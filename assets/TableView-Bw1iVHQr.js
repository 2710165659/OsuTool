import{u as KV,c as XV,i as jS,g as HN,a as be,b as Tp,d as Rm,_ as XR,e as Cs,f as _p,h as Ro,o as Kn,j as nc,k as vl,n as Lr,r as $r,l as Em,t as Tm,m as ZR,w as NN,N as Dw,p as Hi,q as ZV,s as JV,v as JR,x as QV,y as eW,z as US,A as tW,B as nW,C as oa,D as pr,E as gd,F as rW,G as iW,H as DN,I as oW,J as sW,K as aW,L as lW,M as kN,O as rM,P as jh,Q as uW,R as cW,S as hW,T as dW,U as fW,V as gW,W as vr,X as mW,Y as pW,Z as iM,$ as wW,a0 as vW,a1 as CW,a2 as yW,a3 as bW,a4 as SW,a5 as RW,a6 as EW,a7 as TW,a8 as _W,a9 as MW,aa as IW,ab as PW,ac as OW,ad as xW,ae as AW,af as HW}from"./index-C6Wp02jB.js";class NW extends Error{constructor(e){super(e),this.name="ElementPlusError"}}function DW(t,e){throw new NW(`[${t}] ${e}`)}const LN="update:modelValue",oM={prefix:Math.floor(Math.random()*1e4),current:0},kW=Symbol("elIdInjection"),LW=()=>HN()?jS(kW,oM):oM,sM=t=>{const e=LW(),n=KV();return XV(()=>be(t)||`${n.value}-id-${e.prefix}-${e.current++}`)};var aM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};const $W=Tp({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:Rm([String,Object,Array]),default:""},headerClass:String,bodyClass:String,footerClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),FW=Cs({name:"ElCard"}),VW=Cs({...FW,props:$W,setup(t){const e=_p("card");return(n,r)=>(Kn(),Ro("div",{class:Lr([be(e).b(),be(e).is(`${n.shadow}-shadow`)])},[n.$slots.header||n.header?(Kn(),Ro("div",{key:0,class:Lr([be(e).e("header"),n.headerClass])},[$r(n.$slots,"header",{},()=>[Em(Tm(n.header),1)])],2)):nc("v-if",!0),vl("div",{class:Lr([be(e).e("body"),n.bodyClass]),style:ZR(n.bodyStyle)},[$r(n.$slots,"default")],6),n.$slots.footer||n.footer?(Kn(),Ro("div",{key:1,class:Lr([be(e).e("footer"),n.footerClass])},[$r(n.$slots,"footer",{},()=>[Em(Tm(n.footer),1)])],2)):nc("v-if",!0)],2))}});var WW=XR(VW,[["__file","card.vue"]]);const BW=NN(WW);var Zg=(t=>(t[t.TEXT=1]="TEXT",t[t.CLASS=2]="CLASS",t[t.STYLE=4]="STYLE",t[t.PROPS=8]="PROPS",t[t.FULL_PROPS=16]="FULL_PROPS",t[t.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",t[t.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",t[t.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",t[t.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",t[t.NEED_PATCH=512]="NEED_PATCH",t[t.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",t[t.HOISTED=-1]="HOISTED",t[t.BAIL=-2]="BAIL",t))(Zg||{});const $N=t=>{if(!t)return{onClick:Dw,onMousedown:Dw,onMouseup:Dw};let e=!1,n=!1;return{onClick:s=>{e&&n&&t(s),e=n=!1},onMousedown:s=>{e=s.target===s.currentTarget},onMouseup:s=>{n=s.target===s.currentTarget}}},jW=Tp({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:Rm([String,Array,Object])},zIndex:{type:Rm([String,Number])}}),UW={click:t=>t instanceof MouseEvent},zW="overlay";var YW=Cs({name:"ElOverlay",props:jW,emits:UW,setup(t,{slots:e,emit:n}){const r=_p(zW),i=l=>{n("click",l)},{onClick:o,onMousedown:s,onMouseup:a}=$N(t.customMaskEvent?void 0:i);return()=>t.mask?Hi("div",{class:[r.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:o,onMousedown:s,onMouseup:a},[$r(e,"default")],Zg.STYLE|Zg.CLASS|Zg.PROPS,["onClick","onMouseup","onMousedown"]):ZV("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[$r(e,"default")])}});const GW=YW,FN=Symbol("dialogInjectionKey"),VN=Tp({center:Boolean,alignCenter:Boolean,closeIcon:{type:JV},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,headerClass:String,bodyClass:String,footerClass:String,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),qW={close:()=>!0},KW=(t,e,n,r)=>{const i={offsetX:0,offsetY:0},o=(h,d)=>{if(t.value){const{offsetX:f,offsetY:g}=i,w=t.value.getBoundingClientRect(),C=w.left,S=w.top,v=w.width,T=w.height,P=document.documentElement.clientWidth,x=document.documentElement.clientHeight,_=-C+f,M=-S+g,V=P-C-v+f,Y=x-S-(T<x?T:0)+g;r?.value||(h=Math.min(Math.max(h,_),V),d=Math.min(Math.max(d,M),Y)),i.offsetX=h,i.offsetY=d,t.value.style.transform=`translate(${US(h)}, ${US(d)})`}},s=h=>{const d=h.clientX,f=h.clientY,{offsetX:g,offsetY:w}=i,C=v=>{const T=g+v.clientX-d,P=w+v.clientY-f;o(T,P)},S=()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",S)};document.addEventListener("mousemove",C),document.addEventListener("mouseup",S)},a=()=>{e.value&&t.value&&(e.value.addEventListener("mousedown",s),window.addEventListener("resize",c))},l=()=>{e.value&&t.value&&(e.value.removeEventListener("mousedown",s),window.removeEventListener("resize",c))},u=()=>{i.offsetX=0,i.offsetY=0,t.value&&(t.value.style.transform="")},c=()=>{const{offsetX:h,offsetY:d}=i;o(h,d)};return JR(()=>{QV(()=>{n.value?a():l()})}),eW(()=>{l()}),{resetPosition:u,updatePosition:c}},XW=(...t)=>e=>{t.forEach(n=>{tW(n)?n(e):n.value=e})},ZW=Cs({name:"ElDialogContent"}),JW=Cs({...ZW,props:VN,emits:qW,setup(t,{expose:e}){const n=t,{t:r}=nW(),{Close:i}=iW,{dialogRef:o,headerRef:s,bodyId:a,ns:l,style:u}=jS(FN),{focusTrapRef:c}=jS(oW),h=oa(()=>[l.b(),l.is("fullscreen",n.fullscreen),l.is("draggable",n.draggable),l.is("align-center",n.alignCenter),{[l.m("center")]:n.center}]),d=XW(c,o),f=oa(()=>n.draggable),g=oa(()=>n.overflow),{resetPosition:w,updatePosition:C}=KW(o,s,f,g);return e({resetPosition:w,updatePosition:C}),(S,v)=>(Kn(),Ro("div",{ref:be(d),class:Lr(be(h)),style:ZR(be(u)),tabindex:"-1"},[vl("header",{ref_key:"headerRef",ref:s,class:Lr([be(l).e("header"),S.headerClass,{"show-close":S.showClose}])},[$r(S.$slots,"header",{},()=>[vl("span",{role:"heading","aria-level":S.ariaLevel,class:Lr(be(l).e("title"))},Tm(S.title),11,["aria-level"])]),S.showClose?(Kn(),Ro("button",{key:0,"aria-label":be(r)("el.dialog.close"),class:Lr(be(l).e("headerbtn")),type:"button",onClick:T=>S.$emit("close")},[Hi(be(DN),{class:Lr(be(l).e("close"))},{default:pr(()=>[(Kn(),gd(rW(S.closeIcon||be(i))))]),_:1},8,["class"])],10,["aria-label","onClick"])):nc("v-if",!0)],2),vl("div",{id:be(a),class:Lr([be(l).e("body"),S.bodyClass])},[$r(S.$slots,"default")],10,["id"]),S.$slots.footer?(Kn(),Ro("footer",{key:0,class:Lr([be(l).e("footer"),S.footerClass])},[$r(S.$slots,"footer")],2)):nc("v-if",!0)],6))}});var QW=XR(JW,[["__file","dialog-content.vue"]]);const eB=Tp({...VN,appendToBody:Boolean,appendTo:{type:aW.to.type,default:"body"},beforeClose:{type:Rm(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,headerClass:String,bodyClass:String,footerClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),tB={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[LN]:t=>sW(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},nB=(t,e={})=>{lW(t)||DW("[useLockscreen]","You need to pass a ref param to this function");const n=e.ns||_p("popup"),r=oa(()=>n.bm("parent","hidden"));if(!kN||rM(document.body,r.value))return;let i=0,o=!1,s="0";const a=()=>{setTimeout(()=>{typeof document>"u"||o&&document&&(document.body.style.width=s,fW(document.body,r.value))},200)};jh(t,l=>{if(!l){a();return}o=!rM(document.body,r.value),o&&(s=document.body.style.width,cW(document.body,r.value)),i=hW(n.namespace.value);const u=document.documentElement.clientHeight<document.body.scrollHeight,c=dW(document.body,"overflowY");i>0&&(u||c==="scroll")&&o&&(document.body.style.width=`calc(100% - ${i}px)`)}),uW(()=>a())},rB=(t,e)=>{var n;const i=HN().emit,{nextZIndex:o}=gW();let s="";const a=sM(),l=sM(),u=vr(!1),c=vr(!1),h=vr(!1),d=vr((n=t.zIndex)!=null?n:o());let f,g;const w=mW("namespace",pW),C=oa(()=>{const ne={},Fe=`--${w.value}-dialog`;return t.fullscreen||(t.top&&(ne[`${Fe}-margin-top`]=t.top),t.width&&(ne[`${Fe}-width`]=US(t.width))),ne}),S=oa(()=>t.alignCenter?{display:"flex"}:{});function v(){i("opened")}function T(){i("closed"),i(LN,!1),t.destroyOnClose&&(h.value=!1)}function P(){i("close")}function x(){g?.(),f?.(),t.openDelay&&t.openDelay>0?{stop:f}=iM(()=>Y(),t.openDelay):Y()}function _(){f?.(),g?.(),t.closeDelay&&t.closeDelay>0?{stop:g}=iM(()=>O(),t.closeDelay):O()}function M(){function ne(Fe){Fe||(c.value=!0,u.value=!1)}t.beforeClose?t.beforeClose(ne):_()}function V(){t.closeOnClickModal&&M()}function Y(){kN&&(u.value=!0)}function O(){u.value=!1}function G(){i("openAutoFocus")}function J(){i("closeAutoFocus")}function ae(ne){var Fe;((Fe=ne.detail)==null?void 0:Fe.focusReason)==="pointer"&&ne.preventDefault()}t.lockScroll&&nB(u);function te(){t.closeOnPressEscape&&M()}return jh(()=>t.zIndex,()=>{var ne;d.value=(ne=t.zIndex)!=null?ne:o()}),jh(()=>t.modelValue,ne=>{var Fe;ne?(c.value=!1,x(),h.value=!0,d.value=(Fe=t.zIndex)!=null?Fe:o(),wW(()=>{i("open"),e.value&&(e.value.parentElement.scrollTop=0,e.value.parentElement.scrollLeft=0,e.value.scrollTop=0)})):u.value&&_()}),jh(()=>t.fullscreen,ne=>{e.value&&(ne?(s=e.value.style.transform,e.value.style.transform=""):e.value.style.transform=s)}),JR(()=>{t.modelValue&&(u.value=!0,h.value=!0,x())}),{afterEnter:v,afterLeave:T,beforeLeave:P,handleClose:M,onModalClick:V,close:_,doClose:O,onOpenAutoFocus:G,onCloseAutoFocus:J,onCloseRequested:te,onFocusoutPrevented:ae,titleId:a,bodyId:l,closed:c,style:C,overlayDialogStyle:S,rendered:h,visible:u,zIndex:d}},iB=Cs({name:"ElDialog",inheritAttrs:!1}),oB=Cs({...iB,props:eB,emits:tB,setup(t,{expose:e}){const n=t,r=vW();CW({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},oa(()=>!!r.title));const i=_p("dialog"),o=vr(),s=vr(),a=vr(),{visible:l,titleId:u,bodyId:c,style:h,overlayDialogStyle:d,rendered:f,zIndex:g,afterEnter:w,afterLeave:C,beforeLeave:S,handleClose:v,onModalClick:T,onOpenAutoFocus:P,onCloseAutoFocus:x,onCloseRequested:_,onFocusoutPrevented:M}=rB(n,o);MW(FN,{dialogRef:o,headerRef:s,bodyId:c,ns:i,rendered:f,style:h});const V=$N(T),Y=oa(()=>n.draggable&&!n.fullscreen);return e({visible:l,dialogContentRef:a,resetPosition:()=>{var G;(G=a.value)==null||G.resetPosition()},handleClose:v}),(G,J)=>(Kn(),gd(be(_W),{to:G.appendTo,disabled:G.appendTo!=="body"?!1:!G.appendToBody},{default:pr(()=>[Hi(yW,{name:"dialog-fade",onAfterEnter:be(w),onAfterLeave:be(C),onBeforeLeave:be(S),persisted:""},{default:pr(()=>[bW(Hi(be(GW),{"custom-mask-event":"",mask:G.modal,"overlay-class":G.modalClass,"z-index":be(g)},{default:pr(()=>[vl("div",{role:"dialog","aria-modal":"true","aria-label":G.title||void 0,"aria-labelledby":G.title?void 0:be(u),"aria-describedby":be(c),class:Lr(`${be(i).namespace.value}-overlay-dialog`),style:ZR(be(d)),onClick:be(V).onClick,onMousedown:be(V).onMousedown,onMouseup:be(V).onMouseup},[Hi(be(SW),{loop:"",trapped:be(l),"focus-start-el":"container",onFocusAfterTrapped:be(P),onFocusAfterReleased:be(x),onFocusoutPrevented:be(M),onReleaseRequested:be(_)},{default:pr(()=>[be(f)?(Kn(),gd(QW,RW({key:0,ref_key:"dialogContentRef",ref:a},G.$attrs,{center:G.center,"align-center":G.alignCenter,"close-icon":G.closeIcon,draggable:be(Y),overflow:G.overflow,fullscreen:G.fullscreen,"header-class":G.headerClass,"body-class":G.bodyClass,"footer-class":G.footerClass,"show-close":G.showClose,title:G.title,"aria-level":G.headerAriaLevel,onClose:be(v)}),EW({header:pr(()=>[G.$slots.title?$r(G.$slots,"title",{key:1}):$r(G.$slots,"header",{key:0,close:be(v),titleId:be(u),titleClass:be(i).e("title")})]),default:pr(()=>[$r(G.$slots,"default")]),_:2},[G.$slots.footer?{name:"footer",fn:pr(()=>[$r(G.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","header-class","body-class","footer-class","show-close","title","aria-level","onClose"])):nc("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[TW,be(l)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var sB=XR(oB,[["__file","dialog.vue"]]);const aB=NN(sB);var lM={},Ac,uM;function Xt(){if(uM)return Ac;uM=1;var t=function(e){return e&&e.Math===Math&&e};return Ac=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof aM=="object"&&aM)||t(typeof Ac=="object"&&Ac)||function(){return this}()||Function("return this")(),Ac}var kw={},Lw,cM;function sn(){return cM||(cM=1,Lw=function(t){try{return!!t()}catch{return!0}}),Lw}var $w,hM;function li(){if(hM)return $w;hM=1;var t=sn();return $w=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),$w}var Fw,dM;function Mp(){if(dM)return Fw;dM=1;var t=sn();return Fw=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Fw}var Vw,fM;function an(){if(fM)return Vw;fM=1;var t=Mp(),e=Function.prototype.call;return Vw=t?e.bind(e):function(){return e.apply(e,arguments)},Vw}var Ww={},gM;function lB(){if(gM)return Ww;gM=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return Ww.f=n?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,Ww}var Bw,mM;function Ip(){return mM||(mM=1,Bw=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),Bw}var jw,pM;function Zt(){if(pM)return jw;pM=1;var t=Mp(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return jw=t?r:function(i){return function(){return n.apply(i,arguments)}},jw}var Uw,wM;function Nl(){if(wM)return Uw;wM=1;var t=Zt(),e=t({}.toString),n=t("".slice);return Uw=function(r){return n(e(r),8,-1)},Uw}var zw,vM;function uB(){if(vM)return zw;vM=1;var t=Zt(),e=sn(),n=Nl(),r=Object,i=t("".split);return zw=e(function(){return!r("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?i(o,""):r(o)}:r,zw}var Yw,CM;function QR(){return CM||(CM=1,Yw=function(t){return t==null}),Yw}var Gw,yM;function kd(){if(yM)return Gw;yM=1;var t=QR(),e=TypeError;return Gw=function(n){if(t(n))throw new e("Can't call method on "+n);return n},Gw}var qw,bM;function Ld(){if(bM)return qw;bM=1;var t=uB(),e=kd();return qw=function(n){return t(e(n))},qw}var Kw,SM;function ln(){if(SM)return Kw;SM=1;var t=typeof document=="object"&&document.all;return Kw=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},Kw}var Xw,RM;function ui(){if(RM)return Xw;RM=1;var t=ln();return Xw=function(e){return typeof e=="object"?e!==null:t(e)},Xw}var Zw,EM;function dc(){if(EM)return Zw;EM=1;var t=Xt(),e=ln(),n=function(r){return e(r)?r:void 0};return Zw=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},Zw}var Jw,TM;function $d(){if(TM)return Jw;TM=1;var t=Zt();return Jw=t({}.isPrototypeOf),Jw}var Qw,_M;function Pp(){if(_M)return Qw;_M=1;var t=Xt(),e=t.navigator,n=e&&e.userAgent;return Qw=n?String(n):"",Qw}var ev,MM;function cB(){if(MM)return ev;MM=1;var t=Xt(),e=Pp(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),ev=a,ev}var tv,IM;function eE(){if(IM)return tv;IM=1;var t=cB(),e=sn(),n=Xt(),r=n.String;return tv=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),tv}var nv,PM;function WN(){if(PM)return nv;PM=1;var t=eE();return nv=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",nv}var rv,OM;function tE(){if(OM)return rv;OM=1;var t=dc(),e=ln(),n=$d(),r=WN(),i=Object;return rv=r?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&n(s.prototype,i(o))},rv}var iv,xM;function Op(){if(xM)return iv;xM=1;var t=String;return iv=function(e){try{return t(e)}catch{return"Object"}},iv}var ov,AM;function br(){if(AM)return ov;AM=1;var t=ln(),e=Op(),n=TypeError;return ov=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},ov}var sv,HM;function Fd(){if(HM)return sv;HM=1;var t=br(),e=QR();return sv=function(n,r){var i=n[r];return e(i)?void 0:t(i)},sv}var av,NM;function hB(){if(NM)return av;NM=1;var t=an(),e=ln(),n=ui(),r=TypeError;return av=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!n(a=t(s,i))||e(s=i.valueOf)&&!n(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!n(a=t(s,i)))return a;throw new r("Can't convert object to primitive value")},av}var lv={exports:{}},uv,DM;function da(){return DM||(DM=1,uv=!1),uv}var cv,kM;function nE(){if(kM)return cv;kM=1;var t=Xt(),e=Object.defineProperty;return cv=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},cv}var LM;function rE(){if(LM)return lv.exports;LM=1;var t=da(),e=Xt(),n=nE(),r="__core-js_shared__",i=lv.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.44.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"}),lv.exports}var hv,$M;function BN(){if($M)return hv;$M=1;var t=rE();return hv=function(e,n){return t[e]||(t[e]=n||{})},hv}var dv,FM;function fc(){if(FM)return dv;FM=1;var t=kd(),e=Object;return dv=function(n){return e(t(n))},dv}var fv,VM;function ci(){if(VM)return fv;VM=1;var t=Zt(),e=fc(),n=t({}.hasOwnProperty);return fv=Object.hasOwn||function(i,o){return n(e(i),o)},fv}var gv,WM;function jN(){if(WM)return gv;WM=1;var t=Zt(),e=0,n=Math.random(),r=t(1.1.toString);return gv=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},gv}var mv,BM;function Wi(){if(BM)return mv;BM=1;var t=Xt(),e=BN(),n=ci(),r=jN(),i=eE(),o=WN(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||r;return mv=function(u){return n(a,u)||(a[u]=i&&n(s,u)?s[u]:l("Symbol."+u)),a[u]},mv}var pv,jM;function dB(){if(jM)return pv;jM=1;var t=an(),e=ui(),n=tE(),r=Fd(),i=hB(),o=Wi(),s=TypeError,a=o("toPrimitive");return pv=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},pv}var wv,UM;function UN(){if(UM)return wv;UM=1;var t=dB(),e=tE();return wv=function(n){var r=t(n,"string");return e(r)?r:r+""},wv}var vv,zM;function iE(){if(zM)return vv;zM=1;var t=Xt(),e=ui(),n=t.document,r=e(n)&&e(n.createElement);return vv=function(i){return r?n.createElement(i):{}},vv}var Cv,YM;function zN(){if(YM)return Cv;YM=1;var t=li(),e=sn(),n=iE();return Cv=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),Cv}var GM;function YN(){if(GM)return kw;GM=1;var t=li(),e=an(),n=lB(),r=Ip(),i=Ld(),o=UN(),s=ci(),a=zN(),l=Object.getOwnPropertyDescriptor;return kw.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return r(!e(n.f,c,h),c[h])},kw}var yv={},bv,qM;function GN(){if(qM)return bv;qM=1;var t=li(),e=sn();return bv=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),bv}var Sv,KM;function un(){if(KM)return Sv;KM=1;var t=ui(),e=String,n=TypeError;return Sv=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},Sv}var XM;function fa(){if(XM)return yv;XM=1;var t=li(),e=zN(),n=GN(),r=un(),i=UN(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return yv.f=t?n?function(d,f,g){if(r(d),f=i(f),r(g),typeof d=="function"&&f==="prototype"&&"value"in g&&c in g&&!g[c]){var w=a(d,f);w&&w[c]&&(d[f]=g.value,g={configurable:u in g?g[u]:w[u],enumerable:l in g?g[l]:w[l],writable:!1})}return s(d,f,g)}:s:function(d,f,g){if(r(d),f=i(f),r(g),e)try{return s(d,f,g)}catch{}if("get"in g||"set"in g)throw new o("Accessors not supported");return"value"in g&&(d[f]=g.value),d},yv}var Rv,ZM;function gc(){if(ZM)return Rv;ZM=1;var t=li(),e=fa(),n=Ip();return Rv=t?function(r,i,o){return e.f(r,i,n(1,o))}:function(r,i,o){return r[i]=o,r},Rv}var Ev={exports:{}},Tv,JM;function fB(){if(JM)return Tv;JM=1;var t=li(),e=ci(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&r(n,"name").configurable);return Tv={EXISTS:i,PROPER:o,CONFIGURABLE:s},Tv}var _v,QM;function gB(){if(QM)return _v;QM=1;var t=Zt(),e=ln(),n=rE(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),_v=n.inspectSource,_v}var Mv,eI;function mB(){if(eI)return Mv;eI=1;var t=Xt(),e=ln(),n=t.WeakMap;return Mv=e(n)&&/native code/.test(String(n)),Mv}var Iv,tI;function oE(){if(tI)return Iv;tI=1;var t=BN(),e=jN(),n=t("keys");return Iv=function(r){return n[r]||(n[r]=e(r))},Iv}var Pv,nI;function sE(){return nI||(nI=1,Pv={}),Pv}var Ov,rI;function qN(){if(rI)return Ov;rI=1;var t=mB(),e=Xt(),n=ui(),r=gc(),i=ci(),o=rE(),s=oE(),a=sE(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,g=function(v){return f(v)?d(v):h(v,{})},w=function(v){return function(T){var P;if(!n(T)||(P=d(T)).type!==v)throw new u("Incompatible receiver, "+v+" required");return P}};if(t||o.state){var C=o.state||(o.state=new c);C.get=C.get,C.has=C.has,C.set=C.set,h=function(v,T){if(C.has(v))throw new u(l);return T.facade=v,C.set(v,T),T},d=function(v){return C.get(v)||{}},f=function(v){return C.has(v)}}else{var S=s("state");a[S]=!0,h=function(v,T){if(i(v,S))throw new u(l);return T.facade=v,r(v,S,T),T},d=function(v){return i(v,S)?v[S]:{}},f=function(v){return i(v,S)}}return Ov={set:h,get:d,has:f,enforce:g,getterFor:w},Ov}var iI;function KN(){if(iI)return Ev.exports;iI=1;var t=Zt(),e=sn(),n=ln(),r=ci(),i=li(),o=fB().CONFIGURABLE,s=gB(),a=qN(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),g=t([].join),w=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),C=String(String).split("String"),S=Ev.exports=function(v,T,P){d(c(T),0,7)==="Symbol("&&(T="["+f(c(T),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),P&&P.getter&&(T="get "+T),P&&P.setter&&(T="set "+T),(!r(v,"name")||o&&v.name!==T)&&(i?h(v,"name",{value:T,configurable:!0}):v.name=T),w&&P&&r(P,"arity")&&v.length!==P.arity&&h(v,"length",{value:P.arity});try{P&&r(P,"constructor")&&P.constructor?i&&h(v,"prototype",{writable:!1}):v.prototype&&(v.prototype=void 0)}catch{}var x=l(v);return r(x,"source")||(x.source=g(C,typeof T=="string"?T:"")),v};return Function.prototype.toString=S(function(){return n(this)&&u(this).source||s(this)},"toString"),Ev.exports}var xv,oI;function aE(){if(oI)return xv;oI=1;var t=ln(),e=fa(),n=KN(),r=nE();return xv=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&n(s,u,a),a.global)l?i[o]=s:r(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},xv}var Av={},Hv,sI;function pB(){if(sI)return Hv;sI=1;var t=Math.ceil,e=Math.floor;return Hv=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},Hv}var Nv,aI;function Vd(){if(aI)return Nv;aI=1;var t=pB();return Nv=function(e){var n=+e;return n!==n||n===0?0:t(n)},Nv}var Dv,lI;function wB(){if(lI)return Dv;lI=1;var t=Vd(),e=Math.max,n=Math.min;return Dv=function(r,i){var o=t(r);return o<0?e(o+i,0):n(o,i)},Dv}var kv,uI;function vB(){if(uI)return kv;uI=1;var t=Vd(),e=Math.min;return kv=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},kv}var Lv,cI;function mc(){if(cI)return Lv;cI=1;var t=vB();return Lv=function(e){return t(e.length)},Lv}var $v,hI;function CB(){if(hI)return $v;hI=1;var t=Ld(),e=wB(),n=mc(),r=function(i){return function(o,s,a){var l=t(o),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return $v={includes:r(!0),indexOf:r(!1)},$v}var Fv,dI;function XN(){if(dI)return Fv;dI=1;var t=Zt(),e=ci(),n=Ld(),r=CB().indexOf,i=sE(),o=t([].push);return Fv=function(s,a){var l=n(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||o(c,h));return c},Fv}var Vv,fI;function lE(){return fI||(fI=1,Vv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),Vv}var gI;function yB(){if(gI)return Av;gI=1;var t=XN(),e=lE(),n=e.concat("length","prototype");return Av.f=Object.getOwnPropertyNames||function(i){return t(i,n)},Av}var Wv={},mI;function bB(){return mI||(mI=1,Wv.f=Object.getOwnPropertySymbols),Wv}var Bv,pI;function SB(){if(pI)return Bv;pI=1;var t=dc(),e=Zt(),n=yB(),r=bB(),i=un(),o=e([].concat);return Bv=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?o(l,u(a)):l},Bv}var jv,wI;function ZN(){if(wI)return jv;wI=1;var t=ci(),e=SB(),n=YN(),r=fa();return jv=function(i,o,s){for(var a=e(o),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},jv}var Uv,vI;function RB(){if(vI)return Uv;vI=1;var t=sn(),e=ln(),n=/#|\.prototype\./,r=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},o=r.data={},s=r.NATIVE="N",a=r.POLYFILL="P";return Uv=r,Uv}var zv,CI;function pt(){if(CI)return zv;CI=1;var t=Xt(),e=YN().f,n=gc(),r=aE(),i=nE(),o=ZN(),s=RB();return zv=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,g,w,C,S;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(g in l){if(C=l[g],a.dontCallGetSet?(S=e(f,g),w=S&&S.value):w=f[g],d=s(c?g:u+(h?".":"#")+g,a.forced),!d&&w!==void 0){if(typeof C==typeof w)continue;o(C,w)}(a.sham||w&&w.sham)&&n(C,"sham",!0),r(f,g,C,a)}},zv}var Yv,yI;function Wd(){if(yI)return Yv;yI=1;var t=Mp(),e=Function.prototype,n=e.apply,r=e.call;return Yv=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),Yv}var Gv,bI;function JN(){if(bI)return Gv;bI=1;var t=Zt(),e=br();return Gv=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},Gv}var qv,SI;function EB(){if(SI)return qv;SI=1;var t=ui();return qv=function(e){return t(e)||e===null},qv}var Kv,RI;function TB(){if(RI)return Kv;RI=1;var t=EB(),e=String,n=TypeError;return Kv=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},Kv}var Xv,EI;function QN(){if(EI)return Xv;EI=1;var t=JN(),e=ui(),n=kd(),r=TB();return Xv=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),Xv}var Zv,TI;function _B(){if(TI)return Zv;TI=1;var t=fa().f;return Zv=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},Zv}var Jv,_I;function MB(){if(_I)return Jv;_I=1;var t=ln(),e=ui(),n=QN();return Jv=function(r,i,o){var s,a;return n&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&n(r,a),r},Jv}var Qv,MI;function IB(){if(MI)return Qv;MI=1;var t=Wi(),e=t("toStringTag"),n={};return n[e]="z",Qv=String(n)==="[object z]",Qv}var eC,II;function eD(){if(II)return eC;II=1;var t=IB(),e=ln(),n=Nl(),r=Wi(),i=r("toStringTag"),o=Object,s=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return eC=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},eC}var tC,PI;function xp(){if(PI)return tC;PI=1;var t=eD(),e=String;return tC=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},tC}var nC,OI;function PB(){if(OI)return nC;OI=1;var t=xp();return nC=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},nC}var rC,xI;function OB(){if(xI)return rC;xI=1;var t=ui(),e=gc();return rC=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},rC}var iC,AI;function xB(){if(AI)return iC;AI=1;var t=Zt(),e=Error,n=t("".replace),r=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(r);return iC=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=n(s,i,"");return s},iC}var oC,HI;function AB(){if(HI)return oC;HI=1;var t=sn(),e=Ip();return oC=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),oC}var sC,NI;function HB(){if(NI)return sC;NI=1;var t=gc(),e=xB(),n=AB(),r=Error.captureStackTrace;return sC=function(i,o,s,a){n&&(r?r(i,o):t(i,"stack",e(s,a)))},sC}var aC,DI;function NB(){if(DI)return aC;DI=1;var t=dc(),e=ci(),n=gc(),r=$d(),i=QN(),o=ZN(),s=_B(),a=MB(),l=PB(),u=OB(),c=HB(),h=li(),d=da();return aC=function(f,g,w,C){var S="stackTraceLimit",v=C?2:1,T=f.split("."),P=T[T.length-1],x=t.apply(null,T);if(x){var _=x.prototype;if(!d&&e(_,"cause")&&delete _.cause,!w)return x;var M=t("Error"),V=g(function(Y,O){var G=l(C?O:Y,void 0),J=C?new x(Y):new x;return G!==void 0&&n(J,"message",G),c(J,V,J.stack,2),this&&r(_,this)&&a(J,this,V),arguments.length>v&&u(J,arguments[v]),J});if(V.prototype=_,P!=="Error"?i?i(V,M):o(V,M,{name:!0}):h&&S in x&&(s(V,x,S),s(V,x,"prepareStackTrace")),o(V,x),!d)try{_.name!==P&&n(_,"name",P),_.constructor=V}catch{}return V}},aC}var kI;function DB(){if(kI)return lM;kI=1;var t=pt(),e=Xt(),n=Wd(),r=NB(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=r(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),lM}DB();var LI={},lC,$I;function tD(){if($I)return lC;$I=1;var t=Nl();return lC=Array.isArray||function(n){return t(n)==="Array"},lC}var uC,FI;function nD(){if(FI)return uC;FI=1;var t=li(),e=tD(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return uC=i?function(o,s){if(e(o)&&!r(o,"length").writable)throw new n("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},uC}var cC,VI;function rD(){if(VI)return cC;VI=1;var t=TypeError,e=9007199254740991;return cC=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},cC}var WI;function kB(){if(WI)return LI;WI=1;var t=pt(),e=fc(),n=mc(),r=nD(),i=rD(),o=sn(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var g=0;g<f;g++)h[d]=arguments[g],d++;return r(h,d),d}}),LI}kB();var BI={},hC,jI;function LB(){if(jI)return hC;jI=1;var t=Nl(),e=Zt();return hC=function(n){if(t(n)==="Function")return e(n)},hC}var dC,UI;function iD(){if(UI)return dC;UI=1;var t=LB(),e=br(),n=Mp(),r=t(t.bind);return dC=function(i,o){return e(i),o===void 0?i:n?r(i,o):function(){return i.apply(o,arguments)}},dC}var fC,zI;function oD(){return zI||(zI=1,fC={}),fC}var gC,YI;function $B(){if(YI)return gC;YI=1;var t=Wi(),e=oD(),n=t("iterator"),r=Array.prototype;return gC=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},gC}var mC,GI;function uE(){if(GI)return mC;GI=1;var t=eD(),e=Fd(),n=QR(),r=oD(),i=Wi(),o=i("iterator");return mC=function(s){if(!n(s))return e(s,o)||e(s,"@@iterator")||r[t(s)]},mC}var pC,qI;function FB(){if(qI)return pC;qI=1;var t=an(),e=br(),n=un(),r=Op(),i=uE(),o=TypeError;return pC=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return n(t(l,s));throw new o(r(s)+" is not iterable")},pC}var wC,KI;function Sr(){if(KI)return wC;KI=1;var t=an(),e=un(),n=Fd();return wC=function(r,i,o){var s,a;e(r);try{if(s=n(r,"return"),!s){if(i==="throw")throw o;return o}s=t(s,r)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},wC}var vC,XI;function pc(){if(XI)return vC;XI=1;var t=iD(),e=an(),n=un(),r=Op(),i=$B(),o=mc(),s=$d(),a=FB(),l=uE(),u=Sr(),c=TypeError,h=function(f,g){this.stopped=f,this.result=g},d=h.prototype;return vC=function(f,g,w){var C=w&&w.that,S=!!(w&&w.AS_ENTRIES),v=!!(w&&w.IS_RECORD),T=!!(w&&w.IS_ITERATOR),P=!!(w&&w.INTERRUPTED),x=t(g,C),_,M,V,Y,O,G,J,ae=function(ne){return _&&u(_,"normal"),new h(!0,ne)},te=function(ne){return S?(n(ne),P?x(ne[0],ne[1],ae):x(ne[0],ne[1])):P?x(ne,ae):x(ne)};if(v)_=f.iterator;else if(T)_=f;else{if(M=l(f),!M)throw new c(r(f)+" is not iterable");if(i(M)){for(V=0,Y=o(f);Y>V;V++)if(O=te(f[V]),O&&s(d,O))return O;return new h(!1)}_=a(f,M)}for(G=v?f.next:_.next;!(J=e(G,_)).done;){try{O=te(J.value)}catch(ne){u(_,"throw",ne)}if(typeof O=="object"&&O&&s(d,O))return O}return new h(!1)},vC}var CC,ZI;function sD(){if(ZI)return CC;ZI=1;var t=li(),e=fa(),n=Ip();return CC=function(r,i,o){t?e.f(r,i,n(0,o)):r[i]=o},CC}var JI;function VB(){if(JI)return BI;JI=1;var t=pt(),e=pc(),n=sD();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){n(o,s,a)},{AS_ENTRIES:!0}),o}}),BI}VB();var QI={},yC,eP;function Mo(){if(eP)return yC;eP=1;var t=Zt(),e=Set.prototype;return yC={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},yC}var bC,tP;function Dl(){if(tP)return bC;tP=1;var t=Mo().has;return bC=function(e){return t(e),e},bC}var SC,nP;function kl(){if(nP)return SC;nP=1;var t=an();return SC=function(e,n,r){for(var i=r?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=n(s.value),a!==void 0)return a},SC}var RC,rP;function Bd(){if(rP)return RC;rP=1;var t=Zt(),e=kl(),n=Mo(),r=n.Set,i=n.proto,o=t(i.forEach),s=t(i.keys),a=s(new r).next;return RC=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},RC}var EC,iP;function cE(){if(iP)return EC;iP=1;var t=Mo(),e=Bd(),n=t.Set,r=t.add;return EC=function(i){var o=new n;return e(i,function(s){r(o,s)}),o},EC}var TC,oP;function jd(){if(oP)return TC;oP=1;var t=JN(),e=Mo();return TC=t(e.proto,"size","get")||function(n){return n.size},TC}var _C,sP;function Io(){return sP||(sP=1,_C=function(t){return{iterator:t,next:t.next,done:!1}}),_C}var MC,aP;function Ll(){if(aP)return MC;aP=1;var t=br(),e=un(),n=an(),r=Vd(),i=Io(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},MC=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=r(h);if(d<0)throw new s(o);return new u(c,d)},MC}var IC,lP;function WB(){if(lP)return IC;lP=1;var t=Dl(),e=Mo(),n=cE(),r=jd(),i=Ll(),o=Bd(),s=kl(),a=e.has,l=e.remove;return IC=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?o(h,function(g){d.includes(g)&&l(f,g)}):s(d.getIterator(),function(g){a(f,g)&&l(f,g)}),f},IC}var PC,uP;function $l(){if(uP)return PC;uP=1;var t=dc(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return PC=function(r,i){var o=t("Set");try{new o()[r](e(0));try{return new o()[r](e(-1)),!1}catch{if(!i)return!0;try{return new o()[r](n(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[r](n(1/0)))}}}catch{return!1}},PC}var cP;function BB(){if(cP)return QI;cP=1;var t=pt(),e=WB(),n=sn(),r=$l(),i=!r("difference",function(s){return s.size===0}),o=i||n(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),QI}BB();var hP={},OC,dP;function jB(){if(dP)return OC;dP=1;var t=Dl(),e=Mo(),n=jd(),r=Ll(),i=Bd(),o=kl(),s=e.Set,a=e.add,l=e.has;return OC=function(c){var h=t(this),d=r(c),f=new s;return n(h)>d.size?o(d.getIterator(),function(g){l(h,g)&&a(f,g)}):i(h,function(g){d.includes(g)&&a(f,g)}),f},OC}var fP;function UB(){if(fP)return hP;fP=1;var t=pt(),e=sn(),n=jB(),r=$l(),i=!r("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),hP}UB();var gP={},xC,mP;function zB(){if(mP)return xC;mP=1;var t=Dl(),e=Mo().has,n=jd(),r=Ll(),i=Bd(),o=kl(),s=Sr();return xC=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},xC}var pP;function YB(){if(pP)return gP;pP=1;var t=pt(),e=zB(),n=$l(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),gP}YB();var wP={},AC,vP;function GB(){if(vP)return AC;vP=1;var t=Dl(),e=jd(),n=Bd(),r=Ll();return AC=function(o){var s=t(this),a=r(o);return e(s)>a.size?!1:n(s,function(l){if(!a.includes(l))return!1},!0)!==!1},AC}var CP;function qB(){if(CP)return wP;CP=1;var t=pt(),e=GB(),n=$l(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),wP}qB();var yP={},HC,bP;function KB(){if(bP)return HC;bP=1;var t=Dl(),e=Mo().has,n=jd(),r=Ll(),i=kl(),o=Sr();return HC=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},HC}var SP;function XB(){if(SP)return yP;SP=1;var t=pt(),e=KB(),n=$l(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),yP}XB();var RP={},NC,EP;function ZB(){if(EP)return NC;EP=1;var t=Dl(),e=Mo(),n=cE(),r=Ll(),i=kl(),o=e.add,s=e.has,a=e.remove;return NC=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){s(c,f)?a(d,f):o(d,f)}),d},NC}var DC,TP;function aD(){return TP||(TP=1,DC=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[t](n);return r.size===1&&r.values().next().value===4}catch{return!1}}),DC}var _P;function JB(){if(_P)return RP;_P=1;var t=pt(),e=ZB(),n=aD(),r=$l(),i=!r("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),RP}JB();var MP={},kC,IP;function QB(){if(IP)return kC;IP=1;var t=Dl(),e=Mo().add,n=cE(),r=Ll(),i=kl();return kC=function(s){var a=t(this),l=r(s).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},kC}var PP;function ej(){if(PP)return MP;PP=1;var t=pt(),e=QB(),n=aD(),r=$l(),i=!r("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),MP}ej();var OP={},xP={},LC,AP;function tj(){if(AP)return LC;AP=1;var t=$d(),e=TypeError;return LC=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},LC}var $C,HP;function nj(){if(HP)return $C;HP=1;var t=sn();return $C=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),$C}var FC,NP;function lD(){if(NP)return FC;NP=1;var t=ci(),e=ln(),n=fc(),r=oE(),i=nj(),o=r("IE_PROTO"),s=Object,a=s.prototype;return FC=i?s.getPrototypeOf:function(l){var u=n(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},FC}var VC,DP;function rj(){if(DP)return VC;DP=1;var t=KN(),e=fa();return VC=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},VC}var WC={},BC,kP;function ij(){if(kP)return BC;kP=1;var t=XN(),e=lE();return BC=Object.keys||function(r){return t(r,e)},BC}var LP;function oj(){if(LP)return WC;LP=1;var t=li(),e=GN(),n=fa(),r=un(),i=Ld(),o=ij();return WC.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=o(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},WC}var jC,$P;function uD(){if($P)return jC;$P=1;var t=dc();return jC=t("document","documentElement"),jC}var UC,FP;function hE(){if(FP)return UC;FP=1;var t=un(),e=oj(),n=lE(),r=sE(),i=uD(),o=iE(),s=oE(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},f=function(v){return l+c+a+v+l+"/"+c+a},g=function(v){v.write(f("")),v.close();var T=v.parentWindow.Object;return v=null,T},w=function(){var v=o("iframe"),T="java"+c+":",P;return v.style.display="none",i.appendChild(v),v.src=String(T),P=v.contentWindow.document,P.open(),P.write(f("document.F=Object")),P.close(),P.F},C,S=function(){try{C=new ActiveXObject("htmlfile")}catch{}S=typeof document<"u"?document.domain&&C?g(C):w():g(C);for(var v=n.length;v--;)delete S[u][n[v]];return S()};return r[h]=!0,UC=Object.create||function(T,P){var x;return T!==null?(d[u]=t(T),x=new d,d[u]=null,x[h]=T):x=S(),P===void 0?x:e.f(x,P)},UC}var zC,VP;function cD(){if(VP)return zC;VP=1;var t=sn(),e=ln(),n=ui(),r=hE(),i=lD(),o=aE(),s=Wi(),a=da(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var g={};return c[l].call(g)!==g});return f?c={}:a&&(c=r(c)),e(c[l])||o(c,l,function(){return this}),zC={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},zC}var WP;function sj(){if(WP)return xP;WP=1;var t=pt(),e=Xt(),n=tj(),r=un(),i=ln(),o=lD(),s=rj(),a=sD(),l=sn(),u=ci(),c=Wi(),h=cD().IteratorPrototype,d=li(),f=da(),g="constructor",w="Iterator",C=c("toStringTag"),S=TypeError,v=e[w],T=f||!i(v)||v.prototype!==h||!l(function(){v({})}),P=function(){if(n(this,h),o(this)===h)throw new S("Abstract class Iterator not directly constructable")},x=function(_,M){d?s(h,_,{configurable:!0,get:function(){return M},set:function(V){if(r(this),this===h)throw new S("You can't redefine this property");u(this,_)?this[_]=V:a(this,_,V)}}):h[_]=M};return u(h,C)||x(C,w),(T||!u(h,g)||h[g]===Object)&&x(g,P),P.prototype=h,t({global:!0,constructor:!0,forced:T},{Iterator:P}),xP}var BP;function aj(){return BP||(BP=1,sj()),OP}aj();var jP={},UP={},YC,zP;function lj(){if(zP)return YC;zP=1;var t=aE();return YC=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},YC}var GC,YP;function uj(){return YP||(YP=1,GC=function(t,e){return{value:t,done:e}}),GC}var qC,GP;function cj(){if(GP)return qC;GP=1;var t=Sr();return qC=function(e,n,r){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{r=t(e[i].iterator,n,r)}catch(o){n="throw",r=o}if(n==="throw")throw r;return r},qC}var KC,qP;function dE(){if(qP)return KC;qP=1;var t=an(),e=hE(),n=gc(),r=lj(),i=Wi(),o=qN(),s=Fd(),a=cD().IteratorPrototype,l=uj(),u=Sr(),c=cj(),h=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",g="normal",w="throw",C=o.set,S=function(P){var x=o.getterFor(P?f:d);return r(e(a),{next:function(){var M=x(this);if(P)return M.nextHandler();if(M.done)return l(void 0,!0);try{var V=M.nextHandler();return M.returnHandlerResult?V:l(V,M.done)}catch(Y){throw M.done=!0,Y}},return:function(){var _=x(this),M=_.iterator;if(_.done=!0,P){var V=s(M,"return");return V?t(V,M):l(void 0,!0)}if(_.inner)try{u(_.inner.iterator,g)}catch(Y){return u(M,w,Y)}if(_.openIters)try{c(_.openIters,g)}catch(Y){return u(M,w,Y)}return M&&u(M,g),l(void 0,!0)}})},v=S(!0),T=S(!1);return n(T,h,"Iterator Helper"),KC=function(P,x,_){var M=function(Y,O){O?(O.iterator=Y.iterator,O.next=Y.next):O=Y,O.type=x?f:d,O.returnHandlerResult=!!_,O.nextHandler=P,O.counter=0,O.done=!1,C(this,O)};return M.prototype=x?v:T,M},KC}var XC,KP;function hD(){if(KP)return XC;KP=1;var t=un(),e=Sr();return XC=function(n,r,i,o){try{return o?r(t(i)[0],i[1]):r(i)}catch(s){e(n,"throw",s)}},XC}var ZC,XP;function fE(){return XP||(XP=1,ZC=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),ZC}var JC,ZP;function ga(){if(ZP)return JC;ZP=1;var t=Xt();return JC=function(e,n){var r=t.Iterator,i=r&&r.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof n||(s=!1)}if(!s)return o},JC}var JP;function hj(){if(JP)return UP;JP=1;var t=pt(),e=an(),n=br(),r=un(),i=Io(),o=dE(),s=hD(),a=da(),l=Sr(),u=fE(),c=ga(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),f=a||h||d,g=o(function(){for(var w=this.iterator,C=this.predicate,S=this.next,v,T,P;;){if(v=r(e(S,w)),T=this.done=!!v.done,T)return;if(P=v.value,s(w,C,[P,this.counter++],!0))return P}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(C){r(this);try{n(C)}catch(S){l(this,"throw",S)}return d?e(d,this,C):new g(i(this),{predicate:C})}}),UP}var QP;function dj(){return QP||(QP=1,hj()),jP}dj();var eO={},tO={},nO;function fj(){if(nO)return tO;nO=1;var t=pt(),e=an(),n=pc(),r=br(),i=un(),o=Io(),s=Sr(),a=ga(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),tO}var rO;function gj(){return rO||(rO=1,fj()),eO}gj();var iO={},oO={},sO;function mj(){if(sO)return oO;sO=1;var t=pt(),e=an(),n=br(),r=un(),i=Io(),o=dE(),s=hD(),a=Sr(),l=fE(),u=ga(),c=da(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),f=c||h||d,g=o(function(){var w=this.iterator,C=r(e(this.next,w)),S=this.done=!!C.done;if(!S)return s(w,this.mapper,[C.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(C){r(this);try{n(C)}catch(S){a(this,"throw",S)}return d?e(d,this,C):new g(i(this),{mapper:C})}}),oO}var aO;function pj(){return aO||(aO=1,mj()),iO}pj();var lO={},uO={},QC,cO;function gE(){if(cO)return QC;cO=1;var t=Zt();return QC=t([].slice),QC}var ey,hO;function dD(){if(hO)return ey;hO=1;var t=TypeError;return ey=function(e,n){if(e<n)throw new t("Not enough arguments");return e},ey}var ty,dO;function wj(){if(dO)return ty;dO=1;var t=Pp();return ty=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),ty}var ny,fO;function fD(){if(fO)return ny;fO=1;var t=Xt(),e=Pp(),n=Nl(),r=function(i){return e.slice(0,i.length)===i};return ny=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),ny}var ry,gO;function vj(){if(gO)return ry;gO=1;var t=fD();return ry=t==="NODE",ry}var iy,mO;function gD(){if(mO)return iy;mO=1;var t=Xt(),e=Wd(),n=iD(),r=ln(),i=ci(),o=sn(),s=uD(),a=gE(),l=iE(),u=dD(),c=wj(),h=vj(),d=t.setImmediate,f=t.clearImmediate,g=t.process,w=t.Dispatch,C=t.Function,S=t.MessageChannel,v=t.String,T=0,P={},x="onreadystatechange",_,M,V,Y;o(function(){_=t.location});var O=function(te){if(i(P,te)){var ne=P[te];delete P[te],ne()}},G=function(te){return function(){O(te)}},J=function(te){O(te.data)},ae=function(te){t.postMessage(v(te),_.protocol+"//"+_.host)};return(!d||!f)&&(d=function(ne){u(arguments.length,1);var Fe=r(ne)?ne:C(ne),ke=a(arguments,1);return P[++T]=function(){e(Fe,void 0,ke)},M(T),T},f=function(ne){delete P[ne]},h?M=function(te){g.nextTick(G(te))}:w&&w.now?M=function(te){w.now(G(te))}:S&&!c?(V=new S,Y=V.port2,V.port1.onmessage=J,M=n(Y.postMessage,Y)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&_&&_.protocol!=="file:"&&!o(ae)?(M=ae,t.addEventListener("message",J,!1)):x in l("script")?M=function(te){s.appendChild(l("script"))[x]=function(){s.removeChild(this),O(te)}}:M=function(te){setTimeout(G(te),0)}),iy={set:d,clear:f},iy}var pO;function Cj(){if(pO)return uO;pO=1;var t=pt(),e=Xt(),n=gD().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),uO}var wO={},oy,vO;function yj(){if(vO)return oy;vO=1;var t=Xt(),e=Wd(),n=ln(),r=fD(),i=Pp(),o=gE(),s=dD(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return oy=function(u,c){var h=c?2:1;return l?function(d,f){var g=s(arguments.length,1)>h,w=n(d)?d:a(d),C=g?o(arguments,h):[],S=g?function(){e(w,this,C)}:w;return c?u(S,f):u(S)}:u},oy}var CO;function bj(){if(CO)return wO;CO=1;var t=pt(),e=Xt(),n=gD().set,r=yj(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),wO}var yO;function Sj(){return yO||(yO=1,Cj(),bj()),lO}Sj();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:mD,setPrototypeOf:bO,isFrozen:Rj,getPrototypeOf:Ej,getOwnPropertyDescriptor:Tj}=Object;let{freeze:Xn,seal:ai,create:pD}=Object,{apply:zS,construct:YS}=typeof Reflect<"u"&&Reflect;Xn||(Xn=function(e){return e});ai||(ai=function(e){return e});zS||(zS=function(e,n,r){return e.apply(n,r)});YS||(YS=function(e,n){return new e(...n)});const gf=Zn(Array.prototype.forEach),_j=Zn(Array.prototype.lastIndexOf),SO=Zn(Array.prototype.pop),Hc=Zn(Array.prototype.push),Mj=Zn(Array.prototype.splice),Jg=Zn(String.prototype.toLowerCase),sy=Zn(String.prototype.toString),RO=Zn(String.prototype.match),Nc=Zn(String.prototype.replace),Ij=Zn(String.prototype.indexOf),Pj=Zn(String.prototype.trim),_i=Zn(Object.prototype.hasOwnProperty),Fn=Zn(RegExp.prototype.test),Dc=Oj(TypeError);function Zn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return zS(t,e,r)}}function Oj(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return YS(t,n)}}function Le(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jg;bO&&bO(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(Rj(e)||(e[r]=o),i=o)}t[i]=!0}return t}function xj(t){for(let e=0;e<t.length;e++)_i(t,e)||(t[e]=null);return t}function qo(t){const e=pD(null);for(const[n,r]of mD(t))_i(t,n)&&(Array.isArray(r)?e[n]=xj(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=qo(r):e[n]=r);return e}function kc(t,e){for(;t!==null;){const r=Tj(t,e);if(r){if(r.get)return Zn(r.get);if(typeof r.value=="function")return Zn(r.value)}t=Ej(t)}function n(){return null}return n}const EO=Xn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ay=Xn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ly=Xn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Aj=Xn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),uy=Xn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Hj=Xn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),TO=Xn(["#text"]),_O=Xn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),cy=Xn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),MO=Xn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),mf=Xn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Nj=ai(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Dj=ai(/<%[\w\W]*|[\w\W]*%>/gm),kj=ai(/\$\{[\w\W]*/gm),Lj=ai(/^data-[\-\w.\u00B7-\uFFFF]+$/),$j=ai(/^aria-[\-\w]+$/),wD=ai(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Fj=ai(/^(?:\w+script|data):/i),Vj=ai(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),vD=ai(/^html$/i),Wj=ai(/^[a-z][.\w]*(-[.\w]+)+$/i);var IO=Object.freeze({__proto__:null,ARIA_ATTR:$j,ATTR_WHITESPACE:Vj,CUSTOM_ELEMENT:Wj,DATA_ATTR:Lj,DOCTYPE_NAME:vD,ERB_EXPR:Dj,IS_ALLOWED_URI:wD,IS_SCRIPT_OR_DATA:Fj,MUSTACHE_EXPR:Nj,TMPLIT_EXPR:kj});const Lc={element:1,text:3,progressingInstruction:7,comment:8,document:9},Bj=function(){return typeof window>"u"?null:window},jj=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},PO=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function CD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Bj();const e=pe=>CD(pe);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Lc.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,w=kc(g,"cloneNode"),C=kc(g,"remove"),S=kc(g,"nextSibling"),v=kc(g,"childNodes"),T=kc(g,"parentNode");if(typeof s=="function"){const pe=n.createElement("template");pe.content&&pe.content.ownerDocument&&(n=pe.content.ownerDocument)}let P,x="";const{implementation:_,createNodeIterator:M,createDocumentFragment:V,getElementsByTagName:Y}=n,{importNode:O}=r;let G=PO();e.isSupported=typeof mD=="function"&&typeof T=="function"&&_&&_.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:J,ERB_EXPR:ae,TMPLIT_EXPR:te,DATA_ATTR:ne,ARIA_ATTR:Fe,IS_SCRIPT_OR_DATA:ke,ATTR_WHITESPACE:Ve,CUSTOM_ELEMENT:yt}=IO;let{IS_ALLOWED_URI:ot}=IO,ut=null;const pn=Le({},[...EO,...ay,...ly,...uy,...TO]);let m=null;const p=Le({},[..._O,...cy,...MO,...mf]);let b=Object.seal(pD(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),D=null,F=null,j=!0,K=!0,y=!1,R=!0,E=!1,I=!0,A=!1,L=!1,B=!1,N=!1,$=!1,W=!1,U=!0,q=!1;const se="user-content-";let le=!0,Re=!1,We={},Be=null;const Ee=Le({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Se=null;const nt=Le({},["audio","video","img","source","image","track"]);let er=null;const Ao=Le({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),mi="http://www.w3.org/1998/Math/MathML",cn="http://www.w3.org/2000/svg",bt="http://www.w3.org/1999/xhtml";let _t=bt,wt=!1,Qe=null;const Br=Le({},[mi,cn,bt],sy);let $n=Le({},["mi","mo","mn","ms","mtext"]),Ca=Le({},["annotation-xml"]);const ff=Le({},["title","style","font","a","script"]);let Oc=null;const UV=["application/xhtml+xml","text/html"],zV="text/html";let wn=null,jl=null;const YV=n.createElement("form"),z_=function(k){return k instanceof RegExp||k instanceof Function},Aw=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(jl&&jl===k)){if((!k||typeof k!="object")&&(k={}),k=qo(k),Oc=UV.indexOf(k.PARSER_MEDIA_TYPE)===-1?zV:k.PARSER_MEDIA_TYPE,wn=Oc==="application/xhtml+xml"?sy:Jg,ut=_i(k,"ALLOWED_TAGS")?Le({},k.ALLOWED_TAGS,wn):pn,m=_i(k,"ALLOWED_ATTR")?Le({},k.ALLOWED_ATTR,wn):p,Qe=_i(k,"ALLOWED_NAMESPACES")?Le({},k.ALLOWED_NAMESPACES,sy):Br,er=_i(k,"ADD_URI_SAFE_ATTR")?Le(qo(Ao),k.ADD_URI_SAFE_ATTR,wn):Ao,Se=_i(k,"ADD_DATA_URI_TAGS")?Le(qo(nt),k.ADD_DATA_URI_TAGS,wn):nt,Be=_i(k,"FORBID_CONTENTS")?Le({},k.FORBID_CONTENTS,wn):Ee,D=_i(k,"FORBID_TAGS")?Le({},k.FORBID_TAGS,wn):qo({}),F=_i(k,"FORBID_ATTR")?Le({},k.FORBID_ATTR,wn):qo({}),We=_i(k,"USE_PROFILES")?k.USE_PROFILES:!1,j=k.ALLOW_ARIA_ATTR!==!1,K=k.ALLOW_DATA_ATTR!==!1,y=k.ALLOW_UNKNOWN_PROTOCOLS||!1,R=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,E=k.SAFE_FOR_TEMPLATES||!1,I=k.SAFE_FOR_XML!==!1,A=k.WHOLE_DOCUMENT||!1,N=k.RETURN_DOM||!1,$=k.RETURN_DOM_FRAGMENT||!1,W=k.RETURN_TRUSTED_TYPE||!1,B=k.FORCE_BODY||!1,U=k.SANITIZE_DOM!==!1,q=k.SANITIZE_NAMED_PROPS||!1,le=k.KEEP_CONTENT!==!1,Re=k.IN_PLACE||!1,ot=k.ALLOWED_URI_REGEXP||wD,_t=k.NAMESPACE||bt,$n=k.MATHML_TEXT_INTEGRATION_POINTS||$n,Ca=k.HTML_INTEGRATION_POINTS||Ca,b=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&z_(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(b.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&z_(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(b.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(b.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),E&&(K=!1),$&&(N=!0),We&&(ut=Le({},TO),m=[],We.html===!0&&(Le(ut,EO),Le(m,_O)),We.svg===!0&&(Le(ut,ay),Le(m,cy),Le(m,mf)),We.svgFilters===!0&&(Le(ut,ly),Le(m,cy),Le(m,mf)),We.mathMl===!0&&(Le(ut,uy),Le(m,MO),Le(m,mf))),k.ADD_TAGS&&(ut===pn&&(ut=qo(ut)),Le(ut,k.ADD_TAGS,wn)),k.ADD_ATTR&&(m===p&&(m=qo(m)),Le(m,k.ADD_ATTR,wn)),k.ADD_URI_SAFE_ATTR&&Le(er,k.ADD_URI_SAFE_ATTR,wn),k.FORBID_CONTENTS&&(Be===Ee&&(Be=qo(Be)),Le(Be,k.FORBID_CONTENTS,wn)),le&&(ut["#text"]=!0),A&&Le(ut,["html","head","body"]),ut.table&&(Le(ut,["tbody"]),delete D.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw Dc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Dc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');P=k.TRUSTED_TYPES_POLICY,x=P.createHTML("")}else P===void 0&&(P=jj(f,i)),P!==null&&typeof x=="string"&&(x=P.createHTML(""));Xn&&Xn(k),jl=k}},Y_=Le({},[...ay,...ly,...Aj]),G_=Le({},[...uy,...Hj]),GV=function(k){let ee=T(k);(!ee||!ee.tagName)&&(ee={namespaceURI:_t,tagName:"template"});const ge=Jg(k.tagName),Mt=Jg(ee.tagName);return Qe[k.namespaceURI]?k.namespaceURI===cn?ee.namespaceURI===bt?ge==="svg":ee.namespaceURI===mi?ge==="svg"&&(Mt==="annotation-xml"||$n[Mt]):!!Y_[ge]:k.namespaceURI===mi?ee.namespaceURI===bt?ge==="math":ee.namespaceURI===cn?ge==="math"&&Ca[Mt]:!!G_[ge]:k.namespaceURI===bt?ee.namespaceURI===cn&&!Ca[Mt]||ee.namespaceURI===mi&&!$n[Mt]?!1:!G_[ge]&&(ff[ge]||!Y_[ge]):!!(Oc==="application/xhtml+xml"&&Qe[k.namespaceURI]):!1},zi=function(k){Hc(e.removed,{element:k});try{T(k).removeChild(k)}catch{C(k)}},Ul=function(k,ee){try{Hc(e.removed,{attribute:ee.getAttributeNode(k),from:ee})}catch{Hc(e.removed,{attribute:null,from:ee})}if(ee.removeAttribute(k),k==="is")if(N||$)try{zi(ee)}catch{}else try{ee.setAttribute(k,"")}catch{}},q_=function(k){let ee=null,ge=null;if(B)k="<remove></remove>"+k;else{const hn=RO(k,/^[\r\n\t ]+/);ge=hn&&hn[0]}Oc==="application/xhtml+xml"&&_t===bt&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const Mt=P?P.createHTML(k):k;if(_t===bt)try{ee=new d().parseFromString(Mt,Oc)}catch{}if(!ee||!ee.documentElement){ee=_.createDocument(_t,"template",null);try{ee.documentElement.innerHTML=wt?x:Mt}catch{}}const Tn=ee.body||ee.documentElement;return k&&ge&&Tn.insertBefore(n.createTextNode(ge),Tn.childNodes[0]||null),_t===bt?Y.call(ee,A?"html":"body")[0]:A?ee.documentElement:Tn},K_=function(k){return M.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Hw=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},X_=function(k){return typeof a=="function"&&k instanceof a};function Ho(pe,k,ee){gf(pe,ge=>{ge.call(e,k,ee,jl)})}const Z_=function(k){let ee=null;if(Ho(G.beforeSanitizeElements,k,null),Hw(k))return zi(k),!0;const ge=wn(k.nodeName);if(Ho(G.uponSanitizeElement,k,{tagName:ge,allowedTags:ut}),I&&k.hasChildNodes()&&!X_(k.firstElementChild)&&Fn(/<[/\w!]/g,k.innerHTML)&&Fn(/<[/\w!]/g,k.textContent)||k.nodeType===Lc.progressingInstruction||I&&k.nodeType===Lc.comment&&Fn(/<[/\w]/g,k.data))return zi(k),!0;if(!ut[ge]||D[ge]){if(!D[ge]&&Q_(ge)&&(b.tagNameCheck instanceof RegExp&&Fn(b.tagNameCheck,ge)||b.tagNameCheck instanceof Function&&b.tagNameCheck(ge)))return!1;if(le&&!Be[ge]){const Mt=T(k)||k.parentNode,Tn=v(k)||k.childNodes;if(Tn&&Mt){const hn=Tn.length;for(let tr=hn-1;tr>=0;--tr){const No=w(Tn[tr],!0);No.__removalCount=(k.__removalCount||0)+1,Mt.insertBefore(No,S(k))}}}return zi(k),!0}return k instanceof l&&!GV(k)||(ge==="noscript"||ge==="noembed"||ge==="noframes")&&Fn(/<\/no(script|embed|frames)/i,k.innerHTML)?(zi(k),!0):(E&&k.nodeType===Lc.text&&(ee=k.textContent,gf([J,ae,te],Mt=>{ee=Nc(ee,Mt," ")}),k.textContent!==ee&&(Hc(e.removed,{element:k.cloneNode()}),k.textContent=ee)),Ho(G.afterSanitizeElements,k,null),!1)},J_=function(k,ee,ge){if(U&&(ee==="id"||ee==="name")&&(ge in n||ge in YV))return!1;if(!(K&&!F[ee]&&Fn(ne,ee))){if(!(j&&Fn(Fe,ee))){if(!m[ee]||F[ee]){if(!(Q_(k)&&(b.tagNameCheck instanceof RegExp&&Fn(b.tagNameCheck,k)||b.tagNameCheck instanceof Function&&b.tagNameCheck(k))&&(b.attributeNameCheck instanceof RegExp&&Fn(b.attributeNameCheck,ee)||b.attributeNameCheck instanceof Function&&b.attributeNameCheck(ee))||ee==="is"&&b.allowCustomizedBuiltInElements&&(b.tagNameCheck instanceof RegExp&&Fn(b.tagNameCheck,ge)||b.tagNameCheck instanceof Function&&b.tagNameCheck(ge))))return!1}else if(!er[ee]){if(!Fn(ot,Nc(ge,Ve,""))){if(!((ee==="src"||ee==="xlink:href"||ee==="href")&&k!=="script"&&Ij(ge,"data:")===0&&Se[k])){if(!(y&&!Fn(ke,Nc(ge,Ve,"")))){if(ge)return!1}}}}}}return!0},Q_=function(k){return k!=="annotation-xml"&&RO(k,yt)},eM=function(k){Ho(G.beforeSanitizeAttributes,k,null);const{attributes:ee}=k;if(!ee||Hw(k))return;const ge={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:m,forceKeepAttr:void 0};let Mt=ee.length;for(;Mt--;){const Tn=ee[Mt],{name:hn,namespaceURI:tr,value:No}=Tn,xc=wn(hn),Nw=No;let _n=hn==="value"?Nw:Pj(Nw);if(ge.attrName=xc,ge.attrValue=_n,ge.keepAttr=!0,ge.forceKeepAttr=void 0,Ho(G.uponSanitizeAttribute,k,ge),_n=ge.attrValue,q&&(xc==="id"||xc==="name")&&(Ul(hn,k),_n=se+_n),I&&Fn(/((--!?|])>)|<\/(style|title)/i,_n)){Ul(hn,k);continue}if(ge.forceKeepAttr)continue;if(!ge.keepAttr){Ul(hn,k);continue}if(!R&&Fn(/\/>/i,_n)){Ul(hn,k);continue}E&&gf([J,ae,te],nM=>{_n=Nc(_n,nM," ")});const tM=wn(k.nodeName);if(!J_(tM,xc,_n)){Ul(hn,k);continue}if(P&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!tr)switch(f.getAttributeType(tM,xc)){case"TrustedHTML":{_n=P.createHTML(_n);break}case"TrustedScriptURL":{_n=P.createScriptURL(_n);break}}if(_n!==Nw)try{tr?k.setAttributeNS(tr,hn,_n):k.setAttribute(hn,_n),Hw(k)?zi(k):SO(e.removed)}catch{Ul(hn,k)}}Ho(G.afterSanitizeAttributes,k,null)},qV=function pe(k){let ee=null;const ge=K_(k);for(Ho(G.beforeSanitizeShadowDOM,k,null);ee=ge.nextNode();)Ho(G.uponSanitizeShadowNode,ee,null),Z_(ee),eM(ee),ee.content instanceof o&&pe(ee.content);Ho(G.afterSanitizeShadowDOM,k,null)};return e.sanitize=function(pe){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ee=null,ge=null,Mt=null,Tn=null;if(wt=!pe,wt&&(pe="<!-->"),typeof pe!="string"&&!X_(pe))if(typeof pe.toString=="function"){if(pe=pe.toString(),typeof pe!="string")throw Dc("dirty is not a string, aborting")}else throw Dc("toString is not a function");if(!e.isSupported)return pe;if(L||Aw(k),e.removed=[],typeof pe=="string"&&(Re=!1),Re){if(pe.nodeName){const No=wn(pe.nodeName);if(!ut[No]||D[No])throw Dc("root node is forbidden and cannot be sanitized in-place")}}else if(pe instanceof a)ee=q_("<!---->"),ge=ee.ownerDocument.importNode(pe,!0),ge.nodeType===Lc.element&&ge.nodeName==="BODY"||ge.nodeName==="HTML"?ee=ge:ee.appendChild(ge);else{if(!N&&!E&&!A&&pe.indexOf("<")===-1)return P&&W?P.createHTML(pe):pe;if(ee=q_(pe),!ee)return N?null:W?x:""}ee&&B&&zi(ee.firstChild);const hn=K_(Re?pe:ee);for(;Mt=hn.nextNode();)Z_(Mt),eM(Mt),Mt.content instanceof o&&qV(Mt.content);if(Re)return pe;if(N){if($)for(Tn=V.call(ee.ownerDocument);ee.firstChild;)Tn.appendChild(ee.firstChild);else Tn=ee;return(m.shadowroot||m.shadowrootmode)&&(Tn=O.call(r,Tn,!0)),Tn}let tr=A?ee.outerHTML:ee.innerHTML;return A&&ut["!doctype"]&&ee.ownerDocument&&ee.ownerDocument.doctype&&ee.ownerDocument.doctype.name&&Fn(vD,ee.ownerDocument.doctype.name)&&(tr="<!DOCTYPE "+ee.ownerDocument.doctype.name+`>
`+tr),E&&gf([J,ae,te],No=>{tr=Nc(tr,No," ")}),P&&W?P.createHTML(tr):tr},e.setConfig=function(){let pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Aw(pe),L=!0},e.clearConfig=function(){jl=null,L=!1},e.isValidAttribute=function(pe,k,ee){jl||Aw({});const ge=wn(pe),Mt=wn(k);return J_(ge,Mt,ee)},e.addHook=function(pe,k){typeof k=="function"&&Hc(G[pe],k)},e.removeHook=function(pe,k){if(k!==void 0){const ee=_j(G[pe],k);return ee===-1?void 0:Mj(G[pe],ee,1)[0]}return SO(G[pe])},e.removeHooks=function(pe){G[pe]=[]},e.removeAllHooks=function(){G=PO()},e}var Uj=CD();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var yD;function Z(){return yD.apply(null,arguments)}function zj(t){yD=t}function Li(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Cl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function et(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function mE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(et(t,e))return!1;return!0}function cr(t){return t===void 0}function gs(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Ud(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function bD(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Js(t,e){for(var n in e)et(e,n)&&(t[n]=e[n]);return et(e,"toString")&&(t.toString=e.toString),et(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Po(t,e,n,r){return UD(t,e,n,r,!0).utc()}function Yj(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Oe(t){return t._pf==null&&(t._pf=Yj()),t._pf}var GS;Array.prototype.some?GS=Array.prototype.some:GS=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function pE(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Oe(t),n=GS.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function Ap(t){var e=Po(NaN);return t!=null?Js(Oe(e),t):Oe(e).userInvalidated=!0,e}var OO=Z.momentProperties=[],hy=!1;function wE(t,e){var n,r,i,o=OO.length;if(cr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),cr(e._i)||(t._i=e._i),cr(e._f)||(t._f=e._f),cr(e._l)||(t._l=e._l),cr(e._strict)||(t._strict=e._strict),cr(e._tzm)||(t._tzm=e._tzm),cr(e._isUTC)||(t._isUTC=e._isUTC),cr(e._offset)||(t._offset=e._offset),cr(e._pf)||(t._pf=Oe(e)),cr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=OO[n],i=e[r],cr(i)||(t[r]=i);return t}function zd(t){wE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),hy===!1&&(hy=!0,Z.updateOffset(this),hy=!1)}function $i(t){return t instanceof zd||t!=null&&t._isAMomentObject!=null}function SD(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function hi(t,e){var n=!0;return Js(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])et(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}SD(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var xO={};function RD(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),xO[t]||(SD(e),xO[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function Oo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function Gj(t){var e,n;for(n in t)et(t,n)&&(e=t[n],Oo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function qS(t,e){var n=Js({},t),r;for(r in e)et(e,r)&&(Cl(t[r])&&Cl(e[r])?(n[r]={},Js(n[r],t[r]),Js(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)et(t,r)&&!et(e,r)&&Cl(t[r])&&(n[r]=Js({},n[r]));return n}function vE(t){t!=null&&this.set(t)}var KS;Object.keys?KS=Object.keys:KS=function(t){var e,n=[];for(e in t)et(t,e)&&n.push(e);return n};var qj={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Kj(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Oo(r)?r.call(e,n):r}function To(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var CE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,pf=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,dy={},Gu={};function ve(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Gu[t]=i),e&&(Gu[e[0]]=function(){return To(i.apply(this,arguments),e[1],e[2])}),n&&(Gu[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function Xj(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Zj(t){var e=t.match(CE),n,r;for(n=0,r=e.length;n<r;n++)Gu[e[n]]?e[n]=Gu[e[n]]:e[n]=Xj(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Oo(e[s])?e[s].call(i,t):e[s];return o}}function Qg(t,e){return t.isValid()?(e=ED(e,t.localeData()),dy[e]=dy[e]||Zj(e),dy[e](t)):t.localeData().invalidDate()}function ED(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(pf.lastIndex=0;n>=0&&pf.test(t);)t=t.replace(pf,r),pf.lastIndex=0,n-=1;return t}var Jj={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Qj(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(CE).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var eU="Invalid date";function tU(){return this._invalidDate}var nU="%d",rU=/\d{1,2}/;function iU(t){return this._ordinal.replace("%d",t)}var oU={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function sU(t,e,n,r){var i=this._relativeTime[n];return Oo(i)?i(t,e,n,r):i.replace(/%d/i,t)}function aU(t,e){var n=this._relativeTime[t>0?"future":"past"];return Oo(n)?n(e):n.replace(/%s/i,e)}var AO={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function di(t){return typeof t=="string"?AO[t]||AO[t.toLowerCase()]:void 0}function yE(t){var e={},n,r;for(r in t)et(t,r)&&(n=di(r),n&&(e[n]=t[r]));return e}var lU={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function uU(t){var e=[],n;for(n in t)et(t,n)&&e.push({unit:n,priority:lU[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var TD=/\d/,Wr=/\d\d/,_D=/\d{3}/,bE=/\d{4}/,Hp=/[+-]?\d{6}/,Tt=/\d\d?/,MD=/\d\d\d\d?/,ID=/\d\d\d\d\d\d?/,Np=/\d{1,3}/,SE=/\d{1,4}/,Dp=/[+-]?\d{1,6}/,wc=/\d+/,kp=/[+-]?\d+/,cU=/Z|[+-]\d\d:?\d\d/gi,Lp=/Z|[+-]\d\d(?::?\d\d)?/gi,hU=/[+-]?\d+(\.\d{1,3})?/,Yd=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,vc=/^[1-9]\d?/,RE=/^([1-9]\d|\d)/,_m;_m={};function ce(t,e,n){_m[t]=Oo(e)?e:function(r,i){return r&&n?n:e}}function dU(t,e){return et(_m,t)?_m[t](e._strict,e._locale):new RegExp(fU(t))}function fU(t){return hs(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function hs(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ri(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Ue(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=ri(e)),n}var XS={};function gt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),gs(e)&&(r=function(o,s){s[e]=Ue(o)}),i=t.length,n=0;n<i;n++)XS[t[n]]=r}function Gd(t,e){gt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function gU(t,e,n){e!=null&&et(XS,t)&&XS[t](e,n._a,n,t)}function $p(t){return t%4===0&&t%100!==0||t%400===0}var Ln=0,is=1,vo=2,mn=3,Ni=4,os=5,cl=6,mU=7,pU=8;ve("Y",0,0,function(){var t=this.year();return t<=9999?To(t,4):"+"+t});ve(0,["YY",2],0,function(){return this.year()%100});ve(0,["YYYY",4],0,"year");ve(0,["YYYYY",5],0,"year");ve(0,["YYYYYY",6,!0],0,"year");ce("Y",kp);ce("YY",Tt,Wr);ce("YYYY",SE,bE);ce("YYYYY",Dp,Hp);ce("YYYYYY",Dp,Hp);gt(["YYYYY","YYYYYY"],Ln);gt("YYYY",function(t,e){e[Ln]=t.length===2?Z.parseTwoDigitYear(t):Ue(t)});gt("YY",function(t,e){e[Ln]=Z.parseTwoDigitYear(t)});gt("Y",function(t,e){e[Ln]=parseInt(t,10)});function Uh(t){return $p(t)?366:365}Z.parseTwoDigitYear=function(t){return Ue(t)+(Ue(t)>68?1900:2e3)};var PD=Cc("FullYear",!0);function wU(){return $p(this.year())}function Cc(t,e){return function(n){return n!=null?(OD(this,t,n),Z.updateOffset(this,e),this):md(this,t)}}function md(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function OD(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!$p(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function vU(t){return t=di(t),Oo(this[t])?this[t]():this}function CU(t,e){if(typeof t=="object"){t=yE(t);var n=uU(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=di(t),Oo(this[t]))return this[t](e);return this}function yU(t,e){return(t%e+e)%e}var Gt;Array.prototype.indexOf?Gt=Array.prototype.indexOf:Gt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function EE(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=yU(e,12);return t+=(e-n)/12,n===1?$p(t)?29:28:31-n%7%2}ve("M",["MM",2],"Mo",function(){return this.month()+1});ve("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});ve("MMMM",0,0,function(t){return this.localeData().months(this,t)});ce("M",Tt,vc);ce("MM",Tt,Wr);ce("MMM",function(t,e){return e.monthsShortRegex(t)});ce("MMMM",function(t,e){return e.monthsRegex(t)});gt(["M","MM"],function(t,e){e[is]=Ue(t)-1});gt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[is]=i:Oe(n).invalidMonth=t});var bU="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),xD="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),AD=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,SU=Yd,RU=Yd;function EU(t,e){return t?Li(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||AD).test(e)?"format":"standalone"][t.month()]:Li(this._months)?this._months:this._months.standalone}function TU(t,e){return t?Li(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[AD.test(e)?"format":"standalone"][t.month()]:Li(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function _U(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Po([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Gt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Gt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Gt.call(this._shortMonthsParse,s),i!==-1?i:(i=Gt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Gt.call(this._longMonthsParse,s),i!==-1?i:(i=Gt.call(this._shortMonthsParse,s),i!==-1?i:null))}function MU(t,e,n){var r,i,o;if(this._monthsParseExact)return _U.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Po([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function HD(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ue(e);else if(e=t.localeData().monthsParse(e),!gs(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,EE(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function ND(t){return t!=null?(HD(this,t),Z.updateOffset(this,!0),this):md(this,"Month")}function IU(){return EE(this.year(),this.month())}function PU(t){return this._monthsParseExact?(et(this,"_monthsRegex")||DD.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(et(this,"_monthsShortRegex")||(this._monthsShortRegex=SU),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function OU(t){return this._monthsParseExact?(et(this,"_monthsRegex")||DD.call(this),t?this._monthsStrictRegex:this._monthsRegex):(et(this,"_monthsRegex")||(this._monthsRegex=RU),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function DD(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=Po([2e3,i]),s=hs(this.monthsShort(o,"")),a=hs(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function xU(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function pd(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Mm(t,e,n){var r=7+e-n,i=(7+pd(t,0,r).getUTCDay()-e)%7;return-i+r-1}function kD(t,e,n,r,i){var o=(7+n-r)%7,s=Mm(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Uh(l)+a):a>Uh(t)?(l=t+1,u=a-Uh(t)):(l=t,u=a),{year:l,dayOfYear:u}}function wd(t,e,n){var r=Mm(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+ds(s,e,n)):i>ds(t.year(),e,n)?(o=i-ds(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function ds(t,e,n){var r=Mm(t,e,n),i=Mm(t+1,e,n);return(Uh(t)-r+i)/7}ve("w",["ww",2],"wo","week");ve("W",["WW",2],"Wo","isoWeek");ce("w",Tt,vc);ce("ww",Tt,Wr);ce("W",Tt,vc);ce("WW",Tt,Wr);Gd(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Ue(t)});function AU(t){return wd(t,this._week.dow,this._week.doy).week}var HU={dow:0,doy:6};function NU(){return this._week.dow}function DU(){return this._week.doy}function kU(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function LU(t){var e=wd(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}ve("d",0,"do","day");ve("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});ve("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});ve("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});ve("e",0,0,"weekday");ve("E",0,0,"isoWeekday");ce("d",Tt);ce("e",Tt);ce("E",Tt);ce("dd",function(t,e){return e.weekdaysMinRegex(t)});ce("ddd",function(t,e){return e.weekdaysShortRegex(t)});ce("dddd",function(t,e){return e.weekdaysRegex(t)});Gd(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Oe(n).invalidWeekday=t});Gd(["d","e","E"],function(t,e,n,r){e[r]=Ue(t)});function $U(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function FU(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function TE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var VU="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),LD="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),WU="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),BU=Yd,jU=Yd,UU=Yd;function zU(t,e){var n=Li(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?TE(n,this._week.dow):t?n[t.day()]:n}function YU(t){return t===!0?TE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function GU(t){return t===!0?TE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function qU(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Po([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Gt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Gt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Gt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Gt.call(this._weekdaysParse,s),i!==-1||(i=Gt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Gt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Gt.call(this._shortWeekdaysParse,s),i!==-1||(i=Gt.call(this._weekdaysParse,s),i!==-1)?i:(i=Gt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Gt.call(this._minWeekdaysParse,s),i!==-1||(i=Gt.call(this._weekdaysParse,s),i!==-1)?i:(i=Gt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function KU(t,e,n){var r,i,o;if(this._weekdaysParseExact)return qU.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Po([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function XU(t){if(!this.isValid())return t!=null?this:NaN;var e=md(this,"Day");return t!=null?(t=$U(t,this.localeData()),this.add(t-e,"d")):e}function ZU(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function JU(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=FU(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function QU(t){return this._weekdaysParseExact?(et(this,"_weekdaysRegex")||_E.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(et(this,"_weekdaysRegex")||(this._weekdaysRegex=BU),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function ez(t){return this._weekdaysParseExact?(et(this,"_weekdaysRegex")||_E.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(et(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=jU),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function tz(t){return this._weekdaysParseExact?(et(this,"_weekdaysRegex")||_E.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(et(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=UU),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function _E(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Po([2e3,1]).day(o),a=hs(this.weekdaysMin(s,"")),l=hs(this.weekdaysShort(s,"")),u=hs(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function ME(){return this.hours()%12||12}function nz(){return this.hours()||24}ve("H",["HH",2],0,"hour");ve("h",["hh",2],0,ME);ve("k",["kk",2],0,nz);ve("hmm",0,0,function(){return""+ME.apply(this)+To(this.minutes(),2)});ve("hmmss",0,0,function(){return""+ME.apply(this)+To(this.minutes(),2)+To(this.seconds(),2)});ve("Hmm",0,0,function(){return""+this.hours()+To(this.minutes(),2)});ve("Hmmss",0,0,function(){return""+this.hours()+To(this.minutes(),2)+To(this.seconds(),2)});function $D(t,e){ve(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}$D("a",!0);$D("A",!1);function FD(t,e){return e._meridiemParse}ce("a",FD);ce("A",FD);ce("H",Tt,RE);ce("h",Tt,vc);ce("k",Tt,vc);ce("HH",Tt,Wr);ce("hh",Tt,Wr);ce("kk",Tt,Wr);ce("hmm",MD);ce("hmmss",ID);ce("Hmm",MD);ce("Hmmss",ID);gt(["H","HH"],mn);gt(["k","kk"],function(t,e,n){var r=Ue(t);e[mn]=r===24?0:r});gt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});gt(["h","hh"],function(t,e,n){e[mn]=Ue(t),Oe(n).bigHour=!0});gt("hmm",function(t,e,n){var r=t.length-2;e[mn]=Ue(t.substr(0,r)),e[Ni]=Ue(t.substr(r)),Oe(n).bigHour=!0});gt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[mn]=Ue(t.substr(0,r)),e[Ni]=Ue(t.substr(r,2)),e[os]=Ue(t.substr(i)),Oe(n).bigHour=!0});gt("Hmm",function(t,e,n){var r=t.length-2;e[mn]=Ue(t.substr(0,r)),e[Ni]=Ue(t.substr(r))});gt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[mn]=Ue(t.substr(0,r)),e[Ni]=Ue(t.substr(r,2)),e[os]=Ue(t.substr(i))});function rz(t){return(t+"").toLowerCase().charAt(0)==="p"}var iz=/[ap]\.?m?\.?/i,oz=Cc("Hours",!0);function sz(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var VD={calendar:qj,longDateFormat:Jj,invalidDate:eU,ordinal:nU,dayOfMonthOrdinalParse:rU,relativeTime:oU,months:bU,monthsShort:xD,week:HU,weekdays:VU,weekdaysMin:WU,weekdaysShort:LD,meridiemParse:iz},It={},$c={},vd;function az(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function HO(t){return t&&t.toLowerCase().replace("_","-")}function lz(t){for(var e=0,n,r,i,o;e<t.length;){for(o=HO(t[e]).split("-"),n=o.length,r=HO(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Fp(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&az(o,r)>=n-1)break;n--}e++}return vd}function uz(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Fp(t){var e=null,n;if(It[t]===void 0&&typeof module<"u"&&module&&module.exports&&uz(t))try{e=vd._abbr,n=require,n("./locale/"+t),sa(e)}catch{It[t]=null}return It[t]}function sa(t,e){var n;return t&&(cr(e)?n=ys(t):n=IE(t,e),n?vd=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),vd._abbr}function IE(t,e){if(e!==null){var n,r=VD;if(e.abbr=t,It[t]!=null)RD("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=It[t]._config;else if(e.parentLocale!=null)if(It[e.parentLocale]!=null)r=It[e.parentLocale]._config;else if(n=Fp(e.parentLocale),n!=null)r=n._config;else return $c[e.parentLocale]||($c[e.parentLocale]=[]),$c[e.parentLocale].push({name:t,config:e}),null;return It[t]=new vE(qS(r,e)),$c[t]&&$c[t].forEach(function(i){IE(i.name,i.config)}),sa(t),It[t]}else return delete It[t],null}function cz(t,e){if(e!=null){var n,r,i=VD;It[t]!=null&&It[t].parentLocale!=null?It[t].set(qS(It[t]._config,e)):(r=Fp(t),r!=null&&(i=r._config),e=qS(i,e),r==null&&(e.abbr=t),n=new vE(e),n.parentLocale=It[t],It[t]=n),sa(t)}else It[t]!=null&&(It[t].parentLocale!=null?(It[t]=It[t].parentLocale,t===sa()&&sa(t)):It[t]!=null&&delete It[t]);return It[t]}function ys(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return vd;if(!Li(t)){if(e=Fp(t),e)return e;t=[t]}return lz(t)}function hz(){return KS(It)}function PE(t){var e,n=t._a;return n&&Oe(t).overflow===-2&&(e=n[is]<0||n[is]>11?is:n[vo]<1||n[vo]>EE(n[Ln],n[is])?vo:n[mn]<0||n[mn]>24||n[mn]===24&&(n[Ni]!==0||n[os]!==0||n[cl]!==0)?mn:n[Ni]<0||n[Ni]>59?Ni:n[os]<0||n[os]>59?os:n[cl]<0||n[cl]>999?cl:-1,Oe(t)._overflowDayOfYear&&(e<Ln||e>vo)&&(e=vo),Oe(t)._overflowWeeks&&e===-1&&(e=mU),Oe(t)._overflowWeekday&&e===-1&&(e=pU),Oe(t).overflow=e),t}var dz=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,fz=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gz=/Z|[+-]\d\d(?::?\d\d)?/,wf=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],fy=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],mz=/^\/?Date\((-?\d+)/i,pz=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,wz={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function WD(t){var e,n,r=t._i,i=dz.exec(r)||fz.exec(r),o,s,a,l,u=wf.length,c=fy.length;if(i){for(Oe(t).iso=!0,e=0,n=u;e<n;e++)if(wf[e][1].exec(i[1])){s=wf[e][0],o=wf[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(fy[e][1].exec(i[3])){a=(i[2]||" ")+fy[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(gz.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),xE(t)}else t._isValid=!1}function vz(t,e,n,r,i,o){var s=[Cz(t),xD.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function Cz(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function yz(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function bz(t,e,n){if(t){var r=LD.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Oe(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function Sz(t,e,n){if(t)return wz[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function BD(t){var e=pz.exec(yz(t._i)),n;if(e){if(n=vz(e[4],e[3],e[2],e[5],e[6],e[7]),!bz(e[1],n,t))return;t._a=n,t._tzm=Sz(e[8],e[9],e[10]),t._d=pd.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Oe(t).rfc2822=!0}else t._isValid=!1}function Rz(t){var e=mz.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(WD(t),t._isValid===!1)delete t._isValid;else return;if(BD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=hi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function xu(t,e,n){return t??e??n}function Ez(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function OE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=Ez(t),t._w&&t._a[vo]==null&&t._a[is]==null&&Tz(t),t._dayOfYear!=null&&(s=xu(t._a[Ln],i[Ln]),(t._dayOfYear>Uh(s)||t._dayOfYear===0)&&(Oe(t)._overflowDayOfYear=!0),n=pd(s,0,t._dayOfYear),t._a[is]=n.getUTCMonth(),t._a[vo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[mn]===24&&t._a[Ni]===0&&t._a[os]===0&&t._a[cl]===0&&(t._nextDay=!0,t._a[mn]=0),t._d=(t._useUTC?pd:xU).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[mn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Oe(t).weekdayMismatch=!0)}}function Tz(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=xu(e.GG,t._a[Ln],wd(Et(),1,4).year),r=xu(e.W,1),i=xu(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=wd(Et(),o,s),n=xu(e.gg,t._a[Ln],u.year),r=xu(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>ds(n,o,s)?Oe(t)._overflowWeeks=!0:l!=null?Oe(t)._overflowWeekday=!0:(a=kD(n,r,i,o,s),t._a[Ln]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function xE(t){if(t._f===Z.ISO_8601){WD(t);return}if(t._f===Z.RFC_2822){BD(t);return}t._a=[],Oe(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=ED(t._f,t._locale).match(CE)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(dU(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Oe(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Gu[o]?(r?Oe(t).empty=!1:Oe(t).unusedTokens.push(o),gU(o,r,t)):t._strict&&!r&&Oe(t).unusedTokens.push(o);Oe(t).charsLeftOver=a-l,e.length>0&&Oe(t).unusedInput.push(e),t._a[mn]<=12&&Oe(t).bigHour===!0&&t._a[mn]>0&&(Oe(t).bigHour=void 0),Oe(t).parsedDateParts=t._a.slice(0),Oe(t).meridiem=t._meridiem,t._a[mn]=_z(t._locale,t._a[mn],t._meridiem),u=Oe(t).era,u!==null&&(t._a[Ln]=t._locale.erasConvertYear(u,t._a[Ln])),OE(t),PE(t)}function _z(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function Mz(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Oe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=wE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],xE(e),pE(e)&&(s=!0),o+=Oe(e).charsLeftOver,o+=Oe(e).unusedTokens.length*10,Oe(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Js(t,n||e)}function Iz(t){if(!t._d){var e=yE(t._i),n=e.day===void 0?e.date:e.day;t._a=bD([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),OE(t)}}function Pz(t){var e=new zd(PE(jD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function jD(t){var e=t._i,n=t._f;return t._locale=t._locale||ys(t._l),e===null||n===void 0&&e===""?Ap({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),$i(e)?new zd(PE(e)):(Ud(e)?t._d=e:Li(n)?Mz(t):n?xE(t):Oz(t),pE(t)||(t._d=null),t))}function Oz(t){var e=t._i;cr(e)?t._d=new Date(Z.now()):Ud(e)?t._d=new Date(e.valueOf()):typeof e=="string"?Rz(t):Li(e)?(t._a=bD(e.slice(0),function(n){return parseInt(n,10)}),OE(t)):Cl(e)?Iz(t):gs(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function UD(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Cl(t)&&mE(t)||Li(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,Pz(o)}function Et(t,e,n,r){return UD(t,e,n,r,!1)}var xz=hi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Ap()}),Az=hi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Ap()});function zD(t,e){var n,r;if(e.length===1&&Li(e[0])&&(e=e[0]),!e.length)return Et();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function Hz(){var t=[].slice.call(arguments,0);return zD("isBefore",t)}function Nz(){var t=[].slice.call(arguments,0);return zD("isAfter",t)}var Dz=function(){return Date.now?Date.now():+new Date},Fc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function kz(t){var e,n=!1,r,i=Fc.length;for(e in t)if(et(t,e)&&!(Gt.call(Fc,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Fc[r]]){if(n)return!1;parseFloat(t[Fc[r]])!==Ue(t[Fc[r]])&&(n=!0)}return!0}function Lz(){return this._isValid}function $z(){return Bi(NaN)}function Vp(t){var e=yE(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=kz(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=ys(),this._bubble()}function em(t){return t instanceof Vp}function ZS(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Fz(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Ue(t[s])!==Ue(e[s])&&o++;return o+i}function YD(t,e){ve(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+To(~~(n/60),2)+e+To(~~n%60,2)})}YD("Z",":");YD("ZZ","");ce("Z",Lp);ce("ZZ",Lp);gt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=AE(Lp,t)});var Vz=/([\+\-]|\d\d)/gi;function AE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(Vz)||["-",0,0],o=+(i[1]*60)+Ue(i[2]),o===0?0:i[0]==="+"?o:-o)}function HE(t,e){var n,r;return e._isUTC?(n=e.clone(),r=($i(t)||Ud(t)?t.valueOf():Et(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Z.updateOffset(n,!1),n):Et(t).local()}function JS(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function Wz(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=AE(Lp,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=JS(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?KD(this,Bi(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:JS(this)}function Bz(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function jz(t){return this.utcOffset(0,t)}function Uz(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(JS(this),"m")),this}function zz(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=AE(cU,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Yz(t){return this.isValid()?(t=t?Et(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function Gz(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function qz(){if(!cr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return wE(t,this),t=jD(t),t._a?(e=t._isUTC?Po(t._a):Et(t._a),this._isDSTShifted=this.isValid()&&Fz(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Kz(){return this.isValid()?!this._isUTC:!1}function Xz(){return this.isValid()?this._isUTC:!1}function GD(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Zz=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Jz=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Bi(t,e){var n=t,r=null,i,o,s;return em(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:gs(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=Zz.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Ue(r[vo])*i,h:Ue(r[mn])*i,m:Ue(r[Ni])*i,s:Ue(r[os])*i,ms:Ue(ZS(r[cl]*1e3))*i}):(r=Jz.exec(t))?(i=r[1]==="-"?-1:1,n={y:ya(r[2],i),M:ya(r[3],i),w:ya(r[4],i),d:ya(r[5],i),h:ya(r[6],i),m:ya(r[7],i),s:ya(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=Qz(Et(n.from),Et(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Vp(n),em(t)&&et(t,"_locale")&&(o._locale=t._locale),em(t)&&et(t,"_isValid")&&(o._isValid=t._isValid),o}Bi.fn=Vp.prototype;Bi.invalid=$z;function ya(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function NO(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Qz(t,e){var n;return t.isValid()&&e.isValid()?(e=HE(e,t),t.isBefore(e)?n=NO(t,e):(n=NO(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function qD(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(RD(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=Bi(n,r),KD(this,i,t),this}}function KD(t,e,n,r){var i=e._milliseconds,o=ZS(e._days),s=ZS(e._months);t.isValid()&&(r=r??!0,s&&HD(t,md(t,"Month")+s*n),o&&OD(t,"Date",md(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Z.updateOffset(t,o||s))}var eY=qD(1,"add"),tY=qD(-1,"subtract");function XD(t){return typeof t=="string"||t instanceof String}function nY(t){return $i(t)||Ud(t)||XD(t)||gs(t)||iY(t)||rY(t)||t===null||t===void 0}function rY(t){var e=Cl(t)&&!mE(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||et(t,o);return e&&n}function iY(t){var e=Li(t),n=!1;return e&&(n=t.filter(function(r){return!gs(r)&&XD(t)}).length===0),e&&n}function oY(t){var e=Cl(t)&&!mE(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||et(t,o);return e&&n}function sY(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function aY(t,e){arguments.length===1&&(arguments[0]?nY(arguments[0])?(t=arguments[0],e=void 0):oY(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Et(),r=HE(n,this).startOf("day"),i=Z.calendarFormat(this,r)||"sameElse",o=e&&(Oo(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Et(n)))}function lY(){return new zd(this)}function uY(t,e){var n=$i(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=di(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function cY(t,e){var n=$i(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=di(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function hY(t,e,n,r){var i=$i(t)?t:Et(t),o=$i(e)?e:Et(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function dY(t,e){var n=$i(t)?t:Et(t),r;return this.isValid()&&n.isValid()?(e=di(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function fY(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function gY(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function mY(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=HE(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=di(e),e){case"year":o=tm(this,r)/12;break;case"month":o=tm(this,r);break;case"quarter":o=tm(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:ri(o)}function tm(t,e){if(t.date()<e.date())return-tm(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function pY(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function wY(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Qg(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Oo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Qg(n,"Z")):Qg(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function vY(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function CY(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=Qg(this,t);return this.localeData().postformat(e)}function yY(t,e){return this.isValid()&&($i(t)&&t.isValid()||Et(t).isValid())?Bi({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function bY(t){return this.from(Et(),t)}function SY(t,e){return this.isValid()&&($i(t)&&t.isValid()||Et(t).isValid())?Bi({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function RY(t){return this.to(Et(),t)}function ZD(t){var e;return t===void 0?this._locale._abbr:(e=ys(t),e!=null&&(this._locale=e),this)}var JD=hi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function QD(){return this._locale}var Im=1e3,qu=60*Im,Pm=60*qu,ek=(365*400+97)*24*Pm;function Ku(t,e){return(t%e+e)%e}function tk(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-ek:new Date(t,e,n).valueOf()}function nk(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-ek:Date.UTC(t,e,n)}function EY(t){var e,n;if(t=di(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?nk:tk,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Ku(e+(this._isUTC?0:this.utcOffset()*qu),Pm);break;case"minute":e=this._d.valueOf(),e-=Ku(e,qu);break;case"second":e=this._d.valueOf(),e-=Ku(e,Im);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function TY(t){var e,n;if(t=di(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?nk:tk,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Pm-Ku(e+(this._isUTC?0:this.utcOffset()*qu),Pm)-1;break;case"minute":e=this._d.valueOf(),e+=qu-Ku(e,qu)-1;break;case"second":e=this._d.valueOf(),e+=Im-Ku(e,Im)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function _Y(){return this._d.valueOf()-(this._offset||0)*6e4}function MY(){return Math.floor(this.valueOf()/1e3)}function IY(){return new Date(this.valueOf())}function PY(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function OY(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function xY(){return this.isValid()?this.toISOString():null}function AY(){return pE(this)}function HY(){return Js({},Oe(this))}function NY(){return Oe(this).overflow}function DY(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ve("N",0,0,"eraAbbr");ve("NN",0,0,"eraAbbr");ve("NNN",0,0,"eraAbbr");ve("NNNN",0,0,"eraName");ve("NNNNN",0,0,"eraNarrow");ve("y",["y",1],"yo","eraYear");ve("y",["yy",2],0,"eraYear");ve("y",["yyy",3],0,"eraYear");ve("y",["yyyy",4],0,"eraYear");ce("N",NE);ce("NN",NE);ce("NNN",NE);ce("NNNN",YY);ce("NNNNN",GY);gt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Oe(n).era=i:Oe(n).invalidEra=t});ce("y",wc);ce("yy",wc);ce("yyy",wc);ce("yyyy",wc);ce("yo",qY);gt(["y","yy","yyy","yyyy"],Ln);gt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Ln]=n._locale.eraYearOrdinalParse(t,i):e[Ln]=parseInt(t,10)});function kY(t,e){var n,r,i,o=this._eras||ys("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Z(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Z(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function LY(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function $Y(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function FY(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function VY(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function WY(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function BY(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Z(i[t].since).year())*n+i[t].offset;return this.year()}function jY(t){return et(this,"_erasNameRegex")||DE.call(this),t?this._erasNameRegex:this._erasRegex}function UY(t){return et(this,"_erasAbbrRegex")||DE.call(this),t?this._erasAbbrRegex:this._erasRegex}function zY(t){return et(this,"_erasNarrowRegex")||DE.call(this),t?this._erasNarrowRegex:this._erasRegex}function NE(t,e){return e.erasAbbrRegex(t)}function YY(t,e){return e.erasNameRegex(t)}function GY(t,e){return e.erasNarrowRegex(t)}function qY(t,e){return e._eraYearOrdinalRegex||wc}function DE(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=hs(u[i].name),a=hs(u[i].abbr),l=hs(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}ve(0,["gg",2],0,function(){return this.weekYear()%100});ve(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Wp(t,e){ve(0,[t,t.length],0,e)}Wp("gggg","weekYear");Wp("ggggg","weekYear");Wp("GGGG","isoWeekYear");Wp("GGGGG","isoWeekYear");ce("G",kp);ce("g",kp);ce("GG",Tt,Wr);ce("gg",Tt,Wr);ce("GGGG",SE,bE);ce("gggg",SE,bE);ce("GGGGG",Dp,Hp);ce("ggggg",Dp,Hp);Gd(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Ue(t)});Gd(["gg","GG"],function(t,e,n,r){e[r]=Z.parseTwoDigitYear(t)});function KY(t){return rk.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function XY(t){return rk.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function ZY(){return ds(this.year(),1,4)}function JY(){return ds(this.isoWeekYear(),1,4)}function QY(){var t=this.localeData()._week;return ds(this.year(),t.dow,t.doy)}function eG(){var t=this.localeData()._week;return ds(this.weekYear(),t.dow,t.doy)}function rk(t,e,n,r,i){var o;return t==null?wd(this,r,i).year:(o=ds(t,r,i),e>o&&(e=o),tG.call(this,t,e,n,r,i))}function tG(t,e,n,r,i){var o=kD(t,e,n,r,i),s=pd(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}ve("Q",0,"Qo","quarter");ce("Q",TD);gt("Q",function(t,e){e[is]=(Ue(t)-1)*3});function nG(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}ve("D",["DD",2],"Do","date");ce("D",Tt,vc);ce("DD",Tt,Wr);ce("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});gt(["D","DD"],vo);gt("Do",function(t,e){e[vo]=Ue(t.match(Tt)[0])});var ik=Cc("Date",!0);ve("DDD",["DDDD",3],"DDDo","dayOfYear");ce("DDD",Np);ce("DDDD",_D);gt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Ue(t)});function rG(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}ve("m",["mm",2],0,"minute");ce("m",Tt,RE);ce("mm",Tt,Wr);gt(["m","mm"],Ni);var iG=Cc("Minutes",!1);ve("s",["ss",2],0,"second");ce("s",Tt,RE);ce("ss",Tt,Wr);gt(["s","ss"],os);var oG=Cc("Seconds",!1);ve("S",0,0,function(){return~~(this.millisecond()/100)});ve(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ve(0,["SSS",3],0,"millisecond");ve(0,["SSSS",4],0,function(){return this.millisecond()*10});ve(0,["SSSSS",5],0,function(){return this.millisecond()*100});ve(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ve(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ve(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ve(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ce("S",Np,TD);ce("SS",Np,Wr);ce("SSS",Np,_D);var Qs,ok;for(Qs="SSSS";Qs.length<=9;Qs+="S")ce(Qs,wc);function sG(t,e){e[cl]=Ue(("0."+t)*1e3)}for(Qs="S";Qs.length<=9;Qs+="S")gt(Qs,sG);ok=Cc("Milliseconds",!1);ve("z",0,0,"zoneAbbr");ve("zz",0,0,"zoneName");function aG(){return this._isUTC?"UTC":""}function lG(){return this._isUTC?"Coordinated Universal Time":""}var Q=zd.prototype;Q.add=eY;Q.calendar=aY;Q.clone=lY;Q.diff=mY;Q.endOf=TY;Q.format=CY;Q.from=yY;Q.fromNow=bY;Q.to=SY;Q.toNow=RY;Q.get=vU;Q.invalidAt=NY;Q.isAfter=uY;Q.isBefore=cY;Q.isBetween=hY;Q.isSame=dY;Q.isSameOrAfter=fY;Q.isSameOrBefore=gY;Q.isValid=AY;Q.lang=JD;Q.locale=ZD;Q.localeData=QD;Q.max=Az;Q.min=xz;Q.parsingFlags=HY;Q.set=CU;Q.startOf=EY;Q.subtract=tY;Q.toArray=PY;Q.toObject=OY;Q.toDate=IY;Q.toISOString=wY;Q.inspect=vY;typeof Symbol<"u"&&Symbol.for!=null&&(Q[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Q.toJSON=xY;Q.toString=pY;Q.unix=MY;Q.valueOf=_Y;Q.creationData=DY;Q.eraName=FY;Q.eraNarrow=VY;Q.eraAbbr=WY;Q.eraYear=BY;Q.year=PD;Q.isLeapYear=wU;Q.weekYear=KY;Q.isoWeekYear=XY;Q.quarter=Q.quarters=nG;Q.month=ND;Q.daysInMonth=IU;Q.week=Q.weeks=kU;Q.isoWeek=Q.isoWeeks=LU;Q.weeksInYear=QY;Q.weeksInWeekYear=eG;Q.isoWeeksInYear=ZY;Q.isoWeeksInISOWeekYear=JY;Q.date=ik;Q.day=Q.days=XU;Q.weekday=ZU;Q.isoWeekday=JU;Q.dayOfYear=rG;Q.hour=Q.hours=oz;Q.minute=Q.minutes=iG;Q.second=Q.seconds=oG;Q.millisecond=Q.milliseconds=ok;Q.utcOffset=Wz;Q.utc=jz;Q.local=Uz;Q.parseZone=zz;Q.hasAlignedHourOffset=Yz;Q.isDST=Gz;Q.isLocal=Kz;Q.isUtcOffset=Xz;Q.isUtc=GD;Q.isUTC=GD;Q.zoneAbbr=aG;Q.zoneName=lG;Q.dates=hi("dates accessor is deprecated. Use date instead.",ik);Q.months=hi("months accessor is deprecated. Use month instead",ND);Q.years=hi("years accessor is deprecated. Use year instead",PD);Q.zone=hi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Bz);Q.isDSTShifted=hi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",qz);function uG(t){return Et(t*1e3)}function cG(){return Et.apply(null,arguments).parseZone()}function sk(t){return t}var tt=vE.prototype;tt.calendar=Kj;tt.longDateFormat=Qj;tt.invalidDate=tU;tt.ordinal=iU;tt.preparse=sk;tt.postformat=sk;tt.relativeTime=sU;tt.pastFuture=aU;tt.set=Gj;tt.eras=kY;tt.erasParse=LY;tt.erasConvertYear=$Y;tt.erasAbbrRegex=UY;tt.erasNameRegex=jY;tt.erasNarrowRegex=zY;tt.months=EU;tt.monthsShort=TU;tt.monthsParse=MU;tt.monthsRegex=OU;tt.monthsShortRegex=PU;tt.week=AU;tt.firstDayOfYear=DU;tt.firstDayOfWeek=NU;tt.weekdays=zU;tt.weekdaysMin=GU;tt.weekdaysShort=YU;tt.weekdaysParse=KU;tt.weekdaysRegex=QU;tt.weekdaysShortRegex=ez;tt.weekdaysMinRegex=tz;tt.isPM=rz;tt.meridiem=sz;function Om(t,e,n,r){var i=ys(),o=Po().set(r,e);return i[n](o,t)}function ak(t,e,n){if(gs(t)&&(e=t,t=void 0),t=t||"",e!=null)return Om(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Om(t,r,n,"month");return i}function kE(t,e,n,r){typeof t=="boolean"?(gs(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,gs(e)&&(n=e,e=void 0),e=e||"");var i=ys(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Om(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Om(e,(s+o)%7,r,"day");return a}function hG(t,e){return ak(t,e,"months")}function dG(t,e){return ak(t,e,"monthsShort")}function fG(t,e,n){return kE(t,e,n,"weekdays")}function gG(t,e,n){return kE(t,e,n,"weekdaysShort")}function mG(t,e,n){return kE(t,e,n,"weekdaysMin")}sa("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Ue(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=hi("moment.lang is deprecated. Use moment.locale instead.",sa);Z.langData=hi("moment.langData is deprecated. Use moment.localeData instead.",ys);var Do=Math.abs;function pG(){var t=this._data;return this._milliseconds=Do(this._milliseconds),this._days=Do(this._days),this._months=Do(this._months),t.milliseconds=Do(t.milliseconds),t.seconds=Do(t.seconds),t.minutes=Do(t.minutes),t.hours=Do(t.hours),t.months=Do(t.months),t.years=Do(t.years),this}function lk(t,e,n,r){var i=Bi(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function wG(t,e){return lk(this,t,e,1)}function vG(t,e){return lk(this,t,e,-1)}function DO(t){return t<0?Math.floor(t):Math.ceil(t)}function CG(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=DO(QS(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=ri(t/1e3),r.seconds=i%60,o=ri(i/60),r.minutes=o%60,s=ri(o/60),r.hours=s%24,e+=ri(s/24),l=ri(uk(e)),n+=l,e-=DO(QS(l)),a=ri(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function uk(t){return t*4800/146097}function QS(t){return t*146097/4800}function yG(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=di(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+uk(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(QS(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function bs(t){return function(){return this.as(t)}}var ck=bs("ms"),bG=bs("s"),SG=bs("m"),RG=bs("h"),EG=bs("d"),TG=bs("w"),_G=bs("M"),MG=bs("Q"),IG=bs("y"),PG=ck;function OG(){return Bi(this)}function xG(t){return t=di(t),this.isValid()?this[t+"s"]():NaN}function Fl(t){return function(){return this.isValid()?this._data[t]:NaN}}var AG=Fl("milliseconds"),HG=Fl("seconds"),NG=Fl("minutes"),DG=Fl("hours"),kG=Fl("days"),LG=Fl("months"),$G=Fl("years");function FG(){return ri(this.days()/7)}var Qo=Math.round,Wu={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function VG(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function WG(t,e,n,r){var i=Bi(t).abs(),o=Qo(i.as("s")),s=Qo(i.as("m")),a=Qo(i.as("h")),l=Qo(i.as("d")),u=Qo(i.as("M")),c=Qo(i.as("w")),h=Qo(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,VG.apply(null,d)}function BG(t){return t===void 0?Qo:typeof t=="function"?(Qo=t,!0):!1}function jG(t,e){return Wu[t]===void 0?!1:e===void 0?Wu[t]:(Wu[t]=e,t==="s"&&(Wu.ss=e-1),!0)}function UG(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Wu,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Wu,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=WG(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var gy=Math.abs;function zl(t){return(t>0)-(t<0)||+t}function Bp(){if(!this.isValid())return this.localeData().invalidDate();var t=gy(this._milliseconds)/1e3,e=gy(this._days),n=gy(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=ri(t/60),i=ri(r/60),t%=60,r%=60,o=ri(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=zl(this._months)!==zl(a)?"-":"",c=zl(this._days)!==zl(a)?"-":"",h=zl(this._milliseconds)!==zl(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ke=Vp.prototype;Ke.isValid=Lz;Ke.abs=pG;Ke.add=wG;Ke.subtract=vG;Ke.as=yG;Ke.asMilliseconds=ck;Ke.asSeconds=bG;Ke.asMinutes=SG;Ke.asHours=RG;Ke.asDays=EG;Ke.asWeeks=TG;Ke.asMonths=_G;Ke.asQuarters=MG;Ke.asYears=IG;Ke.valueOf=PG;Ke._bubble=CG;Ke.clone=OG;Ke.get=xG;Ke.milliseconds=AG;Ke.seconds=HG;Ke.minutes=NG;Ke.hours=DG;Ke.days=kG;Ke.weeks=FG;Ke.months=LG;Ke.years=$G;Ke.humanize=UG;Ke.toISOString=Bp;Ke.toString=Bp;Ke.toJSON=Bp;Ke.locale=ZD;Ke.localeData=QD;Ke.toIsoString=hi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Bp);Ke.lang=JD;ve("X",0,0,"unix");ve("x",0,0,"valueOf");ce("x",kp);ce("X",hU);gt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});gt("x",function(t,e,n){n._d=new Date(Ue(t))});//! moment.js
Z.version="2.30.1";zj(Et);Z.fn=Q;Z.min=Hz;Z.max=Nz;Z.now=Dz;Z.utc=Po;Z.unix=uG;Z.months=hG;Z.isDate=Ud;Z.locale=sa;Z.invalid=Ap;Z.duration=Bi;Z.isMoment=$i;Z.weekdays=fG;Z.parseZone=cG;Z.localeData=ys;Z.isDuration=em;Z.monthsShort=dG;Z.weekdaysMin=mG;Z.defineLocale=IE;Z.updateLocale=cz;Z.locales=hz;Z.weekdaysShort=gG;Z.normalizeUnits=di;Z.relativeTimeRounding=BG;Z.relativeTimeThreshold=jG;Z.calendarFormat=sY;Z.prototype=Q;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function zG(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function kO(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function nm(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Rr(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Rl(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function je(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function H(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function YG(t){const e=[];return H(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function LO(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return H(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function $O(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function it(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Rr(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Ot(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ue(t){return typeof t<"u"}function Pt(t){return typeof t>"u"}function jt(t){return t===null||t===""||Pt(t)}function GG(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const kh="length",zh=t=>parseInt(t,16),FO=t=>parseInt(t,10),xm=(t,e,n)=>t.substr(e,n),Yh=t=>t.codePointAt(0)-65,eR=t=>`${t}`.replace(/\-/g,""),qG=t=>zh(xm(eR(t),zh("12"),Yh("F")))/(zh(xm(eR(t),Yh("B"),~~![][kh]))||9),KG=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let VO=!1;const WO={invalid:()=>it`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return it`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>it`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},BO={invalid:()=>it`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return it`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>it`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function XG(t,e){const n=!jt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.0.1";let o,s="invalid",a="invalid";t=eR(t||"");const l=ZG(t);if(n||r||l)if(l){const u=Z("10/07/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=qG(t);o=Z((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(KG()&&(s="valid",a="valid"),!VO&&s!=="valid"&&(WO[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](WO[s]({keyValidityDate:o,hotVersion:i})),VO=!0),a!=="valid"&&e&&BO[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=BO[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function ZG(t){let e=[][kh],n=e;if(t[kh]!==Yh("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Yh(i.shift());o;o=Yh(i.shift()||"A"))--o<""[kh]?n=n|(FO(`${FO(zh(r)+(zh(xm(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=xm(t,o,o?i[kh]===1?9:8:6);return n===e}function Fi(t){return t[0].toUpperCase()+t.substr(1)}function hk(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function dk(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function fk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function jO(t){return LE(`${t}`,{ALLOWED_TAGS:[]})}function LE(t,e){return Uj.sanitize(t,e)}const ma=t=>["tabindex",t],JG=()=>["role","treegrid"],ss=()=>["role","presentation"],QG=()=>["role","gridcell"],e2=()=>["role","gridcell button"],t2=()=>["role","rowheader"],gk=()=>["role","rowgroup"],n2=()=>["role","columnheader"],mk=()=>["role","row"],r2=()=>["role","menu"],i2=()=>["role","menuitem"],o2=()=>["role","menuitemcheckbox"],s2=()=>["role","combobox"],pk=()=>["role","listbox"],a2=()=>["role","option"],l2=()=>["role","checkbox"],u2=()=>["scope","col"],c2=()=>["scope","row"],h2=()=>["type","text"],rc=t=>["aria-label",t],Vl=()=>["aria-hidden","true"],d2=()=>["aria-disabled","true"],f2=()=>["aria-multiselectable","true"],wk=t=>["aria-haspopup",t],vk=t=>["aria-rowcount",t],jp=t=>["aria-colcount",t],Ck=t=>["aria-rowindex",t],$E=t=>["aria-colindex",t],si=t=>["aria-expanded",t],g2=t=>["aria-sort",t],UO=()=>["aria-readonly","true"],zO=()=>["aria-invalid","true"],yk=t=>["aria-checked",t],FE=()=>["aria-selected","true"],m2=()=>["aria-autocomplete","list"],p2=t=>["aria-controls",t],w2=t=>["aria-activedescendant",t],v2=t=>["aria-live",t],C2=t=>["aria-relevant",t],y2=t=>["aria-setsize",t],b2=t=>["aria-posinset",t];var YO={},my,GO;function S2(){if(GO)return my;GO=1;var t=Zt(),e=tD(),n=ln(),r=Nl(),i=xp(),o=t([].push);return my=function(s){if(n(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(f,g){if(d)return d=!1,g;if(e(this))return g;for(var w=0;w<h;w++)if(l[w]===f)return g}}},my}var qO;function R2(){if(qO)return YO;qO=1;var t=pt(),e=dc(),n=Wd(),r=an(),i=Zt(),o=sn(),s=ln(),a=tE(),l=gE(),u=S2(),c=eE(),h=String,d=e("JSON","stringify"),f=i(/./.exec),g=i("".charAt),w=i("".charCodeAt),C=i("".replace),S=i(1.1.toString),v=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,P=/^[\uDC00-\uDFFF]$/,x=!c||o(function(){var Y=e("Symbol")("stringify detection");return d([Y])!=="[null]"||d({a:Y})!=="{}"||d(Object(Y))!=="{}"}),_=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),M=function(Y,O){var G=l(arguments),J=u(O);if(!(!s(J)&&(Y===void 0||a(Y))))return G[1]=function(ae,te){if(s(J)&&(te=r(J,this,h(ae),te)),!a(te))return te},n(d,null,G)},V=function(Y,O,G){var J=g(G,O-1),ae=g(G,O+1);return f(T,Y)&&!f(P,ae)||f(P,Y)&&!f(T,J)?"\\u"+S(w(Y,0),16):Y};return d&&t({target:"JSON",stat:!0,arity:3,forced:x||_},{stringify:function(O,G,J){var ae=l(arguments),te=n(x?M:d,null,ae);return _&&typeof te=="string"?C(te,v,V):te}}),YO}R2();function Cd(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},De(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Cd(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Cd(n[0])]:e[r]=[]:e[r]=null)})),e}function E2(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function on(t,e,n){const r=Array.isArray(n);return De(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Up(t,e){De(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Up(t[r],e[r])):t[r]=e[r]})}function Jn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function _o(t){const e={};return De(t,(n,r)=>{e[r]=n}),e}function ft(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return H(n,i=>{t.MIXINS.push(i.MIXIN_NAME),De(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let w=g;return(Array.isArray(w)||Ne(w))&&(w=Jn(w)),w};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function VE(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ne(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ss(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function De(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function T2(t,e){const n=e.split(".");let r=t;return De(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function py(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(nn(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function WE(t){if(!Ne(t))return 0;const e=function(n){let r=0;return Ne(n)?De(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Fr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function nn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Am(t){return window.requestAnimationFrame(t)}function Hm(t){window.cancelAnimationFrame(t)}function bk(){return"ontouchstart"in window}function _2(){return typeof window<"u"}let Yl;function M2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Yl||(typeof Intl=="object"?Yl=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Yl=(n,r)=>`${n}`.localeCompare(r):Yl=(n,r)=>n===r?0:n>r?-1:1,Yl)}const Zr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},pa={chrome:Zr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Zr(t=>/CriOS/.test(t)),edge:Zr(t=>/Edge/.test(t)),edgeWebKit:Zr(t=>/EdgiOS/.test(t)),firefox:Zr(t=>/Firefox/.test(t)),firefoxWebKit:Zr(t=>/FxiOS/.test(t)),mobile:Zr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Zr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},qd={mac:Zr(t=>/^Mac/.test(t)),win:Zr(t=>/^Win/.test(t)),linux:Zr(t=>/^Linux/.test(t)),ios:Zr(t=>/iPhone|iPad|iPod/i.test(t))};function I2(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};De(pa,n=>{let{test:r}=n;return void r(t,e)})}function P2(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};De(qd,e=>{let{test:n}=e;return void n(t)})}_2()&&(I2(),P2());function Sk(){return pa.chrome.value}function O2(){return pa.chromeWebKit.value}function wy(){return pa.firefox.value}function x2(){return pa.firefoxWebKit.value}function yd(){return pa.safari.value}function A2(){return pa.edge.value}function So(){return pa.mobile.value}function Rk(){return qd.ios.value}function Ek(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&qd.mac.value}function tR(){return qd.win.value}function KO(){return qd.mac.value}function H2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function rm(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function N2(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function ic(t){return N2(t)&&t.parent}function El(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function vf(t,e,n){const r=[];let i=t;for(;i&&(i=El(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function D2(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function yl(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function k2(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function ba(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function Tk(t){return!t||!t.length?[]:t.filter(e=>!!e)}function _k(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function ye(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function X(t,e){typeof e=="string"&&(e=e.split(" ")),e=Tk(e),e.length>0&&t.classList.add(...e)}function we(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=_k(e,!0);n=Tk(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Ce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function yc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=_k(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function Mk(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)Mk(e[n])}}function ms(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const L2=/(<(.*)>|&(.*);)/;function bc(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;L2.test(e)?t.innerHTML=n?LE(e):e:Tl(t,e)}function Tl(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(ms(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function oc(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return oc(r.host.impl);if(r.host)return oc(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function $2(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Dn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function Ik(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function BE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function jE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Ik(e):t.scrollTop}function Pk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?BE(e):t.scrollLeft}function Nm(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function F2(t){return t.scrollHeight-t.clientHeight}function V2(t){return t.scrollWidth-t.clientWidth}function bd(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Dm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function qt(t){return t.offsetWidth}function rn(t){return t.offsetHeight}function Gh(t){return t.clientHeight||t.innerHeight}function Ok(t){return t.clientWidth||t.innerWidth}function xk(t){return t.selectionStart?t.selectionStart:0}function W2(t){return t.selectionEnd?t.selectionEnd:0}function XO(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function zp(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let vy;function Ak(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return tR()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function B2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");yd()&&!So()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i+Ak(t)}function bn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return vy===void 0&&(vy=B2(t)),vy}function Hk(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function Nk(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function UE(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function Yp(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function im(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Dk(t){return im(t)&&t.hasAttribute("data-hot-input")===!1}function kk(t){return!t.parentNode}function j2(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Lk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Ce(t,"contenteditable",!0),n&&Ce(t,...Vl()),e&&X(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function $k(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&we(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function U2(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Lk(t,n),e(),$k(t,n)}function fs(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}function at(t){return typeof t=="function"}function Gp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function Fk(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function z2(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function nR(t,e,n,r,i,o,s,a){return ue(a)?t.call(e,n,r,i,o,s,a):ue(s)?t.call(e,n,r,i,o,s):ue(o)?t.call(e,n,r,i,o):ue(i)?t.call(e,n,r,i):ue(r)?t.call(e,n,r):ue(n)?t.call(e,n):t.call(e)}const me={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:wy()?182:174,AUDIO_MUTE:wy()?181:173,AUDIO_UP:wy()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Y2=[me.ALT,me.ARROW_DOWN,me.ARROW_LEFT,me.ARROW_RIGHT,me.ARROW_UP,me.AUDIO_DOWN,me.AUDIO_MUTE,me.AUDIO_UP,me.BACKSPACE,me.CAPS_LOCK,me.DELETE,me.END,me.ENTER,me.ESCAPE,me.F1,me.F2,me.F3,me.F4,me.F5,me.F6,me.F7,me.F8,me.F9,me.F10,me.F11,me.F12,me.F13,me.F14,me.F15,me.F16,me.F17,me.F18,me.F19,me.HOME,me.INSERT,me.MEDIA_NEXT,me.MEDIA_PLAY_PAUSE,me.MEDIA_PREV,me.MEDIA_STOP,me.NULL,me.NUM_LOCK,me.PAGE_DOWN,me.PAGE_UP,me.PAUSE,me.SCROLL_LOCK,me.SHIFT,me.TAB];function G2(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Vk(t){return Y2.includes(t)}function q2(t){return[me.CONTROL,me.COMMAND_LEFT,me.COMMAND_RIGHT,me.COMMAND_FIREFOX].includes(t)}function Kd(t,e){const n=e.split("|");let r=!1;return H(n,i=>{if(t===me[i])return r=!0,!1}),r}function ji(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function al(t){return t.isImmediatePropagationEnabled===!1}function _l(t){return t.button===2}function zE(t){return t.button===0}function K2(t){return t instanceof TouchEvent}function X2(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!fs(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}function Ze(){ue(console)&&console.warn(...arguments)}function YE(){ue(console)&&console.error(...arguments)}const ll=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Cy=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),yy=new Map([[]]);var ZO={},by,JO;function Z2(){if(JO)return by;JO=1;var t=mc();return by=function(e,n,r){for(var i=0,o=arguments.length>2?r:t(n),s=new e(o);o>i;)s[i]=n[i++];return s},by}var Sy,QO;function J2(){if(QO)return Sy;QO=1;var t=Xt();return Sy=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},Sy}var Ry,ex;function qp(){if(ex)return Ry;ex=1;var t=Wi(),e=hE(),n=fa().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),Ry=function(o){i[r][o]=!0},Ry}var tx;function Q2(){if(tx)return ZO;tx=1;var t=pt(),e=Zt(),n=br(),r=Ld(),i=Z2(),o=J2(),s=qp(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),s("toSorted"),ZO}Q2();var nx={},rx={},ix;function eq(){if(ix)return rx;ix=1;var t=pt(),e=an(),n=pc(),r=br(),i=un(),o=Io(),s=Sr(),a=ga(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,g){if(c(f,d++))return g(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),rx}var ox;function tq(){return ox||(ox=1,eq()),nx}tq();function nq(t,e){Wk(t,e),e.add(t)}function Ey(t,e,n){Wk(t,e),e.set(t,n)}function Wk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sx(t,e,n){return t.set(km(t,e),n),n}function Rn(t,e){return t.get(km(t,e))}function km(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rq=100;var Mr=new WeakMap,Au=new WeakMap,Ty=new WeakMap,_y=new WeakSet;class ax{constructor(){nq(this,_y),Ey(this,Mr,new Map),Ey(this,Au,new Map),Ey(this,Ty,new Set),ll.forEach(e=>km(_y,this,lx).call(this,e))}getHooks(e){var n;return(n=Rn(Mr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Rn(Mr,this).has(e)||(km(_y,this,lx).call(this,e),ll.push(e));const i=Rn(Mr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Rn(Ty,this).has(e);!u&&o!==0&&(u=!0,Rn(Ty,this).add(e)),u&&i.length>1&&Rn(Mr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Rn(Mr,this).has(e)&&Rn(Mr,this).get(e).length>0}remove(e,n){if(!Rn(Mr,this).has(e))return!1;const r=Rn(Mr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=Rn(Au,this).get(e);return i.skip=!0,o+=1,o>rq&&(Rn(Mr,this).set(e,r.filter(s=>!s.skip)),o=0),Rn(Au,this).set(e,o),!0}return!1}destroy(){Rn(Mr,this).clear(),Rn(Au,this).clear(),sx(Mr,this,null),sx(Au,this,null)}}function lx(t){Rn(Mr,this).set(t,[]),Rn(Au,this).set(t,0)}function iq(t,e,n){return(e=oq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oq(t){var e=sq(t,"string");return typeof e=="symbol"?e:e+""}function sq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const aq=it`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ie{constructor(){iq(this,"globalBucket",new ax)}static getSingleton(){return uq()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new ax),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?H(n,o=>this.add(e,o,r)):(Cy.has(e)&&Ze(fk(aq,{hookName:e,removedInVersion:Cy.get(e)})),yy.has(e)&&Ze(yy.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?H(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?H(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=nR(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=nR(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||ll.push(e)}deregister(e){this.isRegistered(e)&&ll.splice(ll.indexOf(e),1)}isDeprecated(e){return yy.has(e)||Cy.has(e)}isRegistered(e){return ll.indexOf(e)>=0}getRegistered(){return ll}}const lq=new ie;function uq(){return lq}const hl=new Map;function fi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";hl.has(t)||hl.set(t,new Map);const e=hl.get(t);function n(l,u){e.set(l,u)}function r(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){hl.delete(t),e.clear()}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s,clear:a}}function cq(t,e){var n;return hl==null||(n=hl.get(t.guid))===null||n===void 0?void 0:n.get(e)}const rR=new WeakMap,{register:hq,getItem:Bk,hasItem:jk,getNames:wfe,getValues:vfe}=fi("editors");function dq(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ie.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function Uk(t,e){let n;if(typeof t=="function")rR.get(t)||Pr(null,t),n=rR.get(t);else if(typeof t=="string")n=Bk(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function ux(t){if(typeof t=="function")return t;if(!jk(t))throw Error(`No registered editor found under "${t}" name`);return Bk(t).getConstructor()}function Pr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new dq(e);typeof t=="string"&&hq(t,n),rR.set(e,n)}function fq(t,e,n){return(e=gq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gq(t){var e=mq(t,"string");return typeof e=="symbol"?e:e+""}function mq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;fq(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,pq(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function pq(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ji(this)},t}function wq(t,e){vq(t,e),e.add(t)}function vq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sa(t,e,n){return(e=Cq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cq(t){var e=yq(t,"string");return typeof e=="symbol"?e:e+""}function yq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function My(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cf=new WeakSet;class iR{constructor(e,n,r){wq(this,Cf),Sa(this,"hot",void 0),Sa(this,"tableMeta",void 0),Sa(this,"selection",void 0),Sa(this,"eventManager",void 0),Sa(this,"destroyed",!1),Sa(this,"activeEditor",void 0),Sa(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Vi(e),this.hot.addHook("afterDocumentKeyDown",i=>My(Cf,this,cx).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>My(Cf,this,cx).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>My(Cf,this,bq).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=Uk(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function cx(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||al(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Vk(n)&&!q2(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function bq(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const hx=new WeakMap;iR.getInstance=function(t,e,n){let r=hx.get(t);return r||(r=new iR(t,e,n),hx.set(t,r)),r};function Sq(t,e){zk(t,e),e.add(t)}function Vc(t,e,n){zk(t,e),e.set(t,n)}function zk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){return t.get(rs(t,e))}function Wc(t,e,n){return t.set(rs(t,e),n),n}function rs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xu=Object.freeze({CELL:"cell",MIXED:"mixed"});var tn=new WeakMap,yf=new WeakMap,bf=new WeakMap,Sf=new WeakMap,Rf=new WeakMap,Us=new WeakSet;class Rq{constructor(e){var n=this;Sq(this,Us),Vc(this,tn,void 0),Vc(this,yf,void 0),Vc(this,bf,1),Vc(this,Sf,null),Vc(this,Rf,new Map);const r=e.getSettings();Wc(tn,this,e),Wc(yf,this,r.imeFastEdit?Xu.MIXED:Xu.CELL),vt(tn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return rs(Us,n,Tq).call(n,...o)}),vt(tn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return rs(Us,n,dx).call(n,...o)}),vt(tn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return rs(Us,n,dx).call(n,...o)}),vt(tn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return rs(Us,n,Eq).call(n,...o)})}getFocusMode(){return vt(yf,this)}setFocusMode(e){Object.values(Xu).includes(e)?Wc(yf,this,e):Ze(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return vt(bf,this)}setRefocusDelay(e){Wc(bf,this,e)}setRefocusElementGetter(e){Wc(Sf,this,e)}getRefocusElement(){var e;return typeof vt(Sf,this)=="function"?vt(Sf,this).call(this):(e=vt(tn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=vt(tn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=vt(tn,this).runHooks("modifyFocusedElement",s.row,s.col,r);fs(a)||(a=r),a&&!((o=vt(tn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):rs(Us,this,GE).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vt(bf,this);if(vt(tn,this).getSettings().imeFastEdit&&!((e=vt(tn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=vt(tn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),vt(Rf,this).has(n)||vt(Rf,this).set(n,Gp(()=>{if(!vt(tn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),vt(Rf,this).get(n)()}}}function GE(t){var e;const n=(e=vt(tn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!vt(tn,this).selection.isCellVisible(n)){t(null);return}const r=vt(tn,this).getCell(n.row,n.col,!0);r===null?vt(tn,this).addHookOnce("afterScroll",()=>{t(vt(tn,this).getCell(n.row,n.col,!0))}):t(r)}function dx(){rs(Us,this,GE).call(this,t=>{const{activeElement:e}=vt(tn,this).rootDocument;e&&Dk(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Eq(){rs(Us,this,GE).call(this,t=>{this.getFocusMode()===Xu.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function Tq(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Xu.MIXED:Xu.CELL)}var fx={},Iy,gx;function _q(){if(gx)return Iy;gx=1;var t=ui(),e=Nl(),n=Wi(),r=n("match");return Iy=function(i){var o;return t(i)&&((o=i[r])!==void 0?!!o:e(i)==="RegExp")},Iy}var Py,mx;function Mq(){if(mx)return Py;mx=1;var t=Xt(),e=sn(),n=t.RegExp,r=!e(function(){var i=!0;try{n(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(o,d,{get:function(){return s+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(o);return h!==a||s!==a});return Py={correct:r},Py}var Oy,px;function Iq(){if(px)return Oy;px=1;var t=un();return Oy=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},Oy}var xy,wx;function Pq(){if(wx)return xy;wx=1;var t=an(),e=ci(),n=$d(),r=Mq(),i=Iq(),o=RegExp.prototype;return xy=r.correct?function(s){return s.flags}:function(s){return!r.correct&&n(o,s)&&!e(s,"flags")?t(i,s):s.flags},xy}var Ay,vx;function Oq(){if(vx)return Ay;vx=1;var t=Zt(),e=fc(),n=Math.floor,r=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return Ay=function(l,u,c,h,d,f){var g=c+l.length,w=h.length,C=a;return d!==void 0&&(d=e(d),C=s),i(f,C,function(S,v){var T;switch(r(v,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,g);case"<":T=d[o(v,1,-1)];break;default:var P=+v;if(P===0)return S;if(P>w){var x=n(P/10);return x===0?S:x<=w?h[x-1]===void 0?r(v,1):h[x-1]+r(v,1):S}T=h[P-1]}return T===void 0?"":T})},Ay}var Cx;function xq(){if(Cx)return fx;Cx=1;var t=pt(),e=an(),n=Zt(),r=kd(),i=ln(),o=ui(),s=_q(),a=xp(),l=Fd(),u=Pq(),c=Oq(),h=Wi(),d=da(),f=h("replace"),g=TypeError,w=n("".indexOf),C=n("".replace),S=n("".slice),v=Math.max;return t({target:"String",proto:!0},{replaceAll:function(P,x){var _=r(this),M,V,Y,O,G,J,ae,te,ne,Fe,ke=0,Ve="";if(o(P)){if(M=s(P),M&&(V=a(r(u(P))),!~w(V,"g")))throw new g("`.replaceAll` does not allow non-global regexes");if(Y=l(P,f),Y)return e(Y,P,_,x);if(d&&M)return C(a(_),P,x)}for(O=a(_),G=a(P),J=i(x),J||(x=a(x)),ae=G.length,te=v(1,ae),ne=w(O,G);ne!==-1;)Fe=J?a(x(G,ne,O)):c(G,O,ne,[],void 0,x),Ve+=S(O,ke,ne)+Fe,ke=ne+ae,ne=ne+te>O.length?-1:w(O,G,ne+te);return ke<O.length&&(Ve+=S(O,ke)),Ve}}),fx}xq();var yx={},bx={},Sx;function Aq(){if(Sx)return bx;Sx=1;var t=pt(),e=pc(),n=br(),r=un(),i=Io(),o=Sr(),s=ga(),a=Wd(),l=sn(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){r(this);try{n(f)}catch(v){o(this,"throw",v)}var g=arguments.length<2,w=g?void 0:arguments[1];if(h)return a(h,this,g?[f]:[f,w]);var C=i(this),S=0;if(e(C,function(v){g?(g=!1,w=v):w=f(w,v,S),S++},{IS_RECORD:!0}),g)throw new u("Reduce of empty iterator with no initial value");return w}}),bx}var Rx;function Hq(){return Rx||(Rx=1,Aq()),yx}Hq();const Yk={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Nq=new RegExp(Object.keys(Yk).map(t=>`(${t})`).join("|"),"gi");function Dq(t){return(t&&t.nodeName||"")==="TABLE"}function Ex(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let C=0;C<s;C+=1){const S=!f&&n&&C===0;let v="";if(f)v=`<th>${t.getColHeader(C-c)}</th>`;else if(S)v=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][C],{hidden:P,rowspan:x,colspan:_}=t.getCellMeta(d-h,C-c);if(!P){const M=[];if(x&&M.push(`rowspan="${x}"`),_&&M.push(`colspan="${_}"`),jt(T))v=`<td ${M.join(" ")}></td>`;else{const V=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${M.join(" ")}>${V}</td>`}}}g.push(v)}const w=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,w):u.splice(-1,0,w)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Tx(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=jt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function kq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,P=>{const x=P.match(/<td\b[^>]*?>/g)[0],_=/<p.*?>/g,M=P.substring(x.length,P.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(_,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${x}${M}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!Dq(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,P)=>T+P.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(P=>{const x=P.querySelector("td")!==null;return x&&h.push(P),!x});f=T.length,d=f>0,f>1?n.nestedHeaders=Array.from(T).reduce((P,x)=>{const _=Array.from(x.cells).reduce((M,V,Y)=>{if(a&&Y===0)return M;const{colSpan:O,innerHTML:G}=V,J=O>1?{label:G,colspan:O}:G;return M.push(J),M},[]);return P.push(_),P},[]):d&&(n.colHeaders=Array.from(T[0].children).reduce((P,x,_)=>(a&&_===0||P.push(x.innerHTML),P),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const w=[...h,...Array.from(o.tBodies).reduce((T,P)=>(T.push(...Array.from(P.rows)),T),[]),...c];g=w.length;const C=new Array(g);for(let T=0;T<g;T++)C[T]=new Array(u);const S=[],v=[];for(let T=0;T<g;T++){const P=w[T],x=Array.from(P.cells),_=x.length;for(let M=0;M<_;M++){const V=x[M],{nodeName:Y,innerHTML:O,rowSpan:G,colSpan:J}=V,ae=C[T].findIndex(te=>te===void 0);if(Y==="TD"){if(G>1||J>1){for(let ke=T;ke<T+G;ke++)if(ke<g)for(let Ve=ae;Ve<ae+J;Ve++)C[ke][Ve]=null;const ne=V.getAttribute("style");ne&&ne.includes("mso-ignore:colspan")||S.push({col:ae,row:T,rowspan:G,colspan:J})}let te="";s&&/excel/gi.test(s.content)?te=O.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):te=O.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[T][ae]=te.replace(Nq,ne=>Yk[ne])}else v.push(O)}}return S.length&&(n.mergeCells=S),v.length&&(n.rowHeaders=v),C.length&&(n.data=C),n}function qn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Lq(t){return qn(t,[","])}function de(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function _x(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function Gk(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ze(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const oR="asc",$q="desc",Mx=new Map([[oR,[-1,1]],[$q,[1,-1]]]),Fq=t=>`The priority '${t}' is already declared in a map.`,Vq=t=>`The priority '${t}' is not a number.`;function Wq(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=at(t)?t:Fq,e=at(e)?e:Vq;function r(o,s){if(!qn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oR;const[s,a]=Mx.get(o)||Mx.get(oR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const Bq=t=>`The id '${t}' is already declared in a map.`;function Kp(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=at(t)?t:Bq;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const jq=t=>`'${t}' value is already declared in a unique set.`;function Uq(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=at(t)?t:jq;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const qE=t=>`There is already registered "${t}" plugin.`,zq=t=>`There is already registered plugin on priority "${t}".`,Yq=t=>`The priority "${t}" is not a number.`,qk=Wq({errorPriorityExists:zq,errorPriorityNaN:Yq}),Kk=Uq({errorItemExists:qE}),sR=Kp({errorIdExists:qE});function Xk(){return[...qk.getItems(),...Kk.getItems()]}function KE(t){const e=Fi(t);return sR.getItem(e)}function Gq(t){return!!KE(t)}function Ye(t,e,n){[t,e,n]=Kq(t,e,n),KE(t)===void 0&&qq(t,e,n)}function qq(t,e,n){const r=Fi(t);if(sR.hasItem(r))throw new Error(qE(r));n===void 0?Kk.addItem(r):qk.addItem(n,r),sR.addItem(r,e)}function Kq(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:Xq,getItem:Zq,hasItem:Zk,getNames:Cfe,getValues:yfe}=fi("renderers");function Ix(t){if(typeof t=="function")return t;if(!Zk(t))throw Error(`No registered renderer found under "${t}" name`);return Zq(t)}function Kr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Xq(t,e)}const{register:Jq,getItem:Qq,hasItem:Jk,getNames:bfe,getValues:Sfe}=fi("validators");function eK(t){if(typeof t=="function")return t;if(!Jk(t))throw Error(`No registered validator found under "${t}" name`);return Qq(t)}function Hu(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Jq(t,e)}var Px={},Ox;function tK(){if(Ox)return Px;Ox=1;var t=pt(),e=fc(),n=mc(),r=Vd(),i=qp();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=n(a),u=r(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),Px}tK();var xx={},Ax;function nK(){if(Ax)return xx;Ax=1;var t=pt(),e=Zt(),n=kd(),r=Vd(),i=xp(),o=sn(),s=e("".charAt),a=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:s(c,f)}}),xx}nK();function Bc(t,e,n){return(e=rK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rK(t){var e=iK(t,"string");return typeof e=="symbol"?e:e+""}function iK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oK{constructor(){Bc(this,"count",0),Bc(this,"startColumn",null),Bc(this,"endColumn",null),Bc(this,"startPosition",null),Bc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function jc(t,e,n){return(e=sK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sK(t){var e=aK(t,"string");return typeof e=="symbol"?e:e+""}function aK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lK{constructor(){jc(this,"count",0),jc(this,"startRow",null),jc(this,"endRow",null),jc(this,"startPosition",null),jc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Uc(t,e,n){return(e=uK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:e+""}function cK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qk{constructor(){Uc(this,"count",0),Uc(this,"startColumn",null),Uc(this,"endColumn",null),Uc(this,"startPosition",null),Uc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function zc(t,e,n){return(e=hK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hK(t){var e=dK(t,"string");return typeof e=="symbol"?e:e+""}function dK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eL{constructor(){zc(this,"count",0),zc(this,"startRow",null),zc(this,"endRow",null),zc(this,"startPosition",null),zc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Yc(t,e,n){return(e=fK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fK(t){var e=gK(t,"string");return typeof e=="symbol"?e:e+""}function gK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mK{constructor(){Yc(this,"count",0),Yc(this,"startColumn",0),Yc(this,"endColumn",0),Yc(this,"startPosition",0),Yc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Gc(t,e,n){return(e=pK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pK(t){var e=wK(t,"string");return typeof e=="symbol"?e:e+""}function wK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vK{constructor(){Gc(this,"count",0),Gc(this,"startRow",0),Gc(this,"endRow",0),Gc(this,"startPosition",0),Gc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function Hx(t,e,n){return(e=CK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CK(t){var e=yK(t,"string");return typeof e=="symbol"?e:e+""}function yK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bK extends Qk{constructor(){super(...arguments),Hx(this,"columnStartOffset",0),Hx(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Nx(t,e,n){return(e=SK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SK(t){var e=RK(t,"string");return typeof e=="symbol"?e:e+""}function RK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EK extends eL{constructor(){super(...arguments),Nx(this,"rowStartOffset",0),Nx(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Dx(t,e,n){return(e=TK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TK(t){var e=_K(t,"string");return typeof e=="symbol"?e:e+""}function _K(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tL{constructor(e){Dx(this,"calculationTypes",[]),Dx(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function pi(t,e,n){return(e=MK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MK(t){var e=IK(t,"string");return typeof e=="symbol"?e:e+""}function IK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sc=50;class PK extends tL{constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),pi(this,"viewportWidth",0),pi(this,"scrollOffset",0),pi(this,"zeroBasedScrollOffset",0),pi(this,"totalColumns",0),pi(this,"columnWidthFn",null),pi(this,"columnWidth",0),pi(this,"overrideFn",null),pi(this,"inlineStartOffset",0),pi(this,"totalCalculatedWidth",0),pi(this,"startPositions",[]),pi(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?sc:n}}function jr(t,e,n){return(e=OK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OK(t){var e=xK(t,"string");return typeof e=="symbol"?e:e+""}function xK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AK extends tL{constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),jr(this,"viewportHeight",0),jr(this,"scrollOffset",0),jr(this,"zeroBasedScrollOffset",0),jr(this,"totalRows",0),jr(this,"rowHeightFn",null),jr(this,"rowHeight",0),jr(this,"overrideFn",null),jr(this,"horizontalScrollbarHeight",0),jr(this,"innerViewportHeight",0),jr(this,"totalCalculatedHeight",0),jr(this,"startPositions",[]),jr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function HK(t,e,n){NK(t,e),e.set(t,n)}function NK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kx(t,e,n){return(e=DK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DK(t){var e=kK(t,"string");return typeof e=="symbol"?e:e+""}function kK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gl(t,e){return t.get(nL(t,e))}function Lx(t,e,n){return t.set(nL(t,e),n),n}function nL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ko=new WeakMap;class Ml{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;kx(this,"row",null),kx(this,"col",null),HK(this,ko,!1),Lx(ko,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Gl(ko,this)}isSouthEastOf(e){return this.row>=e.row&&(Gl(ko,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Gl(ko,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Gl(ko,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Gl(ko,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof Ml&&Lx(ko,this,e.isRtl()),this}clone(){return new Ml(this.row,this.col,Gl(ko,this))}toObject(){return{row:this.row,col:this.col}}}function LK(t,e,n){$K(t,e),e.set(t,n)}function $K(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hy(t,e,n){return(e=FK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FK(t){var e=VK(t,"string");return typeof e=="symbol"?e:e+""}function VK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ur(t,e){return t.get(rL(t,e))}function WK(t,e,n){return t.set(rL(t,e),n),n}function rL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nr=new WeakMap;class Xd{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Hy(this,"highlight",null),Hy(this,"from",null),Hy(this,"to",null),LK(this,nr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),WK(nr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Ur(nr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Ur(nr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Ur(nr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Ur(nr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Ur(nr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Ur(nr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Ur(nr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Ur(nr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Ml))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(Ur(nr,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(Ur(nr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new Xd(this.highlight,this.from,this.to,Ur(nr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new Ml(e,n,Ur(nr,this))}}function Yi(t,e,n){BK(t,e),e.set(t,n)}function BK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fe(t,e){return t.get(iL(t,e))}function Ts(t,e,n){return t.set(iL(t,e),n),n}function iL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zr=new WeakMap,Ny=new WeakMap,vn=new WeakMap,ql=new WeakMap,Ef=new WeakMap,wi=new WeakMap,Dy=new WeakMap,qc=new WeakMap,Ra=new WeakMap,Gi=new WeakMap;let oL=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Yi(this,zr,void 0),Yi(this,Ny,void 0),Yi(this,vn,void 0),Yi(this,ql,void 0),Yi(this,Ef,void 0),Yi(this,wi,void 0),Yi(this,Dy,void 0),Yi(this,qc,void 0),Yi(this,Ra,[null,null]),Yi(this,Gi,[null,null]),Ts(zr,this,r),Ts(Ny,this,n),Ts(vn,this,o),Ts(ql,this,s),Ts(Ef,this,a),Ts(wi,this,i),Ts(Dy,this,e),this.registerEvents()}registerEvents(){fe(wi,this).addEventListener(fe(vn,this).holder,"contextmenu",r=>this.onContextMenu(r)),fe(wi,this).addEventListener(fe(vn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),fe(wi,this).addEventListener(fe(vn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{fe(wi,this).addEventListener(fe(vn,this).holder,"touchstart",r=>this.onTouchStart(r)),fe(wi,this).addEventListener(fe(vn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),fe(wi,this).addEventListener(fe(vn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||fe(zr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,fe(zr,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{fe(wi,this).addEventListener(fe(vn,this).holder,"mouseup",r=>this.onMouseUp(r)),fe(wi,this).addEventListener(fe(vn,this).holder,"mousedown",r=>this.onMouseDown(r))};So()?e():(bk()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(fe(qc,this)&&r){const[i,o]=[r.row,fe(qc,this).from.row],[s,a]=[r.col,fe(qc,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=fe(vn,this).TABLE,i=vf(e,["TD","TH"],r);return i?(n.coords=fe(vn,this).getCoords(i),n.TD=i):ye(e,"wtBorder")&&ye(e,"current")?(n.coords=fe(ql,this).getFocusSelection().cellRange.highlight,n.TD=fe(vn,this).getCell(n.coords)):ye(e,"wtBorder")&&ye(e,"area")&&fe(ql,this).getAreaSelection().cellRange&&(n.coords=fe(ql,this).getAreaSelection().cellRange.to,n.TD=fe(vn,this).getCell(n.coords)),n}onMouseDown(e){const n=fe(Ny,this).rootDocument.activeElement,r=Fk(H2,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);ye(i,"corner")?fe(zr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&fe(zr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(fe(Gi,this)[0]=o.TD,clearTimeout(fe(Ra,this)[0]),fe(Ra,this)[0]=setTimeout(()=>{fe(Gi,this)[0]=null},1e3))}onContextMenu(e){if(fe(zr,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!fe(zr,this).has("onCellMouseOver"))return;const n=fe(vn,this).TABLE,r=vf(e.target,["TD","TH"],n),i=fe(Ef,this)||this;r&&r!==i.lastMouseOver&&yl(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,fe(vn,this).getCoords(r),r))}onMouseOut(e){if(!fe(zr,this).has("onCellMouseOut"))return;const n=fe(vn,this).TABLE,r=vf(e.target,["TD","TH"],n),i=vf(e.relatedTarget,["TD","TH"],n),o=fe(Ef,this)||this;r&&r!==i&&yl(r,n)&&(this.callListener("onCellMouseOut",e,fe(vn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&fe(zr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===fe(Gi,this)[0]&&n.TD===fe(Gi,this)[1]?(ye(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),fe(Gi,this)[0]=null,fe(Gi,this)[1]=null):n.TD===fe(Gi,this)[0]&&(fe(Gi,this)[1]=n.TD,clearTimeout(fe(Ra,this)[1]),fe(Ra,this)[1]=setTimeout(()=>{fe(Gi,this)[1]=null},500)))}onTouchStart(e){Ts(qc,this,fe(ql,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&fe(zr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];Rk()&&(O2()||x2())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=fe(zr,this).getSettingPure(e);o&&o(n,r,i,fe(Dy,this).call(this))}destroy(){clearTimeout(fe(Ra,this)[0]),clearTimeout(fe(Ra,this)[1]),fe(wi,this).destroy()}};function ky(t,e,n){return(e=jK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jK(t){var e=UK(t,"string");return typeof e=="symbol"?e:e+""}function UK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zK{constructor(e,n,r){ky(this,"offset",void 0),ky(this,"total",void 0),ky(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Ly(t,e,n){return(e=YK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YK(t){var e=GK(t,"string");return typeof e=="symbol"?e:e+""}function GK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qK{constructor(e,n,r){Ly(this,"offset",void 0),Ly(this,"total",void 0),Ly(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Tf(t,e,n){return(e=KK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KK(t){var e=XK(t,"string");return typeof e=="symbol"?e:e+""}function XK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZK{constructor(){Tf(this,"currentSize",0),Tf(this,"nextSize",0),Tf(this,"currentOffset",0),Tf(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const JK=0,$x=1,aR=2;function $y(t,e,n){return(e=QK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QK(t){var e=e3(t,"string");return typeof e=="symbol"?e:e+""}function e3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class t3{constructor(){$y(this,"size",new ZK),$y(this,"workingSpace",JK),$y(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=$x,e.workingSpace=aR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=aR,e.workingSpace=$x,this.sharedSize=e.getViewSize()}}var Fx={},Fy,Vx;function n3(){if(Vx)return Fy;Vx=1;var t=Op(),e=TypeError;return Fy=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},Fy}var Wx;function r3(){if(Wx)return Fx;Wx=1;var t=pt(),e=fc(),n=mc(),r=nD(),i=n3(),o=rD(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){o(d+f);for(var g=d;g--;){var w=g+f;g in h?h[w]=h[g]:i(h,w)}for(var C=0;C<f;C++)h[C]=arguments[C]}return r(h,d+f)}}),Fx}r3();function i3(t,e,n){return(e=o3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o3(t){var e=s3(t,"string");return typeof e=="symbol"?e:e+""}function s3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bx{constructor(e,n){i3(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function a3(t,e,n){return(e=l3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l3(t){var e=u3(t,"string");return typeof e=="symbol"?e:e+""}function u3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c3{constructor(e){a3(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new Bx(o,n),l=new Bx(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(aR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Kl(t,e,n){return(e=h3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h3(t){var e=d3(t,"string");return typeof e=="symbol"?e:e+""}function d3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sL{constructor(e,n){Kl(this,"rootNode",void 0),Kl(this,"nodesPool",void 0),Kl(this,"sizeSet",new t3),Kl(this,"collectedNodes",[]),Kl(this,"viewDiffer",new c3(this.sizeSet)),Kl(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class aL extends sL{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function jx(t,e,n){return(e=f3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f3(t){var e=g3(t,"string");return typeof e=="symbol"?e:e+""}function g3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m3{constructor(e){jx(this,"nodeType",void 0),jx(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Kc(t,e,n){return(e=p3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p3(t){var e=w3(t,"string");return typeof e=="symbol"?e:e+""}function w3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zd{constructor(e,n){Kc(this,"nodesPool",null),Kc(this,"nodeType",void 0),Kc(this,"rootNode",void 0),Kc(this,"table",null),Kc(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new m3(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function Ux(t,e,n){return(e=v3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v3(t){var e=C3(t,"string");return typeof e=="symbol"?e:e+""}function C3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y3 extends Zd{constructor(){super("TH"),Ux(this,"orderViews",new WeakMap),Ux(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new aL(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),yc(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(d,[t2(),c2(),$E(h+1),ma(-1)]),n[h](a,d,h)}u.end()}}}class b3 extends Zd{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&ms(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ce(this.rootNode,[gk()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ce(s,[mk(),Ck(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),yc(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(u,[$E(a+1+this.table.rowHeadersCount),ma(-1),n2(),...a>=0?[u2()]:[e2(),rc("Select whole grid")]]),r[n](l,u,n)}}}}let zx=!1;class S3 extends Zd{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!zx&&e>1e3&&(zx=!0,Ze(it`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&X(r,"rowHeader")}}function R3(t,e,n){return(e=E3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E3(t){var e=T3(t,"string");return typeof e=="symbol"?e:e+""}function T3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Xl={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let Yx=!1;class _3 extends Zd{constructor(e){super("TR",e),R3(this,"orderView",void 0),this.orderView=new sL(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!Yx&&e>1e3&&(Yx=!0,Ze(it`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ce(this.rootNode,[gk()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Ce(o,[mk(),Ck(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?ye(o,Xl.rowEven)||(we(o,Xl.rowOdd),X(o,Xl.rowEven)):ye(o,Xl.rowOdd)||(we(o,Xl.rowEven),X(o,Xl.rowOdd))}this.orderView.end()}}function Gx(t,e,n){return(e=M3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M3(t){var e=I3(t,"string");return typeof e=="symbol"?e:e+""}function I3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P3 extends Zd{constructor(){super("TD"),Gx(this,"orderViews",new WeakMap),Gx(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new aL(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(ye(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),yc(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;Ce(g,[...g.hasAttribute("role")?[]:[QG()],ma(-1),$E(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function Qt(t,e,n){return(e=O3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O3(t){var e=x3(t,"string");return typeof e=="symbol"?e:e+""}function x3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A3{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Qt(this,"rootNode",void 0),Qt(this,"rootDocument",void 0),Qt(this,"rowHeaders",null),Qt(this,"columnHeaders",null),Qt(this,"colGroup",null),Qt(this,"rows",null),Qt(this,"cells",null),Qt(this,"rowFilter",null),Qt(this,"columnFilter",null),Qt(this,"rowUtils",null),Qt(this,"columnUtils",null),Qt(this,"rowsToRender",0),Qt(this,"columnsToRender",0),Qt(this,"rowHeaderFunctions",[]),Qt(this,"rowHeadersCount",0),Qt(this,"columnHeaderFunctions",[]),Qt(this,"columnHeadersCount",0),Qt(this,"cellRenderer",void 0),Qt(this,"activeOverlayName",void 0),Qt(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class H3{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new A3(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new y3,columnHeaders:new b3(n),colGroup:new S3(r),rows:new _3(i),cells:new P3}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Vy(t,e,n){return(e=N3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N3(t){var e=D3(t,"string");return typeof e=="symbol"?e:e+""}function D3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k3{constructor(e,n){Vy(this,"dataAccessObject",void 0),Vy(this,"wtSettings",void 0),Vy(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function qx(t,e,n){return(e=L3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L3(t){var e=$3(t,"string");return typeof e=="symbol"?e:e+""}function $3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F3{constructor(e,n){qx(this,"dataAccessObject",void 0),qx(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function qi(t,e,n){return(e=V3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V3(t){var e=W3(t,"string");return typeof e=="symbol"?e:e+""}function W3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sc{constructor(e,n,r,i,o){qi(this,"wtSettings",null),qi(this,"domBindings",void 0),qi(this,"TBODY",null),qi(this,"THEAD",null),qi(this,"COLGROUP",null),qi(this,"hasTableHeight",!0),qi(this,"hasTableWidth",!0),qi(this,"isTableVisible",!1),qi(this,"tableOffset",0),qi(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,Mk(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new F3(this.dataAccessObject,this.wtSettings),this.columnUtils=new k3(this.dataAccessObject,this.wtSettings),this.tableRenderer=new H3({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ce(r,[ss()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(r,[ss()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",this.isMaster&&Ce(r,[ma(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ce(r.parentNode,[ss()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(r,[ss()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Dn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Dn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new qK(f,o,c),this.columnFilter=new zK(g,s,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),w=C.skipRender!==!0}w&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Co)||this.is(aa))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Co))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Co)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Gh(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Co))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=El(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=k2(r),s=n.cellIndex;ba(Ol,n,this.wtRootElement)||ba(Il,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):ba(aa,n,this.wtRootElement)||ba(Co,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),ba(Ol,n,this.wtRootElement)||ba(Pl,n,this.wtRootElement)||ba(aa,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),r=e*n.getDefaultRowHeight(),i=Gh(this.TBODY)-1,o=n.areCellsBorderBox(),s=o?rn:Gh,a=o?0:1,l=o?1:0;let u,c,h,d,f;if(!(r===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const g=h===0?l:0;f?c=s(f):c=s(d)-a,(!u&&n.getDefaultRowHeight()<c-g||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return qt(this.TABLE)}getHeight(){return rn(this.TABLE)}getTotalWidth(){const e=qt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=rn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return oc(this.TABLE)}_modifyRowHeaderWidth(e){let n=at(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const B3="stickyRowsBottom",XE={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Ss(XE,"MIXIN_NAME",B3,{writable:!1,enumerable:!1});const j3="stickyColumnsStart",Xp={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ss(Xp,"MIXIN_NAME",j3,{writable:!1,enumerable:!1});class ZE extends Sc{constructor(e,n,r,i){super(e,n,r,i,aa)}}ft(ZE,XE);ft(ZE,Xp);const Il="top",Co="bottom",Pl="inline_start",Ol="top_inline_start_corner",aa="bottom_inline_start_corner",lL=[Il,Co,Pl,Ol,aa],U3=new Map([[Il,`ht_clone_${Il}`],[Co,`ht_clone_${Co}`],[Pl,`ht_clone_${Pl} ht_clone_left`],[Ol,`ht_clone_${Ol} ht_clone_top_left_corner`],[aa,`ht_clone_${aa} ht_clone_bottom_left_corner`]]);function z3(t,e){Y3(t,e),e.add(t)}function Y3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function G3(t,e,n){return(e=q3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q3(t){var e=K3(t,"string");return typeof e=="symbol"?e:e+""}function K3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _f(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xc=new WeakSet;class X3{constructor(e){z3(this,Xc),G3(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Fr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Fr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return _f(Xc,this,Xx).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return _f(Xc,this,Xx).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return _f(Xc,this,Kx).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return _f(Xc,this,Kx).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function Kx(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Dn(r.wtRootElement).left;const u=Math.abs(Pk(s,s));if(l>u){const c=Ok(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function Xx(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Dn(n.wtRootElement),a=jE(o,o);if(s.top>a){const l=Gh(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Yr(t,e,n){return(e=Z3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z3(t){var e=J3(t,"string");return typeof e=="symbol"?e:e+""}function J3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JE{get eventManager(){return new Vi(this)}constructor(e,n){Yr(this,"wtTable",void 0),Yr(this,"wtScroll",void 0),Yr(this,"wtViewport",void 0),Yr(this,"wtOverlays",void 0),Yr(this,"selectionManager",void 0),Yr(this,"wtEvent",void 0),Yr(this,"guid",`wt_${hk()}`),Yr(this,"drawInterrupted",!1),Yr(this,"drawn",!1),Yr(this,"activeOverlayName","master"),Yr(this,"domBindings",void 0),Yr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new X3(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Tl(r,e[n])}])}}createCellCoords(e,n){return new Ml(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new Xd(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||$2(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function Zx(t,e,n){return(e=Q3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q3(t){var e=eX(t,"string");return typeof e=="symbol"?e:e+""}function eX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tX extends JE{constructor(e,n,r){super(e,n),Zx(this,"cloneSource",void 0),Zx(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new oL(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function nX(t,e,n){return(e=rX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rX(t){var e=iX(t,"string");return typeof e=="symbol"?e:e+""}function iX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jd{constructor(e,n,r,i,o){nX(this,"wtSettings",null),Ss(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=bd(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=bd(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Nm(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){Ze(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+bn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(lL.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${U3.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Ce(o,[ss()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Il||u==="vertical"&&this.type===Pl?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Nm(e.TABLE),new tX(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class oX extends Jd{constructor(e,n,r,i,o,s){super(e,n,aa,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new ZE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Yp(n),this.repositionOverlay();let r=rn(this.clone.wtTable.TABLE);const i=qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=bn(r)),i.style.bottom=`${o}px`}}const sX="calculatedColumns",Zp={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ss(Zp,"MIXIN_NAME",sX,{writable:!1,enumerable:!1});class QE extends Sc{constructor(e,n,r,i){super(e,n,r,i,Co)}}ft(QE,XE);ft(QE,Zp);function aX(t,e,n){return(e=lX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lX(t){var e=uX(t,"string");return typeof e=="symbol"?e:e+""}function uX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cX extends Jd{constructor(e,n,r,i){super(e,n,Co,r,i),aX(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new QE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=bn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(BE(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=bn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=rn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=bn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return jE(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ye(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(X(s,"innerBorderBottom"),o=!a):(we(s,"innerBorderBottom"),o=a)}return o}}const hX="calculatedRows",e0={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ss(e0,"MIXIN_NAME",hX,{writable:!1,enumerable:!1});class t0 extends Sc{constructor(e,n,r,i){super(e,n,r,i,Pl)}}ft(t0,e0);ft(t0,Xp);const dX="localHooks",En={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)nR(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Ss(En,"MIXIN_NAME",dX,{writable:!1,enumerable:!1});let uL=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};ft(uL,En);const cL="active-header",n0="header",r0="area",Lm="focus",fX="fill",gX="row",mX="column",pX="custom-selection",i0=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var Jx={},Qx;function wX(){if(Qx)return Jx;Qx=1;var t=qp();return t("flat"),Jx}wX();function vX(t,e){hL(t,e),e.add(t)}function eA(t,e,n){hL(t,e),e.set(t,n)}function hL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nt(t,e){return t.get(qh(t,e))}function tA(t,e,n){return t.set(qh(t,e),n),n}function qh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ri=new WeakMap,On=new WeakMap,Mf=new WeakSet;class CX{constructor(){vX(this,Mf),eA(this,Ri,void 0),eA(this,On,void 0)}setActiveOverlay(e){return tA(On,this,e),this}setActiveSelection(e){return tA(Ri,this,e),this}scan(){const e=Nt(Ri,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Nt(Ri,this).getCorners(),{wtTable:s}=Nt(On,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const w=Nt(On,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Nt(Ri,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});w!==null&&(w!==h&&(g=s.getColumnHeader(w,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Nt(Ri,this).getCorners(),{wtTable:s}=Nt(On,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const w=Nt(On,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Nt(Ri,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});w!==null&&(w!==h&&(g=s.getRowHeader(w,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Nt(On,this);qh(Mf,this,yX).call(this,(r,i)=>{const o=n.getCell(Nt(On,this).createCellCoords(r,i)),s=Nt(On,this).getSetting("onAfterDrawSelection",r,i,Nt(Ri,this).settings.layerLevel);typeof s=="string"&&X(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Nt(Ri,this).getCorners(),{wtTable:i}=Nt(On,this);qh(Mf,this,nA).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Nt(On,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Nt(Ri,this).getCorners(),{wtTable:i}=Nt(On,this);qh(Mf,this,nA).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Nt(On,this).createCellCoords(o,s));e(a)}})}}function yX(t){let[e,n,r,i]=Nt(Ri,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Nt(On,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Nt(On,this).createCellCoords(e,n));if(!fs(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function nA(t){const{wtTable:e}=Nt(On,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class rA{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=i0(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ji(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),So()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,r=n.getSetting("stylesHandler"),i=r.getCSSVariableValue("cell-mobile-handle-size"),o=r.getCSSVariableValue("cell-mobile-handle-border-radius"),s=r.getCSSVariableValue("cell-mobile-handle-background-color"),a=r.getCSSVariableValue("cell-mobile-handle-border-width"),l=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};De(h,(f,g)=>{this.selectionHandles.styles.bottomHitArea[g]=f,this.selectionHandles.styles.topHitArea[g]=f});const d=r.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};De(d,(f,g)=>{this.selectionHandles.styles.bottom[g]=f,this.selectionHandles.styles.top[g]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),w=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-w/4*3,10)}px`,c[l]=`${parseInt(i-w/4*3,10)}px`;const v=Math.min(parseInt(i+o,10),C-g-f*2),T=Math.min(parseInt(i+o-w/4,10),C-w-f*2);h[l]=`${v}px`,d[l]=`${T}px`;const P=Math.min(parseInt(r+s,10),S-g-f*2),x=Math.min(parseInt(r+s-w/4,10),S-w-f*2);h.top=`${P}px`,d.top=`${x}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),f=s.getFirstRenderedColumn(),g=s.getLastRenderedColumn();if(f<0&&g<0||h<0&&d<0){this.disappear();return}let w;if(u){if(r=Math.max(r,f),o=Math.min(o,g),n=Math.max(n,h),i=Math.min(i,d),o<r||i<n){this.disappear();return}w=s.getCell(this.wot.createCellCoords(n,r))}else if(w=s.getCell(this.wot.createCellCoords(n,r)),!fs(w)){this.disappear();return}const C=u?s.getCell(this.wot.createCellCoords(i,o)):w,S=Dn(w),v=u?Dn(C):S,T=Dn(s.TABLE),P=S.top,x=S.left,_=this.wot.wtSettings.getSetting("rtlMode");let M=0,V=0;if(_){const Ve=qt(s.TABLE),yt=qt(w),ot=l.innerWidth-T.left-Ve;V=x+yt-v.left,M=l.innerWidth-x-yt-ot-1}else V=v.left+qt(C)-x,M=x-T.left-1;if(this.isEntireColumnSelected(n,i)){const Ve=n,yt=this.getDimensionsFromHeader("columns",r,o,Ve,T);let ot=null;yt&&([ot,M,V]=yt),ot&&(w=ot)}let Y=P-T.top-1,O=v.top+rn(C)-P;if(this.isEntireRowSelected(r,o)){const Ve=r,yt=this.getDimensionsFromHeader("rows",n,i,Ve,T);let ot=null;yt&&([ot,Y,O]=yt),ot&&(w=ot)}const G=l.getComputedStyle(w);parseInt(G.borderTopWidth,10)>0&&(Y+=1,O=O>0?O-1:0),parseInt(G[_?"borderRightWidth":"borderLeftWidth"],10)>0&&(M+=1,V=V>0?V-1:0);const J=_?"right":"left",ae=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${Y}px`,this.topStyle[J]=`${M}px`,this.topStyle.width=`${V+ae}px`,this.topStyle.display="block",this.startStyle.top=`${Y}px`,this.startStyle[J]=`${M}px`,this.startStyle.height=`${O+ae}px`,this.startStyle.display="block",this.bottomStyle.top=`${Y+O-parseInt(this.bottomStyle.height,10)+ae}px`,this.bottomStyle[J]=`${M}px`,this.bottomStyle.width=`${V+ae}px`,this.bottomStyle.display="block",this.endStyle.top=`${Y}px`,this.endStyle[J]=`${M+V-parseInt(this.endStyle.width,10)+ae}px`,this.endStyle.height=`${O+ae}px`,this.endStyle.display="block";let te=this.settings.border.cornerVisible;te=typeof te=="function"?te(this.settings.layerLevel):te;const ne=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[Fe,ke]=[i,o];if(ne&&Array.isArray(ne)&&([,,Fe,ke]=ne),So()||!te||this.isPartRange(Fe,ke))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Y+O+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[J]=`${M+V+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ve=bd(s.TABLE);const yt=Ve===l;yt&&(Ve=a.documentElement);const ot=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,ut=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),pn=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=yt?C.getBoundingClientRect().left:C.offsetLeft;let p=!1,b=0;if(_?(b=m-parseInt(this.cornerDefaultStyle.width,10)/2,p=b<0):(b=m+qt(C)+parseInt(this.cornerDefaultStyle.width,10)/2,p=b>=Ok(Ve)),p){const D=Math.floor(M+V+this.cornerCenterPointOffset-ut-ot);c?(this.cornerStyle[J]=`${D}px`,this.cornerStyle[_?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[J]=`${D-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(yt?C.getBoundingClientRect().top:C.offsetTop)+rn(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=Gh(Ve)){const D=Math.floor(Y+O+this.cornerCenterPointOffset-pn-ot);c?(this.cornerStyle.top=`${D}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${D-1}px`}this.cornerStyle.display="block"}So()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,Y,M,V,O)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,w=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return rn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return qt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(g=l(n,C-i),w=l(r,C-i),!g||!w)return!1;const S=Dn(g),v=Dn(w);return g&&w&&(h=S[f]-o[f]-1,d=v[f]+u(w)-S[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?X(this[e],"hidden"):(ye(this[e],"hidden")&&we(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?X(this[e],"hidden"):we(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",So()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function bX(t,e){dL(t,e),e.add(t)}function Zl(t,e,n){dL(t,e),e.set(t,n)}function dL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(o0(t,e))}function iA(t,e,n){return t.set(o0(t,e),n),n}function o0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xn=new WeakMap,hr=new WeakMap,Wy=new WeakMap,Lh=new WeakMap,By=new WeakMap,Ea=new WeakMap,oA=new WeakSet;class SX{constructor(e){bX(this,oA),Zl(this,xn,void 0),Zl(this,hr,void 0),Zl(this,Wy,new CX),Zl(this,Lh,new WeakMap),Zl(this,By,new WeakSet),Zl(this,Ea,new Map),iA(hr,this,e)}setActiveOverlay(e){return iA(xn,this,e),xe(Wy,this).setActiveOverlay(xe(xn,this)),xe(Lh,this).has(xe(xn,this))||xe(Lh,this).set(xe(xn,this),new Set),this}getFocusSelection(){return xe(hr,this)!==null?xe(hr,this).getFocus():null}getAreaSelection(){return xe(hr,this)!==null?xe(hr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(xe(Ea,this).has(e)){const r=xe(Ea,this).get(e);if(r.has(xe(xn,this)))return r.get(xe(xn,this));const i=new rA(xe(xn,this),e.settings);return r.set(xe(xn,this),i),i}const n=new rA(xe(xn,this),e.settings);return xe(Ea,this).set(e,new Map([[xe(xn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=xe(Ea,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){xe(Ea,this).get(e).forEach(n=>n.destroy()),xe(Ea,this).delete(e)}render(e){if(xe(hr,this)===null)return;e&&o0(oA,this,RX).call(this);const n=Array.from(xe(hr,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;xe(By,this).has(s)||(xe(By,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&xe(Wy,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const w=r.get(g);w.has(a)&&u===!0?w.set(a,w.get(a)+1):w.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();xe(xn,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>xe(Lh,this).get(xe(xn,this)).add(u)),X(s,l),s.nodeName==="TD"&&Array.isArray((a=xe(hr,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ce(s,xe(hr,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Ce(o,[...i.get(o)])})}}function RX(){const t=xe(Lh,this).get(xe(xn,this)),e=xe(xn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=xe(xn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=xe(hr,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=xe(hr,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=xe(hr,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...xe(hr,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)we(o[a],n),yc(o[a],s)}),t.clear()}class EX extends Jd{constructor(e,n,r,i){super(e,n,Pl,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new t0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),UE(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Yp(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,Ik(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=bn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=qt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=i0(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ye(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=bn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,V2(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(Pk(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?we(r,"emptyRows"):X(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)X(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ye(r,"innerBorderInlineStart");e?(X(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(we(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const TX="stickyRowsTop",s0={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ss(s0,"MIXIN_NAME",TX,{writable:!1,enumerable:!1});class a0 extends Sc{constructor(e,n,r,i){super(e,n,r,i,Ol)}}ft(a0,s0);ft(a0,Xp);function sA(t,e,n){return(e=_X(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _X(t){var e=MX(t,"string");return typeof e=="symbol"?e:e+""}function MX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IX extends Jd{constructor(e,n,r,i,o,s){super(e,n,Ol,r,i),sA(this,"topOverlay",void 0),sA(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new a0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();UE(e,`${i}px`,`${o}px`)}else Yp(e);let n=rn(this.clone.wtTable.TABLE);const r=qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class l0 extends Sc{constructor(e,n,r,i){super(e,n,r,i,Il)}}ft(l0,s0);ft(l0,Zp);function PX(t,e,n){return(e=OX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OX(t){var e=xX(t,"string");return typeof e=="symbol"?e:e+""}function xX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AX extends Jd{constructor(e,n,r,i){super(e,n,Il,r,i),PX(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new l0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),UE(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Yp(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(BE(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=bn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=rn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=i0(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ye(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=bn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,F2(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return jE(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?we(i,"emptyColumns"):X(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ye(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(X(i,"innerBorderTop"),a=!h):(we(i,"innerBorderTop"),a=h)}}return a}}function If(t,e,n){HX(t,e),e.set(t,n)}function HX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lo(t,e,n){return(e=NX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NX(t){var e=DX(t,"string");return typeof e=="symbol"?e:e+""}function DX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ta(t,e,n){return t.set(fL(t,e),n),n}function $o(t,e){return t.get(fL(t,e))}function fL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jl=new WeakMap,Pf=new WeakMap,Ql=new WeakMap,Of=new WeakMap;class kX{constructor(e,n,r,i,o,s){Lo(this,"wot",null),If(this,Jl,[]),Lo(this,"topOverlay",null),Lo(this,"bottomOverlay",null),Lo(this,"inlineStartOverlay",null),Lo(this,"topInlineStartCornerOverlay",null),Lo(this,"bottomInlineStartCornerOverlay",null),Lo(this,"browserLineHeight",void 0),Lo(this,"wtSettings",null),If(this,Pf,!1),If(this,Ql,0),If(this,Of,null),Lo(this,"resizeObserver",new ResizeObserver(c=>{Am(()=>{!Array.isArray(c)||!c.length||(Ta(Ql,this,$o(Ql,this)+1),$o(Ql,this)===100&&(Ze("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),$o(Of,this)!==null&&clearTimeout($o(Of,this)),Ta(Of,this,setTimeout(()=>{Ta(Ql,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=bn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Nm(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...$o(Jl,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new AX(...e),this.bottomOverlay=new cX(...e),this.inlineStartOverlay=new EX(...e),this.topInlineStartCornerOverlay=new IX(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new oX(...e,this.bottomOverlay,this.inlineStartOverlay),Ta(Jl,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Ta(Pf,this,$o(Jl,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),$o(Jl,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),$o(Jl,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!Sk())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Am(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{Ta(Ql,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Kd(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!$o(Pf,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),Ta(Pf,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Nm(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),w=f()?1:0,C=g()?1:0;d.width=`${c+C}px`,d.height=`${u+w}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return H(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];H(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function aA(t,e,n){return(e=LX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LX(t){var e=$X(t,"string");return typeof e=="symbol"?e:e+""}function $X(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FX{constructor(e){aA(this,"settings",{}),aA(this,"defaults",Object.freeze(this.getDefaults())),De(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Tl(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?De(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class u0 extends Sc{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=bd(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Dm(e,"height",n),o=Dm(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=oc(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}ft(u0,e0);ft(u0,Zp);class VX{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new vK:new EK],["fullyVisible",()=>new lK],["partiallyVisible",()=>new eL]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new mK:new bK],["fullyVisible",()=>new oK],["partiallyVisible",()=>new Qk]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=rn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Dn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=rn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=qt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=bn(this.domBindings.rootDocument),new AK({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=bn(this.domBindings.rootDocument)),new PK({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){De(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}class WX extends JE{constructor(e,n){super(e,new FX(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new u0(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new VX(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new SX(this.wtSettings.getSetting("selections")),this.wtEvent=new oL(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new kX(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];De(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),we(this.wtTable.wtRootElement.parentNode,n),X(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!lL.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class c0{constructor(e){e instanceof JE?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new c0(n);return()=>r},this._wot=new WX(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function lA(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function BX(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}function uA(t){let{isLeftClick:e,selection:n,cellRangeMapper:r}=t;if(!e||n.settings.selectionMode!=="multiple")return;const i=n.getSelectedRange(),o=i.clone().map(a=>r.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!n.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),n.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),n.refresh())}}const jX=new Map([["touchstart",lA],["touchend",uA],["mousedown",lA],["mouseover",BX],["mouseup",uA]]);function jy(t,e){jX.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:zE(t)||t.type==="touchstart",isRightClick:_l(t),...e})}const gL=new WeakMap,h0=Symbol("rootInstance");function UX(t){gL.set(t,!0)}function zX(t){return t===h0}function Nu(t){return gL.has(t)}function YX(t,e){mL(t,e),e.add(t)}function _s(t,e,n){mL(t,e),e.set(t,n)}function mL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ms(t,e,n){return(e=GX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GX(t){var e=qX(t,"string");return typeof e=="symbol"?e:e+""}function qX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zt(t,e){return t.get(Zu(t,e))}function rr(t,e,n){return t.set(Zu(t,e),n),n}function Zu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Uy=new WeakMap,xf=new WeakMap,Af=new WeakMap,Fo=new WeakMap,vi=new WeakMap,zy=new WeakMap,Yy=new WeakMap,eu=new WeakMap,$h=new WeakSet;class KX{constructor(e){YX(this,$h),Ms(this,"hot",void 0),Ms(this,"eventManager",void 0),Ms(this,"settings",void 0),Ms(this,"THEAD",void 0),Ms(this,"TBODY",void 0),Ms(this,"_wt",void 0),Ms(this,"activeWt",void 0),_s(this,Uy,0),_s(this,xf,0),Ms(this,"postponedAdjustElementsSize",!1),_s(this,Af,!1),_s(this,Fo,void 0),_s(this,vi,void 0),_s(this,zy,0),_s(this,Yy,0),_s(this,eu,null),this.hot=e,this.eventManager=new Vi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Zu($h,this,ZX).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),X(e,"handsontable"),rr(vi,this,n.createElement("TABLE")),X(zt(vi,this),"htCore"),this.hot.getSettings().tableClassName&&X(zt(vi,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ce(zt(vi,this),[ss()]),Ce(e,[JG(),vk(-1),jp(this.hot.countCols()),f2()])),this.THEAD=n.createElement("THEAD"),zt(vi,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),zt(vi,this).appendChild(this.TBODY),this.hot.table=zt(vi,this),this.hot.container.insertBefore(zt(vi,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{rr(Af,this,!0),this.isTextSelectionAllowed(a.target)||(XO(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{rr(Af,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{zt(Af,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&XO(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&zE(a)&&r.finish(),rr(Fo,this,!1);const l=Dk(n.activeElement);im(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!_l(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&_l(a)&&(r.finish(),rr(Fo,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),rr(Fo,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(zt(Fo,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=bn(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=ic(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=ic(s);this.eventManager.addEventListener(zt(vi,this),"selectstart",a=>{this.settings.fragmentSelection||im(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&X(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&we(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:zt(vi,this),isDataViewInstance:()=>Nu(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),rr(xf,this,o.length),this.hot.getSettings().ariaTags&&Zu($h,this,pL).call(this)===this.hot.countCols()&&Zu($h,this,XX).call(this,zt(xf,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),rr(Uy,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let w=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(w=this.hot.runHooks("beforeValueRender",w,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,w,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,w,f),this.hot.runHooks("afterRenderer",a,l,u,g,w,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&oc(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,rr(Fo,this,!0),rr(eu,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!al(o)&&(jy(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,rr(Fo,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!al(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!al(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!al(o)&&(zt(Fo,this)&&(!zt(eu,this)||zt(eu,this).x!==o.clientX||zt(eu,this).y!==o.clientY)&&jy(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,rr(eu,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(al(o)||this.hot.isDestroyed)&&(jy(o,{coords:u,selection:this.hot.selection,cellRangeMapper:cq(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,w,C,S]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,1)):w,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,S>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(S,-1)):S]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new c0(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(im(e))return!0;const n=yl(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return zt(Fo,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!ye(r,"relative")){ms(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;ye(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",X(s,["relative",...o()])):(ms(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Ce(a,...ss()),Ce(l,...ss())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ye(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):ye(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?bc(e,r(n,i)):(Tl(e," "),X(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){rr(zy,this,e),rr(Yy,this,n)}getLastSize(){return{width:zt(zy,this),height:zt(Yy,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return zt(Uy,this)}getRowHeadersCount(){return zt(xf,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function pL(){return parseInt(this.hot.rootElement.getAttribute(jp()[0]),10)}function XX(t){const e=Zu($h,this,pL).call(this)+t;Ce(this.hot.rootElement,...jp(e))}function ZX(){const t=this.hot.rootElement;this.hasVerticalScroll()?X(t,"htHasScrollY"):we(t,"htHasScrollY"),this.hasHorizontalScroll()?X(t,"htHasScrollX"):we(t,"htHasScrollX")}var cA={},hA={},dA;function JX(){if(dA)return hA;dA=1;var t=pt(),e=an(),n=pc(),r=br(),i=un(),o=Io(),s=Sr(),a=ga(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return!n(h,function(f,g){if(!c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),hA}var fA;function QX(){return fA||(fA=1,JX()),cA}QX();const e4="ABCDEFGHIJKLMNOPQRSTUVWXYZ",gA=e4.length;function t4(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%gA,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/gA,10);return n}function wL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function vL(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ne(t[0])&&(e=WE(t[0]))),e}function n4(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function r4(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function Zc(t,e,n){return(e=i4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i4(t){var e=o4(t,"string");return typeof e=="symbol"?e:e+""}function o4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Zc(this,"hot",void 0),Zc(this,"data",void 0),Zc(this,"dataType","array"),Zc(this,"colToProp",()=>{}),Zc(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return H(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):de(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(Ne(a)||at(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;de(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?py(l,d,f):l[d]=f}})}else De(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?py(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Fr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:py(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?T2(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Fr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return de(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return vL(this.data)}destroy(){this.data=null,this.hot=null}}var mA={},pA={},wA;function a4(){if(wA)return pA;wA=1;var t=pt(),e=an(),n=pc(),r=br(),i=un(),o=Io(),s=Sr(),a=ga(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,g){if(c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),pA}var vA;function l4(){return vA||(vA=1,a4()),mA}l4();function CA(t,e,n){return(e=u4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u4(t){var e=c4(t,"string");return typeof e=="symbol"?e:e+""}function c4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;CA(this,"indexedValues",[]),CA(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,at(this.initValueOrFn)?de(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):de(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ft(Wl,En);function d0(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>at(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function f0(t,e){return Rl(t,(n,r)=>e.includes(r)===!1)}class wa extends Wl{insert(e,n){this.indexedValues=d0(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=f0(this.indexedValues,e),super.remove(e)}}class Jp extends wa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Rr(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function g0(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Sd(t,e){return Rl(t,n=>e.includes(n)===!1)}function m0(t,e){return je(t,n=>n-e.filter(r=>r<n).length)}function p0(t,e){const n=e[0],r=e.length;return je(t,i=>i>=n?i+r:i)}function h4(t,e,n){return(e=d4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d4(t){var e=f4(t,"string");return typeof e=="symbol"?e:e+""}function f4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qp extends Wl{constructor(){super(...arguments),h4(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Sd(this.orderOfIndexes,[e]),at(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=d0(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=p0(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=f0(this.indexedValues,e),this.orderOfIndexes=Sd(this.orderOfIndexes,e),this.orderOfIndexes=m0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Qd extends wa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Rr(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const yA=new Map([["indexesSequence",{getListWithInsertedItems:g0,getListWithRemovedItems:Sd}],["physicallyIndexed",{getListWithInsertedItems:d0,getListWithRemovedItems:f0}]]),CL=t=>{if(yA.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return yA.get(t)};class yL extends Wl{constructor(){super(e=>e)}insert(e,n){const r=p0(this.indexedValues,n);this.indexedValues=g0(r,e,n),super.insert(e,n)}remove(e){const n=Sd(this.indexedValues,e);this.indexedValues=m0(n,e),super.remove(e)}}const bA=new Map([["hiding",Jp],["index",Wl],["linkedPhysicalIndexToValue",Qp],["physicalIndexToValue",wa],["trimming",Qd]]);function g4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!bA.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(bA.get(t))(e)}function m4(t,e,n){return(e=p4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p4(t){var e=w4(t,"string");return typeof e=="symbol"?e:e+""}function w4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w0{constructor(){m4(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)))}unregister(e){const n=this.collection.get(e);ue(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n))}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Pt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}ft(w0,En);function Gy(t,e,n){return(e=v4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v4(t){var e=C4(t,"string");return typeof e=="symbol"?e:e+""}function C4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SA extends w0{constructor(e,n){super(),Gy(this,"mergedValuesCache",[]),Gy(this,"aggregationFunction",void 0),Gy(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=je(this.get(),o=>o.getValues()),r=[],i=ue(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return je(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ue(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function y4(t,e,n){b4(t,e),e.set(t,n)}function b4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S4(t,e,n){return t.set(bL(t,e),n),n}function R4(t,e){return t.get(bL(t,e))}function bL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qy=new WeakMap;class SL{constructor(){y4(this,qy,[])}subscribe(e){return this.addLocalHook("change",e),this._write(R4(qy,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){S4(qy,this,e)}}ft(SL,En);function RA(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Jc(t,e,n){E4(t,e),e.set(t,n)}function E4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gr(t,e){return t.get(RL(t,e))}function Hf(t,e,n){return t.set(RL(t,e),n),n}function RL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nf=new WeakMap,Qc=new WeakMap,Df=new WeakMap,kf=new WeakMap,Lf=new WeakMap;class T4{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Jc(this,Nf,new Set),Jc(this,Qc,[]),Jc(this,Df,[]),Jc(this,kf,!1),Jc(this,Lf,!1),Hf(Lf,this,e??!1)}createObserver(){const e=new SL;return Gr(Nf,this).add(e),e.addLocalHook("unsubscribe",()=>{Gr(Nf,this).delete(e)}),e._writeInitialChanges(RA(Gr(Qc,this),Gr(Df,this))),e}emit(e){let n=Gr(Df,this);(!Gr(kf,this)||Gr(Qc,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Gr(Lf,this)):Hf(Qc,this,new Array(e.length).fill(Gr(Lf,this))),Gr(kf,this)||(Hf(kf,this,!0),n=Gr(Qc,this)));const r=RA(n,e);Gr(Nf,this).forEach(i=>i._write(r)),Hf(Df,this,e)}}function Vn(t,e,n){return(e=_4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _4(t){var e=M4(t,"string");return typeof e=="symbol"?e:e+""}function M4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lR{constructor(){Vn(this,"indexesSequence",new yL),Vn(this,"trimmingMapsCollection",new SA(e=>e.some(n=>n===!0),!1)),Vn(this,"hidingMapsCollection",new SA(e=>e.some(n=>n===!0),!1)),Vn(this,"variousMapsCollection",new w0),Vn(this,"hidingChangesObservable",new T4({initialIndexValue:!1})),Vn(this,"notTrimmedIndexesCache",[]),Vn(this,"notHiddenIndexesCache",[]),Vn(this,"isBatched",!1),Vn(this,"indexesSequenceChanged",!1),Vn(this,"indexesChangeSource",void 0),Vn(this,"trimmedIndexesChanged",!1),Vn(this,"hiddenIndexesChanged",!1),Vn(this,"renderablePhysicalIndexesCache",[]),Vn(this,"fromPhysicalToVisualIndexesCache",new Map),Vn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,g4(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Qd?this.trimmingMapsCollection.register(e,n):n instanceof Jp?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ue(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ue(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ue(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ue(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=je(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Sd(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(g0(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=ue(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=je(new Array(n).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=r==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}ft(lR,En);function I4(t,e){return De(e,(n,r)=>{Pt(t[r])&&(t[r]=n)}),t}function EL(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function TL(t){ue(t)&&YE(it`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function P4(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:O4,getValues:x4}=fi("phraseFormatters");function A4(t,e){O4(t,e)}function H4(){return x4()}A4("pluralize",P4);const _L="ContextMenu:items",_e=_L,v0=`${_e}.noItems`,C0=`${_e}.insertRowAbove`,y0=`${_e}.insertRowBelow`,b0=`${_e}.insertColumnOnTheLeft`,S0=`${_e}.insertColumnOnTheRight`,R0=`${_e}.removeRow`,E0=`${_e}.removeColumn`,T0=`${_e}.undo`,_0=`${_e}.redo`,$m=`${_e}.readOnly`,M0=`${_e}.clearColumn`,I0=`${_e}.copy`,P0=`${_e}.copyWithHeaders`,O0=`${_e}.copyWithGroupHeaders`,x0=`${_e}.copyHeadersOnly`,A0=`${_e}.cut`,H0=`${_e}.freezeColumn`,N0=`${_e}.unfreezeColumn`,D0=`${_e}.mergeCells`,k0=`${_e}.unmergeCells`,L0=`${_e}.addComment`,$0=`${_e}.editComment`,F0=`${_e}.removeComment`,V0=`${_e}.readOnlyComment`,W0=`${_e}.align`,B0=`${_e}.align.left`,j0=`${_e}.align.center`,U0=`${_e}.align.right`,z0=`${_e}.align.justify`,Y0=`${_e}.align.top`,G0=`${_e}.align.middle`,q0=`${_e}.align.bottom`,K0=`${_e}.borders`,X0=`${_e}.borders.top`,Z0=`${_e}.borders.right`,J0=`${_e}.borders.bottom`,Q0=`${_e}.borders.left`,eT=`${_e}.borders.remove`,tT=`${_e}.nestedHeaders.insertChildRow`,nT=`${_e}.nestedHeaders.detachFromParent`,rT=`${_e}.hideColumn`,iT=`${_e}.showColumn`,oT=`${_e}.hideRow`,sT=`${_e}.showRow`,Qn="Filters:",$t=`${Qn}conditions`,ew=`${$t}.none`,aT=`${$t}.isEmpty`,lT=`${$t}.isNotEmpty`,uT=`${$t}.isEqualTo`,cT=`${$t}.isNotEqualTo`,hT=`${$t}.beginsWith`,dT=`${$t}.endsWith`,fT=`${$t}.contains`,gT=`${$t}.doesNotContain`,N4=`${$t}.byValue`,mT=`${$t}.greaterThan`,pT=`${$t}.greaterThanOrEqualTo`,wT=`${$t}.lessThan`,vT=`${$t}.lessThanOrEqualTo`,CT=`${$t}.isBetween`,yT=`${$t}.isNotBetween`,bT=`${$t}.after`,ST=`${$t}.before`,RT=`${$t}.today`,ET=`${$t}.tomorrow`,TT=`${$t}.yesterday`,_T=`${Qn}labels.filterByCondition`,MT=`${Qn}labels.filterByValue`,IT=`${Qn}labels.conjunction`,tw=`${Qn}labels.disjunction`,Fm=`${Qn}values.blankCells`,PT=`${Qn}buttons.selectAll`,OT=`${Qn}buttons.clear`,xT=`${Qn}buttons.ok`,AT=`${Qn}buttons.cancel`,HT=`${Qn}buttons.placeholder.search`,NT=`${Qn}buttons.placeholder.value`,DT=`${Qn}buttons.placeholder.secondValue`,kT="CheckboxRenderer:",LT=`${kT}checked`,$T=`${kT}unchecked`,D4=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:LT,CHECKBOX_RENDERER_NAMESPACE:kT,CHECKBOX_UNCHECKED:$T,CONTEXTMENU_ITEMS_ADD_COMMENT:L0,CONTEXTMENU_ITEMS_ALIGNMENT:W0,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:q0,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:j0,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:z0,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:B0,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:G0,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:U0,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Y0,CONTEXTMENU_ITEMS_BORDERS:K0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:J0,CONTEXTMENU_ITEMS_BORDERS_LEFT:Q0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:Z0,CONTEXTMENU_ITEMS_BORDERS_TOP:X0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:M0,CONTEXTMENU_ITEMS_COPY:I0,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:x0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:O0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:P0,CONTEXTMENU_ITEMS_CUT:A0,CONTEXTMENU_ITEMS_EDIT_COMMENT:$0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:H0,CONTEXTMENU_ITEMS_HIDE_COLUMN:rT,CONTEXTMENU_ITEMS_HIDE_ROW:oT,CONTEXTMENU_ITEMS_INSERT_LEFT:b0,CONTEXTMENU_ITEMS_INSERT_RIGHT:S0,CONTEXTMENU_ITEMS_MERGE_CELLS:D0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:nT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:tT,CONTEXTMENU_ITEMS_NO_ITEMS:v0,CONTEXTMENU_ITEMS_READ_ONLY:$m,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:V0,CONTEXTMENU_ITEMS_REDO:_0,CONTEXTMENU_ITEMS_REMOVE_BORDERS:eT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:E0,CONTEXTMENU_ITEMS_REMOVE_COMMENT:F0,CONTEXTMENU_ITEMS_REMOVE_ROW:R0,CONTEXTMENU_ITEMS_ROW_ABOVE:C0,CONTEXTMENU_ITEMS_ROW_BELOW:y0,CONTEXTMENU_ITEMS_SHOW_COLUMN:iT,CONTEXTMENU_ITEMS_SHOW_ROW:sT,CONTEXTMENU_ITEMS_UNDO:T0,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:N0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:k0,CONTEXT_MENU_ITEMS_NAMESPACE:_L,FILTERS_BUTTONS_CANCEL:AT,FILTERS_BUTTONS_CLEAR:OT,FILTERS_BUTTONS_OK:xT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:HT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:DT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:NT,FILTERS_BUTTONS_SELECT_ALL:PT,FILTERS_CONDITIONS_AFTER:bT,FILTERS_CONDITIONS_BEFORE:ST,FILTERS_CONDITIONS_BEGINS_WITH:hT,FILTERS_CONDITIONS_BETWEEN:CT,FILTERS_CONDITIONS_BY_VALUE:N4,FILTERS_CONDITIONS_CONTAINS:fT,FILTERS_CONDITIONS_EMPTY:aT,FILTERS_CONDITIONS_ENDS_WITH:dT,FILTERS_CONDITIONS_EQUAL:uT,FILTERS_CONDITIONS_GREATER_THAN:mT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:pT,FILTERS_CONDITIONS_LESS_THAN:wT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:vT,FILTERS_CONDITIONS_NAMESPACE:$t,FILTERS_CONDITIONS_NONE:ew,FILTERS_CONDITIONS_NOT_BETWEEN:yT,FILTERS_CONDITIONS_NOT_CONTAIN:gT,FILTERS_CONDITIONS_NOT_EMPTY:lT,FILTERS_CONDITIONS_NOT_EQUAL:cT,FILTERS_CONDITIONS_TODAY:RT,FILTERS_CONDITIONS_TOMORROW:ET,FILTERS_CONDITIONS_YESTERDAY:TT,FILTERS_DIVS_FILTER_BY_CONDITION:_T,FILTERS_DIVS_FILTER_BY_VALUE:MT,FILTERS_LABELS_CONJUNCTION:IT,FILTERS_LABELS_DISJUNCTION:tw,FILTERS_NAMESPACE:Qn,FILTERS_VALUES_BLANK_CELLS:Fm},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const ML={languageCode:"en-US",[v0]:"No available options",[C0]:"Insert row above",[y0]:"Insert row below",[b0]:"Insert column left",[S0]:"Insert column right",[R0]:["Remove row","Remove rows"],[E0]:["Remove column","Remove columns"],[T0]:"Undo",[_0]:"Redo",[$m]:"Read only",[M0]:"Clear column",[W0]:"Alignment",[B0]:"Left",[j0]:"Center",[U0]:"Right",[z0]:"Justify",[Y0]:"Top",[G0]:"Middle",[q0]:"Bottom",[H0]:"Freeze column",[N0]:"Unfreeze column",[K0]:"Borders",[X0]:"Top",[Z0]:"Right",[J0]:"Bottom",[Q0]:"Left",[eT]:"Remove border(s)",[L0]:"Add comment",[$0]:"Edit comment",[F0]:"Delete comment",[V0]:"Read-only comment",[D0]:"Merge cells",[k0]:"Unmerge cells",[I0]:"Copy",[P0]:["Copy with header","Copy with headers"],[O0]:["Copy with group header","Copy with group headers"],[x0]:["Copy header only","Copy headers only"],[A0]:"Cut",[tT]:"Insert child row",[nT]:"Detach from parent",[rT]:["Hide column","Hide columns"],[iT]:["Show column","Show columns"],[oT]:["Hide row","Hide rows"],[sT]:["Show row","Show rows"],[ew]:"None",[aT]:"Is empty",[lT]:"Is not empty",[uT]:"Is equal to",[cT]:"Is not equal to",[hT]:"Begins with",[dT]:"Ends with",[fT]:"Contains",[gT]:"Does not contain",[mT]:"Greater than",[pT]:"Greater than or equal to",[wT]:"Less than",[vT]:"Less than or equal to",[CT]:"Is between",[yT]:"Is not between",[bT]:"After",[ST]:"Before",[RT]:"Today",[ET]:"Tomorrow",[TT]:"Yesterday",[Fm]:"Blank cells",[_T]:"Filter by condition",[MT]:"Filter by value",[IT]:"And",[tw]:"Or",[PT]:"Select all",[OT]:"Clear",[xT]:"OK",[AT]:"Cancel",[HT]:"Search",[NT]:"Value",[DT]:"Second value",[LT]:"Checked",[$T]:"Unchecked"},k4=D4,uR=ML.languageCode,{register:L4,getItem:IL,hasItem:$4,getValues:F4}=fi("languagesDictionaries");PL(ML);function PL(t,e){let n=t,r=e;return Ne(t)&&(r=t,n=r.languageCode),V4(n,r),L4(n,Jn(r)),Jn(r)}function V4(t,e){t!==uR&&I4(e,IL(uR))}function OL(t){return FT(t)?Jn(IL(t)):null}function FT(t){return $4(t)}function W4(){return F4()}function xL(t,e,n){const r=OL(t);if(r===null)return null;const i=r[e];if(Pt(i))return null;const o=B4(i,n);return Array.isArray(o)?o[0]:o}function B4(t,e){let n=t;return H(H4(),r=>{n=r(t,e)}),n}function j4(t){let e=EL(t);return FT(e)||(e=uR,TL(t)),e}function U4(t,e,n){return(e=z4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z4(t){var e=Y4(t,"string");return typeof e=="symbol"?e:e+""}function Y4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rs extends uL{constructor(e,n){super(e,null),U4(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function Ky(t){let{activeHeaderClassName:e,...n}=t;return new Rs({className:e,...n,selectionType:cL})}function G4(t){let{areaCornerVisible:e,...n}=t;return new Rs({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:r0})}function q4(t){let{...e}=t;return new Rs({className:"highlight",...e,selectionType:r0})}function K4(t){let{columnClassName:e,...n}=t;return new Rs({className:e,...n,selectionType:mX})}function X4(t){let{cellCornerVisible:e,...n}=t;return new Rs({className:"current",headerAttributes:[FE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Lm})}function Z4(t){let{border:e,visualCellRange:n,...r}=t;return new Rs({...e,...r,selectionType:pX},n)}function J4(t){let{...e}=t;return new Rs({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:fX})}function EA(t){let{headerClassName:e,...n}=t;return new Rs({className:e,...n,selectionType:n0})}function Q4(t){let{rowClassName:e,...n}=t;return new Rs({className:e,...n,selectionType:gX})}function e6(t,e){t6(t,e),e.add(t)}function t6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ir(t,e,n){return(e=n6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n6(t){var e=r6(t,"string");return typeof e=="symbol"?e:e+""}function r6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ki=new WeakSet;class i6{constructor(e){e6(this,Ki),ir(this,"options",void 0),ir(this,"layerLevel",0),ir(this,"focus",void 0),ir(this,"fill",void 0),ir(this,"layeredAreas",new Map),ir(this,"areas",new Map),ir(this,"rowHeaders",new Map),ir(this,"columnHeaders",new Map),ir(this,"activeRowHeaders",new Map),ir(this,"activeColumnHeaders",new Map),ir(this,"activeCornerHeaders",new Map),ir(this,"rowHighlights",new Map),ir(this,"columnHighlights",new Map),ir(this,"customSelections",[]),this.options=e,this.focus=X4(e),this.fill=J4(e)}isEnabledFor(e,n){let r=e;e===Lm&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Vo(Ki,this,Wo).call(this,this.layeredAreas,G4)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Vo(Ki,this,Wo).call(this,this.areas,q4)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Vo(Ki,this,Wo).call(this,this.rowHeaders,EA)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Vo(Ki,this,Wo).call(this,this.columnHeaders,EA)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Vo(Ki,this,Wo).call(this,this.activeRowHeaders,Ky)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Vo(Ki,this,Wo).call(this,this.activeColumnHeaders,Ky)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Vo(Ki,this,Wo).call(this,this.activeCornerHeaders,Ky)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Vo(Ki,this,Wo).call(this,this.rowHighlights,Q4)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Vo(Ki,this,Wo).call(this,this.columnHighlights,K4)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Z4({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),H(this.areas.values(),e=>void e.clear()),H(this.layeredAreas.values(),e=>void e.clear()),H(this.rowHeaders.values(),e=>void e.clear()),H(this.columnHeaders.values(),e=>void e.clear()),H(this.activeRowHeaders.values(),e=>void e.clear()),H(this.activeColumnHeaders.values(),e=>void e.clear()),H(this.activeCornerHeaders.values(),e=>void e.clear()),H(this.rowHighlights.values(),e=>void e.clear()),H(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Wo(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function TA(t,e,n){return(e=o6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o6(t){var e=s6(t,"string");return typeof e=="symbol"?e:e+""}function s6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VT{constructor(e){TA(this,"ranges",[]),TA(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((r,i)=>r.includes(e)&&n(r,i))}findAll(e){const n=[];return this.ranges.forEach((r,i)=>{r.isEqual(e)&&n.push({range:r,layer:i})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(r=>r.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,r)=>!e.includes(r)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new VT(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,r)=>e(n,r)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function a6(t,e){AL(t,e),e.add(t)}function Xy(t,e,n){AL(t,e),e.set(t,n)}function AL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(t,e){return t.get(en(t,e))}function $f(t,e,n){return t.set(en(t,e),n),n}function en(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ff=new WeakMap,Ct=new WeakMap,Di=new WeakMap,fn=new WeakSet;class cR{constructor(e,n){a6(this,fn),Xy(this,Ff,void 0),Xy(this,Ct,void 0),Xy(this,Di,{x:0,y:0}),$f(Ff,this,e),$f(Ct,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=qe(Ct,this).createCellCoords(e,n);let o=qe(Ff,this).current().highlight;const s=qe(Ct,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=en(fn,this,HL).call(this),{row:h,col:d}=en(fn,this,MA).call(this,o),f=qe(Ct,this).fixedRowsBottom(),g=qe(Ct,this).minSpareRows(),w=qe(Ct,this).minSpareCols(),C=qe(Ct,this).autoWrapRow(),S=qe(Ct,this).autoWrapCol(),v=qe(Ct,this).createCellCoords(h+i.row,d+i.col);if(v.row>=c){const x=Fr(r&&g>0&&f===0),_=v.col+1,M=qe(Ct,this).createCellCoords(v.row-c,_>=u?_-u:_);this.runLocalHooks("beforeColumnWrap",x,en(fn,this,tu).call(this,M),_>=u),x.value?this.runLocalHooks("insertRowRequire",qe(Ct,this).countRenderableRows()):S&&v.assign(M)}else if(v.row<0){const x=Fr(S),_=v.col-1,M=qe(Ct,this).createCellCoords(c+v.row,_<0?u+_:_);this.runLocalHooks("beforeColumnWrap",x,en(fn,this,tu).call(this,M),_<0),S&&v.assign(M)}if(v.col>=u){const x=Fr(r&&w>0),_=v.row+1,M=qe(Ct,this).createCellCoords(_>=c?_-c:_,v.col-u);this.runLocalHooks("beforeRowWrap",x,en(fn,this,tu).call(this,M),_>=c),x.value?this.runLocalHooks("insertColRequire",qe(Ct,this).countRenderableColumns()):C&&v.assign(M)}else if(v.col<0){const x=Fr(C),_=v.row-1,M=qe(Ct,this).createCellCoords(_<0?c+_:_,u+v.col);this.runLocalHooks("beforeRowWrap",x,en(fn,this,tu).call(this,M),_<0),C&&v.assign(M)}const{rowDir:T,colDir:P}=en(fn,this,_A).call(this,v);a=T,l=P,o=en(fn,this,tu).call(this,v)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=qe(Ct,this).createCellCoords(e,n),i=qe(Ff,this).current(),o=qe(Ct,this).visualToRenderableCoords(i.highlight),s=en(fn,this,Zy).call(this,i.to.row,i.from.row),a=en(fn,this,Jy).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=en(fn,this,MA).call(this,i.highlight),f=qe(Ct,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),w=i.getTopEndCorner(),C=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const P=f.col-d;f.col=en(fn,this,Jy).call(this,g.col,w.col)+P}else if(r.col>0&&a<=d&&f.col>d){const P=en(fn,this,Jy).call(this,w.col,g.col),x=Math.max(f.col-P,1);f.col=P+x}if(r.row<0&&s>=h&&f.row<h){const P=f.row-h;f.row=en(fn,this,Zy).call(this,g.row,C.row)+P}else if(r.row>0&&s<=h&&f.row>h){const P=en(fn,this,Zy).call(this,C.row,g.row),x=Math.max(f.row-P,1);f.row=P+x}const{rowDir:S,colDir:v}=en(fn,this,_A).call(this,f);u=S,c=v;const T=en(fn,this,tu).call(this,f);r.row===0&&r.col!==0?l.col=T.col:r.row!==0&&r.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;$f(Di,this,{x:n,y:r})}resetOffsetSize(){$f(Di,this,{x:0,y:0})}}function _A(t){const{width:e,height:n}=en(fn,this,HL).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function HL(){return{width:qe(Di,this).x+qe(Ct,this).countRenderableColumns(),height:qe(Di,this).y+qe(Ct,this).countRenderableRows()}}function Zy(t,e){const n=qe(Ct,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:qe(Di,this).y+n}function Jy(t,e){const n=qe(Ct,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:qe(Di,this).x+n}function MA(t){const{row:e,col:n}=qe(Ct,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return qe(Ct,this).createCellCoords(qe(Di,this).y+e,qe(Di,this).x+n)}function tu(t){const e=t.clone();return e.col=t.col-qe(Di,this).x,e.row=t.row-qe(Di,this).y,qe(Ct,this).renderableToVisualCoords(e)}ft(cR,En);const nw=0,rw=1,NL=2,WT=3,l6=[WT,NL],u6=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Qy=Symbol("root"),IA=Symbol("child");function ac(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qy;if(e!==Qy&&e!==IA)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Qy;let i=nw;if(n){const o=t[0];t.length===0?i=rw:r&&o instanceof Xd?i=WT:r&&Array.isArray(o)?i=ac(o,IA):t.length>=2&&t.length<=4&&!t.some((a,l)=>!u6[l].includes(typeof a))&&(i=NL)}return i}function Rd(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!l6.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===WT;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Pt(u)&&(u=a),Pt(c)&&(c=l),!r){const f=a,g=l,w=u,C=c;a=Math.min(f,w),l=Math.min(g,C),u=Math.max(f,w),c=Math.max(g,C)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function c6(t){const e=ac(t.getSelected());if(e===nw||e===rw)return[];const n=Rd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;H(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;H(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Rr(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function h6(t){const e=ac(t.getSelected());if(e===nw||e===rw)return[];const n=Rd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;H(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;H(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Rr(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function nu(t,e,n){d6(t,e),e.set(t,n)}function d6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _a(t,e,n){return(e=f6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f6(t){var e=g6(t,"string");return typeof e=="symbol"?e:e+""}function g6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function St(t,e){return t.get(DL(t,e))}function Xi(t,e,n){return t.set(DL(t,e),n),n}function DL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mn=new WeakMap,Ma=new WeakMap,Vf=new WeakMap,eh=new WeakMap,Wf=new WeakMap,th=new WeakMap;class kL{constructor(e,n){var r=this;_a(this,"settings",void 0),_a(this,"tableProps",void 0),_a(this,"inProgress",!1),_a(this,"selectedRange",new VT((i,o,s)=>this.tableProps.createCellRange(i,o,s))),_a(this,"highlight",void 0),nu(this,Mn,void 0),nu(this,Ma,void 0),_a(this,"selectedByRowHeader",new Set),_a(this,"selectedByColumnHeader",new Set),nu(this,Vf,!1),nu(this,eh,!1),nu(this,Wf,"unknown"),nu(this,th,-1),this.settings=e,this.tableProps=n,this.highlight=new i6({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[FE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),Xi(Mn,this,new cR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Xi(Ma,this,new cR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),St(Mn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),St(Mn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),St(Mn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),St(Mn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),St(Mn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),St(Mn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),St(Mn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),St(Mn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),St(Ma,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),St(Ma,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Xi(Wf,this,e)}markEndSource(){Xi(Wf,this,"unknown")}getSelectionSource(){return St(Wf,this)}setExpectedLayers(e){Xi(th,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Xi(th,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Pt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Xi(Vf,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Pt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=St(th,this)===-1||this.selectedRange.size()===St(th,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(H(this.highlight.getAreas(),g=>void g.clear()),H(this.highlight.getLayeredAreas(),g=>void g.clear()),H(this.highlight.getRowHeaders(),g=>void g.clear()),H(this.highlight.getColumnHeaders(),g=>void g.clear()),H(this.highlight.getActiveRowHeaders(),g=>void g.clear()),H(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),H(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),H(this.highlight.getRowHighlights(),g=>void g.clear()),H(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(r0,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(n0,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),S=this.tableProps.createCellCoords(e.to.row,-1),v=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(v).commit(),d.add(C).commit(),f.add(v).commit()):(a.add(C).add(S).commit(),l.add(v).add(T).commit(),d.add(C).add(S).commit(),f.add(v).add(T).commit())}const g=!St(eh,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),w=!St(eh,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),w&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&w&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Lm,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(Xi(Vf,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?St(Mn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):St(Mn,this).resetOffsetSize(),this.setRangeStart(St(Mn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?St(Mn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):St(Mn,this).resetOffsetSize(),this.setRangeEnd(St(Mn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?St(Ma,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):St(Ma,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=St(Ma,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(ze(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(ze(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(ze(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,ze(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,ze(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,ze(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const n=Fr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&St(Vf,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;Xi(eh,this,f),d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(ze(d.row,u,o-1),ze(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),w=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.finish(),Xi(eh,this,!1)}selectCells(e){var n=this;const r=ac(e);if(r===rw)return!1;if(r===nw)throw new Error(it`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Rd(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),H(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(f=ze(r.row,u,s-1),g=ze(r.col,Math.min(i,o),Math.max(i,o))):(f=ze(r,u,s-1),g=i);const w=this.tableProps.createCellCoords(f,g),C=l===0?0:ze(w.row,u,-1),S=s-1,v=this.tableProps.createCellCoords(C,i),T=this.tableProps.createCellCoords(S,o);this.runLocalHooks("beforeSelectColumns",v,T,w),v.row=C,T.row=S,this.setRangeStartOnly(v,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",v,T,w),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(h=ze(r.row,Math.min(e,n),Math.max(e,n)),d=ze(r.col,a,o-1)):(h=e,d=ze(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:ze(f.col,a,-1),w=o-1,C=this.tableProps.createCellCoords(e,g),S=this.tableProps.createCellCoords(n,w);this.runLocalHooks("beforeSelectRows",C,S,f),C.col=g,S.col=w,this.setRangeStartOnly(C,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectRows",C,S,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(r.length),r.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=n-1;u.assign({row:ze(u.row,this.settings.navigableHeaders?-1/0:0,c),col:ze(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:ze(a.row,-1/0,c),col:ze(a.col,-1/0,h)}),l.assign({row:ze(l.row,-1/0,c),col:ze(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(Lm,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}ft(kL,En);const PA=/^(\r\n|\n\r|\r|\n)/,m6=/^[^\t\r\n]+/,OA=/^\t/;function p6(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(OA))t=t.replace(OA,""),n+=1,e[r][n]="";else if(t.match(PA))t=t.replace(PA,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(m6);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Kh(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Ia(t,e,n){return(e=w6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w6(t){var e=v6(t,"string");return typeof e=="symbol"?e:e+""}function v6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){Ia(this,"hot",void 0),Ia(this,"metaManager",void 0),Ia(this,"tableMeta",void 0),Ia(this,"dataSource",void 0),Ia(this,"duckSchema",void 0),Ia(this,"colToPropCache",void 0),Ia(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=WE(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Ne(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return vL(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&De(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ue(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ue(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Cd(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Jn(this.getSchema()):(g=[],de(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},Up(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,n,r)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let f=0;for(let g=d;f<n&&l+f<s;g++){if(typeof c!="number"||c>=l+f)if(u>0)for(let w=0;w<u;w+=1)typeof o[w]>"u"&&(o[w]=[]),o[w].push(null);else o.push([null]);else for(let w=0;w<u;w++)o[w].splice(g,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(c,f,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ue(this.tableMeta.columns)||ue(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];kO(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return zG(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];kO(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&nn(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Fr(a);this.hot.runHooks("modifyData",e,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Fr(o);this.hot.runHooks("modifyData",e,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&nn(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Bu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Bu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return Kh(this.getRange(e,n,Bu.DESTINATION_RENDERER))}getCopyableText(e,n){return Kh(this.getRange(e,n,Bu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:C6,getItem:y6,hasItem:LL,getNames:Tfe,getValues:_fe}=fi("cellTypes");function b6(t){if(!LL(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return y6(t)}function Ei(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Pr(t,n),r&&Kr(t,r),i&&Hu(t,i),C6(t,e)}function S6(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!nn(e,t)}function iw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?b6(e.type):e.type;if(t._automaticallyAssignedMetaProps&&De(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Ne(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};De(r,(o,s)=>{if(S6(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),on(t,i)}function R6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}E2(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function om(t){return Number.isInteger(t)&&t>=0}function sm(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Bf(t){return t==null}const $L=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),jt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),jt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),VE(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function xA(t,e,n){return(e=E6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E6(t){var e=T6(t,"string");return typeof e=="symbol"?e:e+""}function T6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _6(){return class{}}class M6{constructor(e){xA(this,"metaCtor",_6()),xA(this,"meta",void 0),this.meta=this.metaCtor.prototype,on(this.meta,$L()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;on(this.meta,e),iw(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function I6(t,e,n){return(e=P6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P6(t){var e=O6(t,"string");return typeof e=="symbol"?e:e+""}function O6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x6{constructor(e){I6(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){on(this.meta,e),iw(this.meta,e,e)}}function jf(t,e,n){return(e=A6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A6(t){var e=H6(t,"string");return typeof e=="symbol"?e:e+""}function H6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vm{constructor(e){jf(this,"valueFactory",void 0),jf(this,"data",[]),jf(this,"index",[]),jf(this,"holes",new Set),this.valueFactory=e}obtain(e){sm(()=>om(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;sm(()=>om(e)||Bf(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Bf(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;sm(()=>om(e)||Bf(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Bf(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function AA(t,e,n){return(e=N6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N6(t){var e=D6(t,"string");return typeof e=="symbol"?e:e+""}function D6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const k6=["data","width"];class L6{constructor(e){AA(this,"globalMeta",void 0),AA(this,"metas",new Vm(()=>this._createMeta())),this.globalMeta=e,this.metas=new Vm(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);on(r,n),iw(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return R6(this.globalMeta.getMetaConstructor(),k6).prototype}}function HA(t,e,n){return(e=$6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $6(t){var e=F6(t,"string");return typeof e=="symbol"?e:e+""}function F6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V6{constructor(e){HA(this,"columnMeta",void 0),HA(this,"metas",new Vm(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);on(i,r),iw(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)ue(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){sm(()=>om(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Vm(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class FL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new M6(e),this.tableMeta=new x6(this.globalMeta),this.columnMeta=new L6(this.globalMeta),this.cellMeta=new V6(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ft(FL,En);function NA(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Fi(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":at(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Bu(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let w,C=0,S=0;for(C=0,S=d.startRows;C<S;C++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)w=Jn(g),t.push(w);else if(i.dataType==="array")w=Jn(g[0]),t.push(w);else{w=[];for(let v=0,T=d.startCols;v<T;v++)w.push(null);t.push(w)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ce(i.rootElement,[vk(-1),jp(i.countCols()+(i.view?i.countRowHeaders():0))])}function DA(t,e,n){return(e=W6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W6(t){var e=B6(t,"string");return typeof e=="symbol"?e:e+""}function B6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j6{constructor(e){var n=this;DA(this,"metaManager",void 0),DA(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),ie.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=nn(e,"type")?e.type:null;let c=at(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function U6(t,e,n){z6(t,e),e.set(t,n)}function z6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eb(t,e,n){return(e=Y6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y6(t){var e=G6(t,"string");return typeof e=="symbol"?e:e+""}function G6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q6(t,e){return t.get(K6(t,e))}function K6(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kA=new WeakMap;class X6{constructor(e){eb(this,"metaManager",void 0),eb(this,"usageTracker",new Set),eb(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),U6(this,kA,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,q6(kA,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const VL="gridDefault",va="editorManager.handlingEditor",Z6={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},J6="hooksRefRegisterer",WL={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){H(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){De(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Ss(WL,"MIXIN_NAME",J6,{writable:!1,enumerable:!1});function Ci(t,e,n){return(e=Q6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q6(t){var e=e9(t,"string");return typeof e=="symbol"?e:e+""}function e9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const t9="base",Wt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Rc{static get EDITOR_TYPE(){return t9}constructor(e){Ci(this,"hot",void 0),Ci(this,"state",Wt.VIRGIN),Ci(this,"_opened",!1),Ci(this,"_fullEditMode",!1),Ci(this,"_closeCallback",null),Ci(this,"TD",null),Ci(this,"row",null),Ci(this,"col",null),Ci(this,"prop",null),Ci(this,"originalValue",null),Ci(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Wt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Wt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Wt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Ot(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Wt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Wt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Wt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Wt.FINISHED,this.discardEditor(s)}):(this.state=Wt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Wt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Wt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Wt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Wt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Wt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Dn(n),a=qt(n),l=Dn(this.hot.rootElement),u=qt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:w}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,C=w.name,S=["master","inline_start"].includes(C)?d:0,v=["master","top","bottom"].includes(C)?f:0,T=s.top===l.top?0:1;let P=s.top-l.top-T-S,x=0;this.hot.isRtl()?x=o.innerWidth-s.left-a-g-1+v:x=s.left-l.left-1-v,["top","top_inline_start_corner"].includes(C)&&(P+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(x+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const _=this.hot.hasColHeaders(),M=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),V=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),O=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(_&&M<=0||M===O)&&(P+=1),V<=0&&(x+=1);const G=i.rowsRenderCalculator.startPosition,J=i.columnsRenderCalculator.startPosition,ae=Math.abs(r.inlineStartOverlay.getScrollPosition()),te=r.topOverlay.getScrollPosition(),ne=bn(this.hot.rootDocument);let Fe=n.offsetTop;if(["inline_start","master"].includes(C)&&(Fe+=G-te),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:j,wtTable:K}=r.bottomOverlay.clone;Fe+=j.getWorkspaceHeight()-K.getHeight()-ne}let ke=n.offsetLeft;this.hot.isRtl()?(ke>=0?ke=w.getWidth()-n.offsetLeft:ke=Math.abs(ke),ke+=J-ae-a):["top","master","bottom"].includes(C)&&(ke+=J-ae);const Ve=o.getComputedStyle(this.TD),yt=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",ot=parseInt(Ve[yt],10)>0?0:1,ut=parseInt(Ve.borderTopWidth,10)>0?0:1,pn=qt(n)+ot,m=rn(n)+ut,p=Hk(c)?ne:0,b=Nk(h)?ne:0,D=this.hot.view.maximumVisibleElementWidth(ke)-p+ot,F=Math.max(this.hot.view.maximumVisibleElementHeight(Fe)-b+ut,this.hot.stylesHandler.getDefaultRowHeight());return{top:P,start:x,height:m,maxHeight:F,width:pn,maxWidth:D}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}ft(Rc,WL);const n9={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Wt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},r9={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},i9={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},o9={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},s9={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),ji(e))}};function a9(){return[Z6,n9,r9,i9,o9,s9]}const l9={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},u9={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},c9={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},h9={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},d9={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},f9={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},g9={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},m9={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},p9={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},w9={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},v9={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},C9={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},y9={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},b9={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function S9(){return[l9,u9,c9,h9,d9,f9,g9,m9,p9,w9,v9,C9,y9,b9]}const R9={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},E9={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},T9={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},_9={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},M9={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},I9={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},P9={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},O9={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},x9={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},A9={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},H9={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},N9={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},D9={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},k9={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},L9={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},$9={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function F9(){return[R9,E9,T9,_9,M9,I9,P9,O9,x9,A9,H9,N9,D9,k9,L9,$9]}const V9={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},W9={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},B9={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},j9={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},U9={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},z9=[...a9(),...S9(),...F9(),V9,W9,B9,j9,U9];function BL(t){const e={};return z9.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function Y9(t){const e=t.getShortcutManager().addContext("editor"),n=BL(t),r={group:va};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function G9(t){const e=t.getShortcutManager().addContext("grid"),n=BL(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ue(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:VL};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:va,runOnlyIf:()=>ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function q9(t){[G9,Y9].forEach(e=>e(t))}function K9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=LA(t),i=LA(t);return r.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),n.before(r),n.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function LA(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ce(n,[rc("Focus catcher")]),n}function X9(t){const e=Z9(t);let n;const{activate:r,deactivate:i}=K9(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:hR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:dR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,w)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,w.value=!0),s){var C;n=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:VL,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?hR(t):dR(t)),u(),!1;h.preventDefault()},position:"after"}])}function hR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function dR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function Z9(t){return e=>{if(!e)return null;const n=hR(t),r=dR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function Ec(t){fs(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function ow(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,w=f<=h,C=g>=d;return{getComputedColumnTarget(S){return i==="mouse"||i==="keyboard"?S.col:u&&c?r.highlight.col:u?a:c?l:S.col},getComputedRowTarget(S){return i==="mouse"||i==="keyboard"?S.row:w&&C?r.highlight.row:w?f:C?g:S.row}}}function J9(t){return e=>{const n=ow(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;Ec(t.getCell(r?-1:0,n,!0))})}}function Q9(){return()=>{}}function e8(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;Ec(t.getCell(n,r,!0))})}}function t8(t){return e=>{const n=ow(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Ec(t.getCell(i,o,!0))})}}function n8(t){return e=>{const n=ow(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Ec(t.getCell(i,o,!0))})}}function r8(t){return e=>{const n=ow(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;Ec(t.getCell(n,r?-1:0,!0))})}}function i8(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{Ec(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function o8(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=e8(t):e.isSelectedByCorner()?s=Q9():e.isSelectedByRowHeader()?s=r8(t):e.isSelectedByColumnHeader()?s=J9(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=t8(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=i8(t):e.getSelectedRange().size()>1&&(s=n8(t)),(o=s)===null||o===void 0||o(i)}}}const $A=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Uf=t=>t.map(e=>{const n=e.toLowerCase();return $A.has(n)?$A.get(n):n}).sort().join("+"),s8=t=>t.split("+"),FA=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),tb=t=>{let{which:e,key:n}=t;if(FA.has(e))return FA.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},jL=Symbol("shortcut-context");function UL(t){return Ne(t)&&t.__kindOf===jL}const a8=t=>{const e=Kp({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:w,position:C,forwardToContext:S}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Pt(c))throw new Error("You need to define the shortcut's group.");if(at(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(it`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const v={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};ue(w)&&(v.relativeToGroup=w,v.position=C),UL(S)&&(v.forwardToContext=S),l.forEach(T=>{const P=Uf(T);if(e.hasItem(P)){const _=e.getItem(P);let M=_.findIndex(V=>V.group===w);M!==-1?C==="before"?M-=1:M+=1:M=_.length,_.splice(M,0,v)}else e.addItem(P,[v])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{De(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=Uf(l);e.removeItem(u)};return{__kindOf:jL,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Uf(l),c=e.getItem(u);return ue(c)?c.slice():[]},hasShortcut:l=>{const u=Uf(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(s8(h)):(d.length=0,d.push(...f))})}}};function l8(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const u8=["meta","alt","shift","control"],nh=l8(),rh=[];let zf=0;function c8(t,e,n,r,i){const o=f=>u8.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=[];return f.altKey&&w.push("alt"),g&&(f.ctrlKey||f.metaKey)?w.push("control/meta"):(f.ctrlKey&&w.push("control"),f.metaKey&&w.push("meta")),f.shiftKey&&w.push("shift"),w},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||al(f))return;const w=tb(f);let C=[];o(w)||(C=s(f));const S=[w].concat(C);!i(f,S)&&(KO()&&C.includes("meta")||!KO()&&C.includes("control"))&&i(f,[w].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=tb(f);o(g)&&nh.press(g)}},u=f=>{if(typeof f.key=="string"){const g=tb(f);o(g)&&nh.release(g)}},c=()=>{nh.releaseAll()};return{mount:()=>{let f=t;for(zf+=1;f;)zf===1&&(f.document.documentElement.addEventListener("keydown",l),rh.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),rh.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=ic(f)},unmount:()=>{let f=t;for(zf-=1;f;){if(zf===0){for(let g=0;g<rh.length;g++){const{event:w,listener:C}=rh[g];f.document.documentElement.removeEventListener(w,C)}rh.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=ic(f)}},isPressed:f=>nh.isPressed(f),releasePressedKeys:()=>nh.releaseAll()}}const h8=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Kp({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const w=a8(g);return o.addItem(g,w),w},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(it`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,w){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const S=UL(C)?C:u(C);let v=!1;if(!S.hasShortcut(w))return v;const T=S.getShortcuts(w);for(let P=0;P<T.length;P++){const{callback:x,runOnlyIf:_,preventDefault:M,stopPropagation:V,captureCtrl:Y,forwardToContext:O}=T[P];if(_(g)===!0){if(h=Y,v=x(g,w)===!1,h=!1,M&&g.preventDefault(),V&&(ji(g),g.stopPropagation()),v)break;O&&d(g,w,O)}}return v},f=c8(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function VA(t){const{classNames:e}=D2(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function d8(t,e){zL(t,e),e.add(t)}function Pa(t,e,n){zL(t,e),e.set(t,n)}function zL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hn(t,e){return t.get(xi(t,e))}function Jr(t,e,n){return t.set(xi(t,e),n),n}function xi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const WA=23;var Oa=new WeakMap,Wm=new WeakMap,BT=new WeakMap,fR=new WeakMap,Bs=new WeakMap,Fh=new WeakMap,Ed=new WeakMap,ho=new WeakSet;class f8{constructor(e,n){d8(this,ho),Pa(this,Oa,void 0),Pa(this,Wm,void 0),Pa(this,BT,void 0),Pa(this,fR,void 0),Pa(this,Bs,!0),Pa(this,Fh,{}),Pa(this,Ed,{}),Jr(Wm,this,e),Jr(fR,this,n)}isClassicTheme(){return Hn(Bs,this)}getCSSVariableValue(e){var n;if(Hn(Bs,this))return null;if(Hn(Fh,this)[`--ht-${e}`])return Hn(Fh,this)[`--ht-${e}`];const r=(n=xi(ho,this,p8).call(this,`--ht-${e}`))!==null&&n!==void 0?n:xi(ho,this,YL).call(this,`--ht-${e}`);if(r!==null)return Hn(Fh,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=Hn(Ed,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Hn(Bs,this))return WA;const e=xi(ho,this,g8).call(this);return e||WA}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Jr(Oa,this,void 0),Jr(Bs,this,!0),xi(ho,this,nb).call(this);return}if(e&&e!==Hn(Oa,this)){if(!/ht-theme-.*/.test(e)){Ze(`Invalid theme name: ${e}. Please provide a valid theme name.`),Jr(Oa,this,void 0),Jr(Bs,this,!1),xi(ho,this,nb).call(this);return}Hn(Oa,this)&&xi(ho,this,w8).call(this),Jr(Oa,this,e),Jr(Bs,this,!1),xi(ho,this,nb).call(this)}}getThemeName(){return Hn(Oa,this)}}function g8(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function nb(){this.isClassicTheme()||Jr(BT,this,getComputedStyle(Hn(Wm,this)));const t=xi(ho,this,m8).call(this,["box-sizing","border-bottom-width"]);Hn(Ed,this).td={...Hn(Ed,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function m8(t){const e=Hn(fR,this),n=Hn(Wm,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function p8(t){const e=Math.ceil(parseFloat(xi(ho,this,YL).call(this,t)));return Number.isNaN(e)?null:e}function YL(t){const e=Hn(BT,this).getPropertyValue(t);return e===""?null:e}function w8(){Jr(Ed,this,{}),Jr(Fh,this,{}),Jr(Bs,this,!0)}function v8(t,e){GL(t,e),e.add(t)}function BA(t,e,n){GL(t,e),e.set(t,n)}function GL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jA(t,e){return t.get(lc(t,e))}function UA(t,e,n){return t.set(lc(t,e),n),n}function lc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gR=new WeakMap,mR=new WeakMap,Xh=new WeakSet;class C8{constructor(e){let{rowIndexMapper:n,columnIndexMapper:r}=e;v8(this,Xh),BA(this,gR,void 0),BA(this,mR,void 0),UA(gR,this,n),UA(mR,this,r)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,i=lc(Xh,this,zA).call(this,e.from,n,r);if(i===null)return null;const o=lc(Xh,this,zA).call(this,e.to,-n,-r);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function zA(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const r=lc(Xh,this,YA).call(this,jA(gR,this),t.row,e);if(r===null)return null;const i=lc(Xh,this,YA).call(this,jA(mR,this),t.col,n);return i===null?null:t.clone().assign({row:r,col:i})}function YA(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}let rb=null;const ib=new Map;function qL(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Vi(o);let a,l,u,c,h,d,f=!0;zX(i)&&UX(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=Nu(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Nu(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),X(this.rootElement,"ht-wrapper"),X(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),X(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e?.layoutDirection)!==null&&n!==void 0?n:"inherit",w=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return w==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new f8(o.rootElement,o.rootDocument),e.language=j4(e.language);const C=Object.fromEntries(Object.entries(e).filter(m=>{let[p]=m;return!(ie.getSingleton().isRegistered(p)||ie.getSingleton().isDeprecated(p))})),S=new FL(o,C,[j6,X6]),v=S.getTableMeta(),T=S.getGlobalMeta(),P=Kp();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),Nu(this)&&XG(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${hk()}`,ib.set(this.guid,this),this.columnIndexMapper=new lR,this.rowIndexMapper=new lR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new s4(o);const x=fi(this.guid);x.register("cellRangeMapper",new C8({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const _=m=>{const{row:p,col:b}=m;return o._createCellCoords(p>=0?o.rowIndexMapper.getRenderableFromVisualIndex(p):p,b>=0?o.columnIndexMapper.getRenderableFromVisualIndex(b):b)},M=m=>{const{row:p,col:b}=m;return o._createCellCoords(p>=0?o.rowIndexMapper.getVisualFromRenderableIndex(p):p,b>=0?o.columnIndexMapper.getVisualFromRenderableIndex(b):b)},V=(m,p)=>{const b=p>m?1:-1,D=Math.min(m,p),F=Math.max(m,p),j=o.rowIndexMapper.getNearestNotHiddenIndex(m,b);return j===null||b===1&&j>F||b===-1&&j<D?null:j>=0?o.rowIndexMapper.getRenderableFromVisualIndex(j):j},Y=(m,p)=>{const b=p>m?1:-1,D=Math.min(m,p),F=Math.max(m,p),j=o.columnIndexMapper.getNearestNotHiddenIndex(m,b);return j===null||b===1&&j>F||b===-1&&j<D?null:j>=0?o.columnIndexMapper.getRenderableFromVisualIndex(j):j};let O=new kL(v,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,p)=>o._createCellCoords(m,p),createCellRange:(m,p,b)=>o._createCellRange(m,p,b),visualToRenderableCoords:_,renderableToVisualCoords:M,findFirstNonHiddenRenderableRow:V,findFirstNonHiddenRenderableColumn:Y,isDisabledCellSelection:(m,p)=>m<0||p<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,p).disableVisualSelection});this.selection=O;const G=m=>{let{hiddenIndexesChanged:p}=m;this.forceFullRender=!0,p&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",G),this.rowIndexMapper.addLocalHook("cacheUpdated",G),this.selection.addLocalHook("afterSetRangeEnd",(m,p)=>{const b=Fr(!1),D=this.selection.getSelectedRange(),{from:F,to:j}=D.current(),K=D.size()-1;this.runHooks("afterSelection",F.row,F.col,j.row,j.col,b,K),this.runHooks("afterSelectionByProp",F.row,o.colToProp(F.col),j.row,o.colToProp(j.col),b,K),p&&(!b.isTouched()||b.isTouched()&&!b.value)&&d.scrollTo(m);const y=O.isSelectedByRowHeader(),R=O.isSelectedByColumnHeader();y&&R?X(this.rootElement,["ht__selection--rows","ht__selection--columns"]):y?(we(this.rootElement,"ht__selection--columns"),X(this.rootElement,"ht__selection--rows")):R?(we(this.rootElement,"ht__selection--rows"),X(this.rootElement,"ht__selection--columns")):we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(O.getSelectionSource())||c.closeEditor(null),O.getSelectionSource()!=="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const p=Fr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,p),(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const p=m.length-1,{from:b,to:D}=m[p];this.runHooks("afterSelectionEnd",b.row,b.col,D.row,D.col,p),this.runHooks("afterSelectionEndByProp",b.row,o.colToProp(b.col),D.row,o.colToProp(D.col),p),O.getSelectionSource()==="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const p=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=p)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSetRangeStart",...p)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSetRangeStartOnly",...p)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSetRangeEnd",...p)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSelectColumns",...p)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterSelectColumns",...p)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSelectRows",...p)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterSelectRows",...p)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("modifyTransformStart",...p)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterModifyTransformStart",...p)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("modifyTransformFocus",...p)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterModifyTransformFocus",...p)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("modifyTransformEnd",...p)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterModifyTransformEnd",...p)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeRowWrap",...p)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeColumnWrap",...p)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,p){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3?arguments[3]:void 0,F=arguments.length>4?arguments[4]:void 0;const j=K=>{if(K.length===0)return[];const y=[...K];return y.sort((E,I)=>{let[A]=E,[L]=I;return A===L?0:A>L?1:-1}),Rr(y,(E,I)=>{let[A,L]=I;const B=E[E.length-1],[N,$]=B,W=N+$;if(A<=W){const U=Math.max(L-(W-A),0);B[1]+=U}else E.push([A,L]);return E},[y[0]])};switch(m){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(v.maxRows===K)return;const y=m==="insert_row_below"?"below":"above";p=p??(y==="below"?K:0);const{delta:R,startPhysicalIndex:E}=a.createRow(p,b,{source:D,mode:y});O.shiftRows(o.toVisualRow(E),R);break;case"insert_col_start":case"insert_col_end":const I=m==="insert_col_end"?"end":"start";p=p??(I==="end"?o.countSourceCols():0);const{delta:A,startPhysicalIndex:L}=a.createCol(p,b,{source:D,mode:I});if(A){if(Array.isArray(v.colHeaders)){const $=[o.toVisualColumn(L),0];$.length+=A,Array.prototype.splice.apply(v.colHeaders,$)}O.shiftColumns(o.toVisualColumn(L),A)}break;case"remove_row":const B=$=>{let W=0;H($,U=>{let[q,se]=U;const le=jt(q)?o.countRows()-1:Math.max(q-W,0);if(Number.isInteger(q)&&(q=Math.max(q-W,0)),!a.removeRow(q,se,D))return;if(O.isSelected()){const{row:Se}=o.getSelectedRangeLast().highlight;Se>=q&&Se<=q+se-1&&c.closeEditor(!0)}const We=o.countRows(),Be=v.fixedRowsTop;Be>=le+1&&(v.fixedRowsTop-=Math.min(se,Be-le));const Ee=v.fixedRowsBottom;if(Ee&&le>=We-Ee&&(v.fixedRowsBottom-=Math.min(se,Ee)),We===0)O.deselect();else if(D==="ContextMenu.removeRow"){const Se=O.getSelectedRange(),nt=Se.pop();Se.clear().set(nt.from).current().setTo(nt.to),O.refresh()}else O.shiftRows(q,-se);W+=se})};Array.isArray(p)?B(j(p)):B([[p,b]]);break;case"remove_col":const N=$=>{let W=0;H($,U=>{let[q,se]=U;const le=jt(q)?o.countCols()-1:Math.max(q-W,0);let Re=o.toPhysicalColumn(le);if(Number.isInteger(q)&&(q=Math.max(q-W,0)),!a.removeCol(q,se,D))return;if(O.isSelected()){const{col:Se}=o.getSelectedRangeLast().highlight;Se>=q&&Se<=q+se-1&&c.closeEditor(!0)}if(o.countCols()===0)O.deselect();else if(D==="ContextMenu.removeColumn"){const Se=O.getSelectedRange(),nt=Se.pop();Se.clear().set(nt.from).current().setTo(nt.to),O.refresh()}else O.shiftColumns(q,-se);const Ee=v.fixedColumnsStart;Ee>=le+1&&(v.fixedColumnsStart-=Math.min(se,Ee-le)),Array.isArray(v.colHeaders)&&(typeof Re>"u"&&(Re=-1),v.colHeaders.splice(Re,se)),W+=se})};Array.isArray(p)?N(j(p)):N([[p,b]]);break;default:throw new Error(`There is no such action "${m}"`)}F||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=v.minRows,p=v.minSpareRows,b=v.minCols,D=v.minSpareCols;if(m){const F=o.countRows();F<m&&a.createRow(F,m-F,{source:"auto"})}if(p){const F=o.countEmptyRows(!0);if(F<p){const j=p-F,K=Math.min(j,v.maxRows-o.countSourceRows());a.createRow(o.countRows(),K,{source:"auto"})}}{let F;(b||D)&&(F=o.countEmptyCols(!0));let j=o.countCols();if(b&&!v.columns&&j<b){const K=b-j;F+=K,a.createCol(j,K,{source:"auto"})}if(D&&!v.columns&&o.dataType==="array"&&F<D){j=o.countCols();const K=D-F,y=Math.min(K,v.maxCols-j);a.createCol(j,y,{source:"auto"})}}},populateFromArray(m,p,b,D,F){let j,K,y,R;const E=[],I={},A=[],L=m.row,B=m.col;if(K=p.length,K===0)return!1;let N=0,$=0;switch(Ne(b)&&(N=b.col-B+1,$=b.row-L+1),F){case"shift_down":const W=nm(p),U=W.length,q=Math.max(U,N),se=o.getData().slice(L),le=nm(se).slice(B,B+q);for(y=0;y<q;y+=1)if(y<U){for(j=0,K=W[y].length;j<$-K;j+=1)W[y].push(W[y][j%K]);y<le.length?A.push(W[y].concat(le[y])):A.push(W[y].concat(new Array(se.length).fill(null)))}else A.push(W[y%U].concat(le[y]));o.populateFromArray(L,B,nm(A));break;case"shift_right":const Re=p.length,We=Math.max(Re,$),Be=o.getData().slice(L).map(bt=>bt.slice(B));for(j=0;j<We;j+=1)if(j<Re){for(y=0,R=p[j].length;y<N-R;y+=1)p[j].push(p[j][y%R]);if(j<Be.length)for(let bt=0;bt<Be[j].length;bt+=1)p[j].push(Be[j][bt]);else p[j].push(...new Array(Be[0].length).fill(null))}else p.push(p[j%K].slice(0,We).concat(Be[j]));o.populateFromArray(L,B,p);break;case"overwrite":default:I.row=m.row,I.col=m.col;let Ee=0,Se=0,nt=!0,er;const Ao=function(_t){let wt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Qe=p[_t%p.length];return wt!==null?Qe[wt%Qe.length]:Qe},mi=p.length,cn=b?b.row-m.row+1:0;for(b?K=cn:K=Math.max(mi,cn),j=0;j<K&&!(b&&I.row>b.row&&cn>mi||!v.allowInsertRow&&I.row>o.countRows()-1||I.row>=v.maxRows);j++){const bt=j-Ee,_t=Ao(bt).length,wt=b?b.col-m.col+1:0;if(b?R=wt:R=Math.max(_t,wt),I.col=m.col,er=o.getCellMeta(I.row,I.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&er.skipRowOnPaste){Ee+=1,I.row+=1,K+=1;continue}for(Se=0,y=0;y<R&&!(b&&I.col>b.col&&wt>_t||!v.allowInsertColumn&&I.col>o.countCols()-1||I.col>=v.maxCols);y++){if(er=o.getCellMeta(I.row,I.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&er.skipColumnOnPaste){Se+=1,I.col+=1,R+=1;continue}if(er.readOnly&&D!=="UndoRedo.undo"){I.col+=1;continue}const Qe=y-Se;let Br=Ao(bt,Qe),$n=o.getDataAtCell(I.row,I.col);if(Br!==null&&typeof Br=="object")if(Array.isArray(Br)&&$n===null&&($n=[]),$n===null||typeof $n!="object")nt=!1;else{const Ca=Cd(Array.isArray($n)?$n:$n[0]||$n),ff=Cd(Array.isArray(Br)?Br:Br[0]||Br);VE(Ca,ff)||Array.isArray(Ca)&&Array.isArray(ff)?Br=Jn(Br):nt=!1}else $n!==null&&typeof $n=="object"&&(nt=!1);nt&&E.push([I.row,I.col,Br]),nt=!0,I.col+=1}I.row+=1}o.setDataAtCell(E,null,null,D||"populateFromArray");break}}};function J(m){const p=EL(m);FT(p)?(o.runHooks("beforeLanguageChange",p),T.language=p,o.runHooks("afterLanguageChange",p)):TL(m)}function ae(m,p){const b=m==="className"?o.rootElement:o.table;if(f)X(b,p);else{let D=[],F=[];T[m]&&(D=Array.isArray(T[m])?T[m]:$O(T[m])),p&&(F=Array.isArray(p)?p:$O(p));const j=LO(D,F),K=LO(F,D);j.length&&we(b,j),K.length&&X(b,K)}T[m]=p}this.init=function(){l.setData(v.data),o.runHooks("beforeInit"),(So()||Ek())&&X(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new KX(this);const m=v.themeName||VA(o.rootContainer);o.useTheme(m),c=iR.getInstance(o,v,O),d=o8(o),h=new Rq(o),Nu(this)&&X9(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&j2(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function te(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function ne(m){const p=m.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):m}function Fe(m,p,b){if(!m.length){b();return}const D=o.getActiveEditor(),F=new te;let j=!0;F.onQueueEmpty=()=>{D&&j&&D.cancelChanges(),b()};for(let K=m.length-1;K>=0;K--){const[y,R]=m[K],E=a.propToCol(R);let I;Number.isInteger(E)?I=o.getCellMeta(y,E):I={...Object.getPrototypeOf(v),...v},o.getCellValidator(I)&&(F.addValidatorToQueue(),o.validateCell(m[K][3],I,function(A,L){return function(B){if(typeof B!="boolean")throw new Error("Validation error: result is not boolean");B===!1&&L.allowInvalid===!1&&(j=!1,m.splice(A,1),L.valid=!0),F.removeValidatorFormQueue()}}(K,I),p))}F.checkIfQueueIsEmpty()}function ke(m,p){for(let D=m.length-1;D>=0;D--){let F=!1;if(m[D]===null){m.splice(D,1);continue}if(!((m[D][2]===null||m[D][2]===void 0)&&(m[D][3]===null||m[D][3]===void 0))){if(v.allowInsertRow)for(;m[D][0]>o.countRows()-1;){const{delta:j}=a.createRow(void 0,void 0,{source:"auto"});if(j===0){F=!0;break}}if(o.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;a.propToCol(m[D][1])>o.countCols()-1;){const{delta:j}=a.createCol(void 0,void 0,{source:"auto"});if(j===0){F=!0;break}}F||a.set(m[D][0],m[D][1],m[D][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,p),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,p||"edit");const D=o.getActiveEditor();D&&ue(D.refreshValue)&&D.refreshValue()}else o.render()}this._createCellCoords=function(m,p){return o.view._wt.createCellCoords(m,p)},this._createCellRange=function(m,p,b){return o.view._wt.createCellRange(m,p,b)},this.validateCell=function(m,p,b,D){let F=o.getCellValidator(p);function j(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||p.hidden===!0){b(K);return}const R=p.visualCol,E=p.visualRow,I=o.getCell(E,R,!0);if(I&&I.nodeName!=="TH"){const A=o.rowIndexMapper.getRenderableFromVisualIndex(E),L=o.columnIndexMapper.getRenderableFromVisualIndex(R);o.view._wt.getSetting("cellRenderer",A,L,I)}b(K)}GG(F)&&(F=function(K){return function(y,R){R(K.test(y))}}(F)),at(F)?(m=o.runHooks("beforeValidate",m,p.visualRow,p.prop,D),o._registerImmediate(()=>{F.call(p,m,K=>{o&&(K=o.runHooks("afterValidate",K,m,p.visualRow,p.prop,D),p.valid=K,j(K),o.runHooks("postAfterValidate",K,m,p.visualRow,p.prop,D))})})):o._registerImmediate(()=>{p.valid=!0,j(p.valid,!1)})};function Ve(m,p,b){return Array.isArray(m)?m:[[m,p,b]]}function yt(m,p){const b=o.runHooks("beforeChange",m,p||"edit"),D=m.filter(j=>j!==null);if(b===!1||D.length===0){var F;return(F=o.getActiveEditor())===null||F===void 0||F.cancelChanges(),[]}for(let j=D.length-1;j>=0;j--){const[K,y,,R]=D[j],E=a.propToCol(y);let I;Number.isInteger(E)?I=o.getCellMeta(K,E):I={...Object.getPrototypeOf(v),...v};const{type:A,checkedTemplate:L,uncheckedTemplate:B}=I;if(A==="numeric"&&typeof R=="string"&&Lq(R)&&(D[j][3]=ne(R)),A==="checkbox"){const N=Ot(R),$=N===Ot(L),W=N===Ot(B);($||W)&&(D[j][3]=$?L:B)}}return D}this.setDataAtCell=function(m,p,b,D){const F=Ve(m,p,b),j=[];let K=D,y,R,E;for(y=0,R=F.length;y<R;y++){if(typeof F[y]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof F[y][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");F[y][1]>=this.countCols()?E=F[y][1]:E=a.colToProp(F[y][1]),j.push([F[y][0],E,l.getAtCell(this.toPhysicalRow(F[y][0]),F[y][1]),F[y][2]])}!K&&typeof m=="object"&&(K=p);const I=yt(j,K);o.runHooks("afterSetDataAtCell",I,K),Fe(I,K,()=>{ke(I,K)})},this.setDataAtRowProp=function(m,p,b,D){const F=Ve(m,p,b),j=[];let K=D,y,R;for(y=0,R=F.length;y<R;y++)j.push([F[y][0],F[y][1],l.getAtCell(this.toPhysicalRow(F[y][0]),F[y][1]),F[y][2]]);!K&&typeof m=="object"&&(K=p);const E=yt(j,D);o.runHooks("afterSetDataAtRowProp",E,K),Fe(E,K,()=>{ke(E,K)})},this.listen=function(){o&&!o.isListening()&&(ib.forEach(m=>{o!==m&&m.unlisten()}),rb=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(rb=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return rb===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),p&&O.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,p,b,D,F,j,K){if(!(typeof b=="object"&&typeof b[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const y=typeof D=="number"?o._createCellCoords(D,F):null;return u.populateFromArray(o._createCellCoords(m,p),b,y,j,K)},this.spliceCol=function(m,p,b){for(var D=arguments.length,F=new Array(D>3?D-3:0),j=3;j<D;j++)F[j-3]=arguments[j];return a.spliceCol(m,p,b,...F)},this.spliceRow=function(m,p,b){for(var D=arguments.length,F=new Array(D>3?D-3:0),j=3;j<D;j++)F[j-3]=arguments[j];return a.spliceRow(m,p,b,...F)},this.getSelected=function(){if(O.isSelected())return je(O.getSelectedRange(),m=>{let{from:p,to:b}=m;return[p.row,p.col,b.row,b.col]})},this.getSelectedLast=function(){const m=this.getSelected();let p;return m&&m.length>0&&(p=m[m.length-1]),p},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let p;return m&&m.length>0&&(p=m[m.length-1]),p},this.emptySelectedCells=function(m){if(!O.isSelected()||this.countRows()===0||this.countCols()===0)return;const p=[];H(O.getSelectedRange(),b=>{if(b.isSingleHeader())return;const D=b.getTopStartCorner(),F=b.getBottomEndCorner();de(D.row,F.row,j=>{de(D.col,F.col,K=>{this.getCellMeta(j,K).readOnly||p.push([j,K,null])})})}),p.length>0&&this.setDataAtCell(p,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const p=m();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const b=m();return this.resumeExecution(p),b},this.batch=function(m){this.suspendRender(),this.suspendExecution();const p=m();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:p,height:b}=m.getLastSize(),{width:D,height:F}=o.rootElement.getBoundingClientRect(),j=D!==p||F!==b;o.runHooks("beforeRefreshDimensions",{width:p,height:b},{width:D,height:F},j)!==!1&&((j||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(D,F),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:p,height:b},{width:D,height:F},j))},this.updateData=function(m,p){NA(m,b=>{a=b},b=>{a=b,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),O.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:p,metaManager:S,firstRun:f})},this.loadData=function(m,p){NA(m,b=>{a=b},()=>{S.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),O.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:p,metaManager:S,firstRun:f})},this.getInitialColumnCount=function(){const m=v.columns;let p=0;if(Array.isArray(m))p=m.length;else if(at(m))if(o.dataType==="array"){const b=this.countSourceCols();for(let D=0;D<b;D+=1)m(D)&&(p+=1)}else(o.dataType==="object"||o.dataType==="function")&&(p=a.colToPropCache.length);else if(ue(v.dataSchema)){const b=a.getSchema();p=Array.isArray(b)?b.length:WE(b)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,p,b,D){return Pt(m)?a.getAll():a.getRange(o._createCellCoords(m,p),o._createCellCoords(b,D),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,p,b,D){return a.getCopyableText(o._createCellCoords(m,p),o._createCellCoords(b,D))},this.getCopyableData=function(m,p){return a.getCopyable(m,a.colToProp(p))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=(f?o.loadData:o.updateData).bind(this);let D=!1,F,j;if(ue(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ue(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ue(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&J(m.language);for(F in m)if(!(F==="data"||F==="language"))if(F==="className")ae("className",m.className);else if(F==="tableClassName"&&o.table)ae("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ie.getSingleton().isRegistered(F)||ie.getSingleton().isDeprecated(F)){const I=m[F];at(I)?(ie.getSingleton().addAsFixed(F,I,o),v[F]=I):Array.isArray(I)&&(ie.getSingleton().add(F,I,o),v[F]=I)}else!p&&nn(m,F)&&(T[F]=m[F]);m.data===void 0&&v.data===void 0?b(null,"updateSettings"):m.data!==void 0?b(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const K=o.countCols(),y=v.columns;if(y&&at(y)&&(D=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&S.clearCache(),K>0)for(F=0,j=0;F<K;F++){if(y){const I=D?y(F):y[j];I&&S.updateColumnMeta(j,I)}j+=1}ue(m.cell)&&De(m.cell,I=>{o.setCellMetaObject(I.row,I.col,I)}),o.runHooks("afterCellMetaReset");let R=o.rootElement.style.height;R!==""&&(R=parseInt(o.rootElement.style.height,10));let E=m.height;if(at(E)&&(E=E()),p&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),E===null){const I=o.rootElement.getAttribute("data-initialstyle");I&&(I.indexOf("height")>-1||I.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",I):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else E!==void 0&&(o.rootElement.style.height=isNaN(E)?`${E}`:`${E}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let I=m.width;at(I)&&(I=I()),o.rootElement.style.width=isNaN(I)?`${I}`:`${I}px`}if(!p){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const I=o.getCurrentThemeName();nn(m,"themeName")&&I!==m.themeName&&o.useTheme(m.themeName)}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!p&&o.view&&(R===""||E===""||E===void 0)&&R!==E&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(v.getValue){if(at(v.getValue))return v.getValue.call(o);if(m)return o.getData()[m[0][0]][v.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,p,b,D,F){u.alter(m,p,b,D,F)},this.getCell=function(m,p){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,D=p,F=m;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;D=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;F=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return F===null||D===null||F===void 0||D===void 0?null:o.view.getCellAtCoords(o._createCellCoords(F,D),b)},this.getCoords=function(m){const p=this.view._wt.wtTable.getCoords(m);if(p===null)return null;const{row:b,col:D}=p;let F=b,j=D;return b>=0&&(F=this.rowIndexMapper.getVisualFromRenderableIndex(b)),D>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(D)),o._createCellCoords(F,j)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,p){return a.get(m,a.colToProp(p))},this.getDataAtRowProp=function(m,p){return a.get(m,p)},this.getDataAtCol=function(m){const p=[],b=a.getRange(o._createCellCoords(0,m),o._createCellCoords(v.data.length-1,m),a.DESTINATION_RENDERER);for(let D=0;D<b.length;D+=1)for(let F=0;F<b[D].length;F+=1)p.push(b[D][F]);return p},this.getDataAtProp=function(m){const p=[],b=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(v.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let D=0;D<b.length;D+=1)for(let F=0;F<b[D].length;F+=1)p.push(b[D][F]);return p},this.getSourceData=function(m,p,b,D){let F;return m===void 0?F=l.getData():F=l.getByRange(o._createCellCoords(m,p),o._createCellCoords(b,D)),F},this.getSourceDataArray=function(m,p,b,D){let F;return m===void 0?F=l.getData(!0):F=l.getByRange(o._createCellCoords(m,p),o._createCellCoords(b,D),!0),F},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,p,b,D){const F=Ve(m,p,b),j=this.hasHook("afterSetSourceDataAtCell"),K=[];j&&H(F,R=>{let[E,I,A]=R;K.push([E,I,l.getAtCell(E,I),A])}),H(F,R=>{let[E,I,A]=R;l.setAtCell(E,I,A)}),j&&this.runHooks("afterSetSourceDataAtCell",K,D),this.render();const y=o.getActiveEditor();y&&ue(y.refreshValue)&&y.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,p){return l.getAtCell(m,p)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,p,b,D){const F=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,p,b,D],[j,K]=F;let[,,y,R]=F,E=null,I=null;y===void 0&&(y=j),R===void 0&&(R=K);let A="mixed";return de(Math.max(Math.min(j,y),0),Math.max(j,y),L=>{let B=!0;return de(Math.max(Math.min(K,R),0),Math.max(K,R),N=>(I=this.getCellMeta(L,N).type,E?B=E===I:E=I,B)),A=B?I:"mixed",B}),A},this.removeCellMeta=function(m,p,b){const[D,F]=[this.toPhysicalRow(m),this.toPhysicalColumn(p)];let j=S.getCellMetaKeyValue(D,F,b);o.runHooks("beforeRemoveCellMeta",m,p,b,j)!==!1&&(S.removeCellMeta(D,F,b),o.runHooks("afterRemoveCellMeta",m,p,b,j)),j=null},this.spliceCellsMeta=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var b=arguments.length,D=new Array(b>2?b-2:0),F=2;F<b;F++)D[F-2]=arguments[F];if(D.length>0&&!Array.isArray(D[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");p>0&&S.removeRow(this.toPhysicalRow(m),p),D.length>0&&H(D.reverse(),j=>{S.createRow(this.toPhysicalRow(m)),H(j,(K,y)=>this.setCellMetaObject(m,y,K))}),o.render()},this.setCellMetaObject=function(m,p,b){typeof b=="object"&&De(b,(D,F)=>{this.setCellMeta(m,p,F,D)})},this.setCellMeta=function(m,p,b,D){if(o.runHooks("beforeSetCellMeta",m,p,b,D)===!1)return;let j=m,K=p;m<this.countRows()&&(j=this.toPhysicalRow(m)),p<this.countCols()&&(K=this.toPhysicalColumn(p)),S.setCellMeta(j,K,b,D),o.runHooks("afterSetCellMeta",m,p,b,D)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(m,p){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},D=this.toPhysicalRow(m),F=this.toPhysicalColumn(p);return D===null&&(D=m),F===null&&(F=p),S.getCellMeta(D,F,{visualRow:m,visualColumn:p,...b})},this.getColumnMeta=function(m){return S.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return S.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||v.columns)},this.getCellRenderer=function(m,p){const b=typeof m=="number"?o.getCellMeta(m,p).renderer:m.renderer;return typeof b=="string"?Ix(b):Pt(b)?Ix("text"):b},this.getCellEditor=function(m,p){const b=typeof m=="number"?o.getCellMeta(m,p).editor:m.editor;return typeof b=="string"?ux(b):Pt(b)?ux("text"):b},this.getCellValidator=function(m,p){const b=typeof m=="number"?o.getCellMeta(m,p).validator:m.validator;return typeof b=="string"?eK(b):b},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,p){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,m)},this.validateColumns=function(m,p){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,m)},this._validateCells=function(m,p,b){const D=new te;m&&(D.onQueueEmpty=m);let F=o.countRows()-1;for(;F>=0;){if(p!==void 0&&p.indexOf(F)===-1){F-=1;continue}let j=o.countCols()-1;for(;j>=0;){if(b!==void 0&&b.indexOf(j)===-1){j-=1;continue}D.addValidatorToQueue(),o.validateCell(o.getDataAtCell(F,j),o.getCellMeta(F,j),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(D.valid=!1),D.removeValidatorFormQueue()},"validateCells"),j-=1}F-=1}D.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let p=v.rowHeaders,b=m;return b!==void 0&&(b=o.runHooks("modifyRowHeader",b)),b===void 0?(p=[],de(o.countRows()-1,D=>{p.push(o.getRowHeader(D))})):Array.isArray(p)&&p[b]!==void 0?p=p[b]:at(p)?p=p(b):p&&typeof p!="string"&&typeof p!="number"&&(p=b+1),p},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let m=0,p=o.countCols();m<p;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const b=o.runHooks("modifyColHeader",m);if(b===void 0){const y=[],R=o.countCols();for(let E=0;E<R;E++)y.push(o.getColHeader(E));return y}let D=v.colHeaders;const F=function(y){const R=[],E=o.countCols();let I=0;for(;I<E;I++)at(v.columns)&&v.columns(I)&&R.push(I);return R[y]},j=o.toPhysicalColumn(b),K=F(j);return v.colHeaders===!1?D=null:v.columns&&at(v.columns)&&v.columns(K)&&v.columns(K).title?D=v.columns(K).title:v.columns&&v.columns[j]&&v.columns[j].title?D=v.columns[j].title:Array.isArray(v.colHeaders)&&v.colHeaders[j]!==void 0?D=v.colHeaders[j]:at(v.colHeaders)?D=v.colHeaders(j):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(D=t4(b)),D=o.runHooks("modifyColumnHeaderValue",D,m,p),D},this._getColWidthFromSettings=function(m){let p;if(m>=0&&(p=o.getCellMeta(0,m).width),(p===void 0||p===v.width)&&(p=v.colWidths),p!=null){switch(typeof p){case"object":p=p[m];break;case"function":p=p(m);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(m,p){let b=o._getColWidthFromSettings(m);return b=o.runHooks("modifyColWidth",b,m,p),b===void 0&&(b=sc),b},this._getRowHeightFromSettings=function(m){const p=o.stylesHandler.getDefaultRowHeight();let b=v.rowHeights;if(b!=null){switch(typeof b){case"object":b=b[m];break;case"function":b=b(m);break}typeof b=="string"&&(b=parseInt(b,10))}return b!=null&&b<p?p:b},this.getRowHeight=function(m,p){let b=o._getRowHeightFromSettings(m);return b=o.runHooks("modifyRowHeight",b,m,p),b},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=v.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,p)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return _x(o.countRows()-1,b=>{if(o.isEmptyRow(b))p+=1;else if(m===!0)return!1}),p},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return _x(o.countCols()-1,b=>{if(o.isEmptyCol(b))p+=1;else if(m===!0)return!1}),p},this.isEmptyRow=function(m){return v.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return v.isEmptyCol.call(o,m)},this.selectCell=function(m,p,b,D){let F=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Pt(m)||Pt(p)?!1:this.selectCells([[m,p,b,D]],F,j)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&d.suspend();const D=O.selectCells(m);return D&&b&&o.listen(),d.resume(),D},this.selectColumns=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,b=arguments.length>2?arguments[2]:void 0;return O.selectColumns(m,p,b)},this.selectRows=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,b=arguments.length>2?arguments[2]:void 0;return O.selectRows(m,p,b)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,b=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),O.selectAll(m,p,b)};const ot=(m,p)=>m.getNearestNotHiddenIndex(p,1,!0);this.scrollViewportTo=function(m,p){if(typeof m=="number"){var b;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(b=arguments[4])!==null&&b!==void 0?b:!0}}const{row:D,col:F,considerHiddenIndexes:j}=m??{};let K=D,y=F;if(at(p)&&this.addHookOnce("afterScroll",p),j===void 0||j){const A=Number.isInteger(D)&&D>=0,L=Number.isInteger(F)&&F>=0,B=A?ot(this.rowIndexMapper,D):void 0,N=L?ot(this.columnIndexMapper,F):void 0;if(B===null||N===null)return!1;K=A?o.rowIndexMapper.getRenderableFromVisualIndex(B):D,y=L?o.columnIndexMapper.getRenderableFromVisualIndex(N):F}const R=Number.isInteger(K),E=Number.isInteger(y);let I=!1;return R&&K>=0&&E&&y>=0?I=o.view.scrollViewport(o._createCellCoords(K,y),m.horizontalSnap,m.verticalSnap):R&&K>=0&&(E&&y<0||!E)?I=o.view.scrollViewportVertically(K,m.verticalSnap):E&&y>=0&&(R&&K<0||!R)&&(I=o.view.scrollViewportHorizontally(y,m.horizontalSnap)),at(p)&&(I?this.view.render():(this.removeHook("afterScroll",p),this._registerMicrotask(()=>p()))),I},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;at(m)&&this.addHookOnce("afterScroll",m);const{highlight:p}=this.getSelectedRangeLast(),b=this.scrollViewportTo(p.toObject());return b?this.view.render():at(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),b},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),x.clear(),S.clearCache(),ib.delete(this.guid),s.destroy(),c&&c.destroy(),o.rootContainer&&ms(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),P.getItems().forEach(m=>{let[,p]=m;p.destroy()}),P.clear(),o.runHooks("afterDestroy")},!0),ie.getSingleton().destroy(o),De(o,(m,p,b)=>{at(m)?b[p]=ut(p):p!=="guid"&&(b[p]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,O=null,c=null,o=null};function ut(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return P.getItem(Fi(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:P.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,p,b){ie.getSingleton().add(m,p,o,b)},this.hasHook=function(m){return ie.getSingleton().has(m,o)||ie.getSingleton().has(m)},this.addHookOnce=function(m,p,b){ie.getSingleton().once(m,p,o,b)},this.removeHook=function(m,p){ie.getSingleton().remove(m,p,o)},this.runHooks=function(m,p,b,D,F,j,K){return ie.getSingleton().run(o,m,p,b,D,F,j,K)},this.getTranslatedPhrase=function(m,p){return xL(v.language,m,p)},this.toHTML=()=>Ex(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",Ex(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{const p=!!f;this.stylesHandler.useTheme(m);const b=this.stylesHandler.getThemeName();Nu(this)&&(we(this.rootWrapperElement,/ht-theme-.*/g),we(this.rootPortalElement,/ht-theme-.*/g),b&&(X(this.rootWrapperElement,b),X(this.rootPortalElement,b),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Ze(`The "${b}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),p||(o.render(),o.scrollViewportTo(0,0),VA(this.rootContainer)&&(we(this.rootContainer,/ht-theme-.*/g),b&&X(this.rootContainer,b))),this.runHooks("afterSetTheme",b,p)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=m;typeof b=="function"&&(b=setTimeout(b,p)),this.timeouts.push(b)},this._clearTimeouts=function(){H(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){H(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const pn=h8({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&pn.releasePressedKeys()}),this.getShortcutManager=function(){return pn},this.getFocusManager=function(){return h},Xk().forEach(m=>{const p=KE(m);P.addItem(m,new p(this))}),q9(o),pn.setActiveContextName("grid"),ie.getSingleton().run(o,"construct")}function GA(t,e,n){t.addEventListener(e,n,!1)}function qA(t,e,n){t.removeEventListener(e,n,!1)}function Yf(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function KL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Yf(s).fontSize,o.style.fontFamily=Yf(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=Yf(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=Yf(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),w=o.clientWidth+f+g+1;r.removeChild(o);const C=s.style;C.height=`${n.minHeight}px`,n.minWidth>w?C.width=`${n.minWidth}px`:w>n.maxWidth?C.width=`${n.maxWidth}px`:C.width=`${w}px`;const S=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>S?C.height=`${n.minHeight}px`:n.maxHeight<S?(C.height=`${n.maxHeight}px`,C.overflowY="visible"):C.height=`${S}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(GA(s,"input",a),GA(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){qA(s,"input",a),qA(s,"keydown",l)}}}function KA(t,e){const n=xk(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}zp(e,i)}function xa(t,e,n){return(e=y8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y8(t){var e=b8(t,"string");return typeof e=="symbol"?e:e+""}function b8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const S8="ht_editor_visible",Gf="ht_editor_hidden",XA="textEditor",R8="text";class Bl extends Rc{static get EDITOR_TYPE(){return R8}constructor(e){super(e),xa(this,"eventManager",new Vi(this)),xa(this,"autoResize",KL(this.hot.rootDocument)),xa(this,"TEXTAREA",void 0),xa(this,"textareaStyle",void 0),xa(this,"TEXTAREA_PARENT",void 0),xa(this,"textareaParentStyle",void 0),xa(this,"layerClass",void 0),this.eventManager=new Vi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),rm(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Wt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Wt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),zp(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ce(this.TEXTAREA,[["data-hot-input",""],ma(-1)]),X(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),X(this.TEXTAREA_PARENT,"handsontableInputHolder"),ye(this.TEXTAREA_PARENT,this.layerClass)&&we(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Gf),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){A2()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",we(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Gf)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;de(e.length-1,r=>{const i=e[r];if(ye(i,"handsontableEditor"))return n=!0,!1}),ye(this.TEXTAREA_PARENT,Gf)&&we(this.TEXTAREA_PARENT,Gf),n?(this.layerClass=S8,X(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),X(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Wt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){Rk()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Wt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Wt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>ue(this.hot.getSelected()),group:XA},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;KA(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;KA(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(XA)}}const E8="base",T8="htTextEllipsis";function ef(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&X(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(UO())):a&&c.push(UO()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(zO())):(u.push(s.invalidCellClassName),a&&c.push(zO()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(T8),we(e,u),X(e,l),yc(e,c),Ce(e,h)}ef.RENDERER_TYPE=E8;const _8="text";function Es(t,e,n,r,i,o,s){ef.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Ot(a),s.trimWhitespace&&(a=a.trim()),Tl(e,a)}Es.RENDERER_TYPE=_8;const M8="text",XL={CELL_TYPE:M8,editor:Bl,renderer:Es};Ei(XL);Vr.editors={BaseEditor:Rc};function Vr(t,e){const n=new qL(t,e||{},h0);return n.init(),n}Vr.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new qL(t,e,h0)};Vr.DefaultSettings=$L();Vr.hooks=ie.getSingleton();Vr.CellCoords=Ml;Vr.CellRange=Xd;Vr.packageName="handsontable";Vr.buildDate="10/07/2025 10:59:01";Vr.version="16.0.1";Vr.languages={dictionaryKeys:k4,getLanguageDictionary:OL,getLanguagesDictionaries:W4,registerLanguageDictionary:PL,getTranslatedPhrase:xL};function I8(t,e,n){return(e=x8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function P8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ZA(Object(n),!0).forEach(function(r){I8(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ZA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function O8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function x8(t){var e=O8(t,"string");return typeof e=="symbol"?e:e+""}function Zh(t){"@babel/helpers - typeof";return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zh(t)}var Ju=Symbol("unassigned"),A8="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function Bm(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ZL(t){var e=Vr.hooks.getRegistered(),n={};Object.assign(n,Vr.DefaultSettings);for(var r in n)n[r]={default:Ju};for(var i=0;i<e.length;i++)n[e[i]]={default:Ju};return n.settings={default:Ju},t==="HotTable"&&(n.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),n}function JL(t){var e={},n=t.settings;if(n!==Ju)for(var r in n)Bm(n,r)&&n[r]!==Ju&&(e[r]=n[r]);for(var i in t)Bm(t,i)&&i!=="settings"&&t[i]!==Ju&&(e[i]=t[i]);return e}function JA(t,e){var n=JL(t),r=t.settings?t.settings:n,i=t.settings?n:null,o={};for(var s in r)Bm(r,s)&&r[s]!==void 0&&(!(e&&s!=="data")||!QA(e[s],r[s]))&&(o[s]=r[s]);for(var a in i)Bm(i,a)&&a!=="id"&&a!=="settings"&&i[a]!==void 0&&(!(e&&a!=="data")||!QA(e[a],i[a]))&&(o[a]=i[a]);return o}function QA(t,e){var n=function(i){var o=function(){var s=new WeakSet;return function(a,l){if(Zh(l)==="object"&&l!==null){if(s.has(l))return;s.add(l)}return l}}();return JSON.stringify(i,o)};return typeof t=="function"&&typeof e=="function"?t.toString()===e.toString():Zh(t)!==Zh(e)?!1:n(t)===n(e)}var H8="16.0.1",jT=Cs({name:"HotTable",props:ZL("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var n=JA(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||n===void 0||(n.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete n.data),Object.keys(n).length?this.hotInstance.updateSettings(n):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(A8),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=JA(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=IW(new Vr.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var n=this.hotInstance.getSourceData(),r=[],i=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==o&&n.length<o)for(var l=n.length;l<o;l++)r.push(l);if(s){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&((u=n[0])===null||u===void 0?void 0:u.length)!==a&&n[0].length<a)for(var c=n[0].length;c<a;c++)i.push(c)}this.hotInstance.batch(function(){r.length>0?e.hotInstance.rowIndexMapper.removeIndexes(r):e.hotInstance.rowIndexMapper.insertIndexes(o-1,n.length-o),s&&n.length!==0&&(i.length>0?e.hotInstance.columnIndexMapper.removeIndexes(i):e.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:H8}),N8=["id"];function D8(t,e,n,r,i,o){return Kn(),Ro("div",{id:t.id},[$r(t.$slots,"default")],8,N8)}jT.render=D8;jT.__file="src/HotTable.vue";var k8=Cs({name:"HotColumn",props:ZL("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=JL(this.$props),n=P8({},e);e.renderer&&(n.renderer=e.renderer),e.editor&&(n.editor=e.editor),this.columnsCache.set(this,n)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});k8.__file="src/HotColumn.vue";function e1(t,e,n){return(e=L8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L8(t){var e=$8(t,"string");return typeof e=="symbol"?e:e+""}function $8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const t1="handsontableEditor",F8="handsontable";class UT extends Bl{constructor(){super(...arguments),e1(this,"isFlippedVertically",!1),e1(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return F8}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),zp(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&on(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getDropdownHeight(),o=e.getWorkspaceHeight()-r-n.height,s=i>o&&r>o+n.height;return s?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:s,spaceAbove:r,spaceBelow:o}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;r=Math.max(r+a,0)}const i=this.getDropdownWidth(),o=e.getWorkspaceWidth()-r+n.width,s=i>o&&r>o;return s?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:s,spaceInlineStart:r,spaceInlineEnd:o}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:t1,relativeToGroup:va,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||this.isFlippedVertically&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),ji(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&this.isFlippedVertically?a=s.countRows()-1:s.getSelectedLast()&&(this.isFlippedVertically?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!this.isFlippedVertically)a=0;else if(s.getSelectedLast()){if(this.isFlippedVertically)a=s.getSelectedLast()[0]+1;else if(!this.isFlippedVertically){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(t1)}}function V8(t,e){QL(t,e),e.add(t)}function n1(t,e,n){QL(t,e),e.set(t,n)}function QL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qf(t,e,n){return(e=W8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W8(t){var e=B8(t,"string");return typeof e=="symbol"?e:e+""}function B8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ob(t,e){return t.get(pR(t,e))}function pR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const j8="autocomplete";var sb=new WeakMap,r1=new WeakMap,ab=new WeakSet;class zT extends UT{constructor(){super(...arguments),V8(this,ab),qf(this,"query",null),qf(this,"strippedChoices",[]),qf(this,"rawChoices",[]),n1(this,sb,this.hot.guid.slice(0,9)),n1(this,r1,Gp(()=>{this.focus()},100)),qf(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=jO(Ot(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return j8}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ue(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),X(this.htContainer,"autocompleteEditor"),X(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[h2(),s2(),wk("listbox"),m2()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[si("false"),p2(`${ob(sb,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r?.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",ob(r1,this)),this.htEditor.updateSettings({colWidths:e?[qt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{Es(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:w,locale:C}=this.cellProperties,S=this.query;let v=Ot(d),T,P;v&&!w&&(T=g===!0?v.indexOf(S):v.toLocaleLowerCase(C).indexOf(S.toLocaleLowerCase(C)),T!==-1&&(P=v.substr(T,S.length),v=v.replace(P,`<strong>${P}</strong>`))),n&&Ce(l,[a2(),...r?[y2(i)]:[],...r?[b2(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=v},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{Ce(h,[FE()]),Ce(this.TEXTAREA,...w2(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(Ce(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...ss()),Ce(this.htEditor.rootElement,[pk(),v2("polite"),C2("text"),["id",`${ob(sb,this)}-listbox-${o}-${s}`]]),Ce(this.TEXTAREA,...si("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[si("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=xk(this.TEXTAREA),r=W2(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(nm([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),zp(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:r,spaceBelow:i}=e;return this.limitDropdownIfNeeded(n?r:i),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let r=0,i=0,o=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),r+=i;while(r<e);o=r-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(r-i)}}updateDropdownDimensions(){const e=Ak(),n=this.getTargetEditorWidth()+e,r=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:r}),pR(ab,this,i1).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),pR(ab,this,i1).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(i,o)=>o).reduce((i,o)=>{const s=this.hot.stylesHandler.getDefaultRowHeight()+(o===0?1:0);return i+s},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=je(e,o=>Ot(o));return je(r,o=>n?o:jO(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===me.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===me.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(G2(e.keyCode)||e.keyCode===me.BACKSPACE||e.keyCode===me.DELETE||e.keyCode===me.INSERT){let n=10;if(e.keyCode===me.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function i1(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+bn(this.hot.rootDocument)})}const U8="checkbox";class e$ extends Rc{static get EDITOR_TYPE(){return U8}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');ye(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const ea=()=>window,ni=()=>window.document,wR=(t,e)=>window.setTimeout(t,e),uo=function(t,e,n,r){t.addEventListener(e,n,!!r)},Bo=function(t,e,n,r){t.removeEventListener(e,n,!!r)},z8=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Ir=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},lb=function(t,e){Ir(t,e)||(t.className=t.className===""?e:t.className+" "+e)},ub=function(t,e){t.className=z8((" "+t.className+" ").replace(" "+e+" "," "))},YT=function(t){return/Array/.test(Object.prototype.toString.call(t))},Hr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Y8=function(t){let e=t.getDay();return e===0||e===6},G8=function(t){return t%4===0&&t%100!==0||t%400===0},o1=function(t,e){return[31,G8(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Kf=function(t){Hr(t)&&t.setHours(0,0,0,0)},Xf=function(t,e){return t.getTime()===e.getTime()},jm=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Hr(e[r])?n&&(t[r]=new Date(e[r].getTime())):YT(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=jm({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},s1=function(t,e,n){let r=ni().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=jm(r,n),t.dispatchEvent(r)},a1=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Zi={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},l1=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},q8=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},K8=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},X8=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():K8(o,i))+"</td>"},Z8=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},J8=function(t){return"<tbody>"+t.join("")+"</tbody>"},Q8=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+l1(t,e)+'">'+l1(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},e5=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,w=!0,C=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",YT(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(w=!1),h&&(r===11||u.maxMonth<=r)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(w?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},t5=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Q8(t)+J8(e)+"</table>"};function vR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||ea().event;let o=i.target||i.srcElement;if(o)if(Ir(o,"is-disabled")||(Ir(o,"pika-button")&&!Ir(o,"is-empty")&&!Ir(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&wR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Ir(o,"pika-prev")?e.prevMonth():Ir(o,"pika-next")&&e.nextMonth()),Ir(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||ea().event;let o=i.target||i.srcElement;o&&(Ir(o,"pika-select-month")?e.gotoMonth(o.value):Ir(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||ea().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Hr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=ni().activeElement;do if(Ir(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=wR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||ea().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Ir(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),uo(o,"change",e._onChange)));do if(Ir(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=ni().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),uo(e.el,"mousedown",e._onMouseDown,!0),uo(e.el,"touchend",e._onMouseDown,!0),uo(e.el,"change",e._onChange),n.keyboardInput&&uo(ni(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?ni().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),uo(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Hr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",uo(n.trigger,"click",e._onInputClick),uo(n.trigger,"focus",e._onInputFocus),uo(n.trigger,"blur",e._onInputBlur)):this.show()}vR.prototype={config:function(t){this._o||(this._o=jm({},Zi,!0));let e=jm(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Hr(e.minDate)||(e.minDate=!1),Hr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),YT(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Zi.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Hr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Hr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",s1(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Hr(t))return;let n=this._o.minDate,r=this._o.maxDate;Hr(n)&&t<n?t=n:Hr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Kf(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),s1(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Hr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=a1(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=a1({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Kf(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Zi.minDate,this._o.minYear=Zi.minYear,this._o.minMonth=Zi.minMonth,this._o.startRange=Zi.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Kf(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Zi.maxDate,this._o.maxYear=Zi.maxYear,this._o.maxMonth=Zi.maxMonth,this._o.endRange=Zi.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+e5(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&wR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=ea().innerWidth||ni().documentElement.clientWidth,i=ea().innerHeight||ni().documentElement.clientHeight,o=ni().body.scrollTop||ni().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+ea().pageXOffset,a=l.bottom+ea().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",lb(this.el,u?"left-aligned":"right-aligned"),lb(this.el,c?"bottom-aligned":"top-aligned"),ub(this.el,u?"right-aligned":"left-aligned"),ub(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=o1(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Kf(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=o1(h,u),g=o+s,w=g;for(;w>7;)w-=7;g+=7-w;let C=!1;for(let S=0,v=0;S<g;S++){let T=new Date(t,e,1+(S-s)),P=Hr(this._d)?Xf(T,this._d):!1,x=Xf(T,i),_=r.events.indexOf(T.toDateString())!==-1,M=S<s||S>=o+s,V=1+(S-s),Y=e,O=t,G=r.startRange&&Xf(r.startRange,T),J=r.endRange&&Xf(r.endRange,T),ae=r.startRange&&r.endRange&&r.startRange<T&&T<r.endRange,te=r.minDate&&T<r.minDate||r.maxDate&&T>r.maxDate||r.disableWeekends&&Y8(T)||r.disableDayFn&&r.disableDayFn(T);M&&(S<s?(V=f+V,Y=u,O=h):(V=V-o,Y=c,O=d));let ne={day:V,month:Y,year:O,hasEvent:_,isSelected:P,isToday:x,isDisabled:te,isEmpty:M,isStartRange:G,isEndRange:J,isInRange:ae,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&P&&(C=!0),l.push(q8(ne)),++v===7&&(r.showWeekNumber&&l.unshift(X8(this,S-s,e,t,r.firstWeekOfYearMinDays)),a.push(Z8(l,r.isRTL,r.pickWholeWeek,C)),l=[],v=0,C=!1)}return t5(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),ub(this.el,"is-hidden"),this._o.bound&&(uo(ni(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Bo(ni(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),lb(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Bo(this.el,"mousedown",this._onMouseDown,!0),Bo(this.el,"touchend",this._onMouseDown,!0),Bo(this.el,"change",this._onChange),t.keyboardInput&&Bo(ni(),"keydown",this._onKeyChange),t.field&&(Bo(t.field,"change",this._onInputChange),t.bound&&(Bo(t.trigger,"click",this._onInputClick),Bo(t.trigger,"focus",this._onInputFocus),Bo(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function n5(t,e){r5(t,e),e.add(t)}function r5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u1(t,e,n){return(e=i5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i5(t){var e=o5(t,"string");return typeof e=="symbol"?e:e+""}function o5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const t$="date",c1="dateEditor",s5="DD/MM/YYYY";var Zf=new WeakSet;class n$ extends Bl{constructor(){super(...arguments),n5(this,Zf),u1(this,"parentDestroyed",!1),u1(this,"$datePicker",null)}static get EDITOR_TYPE(){return t$}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof vR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),X(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{ye(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:c1})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(c1),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=cb(Zf,this,hb).call(this),r=this.hot.view.isMouseDown(),i=e?Vk(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new vR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Z),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&Up(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:cb(Zf,this,hb).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Z(a).format(cb(Zf,this,hb).call(this))),this.setValue(a),i&&i(),So()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Wt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+rn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-qt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function hb(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:s5}const a5="dropdown";class r$ extends zT{static get EDITOR_TYPE(){return a5}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const l5="numeric";class i$ extends Bl{static get EDITOR_TYPE(){return l5}}function u5(t,e,n){return(e=c5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c5(t){var e=h5(t,"string");return typeof e=="symbol"?e:e+""}function h5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const d5="password";class o$ extends Bl{constructor(){super(...arguments),u5(this,"autoResize",KL(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return d5}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ms(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...ma(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const db="ht_editor_visible",h1="selectEditor",f5="select";class s$ extends Rc{static get EDITOR_TYPE(){return f5}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Vl()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),X(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ye(this.selectWrapper,db)&&we(this.selectWrapper,db),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ms(this.select),De(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,bc(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Wt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",X(this.selectWrapper,db)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:h1};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(h1)}}const g5="time";class a$ extends Bl{static get EDITOR_TYPE(){return g5}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function m5(){Pr(Rc),Pr(zT),Pr(e$),Pr(n$),Pr(r$),Pr(UT),Pr(i$),Pr(o$),Pr(s$),Pr(Bl),Pr(a$)}const p5="html";function GT(t,e,n,r,i,o,s){ef.apply(this,[t,e,n,r,i,o,s]),bc(e,o??"",!1)}GT.RENDERER_TYPE=p5;const w5="autocomplete";function Tc(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?GT:Es,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Vl()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),X(e,"htAutocomplete"),!t.acArrowListener){const h=new Vi(t);t.acArrowListener=function(d){ye(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Tc.RENDERER_TYPE=w5;const v5="dropdown";function qT(t,e,n,r,i,o,s){Tc.apply(this,[t,e,n,r,i,o,s])}qT.RENDERER_TYPE=v5;const d1=new WeakMap,f1=new WeakMap,C5="htBadValue",uc="data-row",cc="data-col",y5="checkboxRenderer",l$="checkbox";ie.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===l$){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function KT(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;ef.apply(this,[t,e,n,r,i,o,s]),b5(t);let u=S5(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),ms(e),o===s.checkedTemplate||Ot(o).toLocaleLowerCase(s.locale)===Ot(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Ot(o).toLocaleLowerCase(s.locale)===Ot(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:jt(o)?X(u,"noValue"):(u.style.display="none",X(u,C5),h=!0),Ce(u,[[uc,n],[cc,r]]),l&&Ce(u,[rc(u.checked?t.getTranslatedPhrase(LT):t.getTranslatedPhrase($T)),yk(u.checked),l2()]),!h&&c){let w="";if(c.value)w=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const S=t.getDataAtRowProp(n,c.property);w=S!==null?S:""}const C=R5(a,w,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),d1.has(t)||(d1.set(t,!0),d());function d(){const C=t.getShortcutManager().getContext("grid"),S={group:y5,relativeToGroup:va,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const v=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&v?.highlight.isCell()&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}}],S)}function f(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=t.getSelectedRange(),S=[],v=new Map;let T=[],P=0;if(C){for(let x=0;x<C.length;x++){const{row:_,col:M}=C[x].getTopStartCorner(),{row:V,col:Y}=C[x].getBottomEndCorner();for(let O=_;O<=V;O+=1)for(let G=M;G<=Y;G+=1){const J=t.getCellMeta(O,G);if(J.hidden)continue;const ae={checkedTemplate:J.checkedTemplate,uncheckedTemplate:J.uncheckedTemplate};if(J.type!=="checkbox"){w===!0&&!J.readOnly&&(v.has(S.length)?v.set(S.length,[...v.get(S.length),[O,G,null]]):v.set(S.length,[[O,G,null]]));continue}if(J.readOnly===!0)continue;typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);const te=t.getDataAtCell(O,G);w===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(te)?T.push([O,G,J.uncheckedTemplate,ae]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(te)&&T.push([O,G,J.checkedTemplate,ae]):T.push([O,G,J.uncheckedTemplate,ae]),P+=1}S.push(P),P=0}T.every(x=>{let[,,_]=x;return _===T[0][2]})?T=T.map(x=>{let[_,M,V]=x;return[_,M,V]}):T=T.map(x=>{let[_,M,,V]=x;return[_,M,V.checkedTemplate]}),T.length>0&&S.forEach((x,_)=>{let M=T.splice(0,x);v.size&&v.has(_)&&(M=[...M,...v.get(_)]),t.setDataAtCell(M)})}}function g(){const w=t.getSelectedRange();if(w){for(let C=0;C<w.length;C++){const S=w[C].getTopStartCorner(),v=w[C].getBottomEndCorner();for(let T=S.row;T<=v.row;T++)for(let P=S.col;P<=v.col;P++){if(t.getCellMeta(T,P).readOnly)continue;const _=t.getCell(T,P);if(fs(_)&&_.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}KT.RENDERER_TYPE=l$;function b5(t){let e=f1.get(t);if(!e){const{rootElement:n}=t;e=new Vi(t),e.addEventListener(n,"click",r=>T5(r,t)),e.addEventListener(n,"mouseup",r=>E5(r,t)),e.addEventListener(n,"change",r=>_5(r,t)),f1.set(t,e)}return e}function S5(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function R5(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function E5(t,e){const{target:n}=t;XT(n)&&(!n.hasAttribute(uc)||!n.hasAttribute(cc)||setTimeout(e.listen,10))}function T5(t,e){const{target:n}=t;if(!XT(n)||!n.hasAttribute(uc)||!n.hasAttribute(cc))return;const r=parseInt(n.getAttribute(uc),10),i=parseInt(n.getAttribute(cc),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function _5(t,e){const{target:n}=t;if(!XT(n)||!n.hasAttribute(uc)||!n.hasAttribute(cc))return;const r=parseInt(n.getAttribute(uc),10),i=parseInt(n.getAttribute(cc),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function XT(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const M5="handsontable";function ZT(t,e,n,r,i,o,s){Tc.apply(this,[t,e,n,r,i,o,s])}ZT.RENDERER_TYPE=M5;var I5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function P5(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var fb,g1;function O5(){return g1||(g1=1,fb={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),fb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var gb,m1;function u$(){if(m1)return gb;m1=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let w="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*n(C,u,c,h,d,f);for(let _=0;_<t.length;_++){let M=t[_];if(w=l.replace(RegExp(`([0-9 ])(${M.key})$`),"$1"),w!==l)return n(w,u,c,h,d,f)*M.factor}if(w=l.replace("%",""),w!==l)return n(w,u,c,h,d,f)/100;let S=parseFloat(l);if(isNaN(S))return;let v=h(S);if(v&&v!=="."&&(w=l.replace(new RegExp(`${e(v)}$`),""),w!==l))return n(w,u,c,h,d,f);let T={};Object.keys(f).forEach(_=>{T[f[_]]=_});let P=Object.keys(T).sort().reverse(),x=P.length;for(let _=0;_<x;_++){let M=P[_],V=T[M];if(w=l.replace(M,""),w!==l){let Y;switch(V){case"thousand":Y=Math.pow(10,3);break;case"million":Y=Math.pow(10,6);break;case"billion":Y=Math.pow(10,9);break;case"trillion":Y=Math.pow(10,12);break}return n(w,u,c,h,d,f)*Y}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let w=r(l,u,c);return n(w,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=e_();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),w=c.currentAbbreviations(),C;if(typeof l=="string")o(l,h)?C=s(l):C=i(l,h,d,f,g,w);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return gb={unformat:a},gb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var mb,p1;function JT(){if(p1)return mb;p1=1;let t=u$();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,S)=>S.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,S)=>S.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,S)=>!S.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,S)=>S.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(C,S){let v=d(C),T=g(S);return v&&T}function d(C){return t.unformat(C)!==void 0}function f(C,S,v,T=!1){let P=Object.keys(C).map(x=>{if(!S[x])return console.error(`${v} Invalid key: ${x}`),!1;let _=C[x],M=S[x];if(typeof M=="string"&&(M={type:M}),M.type==="format"){if(!f(_,u,`[Validate ${x}]`,!0))return!1}else if(typeof _!==M.type)return console.error(`${v} ${x} type mismatched: "${M.type}" expected, "${typeof _}" provided`),!1;if(M.restrictions&&M.restrictions.length){let V=M.restrictions.length;for(let Y=0;Y<V;Y++){let{restriction:O,message:G}=M.restrictions[Y];if(!O(_,C))return console.error(`${v} ${x} invalid value: ${G}`),!1}}return M.restriction&&!M.restriction(_,C)?(console.error(`${v} ${x} invalid value: ${M.message}`),!1):M.validValues&&M.validValues.indexOf(_)===-1?(console.error(`${v} ${x} invalid value: must be among ${JSON.stringify(M.validValues)}, "${_}" provided`),!1):!(M.children&&!f(_,M.children,`[Validate ${x}]`))});return T||P.push(...Object.keys(S).map(x=>{let _=S[x];if(typeof _=="string"&&(_={type:_}),_.mandatory){let M=_.mandatory;if(typeof M=="function"&&(M=M(C)),M&&C[x]===void 0)return console.error(`${v} Missing mandatory key "${x}"`),!1}return!0})),P.reduce((x,_)=>x&&_,!0)}function g(C){return f(C,u,"[Validate format]")}function w(C){return f(C,c,"[Validate language]")}return mb={validate:h,validateFormat:g,validateInput:d,validateLanguage:w},mb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function x5(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function A5(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function H5(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function N5(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function D5(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function k5(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function L5(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function $5(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function F5(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function V5(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function W5(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function B5(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function j5(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function U5(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function z5(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function Y5(t,e={}){return typeof t!="string"?t:(t=x5(t,e),t=A5(t,e),H5(t,e),k5(t,e),L5(t,e),j5(t,e),V5(t,e),W5(t,e),$5(t,e),B5(t,e),F5(t,e),N5(t,e),D5(t,e),U5(t,e),z5(t,e),e)}var QT={parseFormat:Y5};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var pb,w1;function e_(){if(w1)return pb;w1=1;const t=O5(),e=JT(),n=QT;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,pb=r,pb}function G5(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function q5(t,e){t.forEach(n=>{let r;try{r=G5(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var K5=t=>({loadLanguagesInNode:e=>q5(e,t)}),c$={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(_){var M,V,Y,O=p.prototype={constructor:p,toString:null,valueOf:null},G=new p(1),J=20,ae=4,te=-7,ne=21,Fe=-1e7,ke=1e7,Ve=!1,yt=1,ot=0,ut={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},pn="0123456789abcdefghijklmnopqrstuvwxyz",m=!0;function p(y,R){var E,I,A,L,B,N,$,W,U=this;if(!(U instanceof p))return new p(y,R);if(R==null){if(y&&y._isBigNumber===!0){U.s=y.s,!y.c||y.e>ke?U.c=U.e=null:y.e<Fe?U.c=[U.e=0]:(U.e=y.e,U.c=y.c.slice());return}if((N=typeof y=="number")&&y*0==0){if(U.s=1/y<0?(y=-y,-1):1,y===~~y){for(L=0,B=y;B>=10;B/=10,L++);L>ke?U.c=U.e=null:(U.e=L,U.c=[y]);return}W=String(y)}else{if(!r.test(W=String(y)))return Y(U,W,N);U.s=W.charCodeAt(0)==45?(W=W.slice(1),-1):1}(L=W.indexOf("."))>-1&&(W=W.replace(".","")),(B=W.search(/e/i))>0?(L<0&&(L=B),L+=+W.slice(B+1),W=W.substring(0,B)):L<0&&(L=W.length)}else{if(v(R,2,pn.length,"Base"),R==10&&m)return U=new p(y),j(U,J+U.e+1,ae);if(W=String(y),N=typeof y=="number"){if(y*0!=0)return Y(U,W,N,R);if(U.s=1/y<0?(W=W.slice(1),-1):1,p.DEBUG&&W.replace(/^0\.0*|\./,"").length>15)throw Error(a+y)}else U.s=W.charCodeAt(0)===45?(W=W.slice(1),-1):1;for(E=pn.slice(0,R),L=B=0,$=W.length;B<$;B++)if(E.indexOf(I=W.charAt(B))<0){if(I=="."){if(B>L){L=$;continue}}else if(!A&&(W==W.toUpperCase()&&(W=W.toLowerCase())||W==W.toLowerCase()&&(W=W.toUpperCase()))){A=!0,B=-1,L=0;continue}return Y(U,String(y),N,R)}N=!1,W=V(W,R,10,U.s),(L=W.indexOf("."))>-1?W=W.replace(".",""):L=W.length}for(B=0;W.charCodeAt(B)===48;B++);for($=W.length;W.charCodeAt(--$)===48;);if(W=W.slice(B,++$)){if($-=B,N&&p.DEBUG&&$>15&&(y>c||y!==o(y)))throw Error(a+U.s*y);if((L=L-B-1)>ke)U.c=U.e=null;else if(L<Fe)U.c=[U.e=0];else{if(U.e=L,U.c=[],B=(L+1)%u,L<0&&(B+=u),B<$){for(B&&U.c.push(+W.slice(0,B)),$-=u;B<$;)U.c.push(+W.slice(B,B+=u));B=u-(W=W.slice(B)).length}else B-=$;for(;B--;W+="0");U.c.push(+W)}}else U.c=[U.e=0]}p.clone=g,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(y){var R,E;if(y!=null)if(typeof y=="object"){if(y.hasOwnProperty(R="DECIMAL_PLACES")&&(E=y[R],v(E,0,f,R),J=E),y.hasOwnProperty(R="ROUNDING_MODE")&&(E=y[R],v(E,0,8,R),ae=E),y.hasOwnProperty(R="EXPONENTIAL_AT")&&(E=y[R],E&&E.pop?(v(E[0],-f,0,R),v(E[1],0,f,R),te=E[0],ne=E[1]):(v(E,-f,f,R),te=-(ne=E<0?-E:E))),y.hasOwnProperty(R="RANGE"))if(E=y[R],E&&E.pop)v(E[0],-f,-1,R),v(E[1],1,f,R),Fe=E[0],ke=E[1];else if(v(E,-f,f,R),E)Fe=-(ke=E<0?-E:E);else throw Error(s+R+" cannot be zero: "+E);if(y.hasOwnProperty(R="CRYPTO"))if(E=y[R],E===!!E)if(E)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ve=E;else throw Ve=!E,Error(s+"crypto unavailable");else Ve=E;else throw Error(s+R+" not true or false: "+E);if(y.hasOwnProperty(R="MODULO_MODE")&&(E=y[R],v(E,0,9,R),yt=E),y.hasOwnProperty(R="POW_PRECISION")&&(E=y[R],v(E,0,f,R),ot=E),y.hasOwnProperty(R="FORMAT"))if(E=y[R],typeof E=="object")ut=E;else throw Error(s+R+" not an object: "+E);if(y.hasOwnProperty(R="ALPHABET"))if(E=y[R],typeof E=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(E))m=E.slice(0,10)=="0123456789",pn=E;else throw Error(s+R+" invalid: "+E)}else throw Error(s+"Object expected: "+y);return{DECIMAL_PLACES:J,ROUNDING_MODE:ae,EXPONENTIAL_AT:[te,ne],RANGE:[Fe,ke],CRYPTO:Ve,MODULO_MODE:yt,POW_PRECISION:ot,FORMAT:ut,ALPHABET:pn}},p.isBigNumber=function(y){if(!y||y._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var R,E,I=y.c,A=y.e,L=y.s;e:if({}.toString.call(I)=="[object Array]"){if((L===1||L===-1)&&A>=-f&&A<=f&&A===o(A)){if(I[0]===0){if(A===0&&I.length===1)return!0;break e}if(R=(A+1)%u,R<1&&(R+=u),String(I[0]).length==R){for(R=0;R<I.length;R++)if(E=I[R],E<0||E>=l||E!==o(E))break e;if(E!==0)return!0}}}else if(I===null&&A===null&&(L===null||L===1||L===-1))return!0;throw Error(s+"Invalid BigNumber: "+y)},p.maximum=p.max=function(){return D(arguments,-1)},p.minimum=p.min=function(){return D(arguments,1)},p.random=function(){var y=9007199254740992,R=Math.random()*y&2097151?function(){return o(Math.random()*y)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(E){var I,A,L,B,N,$=0,W=[],U=new p(G);if(E==null?E=J:v(E,0,f),B=i(E/u),Ve)if(crypto.getRandomValues){for(I=crypto.getRandomValues(new Uint32Array(B*=2));$<B;)N=I[$]*131072+(I[$+1]>>>11),N>=9e15?(A=crypto.getRandomValues(new Uint32Array(2)),I[$]=A[0],I[$+1]=A[1]):(W.push(N%1e14),$+=2);$=B/2}else if(crypto.randomBytes){for(I=crypto.randomBytes(B*=7);$<B;)N=(I[$]&31)*281474976710656+I[$+1]*1099511627776+I[$+2]*4294967296+I[$+3]*16777216+(I[$+4]<<16)+(I[$+5]<<8)+I[$+6],N>=9e15?crypto.randomBytes(7).copy(I,$):(W.push(N%1e14),$+=7);$=B/7}else throw Ve=!1,Error(s+"crypto unavailable");if(!Ve)for(;$<B;)N=R(),N<9e15&&(W[$++]=N%1e14);for(B=W[--$],E%=u,B&&E&&(N=h[u-E],W[$]=o(B/N)*N);W[$]===0;W.pop(),$--);if($<0)W=[L=0];else{for(L=-1;W[0]===0;W.splice(0,1),L-=u);for($=1,N=W[0];N>=10;N/=10,$++);$<u&&(L-=u-$)}return U.e=L,U.c=W,U}}(),p.sum=function(){for(var y=1,R=arguments,E=new p(R[0]);y<R.length;)E=E.plus(R[y++]);return E},V=function(){var y="0123456789";function R(E,I,A,L){for(var B,N=[0],$,W=0,U=E.length;W<U;){for($=N.length;$--;N[$]*=I);for(N[0]+=L.indexOf(E.charAt(W++)),B=0;B<N.length;B++)N[B]>A-1&&(N[B+1]==null&&(N[B+1]=0),N[B+1]+=N[B]/A|0,N[B]%=A)}return N.reverse()}return function(E,I,A,L,B){var N,$,W,U,q,se,le,Re,We=E.indexOf("."),Be=J,Ee=ae;for(We>=0&&(U=ot,ot=0,E=E.replace(".",""),Re=new p(I),se=Re.pow(E.length-We),ot=U,Re.c=R(x(C(se.c),se.e,"0"),10,A,y),Re.e=Re.c.length),le=R(E,I,A,B?(N=pn,y):(N=y,pn)),W=U=le.length;le[--U]==0;le.pop());if(!le[0])return N.charAt(0);if(We<0?--W:(se.c=le,se.e=W,se.s=L,se=M(se,Re,Be,Ee,A),le=se.c,q=se.r,W=se.e),$=W+Be+1,We=le[$],U=A/2,q=q||$<0||le[$+1]!=null,q=Ee<4?(We!=null||q)&&(Ee==0||Ee==(se.s<0?3:2)):We>U||We==U&&(Ee==4||q||Ee==6&&le[$-1]&1||Ee==(se.s<0?8:7)),$<1||!le[0])E=q?x(N.charAt(1),-Be,N.charAt(0)):N.charAt(0);else{if(le.length=$,q)for(--A;++le[--$]>A;)le[$]=0,$||(++W,le=[1].concat(le));for(U=le.length;!le[--U];);for(We=0,E="";We<=U;E+=N.charAt(le[We++]));E=x(E,W,N.charAt(0))}return E}}(),M=function(){function y(I,A,L){var B,N,$,W,U=0,q=I.length,se=A%d,le=A/d|0;for(I=I.slice();q--;)$=I[q]%d,W=I[q]/d|0,B=le*$+W*se,N=se*$+B%d*d+U,U=(N/L|0)+(B/d|0)+le*W,I[q]=N%L;return U&&(I=[U].concat(I)),I}function R(I,A,L,B){var N,$;if(L!=B)$=L>B?1:-1;else for(N=$=0;N<L;N++)if(I[N]!=A[N]){$=I[N]>A[N]?1:-1;break}return $}function E(I,A,L,B){for(var N=0;L--;)I[L]-=N,N=I[L]<A[L]?1:0,I[L]=N*B+I[L]-A[L];for(;!I[0]&&I.length>1;I.splice(0,1));}return function(I,A,L,B,N){var $,W,U,q,se,le,Re,We,Be,Ee,Se,nt,er,Ao,mi,cn,bt,_t=I.s==A.s?1:-1,wt=I.c,Qe=A.c;if(!wt||!wt[0]||!Qe||!Qe[0])return new p(!I.s||!A.s||(wt?Qe&&wt[0]==Qe[0]:!Qe)?NaN:wt&&wt[0]==0||!Qe?_t*0:_t/0);for(We=new p(_t),Be=We.c=[],W=I.e-A.e,_t=L+W+1,N||(N=l,W=w(I.e/u)-w(A.e/u),_t=_t/u|0),U=0;Qe[U]==(wt[U]||0);U++);if(Qe[U]>(wt[U]||0)&&W--,_t<0)Be.push(1),q=!0;else{for(Ao=wt.length,cn=Qe.length,U=0,_t+=2,se=o(N/(Qe[0]+1)),se>1&&(Qe=y(Qe,se,N),wt=y(wt,se,N),cn=Qe.length,Ao=wt.length),er=cn,Ee=wt.slice(0,cn),Se=Ee.length;Se<cn;Ee[Se++]=0);bt=Qe.slice(),bt=[0].concat(bt),mi=Qe[0],Qe[1]>=N/2&&mi++;do{if(se=0,$=R(Qe,Ee,cn,Se),$<0){if(nt=Ee[0],cn!=Se&&(nt=nt*N+(Ee[1]||0)),se=o(nt/mi),se>1)for(se>=N&&(se=N-1),le=y(Qe,se,N),Re=le.length,Se=Ee.length;R(le,Ee,Re,Se)==1;)se--,E(le,cn<Re?bt:Qe,Re,N),Re=le.length,$=1;else se==0&&($=se=1),le=Qe.slice(),Re=le.length;if(Re<Se&&(le=[0].concat(le)),E(Ee,le,Se,N),Se=Ee.length,$==-1)for(;R(Qe,Ee,cn,Se)<1;)se++,E(Ee,cn<Se?bt:Qe,Se,N),Se=Ee.length}else $===0&&(se++,Ee=[0]);Be[U++]=se,Ee[0]?Ee[Se++]=wt[er]||0:(Ee=[wt[er]],Se=1)}while((er++<Ao||Ee[0]!=null)&&_t--);q=Ee[0]!=null,Be[0]||Be.splice(0,1)}if(N==l){for(U=1,_t=Be[0];_t>=10;_t/=10,U++);j(We,L+(We.e=U+W*u-1)+1,B,q)}else We.e=W,We.r=+q;return We}}();function b(y,R,E,I){var A,L,B,N,$;if(E==null?E=ae:v(E,0,8),!y.c)return y.toString();if(A=y.c[0],B=y.e,R==null)$=C(y.c),$=I==1||I==2&&(B<=te||B>=ne)?P($,B):x($,B,"0");else if(y=j(new p(y),R,E),L=y.e,$=C(y.c),N=$.length,I==1||I==2&&(R<=L||L<=te)){for(;N<R;$+="0",N++);$=P($,L)}else if(R-=B,$=x($,L,"0"),L+1>N){if(--R>0)for($+=".";R--;$+="0");}else if(R+=L-N,R>0)for(L+1==N&&($+=".");R--;$+="0");return y.s<0&&A?"-"+$:$}function D(y,R){for(var E,I,A=1,L=new p(y[0]);A<y.length;A++)I=new p(y[A]),(!I.s||(E=S(L,I))===R||E===0&&L.s===R)&&(L=I);return L}function F(y,R,E){for(var I=1,A=R.length;!R[--A];R.pop());for(A=R[0];A>=10;A/=10,I++);return(E=I+E*u-1)>ke?y.c=y.e=null:E<Fe?y.c=[y.e=0]:(y.e=E,y.c=R),y}Y=function(){var y=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,E=/^\.([^.]+)$/,I=/^-?(Infinity|NaN)$/,A=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(L,B,N,$){var W,U=N?B:B.replace(A,"");if(I.test(U))L.s=isNaN(U)?null:U<0?-1:1;else{if(!N&&(U=U.replace(y,function(q,se,le){return W=(le=le.toLowerCase())=="x"?16:le=="b"?2:8,!$||$==W?se:q}),$&&(W=$,U=U.replace(R,"$1").replace(E,"0.$1")),B!=U))return new p(U,W);if(p.DEBUG)throw Error(s+"Not a"+($?" base "+$:"")+" number: "+B);L.s=null}L.c=L.e=null}}();function j(y,R,E,I){var A,L,B,N,$,W,U,q=y.c,se=h;if(q){e:{for(A=1,N=q[0];N>=10;N/=10,A++);if(L=R-A,L<0)L+=u,B=R,$=q[W=0],U=o($/se[A-B-1]%10);else if(W=i((L+1)/u),W>=q.length)if(I){for(;q.length<=W;q.push(0));$=U=0,A=1,L%=u,B=L-u+1}else break e;else{for($=N=q[W],A=1;N>=10;N/=10,A++);L%=u,B=L-u+A,U=B<0?0:o($/se[A-B-1]%10)}if(I=I||R<0||q[W+1]!=null||(B<0?$:$%se[A-B-1]),I=E<4?(U||I)&&(E==0||E==(y.s<0?3:2)):U>5||U==5&&(E==4||I||E==6&&(L>0?B>0?$/se[A-B]:0:q[W-1])%10&1||E==(y.s<0?8:7)),R<1||!q[0])return q.length=0,I?(R-=y.e+1,q[0]=se[(u-R%u)%u],y.e=-R||0):q[0]=y.e=0,y;if(L==0?(q.length=W,N=1,W--):(q.length=W+1,N=se[u-L],q[W]=B>0?o($/se[A-B]%se[B])*N:0),I)for(;;)if(W==0){for(L=1,B=q[0];B>=10;B/=10,L++);for(B=q[0]+=N,N=1;B>=10;B/=10,N++);L!=N&&(y.e++,q[0]==l&&(q[0]=1));break}else{if(q[W]+=N,q[W]!=l)break;q[W--]=0,N=1}for(L=q.length;q[--L]===0;q.pop());}y.e>ke?y.c=y.e=null:y.e<Fe&&(y.c=[y.e=0])}return y}function K(y){var R,E=y.e;return E===null?y.toString():(R=C(y.c),R=E<=te||E>=ne?P(R,E):x(R,E,"0"),y.s<0?"-"+R:R)}return O.absoluteValue=O.abs=function(){var y=new p(this);return y.s<0&&(y.s=1),y},O.comparedTo=function(y,R){return S(this,new p(y,R))},O.decimalPlaces=O.dp=function(y,R){var E,I,A,L=this;if(y!=null)return v(y,0,f),R==null?R=ae:v(R,0,8),j(new p(L),y+L.e+1,R);if(!(E=L.c))return null;if(I=((A=E.length-1)-w(this.e/u))*u,A=E[A])for(;A%10==0;A/=10,I--);return I<0&&(I=0),I},O.dividedBy=O.div=function(y,R){return M(this,new p(y,R),J,ae)},O.dividedToIntegerBy=O.idiv=function(y,R){return M(this,new p(y,R),0,1)},O.exponentiatedBy=O.pow=function(y,R){var E,I,A,L,B,N,$,W,U,q=this;if(y=new p(y),y.c&&!y.isInteger())throw Error(s+"Exponent not an integer: "+K(y));if(R!=null&&(R=new p(R)),N=y.e>14,!q.c||!q.c[0]||q.c[0]==1&&!q.e&&q.c.length==1||!y.c||!y.c[0])return U=new p(Math.pow(+K(q),N?y.s*(2-T(y)):+K(y))),R?U.mod(R):U;if($=y.s<0,R){if(R.c?!R.c[0]:!R.s)return new p(NaN);I=!$&&q.isInteger()&&R.isInteger(),I&&(q=q.mod(R))}else{if(y.e>9&&(q.e>0||q.e<-1||(q.e==0?q.c[0]>1||N&&q.c[1]>=24e7:q.c[0]<8e13||N&&q.c[0]<=9999975e7)))return L=q.s<0&&T(y)?-0:0,q.e>-1&&(L=1/L),new p($?1/L:L);ot&&(L=i(ot/u+2))}for(N?(E=new p(.5),$&&(y.s=1),W=T(y)):(A=Math.abs(+K(y)),W=A%2),U=new p(G);;){if(W){if(U=U.times(q),!U.c)break;L?U.c.length>L&&(U.c.length=L):I&&(U=U.mod(R))}if(A){if(A=o(A/2),A===0)break;W=A%2}else if(y=y.times(E),j(y,y.e+1,1),y.e>14)W=T(y);else{if(A=+K(y),A===0)break;W=A%2}q=q.times(q),L?q.c&&q.c.length>L&&(q.c.length=L):I&&(q=q.mod(R))}return I?U:($&&(U=G.div(U)),R?U.mod(R):L?j(U,ot,ae,B):U)},O.integerValue=function(y){var R=new p(this);return y==null?y=ae:v(y,0,8),j(R,R.e+1,y)},O.isEqualTo=O.eq=function(y,R){return S(this,new p(y,R))===0},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(y,R){return S(this,new p(y,R))>0},O.isGreaterThanOrEqualTo=O.gte=function(y,R){return(R=S(this,new p(y,R)))===1||R===0},O.isInteger=function(){return!!this.c&&w(this.e/u)>this.c.length-2},O.isLessThan=O.lt=function(y,R){return S(this,new p(y,R))<0},O.isLessThanOrEqualTo=O.lte=function(y,R){return(R=S(this,new p(y,R)))===-1||R===0},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&this.c[0]==0},O.minus=function(y,R){var E,I,A,L,B=this,N=B.s;if(y=new p(y,R),R=y.s,!N||!R)return new p(NaN);if(N!=R)return y.s=-R,B.plus(y);var $=B.e/u,W=y.e/u,U=B.c,q=y.c;if(!$||!W){if(!U||!q)return U?(y.s=-R,y):new p(q?B:NaN);if(!U[0]||!q[0])return q[0]?(y.s=-R,y):new p(U[0]?B:ae==3?-0:0)}if($=w($),W=w(W),U=U.slice(),N=$-W){for((L=N<0)?(N=-N,A=U):(W=$,A=q),A.reverse(),R=N;R--;A.push(0));A.reverse()}else for(I=(L=(N=U.length)<(R=q.length))?N:R,N=R=0;R<I;R++)if(U[R]!=q[R]){L=U[R]<q[R];break}if(L&&(A=U,U=q,q=A,y.s=-y.s),R=(I=q.length)-(E=U.length),R>0)for(;R--;U[E++]=0);for(R=l-1;I>N;){if(U[--I]<q[I]){for(E=I;E&&!U[--E];U[E]=R);--U[E],U[I]+=l}U[I]-=q[I]}for(;U[0]==0;U.splice(0,1),--W);return U[0]?F(y,U,W):(y.s=ae==3?-1:1,y.c=[y.e=0],y)},O.modulo=O.mod=function(y,R){var E,I,A=this;return y=new p(y,R),!A.c||!y.s||y.c&&!y.c[0]?new p(NaN):!y.c||A.c&&!A.c[0]?new p(A):(yt==9?(I=y.s,y.s=1,E=M(A,y,0,3),y.s=I,E.s*=I):E=M(A,y,0,yt),y=A.minus(E.times(y)),!y.c[0]&&yt==1&&(y.s=A.s),y)},O.multipliedBy=O.times=function(y,R){var E,I,A,L,B,N,$,W,U,q,se,le,Re,We,Be,Ee=this,Se=Ee.c,nt=(y=new p(y,R)).c;if(!Se||!nt||!Se[0]||!nt[0])return!Ee.s||!y.s||Se&&!Se[0]&&!nt||nt&&!nt[0]&&!Se?y.c=y.e=y.s=null:(y.s*=Ee.s,!Se||!nt?y.c=y.e=null:(y.c=[0],y.e=0)),y;for(I=w(Ee.e/u)+w(y.e/u),y.s*=Ee.s,$=Se.length,q=nt.length,$<q&&(Re=Se,Se=nt,nt=Re,A=$,$=q,q=A),A=$+q,Re=[];A--;Re.push(0));for(We=l,Be=d,A=q;--A>=0;){for(E=0,se=nt[A]%Be,le=nt[A]/Be|0,B=$,L=A+B;L>A;)W=Se[--B]%Be,U=Se[B]/Be|0,N=le*W+U*se,W=se*W+N%Be*Be+Re[L]+E,E=(W/We|0)+(N/Be|0)+le*U,Re[L--]=W%We;Re[L]=E}return E?++I:Re.splice(0,1),F(y,Re,I)},O.negated=function(){var y=new p(this);return y.s=-y.s||null,y},O.plus=function(y,R){var E,I=this,A=I.s;if(y=new p(y,R),R=y.s,!A||!R)return new p(NaN);if(A!=R)return y.s=-R,I.minus(y);var L=I.e/u,B=y.e/u,N=I.c,$=y.c;if(!L||!B){if(!N||!$)return new p(A/0);if(!N[0]||!$[0])return $[0]?y:new p(N[0]?I:A*0)}if(L=w(L),B=w(B),N=N.slice(),A=L-B){for(A>0?(B=L,E=$):(A=-A,E=N),E.reverse();A--;E.push(0));E.reverse()}for(A=N.length,R=$.length,A-R<0&&(E=$,$=N,N=E,R=A),A=0;R;)A=(N[--R]=N[R]+$[R]+A)/l|0,N[R]=l===N[R]?0:N[R]%l;return A&&(N=[A].concat(N),++B),F(y,N,B)},O.precision=O.sd=function(y,R){var E,I,A,L=this;if(y!=null&&y!==!!y)return v(y,1,f),R==null?R=ae:v(R,0,8),j(new p(L),y,R);if(!(E=L.c))return null;if(A=E.length-1,I=A*u+1,A=E[A]){for(;A%10==0;A/=10,I--);for(A=E[0];A>=10;A/=10,I++);}return y&&L.e+1>I&&(I=L.e+1),I},O.shiftedBy=function(y){return v(y,-c,c),this.times("1e"+y)},O.squareRoot=O.sqrt=function(){var y,R,E,I,A,L=this,B=L.c,N=L.s,$=L.e,W=J+4,U=new p("0.5");if(N!==1||!B||!B[0])return new p(!N||N<0&&(!B||B[0])?NaN:B?L:1/0);if(N=Math.sqrt(+K(L)),N==0||N==1/0?(R=C(B),(R.length+$)%2==0&&(R+="0"),N=Math.sqrt(+R),$=w(($+1)/2)-($<0||$%2),N==1/0?R="5e"+$:(R=N.toExponential(),R=R.slice(0,R.indexOf("e")+1)+$),E=new p(R)):E=new p(N+""),E.c[0]){for($=E.e,N=$+W,N<3&&(N=0);;)if(A=E,E=U.times(A.plus(M(L,A,W,1))),C(A.c).slice(0,N)===(R=C(E.c)).slice(0,N))if(E.e<$&&--N,R=R.slice(N-3,N+1),R=="9999"||!I&&R=="4999"){if(!I&&(j(A,A.e+J+2,0),A.times(A).eq(L))){E=A;break}W+=4,N+=4,I=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(j(E,E.e+J+2,1),y=!E.times(E).eq(L));break}}return j(E,E.e+J+1,ae,y)},O.toExponential=function(y,R){return y!=null&&(v(y,0,f),y++),b(this,y,R,1)},O.toFixed=function(y,R){return y!=null&&(v(y,0,f),y=y+this.e+1),b(this,y,R)},O.toFormat=function(y,R,E){var I,A=this;if(E==null)y!=null&&R&&typeof R=="object"?(E=R,R=null):y&&typeof y=="object"?(E=y,y=R=null):E=ut;else if(typeof E!="object")throw Error(s+"Argument not an object: "+E);if(I=A.toFixed(y,R),A.c){var L,B=I.split("."),N=+E.groupSize,$=+E.secondaryGroupSize,W=E.groupSeparator||"",U=B[0],q=B[1],se=A.s<0,le=se?U.slice(1):U,Re=le.length;if($&&(L=N,N=$,$=L,Re-=L),N>0&&Re>0){for(L=Re%N||N,U=le.substr(0,L);L<Re;L+=N)U+=W+le.substr(L,N);$>0&&(U+=W+le.slice(L)),se&&(U="-"+U)}I=q?U+(E.decimalSeparator||"")+(($=+E.fractionGroupSize)?q.replace(new RegExp("\\d{"+$+"}\\B","g"),"$&"+(E.fractionGroupSeparator||"")):q):U}return(E.prefix||"")+I+(E.suffix||"")},O.toFraction=function(y){var R,E,I,A,L,B,N,$,W,U,q,se,le=this,Re=le.c;if(y!=null&&(N=new p(y),!N.isInteger()&&(N.c||N.s!==1)||N.lt(G)))throw Error(s+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+K(N));if(!Re)return new p(le);for(R=new p(G),W=E=new p(G),I=$=new p(G),se=C(Re),L=R.e=se.length-le.e-1,R.c[0]=h[(B=L%u)<0?u+B:B],y=!y||N.comparedTo(R)>0?L>0?R:W:N,B=ke,ke=1/0,N=new p(se),$.c[0]=0;U=M(N,R,0,1),A=E.plus(U.times(I)),A.comparedTo(y)!=1;)E=I,I=A,W=$.plus(U.times(A=W)),$=A,R=N.minus(U.times(A=R)),N=A;return A=M(y.minus(E),I,0,1),$=$.plus(A.times(W)),E=E.plus(A.times(I)),$.s=W.s=le.s,L=L*2,q=M(W,I,L,ae).minus(le).abs().comparedTo(M($,E,L,ae).minus(le).abs())<1?[W,I]:[$,E],ke=B,q},O.toNumber=function(){return+K(this)},O.toPrecision=function(y,R){return y!=null&&v(y,1,f),b(this,y,R,2)},O.toString=function(y){var R,E=this,I=E.s,A=E.e;return A===null?I?(R="Infinity",I<0&&(R="-"+R)):R="NaN":(y==null?R=A<=te||A>=ne?P(C(E.c),A):x(C(E.c),A,"0"):y===10&&m?(E=j(new p(E),J+A+1,ae),R=x(C(E.c),E.e,"0")):(v(y,2,pn.length,"Base"),R=V(x(C(E.c),A,"0"),10,y,I,!0)),I<0&&E.c[0]&&(R="-"+R)),R},O.valueOf=O.toJSON=function(){return K(this)},O._isBigNumber=!0,_!=null&&p.set(_),p}function w(_){var M=_|0;return _>0||_===M?M:M-1}function C(_){for(var M,V,Y=1,O=_.length,G=_[0]+"";Y<O;){for(M=_[Y++]+"",V=u-M.length;V--;M="0"+M);G+=M}for(O=G.length;G.charCodeAt(--O)===48;);return G.slice(0,O+1||1)}function S(_,M){var V,Y,O=_.c,G=M.c,J=_.s,ae=M.s,te=_.e,ne=M.e;if(!J||!ae)return null;if(V=O&&!O[0],Y=G&&!G[0],V||Y)return V?Y?0:-ae:J;if(J!=ae)return J;if(V=J<0,Y=te==ne,!O||!G)return Y?0:!O^V?1:-1;if(!Y)return te>ne^V?1:-1;for(ae=(te=O.length)<(ne=G.length)?te:ne,J=0;J<ae;J++)if(O[J]!=G[J])return O[J]>G[J]^V?1:-1;return te==ne?0:te>ne^V?1:-1}function v(_,M,V,Y){if(_<M||_>V||_!==o(_))throw Error(s+(Y||"Argument")+(typeof _=="number"?_<M||_>V?" out of range: ":" not an integer: ":" not a primitive number: ")+String(_))}function T(_){var M=_.c.length-1;return w(_.e/u)==M&&_.c[M]%2!=0}function P(_,M){return(_.length>1?_.charAt(0)+"."+_.slice(1):_)+(M<0?"e":"e+")+M}function x(_,M,V){var Y,O;if(M<0){for(O=V+".";++M;O+=V);_=O+_}else if(Y=_.length,++M>Y){for(O=V,M-=Y;--M;O+=V);_+=O}else M<Y&&(_=_.slice(0,M)+"."+_.slice(M));return _}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(I5)})(c$);var h$=c$.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Mi=e_(),X5=JT(),Z5=QT,J5=h$,Sn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},tf={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:d$,decimalSuffixes:Um}=Mi.currentBytes(),t_={general:{scale:1024,suffixes:Um},binary:{scale:1024,suffixes:d$},decimal:{scale:1e3,suffixes:Um}};function Q5(t,e={},n){if(typeof e=="string"&&(e=Z5.parseFormat(e)),!X5.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=e7(t,e,n);return s=C7(s,i),s=y7(s,o),s}function e7(t,e,n){switch(e.output){case"currency":return e=Du(e,Mi.currentCurrencyDefaultFormat()),l7(t,e,Mi);case"percent":return e=Du(e,Mi.currentPercentageDefaultFormat()),a7(t,e,Mi,n);case"byte":return e=Du(e,Mi.currentByteDefaultFormat()),i7(t,e,Mi,n);case"time":return e=Du(e,Mi.currentTimeDefaultFormat()),s7(t);case"ordinal":return e=Du(e,Mi.currentOrdinalDefaultFormat()),o7(t,e,Mi);case"number":default:return nf({instance:t,providedFormat:e})}}function t7(t){let e=t_.decimal;return sw(t._value,e.suffixes,e.scale).suffix}function n7(t){let e=t_.binary;return sw(t._value,e.suffixes,e.scale).suffix}function r7(t){let e=t_.general;return sw(t._value,e.suffixes,e.scale).suffix}function sw(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function i7(t,e,n,r){let i=e.base||"binary",o=Object.assign({},tf,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Um,marker:"bd"},binary:{scale:1024,suffixes:s||d$,marker:"b"},decimal:{scale:1e3,suffixes:a||Um,marker:"d"}}[i],{value:c,suffix:h}=sw(t._value,u.suffixes,u.scale);return`${nf({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function o7(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},tf,e),o=nf({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function s7(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function a7(t,e,n,r){let i=e.prefixSymbol,o=nf({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},tf,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function l7(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},tf,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=nf({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function u7({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&Sn[e]?(a=r[e],t=t/Sn[e]):l>=Sn.trillion||n&&s(l/Sn.trillion)===1?(a=r.trillion,t=t/Sn.trillion):l<Sn.trillion&&l>=Sn.billion||n&&s(l/Sn.billion)===1?(a=r.billion,t=t/Sn.billion):l<Sn.billion&&l>=Sn.million||n&&s(l/Sn.million)===1?(a=r.million,t=t/Sn.million):(l<Sn.million&&l>=Sn.thousand||n&&s(l/Sn.thousand)===1)&&(a=r.thousand,t=t/Sn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function c7({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function Jf(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function h7(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+Jf(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Jf(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Jf(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${Jf(e)}`),n}function d7(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?h7(t,e):new J5(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function f7(t,e,n,r,i,o){if(r===-1)return t;let s=d7(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function g7(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function m7(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function p7(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),m7(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function w7(t,e){return t+e}function v7(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function C7(t,e){return e+t}function y7(t,e){return t+e}function nf({instance:t,providedFormat:e,state:n=Mi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},tf,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,w=s.trimMantissa,C=s.thousandSeparated,S=s.spaceSeparated,v=s.negative,T=s.forceSign,P=s.exponential,x=s.roundingFunction,_="";if(d){let V=u7({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:S,roundingFunction:x,totalLength:a});o=V.value,_+=V.abbreviation,a&&(f=V.mantissaPrecision)}if(P){let V=c7({value:o,characteristicPrecision:l});o=V.value,_=V.abbreviation+_}let M=f7(o.toString(),o,g,f,w,x);return M=g7(M,o,u,l),M=p7(M,o,C,n,r),(d||P)&&(M=w7(M,_)),(T||o<0)&&(M=v7(M,o,v)),M}function Du(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var b7=t=>({format:(...e)=>Q5(...e,t),getByteUnit:(...e)=>r7(...e,t),getBinaryByteUnit:(...e)=>n7(...e,t),getDecimalByteUnit:(...e)=>t7(...e,t),formatOrDefault:Du});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ps=h$;function S7(t,e,n){let r=new ps(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ps(i),t._value=r.plus(i).toNumber(),t}function f$(t,e,n){let r=new ps(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ps(i),t._value=r.minus(i).toNumber(),t}function R7(t,e,n){let r=new ps(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ps(i),t._value=r.times(i).toNumber(),t}function E7(t,e,n){let r=new ps(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ps(i),t._value=r.dividedBy(i).toNumber(),t}function T7(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function _7(t,e,n){let r=n(t._value);return f$(r,e,n),Math.abs(r._value)}var M7=t=>({add:(e,n)=>S7(e,n,t),subtract:(e,n)=>f$(e,n,t),multiply:(e,n)=>R7(e,n,t),divide:(e,n)=>E7(e,n,t),set:(e,n)=>T7(e,n,t),difference:(e,n)=>_7(e,n,t),BigNumber:ps});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const I7="2.5.0",xo=e_(),P7=JT(),O7=K5(Ut),x7=u$();let Aa=b7(Ut),il=M7(Ut);const A7=QT;class g${constructor(e){this._value=e}clone(){return Ut(this._value)}format(e={}){return Aa.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=A7.parseFormat(e)),e=Aa.formatOrDefault(e,xo.currentCurrencyDefaultFormat()),e.output="currency",Aa.format(this,e)}formatTime(e={}){return e.output="time",Aa.format(this,e)}binaryByteUnits(){return Aa.getBinaryByteUnit(this)}decimalByteUnits(){return Aa.getDecimalByteUnit(this)}byteUnits(){return Aa.getByteUnit(this)}difference(e){return il.difference(this,e)}add(e){return il.add(this,e)}subtract(e){return il.subtract(this,e)}multiply(e){return il.multiply(this,e)}divide(e){return il.divide(this,e)}set(e){return il.set(this,m$(e))}value(){return this._value}valueOf(){return this._value}}function m$(t){let e=t;return Ut.isNumbro(t)?e=t._value:typeof t=="string"?e=Ut.unformat(t):isNaN(t)&&(e=NaN),e}function Ut(t){return new g$(m$(t))}Ut.version=I7;Ut.isNumbro=function(t){return t instanceof g$};Ut.language=xo.currentLanguage;Ut.registerLanguage=xo.registerLanguage;Ut.setLanguage=xo.setLanguage;Ut.languages=xo.languages;Ut.languageData=xo.languageData;Ut.zeroFormat=xo.setZeroFormat;Ut.defaultFormat=xo.currentDefaults;Ut.setDefaults=xo.setDefaults;Ut.defaultCurrencyFormat=xo.currentCurrencyDefaultFormat;Ut.validate=P7.validate;Ut.loadLanguagesInNode=O7.loadLanguagesInNode;Ut.unformat=x7.unformat;Ut.BigNumber=il.BigNumber;var H7=Ut,Ha=P5(H7);const N7="numeric";function p$(t,e){if(qn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!Ha.languages()[r]){const o=r.replace("-",""),s=Ha.allLanguages?Ha.allLanguages[r]:Ha[o];s&&Ha.registerLanguage(s)}Ha.setLanguage(r),t=Ha(t).format(i||"0")}return t}function n_(t,e,n,r,i,o,s){let a=o;if(qn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=p$(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}Es(t,e,n,r,i,a,s)}n_.RENDERER_TYPE=N7;const D7="password";function r_(t,e,n,r,i,o,s){Es.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";de(a-1,()=>{u+=l}),bc(e,u)}r_.RENDERER_TYPE=D7;const k7="select";function i_(t,e,n,r,i,o,s){Es.apply(this,[t,e,n,r,i,o,s])}i_.RENDERER_TYPE=k7;const L7="time";function o_(t,e,n,r,i,o,s){Es.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}o_.RENDERER_TYPE=L7;function $7(){Kr(Tc),Kr(ef),Kr(KT),Kr(qT),Kr(ZT),Kr(GT),Kr(n_),Kr(r_),Kr(i_),Kr(Es),Kr(o_)}const F7="autocomplete";function aw(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,v1(n,e)):v1(n,e)(this.source):e(!0)}aw.VALIDATOR_TYPE=F7;function v1(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function V7(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const W7="date";function s_(t,e){const n=Uk(t$,this.instance);let r=t,i=!0;r==null&&(r="");let o=Z(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Z(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=B7(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}s_.VALIDATOR_TYPE=W7;function B7(t,e){const n=Z(V7(t)),r=Z(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const j7="dropdown";function a_(t,e){aw.apply(this,[t,e])}a_.VALIDATOR_TYPE=j7;const U7="numeric";function l_(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:qn(t))}l_.VALIDATOR_TYPE=U7;const z7=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Y7="time";function u_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Z(i,z7,!0).isValid()?Z(i):Z(i,n);let a=s.isValid(),l=Z(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}u_.VALIDATOR_TYPE=Y7;function G7(){Hu(aw),Hu(a_),Hu(s_),Hu(l_),Hu(u_)}const q7="autocomplete",K7={CELL_TYPE:q7,editor:zT,renderer:Tc,validator:aw},X7="checkbox",Z7={CELL_TYPE:X7,editor:e$,renderer:KT},J7="date";function w$(t,e,n,r,i,o,s){Tc.apply(this,[t,e,n,r,i,o,s])}w$.RENDERER_TYPE=J7;const Q7="date",eZ={CELL_TYPE:Q7,editor:n$,renderer:w$,validator:s_},tZ="dropdown",nZ={CELL_TYPE:tZ,editor:r$,renderer:qT,validator:a_,filter:!1,strict:!0},rZ="handsontable",iZ={CELL_TYPE:rZ,editor:UT,renderer:ZT},oZ="numeric",sZ={CELL_TYPE:oZ,editor:i$,renderer:n_,validator:l_,dataType:"number"},aZ="password",lZ={CELL_TYPE:aZ,editor:o$,renderer:r_,copyable:!1},uZ="select",cZ={CELL_TYPE:uZ,editor:s$,renderer:i_},hZ="time",dZ={CELL_TYPE:hZ,editor:a$,renderer:o_,validator:u_};function fZ(){Ei(K7),Ei(Z7),Ei(eZ),Ei(nZ),Ei(iZ),Ei(sZ),Ei(lZ),Ei(cZ),Ei(XL),Ei(dZ)}function gZ(t,e){v$(t,e),e.add(t)}function mZ(t,e,n){v$(t,e),e.set(t,n)}function v$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ru(t,e,n){return(e=pZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pZ(t){var e=wZ(t,"string");return typeof e=="symbol"?e:e+""}function wZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iu(t,e){return t.get(C$(t,e))}function C$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const C1=new Map([["plugin",Gq],["cell-type",LL],["editor",jk],["renderer",Zk],["validator",Jk]]),y$=Symbol("mainSetting"),vZ="base",Qf=[];let Na=null;var Da=new WeakMap,y1=new WeakSet;class Je{static get PLUGIN_KEY(){return vZ}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){gZ(this,y1),ru(this,"eventManager",new Vi(this)),ru(this,"pluginName",null),ru(this,"pluginsInitializedCallbacks",[]),ru(this,"isPluginsReady",!1),ru(this,"enabled",!1),ru(this,"initialized",!1),mZ(this,Da,{}),Ss(this,"hot",e,{writable:!1}),Na=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!C1.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);C1.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Qf.push(o)}}if(Na||(Na=Xk()),Na.indexOf(this.pluginName)>=0&&Na.splice(Na.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Na.length===0){if(Qf.length>0){const i=[`${Qf.join(`
`)}
`,"You have to import and register them manually."].join("");throw Qf.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||Ne(n))&&r[y$]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(Ne(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){iu(Da,this)[e]=iu(Da,this)[e]||[];const i=iu(Da,this)[e];this.hot.addHook(e,n,r),i.push(n),iu(Da,this)[e]=i}removeHooks(e){H(iu(Da,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=iu(Da,this);De(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){H(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=C$(y1,this,CZ).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),De(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function CZ(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ka(t,e,n){return(e=yZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yZ(t){var e=bZ(t,"string");return typeof e=="symbol"?e:e+""}function bZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let b$=class{constructor(e){ka(this,"hot",null),ka(this,"container",null),ka(this,"injected",!1),ka(this,"rows",[]),ka(this,"columns",[]),ka(this,"samples",null),ka(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&X(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),H(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),H(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{H(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{H(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{H(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),H(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{H(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),X(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return X(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function eg(t,e,n){return(e=SZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SZ(t){var e=RZ(t,"string");return typeof e=="symbol"?e:e+""}function RZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lw{static get SAMPLE_COUNT(){return 3}constructor(e){eg(this,"samples",null),eg(this,"dataFactory",null),eg(this,"customSampleCount",null),eg(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:lw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return de(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return de(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Ne(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Ot(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function EZ(t,e){S$(t,e),e.add(t)}function wb(t,e,n){S$(t,e),e.set(t,n)}function S$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ih(t,e,n){return(e=TZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TZ(t){var e=_Z(t,"string");return typeof e=="symbol"?e:e+""}function _Z(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ta(t,e){return t.get(fr(t,e))}function zm(t,e,n){return t.set(fr(t,e),n),n}function fr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutoColumnSizeSeed");const vb="autoColumnSize",MZ=10,IZ="autoColumnSize";var c_=new WeakMap,ku=new WeakMap,hc=new WeakMap,xr=new WeakSet;class Jh extends Je{static get PLUGIN_KEY(){return vb}static get PLUGIN_PRIORITY(){return MZ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),EZ(this,xr),ih(this,"ghostTable",new b$(this.hot)),ih(this,"samplesGenerator",new lw((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),ih(this,"inProgress",!1),ih(this,"measuredColumns",0),ih(this,"columnWidthsMap",new wa),wb(this,c_,!1),wb(this,ku,[]),wb(this,hc,[]),this.hot.columnIndexMapper.registerMap(IZ,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>fr(xr,this,b1).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[vb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fr(xr,e,xZ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fr(xr,e,AZ).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fr(xr,e,NZ).call(e,...i)}),this.addHook("beforeRender",()=>fr(xr,this,OZ).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>fr(xr,this,HZ).call(this)),super.enablePlugin()}updatePlugin(){zm(hc,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>fr(xr,this,b1).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;de(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&fr(xr,this,R$).call(this,s,o)}),this.ghostTable.columns.length&&(fr(xr,this,E$).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Hm(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Jh.CALCULATION_STEP,i)},e,n),r=r+Jh.CALCULATION_STEP+1,r<i?o=Am(s):(Hm(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[vb];let n=Jh.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Ne(e)&&(n=e.syncLimit,dk(n)?n=Gk(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,sc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=ta(ku,this).length;return(s-1<o||ta(ku,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?ta(ku,this).push(i):ta(ku,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function PZ(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||fr(xr,this,R$).call(this,n,e))}),this.ghostTable.columns.length&&(fr(xr,this,E$).call(this),this.ghostTable.clean())}function R$(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function E$(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function OZ(){this.calculateVisibleColumnsWidth(),this.inProgress||(fr(xr,this,PZ).call(this,ta(hc,this)),zm(hc,this,[]))}function xZ(t,e){e||this.recalculateAllColumnsWidth()}function AZ(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);ta(hc,this).push(...e)}function b1(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function HZ(){zm(ku,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),zm(c_,this,!0)}function NZ(t){if(!ta(c_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);ta(hc,this).push(...e)}const dl={horizontal:"horizontal",vertical:"vertical"};function DZ(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function kZ(t){const e={};return t===!0?(e.directions=Object.keys(dl),e.autoInsertRow=!0):Ne(t)?(ue(t.autoInsertRow)?t.direction===dl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ue(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(dl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function LZ(t,e){$Z(t,e),e.add(t)}function $Z(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ou(t,e,n){return(e=FZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FZ(t){var e=VZ(t,"string");return typeof e=="symbol"?e:e+""}function VZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutofillRange");ie.getSingleton().register("beforeAutofill");ie.getSingleton().register("afterAutofill");const S1="autofill",WZ=20,BZ=["fillHandle"],jZ="insert_row_below",UZ=200;var su=new WeakSet;class zZ extends Je{constructor(){super(...arguments),LZ(this,su),ou(this,"addingStarted",!1),ou(this,"mouseDownOnCellCorner",!1),ou(this,"mouseDragOutside",!1),ou(this,"handleDraggedCells",0),ou(this,"directions",[]),ou(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return S1}static get PLUGIN_PRIORITY(){return WZ}static get SETTING_KEYS(){return[S1,...BZ]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>oh(su,this,GZ).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>oh(su,this,YZ).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>oh(su,this,qZ).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return H(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),H(a,c=>{const h=[];H(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=DZ(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),w=this.hot._createCellRange(h,h,d),C=this.hot.runHooks("beforeAutofill",f,g,w,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let S=C;const v=C;if(["up","left"].indexOf(c)>-1&&!(v.length===1&&v[0].length===0))if(S=[],c==="up"){const T=d.row-h.row+1,P=T%v.length;for(let x=0;x<T;x++)S.push(v[(x+(v.length-P))%v.length])}else{const T=d.col-h.col+1,P=T%v[0].length;for(let x=0;x<v.length;x++){S.push([]);for(let _=0;_<T;_++)S[x].push(v[x][(_+(v[x].length-P))%v[x].length])}}this.hot.populateFromArray(h.row,h.col,S,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",S,g,w,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(dl.vertical)&&this.directions.includes(dl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(dl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(dl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(jZ,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},UZ)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!jt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!jt(s)||!jt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...je(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Dn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+rn(this.hot.table),i=Dn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+qt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>oh(su,this,KZ).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>oh(su,this,XZ).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=kZ(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function YZ(){this.selectAdjacent()&&this.fillIn()}function GZ(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function qZ(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function KZ(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function XZ(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function ZZ(t,e){T$(t,e),e.add(t)}function R1(t,e,n){T$(t,e),e.set(t,n)}function T$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function au(t,e,n){return(e=JZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JZ(t){var e=QZ(t,"string");return typeof e=="symbol"?e:e+""}function QZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _$(t,e,n){return t.set(po(t,e),n),n}function Ym(t,e){return t.get(po(t,e))}function po(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Cb="autoRowSize",eJ=40,tJ="autoRowSize";var Td=new WeakMap,h_=new WeakMap,Ko=new WeakSet;class Qh extends Je{static get PLUGIN_KEY(){return Cb}static get PLUGIN_PRIORITY(){return eJ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),ZZ(this,Ko),au(this,"headerHeight",null),au(this,"ghostTable",new b$(this.hot)),au(this,"samplesGenerator",new lw((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),au(this,"inProgress",!1),au(this,"measuredRows",0),au(this,"rowHeightsMap",new wa),R1(this,Td,[]),R1(this,h_,!1),this.hot.rowIndexMapper.registerMap(tJ,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>po(Ko,this,E1).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[Cb];return e===!0||Ne(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return po(Ko,e,iJ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return po(Ko,e,oJ).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return po(Ko,e,aJ).call(e,...i)}),this.addHook("beforeRender",()=>po(Ko,this,rJ).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>po(Ko,this,sJ).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>po(Ko,this,E1).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}de(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Hm(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Qh.CALCULATION_STEP,i)},e,n),r=r+Qh.CALCULATION_STEP+1,r<i?o=Am(s):(Hm(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Cb];let n=Qh.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Ne(e)&&(n=e.syncLimit,dk(n)?n=Gk(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{de(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function nJ(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function rJ(){this.calculateVisibleRowsHeight(),this.inProgress||(po(Ko,this,nJ).call(this,Ym(Td,this)),_$(Td,this,[]))}function E1(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function iJ(t,e){e||this.recalculateAllRowsHeight()}function oJ(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);Ym(Td,this).push(...e)}function sJ(){this.recalculateAllRowsHeight(),_$(h_,this,!0)}function aJ(t){if(!Ym(h_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Ym(Td,this).push(...e)}const{getListWithInsertedItems:lJ,getListWithRemovedItems:uJ}=CL("physicallyIndexed");class cJ extends Wl{constructor(){super(e=>e)}insert(e,n){const r=p0(this.indexedValues,n);this.indexedValues=lJ(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=uJ(this.indexedValues,e);this.indexedValues=m0(n,e),super.remove(e)}}const{getListWithInsertedItems:hJ,getListWithRemovedItems:dJ}=CL("physicallyIndexed");class fJ extends Wl{constructor(){super(e=>e)}insert(e,n){this.indexedValues=hJ(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=dJ(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function gJ(t,e){mJ(t,e),e.add(t)}function mJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pJ(t,e,n){return(e=wJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wJ(t){var e=vJ(t,"string");return typeof e=="symbol"?e:e+""}function vJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CJ(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const T1="bindRowsWithHeaders",yJ=210,bJ="loose",_1=new Map([["loose",cJ],["strict",fJ]]);var M1=new WeakSet;class SJ extends Je{constructor(){super(...arguments),gJ(this,M1),pJ(this,"headerIndexes",null)}static get PLUGIN_KEY(){return T1}static get PLUGIN_PRIORITY(){return yJ}isEnabled(){return!!this.hot.getSettings()[T1]}enablePlugin(){var e;if(this.enabled)return;const n=(e=_1.get(this.getSetting()))!==null&&e!==void 0?e:_1.get(bJ);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>CJ(M1,this,RJ).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function RJ(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function EJ(t,e){M$(t,e),e.add(t)}function TJ(t,e,n){M$(t,e),e.set(t,n)}function M$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function I1(t,e,n){return(e=_J(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _J(t){var e=MJ(t,"string");return typeof e=="symbol"?e:e+""}function MJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function P1(t,e){return t.get(ju(t,e))}function yb(t,e,n){return t.set(ju(t,e),n),n}function ju(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const am="collapsibleColumns",IJ=290,PJ=["nestedHeaders"],Qu="collapsibleIndicator",O1=am,x1=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var lu=new WeakMap,sh=new WeakSet;class OJ extends Je{constructor(){super(...arguments),EJ(this,sh),I1(this,"nestedHeadersPlugin",null),I1(this,"headerStateManager",null),TJ(this,lu,null)}static get PLUGIN_KEY(){return am}static get PLUGIN_PRIORITY(){return IJ}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[am,...PJ]}isEnabled(){return!!this.hot.getSettings()[am]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Ze("You need to configure the Nested Headers plugin in order to use collapsible headers."),yb(lu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>ju(sh,this,HJ).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ju(sh,e,NJ).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ju(sh,e,xJ).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>ju(sh,this,AJ).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),yb(lu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:O1,relativeToGroup:va,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(O1)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};de(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;de(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Qu}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Qu}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Qu}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!x1.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Rl(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;H(r,f=>{var g;let{row:w,col:C}=f;const{collapsible:S,isCollapsed:v}=(g=this.headerStateManager.getHeaderSettings(w,C))!==null&&g!==void 0?g:{};if(!S||v&&n==="collapse"||!v&&n==="expand")return i=!1,!1});const o=[],s=[];i&&H(r,f=>{let{row:g,col:w}=f;const{colspanCompensation:C,affectedColumns:S,rollbackModification:v}=this.headerStateManager.triggerNodeModification(n,g,w);C>0&&(s.push(...S),o.push(v))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=YG([...a,...s]):n==="expand"&&(l=Rl(a,f=>!s.includes(f)));const u=x1.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){H(o,f=>{f()});return}this.hot.batchExecution(()=>{H(s,f=>{P1(lu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const C=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,S=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;C!==null&&S!==null&&this.hot.selectCell(C,S)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return P1(lu,this).getHiddenIndexes()}destroy(){yb(lu,this,null),super.destroy()}}function xJ(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Qu}`);if(yc(e,[si("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),X(u,Qu),e.querySelector("div:first-child").appendChild(u)),we(u,["collapsed","expanded"]),s?(X(u,"collapsed"),Tl(u,"+"),l&&Ce(e,...si(!1))):(X(u,"expanded"),Tl(u,"-"),l&&Ce(e,...si(!0))),l&&Ce(u,...Vl());else{var c;(c=u)===null||c===void 0||c.remove()}}function AJ(t,e){ye(t.target,Qu)&&(ye(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ye(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),ji(t))}function HJ(){this.updatePlugin()}function NJ(t,e){e||this.updatePlugin()}function La(t,e,n){return(e=DJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DJ(t){var e=kJ(t,"string");return typeof e=="symbol"?e:e+""}function kJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const LJ=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],$J=!1,FJ=!0,VJ=!0;class WJ{constructor(e,n){La(this,"hot",void 0),La(this,"sortingStates",new Qp),La(this,"sortEmptyCells",$J),La(this,"indicator",FJ),La(this,"headerAction",VJ),La(this,"compareFunctionFactory",void 0),La(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Ne(e)&&De(e,(n,r)=>{LJ.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Ne(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ue(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function I$(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Eo:jt(i)?jt(o)?Eo:s&&t==="asc"?kt:Lt:jt(o)?s&&t==="asc"?Lt:kt:isNaN(i)&&!isNaN(o)?t==="asc"?Lt:kt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?kt:Lt:i>o?t==="asc"?Lt:kt:Eo}}const P$="default";function BJ(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Eo;if(a){if(jt(r))return t==="asc"?kt:Lt;if(jt(i))return t==="asc"?Lt:kt}return isNaN(o)?Lt:isNaN(s)?kt:o<s?t==="asc"?kt:Lt:o>s?t==="asc"?Lt:kt:Eo}}const jJ="numeric";function UJ(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=jt(s),u=jt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Lt;if(l===!1&&u)return kt}return d===!1&&f?t==="asc"?kt:Lt:d&&f===!1?t==="asc"?Lt:kt:d===!1&&f===!1?I$(t,e,n)(s,a):c===i&&h===r?t==="asc"?kt:Lt:c===r&&h===i?t==="asc"?Lt:kt:Eo}}const zJ="checkbox";function YJ(t,e,n){return D$(t,e.dateFormat,n)}const GJ="date";function qJ(t,e,n){return D$(t,e.timeFormat,n)}const KJ="time",{register:rf,getItem:A1,hasItem:XJ}=fi("sorting.compareFunctionFactory"),{register:O$,getItem:ZJ}=fi("sorting.mainSortComparator");function x$(t){return XJ(t)?A1(t):A1(P$)}rf(zJ,UJ);rf(GJ,YJ);rf(P$,I$);rf(jJ,BJ);rf(KJ,qJ);const Eo=0,kt=-1,Lt=1;function JJ(t,e){const n=ZJ(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Gm="asc",qm="desc",A$="colHeader";function QJ(t){if(Ne(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Gm,qm].includes(n)}function eQ(t){if(t.some(n=>QJ(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function H1(t){if(t!==qm)return t===Gm?qm:Gm}function H$(t){return t.querySelector(`.${A$}`)}function N$(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function d_(t,e,n){return t===-1&&e>=0&&_l(n)===!1}function D$(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Eo;if(jt(r))return jt(i)?Eo:o&&t==="asc"?kt:Lt;if(jt(i))return o&&t==="asc"?Lt:kt;const s=Z(r,e),a=Z(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?kt:Lt:a.isBefore(s)?t==="asc"?Lt:kt:Eo:kt:Lt}}function tQ(t,e){Ze(it`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const nQ="ascending",rQ="descending",k$="indicatorDisabled",L$="columnSorting",$$="sortAction",F$=new Map([[Gm,nQ],[qm,rQ]]);function iQ(t,e,n,r){const i=[L$];if(r&&i.push($$),n===!1)return i.push(k$),i;const o=t.getSortOrderOfColumn(e);return ue(o)&&i.push(F$.get(o)),i}function oQ(){return Array.from(F$.values()).concat($$,k$,L$)}function sQ(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:x$(u.type))(l,u,d)(c,h)}(0)}}function aQ(t,e){lQ(t,e),e.add(t)}function lQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tg(t,e,n){return(e=uQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uQ(t){var e=cQ(t,"string");return typeof e=="symbol"?e:e+""}function cQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Km="columnSorting",hQ=50,Xm="append",dQ="replace",N1=Km;O$(Km,sQ);ie.getSingleton().register("beforeColumnSort");ie.getSingleton().register("afterColumnSort");const ah=new WeakMap;var ol=new WeakSet;class V$ extends Je{constructor(){super(...arguments),aQ(this,ol),tg(this,"columnStatesManager",null),tg(this,"columnMetaCache",null),tg(this,"pluginKey",Km),tg(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Km}static get PLUGIN_PRIORITY(){return hQ}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(ah.has(this.hot)&&ah.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),tQ(ah.get(this.hot),this.pluginKey);return}this.enabled||(ah.set(this.hot,this.pluginKey),this.columnStatesManager=new WJ(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new wa(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Lu(ol,this,fQ).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Lu(ol,e,mQ).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Lu(ol,this,CR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Lu(ol,e,gQ).call(e,...r)}),this.hot.view&&Lu(ol,this,CR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=H$(r);N$(n,r)===!1||i===null||this.updateHeaderClasses(i)};ah.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:va,position:"before",group:N1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(N1)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new yL),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ue(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return eQ(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=je(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ue(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=je(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ue(n)){const i=H1(n);return ue(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:H1()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xm;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Pt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Xm)return[...o.slice(0,r),...o.slice(r+1),s];if(n===dQ)return[...o.slice(0,r),s,...o.slice(r+1)]}return ue(s)?o.concat(s):o}getPluginColumnConfig(e){if(Ne(e)){const n=e[this.pluginKey];if(Ne(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):at(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>je(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=je(n,u=>u[0]);JJ(n,this.pluginKey,je(e,u=>u.sortOrder),je(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=je(n,u=>u[0]),a=new Map(je(o,(u,c)=>[u,s[c]])),l=je(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ne(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Ne(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(we(e,oQ()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];X(e,iQ(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ue(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ye(e.target,A$)}onAfterOnCellMouseDown(e,n){if(d_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function CR(){const t=this.getAllSavedSortSettings();if(Ne(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function fQ(t,e){const n=H$(e);if(N$(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Ce(e,...g2(s?`${s}ending`:"none"))}}function gQ(t){t===!0&&this.hot.view&&Lu(ol,this,CR).call(this)}function mQ(t,e,n,r){d_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function $a(t,e,n){return(e=pQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pQ(t){var e=wQ(t,"string");return typeof e=="symbol"?e:e+""}function wQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vQ{constructor(e,n){$a(this,"plugin",void 0),$a(this,"hot",void 0),$a(this,"endpoints",[]),$a(this,"settings",void 0),$a(this,"settingsType","array"),$a(this,"currentEndpoint",null),$a(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),H(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();H(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;H(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?H(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):H(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){H(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];H(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),H(i,o=>{let s=[];H(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,H(e.ranges,r=>{H(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],H(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],H(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],H(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&H(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),H(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ze("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function bb(t){return t==null||isNaN(t)}function CQ(t,e){yQ(t,e),e.add(t)}function yQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bQ(t,e,n){return(e=SQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SQ(t){var e=RQ(t,"string");return typeof e=="symbol"?e:e+""}function RQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ng(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sb="columnSummary",EQ=220;var lh=new WeakSet;class TQ extends Je{constructor(){super(...arguments),CQ(this,lh),bQ(this,"endpoints",null)}static get PLUGIN_KEY(){return Sb}static get PLUGIN_PRIORITY(){return EQ}isEnabled(){return!!this.hot.getSettings()[Sb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Sb],this.endpoints=new vQ(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ng(lh,e,_Q).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ng(lh,e,IQ).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ng(lh,e,MQ).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ng(lh,e,PQ).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return De(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=bb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return De(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=bb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=bb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return De(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(it`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function _Q(){this.endpoints.initEndpoints()}function MQ(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function IQ(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function PQ(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function OQ(t,e){W$(t,e),e.add(t)}function Rb(t,e,n){W$(t,e),e.set(t,n)}function W$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $u(t,e){return t.get(f_(t,e))}function yR(t,e,n){return t.set(f_(t,e),n),n}function f_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zm=new WeakMap,rg=new WeakMap,ig=new WeakMap,D1=new WeakSet;class B${constructor(){OQ(this,D1),Rb(this,Zm,!0),Rb(this,rg,null),Rb(this,ig,new ResizeObserver(e=>f_(D1,this,xQ).call(this,e)))}setObservedElement(e){yR(rg,this,e)}unobserve(){$u(ig,this).unobserve($u(rg,this))}observe(){yR(Zm,this,!0),$u(ig,this).observe($u(rg,this))}destroy(){$u(ig,this).disconnect()}}function xQ(t){if($u(Zm,this)||!Array.isArray(t)||!t.length){yR(Zm,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}ft(B$,En);function Is(t,e,n){AQ(t,e),e.set(t,n)}function AQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ct(t,e){return t.get(j$(t,e))}function Ji(t,e,n){return t.set(j$(t,e),n),n}function j$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uu=new WeakMap,Eb=new WeakMap,Tb=new WeakMap,jo=new WeakMap,Ps=new WeakMap,Os=new WeakMap,og=new WeakMap,cu=new WeakMap;class fl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,r){var i=this;Is(this,uu,void 0),Is(this,Eb,void 0),Is(this,Tb,!1),Is(this,jo,null),Is(this,Ps,void 0),Is(this,Os,void 0),Is(this,og,!0),Is(this,cu,new B$),Ji(uu,this,e),Ji(Eb,this,r),Ji(Tb,this,n),Ji(Ps,this,this.createEditor()),Ji(Os,this,ct(Ps,this).style),ct(cu,this).setObservedElement(this.getInputElement()),ct(cu,this).addLocalHook("resize",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){ct(Os,this).left=`${e}px`,ct(Os,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:qt(this.getInputElement()),height:rn(this.getInputElement())}}observeSize(){ct(cu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){ct(Os,this).display="block",Ji(og,this,!1)}hide(){ct(cu,this).unobserve(),ct(og,this)||(ct(Os,this).display="none"),Ji(og,this,!0)}isVisible(){return ct(Os,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return ct(uu,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=ct(uu,this).createElement("div"),n=ct(uu,this).createElement("textarea");return e.style.display="none",Ji(jo,this,ct(uu,this).createElement("div")),ct(jo,this).setAttribute("dir",ct(Tb,this)?"rtl":"ltr"),X(ct(jo,this),fl.CLASS_EDITOR_CONTAINER),ct(Eb,this).appendChild(ct(jo,this)),X(e,fl.CLASS_EDITOR),X(n,fl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),ct(jo,this).appendChild(e),e}getInputElement(){return ct(Ps,this).querySelector(`.${fl.CLASS_INPUT}`)}getEditorElement(){return ct(Ps,this)}destroy(){const e=ct(jo,this)?ct(jo,this).parentNode:null;ct(Ps,this).parentNode.removeChild(ct(Ps,this)),Ji(Ps,this,null),Ji(Os,this,null),ct(cu,this).destroy(),e&&e.removeChild(ct(jo,this))}}ft(fl,En);function _b(t,e,n){return(e=HQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HQ(t){var e=NQ(t,"string");return typeof e=="symbol"?e:e+""}function NQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const DQ=250,kQ=250;class U${constructor(e){_b(this,"wasLastActionShow",!0),_b(this,"showDebounced",null),_b(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},kQ)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DQ;this.showDebounced=Gp(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}ft(U$,En);function LQ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function $Q(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Fa(t,e){const n={};return H(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function js(t,e,n,r,i){H(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&FQ(s,a,e,n,r,i)})})}function FQ(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=LQ(s.className,r):a=$Q(s.className,r)),o(t,e,"className",a)}function z$(t){return`<span class="selected">✓</span>${t}`}function lm(t,e){let n=!1;return Array.isArray(t)&&H(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function uw(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const He="---------";function VQ(){return{name:He}}const Qr="alignment";function WQ(){return{key:Qr,name(){return this.getTranslatedPhrase(W0)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Qr}:left`,name(){return this.getTranslatedPhrase(B0)},callback(){const t=this.getSelectedRange(),e=Fa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),js(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Qr}:center`,name(){return this.getTranslatedPhrase(j0)},callback(){const t=this.getSelectedRange(),e=Fa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),js(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Qr}:right`,name(){return this.getTranslatedPhrase(U0)},callback(){const t=this.getSelectedRange(),e=Fa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),js(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Qr}:justify`,name(){return this.getTranslatedPhrase(z0)},callback(){const t=this.getSelectedRange(),e=Fa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),js(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:He},{key:`${Qr}:top`,name(){return this.getTranslatedPhrase(Y0)},callback(){const t=this.getSelectedRange(),e=Fa(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),js(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Qr}:middle`,name(){return this.getTranslatedPhrase(G0)},callback(){const t=this.getSelectedRange(),e=Fa(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),js(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Qr}:bottom`,name(){return this.getTranslatedPhrase(q0)},callback(){const t=this.getSelectedRange(),e=Fa(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),js(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const cw="clear_column";function BQ(){return{key:cw,name(){return this.getTranslatedPhrase(M0)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const of="col_left";function jQ(){return{key:of,name(){return this.getTranslatedPhrase(b0)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const sf="col_right";function UQ(){return{key:sf,name(){return this.getTranslatedPhrase(S0)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const af="make_read_only";function zQ(){return{key:af,checkable:!0,ariaChecked(){return lm(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase($m)},name(){let t=this.getTranslatedPhrase($m);return lm(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=z$(t)),t},callback(){const t=this.getSelectedRange(),e=lm(t,(n,r)=>this.getCellMeta(n,r).readOnly);H(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const hw="redo";function YQ(){return{key:hw,name(){return this.getTranslatedPhrase(_0)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const lf="remove_col";function GQ(){return{key:lf,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(E0,e)},callback(){this.alter("remove_col",c6(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const dw="remove_row";function qQ(){return{key:dw,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(R0,e)},callback(){this.alter("remove_row",h6(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const fw="row_above";function KQ(){return{key:fw,name(){return this.getTranslatedPhrase(C0)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const gw="row_below";function XQ(){return{key:gw,name(){return this.getTranslatedPhrase(y0)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const _d="no_items";function ZQ(){return{key:_d,name(){return this.getTranslatedPhrase(v0)},disabled:!0,isCommand:!1}}const mw="undo";function JQ(){return{key:mw,name(){return this.getTranslatedPhrase(T0)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const QQ=[fw,gw,of,sf,cw,dw,lf,mw,hw,af,Qr,He,_d],eee={[He]:VQ,[_d]:ZQ,[fw]:KQ,[gw]:XQ,[of]:jQ,[sf]:UQ,[cw]:BQ,[dw]:qQ,[lf]:GQ,[mw]:JQ,[hw]:YQ,[af]:zQ,[Qr]:WQ};function Y$(){const t={};return De(eee,(e,n)=>{t[n]=e()}),t}function tee(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase($0):this.getTranslatedPhrase(L0)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function nee(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(F0)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ree(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(V0);return lm(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,um))?z$(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,um);t.updateCommentMeta(n,r,{[um]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function iee(t,e){G$(t,e),e.add(t)}function hu(t,e,n){G$(t,e),e.set(t,n)}function G$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oee(t,e,n){return(e=see(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function see(t){var e=aee(t,"string");return typeof e=="symbol"?e:e+""}function aee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function na(t,e,n){return t.set(Or(t,e),n),n}function Ae(t,e){return t.get(Or(t,e))}function Or(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jm="comments",lee=60,es="comment",Vh="value",q$="style",um="readOnly",uh=Jm,bR=`plugin:${Jm}`;var dt=new WeakMap,fo=new WeakMap,pw=new WeakMap,cm=new WeakMap,SR=new WeakMap,Qm=new WeakMap,qr=new WeakSet;class uee extends Je{constructor(){super(...arguments),iee(this,qr),oee(this,"range",{}),hu(this,dt,null),hu(this,fo,null),hu(this,pw,!1),hu(this,cm,!1),hu(this,SR,null),hu(this,Qm,"")}static get PLUGIN_KEY(){return Jm}static get PLUGIN_PRIORITY(){return lee}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Jm]}enablePlugin(){var e=this;this.enabled||(Ae(dt,this)||(na(dt,this,new fl(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),Ae(dt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Or(qr,e,wee).call(e,...r)}),this.hot.addHook("afterSetTheme",(n,r)=>{r||this.hide()})),Ae(fo,this)||na(fo,this,new U$(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Or(qr,this,gee).call(this,n,a)),this.addHook("afterScroll",()=>Or(qr,this,vee).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Or(qr,this,k1).call(this,n)),this.addHook("beforeCompositionStart",n=>Or(qr,this,k1).call(this,n)),Ae(fo,this).addLocalHook("hide",()=>this.hide()),Ae(fo,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Ae(fo,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(bR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();na(cm,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(bR),this.hot._registerTimeout(()=>{na(cm,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:uh}),r.addShortcut({keys:[["Escape"]],callback:()=>{Ae(dt,this).setValue(Ae(Qm,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ae(dt,this).isVisible()&&Ae(dt,this).isFocused(),group:uh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ae(dt,this).isVisible()&&Ae(dt,this).isFocused(),group:uh}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{Ae(dt,this).setValue(Ae(dt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:uh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Or(qr,this,dee).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Or(qr,this,cee).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Or(qr,this,fee).call(this)),this.eventManager.addEventListener(n,"focus",()=>Or(qr,this,pee).call(this)),this.eventManager.addEventListener(n,"blur",()=>Or(qr,this,mee).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Or(qr,this,hee).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=El(e.target,"TD","TBODY");return!!(n&&ye(n,"htCommentCell")&&El(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Ae(dt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Vh]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,es),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Vh)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Vh)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Ae(fo,this).cancelHiding(),Ae(dt,this).setValue((e=i[es]?i[es][Vh]:null)!==null&&e!==void 0?e:""),Ae(dt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Ae(dt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Ae(dt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;Ae(dt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),w=this.getCommentMeta(i,o,q$);w?Ae(dt,this).setSize(w.width,w.height):Ae(dt,this).resetSize();const C=c?0:f.getColumnWidth(a),S=l&&!u?rn(g):0,{left:v,top:T,width:P,height:x}=g.getBoundingClientRect(),{width:_,height:M}=Ae(dt,this).getSize(),{innerWidth:V,innerHeight:Y}=this.hot.rootWindow,O=this.hot.rootDocument.documentElement,G=bn(this.hot.rootDocument),J=Hk(this.hot.rootWindow)?G:0,ae=Nk(this.hot.rootWindow)?G:0;let te=v+h.scrollX+C,ne=T+h.scrollY+S;this.hot.isRtl()&&(te-=_+C),this.hot.isLtr()&&v+P+_>V-J?te=v+h.scrollX-_-1:this.hot.isRtl()&&te<-(O.scrollWidth-O.clientWidth)&&(te=v+h.scrollX+C+1),T+M>Y-ae&&(ne-=M-x+1),Ae(dt,this).setPosition(te,ne),Ae(dt,this).setReadOnlyState(this.getCommentMeta(i,o,um)),Ae(dt,this).observeSize()}focusEditor(){Ae(dt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[es];let o;i?(o=Jn(i),Up(o,r)):o=r,this.hot.setCellMeta(e,n,es,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[es])return i[es][r]}addToContextMenu(e){e.items.push({name:He},tee(this),nee(this),ree(this))}getEditorInputElement(){return Ae(dt,this).getInputElement()}destroy(){var e,n;(e=Ae(dt,this))===null||e===void 0||e.destroy(),(n=Ae(fo,this))===null||n===void 0||n.destroy(),super.destroy()}}function cee(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Ae(pw,this)&&!this.targetIsCommentTextArea(t)){const e=El(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function hee(t){t.stopPropagation()}function dee(t){const{rootDocument:e}=this.hot;if(!(Ae(pw,this)||Ae(dt,this).isFocused()||ye(t.target,"wtBorder")||Ae(SR,this)===t.target||!Ae(dt,this)))if(na(SR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Ae(fo,this).show(n)}else yl(t.target,e)&&!this.targetIsCommentTextArea(t)&&Ae(fo,this).hide()}function fee(){na(pw,this,!1)}function gee(t,e){e[es]&&e[es][Vh]&&X(t,e.commentedCellClassName)}function mee(){na(Qm,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function pee(){na(Qm,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(bR)}function wee(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[q$]:{width:t,height:e}})}function k1(t){Ae(dt,this).isFocused()&&ji(t)}function vee(){Ae(cm,this)||this.hide()}function Mb(t,e,n){return(e=Cee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cee(t){var e=yee(t,"string");return typeof e=="symbol"?e:e+""}function yee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K${constructor(e){Mb(this,"hot",void 0),Mb(this,"commands",{}),Mb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=bee(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||nn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),H(u,c=>c.apply(this.hot,r))}}function bee(t,e){let n;return H(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Ib(t,e,n){return(e=See(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=Ree(t,"string");return typeof e=="symbol"?e:e+""}function Ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ib(this,"hot",void 0),Ib(this,"predefinedItems",Y$()),Ib(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,De(e,(r,i)=>{let o="";r.name===He?(n[He]=r,o=He):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Eee(e,this.defaultOrderPattern,this.predefinedItems)}}function Eee(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ne(i)?De(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Ne(o)?on(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):H(i,(o,s)=>{let a=n[o];!a&&QQ.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Ne(o)&&on(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function xs(t,e,n){return(e=Tee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tee(t){var e=_ee(t,"string");return typeof e=="symbol"?e:e+""}function _ee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mee{constructor(e,n){xs(this,"top",void 0),xs(this,"topRelative",void 0),xs(this,"left",void 0),xs(this,"leftRelative",void 0),xs(this,"scrollTop",void 0),xs(this,"scrollLeft",void 0),xs(this,"cellHeight",void 0),xs(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function ch(t,e,n){Iee(t,e),e.set(t,n)}function Iee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Me(t,e){return t.get(Z$(t,e))}function sg(t,e,n){return t.set(Z$(t,e),n),n}function Z$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wn=new WeakMap,or=new WeakMap,sr=new WeakMap,Pb=new WeakMap,du=new WeakMap;class Pee{constructor(e){ch(this,Wn,void 0),ch(this,or,void 0),ch(this,sr,void 0),ch(this,Pb,!1),ch(this,du,{above:0,below:0,left:0,right:0}),sg(Pb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Me(du,this)[e]=n,this}setElement(e){return sg(Wn,this,e),this}setParentElement(e){return sg(or,this,e),this}updatePosition(e){sg(sr,this,new Mee(e,Me(Wn,this).ownerDocument.defaultView)),Me(Pb,this)?(Me(sr,this).fitsBelow(Me(Wn,this))?this.setPositionBelowCursor():Me(sr,this).fitsAbove(Me(Wn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Me(Wn,this).dir==="rtl"?Me(sr,this).fitsOnLeft(Me(Wn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Me(sr,this).fitsOnRight(Me(Wn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Me(du,this).above+Me(sr,this).top-Me(Wn,this).offsetHeight;if(Me(or,this)){const r=Me(or,this).ownerDocument.defaultView.getComputedStyle(Me(or,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Me(sr,this).top+Me(sr,this).cellHeight-Me(Wn,this).scrollHeight+i+o}Me(Wn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Me(du,this).below+Me(sr,this).top+1;if(Me(or,this)){const r=Me(or,this).ownerDocument.defaultView.getComputedStyle(Me(or,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Me(sr,this).top-i-o-1}Me(Wn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Me(sr,this).left;if(Me(or,this)){const n=Me(or,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Me(or,this).querySelector(".htCore")).borderRightWidth,10);e+=Me(sr,this).cellWidth+r}else e+=Me(du,this).right;Me(Wn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Me(du,this).left+Me(sr,this).left-Me(Wn,this).offsetWidth;if(Me(or,this)){const n=Me(or,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Me(or,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Me(Wn,this).style.left=`${e}px`}}function J$(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=ze(e,-1,w()-1);function a(S,v){const T=w()-1;return S<0&&(S=T),S>T&&(S=0),o.has(S)?-1:(o.add(S),r(S,!1)===!1&&(S=a(v===1?++S:--S,v)),S)}function l(S){S>-1&&S<w()&&r(S,!0)!==!1&&(s=S)}function u(S){S>-1&&S<w()&&(s=S)}function c(){return s}function h(){w()>0&&(o.clear(),s=a(0,1))}function d(){w()>0&&(o.clear(),s=a(w()-1,-1))}function f(){w()>0&&(o.clear(),s=a(++s,1))}function g(){w()>0&&(o.clear(),s=a(--s,-1))}function w(){return Math.max(n(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:g,getSize:w,clear:C}}function Oee(t){return je(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function RR(t){return nn(t,"submenu")}function ER(t){return new RegExp(He,"i").test(t.name)}function hm(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function L1(t){return nn(t,"disableSelection")}function xee(t){return ye(t,"htSeparator")}function Aee(t){return ye(t,"htSubmenu")}function Hee(t){return ye(t,"htDisabled")}function Nee(t){return ye(t,"htSelectionDisabled")}function Dee(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function Q$(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function kee(t,e){let n=t.slice(0);return n.reverse(),n=Q$(n,e),n.reverse(),n}function Lee(t){const e=[];return H(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function $ee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:He,n=t.slice(0);return n=Q$(n,e),n=kee(n,e),n=Lee(n),n}function Fee(t){return t.checkable===!0}function Vee(t){return J$({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||xee(r)||Hee(r)||Nee(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Wee(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const eF="menu",$1=eF;function Bee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Wee(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:eF})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${$1}:${u}`:$1}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function jee(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(ms(n),X(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!hm(a,t)&&!L1(a)&&!ER(a);Ce(n,[...Fee(a)?[o2(),rc(c),yk(h)]:[i2(),rc(u)],...d?[ma(-1)]:[],...hm(a,t)?[d2()]:[],...RR(a)?[si(!1)]:[]])}n.className="",n.appendChild(l),ER(a)?X(n,"htSeparator"):typeof a.renderer=="function"?(X(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):bc(l,u),hm(a,t)?X(n,"htDisabled"):L1(a)?X(n,"htSelectionDisabled"):RR(a)&&X(n,"htSubmenu")}}function Ob(t,e,n){Uee(t,e),e.set(t,n)}function Uee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qi(t,e,n){return(e=zee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zee(t){var e=Yee(t,"string");return typeof e=="symbol"?e:e+""}function Yee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xb(t,e,n){return t.set(tF(t,e),n),n}function As(t,e){return t.get(tF(t,e))}function tF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const F1=215;var fu=new WeakMap,ag=new WeakMap,lg=new WeakMap;class _c{get tableBorderWidth(){return As(lg,this)===void 0&&this.hotMenu&&xb(lg,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),As(lg,this)}constructor(e,n){var r=this;Qi(this,"hot",void 0),Qi(this,"options",void 0),Qi(this,"eventManager",new Vi(this)),Qi(this,"container",void 0),Qi(this,"positioner",void 0),Qi(this,"hotMenu",null),Qi(this,"hotSubMenus",{}),Qi(this,"parentMenu",void 0),Qi(this,"menuItems",null),Qi(this,"origOutsideClickDeselects",null),Ob(this,fu,void 0),Ob(this,ag,void 0),Ob(this,lg,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:F1,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new Pee(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(we(this.options.container,/ht-theme-.*/g),X(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=ic(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return As(fu,this)}getKeyboardShortcutsCtrl(){return As(ag,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Gp(a=>this.openSubMenu(a),300),n=this.options.minWidth||F1;let r=!1,i=Rl(this.menuItems,a=>(a.key===_d&&(r=!0),Dee(a,this.hot)));if(i.length<1&&!r)i.push(Y$()[_d]);else if(i.length===0)return;i=$ee(i,He);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ue(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:jee(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?As(fu,this).setCurrentPage(l.row):As(fu,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),tR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!tR()||!_l(a))&&o&&this.hasSelectedItem()&&(So()||Ek()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),xb(fu,this,Vee(this.hotMenu)),xb(ag,this,Bee(this)),As(ag,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(As(fu,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Ce(r,[si(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Aee(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new _c(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Ce(n,[si(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ce(i,[si(!1)])}}closeAllSubMenus(){H(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Oee(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||ER(e)||hm(e,this.hot)||RR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=Rr(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?rn(this.hotMenu.getCell(u,0)):0;return a+(l.name===He?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(at(r)&&(r=r.call(this.hot),r===null||Pt(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),X(i,`htMenu handsontable ${this.options.className}`),r&&X(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ce(this.hotMenu.rootElement,[r2(),ma(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!yl(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!yl(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ye(e.target,"htCore")&&yl(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ft(_c,En);function Gee(t,e){qee(t,e),e.add(t)}function qee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ab(t,e,n){return(e=Kee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kee(t){var e=Xee(t,"string");return typeof e=="symbol"?e:e+""}function Xee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ug(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Wh="contextMenu",Zee=70,V1=Wh;ie.getSingleton().register("afterContextMenuDefaultOptions");ie.getSingleton().register("beforeContextMenuShow");ie.getSingleton().register("afterContextMenuShow");ie.getSingleton().register("afterContextMenuHide");ie.getSingleton().register("afterContextMenuExecute");var hh=new WeakSet;class ww extends Je{constructor(){super(...arguments),Gee(this,hh),Ab(this,"commandExecutor",new K$(this.hot)),Ab(this,"itemsFactory",null),Ab(this,"menu",null)}static get PLUGIN_KEY(){return Wh}static get PLUGIN_PRIORITY(){return Zee}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[fw,gw,He,of,sf,He,dw,lf,He,mw,hw,He,af,He,Qr]}isEnabled(){return!!this.hot.getSettings()[Wh]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Wh];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new _c(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>ug(hh,this,Qee).call(this)),this.menu.addLocalHook("afterOpen",()=>ug(hh,this,ete).call(this)),this.menu.addLocalHook("afterClose",()=>ug(hh,this,tte).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>ug(hh,this,Jee).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=uw(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:V1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(V1)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;De(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new X$(this.hot,ww.DEFAULT_ITEMS);const e=this.hot.getSettings()[Wh],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),H(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Jee(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ye(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(ye(o,"current")&&ye(o,"wtBorder"))))return;const s=uw(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Qee(){this.hot.runHooks("beforeContextMenuShow",this)}function ete(){this.hot.runHooks("afterContextMenuShow",this)}function tte(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ww.SEPARATOR={name:He};function nte(t){return{key:"copy",name(){return this.getTranslatedPhrase(I0)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function rte(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(x0,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ite(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(O0,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ote(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(P0,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ste(t){return{key:"cut",name(){return this.getTranslatedPhrase(A0)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class ate{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class lte{constructor(){this.clipboardData=new ate}preventDefault(){}composedPath(){return[]}}function ute(t,e){nF(t,e),e.add(t)}function gu(t,e,n){nF(t,e),e.set(t,n)}function nF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Un(t,e){return t.get(Uu(t,e))}function mu(t,e,n){return t.set(Uu(t,e),n),n}function Uu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hs=new WeakMap,Hb=new WeakMap,dh=new WeakMap,TR=new WeakMap,_R=new WeakMap,fh=new WeakMap,gh=new WeakSet;class cte{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;ute(this,gh),gu(this,Hs,void 0),gu(this,Hb,void 0),gu(this,dh,void 0),gu(this,TR,void 0),gu(this,_R,void 0),gu(this,fh,void 0),mu(Hb,this,n),mu(dh,this,r),mu(TR,this,i),mu(_R,this,o),mu(fh,this,s)}setSelectedRange(e){mu(Hs,this,e)}getCellsRange(){if(Un(Hb,this).call(this)===0||Un(dh,this).call(this)===0)return null;const{row:e,col:n}=Un(Hs,this).getTopStartCorner(),{row:r,col:i}=Un(Hs,this).getBottomEndCorner(),o=Uu(gh,this,hte).call(this,e,r),s=Uu(gh,this,Nb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Un(dh,this).call(this)===0||Un(fh,this).call(this)===0)return null;const{col:e}=Un(Hs,this).getTopStartCorner(),{col:n}=Un(Hs,this).getBottomEndCorner(),r=Uu(gh,this,Nb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Un(dh,this).call(this)===0||Un(fh,this).call(this)===0)return null;const{col:e}=Un(Hs,this).getTopStartCorner(),{col:n}=Un(Hs,this).getBottomEndCorner(),r=Uu(gh,this,Nb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Un(fh,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Nb(t,e){return Math.min(e,Math.max(t+Un(_R,this).call(this)-1,t))}function hte(t,e){return Math.min(e,Math.max(t+Un(TR,this).call(this)-1,t))}function rF(t){const e=[],n=[];return H(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);de(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);de(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function dte(t,e){iF(t,e),e.add(t)}function Ns(t,e,n){iF(t,e),e.set(t,n)}function iF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mh(t,e,n){return(e=fte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fte(t){var e=gte(t,"string");return typeof e=="symbol"?e:e+""}function gte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dr(t,e){return t.get(gr(t,e))}function Ti(t,e,n){return t.set(gr(t,e),n),n}function gr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterCopyLimit");ie.getSingleton().register("modifyCopyableRange");ie.getSingleton().register("beforeCut");ie.getSingleton().register("afterCut");ie.getSingleton().register("beforePaste");ie.getSingleton().register("afterPaste");ie.getSingleton().register("beforeCopy");ie.getSingleton().register("afterCopy");const Db="copyPaste",mte=80,pte=["fragmentSelection"],W1=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var MR=new WeakMap,IR=new WeakMap,PR=new WeakMap,pu=new WeakMap,cg=new WeakMap,hg=new WeakMap,wu=new WeakMap,ep=new WeakMap,Ar=new WeakSet;class wte extends Je{constructor(){super(...arguments),dte(this,Ar),mh(this,"columnsLimit",1/0),mh(this,"rowsLimit",1/0),mh(this,"pasteMode","overwrite"),mh(this,"uiContainer",this.hot.rootDocument.body),Ns(this,MR,!1),Ns(this,IR,!1),Ns(this,PR,!1),Ns(this,pu,"cells-only"),Ns(this,cg,!1),Ns(this,hg,!1),Ns(this,wu,new cte({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ns(this,ep,!1),mh(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Db}static get SETTING_KEYS(){return[Db,...pte]}static get PLUGIN_PRIORITY(){return mte}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Db]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Ti(MR,this,this.getSetting("copyColumnHeaders")),Ti(IR,this,this.getSetting("copyColumnGroupHeaders")),Ti(PR,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>gr(Ar,this,yte).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gr(Ar,r,bte).call(r,...o)}),this.addHook("afterSelectionEnd",()=>gr(Ar,this,Ste).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),yd()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gr(Ar,r,Rte).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gr(Ar,r,Ete).call(r,...o)}),this.addHook("afterSelection",()=>gr(Ar,this,Tte).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Ti(pu,this,e),Ti(cg,this,!0),gr(Ar,this,B1).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Ti(hg,this,!0),gr(Ar,this,B1).call(this,"cut")}getRangedCopyableData(e){return Kh(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=rF(e);return H(r,o=>{const s=[];H(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new lte;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}dr(wu,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);dr(pu,this)==="column-headers-only"?n.set("headers",dr(wu,this).getMostBottomColumnHeadersRange()):(dr(pu,this)==="with-column-headers"?n.set("headers",dr(wu,this).getMostBottomColumnHeadersRange()):dr(pu,this)==="with-column-group-headers"&&n.set("headers",dr(wu,this).getAllColumnHeadersRange()),n.set("cells",dr(wu,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:w}=this.hot.getCellMeta(c,a);if(c=w+1,g===!0)continue;d=w,h=a;const C=[],S=o.length%r;for(;C.length<i||h<=u;){const{skipColumnOnPaste:v,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,v===!0)continue;f=T;const P=C.length%i;C.push(e[S][P])}o.push(C)}return Ti(ep,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!dr(cg,this)||this.isEditorOpened()||fs(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!rm(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ti(cg,this,!1);const o=this.getRangedData(this.copyableRanges),s=gr(Ar,this,vte).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=Kh(o);if(e&&e.clipboardData){const u=Tx(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[W1,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Ti(pu,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!dr(hg,this)||this.isEditorOpened()||fs(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!rm(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ti(hg,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=Kh(o);if(e&&e.clipboardData){const l=Tx(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[W1,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||fs(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!rm(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=LE(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=kq(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=p6(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function B1(t){if(yd()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&U2(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function vte(t){const{rows:e}=rF(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function Cte(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&Lk(r)}}}function oF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&$k(r)}}}function yte(t){t.items.push({name:"---------"},nte(this)),dr(MR,this)&&t.items.push(ote(this)),dr(IR,this)&&t.items.push(ite(this)),dr(PR,this)&&t.items.push(rte(this)),t.items.push(ste(this))}function bte(t,e,n,r,i){dr(ep,this)&&(i.value=!0),Ti(ep,this,!1)}function Ste(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Rte(){gr(Ar,this,oF).call(this)}function Ete(){gr(Ar,this,Cte).call(this)}function Tte(){gr(Ar,this,oF).call(this)}function sF(t,e){return`border_row${t}col${e}`}function Bh(){return{width:1,color:"#000"}}function as(){return{hide:!0}}function _te(){return{width:1,color:"#000",cornerVisible:!1}}function kb(t){if(ue(t.start)||ue(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ue(t.end)||ue(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function ph(t){return ue(t.start)&&(t.left=t.start),ue(t.end)&&(t.right=t.end),t}function Lb(t,e){return{id:sF(t,e),border:_te(),row:t,col:e,top:as(),bottom:as(),start:as(),end:as()}}function Mte(t,e){return nn(e,"border")&&e.border&&(t.border=e.border),nn(e,"top")&&ue(e.top)&&(e.top?(Ne(e.top)||(e.top=Bh()),t.top=e.top):(e.top=as(),t.top=e.top)),nn(e,"bottom")&&ue(e.bottom)&&(e.bottom?(Ne(e.bottom)||(e.bottom=Bh()),t.bottom=e.bottom):(e.bottom=as(),t.bottom=e.bottom)),nn(e,"start")&&ue(e.start)&&(e.start?(Ne(e.start)||(e.start=Bh()),t.start=e.start):(e.start=as(),t.start=e.start)),nn(e,"end")&&ue(e.end)&&(e.end?(Ne(e.end)||(e.end=Bh()),t.end=e.end):(e.end=as(),t.end=e.end)),t}function ws(t,e){let n=!1;return H(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!nn(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function vw(t){return`<span class="selected">✓</span>${t}`}function Ite(t){return t.some(e=>ue(e.left)||ue(e.right))}function Pte(t){return t.some(e=>ue(e.start)||ue(e.end))}const Ote=new Map([["left","start"],["right","end"]]);function xte(t){var e;return(e=Ote.get(t))!==null&&e!==void 0?e:t}function Ate(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(J0);return ws(this,"bottom")&&(e=vw(e)),e},callback(e,n){const r=ws(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function Hte(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(Q0);return ws(this,e)&&(n=vw(n)),n},callback(n,r){const i=ws(this,e);t.prepareBorder(r,e,i)}}}function Nte(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(eT)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!ws(this)}}}function Dte(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(Z0);return ws(this,e)&&(n=vw(n)),n},callback(n,r){const i=ws(this,e);t.prepareBorder(r,e,i)}}}function kte(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(X0);return ws(this,"top")&&(e=vw(e)),e},callback(e,n){const r=ws(this,"top");t.prepareBorder(n,"top",r)}}}function Lte(t,e){$te(t,e),e.add(t)}function $te(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fte(t,e,n){return(e=Vte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vte(t){var e=Wte(t,"string");return typeof e=="symbol"?e:e+""}function Wte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function j1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dm="customBorders",Bte=90;var $b=new WeakSet;class jte extends Je{constructor(){super(...arguments),Lte(this,$b),Fte(this,"savedBorders",[])}static get PLUGIN_KEY(){return dm}static get PLUGIN_PRIORITY(){return Bte}isEnabled(){return!!this.hot.getSettings()[dm]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>j1($b,this,Ute).call(this,e)),this.addHook("init",()=>j1($b,this,zte).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=kb(n));const o=ac(e),s=Rd(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});H(e,a=>{s(a).forAll((l,u)=>{H(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,xte(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=ac(e),r=Rd(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return H(e,o=>{r(o).forAll((s,a)=>{H(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(ph(l))})})}),i}clearBorders(e){e?this.setBorders(e):(H(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Lb(e,n);r&&(a=Mte(a,r),H(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",ph(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);de(e.from.row,r,o=>{de(e.from.col,i,s=>{const a=Lb(o,s);let l=0;o===e.from.row&&nn(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&nn(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&nn(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&nn(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",ph(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=sF(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Lb(e,n):o=kb(o),i?(o[r]=as(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",ph(o)))):(o[r]=Bh(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",ph(o)))}prepareBorder(e,n,r){H(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":de(o.col,s.col,a=>{de(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":de(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":de(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":de(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":de(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){H(e,n=>{const r=kb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Rr([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=je(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){H(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){H(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=je(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):H(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return H(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return H(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):H(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);H(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[dm];if(Array.isArray(e)){const n=Jn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Ite(e),r=Pte(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Ute(t){this.hot.getSettings()[dm]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(K0)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[kte(this),Dte(this),Ate(this),Hte(this),Nte(this)]}})}function zte(){this.changeBorderSettings()}function Yte(t,e){Gte(t,e),e.add(t)}function Gte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fb(t,e,n){return(e=qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qte(t){var e=Kte(t,"string");return typeof e=="symbol"?e:e+""}function Kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function U1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const z1="dragToScroll",Xte=100;var Vb=new WeakSet;class Zte extends Je{constructor(){super(...arguments),Yte(this,Vb),Fb(this,"boundaries",null),Fb(this,"callback",null),Fb(this,"listening",!1)}static get PLUGIN_KEY(){return z1}static get PLUGIN_PRIORITY(){return Xte}isEnabled(){return!!this.hot.getSettings()[z1]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>U1(Vb,this,Y1).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>U1(Vb,this,Y1).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=ic(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function Y1(t){if(_l(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Jte(t,e){aF(t,e),e.add(t)}function Qte(t,e,n){aF(t,e),e.set(t,n)}function aF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wb(t,e,n){return(e=ene(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ene(t){var e=tne(t,"string");return typeof e=="symbol"?e:e+""}function tne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nne(t,e){return t.get(ei(t,e))}function lF(t,e,n){return t.set(ei(t,e),n),n}function ei(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterDropdownMenuDefaultOptions");ie.getSingleton().register("beforeDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuHide");ie.getSingleton().register("afterDropdownMenuExecute");const fm="dropdownMenu",rne=230,Md="changeType",Bb=fm;var Cw=new WeakMap,Ii=new WeakSet;class yw extends Je{static get PLUGIN_KEY(){return fm}static get PLUGIN_PRIORITY(){return rne}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[of,sf,He,lf,He,cw,He,af,He,Qr]}constructor(e){super(e),Jte(this,Ii),Wb(this,"commandExecutor",new K$(this.hot)),Wb(this,"itemsFactory",null),Wb(this,"menu",null),Qte(this,Cw,!1),this.hot.addHook("afterGetColHeader",(n,r)=>ei(Ii,this,one).call(this,n,r))}isEnabled(){return this.hot.getSettings()[fm]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new X$(this.hot,yw.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ei(Ii,e,hne).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ei(Ii,e,cne).call(e,...o)});const n=this.hot.getSettings()[fm],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new _c(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>ei(Ii,this,sne).call(this)),this.menu.addLocalHook("afterOpen",()=>ei(Ii,this,ane).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>ei(Ii,this,lne).call(this,o)),this.menu.addLocalHook("afterClose",()=>ei(Ii,this,une).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),H(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=uw(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${Md}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Bb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Bb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Bb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ei(Ii,this,ine).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),De(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function uF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function ine(t){if(ye(t.target,Md)){const e=uw(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),lF(Cw,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function one(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Md}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Md,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ce(s,[Vl(),rc(" ")]),Ce(e,[wk("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function sne(){this.hot.runHooks("beforeDropdownMenuShow",this)}function ane(){this.hot.runHooks("afterDropdownMenuShow",this),ei(Ii,this,uF).call(this,this.menu)}function lne(t){ei(Ii,this,uF).call(this,t)}function une(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function cne(t){return nne(Cw,this)?null:t}function hne(t){ye(t.target,Md)&&lF(Cw,this,!0)}yw.SEPARATOR={name:He};function G1(t,e,n){return(e=dne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dne(t){var e=fne(t,"string");return typeof e=="symbol"?e:e+""}function fne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gne{constructor(e){G1(this,"hot",void 0),G1(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return de(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(de(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();de(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();de(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function q1(t,e,n){return(e=mne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mne(t){var e=pne(t,"string");return typeof e=="symbol"?e:e+""}function pne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){q1(this,"dataProvider",void 0),q1(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=_o(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=on(_o(g_.DEFAULT_OPTIONS),n),n=on(n,e),n.filename=fk(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function wne(t,e){vne(t,e),e.add(t)}function vne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function K1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cF="\r",Cne='"',yne=`
`,bne="=",Sne="+",Rne="-",Ene="@",Tne="	";var jb=new WeakSet;class _ne extends g_{constructor(){super(...arguments),wne(this,jb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=je(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),H(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Ot(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=K1(jb,this,Ine).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=K1(jb,this,Mne).call(this,i)),(n||i.indexOf(cF)>=0||i.indexOf(Cne)>=0||i.indexOf(yne)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function Mne(t){return t.startsWith(bne)||t.startsWith(Sne)||t.startsWith(Rne)||t.startsWith(Ene)||t.startsWith(Tne)||t.startsWith(cF)?`'${t}`:t}function Ine(t,e){return e.test(t)?`'${t}`:t}const Pne="csv",OR={[Pne]:_ne};function One(t,e,n){return typeof OR[t]=="function"?new OR[t](e,n):null}const xne="exportFile",Ane=240;class Hne extends Je{static get PLUGIN_KEY(){return xne}static get PLUGIN_PRIORITY(){return Ane}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!OR[e])throw new Error(`Export format type "${e}" is not supported.`);return One(e,new gne(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function vu(t,e,n){return(e=Nne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nne(t){var e=Dne(t,"string");return typeof e=="symbol"?e:e+""}function Dne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uf{constructor(e,n){let{id:r,stateless:i=!0}=n;vu(this,"hot",void 0),vu(this,"id",void 0),vu(this,"elements",[]),vu(this,"hidden",!1),vu(this,"stateId",""),vu(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Qp)}getElements(){return this.elements}reset(){H(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),H(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ft(uf,En);const Id={};function ca(t,e){if(!Id[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Id[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function gl(t){if(!Id[t])throw Error(`Filter condition "${t}" does not exist.`);return Id[t].descriptor}function Jt(t,e,n){n.key=t,Id[t]={condition:e,descriptor:n}}const yn="none";function kne(){return!0}Jt(yn,kne,{name:ew,inputsCount:0,showOperators:!1});const ed="empty";function Lne(t){return jt(t.value)}Jt(ed,Lne,{name:aT,inputsCount:0,showOperators:!0});const gm="not_empty";function $ne(t,e){return!ca(ed,e)(t)}Jt(gm,$ne,{name:lT,inputsCount:0,showOperators:!0});const td="eq";function Fne(t,e){let[n]=e;return Ot(t.value).toLocaleLowerCase(t.meta.locale)===Ot(n)}Jt(td,Fne,{name:uT,inputsCount:1,showOperators:!0});const mm="neq";function Vne(t,e){return!ca(td,e)(t)}Jt(mm,Vne,{name:cT,inputsCount:1,showOperators:!0});const hF="gt";function Wne(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Jt(hF,Wne,{name:mT,inputsCount:1,showOperators:!0});const dF="gte";function Bne(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Jt(dF,Bne,{name:pT,inputsCount:1,showOperators:!0});const fF="lt";function jne(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Jt(fF,jne,{name:wT,inputsCount:1,showOperators:!0});const gF="lte";function Une(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Jt(gF,Une,{name:vT,inputsCount:1,showOperators:!0});const m_="date_after";function zne(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Jt(m_,zne,{name:bT,inputsCount:1,showOperators:!0});const p_="date_before";function Yne(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Jt(p_,Yne,{name:ST,inputsCount:1,showOperators:!0});const tp="between";function Gne(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=ca(p_,[o]),a=ca(m_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Jt(tp,Gne,{name:CT,inputsCount:2,showOperators:!0});const mF="not_between";function qne(t,e){return!ca(tp,e)(t)}Jt(mF,qne,{name:yT,inputsCount:2,showOperators:!0});const pF="begins_with";function Kne(t,e){let[n]=e;return Ot(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Ot(n))}Jt(pF,Kne,{name:hT,inputsCount:1,showOperators:!0});const wF="ends_with";function Xne(t,e){let[n]=e;return Ot(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Ot(n))}Jt(wF,Xne,{name:dT,inputsCount:1,showOperators:!0});const w_="contains";function Zne(t,e){let[n]=e;return Ot(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Ot(n))>=0}Jt(w_,Zne,{name:fT,inputsCount:1,showOperators:!0});const vF="not_contains";function Jne(t,e){return!ca(w_,e)(t)}Jt(vF,Jne,{name:gT,inputsCount:1,showOperators:!0});const CF="date_tomorrow";function Qne(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}Jt(CF,Qne,{name:ET,inputsCount:0});const yF="date_today";function ere(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}Jt(yF,ere,{name:RT,inputsCount:0});const bF="date_yesterday";function tre(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}Jt(bF,tre,{name:TT,inputsCount:0});M2();function nre(t,e){let n=t;return n===""&&(n=`(${e})`),n}function cf(t){const e=new Set(t);return function(n){return e.has(n)}}function v_(t){return t??""}function xR(t){return Array.from(new Set(t)).map(e=>v_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function X1(t,e,n,r){const i=[],o=t===e;let s;return o||(s=cf(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:nre(a,n)};r&&r(u),i.push(u)}),i}const ml="by_value";function rre(t,e){let[n]=e;return n(t.value)}Jt(ml,rre,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[cf(e)]},showOperators:!1});const Pd={};function ire(t){if(!Pd[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Pd[t].func;return function(n,r){return e(n,r)}}function ore(t){return Pd[t].name}function C_(t,e,n){Pd[t]={name:e,func:n}}const la="conjunction",sre=IT;function are(t,e){return t.every(n=>n.func(e))}C_(la,sre,are);const np="disjunction",lre=tw;function ure(t,e){return t.some(n=>n.func(e))}C_(np,lre,ure);const y_="disjunctionWithExtraCondition",cre=tw;function hre(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}C_(y_,cre,hre);const dre="numeric",SF="text",fre="date",Z1={[dre]:[yn,He,ed,gm,He,td,mm,He,hF,dF,fF,gF,tp,mF],[SF]:[yn,He,ed,gm,He,td,mm,He,pF,wF,He,w_,vF],[fre]:[yn,He,ed,gm,He,td,mm,He,p_,m_,tp,He,CF,yF,bF]};function gre(t){const e=[];let n=t;return Z1[n]||(n=SF),H(Z1[n],r=>{let i;r===He?i={name:He}:i=_o(gl(r)),e.push(i)}),e}function wh(t,e,n){return(e=mre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mre(t){var e=pre(t,"string");return typeof e=="symbol"?e:e+""}function pre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ub="built",zb="building",J1=["click","input","keydown","keypress","keyup","focus","blur","change"];let ki=class RF{static get DEFAULTS(){return _o({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){wh(this,"hot",void 0),wh(this,"eventManager",new Vi(this)),wh(this,"options",void 0),wh(this,"_element",void 0),wh(this,"buildState",void 0),this.hot=e,this.options=on(RF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===zb?this._element:this.buildState===Ub?(this.update(),this._element):(this.buildState=zb,this.build(),this.buildState=Ub,this._element)}isBuilt(){return this.buildState===Ub}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Qn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=zb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&X(this._element,this.options.className),this.options.children.length)H(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),De(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),H(J1,r=>e(n,r))}else H(J1,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ft(ki,En);function wre(t,e){EF(t,e),e.add(t)}function vre(t,e,n){EF(t,e),e.set(t,n)}function EF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dg(t,e){return t.get(b_(t,e))}function Cre(t,e,n){return t.set(b_(t,e),n),n}function b_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cu=new WeakMap,Q1=new WeakSet;class ua extends ki{static get DEFAULTS(){return _o({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,on(ua.DEFAULTS,n)),wre(this,Q1),vre(this,Cu,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>b_(Q1,this,yre).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Cre(Cu,this,this._element.firstChild),X(this._element,"htUIInput"),X(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(dg(Cu,this).type=this.options.type,dg(Cu,this).placeholder=this.translateIfPossible(this.options.placeholder),dg(Cu,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&dg(Cu,this).focus()}}function yre(t){this.options.value=t.target.value}function bre(t,e){TF(t,e),e.add(t)}function vh(t,e,n){TF(t,e),e.set(t,n)}function TF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yu(t,e,n){return t.set(nd(t,e),n),n}function xt(t,e){return t.get(nd(t,e))}function nd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dn=new WeakMap,fg=new WeakMap,gg=new WeakMap,Yb=new WeakMap,mg=new WeakMap,pg=new WeakSet;class Od extends ki{static get DEFAULTS(){return _o({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,on(Od.DEFAULTS,n)),bre(this,pg),vh(this,dn,null),vh(this,fg,[]),vh(this,gg,void 0),vh(this,Yb,void 0),vh(this,mg,void 0),this.registerHooks()}getMenu(){return xt(dn,this)}registerHooks(){this.addLocalHook("click",()=>nd(pg,this,Ere).call(this))}setItems(e){yu(fg,this,this.translateNames(e)),xt(dn,this)&&xt(dn,this).setMenuItems(xt(fg,this))}translateNames(e){return H(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),yu(dn,this,new _c(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),xt(dn,this).setMenuItems(xt(fg,this));const e=new ki(this.hot,{className:"htUISelectCaption"}),n=new ki(this.hot,{className:"htUISelectDropdown"});yu(gg,this,e),yu(Yb,this,e.element),yu(mg,this,n),this.hot.getSettings().ariaTags&&(Ce(n.element,[Vl()]),Ce(this._element,[pk()])),H([e,n],r=>this._element.appendChild(r.element)),xt(dn,this).addLocalHook("select",r=>nd(pg,this,Sre).call(this,r)),xt(dn,this).addLocalHook("afterClose",()=>nd(pg,this,Rre).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=xt(dn,this).hot.getTranslatedPhrase(ew),xt(Yb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();xt(dn,this)&&(xt(dn,this).open(),xt(dn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),xt(dn,this).getNavigator().toFirstItem(),xt(dn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){xt(dn,this)&&xt(dn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){xt(dn,this)&&(xt(dn,this).destroy(),yu(dn,this,null)),xt(gg,this)&&xt(gg,this).destroy(),xt(mg,this)&&xt(mg,this).destroy(),super.destroy()}}function Sre(t){t.name!==He&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Rre(){this.runLocalHooks("afterClose")}function Ere(){this.openOptions()}function Tre(t,e){_re(t,e),e.add(t)}function _re(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eH(t,e,n){return(e=Mre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mre(t){var e=Ire(t,"string");return typeof e=="symbol"?e:e+""}function Ire(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gb=new WeakSet;class AR extends uf{constructor(e,n){super(e,{id:n.id,stateless:!1}),Tre(this,Gb),eH(this,"name",""),eH(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Od(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ua(this.hot,{placeholder:NT})),this.elements.push(new ua(this.hot,{placeholder:DT})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>tH(Gb,this,Pre).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),H(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>tH(Gb,this,Ore).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=_o(e.command);n.name.startsWith($t)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),H(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||gl(yn),n=[];return H(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=gl(e?e.name:yn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||H(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Od)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ua)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{X(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&X(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||H(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[gl(yn)];if(e!==null){const{visualIndex:r}=e;n=gre(this.hot.getDataType(0,r,this.hot.countRows(),r))}H(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Pre(t){H(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Ore(t){Kd(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ji(t))}function nH(t,e,n){xre(t,e),e.set(t,n)}function xre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ch(t,e){return t.get(_F(t,e))}function rH(t,e,n){return t.set(_F(t,e),n),n}function _F(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bu=new WeakMap,qb=new WeakMap;class rp extends ki{static get DEFAULTS(){return _o({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,on(rp.DEFAULTS,n)),nH(this,bu,void 0),nH(this,qb,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),rH(qb,this,e),rH(bu,this,this._element.firstChild),Ch(bu,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Ch(qb,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Ch(bu,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Ch(bu,this).checked=e)}focus(){this.isBuilt()&&Ch(bu,this).focus()}}function Are(t,e){Hre(t,e),e.add(t)}function Hre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nre(t,e,n){return(e=Dre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dre(t){var e=kre(t,"string");return typeof e=="symbol"?e:e+""}function kre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lre(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const iH=0;var oH=new WeakSet;class $re extends uf{constructor(e,n){super(e,{id:n.id,stateless:!1}),Are(this,oH),Nre(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuOperators"),H(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[la,np];H(e,n=>{const r=new rp(this.hot,{name:"operator",label:{htmlFor:n,textContent:ore(n)},value:n,checked:n===e[iH],id:n});r.addLocalHook("change",i=>Lre(oH,this,Fre).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(it`Radio button with index ${e} doesn't exist.`);H(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof rp&&n.isChecked());return e?e.getValue():la}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&H(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:la,n=arguments.length>1?arguments[1]:void 0,r=e;r===y_&&(r=np),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(iH)}}function Fre(t){this.setState(t.target.value)}function Vre(t,e,n){Wre(t,e),e.set(t,n)}function Wre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kb(t,e){return t.get(MF(t,e))}function Bre(t,e,n){return t.set(MF(t,e),n),n}function MF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yh=new WeakMap;class xd extends ki{static get DEFAULTS(){return _o({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,on(xd.DEFAULTS,n)),Vre(this,yh,void 0)}build(){super.build(),Bre(yh,this,this._element.firstChild)}update(){this.isBuilt()&&(Kb(yh,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Kb(yh,this).focus()}activate(){Kb(yh,this).click()}}function jre(t,e){IF(t,e),e.add(t)}function Su(t,e,n){IF(t,e),e.set(t,n)}function IF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ie(t,e){return t.get(zu(t,e))}function yi(t,e,n){return t.set(zu(t,e),n),n}function zu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sH="multipleSelect.itemBox";var Pi=new WeakMap,Yt=new WeakMap,Xb=new WeakMap,Uo=new WeakMap,Ds=new WeakMap,ks=new WeakMap,bh=new WeakSet;class Ad extends ki{static get DEFAULTS(){return _o({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,on(Ad.DEFAULTS,n)),jre(this,bh),Su(this,Pi,[]),Su(this,Yt,void 0),Su(this,Xb,void 0),Su(this,Uo,void 0),Su(this,Ds,void 0),Su(this,ks,void 0),yi(Uo,this,new ua(this.hot,{placeholder:HT,className:"htUIMultipleSelectSearch"})),yi(Ds,this,new xd(this.hot,{textContent:PT,className:"htUISelectAll"})),yi(ks,this,new xd(this.hot,{textContent:OT,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ie(Yt,this)}registerHooks(){Ie(Uo,this).addLocalHook("keydown",e=>zu(bh,this,zre).call(this,e)),Ie(Uo,this).addLocalHook("input",e=>zu(bh,this,Ure).call(this,e)),Ie(Ds,this).addLocalHook("click",e=>zu(bh,this,Yre).call(this,e)),Ie(ks,this).addLocalHook("click",e=>zu(bh,this,Gre).call(this,e))}setItems(e){var n;yi(Pi,this,e),(n=Ie(Yt,this))===null||n===void 0||n.loadData(Ie(Pi,this))}setLocale(e){yi(Xb,this,e)}getLocale(){return Ie(Xb,this)}getItems(){return[...Ie(Pi,this)]}getValue(){return Kre(Ie(Pi,this))}getSearchInputElement(){return Ie(Uo,this)}getSelectAllElement(){return Ie(Ds,this)}getClearAllElement(){return Ie(ks,this)}isSelectedAllValues(){return Ie(Pi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new ki(this.hot,{className:"htUISelectionControls",children:[Ie(Ds,this),Ie(ks,this)]});this._element.appendChild(Ie(Uo,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Ie(Yt,this))===null||s===void 0||s.destroy(),X(o,"htUIMultipleSelectHot"),yi(Yt,this,new this.hot.constructor(o,{data:Ie(Pi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ie(Yt,this).listen()},modifyColWidth:u=>{const c=Ie(Yt,this).container.scrollWidth-bn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ie(Yt,this).init();const l=Ie(Yt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:sH}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Ie(Yt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:sH})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Ie(Yt,this).listen()}reset(){Ie(Uo,this).reset(),Ie(Ds,this).reset(),Ie(ks,this).reset()}update(){this.isBuilt()&&(Ie(Yt,this).loadData(qre(Ie(Pi,this),this.options.value)),super.update())}destroy(){var e;(e=Ie(Yt,this))===null||e===void 0||e.destroy(),Ie(Uo,this).destroy(),Ie(ks,this).destroy(),Ie(Ds,this).destroy(),yi(Uo,this,null),yi(ks,this,null),yi(Ds,this,null),yi(Yt,this,null),yi(Pi,this,null),super.destroy()}}function Ure(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Ie(Pi,this)]:n=Ie(Pi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ie(Yt,this).loadData(n)}function zre(t){this.runLocalHooks("keydown",t,this),Fk(Kd,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),ji(t),Ie(Yt,this).listen(),Ie(Yt,this).selectCell(0,0))}function Yre(t){const e=[];t.preventDefault(),Ie(Yt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(wL(n,r)[0])}),Ie(Yt,this).setSourceDataAtCell(e)}function Gre(t){const e=[];t.preventDefault(),Ie(Yt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(wL(n,r)[0])}),Ie(Yt,this).setSourceDataAtCell(e)}function qre(t,e){const n=cf(e);return t.map(r=>(r.checked=n(r.value),r))}function Kre(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Xre(t,e){Zre(t,e),e.add(t)}function Zre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jre(t,e,n){return(e=Qre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qre(t){var e=eie(t,"string");return typeof e=="symbol"?e:e+""}function eie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sh=new WeakSet;class tie extends uf{constructor(e,n){super(e,{id:n.id,stateless:!1}),Xre(this,Sh),Jre(this,"name",""),this.name=n.name,this.elements.push(new Ad(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>wg(Sh,this,nie).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>wg(Sh,this,rie).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===ml){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?yn:ml},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Rl(i,h=>h.name===ml),u={},c=this.hot.getTranslatedPhrase(Fm);if(l){const h=s(r,a),d=je(h,v=>v.value),f=new Map(h.map(v=>[v.value,this.hot.getCellMeta(v.meta.visualRow,v.meta.visualCol)])),g=xR(d);o&&(l.args[0]=o);const w=[],C=X1(g,l.args[0],c,v=>{v.checked&&w.push(v.value),wg(Sh,this,aH).call(this,v,f)}),S=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,S).locale,u.args=[w],u.command=gl(ml),u.itemsSnapshot=C}else u.args=[],u.command=gl(yn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Ad)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{X(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||H(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Fm),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=xR(r),s=X1(o,o,e,l=>{wg(Sh,this,aH).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:je(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:v_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function nie(t){Kd(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ji(t))}function aH(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function rie(t,e){switch(e.type){case"numeric":return p$(t,e);default:return t}}var PF;function iie(t,e){oie(t,e),e.add(t)}function oie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sie(t,e,n){return(e=aie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aie(t){var e=lie(t,"string");return typeof e=="symbol"?e:e+""}function lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uie(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lH=new WeakSet;class Hd extends uf{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),iie(this,lH),sie(this,"name",""),this.name=n.name,this.elements.push(new ua(this.hot,{type:"button",value:xT,className:"htUIButton htUIButtonOK",identifier:Hd.BUTTON_OK})),this.elements.push(new ua(this.hot,{type:"button",value:AT,className:"htUIButton htUIButtonCancel",identifier:Hd.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){H(this.elements,e=>{e.addLocalHook("click",(n,r)=>uie(lH,this,cie).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuActionBar"),H(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}PF=Hd;function cie(t,e){e.options.identifier===PF.BUTTON_OK?this.accept():this.cancel()}function Zb(t,e,n){return(e=hie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hie(t){var e=die(t,"string");return typeof e=="symbol"?e:e+""}function die(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uH="ConditionCollection.filteringStates";class S_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Zb(this,"hot",void 0),Zb(this,"isMapRegistrable",void 0),Zb(this,"filteringStates",new Qp),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(uH,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i?.conditions)!==null&&r!==void 0?r:[],s=i?.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:la;return e.length?ire(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:la,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(it`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Pt(Pd[r]))throw new Error(it`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:ca(a,s)}]},i):u.push({name:a,args:s,func:ca(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(uH),this.filteringStates=null,this.clearLocalHooks()}}ft(S_,En);function cH(t,e,n){return(e=fie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fie(t){var e=gie(t,"string");return typeof e=="symbol"?e:e+""}function gie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];cH(this,"conditionCollection",void 0),cH(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return H(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return H(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return H(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function mie(t,e){pie(t,e),e.add(t)}function pie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Va(t,e,n){return(e=wie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wie(t){var e=vie(t,"string");return typeof e=="symbol"?e:e+""}function vie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vg=new WeakSet;class xF{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];mie(this,vg),Va(this,"hot",void 0),Va(this,"conditionCollection",void 0),Va(this,"columnDataFactory",void 0),Va(this,"changes",[]),Va(this,"grouping",!1),Va(this,"latestEditedColumnPosition",-1),Va(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Jb(vg,this,Cie).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Jb(vg,this,yie).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Jb(vg,this,bie).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,H(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=z2(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new S_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const w=r.columnDataFactory(h);let C;f.isEmpty()?C=w:C=new OF(f,v=>r.columnDataFactory(v)).filter(),C=je(C,v=>v.meta.visualRow);const S=cf(C);return f.destroy(),Rl(w,v=>S(v.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),De(this,(e,n)=>{this[n]=null})}}function Cie(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function yie(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function bie(){H(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ft(xF,En);function Sie(t){return J$({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Ad)return r;if(i.element&&!oc(i.element))return!1;i.focus()}})}const Rh="filters";function Rie(t,e){let n=-1,r;const i=Sie(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Rh),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof ki&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Rh),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Rh)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const w=r.getNavigator();w.getCurrentPage()>-1&&(n=w.getCurrentPage()),w.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const w=e[i.getCurrentPage()];w instanceof Od&&(w.openOptions(),g.preventDefault()),w instanceof xd&&(w.activate(),g.preventDefault()),w instanceof ki||g.preventDefault()}}],Rh)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Rh)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function Eie(t,e){AF(t,e),e.add(t)}function Qb(t,e,n){AF(t,e),e.set(t,n)}function AF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eh(t,e,n){return(e=Tie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tie(t){var e=_ie(t,"string");return typeof e=="symbol"?e:e+""}function _ie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pm(t,e,n){return t.set(ur(t,e),n),n}function ti(t,e){return t.get(ur(t,e))}function ur(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const HR="filters",Mie=250,hH=HR;var Xo=new WeakMap,NR=new WeakMap,ul=new WeakMap,Er=new WeakSet;class Iie extends Je{static get PLUGIN_KEY(){return HR}static get PLUGIN_PRIORITY(){return Mie}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,Eie(this,Er),Eh(this,"dropdownMenuPlugin",null),Eh(this,"conditionCollection",null),Eh(this,"conditionUpdateObserver",null),Eh(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Eh(this,"filtersRowsMap",null),Qb(this,Xo,void 0),Qb(this,NR,new WeakSet),Qb(this,ul,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ur(Er,n,Die).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[HR]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Qd),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>ur(Er,this,dH).call(this,"accept")),a.addLocalHook("cancel",()=>ur(Er,this,dH).call(this,"cancel")),a.addLocalHook("change",l=>ur(Er,this,Nie).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(_T)}:`,s=()=>`${this.hot.getTranslatedPhrase(MT)}:`;if(!this.components.get("filter_by_condition")){const a=new AR(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>ur(Er,this,fH).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new $re(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new AR(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>ur(Er,this,fH).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new tie(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Hd(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new S_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new xF(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>ur(Er,this,kie).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return ur(Er,e,Hie).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>ur(Er,this,Aie).call(this)),this.addHook("afterDropdownMenuShow",()=>ur(Er,this,Oie).call(this)),this.addHook("afterDropdownMenuHide",()=>ur(Er,this,xie).call(this)),this.addHook("afterChange",a=>ur(Er,this,Pie).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!ti(Xo,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=ti(Xo,this).getMenu(),c=u.getNavigator(),h=ti(Xo,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];pm(Xo,this,Rie(this.dropdownMenuPlugin.menu,a));const l=u=>{ti(Xo,this).listen(),u.preventDefault(),Kd(u.keyCode,"TAB")&&(u.shiftKey?ti(Xo,this).toPreviousItem():ti(Xo,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:hH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hH)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:la;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,ti(ul,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=je(n.filter(),u=>u.meta.visualRow);const l=cf(i);de(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),H(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),pm(ul,this,this.exportConditions())}else s!==!1&&!r?(pm(ul,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(ti(ul,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return H(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),w=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:v_(w)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=xR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===np&&n.command.key!==yn&&r.command.key!==yn&&i.command.key!==yn?o=y_:i.command.key!==yn&&(n.command.key===yn||r.command.key===yn)&&(o=la),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new OF(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return H(i,s=>{H(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Pie(t){t&&H(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Oie(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function xie(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Aie(){const t=this.dropdownMenuPlugin.menu;ti(NR,this).has(t)||ti(Xo,this).setMenu(t),ti(NR,this).add(t)}function Hie(t){t.items.push({name:He}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function dH(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==yn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==yn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==yn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Nie(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===AR&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function fH(){this.setListeningDropdownMenu()}function Die(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?X(e,"htFiltersActive"):we(e,"htFiltersActive")}function kie(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&pm(ul,this,ti(ul,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===ml),s=n.filter(a=>a.name!==ml);if(o.length>=2||s.length>=3)Ze(it`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const HF="internal-use-in-handsontable",DR={licenseKey:HF,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function NF(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Nn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function DF(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Lie(t){var e;const n=t[Nn],r=DF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=NF(t);return{...DR,...r,...i}}function $ie(t){var e;const n=t[Nn],r=DF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=NF(t);return{...r,...i}}function Fie(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function bw(){const t="engine_relationship",e=fi(Nn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function R_(){const t="shared_engine_usage",e=fi(Nn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Vie(t){const e=t.getSettings(),n=e[Nn],r=n?.engine;if(n===!0||Pt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Wie((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Pt(r.hyperformula)){const o=bw(),s=R_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:HF}),(r.getConfig().leapYear1900!==DR.leapYear1900||VE(r.getConfig().nullDate,DR.nullDate)===!1)&&Ze(it`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Wie(t,e,n){const r=e[Nn],i=Lie(e),o=bw(),s=R_();Bie(t,r.functions),jie(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Uie(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function gH(t){var e;const n=bw(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function mH(t,e){if(t){const n=bw(),r=n.get(t),i=R_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Bie(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){Ze(s.message)}})}function jie(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){Ze(r.message)}}}function Uie(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){Ze(a.message)}}),t.resumeEvaluation())}function zie(t,e){return(Pt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const kF="DD/MM/YYYY";function Yie(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Gie(t){return Yie(t)?t.substr(1):t}function qie(t){return typeof t=="string"&&t.startsWith("=")}function E_(t,e){return typeof t=="string"&&e==="date"}function LF(t,e){return Z(t,e,!0).isValid()}function $F(t,e){return Z(t,e,!0).format(kF)}function Kie(t,e){return Z(t,kF,!0).format(e)}function FF(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Z(r).format(e)}function Xie(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Zie(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Jie(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function T_(t,e,n){const r=Zie(t,Xie(t,e,n));return Jie(r)}function Wa(t,e,n){Qie(t,e),e.set(t,n)}function Qie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rt(t,e){return t.get(VF(t,e))}function Ls(t,e,n){return t.set(VF(t,e),n),n}function VF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Th=new WeakMap,$s=new WeakMap,Tr=new WeakMap,Cg=new WeakMap,eS=new WeakMap,tS=new WeakMap,yg=new WeakMap;class pH{constructor(e,n,r){Wa(this,Th,void 0),Wa(this,$s,void 0),Wa(this,Tr,void 0),Wa(this,Cg,[]),Wa(this,eS,[]),Wa(this,tS,void 0),Wa(this,yg,[]),Ls(Th,this,e),Ls($s,this,n),Ls(Tr,this,r)}setRemovedHfIndexes(e){return Ls(yg,this,e.map(n=>{const r=Rt($s,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Rt(yg,this)}getRemovedHfIndexes(){return Rt(yg,this)}getHfIndexFromVisualIndex(e){const n=Rt($s,this).getIndexesSequence(),r=Rt($s,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Fi(Rt(Th,this))}s`;Rt(Tr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Rt(Tr,this).getEngine()[r](Rt(Tr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Ls(eS,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Ls(tS,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Rt(Tr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=T_(Rt(eS,this),Rt(tS,this),Rt($s,this).getNumberOfIndexes());Rt(Tr,this).getSheetId()===null?Rt(Tr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Fi(Rt(Th,this))}Order`;return n=>{if(Rt(Tr,this).isPerformingUndoRedo())return;const r=Rt($s,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=Rt(Cg,this).map(l=>r.indexOf(l)),o=Rt(Tr,this).getEngine().getSheetDimensions(Rt(Tr,this).getSheetId());let s;Rt(Th,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Rt(Tr,this).getEngine()[e](Rt(Tr,this).getSheetId(),i)}Ls(Cg,this,r)}}init(){Ls(Cg,this,Rt($s,this).getIndexesSequence())}}function Ba(t,e,n){eoe(t,e),e.set(t,n)}function eoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zo(t,e){return t.get(WF(t,e))}function ja(t,e,n){return t.set(WF(t,e),n),n}function WF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bg=new WeakMap,Sg=new WeakMap,nS=new WeakMap,rS=new WeakMap,iS=new WeakMap,oS=new WeakMap,sS=new WeakMap;class toe{constructor(e,n,r){Ba(this,bg,void 0),Ba(this,Sg,void 0),Ba(this,nS,void 0),Ba(this,rS,!1),Ba(this,iS,!1),Ba(this,oS,null),Ba(this,sS,null),ja(bg,this,new pH("row",e,this)),ja(Sg,this,new pH("column",n,this)),ja(nS,this,r)}getForAxis(e){return e==="row"?zo(bg,this):zo(Sg,this)}setPerformUndo(e){ja(rS,this,e)}setPerformRedo(e){ja(iS,this,e)}isPerformingUndoRedo(){return zo(rS,this)||zo(iS,this)}getSheetId(){return zo(sS,this)}getEngine(){return zo(oS,this)}getPostponeAction(){return zo(nS,this)}setupSyncEndpoint(e,n){ja(oS,this,e),ja(sS,this,n),zo(bg,this).init(),zo(Sg,this).init()}}function noe(t,e){BF(t,e),e.add(t)}function Ua(t,e,n){return(e=roe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function roe(t){var e=ioe(t,"string");return typeof e=="symbol"?e:e+""}function ioe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aS(t,e,n){BF(t,e),e.set(t,n)}function BF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ha(t,e,n){return t.set(Ge(t,e),n),n}function bl(t,e){return t.get(Ge(t,e))}function Ge(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Nn="formulas",ooe=["maxRows","maxColumns","language"],soe=260;ie.getSingleton().register("afterNamedExpressionAdded");ie.getSingleton().register("afterNamedExpressionRemoved");ie.getSingleton().register("afterSheetAdded");ie.getSingleton().register("afterSheetRemoved");ie.getSingleton().register("afterSheetRenamed");ie.getSingleton().register("afterFormulasValuesUpdate");const Mc=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var vs=new WeakMap,Sw=new WeakMap,_h=new WeakMap,Xe=new WeakSet;class aoe extends Je{constructor(){var e;super(...arguments),e=this,noe(this,Xe),aS(this,vs,!1),aS(this,Sw,!1),aS(this,_h,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,Roe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,Eoe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,Toe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,_oe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,Moe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,Ioe).call(e,...r)}]]),Ua(this,"staticRegister",fi("formulas")),Ua(this,"engine",null),Ua(this,"sheetId",null),Ua(this,"sheetName",null),Ua(this,"indexSyncer",null),Ua(this,"rowAxisSyncer",null),Ua(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Nn}static get PLUGIN_PRIORITY(){return soe}static get SETTING_KEYS(){return[Nn,...ooe]}isEnabled(){return!!this.hot.getSettings()[Nn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Vie(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Ze("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&Ge(Xe,this,rd).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,wH).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,vH).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,wH).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,vH).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,hoe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,doe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,loe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,foe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,CH).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,CH).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,goe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,moe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,voe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,Coe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,poe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,woe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,yoe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,boe).call(n,...i)}),this.indexSyncer=new toe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,coe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,Soe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,uoe).call(n,...i)}),bl(_h,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){bl(_h,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),mH(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=$ie(this.hot.getSettings());Fie(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Nn];if(ue(r)&&ue(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Nn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());Ge(Xe,this,rd).call(this,o)}}super.updatePlugin(e)}destroy(){bl(_h,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),ha(_h,this,null),mH(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ue(n)&&!n4(n))return Ze("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Ze("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return Ze(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){YE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Ge(Xe,this,rd).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Fi(Nn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),gH(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o?.address)!==null&&s!==void 0?s:{};return ue(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ue(l)===!1||ue(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=gH(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Ze(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return E_(r,o.type)&&(LF(r,o.dateFormat)?r=$F(r,o.dateFormat):qie(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function rd(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function loe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&qn(s)&&(s=FF(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function uoe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:w}=h.start,{row:C,col:S}=h.end,v=C-g+1,T=S-w+1;for(let P=0;P<f.length;P+=1)for(let x=0;x<f[P].length;x+=1){const _=f[P][x],M=g+P%v,V=w+x%T,Y=this.hot.getCellMeta(M,V);E_(_,Y.type)&&(_.startsWith("'")?f[P][x]=_.slice(1):this.isFormulaCellType(M,V,this.sheetId)===!1&&(f[P][x]=Kie(_,Y.dateFormat)))}return f}function wH(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Fi(Nn))||ha(Sw,this,Pt(this.hot.getSettings().data))}function coe(){if(bl(Sw,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;E_(i,s.type)&&(LF(i,a)?t[r][o]=$F(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),ha(vs,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),ha(vs,this,!1)}function vH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Fi(Nn)))return;const r=zie(this.engine,this.hot.getSettings()[Nn].sheetName);if(Ge(Xe,this,rd).call(this,r),n!=="updateSettings")if(bl(Sw,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){ha(vs,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),ha(vs,this,!1)}}}function hoe(t,e,n,r){if(r!=="get"||bl(vs,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){n.value=Gie(n.value);return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let s=this.engine.getCellValue(o);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&qn(s)&&(s=FF(s,a.dateFormat)),n.value=typeof s=="object"&&s!==null?s.value:s}function doe(t,e,n,r){if(r!=="get"||bl(vs,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function CH(t,e){if(Mc(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function foe(t,e){if(Mc(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!qn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Ze(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function goe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function moe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function poe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function woe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function voe(t,e,n){if(Mc(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Coe(t,e,n){if(Mc(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function yoe(t,e,n,r){if(Mc(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function boe(t,e,n,r){if(Mc(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Soe(t,e,n){var r;ha(vs,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());ha(vs,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Roe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Eoe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Toe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function _oe(t){this.hot.runHooks("afterSheetAdded",t)}function Moe(t,e){Ge(Xe,this,rd).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function Ioe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Poe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(rT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Ooe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(iT,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=je(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return H(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function xoe(t,e){jF(t,e),e.add(t)}function Aoe(t,e,n){jF(t,e),e.set(t,n)}function jF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function za(t,e){return t.get(zs(t,e))}function yH(t,e,n){return t.set(zs(t,e),n),n}function zs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideColumns");ie.getSingleton().register("afterHideColumns");ie.getSingleton().register("beforeUnhideColumns");ie.getSingleton().register("afterUnhideColumns");const bH="hiddenColumns",Hoe=310;var eo=new WeakMap,Ya=new WeakSet;class Noe extends Je{constructor(){super(...arguments),xoe(this,Ya),Aoe(this,eo,null)}static get PLUGIN_KEY(){return bH}static get PLUGIN_PRIORITY(){return Hoe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[bH]}enablePlugin(){var e=this;this.enabled||(yH(eo,this,new Jp),za(eo,this).addLocalHook("init",()=>zs(Ya,this,Voe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,za(eo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zs(Ya,e,Foe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>zs(Ya,this,koe).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>zs(Ya,this,Doe).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zs(Ya,e,$oe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>zs(Ya,this,Loe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=za(eo,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));H(l,u=>{o[u]=!1}),i=Rr(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&za(eo,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{za(eo,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return je(za(eo,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return za(eo,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){H(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){yH(eo,this,null),super.destroy()}}function Doe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function koe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Loe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return H(t,r=>{let i=!0,o=0;de(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function $oe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),X(e,n)}function Foe(t){t.items.push({name:He},Poe(this),Ooe(this))}function Voe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Woe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(oT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Boe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(sT,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=je(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return H(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function joe(t,e){UF(t,e),e.add(t)}function Uoe(t,e,n){UF(t,e),e.set(t,n)}function UF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ga(t,e){return t.get(Ys(t,e))}function SH(t,e,n){return t.set(Ys(t,e),n),n}function Ys(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideRows");ie.getSingleton().register("afterHideRows");ie.getSingleton().register("beforeUnhideRows");ie.getSingleton().register("afterUnhideRows");const RH="hiddenRows",zoe=320;var to=new WeakMap,qa=new WeakSet;class Yoe extends Je{constructor(){super(...arguments),joe(this,qa),Uoe(this,to,null)}static get PLUGIN_KEY(){return RH}static get PLUGIN_PRIORITY(){return zoe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[RH]}enablePlugin(){var e=this;this.enabled||(SH(to,this,new Jp),Ga(to,this).addLocalHook("init",()=>Ys(qa,this,Joe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ga(to,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ys(qa,e,Zoe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Ys(qa,this,qoe).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>Ys(qa,this,Goe).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ys(qa,e,Xoe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Ys(qa,this,Koe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Ga(to,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));H(l,u=>{o[u]=!1}),i=Rr(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Ga(to,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{Ga(to,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return je(Ga(to,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ga(to,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){H(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){SH(to,this,null),super.destroy()}}function Goe(t,e){return this.isHidden(e)?0:t}function qoe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Koe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return H(t,r=>{let i=!0,o=0;de(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Xoe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),X(e,n)}function Zoe(t){t.items.push({name:He},Woe(this),Boe(this))}function Joe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Qoe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(H0)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function ese(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(N0)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function tse(t,e){zF(t,e),e.add(t)}function nse(t,e,n){zF(t,e),e.set(t,n)}function zF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kR(t,e){return t.get(ip(t,e))}function lS(t,e,n){return t.set(ip(t,e),n),n}function ip(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnFreeze");ie.getSingleton().register("afterColumnFreeze");ie.getSingleton().register("beforeColumnUnfreeze");ie.getSingleton().register("afterColumnUnfreeze");const EH="manualColumnFreeze",rse=110;var sl=new WeakMap,uS=new WeakSet;class ise extends Je{constructor(){super(...arguments),tse(this,uS),nse(this,sl,!1)}static get PLUGIN_KEY(){return EH}static get PLUGIN_PRIORITY(){return rse}isEnabled(){return!!this.hot.getSettings()[EH]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>ip(uS,this,ose).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>ip(uS,this,sse).call(this,e,n)),super.enablePlugin())}disablePlugin(){lS(sl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;kR(sl,this)||lS(sl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;kR(sl,this)||lS(sl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function ose(t){t.items.push({name:"---------"},Qoe(this),ese(this))}function sse(t,e){if(kR(sl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Rg(t,e,n){return(e=ase(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ase(t){var e=lse(t,"string");return typeof e=="symbol"?e:e+""}function lse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cS=0,TH=1,_H=2,Ru="px";let YF=class{constructor(e){Rg(this,"hot",void 0),Rg(this,"_element",null),Rg(this,"state",cS),Rg(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=_H}build(){this.state===cS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=TH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=cS}isAppended(){return this.state===_H}isBuilt(){return this.state>=TH}setPosition(e,n){qn(e)&&(this._element.style.top=e+Ru),qn(n)&&(this._element.style[this.inlineProperty]=n+Ru)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){qn(e)&&(this._element.style.width=e+Ru),qn(n)&&(this._element.style.height=n+Ru)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){qn(e)&&(this._element.style.marginTop=e+Ru),qn(n)&&(this._element.style[`margin${Fi(this.inlineProperty)}`]=n+Ru)}getOffset(){const e=this._element.style,n=`margin${Fi(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const use="ht__manualColumnMove--backlight";let cse=class extends YF{build(){super.build(),X(this._element,use)}};const hse="ht__manualColumnMove--guideline";let dse=class extends YF{build(){super.build(),X(this._element,hse)}};function fse(t,e){GF(t,e),e.add(t)}function bi(t,e,n){GF(t,e),e.set(t,n)}function GF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mr(t,e,n){return t.set(Gs(t,e),n),n}function he(t,e){return t.get(Gs(t,e))}function Gs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnMove");ie.getSingleton().register("afterColumnMove");const hS="manualColumnMove",gse=120,MH="ht__manualColumnMove",op="show-ui",LR="on-moving--columns",$R="after-selection--columns";var Yn=new WeakMap,Ks=new WeakMap,ls=new WeakMap,wm=new WeakMap,ra=new WeakMap,zn=new WeakMap,Eg=new WeakMap,Xr=new WeakMap,Fu=new WeakMap,sp=new WeakMap,id=new WeakMap,Ka=new WeakSet;class mse extends Je{constructor(){super(...arguments),fse(this,Ka),bi(this,Yn,new cse(this.hot)),bi(this,Ks,new dse(this.hot)),bi(this,ls,[]),bi(this,wm,0),bi(this,ra,!1),bi(this,zn,{}),bi(this,Eg,void 0),bi(this,Xr,void 0),bi(this,Fu,void 0),bi(this,sp,void 0),bi(this,id,void 0)}static get PLUGIN_KEY(){return hS}static get PLUGIN_PRIORITY(){return gse}isEnabled(){return!!this.hot.getSettings()[hS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Gs(Ka,e,pse).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Gs(Ka,e,vse).call(e,...r)}),this.addHook("afterScrollVertically",()=>Gs(Ka,this,yse).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Gs(Ka,e,bse).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,MH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,MH),this.unregisterEvents(),he(Yn,this).destroy(),he(Ks,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(Eg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(mr(Eg,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return mr(Eg,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Rr(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[hS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return de(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(Xr,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(Xr,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(Yn,this).getOffset().start,u=he(Yn,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,w=qt(this.hot.rootElement),C=g.innerWidth-he(Fu,this)-w;h=g.innerWidth-he(zn,this).eventPageX-C-(r.scrollX===void 0?i:0)}else h=he(zn,this).eventPageX-(he(Fu,this)-(r.scrollX===void 0?i:0));if(he(sp,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(Xr,this))&&(o+=i),o+=c,he(Xr,this)<0)he(id,this)>0?he(zn,this).col=0:he(zn,this).col=e>0?e-1:e;else if(he(zn,this).TD.offsetWidth/2+o<=h){const g=he(Xr,this)>=he(wm,this)?he(wm,this)-1:he(Xr,this);he(zn,this).col=g+1,o+=he(zn,this).TD.offsetWidth}else he(zn,this).col=he(Xr,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(Xr,this)<he(id,this)&&(f-=he(Fu,this)<=r.scrollX?he(Fu,this):0),he(Yn,this).setPosition(null,d),he(Ks,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Gs(Ka,this,wse).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Gs(Ka,this,Cse).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(Yn,this).build(),he(Ks,this).build()}destroy(){he(Yn,this).destroy(),he(Ks,this).destroy(),super.destroy()}}function pse(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=ye(t.target,"sortAction");if(!s||!o||he(ra,this)||t.button!==0||a){mr(ra,this,!1),he(ls,this).length=0,we(this.hot.rootElement,[LR,op]);return}const l=he(Ks,this).isBuilt()&&!he(Ks,this).isAppended(),u=he(Yn,this).isBuilt()&&!he(Yn,this).isAppended();l&&u&&(he(Ks,this).appendTo(i.hider),he(Yn,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,mr(ra,this,!0);const g=n.firstChild?X2(t,n.firstChild).x:t.offsetX;he(zn,this).eventPageX=t.pageX,mr(Xr,this,e.col),he(zn,this).TD=n,he(zn,this).col=e.col,mr(ls,this,this.prepareColumnsToMoving(d,f)),mr(sp,this,!!this.hot.getSettings().rowHeaders),mr(wm,this,this.hot.countCols()),mr(id,this,this.hot.getSettings().fixedColumnsStart),mr(Fu,this,Dn(this.hot.rootElement).left);const w=he(sp,this)?-1:0,C=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,S=e.col<he(id,this),v=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),P=this.getColumnsWidth(d,e.col-1)+T,x=this.getColumnsWidth(w,d-1)+(S?v:0)+P;he(Yn,this).setPosition(C,x),he(Yn,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-C),he(Yn,this).setOffset(null,-P),X(this.hot.rootElement,LR)}else we(this.hot.rootElement,$R),mr(ra,this,!1),he(ls,this).length=0}function wse(t){he(ra,this)&&(he(zn,this).eventPageX=t.pageX,this.refreshPositions())}function vse(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(ra,this)||(he(ls,this).indexOf(e.col)>-1?we(this.hot.rootElement,op):X(this.hot.rootElement,op),r.row=!0,r.column=!0,r.cell=!0,mr(Xr,this,e.col),he(zn,this).TD=n)}function Cse(){const t=he(zn,this).col,e=he(ls,this).length;if(mr(Xr,this,void 0),mr(ra,this,!1),we(this.hot.rootElement,[LR,op,$R]),this.hot.selection.isSelectedByColumnHeader()&&X(this.hot.rootElement,$R),e<1||t===void 0)return;const n=he(ls,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(ls,this),t);if(he(ls,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function yse(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(Yn,this).setPosition(r),he(Yn,this).setSize(null,t.hider.offsetHeight-r)}function bse(){this.moveBySettingsOrLoad()}function Sse(t,e){qF(t,e),e.add(t)}function In(t,e,n){qF(t,e),e.set(t,n)}function qF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(t,e,n){return t.set(Oi(t,e),n),n}function oe(t,e){return t.get(Oi(t,e))}function Oi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ap="manualColumnResize",Rse=130,IH="manualColumnWidths";var ts=new WeakMap,Tg=new WeakMap,Nr=new WeakMap,lp=new WeakMap,yo=new WeakMap,Ese=new WeakMap,ec=new WeakMap,_g=new WeakMap,lr=new WeakMap,Zo=new WeakMap,xl=new WeakMap,up=new WeakMap,od=new WeakMap,sd=new WeakMap,kr=new WeakMap,ad=new WeakMap,no=new WeakSet;class Tse extends Je{static get PLUGIN_KEY(){return ap}static get PLUGIN_PRIORITY(){return Rse}constructor(e){super(e),Sse(this,no),In(this,ts,null),In(this,Tg,null),In(this,Nr,[]),In(this,lp,null),In(this,yo,null),In(this,Ese,null),In(this,ec,null),In(this,_g,null),In(this,lr,this.hot.rootDocument.createElement("DIV")),In(this,Zo,this.hot.rootDocument.createElement("DIV")),In(this,xl,null),In(this,up,!1),In(this,od,0),In(this,sd,null),In(this,kr,void 0),In(this,ad,void 0),X(oe(lr,this),"manualColumnResizer"),X(oe(Zo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ap]}enablePlugin(){var e=this;this.enabled||(Bt(kr,this,new wa),oe(kr,this).addLocalHook("init",()=>Oi(no,this,_se).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,oe(kr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oi(no,e,Ase).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oi(no,e,Hse).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oi(no,e,Nse).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Bt(ad,this,oe(kr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",IH,oe(kr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",IH,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return oe(kr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);oe(kr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Bt(ts,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(oe(ts,this)),i=r.col;if(i<0)return;const o=rn(oe(ts,this)),s=oe(ts,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(oe(ts,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(oe(ts,this),r.row,r.col)),Bt(Tg,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Bt(Nr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();H(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;de(d,f,g=>{oe(Nr,this).includes(g)||oe(Nr,this).push(g)})})}oe(Nr,this).includes(oe(Tg,this))||Bt(Nr,this,[oe(Tg,this)]),Bt(_g,this,l.start-6),Bt(ec,this,parseInt(s.width,10)),oe(lr,this).style.top=`${l.top}px`,oe(lr,this).style[this.inlineDir]=`${oe(_g,this)+oe(ec,this)}px`,oe(lr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(oe(lr,this))}refreshHandlePosition(){oe(lr,this).style[this.inlineDir]=`${oe(_g,this)+oe(lp,this)}px`}setupGuidePosition(){const e=parseInt(rn(oe(lr,this)),10),n=parseInt(oe(lr,this).style.top,10)+e,r=this.hot.view.getTableHeight();X(oe(lr,this),"active"),X(oe(Zo,this),"active"),oe(Zo,this).style.top=`${n}px`,this.refreshGuidePosition(),oe(Zo,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(oe(Zo,this))}refreshGuidePosition(){oe(Zo,this).style[this.inlineDir]=oe(lr,this).style[this.inlineDir]}hideHandleAndGuide(){we(oe(lr,this),"active"),we(oe(Zo,this),"active")}checkIfColumnHeader(e){const n=El(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",oe(yo,this),r,!0);o!==void 0&&Bt(yo,this,o),this.setManualSize(r,oe(yo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(yo,this),r,!0),i&&e()};oe(od,this)>=2&&(oe(Nr,this).length>1?(H(oe(Nr,this),i=>{n(i)}),e()):H(oe(Nr,this),i=>{n(i,!0)})),Bt(od,this,0),Bt(sd,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Oi(no,this,Mse).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Oi(no,this,Ise).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Oi(no,this,Pse).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Oi(no,this,Ose).call(this)),this.eventManager.addEventListener(oe(lr,this),"contextmenu",()=>Oi(no,this,xse).call(this))}destroy(){super.destroy()}}function _se(){const t=this.hot.getSettings()[ap],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{oe(kr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{oe(kr,this).setValueAtIndex(r,n)})},!0),Bt(ad,this,t)):t===!0&&Array.isArray(oe(ad,this))&&this.hot.batchExecution(()=>{oe(ad,this).forEach((n,r)=>{oe(kr,this).setValueAtIndex(r,n)})},!0)}function Mse(t){if(!kk(t.target)&&oe(up,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(oe(xl,this)||this.setupHandlePosition(e))}}function Ise(t){t.target.parentNode===this.hot.rootElement&&ye(t.target,"manualColumnResizer")&&(this.setupHandlePosition(oe(ts,this)),this.setupGuidePosition(),Bt(xl,this,!0),oe(sd,this)===null&&(Bt(sd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(oe(sd,this))),Bt(od,this,oe(od,this)+1),this.startX=t.pageX,Bt(yo,this,oe(ec,this)))}function Pse(t){if(oe(xl,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Bt(lp,this,oe(ec,this)+e),H(oe(Nr,this),n=>{Bt(yo,this,this.setManualSize(n,oe(lp,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Ose(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",oe(yo,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(yo,this),n,!1)};oe(xl,this)&&(this.hideHandleAndGuide(),Bt(xl,this,!1),oe(yo,this)!==oe(ec,this)&&(oe(Nr,this).length>1?(H(oe(Nr,this),r=>{e(r)}),t()):H(oe(Nr,this),r=>{e(r,!0)})),this.setupHandlePosition(oe(ts,this)))}function xse(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(oe(lr,this)),this.hot.rootElement.removeChild(oe(Zo,this)),Bt(xl,this,!1),Bt(up,this,!0),this.hot._registerImmediate(()=>{Bt(up,this,!1)})}function Ase(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=oe(kr,this).getValueAtIndex(r);this.hot.getSettings()[ap]&&i&&(n=i)}return n}function Hse(t,e){const n=oe(kr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Nse(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function dS(t,e,n){return(e=Dse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dse(t){var e=kse(t,"string");return typeof e=="symbol"?e:e+""}function kse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const fS=0,PH=1,OH=2,Eu="px";let KF=class{constructor(e){dS(this,"hot",void 0),dS(this,"_element",null),dS(this,"state",fS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=OH}build(){this.state===fS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=PH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=fS}isAppended(){return this.state===OH}isBuilt(){return this.state>=PH}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Eu),n!==void 0&&(this._element.style.left=n+Eu)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Eu),n&&(this._element.style.height=n+Eu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Eu),n&&(this._element.style.marginLeft=n+Eu)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Lse="ht__manualRowMove--backlight";class $se extends KF{build(){super.build(),X(this._element,Lse)}}const Fse="ht__manualRowMove--guideline";class Vse extends KF{build(){super.build(),X(this._element,Fse)}}function Wse(t,e){XF(t,e),e.add(t)}function Tu(t,e,n){XF(t,e),e.set(t,n)}function XF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pl(t,e,n){return t.set(qs(t,e),n),n}function Te(t,e){return t.get(qs(t,e))}function qs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeRowMove");ie.getSingleton().register("afterRowMove");const gS="manualRowMove",Bse=140,xH="ht__manualRowMove",cp="show-ui",FR="on-moving--rows",VR="after-selection--rows";var Gn=new WeakMap,Xs=new WeakMap,us=new WeakMap,ia=new WeakMap,wr=new WeakMap,Mg=new WeakMap,Xa=new WeakSet;class jse extends Je{constructor(){super(...arguments),Wse(this,Xa),Tu(this,Gn,new $se(this.hot)),Tu(this,Xs,new Vse(this.hot)),Tu(this,us,[]),Tu(this,ia,void 0),Tu(this,wr,{}),Tu(this,Mg,void 0)}static get PLUGIN_KEY(){return gS}static get PLUGIN_PRIORITY(){return Bse}isEnabled(){return!!this.hot.getSettings()[gS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qs(Xa,e,Use).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qs(Xa,e,Yse).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>qs(Xa,this,qse).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qs(Xa,e,Kse).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,xH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,xH),this.unregisterEvents(),Te(Gn,this).destroy(),Te(Xs,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Te(Mg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(pl(Mg,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return pl(Mg,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Rr(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[gS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return de(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Te(wr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Te(wr,this).TD,a=this.hot.rootElement,l=Dn(a),u=bd(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Te(wr,this).eventPageY-d+c,g=o.hider.offsetHeight,w=o.TBODY.offsetTop,C=Te(Gn,this).getOffset().top,S=Te(Gn,this).getSize().height,v=s.offsetHeight/2,T=s.offsetHeight;let P=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const x=f>=P+v;this.isFixedRowTop(e.row)&&(P+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Te(wr,this).row=n>0?n-1:n:x?(Te(wr,this).row=e.row+1,P+=e.row===0?T-1:T):Te(wr,this).row=e.row;let _=f,M=P;f+S+C>=g?_=g-S-C:f+C<w&&(_=w+Math.abs(C)),P>=g-1&&(M=g-1),Te(Gn,this).setPosition(_),Te(Xs,this).setPosition(M)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>qs(Xa,this,zse).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>qs(Xa,this,Gse).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Te(Gn,this).build(),Te(Xs,this).build()}destroy(){Te(Gn,this).destroy(),Te(Xs,this).destroy(),super.destroy()}}function Use(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Te(ia,this)||t.button!==0){pl(ia,this,!1),Te(us,this).length=0,we(this.hot.rootElement,[FR,cp]);return}const l=Te(Xs,this).isBuilt()&&!Te(Xs,this).isAppended(),u=Te(Gn,this).isBuilt()&&!Te(Gn,this).isAppended();l&&u&&(Te(Xs,this).appendTo(i.hider),Te(Gn,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,pl(ia,this,!0),Te(wr,this).eventPageY=t.pageY,Te(wr,this).coords=e,Te(wr,this).TD=n,pl(us,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),w=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Te(Gn,this).setPosition(null,g),Te(Gn,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),Te(Gn,this).setOffset(-w,null),X(this.hot.rootElement,FR),this.refreshPositions()}else we(this.hot.rootElement,VR),pl(ia,this,!1),Te(us,this).length=0}function zse(t){Te(ia,this)&&(Te(wr,this).eventPageY=t.pageY,this.refreshPositions())}function Yse(t,e,n,r){!this.hot.getSelectedRangeLast()||!Te(ia,this)||(Te(us,this).indexOf(e.row)>-1?we(this.hot.rootElement,cp):X(this.hot.rootElement,cp),r.row=!0,r.column=!0,r.cell=!0,Te(wr,this).coords=e,Te(wr,this).TD=n)}function Gse(){const t=Te(wr,this).row,e=Te(us,this).length;if(pl(ia,this,!1),we(this.hot.rootElement,[FR,cp,VR]),this.hot.selection.isSelectedByRowHeader()&&X(this.hot.rootElement,VR),e<1||t===void 0)return;const n=Te(us,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Te(us,this),t);if(Te(us,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function qse(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Te(Gn,this).setPosition(null,r),Te(Gn,this).setSize(t.hider.offsetWidth-r)}function Kse(){this.moveBySettingsOrLoad()}function Xse(t,e){ZF(t,e),e.add(t)}function Pn(t,e,n){ZF(t,e),e.set(t,n)}function ZF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dt(t,e,n){return t.set(ns(t,e),n),n}function re(t,e){return t.get(ns(t,e))}function ns(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hp="manualRowResize",Zse=30,AH="manualRowHeights";var go=new WeakMap,Ig=new WeakMap,Dr=new WeakMap,ld=new WeakMap,Zs=new WeakMap,__=new WeakMap,tc=new WeakMap,Pg=new WeakMap,jn=new WeakMap,co=new WeakMap,Al=new WeakMap,dp=new WeakMap,ud=new WeakMap,cd=new WeakMap,Ai=new WeakMap,hd=new WeakMap,Fs=new WeakSet;class Jse extends Je{static get PLUGIN_KEY(){return hp}static get PLUGIN_PRIORITY(){return Zse}constructor(e){super(e),Xse(this,Fs),Pn(this,go,null),Pn(this,Ig,null),Pn(this,Dr,[]),Pn(this,ld,null),Pn(this,Zs,null),Pn(this,__,null),Pn(this,tc,null),Pn(this,Pg,null),Pn(this,jn,this.hot.rootDocument.createElement("DIV")),Pn(this,co,this.hot.rootDocument.createElement("DIV")),Pn(this,Al,!1),Pn(this,dp,!1),Pn(this,ud,0),Pn(this,cd,null),Pn(this,Ai,void 0),Pn(this,hd,void 0),X(re(jn,this),"manualRowResizer"),X(re(co,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[hp]}enablePlugin(){this.enabled||(Dt(Ai,this,new wa),re(Ai,this).addLocalHook("init",()=>ns(Fs,this,oae).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,re(Ai,this)),this.addHook("modifyRowHeight",(e,n)=>ns(Fs,this,iae).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Dt(hd,this,re(Ai,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",AH,re(Ai,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",AH,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return re(Ai,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return re(ld,this)}setupHandlePosition(e){Dt(go,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(re(go,this)),o=i.row;if(o<0)return;const s=qt(re(go,this)),a=re(go,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(re(go,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(re(go,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(re(go,this),i.row,i.col)),Dt(Ig,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Dt(Dr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();H(d,f=>{const g=f.getTopStartCorner().row,w=f.getBottomStartCorner().row;de(g,w,C=>{re(Dr,this).includes(C)||re(Dr,this).push(C)})})}re(Dr,this).includes(re(Ig,this))||Dt(Dr,this,[re(Ig,this)]),Dt(Pg,this,c.top-6),Dt(tc,this,parseInt(a.height,10)),re(jn,this).style.top=`${re(Pg,this)+re(tc,this)}px`,re(jn,this).style[this.inlineDir]=`${c.start}px`,re(jn,this).style.width=`${s}px`,this.hot.rootElement.appendChild(re(jn,this))}refreshHandlePosition(){re(jn,this).style.top=`${re(Pg,this)+re(ld,this)}px`}setupGuidePosition(){const e=parseInt(qt(re(jn,this)),10),n=parseInt(re(jn,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();X(re(jn,this),"active"),X(re(co,this),"active"),re(co,this).style.top=re(jn,this).style.top,re(co,this).style[this.inlineDir]=`${n}px`,re(co,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(re(co,this))}refreshGuidePosition(){re(co,this).style.top=re(jn,this).style.top}hideHandleAndGuide(){we(re(jn,this),"active"),we(re(co,this),"active")}checkIfRowHeader(e){const n=El(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&re(Zs,this)<n?n:re(Zs,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Dt(Zs,this,o),this.setManualSize(r,re(Zs,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};re(ud,this)>=2&&(re(Dr,this).length>1?(H(re(Dr,this),i=>{n(i)}),e()):H(re(Dr,this),i=>{n(i,!0)})),Dt(ud,this,0),Dt(cd,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>ns(Fs,this,Qse).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>ns(Fs,this,eae).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>ns(Fs,this,tae).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>ns(Fs,this,nae).call(this)),this.eventManager.addEventListener(re(jn,this),"contextmenu",()=>ns(Fs,this,rae).call(this))}destroy(){super.destroy()}}function Qse(t){if(!kk(t.target)&&re(dp,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(re(Al,this)||this.setupHandlePosition(e))}}function eae(t){ye(t.target,"manualRowResizer")&&(this.setupHandlePosition(re(go,this)),this.setupGuidePosition(),Dt(Al,this,!0),re(cd,this)===null&&(Dt(cd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(re(cd,this))),Dt(ud,this,re(ud,this)+1),Dt(__,this,t.pageY),Dt(Zs,this,re(tc,this)))}function tae(t){re(Al,this)&&(Dt(ld,this,re(tc,this)+(t.pageY-re(__,this))),H(re(Dr,this),e=>{Dt(Zs,this,this.setManualSize(e,re(ld,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function nae(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};re(Al,this)&&(this.hideHandleAndGuide(),Dt(Al,this,!1),re(Zs,this)!==re(tc,this)&&(re(Dr,this).length>1?(H(re(Dr,this),r=>{e(r)}),t()):H(re(Dr,this),r=>{e(r,!0)})),this.setupHandlePosition(re(go,this)))}function rae(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(re(jn,this)),this.hot.rootElement.removeChild(re(co,this)),Dt(Al,this,!1),Dt(dp,this,!0),this.hot._registerImmediate(()=>{Dt(dp,this,!1)})}function iae(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=re(Ai,this).getValueAtIndex(r);this.hot.getSettings()[hp]&&i&&(n=i)}return n}function oae(){const t=this.hot.getSettings()[hp],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{re(Ai,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{re(Ai,this).setValueAtIndex(r,n)}),Dt(hd,this,t)):t===!0&&Array.isArray(re(hd,this))&&re(hd,this).forEach((n,r)=>{re(Ai,this).setValueAtIndex(r,n)})},!0)}var HH={},NH;function sae(){if(NH)return HH;NH=1;var t=qp();return t("flatMap"),HH}sae();var DH={},kH={},mS,LH;function aae(){if(LH)return mS;LH=1;var t=an(),e=un(),n=Io(),r=uE();return mS=function(i,o){(!o||typeof i!="string")&&e(i);var s=r(i);return n(e(s!==void 0?t(s,i):i))},mS}var $H;function lae(){if($H)return kH;$H=1;var t=pt(),e=an(),n=br(),r=un(),i=Io(),o=aae(),s=dE(),a=Sr(),l=da(),u=fE(),c=ga(),h=!l&&!u("flatMap",function(){}),d=!l&&!h&&c("flatMap",TypeError),f=l||h||d,g=s(function(){for(var w=this.iterator,C=this.mapper,S,v;;){if(v=this.inner)try{if(S=r(e(v.next,v.iterator)),!S.done)return S.value;this.inner=null}catch(T){a(w,"throw",T)}if(S=r(e(this.next,w)),this.done=!!S.done)return;try{this.inner=o(C(S.value,this.counter++),!1)}catch(T){a(w,"throw",T)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(C){r(this);try{n(C)}catch(S){a(this,"throw",S)}return d?e(d,this,C):new g(i(this),{mapper:C,inner:null})}}),kH}var FH;function uae(){return FH||(FH=1,lae()),DH}uae();function cae(t,e,n){hae(t,e),e.set(t,n)}function hae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Za(t,e,n){return(e=dae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dae(t){var e=fae(t,"string");return typeof e=="symbol"?e:e+""}function fae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VH(t,e){return t.get(JF(t,e))}function Og(t,e,n){return t.set(JF(t,e),n),n}function JF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ja=new WeakMap;class mo{constructor(e,n,r,i,o,s){Za(this,"row",void 0),Za(this,"col",void 0),Za(this,"rowspan",void 0),Za(this,"colspan",void 0),Za(this,"removed",!1),Za(this,"cellCoordsFactory",void 0),Za(this,"cellRangeFactory",void 0),cae(this,Ja,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return it`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),Og(Ja,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,Og(Ja,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return Og(Ja,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return VH(Ja,this)||Og(Ja,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),VH(Ja,this)}}function gae(t,e){mae(t,e),e.add(t)}function mae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xg(t,e,n){return(e=pae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pae(t){var e=wae(t,"string");return typeof e=="symbol"?e:e+""}function wae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vs=new WeakSet;class fp{constructor(e){gae(this,Vs),xg(this,"plugin",void 0),xg(this,"mergedCells",[]),xg(this,"mergedCellsMatrix",new Map),xg(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){Ze(fp.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new mo(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Qa(Vs,this,WH).call(this,a),a):(u&&Ze(fp.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Qa(Vs,this,vae).call(this,r),r):!1}clear(){H(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;de(n,n+i,s=>{de(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=ze(u,i,i+s-1),d=ze(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Qa(Vs,this,Ag).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Qa(Vs,this,Ag).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Qa(Vs,this,Ag).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Qa(Vs,this,Ag).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Qa(Vs,this,WH).call(this,s)})}}function Ag(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function WH(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function vae(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function pS(t,e,n){return(e=Cae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cae(t){var e=yae(t,"string");return typeof e=="symbol"?e:e+""}function yae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bae{constructor(e){pS(this,"plugin",void 0),pS(this,"mergedCellsCollection",void 0),pS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,w=this.getFarthestCollection(e,n,r,i);if(w){if(r==="down"){const C=w.row+w.rowspan-a-g;o[2]+C>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?C:0}else if(r==="right"){const C=w.col+w.colspan-l-g;o[3]+C>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?C:0}else if(r==="up"){const C=u-g-w.row+1;o[0]+C<0?o[0]+=g:o[0]-=g?C:0}else if(r==="left"){const C=c-g-w.col+1;o[1]+C<0?o[1]+=g:o[1]-=g?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),on(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,w=d-g;let C=null,S=null,v=null;switch(r){case"up":C="includesVertically",v=c-w+1;break;case"left":C="includesHorizontally",v=c-w+1;break;case"down":C="includesVertically",v=h+w-1;break;case"right":C="includesHorizontally",v=h+w-1;break}return H(i,T=>{T[C](v)&&T.isFarther(S,r)&&(S=T)}),S}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return H(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:w}=g;return w===h.getWidth()}):!f.every(g=>{let{rowspan:w}=g;return w===h.getHeight()})}}function wS(t,e,n){return(e=Sae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sae(t){var e=Rae(t,"string");return typeof e=="symbol"?e:e+""}function Rae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eae{constructor(e){wS(this,"plugin",void 0),wS(this,"hot",void 0),wS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function Tae(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(k0)}return this.getTranslatedPhrase(D0)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?mo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function dd(t,e,n){return(e=_ae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ae(t){var e=Mae(t,"string");return typeof e=="symbol"?e:e+""}function Mae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BH{constructor(e){dd(this,"data",void 0),dd(this,"next",null),dd(this,"prev",null),this.data=e}}class Hg{constructor(){dd(this,"first",null),dd(this,"last",null)}push(e){const n=new BH(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new BH(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function Iae(t,e){QF(t,e),e.add(t)}function el(t,e,n){QF(t,e),e.set(t,n)}function QF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(t,e){return t.get(gp(t,e))}function _r(t,e,n){return t.set(gp(t,e),n),n}function gp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ro=new WeakMap,io=new WeakMap,oo=new WeakMap,so=new WeakMap,WR=new WeakMap,Ng=new WeakMap,Dg=new WeakMap,vS=new WeakSet;class Pae{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;Iae(this,vS),el(this,ro,new Hg),el(this,io,new Hg),el(this,oo,null),el(this,so,null),el(this,WR,null),el(this,Ng,null),el(this,Dg,null),_r(WR,this,n),_r(Ng,this,r),_r(Dg,this,i)}getCurrentVerticalNode(){return rt(so,this).data}getFirstVerticalNode(){return rt(io,this).first.data}getNextVerticalNode(){return rt(so,this).next.data}getPrevVerticalNode(){return rt(so,this).prev.data}getCurrentHorizontalNode(){return rt(oo,this).data}getFirstHorizontalNode(){return rt(ro,this).first.data}getNextHorizontalNode(){return rt(oo,this).next.data}getPrevHorizontalNode(){return rt(oo,this).prev.data}setPrevNodeAsActive(){_r(so,this,rt(so,this).prev),_r(oo,this,rt(oo,this).prev)}setNextNodeAsActive(){_r(so,this,rt(so,this).next),_r(oo,this,rt(oo,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;_r(ro,this,new Hg);for(let s=n.row;s<=r.row;s++)if(!rt(Ng,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(rt(Dg,this).isHidden(a))continue;const l=gp(vS,this,jH).call(this,e,rt(ro,this),i,s,a);l&&_r(oo,this,l)}rt(ro,this).first&&(rt(ro,this).first.prev=rt(ro,this).last,rt(ro,this).last.next=rt(ro,this).first);const o=new WeakSet;_r(io,this,new Hg);for(let s=n.col;s<=r.col;s++)if(!rt(Dg,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(rt(Ng,this).isHidden(a))continue;const l=gp(vS,this,jH).call(this,e,rt(io,this),o,a,s);l&&_r(so,this,l)}rt(io,this).first&&(rt(io,this).first.prev=rt(io,this).last,rt(io,this).last.next=rt(io,this).first)}setActiveNode(e,n){return rt(ro,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return _r(oo,this,r),!1}),rt(io,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return _r(so,this,r),!1}),this}}function jH(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=rt(WR,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function eV(t,e,n){const{rowIndexMapper:r,stylesHandler:i}=t,o=i.getDefaultRowHeight();let s=0;for(let l=e;l<e+n;l++)if(!r.isHidden(l)){var a;s+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:o,l===0&&!i.isClassicTheme()&&(s+=1)}return s}function Oae(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!Ne(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),yd()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[w,C]=t.translateMergedCellToRenderable(h,g,d,f),S=t.getSetting("virtualized");if(yd()&&d===0&&!e.getSettings().rowHeaders){const O=eV(e,h,g);i.set(l,O/g)}const v=n.getRenderableFromVisualIndex(l),T=r.getRenderableFromVisualIndex(u),P=w-v+1,x=C-T+1;let _=n.getNearestNotHiddenIndex(h,1),M=r.getNearestNotHiddenIndex(d,1);if(S){const O=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(O)||(_=Math.max(_,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(O)||(M=Math.max(M,e.getFirstRenderedVisibleColumn()))}const V=Math.min(g,P),Y=Math.min(f,x);_===l&&M===u?(a.setAttribute("rowspan",V),a.setAttribute("colspan",Y)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function xae(t,e){tV(t,e),e.add(t)}function kg(t,e,n){tV(t,e),e.set(t,n)}function tV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CS(t,e,n){return(e=Aae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aae(t){var e=Hae(t,"string");return typeof e=="symbol"?e:e+""}function Hae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nd(t,e,n){return t.set(st(t,e),n),n}function mt(t,e){return t.get(st(t,e))}function st(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeMergeCells");ie.getSingleton().register("afterMergeCells");ie.getSingleton().register("beforeUnmergeCells");ie.getSingleton().register("afterUnmergeCells");const BR="mergeCells",Nae=150,UH=BR;var ii=new WeakMap,oi=new WeakMap,bo=new WeakMap,zH=new WeakMap,ht=new WeakSet;class Dae extends Je{constructor(){super(...arguments),xae(this,ht),CS(this,"mergedCellsCollection",null),CS(this,"autofillCalculations",null),CS(this,"selectionCalculations",null),kg(this,ii,null),kg(this,oi,{row:0,col:0}),kg(this,bo,new Pae({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),kg(this,zH,Oae(this))}static get PLUGIN_KEY(){return BR}static get PLUGIN_PRIORITY(){return Nae}static get DEFAULT_SETTINGS(){return{[y$]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[BR]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new fp(this),this.autofillCalculations=new bae(this),this.selectionCalculations=new Eae(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,kae).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,$ae).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Fae).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Vae).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Wae).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,GH).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,GH).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,jae).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Uae).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,zae).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,YH).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,YH).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Lae).call(e,...r)}),this.addHook("afterRenderer",function(){return mt(zH,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Bae).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Yae).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Gae).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,qae).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Kae).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Xae).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Zae).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Jae).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Qae).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,ele).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,tle).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,nle).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,rle).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,ile).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,ole).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!Sk())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>o?.name==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Dm(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Dm(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?mo.containsNegativeValues(e)?(Ze(mo.NEGATIVE_VALUES_WARNING(e)),!1):mo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ze(mo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):mo.isSingleCell(e)?(Ze(mo.IS_SINGLE_CELL(e)),!1):mo.containsZeroSpan(e)?(Ze(mo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),de(0,s.rowspan-1,c=>{de(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),H(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),de(0,i.rowspan-1,o=>{de(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:UH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(UH)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ne(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ne(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ne(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ne(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function kae(){this.generateFromSettings(),this.hot.render()}function Lae(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function $ae(t){mt(oi,this).row=t.row,mt(oi,this).col=t.col}function Fae(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;mt(ii,this)&&(i.getRenderableFromVisualIndex(mt(ii,this).row)!==null&&(n.row=mt(ii,this).row),r.getRenderableFromVisualIndex(mt(ii,this).col)!==null&&(n.col=mt(ii,this).col),Nd(ii,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Vae(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Wae(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Nd(ii,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Nd(ii,this,e.clone()),n&&e.assign(n)}function YH(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),w=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[ze(g,u,h),ze(w,c,d),ze(this.hot.getLastRenderedVisibleRow(),u,h),ze(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Bae(t){t.items.push({name:"---------"},Tae(this))}function GH(){Nd(ii,this,null)}function jae(){if(mt(ii,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=mt(ii,this).clone().normalize();mt(bo,this).setActiveNode(r.row,r.col),mt(oi,this).row>0||mt(oi,this).col>0?mt(bo,this).setPrevNodeAsActive():(n==="E-W"&&mt(oi,this).col<0||e==="S-N"&&mt(oi,this).row<0)&&mt(bo,this).setNextNodeAsActive()}function Uae(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(mt(oi,this).col<0){const{rowEnd:a,colEnd:l}=mt(bo,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(mt(oi,this).col>0){const{rowStart:a,colStart:l}=mt(bo,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(mt(oi,this).row<0){const{rowEnd:a,colEnd:l}=mt(bo,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(mt(oi,this).row>0){const{rowStart:a,colStart:l}=mt(bo,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}mt(bo,this).setActiveNode(t,e),Nd(oi,this,{row:0,col:0})}function zae(){this.hot.getSelectedRangeLast().isHeader()||mt(bo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Yae(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Gae(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function qae(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Kae(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function Xae(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Zae(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Jae(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Qae(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function ele(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function tle(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);H(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function nle(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function rle(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function ile(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function ole(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,eV(this.hot,e,g))}),t}function sle(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:x$(u.type))(l,u,d)(c,h);if(g===Eo){const w=a+1;if(typeof e[w]<"u")return s(w)}return g}(0)}}const nV="sort";function ale(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${nV}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function lle(t){const e=t.className.split(" "),n=new RegExp(`^${nV}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function ule(t,e,n){return(e=cle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cle(t){var e=hle(t,"string");return typeof e=="symbol"?e:e+""}function hle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mp="multiColumnSorting",dle=170,qH=mp;O$(mp,sle);class fle extends V${constructor(){super(...arguments),ule(this,"pluginKey",mp)}static get PLUGIN_KEY(){return mp}static get PLUGIN_PRIORITY(){return dle}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Xm)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:va,position:"before",group:qH})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(qH)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),we(e,lle(e)),this.enabled!==!1&&X(e,ale(...r))}onAfterOnCellMouseDown(e,n){d_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Xm))):this.sort(this.getColumnNextConfig(n.col)))}}function KH(t,e,n){return(e=gle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gle(t){var e=mle(t,"string");return typeof e=="symbol"?e:e+""}function mle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ple="multipleSelectionHandles",wle=160;class vle extends Je{constructor(){super(...arguments),KH(this,"dragged",[]),KH(this,"lastSetCell",null)}static get PLUGIN_KEY(){return ple}static get PLUGIN_PRIORITY(){return wle}isEnabled(){return So()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(ye(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(ye(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(ye(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(ye(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function jR(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function rV(){return{label:"",isPlaceholder:!0}}function Cle(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;H(t,i=>{const o=[];let s=0;n.push(o),H(i,a=>{const l=jR();if(Ne(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Ot(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Ot(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(rV());return!u})});const r=Math.max(...je(n,i=>i.length));return H(n,i=>{if(i.length<r){const o=je(new Array(r-i.length),()=>jR());i.splice(i.length,0,...o)}}),n}function yS(t,e,n){yle(t,e),e.set(t,n)}function yle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Si(t,e){return t.get(iV(t,e))}function Mh(t,e,n){return t.set(iV(t,e),n),n}function iV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const XH=["label","collapsible"];var Yo=new WeakMap,tl=new WeakMap,bS=new WeakMap;class ble{constructor(){yS(this,Yo,[]),yS(this,tl,0),yS(this,bS,1/0)}setColumnsLimit(e){Mh(bS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Mh(Yo,this,Cle(e,Si(bS,this))),Mh(tl,this,Si(Yo,this).length)}getData(){return Si(Yo,this)}mergeWith(e){H(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&on(s,o,XH)})}map(e){H(Si(Yo,this),n=>{H(n,r=>{const i=e({...r});Ne(i)&&on(r,i,XH)})})}getHeaderSettings(e,n){var r;if(e>=Si(tl,this)||e<0)return null;const i=Si(Yo,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Si(tl,this)||e<0)return i;const o=Si(Yo,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Si(tl,this)}getColumnsCount(){return Si(tl,this)>0?Si(Yo,this)[0].length:0}clear(){Mh(Yo,this,[]),Mh(tl,this,0)}}function SS(t,e,n){return(e=Sle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sle(t){var e=Rle(t,"string");return typeof e=="symbol"?e:e+""}function Rle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oV="DF-pre-order";function sV(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=sV.call(this.childs[r],t,e)}return n}const Ele="DF-post-order";function aV(t,e){for(let n=0;n<this.childs.length;n++)if(aV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const lV="BF";function Tle(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const _le=lV,ZH=new Map([[oV,sV],[Ele,aV],[lV,Tle]]);class pp{constructor(e){SS(this,"data",{}),SS(this,"parent",null),SS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new pp({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_le;if(!ZH.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);ZH.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function RS(t,e,n){Mle(t,e),e.set(t,n)}function Mle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bn(t,e){return t.get(uV(t,e))}function Ile(t,e,n){return t.set(uV(t,e),n),n}function uV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _u=new WeakMap,nl=new WeakMap,Mu=new WeakMap;class Ple{constructor(e){RS(this,_u,new Map),RS(this,nl,new Map),RS(this,Mu,null),Ile(Mu,this,e)}getRoots(){return Array.from(Bn(_u,this).values())}getRootByColumn(e){let n;return Bn(nl,this).has(e)&&(n=Bn(_u,this).get(Bn(nl,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Bn(nl,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Bn(nl,this).clear(),H(Bn(_u,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Bn(nl,this).set(i,e);e+=r})}buildTree(){this.clear();const e=Bn(Mu,this).getColumnsCount();let n=0;for(;n<e;){const r=Bn(Mu,this).getHeaderSettings(0,n),i=new pp;Bn(_u,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Bn(Mu,this).getHeadersSettings(r,n,i);r+=1,H(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new pp(a),e.addChild(l)),r<Bn(Mu,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Bn(_u,this).clear(),Bn(nl,this).clear()}}function cV(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function wp(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function vp(t){return wp(t,"origColspan")===t.data.origColspan}function M_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(vp(t))return M_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)H(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,cV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):vp(a)&&(l.isCollapsed=wp(a,"isCollapsed"))}),{rollbackModification:()=>I_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function I_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(vp(t))return I_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)H(o,l=>{cV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=wp(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):vp(l)&&(u.isCollapsed=wp(l,"isCollapsed"))}),{rollbackModification:()=>M_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function Ole(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(it`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function xle(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(it`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const JH=new Map([["collapse",I_],["expand",M_],["hide-column",Ole],["show-column",xle]]);function Ale(t,e,n){if(!JH.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return JH.get(t)(e,n)}function Lg(t){const e=[];return H(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=Nle(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(rV());else{const f=Hle(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function Hle(t){const{crossHiddenColumns:e,...n}=jR(t);return n}function Nle(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function ES(t,e,n){Dle(t,e),e.set(t,n)}function Dle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ih(t,e,n){return t.set(hV(t,e),n),n}function At(t,e){return t.get(hV(t,e))}function hV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ao=new WeakMap,ar=new WeakMap,rl=new WeakMap;class kle{constructor(){ES(this,ao,new ble),ES(this,ar,new Ple(At(ao,this))),ES(this,rl,[[]])}setState(e){At(ao,this).setData(e);let n=!1;try{At(ar,this).buildTree()}catch{At(ar,this).clear(),At(ao,this).clear(),n=!0}return Ih(rl,this,Lg(At(ar,this).getRoots())),n}setColumnsLimit(e){At(ao,this).setColumnsLimit(e)}mergeStateWith(e){const n=je(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});At(ao,this).mergeWith(n),At(ar,this).buildTree(),Ih(rl,this,Lg(At(ar,this).getRoots()))}mapState(e){At(ao,this).map(e),At(ar,this).buildTree(),Ih(rl,this,Lg(At(ar,this).getRoots()))}mapNodes(e){return Rr(At(ar,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=At(ar,this).getNode(n,r);let o;return i&&(o=Ale(e,i,r),Ih(rl,this,Lg(At(ar,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=At(rl,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=At(ar,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=At(ar,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},oV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return At(ao,this).getLayersCount()}getColumnsCount(){return At(ao,this).getColumnsCount()}clear(){Ih(rl,this,[]),At(ao,this).clear(),At(ar,this).clear()}}function Ph(t,e,n){return(e=Lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lle(t){var e=$le(t,"string");return typeof e=="symbol"?e:e+""}function $le(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fle{constructor(e,n){Ph(this,"hot",void 0),Ph(this,"nestedHeaderSettingsGetter",void 0),Ph(this,"layersCount",0),Ph(this,"container",void 0),Ph(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),bc(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function Vle(t,e){dV(t,e),e.add(t)}function QH(t,e,n){return(e=Wle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wle(t){var e=Ble(t,"string");return typeof e=="symbol"?e:e+""}function Ble(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oh(t,e,n){dV(t,e),e.set(t,n)}function dV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cs(t,e,n){return t.set(Ht(t,e),n),n}function $e(t,e){return t.get(Ht(t,e))}function Ht(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eN="nestedHeaders",jle=280;var lt=new WeakMap,Ws=new WeakMap,fd=new WeakMap,Rw=new WeakMap,Cp=new WeakMap,Ft=new WeakSet;class Ule extends Je{constructor(){super(...arguments),Vle(this,Ft),Oh(this,lt,new kle),Oh(this,Ws,null),Oh(this,fd,null),Oh(this,Rw,!1),Oh(this,Cp,null),QH(this,"ghostTable",new Fle(this.hot,(e,n)=>this.getHeaderSettings(e,n))),QH(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return eN}static get PLUGIN_PRIORITY(){return jle}isEnabled(){return!!this.hot.getSettings()[eN]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Ze(it`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Ht(Ft,this,sue).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,aue).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,qle).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Kle).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Xle).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Zle).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Jle).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Qle).call(e,...i)}),this.addHook("afterSelection",()=>Ht(Ft,this,$g).call(this)),this.addHook("afterSelectionFocusSet",()=>Ht(Ft,this,$g).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,zle).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Ht(Ft,this,tue).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,rue).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,iue).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Yle).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Gle).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,eue).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,nue).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,oue).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Ht(Ft,this,$g).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Ht(Ft,this,$g).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();$e(lt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=$e(lt,this).setState(e)),this.detectedOverlappedHeaders&&Ze(it`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";$e(lt,this).triggerColumnModification(i,r)}),!$e(Ws,this)&&this.enabled&&cs(Ws,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";$e(lt,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),$e(lt,this).clear(),$e(Ws,this).unsubscribe(),cs(Ws,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return $e(lt,this)}getLayersCount(){return $e(lt,this).getLayersCount()}getHeaderSettings(e,n){return $e(lt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),we(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),we(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),we(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),we(o,"hiddenHeader"),we(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=$e(lt,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)X(o,"hiddenHeader");else if(c>1){var g,w,C;const{wtOverlays:S}=l._wt,v=(g=S.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),T=(w=S.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o);((C=S.topOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o))&&u<r&&X(o,"hiddenHeaderText");const x=v||T?Math.min(c,r-i):c;x>1&&o.setAttribute("colspan",x)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const S=o.querySelector("div.relative");S&&f&&f.length>0&&(we(S,this.hot.getColumnMeta(u).headerClassName),X(S,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=$e(lt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){cs(lt,this,null),$e(Ws,this)!==null&&($e(Ws,this).unsubscribe(),cs(Ws,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return $e(lt,this).getHeaderTreeNodeData(e.row,e.col)}}function $g(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=$e(lt,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function zle(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=$e(Cp,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(cs(Cp,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=$e(lt,this).findLeftMostColumnIndex(a,l),g=$e(lt,this).findRightMostColumnIndex(a,l),w=g-f+1;if(f<c&&g>h)return f;if(s){let C=null;return f>=c&&g>h?w>d?(e.value="start",C=f):(e.value="end",C=g):f<c&&g<=h&&(w>d?(e.value="end",C=g):(e.value="start",C=f)),C}return f<=c?f:g}function Yle(t,e,n){const r=$e(lt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=$e(lt,this).getHeaderSettings(e,t);if(o===n0){if(!a)return r.columnIndex}else if(o===cL&&(l>s-i||!a))return null;return t}function Gle(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,w=d-a;if(w===0)continue;((i=$e(lt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][w]="")}}}function qle(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Kle(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;cs(fd,this,e.clone()),cs(Rw,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(zE(t)||_l(t)&&l||K2(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Xle(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=ze(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function Zle(){cs(Rw,this,!1)}function Jle(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!$e(Rw,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=$e(lt,this).getHeaderTreeNodeData($e(fd,this).row,$e(fd,this).col);if(e.setHighlight($e(fd,this)),o>e.getWidth()||i<n||i+o-1>r){const s=$e(lt,this).findTopMostEntireHeaderLevel(ze(n,i,i+o-1),ze(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Qle(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=$e(lt,this).findLeftMostColumnIndex(n.row,n.col),o=$e(lt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function eue(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});cs(Cp,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function tue(t){if($e(lt,this).getLayersCount()>0){t.length=0;for(let e=0;e<$e(lt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function nue(t){const e=$e(lt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=$e(lt,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),qn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?$e(lt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function rue(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function iue(t,e,n){var r;const{label:i}=(r=$e(lt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function oue(t,e){if(t<0)return this.hot.getCell(t,$e(lt,this).findLeftMostColumnIndex(t,e),!0)}function sue(){this.updatePlugin()}function aue(t,e){e||this.updatePlugin()}function xh(t,e,n){return(e=lue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lue(t){var e=uue(t,"string");return typeof e=="symbol"?e:e+""}function uue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cue{constructor(e,n){xh(this,"hot",void 0),xh(this,"data",null),xh(this,"plugin",void 0),xh(this,"parentReference",new WeakMap),xh(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},de(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&H(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&H(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return De(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(H(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(de(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),de(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];H(r,o=>{i.push(this.getDataObject(o))}),H(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function tN(t,e,n){return(e=hue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hue(t){var e=due(t,"string");return typeof e=="symbol"?e:e+""}function due(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P_{constructor(e,n){tN(this,"hot",void 0),tN(this,"plugin",void 0),this.hot=n,this.plugin=e}}class wo extends P_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(H(l,c=>{c&&s.removeChild(c)}),X(n,wo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",de(0,i-1,()=>{const d=c.createElement("SPAN");X(d,wo.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Ce(c,[Vl()]),X(n,wo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(X(c,`${wo.CSS_CLASSES.button} ${wo.CSS_CLASSES.expandButton}`),u&&Ce(n,[si(!1)])):(X(c,`${wo.CSS_CLASSES.button} ${wo.CSS_CLASSES.collapseButton}`),u&&Ce(n,[si(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let r=11;this.hot.stylesHandler.isClassicTheme()||(r=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}class fue extends P_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),H(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{de(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&H(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];H(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return H(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);H(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return H(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);H(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&H(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];H(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];H(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];H(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{H(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{H(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&H(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);ye(e.target,wo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),ji(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function gue(t,e,n){mue(t,e),e.set(t,n)}function mue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pue(t,e,n){return(e=wue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wue(t){var e=vue(t,"string");return typeof e=="symbol"?e:e+""}function vue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cue(t,e){return t.get(yue(t,e))}function yue(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nN=new WeakMap;class bue extends P_{constructor(){super(...arguments),pue(this,"dataManager",this.plugin.dataManager),gue(this,nN,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(tT)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(nT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return de(0,e.items.length-1,r=>{if(r===0)return H(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return de(0,e.items.length-1,n=>{const r=Cue(nN,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function Fg(t,e,n){return(e=Sue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sue(t){var e=Rue(t,"string");return typeof e=="symbol"?e:e+""}function Rue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eue{constructor(e){Fg(this,"plugin",void 0),Fg(this,"hot",void 0),Fg(this,"dataManager",void 0),Fg(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const w=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(w,a),w}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Pt(i)&&(Ze(it`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Tue(t,e){fV(t,e),e.add(t)}function rN(t,e,n){fV(t,e),e.set(t,n)}function fV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TS(t,e,n){return(e=_ue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ue(t){var e=Mue(t,"string");return typeof e=="symbol"?e:e+""}function Mue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vm(t,e){return t.get(gn(t,e))}function yp(t,e,n){return t.set(gn(t,e),n),n}function gn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bp="nestedRows",Iue=300,iN=bp,Pue="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Ew=new WeakMap,Iu=new WeakMap,Cn=new WeakSet;class Oue extends Je{constructor(){super(...arguments),Tue(this,Cn),TS(this,"dataManager",null),TS(this,"headersUI",null),TS(this,"collapsedRowsMap",null),rN(this,Ew,!1),rN(this,Iu,!1)}static get PLUGIN_KEY(){return bp}static get PLUGIN_PRIORITY(){return Iue}isEnabled(){return!!this.hot.getSettings()[bp]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Qd),this.dataManager=new cue(this,this.hot),this.collapsingUI=new fue(this,this.hot),this.headersUI=new wo(this,this.hot),this.contextMenuUI=new bue(this,this.hot),this.rowMoveController=new Eue(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,Uue).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,zue).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,Hue).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,Nue).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,Due).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,Aue).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,$ue).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,Lue).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,Fue).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,Vue).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,Wue).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,Bue).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,kue).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,jue).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gn(Cn,e,xue).call(e,...r)}),this.addHook("beforeLoadData",n=>gn(Cn,this,oN).call(this,n)),this.addHook("beforeUpdateData",n=>gn(Cn,this,oN).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:iN,relativeToGroup:va,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iN)}disableCoreAPIModifiers(){yp(Iu,this,!0)}enableCoreAPIModifiers(){yp(Iu,this,!1)}onModifyRowData(e){if(!vm(Iu,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!vm(Iu,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return vm(Iu,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function xue(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Aue(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Hue(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),yp(Ew,this,!0),this.dataManager.getData().slice()}function Nue(t){return this.contextMenuUI.appendOptions(t)}function Due(t,e){this.headersUI.appendLevelIndicators(t,e)}function kue(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Lue(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{yp(Ew,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function $ue(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Fue(){this.collapsingUI.collapsedRowsStash.stash()}function Vue(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Wue(){this.collapsingUI.collapsedRowsStash.stash()}function Bue(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function jue(){this.dataManager.rewriteCache()}function Uue(){this.headersUI.updateRowHeaderWidth()}function zue(t,e){vm(Ew,this)&&(e.skipRender=!0)}function oN(t){if(!r4(t)){YE(Pue),this.hot.getSettings()[bp]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function _S(t,e,n){return(e=Yue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yue(t){var e=Gue(t,"string");return typeof e=="symbol"?e:e+""}function Gue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class que{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;_S(this,"rootWindow",void 0),_S(this,"prefix",void 0),_S(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){H(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Kue(t,e,n){return(e=Xue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xue(t){var e=Zue(t,"string");return typeof e=="symbol"?e:e+""}function Zue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ie.getSingleton().register("persistentStateSave");ie.getSingleton().register("persistentStateLoad");ie.getSingleton().register("persistentStateReset");const sN="persistentState",Jue=0;class Que extends Je{constructor(){super(...arguments),Kue(this,"storage",void 0)}static get PLUGIN_KEY(){return sN}static get PLUGIN_PRIORITY(){return Jue}isEnabled(){return!!this.hot.getSettings()[sN]}enablePlugin(){this.enabled||(this.storage||(this.storage=new que(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function ece(t,e){tce(t,e),e.add(t)}function tce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MS(t,e,n){return(e=nce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nce(t){var e=rce(t,"string");return typeof e=="symbol"?e:e+""}function rce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const IS="search",ice=190,oce="htSearchResult",sce=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},ace=function(t,e,n){return Pt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Pt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var PS=new WeakSet;class lce extends Je{constructor(){super(...arguments),ece(this,PS),MS(this,"callback",sce),MS(this,"queryMethod",ace),MS(this,"searchResultClass",oce)}static get PLUGIN_KEY(){return IS}static get PLUGIN_PRIORITY(){return ice}isEnabled(){return this.hot.getSettings()[IS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[IS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return aN(PS,e,lN).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return aN(PS,e,lN).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return de(0,i-1,l=>{de(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const w={row:l,col:u,data:c};s.push(w)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ne(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function lN(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Vg(t,e,n){return(e=uce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uce(t){var e=cce(t,"string");return typeof e=="symbol"?e:e+""}function cce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gV{constructor(e){Vg(this,"viewportWidth",void 0),Vg(this,"overwriteColumnWidthFn",void 0),Vg(this,"baseWidths",new Map),Vg(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class hce extends gV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=sc?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=sc){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,w=g;o.includes(f)||(w=Math.round(g*l)),this.stretchedWidths.set(f,w),u=f,d<i.length-1&&(c+=w)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function uN(t,e,n){dce(t,e),e.set(t,n)}function dce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OS(t,e){return t.get(mV(t,e))}function Wg(t,e,n){return t.set(mV(t,e),n),n}function mV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bg=new WeakMap,Ah=new WeakMap;class fce extends gV{constructor(){super(...arguments),uN(this,Bg,0),uN(this,Ah,-1)}prepare(e){super.prepare(e),Wg(Bg,this,0),Wg(Ah,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),Wg(Ah,this,e),Wg(Bg,this,n)}calculate(){if(OS(Ah,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+OS(Bg,this),0);this.stretchedWidths.set(OS(Ah,this),n)}}function gce(t,e){pV(t,e),e.add(t)}function jg(t,e,n){pV(t,e),e.set(t,n)}function pV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e){return t.get(Yu(t,e))}function xS(t,e,n){return t.set(Yu(t,e),n),n}function Yu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mce="stretchColumns";var An=new WeakMap,Pu=new WeakMap,AS=new WeakMap,Ug=new WeakMap,Hh=new WeakSet;class pce{constructor(e){gce(this,Hh),jg(this,An,void 0),jg(this,Pu,void 0),jg(this,AS,new Map([["all",new hce(Yu(Hh,this,cN).bind(this))],["last",new fce(Yu(Hh,this,cN).bind(this))]])),jg(this,Ug,"none"),xS(An,this,e),xS(Pu,this,Vt(An,this).columnIndexMapper.createAndRegisterIndexMap(mce,"physicalIndexToValue"))}useStrategy(e){xS(Ug,this,Vt(AS,this).has(e)?e:"none")}refreshStretching(){if(Vt(Ug,this)==="none"){Vt(Pu,this).clear();return}Vt(An,this).batchExecution(()=>{Vt(Pu,this).clear();const e=Vt(AS,this).get(Vt(Ug,this));let r=Vt(An,this).view.getViewportWidth();Yu(Hh,this,wce).call(this)&&(r-=bn(Vt(An,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Vt(An,this).countCols();i++)Vt(An,this).columnIndexMapper.isHidden(Vt(An,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Yu(Hh,this,vce).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;Vt(Pu,this).setValueAtIndex(Vt(An,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return Vt(Pu,this).getValueAtIndex(Vt(An,this).toPhysicalColumn(e))}}function wce(){const{view:t,stylesHandler:e}=Vt(An,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),r=Vt(An,this).countRows(),i=e.getDefaultRowHeight();let o=0,s=!1;for(let l=0;l<r;l++){var a;if(o+=((a=Vt(An,this).getRowHeight(l))!==null&&a!==void 0?a:i)+(l===0?1:0),o>n){s=!0;break}}return s}function vce(t){var e;return(e=Vt(An,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:sc}function cN(t,e){return Vt(An,this).runHooks("beforeStretchingColumnWidth",t,e)}function Cce(t,e){wV(t,e),e.add(t)}function HS(t,e,n){wV(t,e),e.set(t,n)}function wV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NS(t,e,n){return t.set(Sp(t,e),n),n}function Jo(t,e){return t.get(Sp(t,e))}function Sp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yce="stretchColumns",bce=155;var Vu=new WeakMap,zg=new WeakMap,Nh=new WeakMap,DS=new WeakSet;class Sce extends Je{constructor(){super(...arguments),Cce(this,DS),HS(this,Vu,new pce(this.hot)),HS(this,zg,null),HS(this,Nh,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;Jo(zg,this)!==null&&Jo(zg,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),NS(zg,this,i.width)})})}))}static get PLUGIN_KEY(){return yce}static get PLUGIN_PRIORITY(){return bce}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Jo(Vu,this).useStrategy(this.hot.getSettings().stretchH),Jo(Nh,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sp(DS,e,Ece).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sp(DS,e,Rce).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Jo(Vu,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Jo(Nh,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Jo(Vu,this).getStretchedWidth(e)}destroy(){Jo(Nh,this).disconnect(),NS(Nh,this,null),NS(Vu,this,null),super.destroy()}}function Rce(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function Ece(t){t&&Jo(Vu,this).refreshStretching()}function Tce(t,e){_ce(t,e),e.add(t)}function _ce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yg(t,e,n){return(e=Mce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mce(t){var e=Ice(t,"string");return typeof e=="symbol"?e:e+""}function Ice(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Pce="touchScroll",Oce=200;var Gg=new WeakSet;class xce extends Je{constructor(){super(...arguments),Tce(this,Gg),Yg(this,"scrollbars",[]),Yg(this,"clones",[]),Yg(this,"lockedCollection",!1),Yg(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Pce}static get PLUGIN_PRIORITY(){return Oce}static get SETTING_KEYS(){return!0}isEnabled(){return bk()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>kS(Gg,this,Ace).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>kS(Gg,this,Hce).call(this)),this.addHook("afterMomentumScroll",()=>kS(Gg,this,Nce).call(this))}}function Ace(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Hce(){this.freezeOverlays=!0,H(this.clones,t=>{X(t,"hide-tween")})}function Nce(){this.freezeOverlays=!1,H(this.clones,t=>{we(t,"hide-tween"),X(t,"show-tween")}),this.hot._registerTimeout(()=>{H(this.clones,t=>{we(t,"show-tween")})},400),H(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Dce(t,e){kce(t,e),e.add(t)}function kce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lce(t,e,n){return(e=$ce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ce(t){var e=Fce(t,"string");return typeof e=="symbol"?e:e+""}function Fce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Cm="trimRows",Wce=330;var hN=new WeakSet;class Bce extends Je{constructor(){super(...arguments),Dce(this,hN),Lce(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Cm}static get PLUGIN_PRIORITY(){return Wce}isEnabled(){return!!this.hot.getSettings()[Cm]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Qd),this.trimmedRowsMap.addLocalHook("init",()=>Vce(hN,this,jce).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Cm];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),H(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(H(e,l=>{o[l]=!1}),i=Rr(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function jce(){const t=this.hot.getSettings()[Cm];Array.isArray(t)&&this.hot.batchExecution(()=>{H(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function Uce(t,e,n){return(e=zce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zce(t){var e=Yce(t,"string");return typeof e=="symbol"?e:e+""}function Yce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gi{constructor(e){Uce(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function qg(t,e,n){return(e=Gce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gce(t){var e=qce(t,"string");return typeof e=="symbol"?e:e+""}function qce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O_ extends gi{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),qg(this,"stateBefore",void 0),qg(this,"range",void 0),qg(this,"type",void 0),qg(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new O_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){H(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){js(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function dN(t,e,n){return(e=Kce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kce(t){var e=Xce(t,"string");return typeof e=="symbol"?e:e+""}function Xce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x_ extends gi{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),dN(this,"columns",void 0),dN(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new x_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),T_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function fN(t,e,n){return(e=Zce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zce(t){var e=Jce(t,"string");return typeof e=="symbol"?e:e+""}function Jce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A_ extends gi{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),fN(this,"previousSortState",void 0),fN(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new A_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function gN(t,e,n){return(e=Qce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qce(t){var e=ehe(t,"string");return typeof e=="symbol"?e:e+""}function ehe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H_ extends gi{constructor(e){let{index:n,amount:r}=e;super("insert_col"),gN(this,"index",void 0),gN(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new H_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function mN(t,e,n){return(e=the(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function the(t){var e=nhe(t,"string");return typeof e=="symbol"?e:e+""}function nhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N_ extends gi{constructor(e){let{index:n,amount:r}=e;super("insert_row"),mN(this,"index",void 0),mN(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new N_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Kg(t,e,n){return(e=rhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rhe(t){var e=ihe(t,"string");return typeof e=="symbol"?e:e+""}function ihe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D_ extends gi{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Kg(this,"changes",void 0),Kg(this,"selected",void 0),Kg(this,"countCols",void 0),Kg(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new D_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=Jn(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=Jn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function pN(t,e,n){return(e=ohe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ohe(t){var e=she(t,"string");return typeof e=="symbol"?e:e+""}function she(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k_ extends gi{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),pN(this,"conditionsStack",void 0),pN(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new k_({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function ahe(t,e,n){return(e=lhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lhe(t){var e=uhe(t,"string");return typeof e=="symbol"?e:e+""}function uhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L_ extends gi{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),ahe(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new L_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function vV(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return de(r,i,l=>{de(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Go(t,e,n){return(e=che(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function che(t){var e=hhe(t,"string");return typeof e=="symbol"?e:e+""}function hhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $_ extends gi{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Go(this,"index",void 0),Go(this,"indexes",void 0),Go(this,"data",void 0),Go(this,"amount",void 0),Go(this,"headers",void 0),Go(this,"columnPositions",void 0),Go(this,"rowPositions",void 0),Go(this,"fixedColumnsStart",void 0),Go(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return de(l.length-1,g=>{const w=[],C=l[g];de(u,c,S=>{w.push(C[e.toPhysicalColumn(S)])}),h.push(w)}),de(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&de(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new $_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:vV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(je(this.data[c],o));const l=je(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),H(e.getSourceDataArray(),(c,h)=>{H(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&H(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Ou(t,e,n){return(e=dhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dhe(t){var e=fhe(t,"string");return typeof e=="symbol"?e:e+""}function fhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F_ extends gi{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),Ou(this,"index",void 0),Ou(this,"data",void 0),Ou(this,"fixedRowsBottom",void 0),Ou(this,"fixedRowsTop",void 0),Ou(this,"rowIndexesSequence",void 0),Ou(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Jn(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new F_({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:vV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function wN(t,e,n){return(e=ghe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ghe(t){var e=mhe(t,"string");return typeof e=="symbol"?e:e+""}function mhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V_ extends gi{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),wN(this,"rows",void 0),wN(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new V_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),T_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function phe(t,e,n){return(e=whe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function whe(t){var e=vhe(t,"string");return typeof e=="symbol"?e:e+""}function vhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W_ extends gi{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),phe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new W_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function Che(t,e){[O_,x_,A_,H_,N_,D_,k_,L_,$_,F_,V_,W_].forEach(n=>n.startRegisteringEvents(t,e))}function yhe(t,e){bhe(t,e),e.add(t)}function bhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LS(t,e,n){return(e=She(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function She(t){var e=Rhe(t,"string");return typeof e=="symbol"?e:e+""}function Rhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $S(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vN="undoRedo",Ehe="undoRedo",The=1e3;ie.getSingleton().register("beforeUndo");ie.getSingleton().register("afterUndo");ie.getSingleton().register("beforeRedo");ie.getSingleton().register("afterRedo");const CN=new Set;var Xg=new WeakSet;class _he extends Je{static get PLUGIN_KEY(){return Ehe}static get PLUGIN_PRIORITY(){return The}static get SETTING_KEYS(){return!0}constructor(e){super(e),yhe(this,Xg),LS(this,"doneActions",[]),LS(this,"undoneActions",[]),LS(this,"ignoreNewActions",!1),Che(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $S(Xg,e,Mhe).call(e,...r)}),this.registerShortcuts(),$S(Xg,this,Ihe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),$S(Xg,this,Phe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:vN};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vN)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Jn(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Jn(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function Mhe(t,e){e==="loadData"&&this.clear()}function Ihe(){const t=e=>{CN.has(e)||(Ze(it`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),CN.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Phe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function Ohe(){Ye(Jh),Ye(zZ),Ye(Qh),Ye(SJ),Ye(OJ),Ye(V$),Ye(TQ),Ye(uee),Ye(ww),Ye(wte),Ye(jte),Ye(Zte),Ye(yw),Ye(Hne),Ye(Iie),Ye(aoe),Ye(Noe),Ye(Yoe),Ye(ise),Ye(mse),Ye(Tse),Ye(jse),Ye(Jse),Ye(Dae),Ye(fle),Ye(vle),Ye(Ule),Ye(Oue),Ye(Que),Ye(lce),Ye(Sce),Ye(xce),Ye(Bce),Ye(_he)}function xhe(){m5(),$7(),G7(),fZ(),Ohe()}const FS={isDone:{name:"是否已完成",show:!1},id:{name:"谱面ID",show:!0},mode:{name:"模式",show:!1},status:{name:"状态",show:!1},bpm:{name:"BPM",show:!0},total_length:{name:"音频总时长(秒)",show:!1},hit_length:{name:"游玩长度(秒)",show:!1},url:{name:"谱面链接",show:!1},version:{name:"难度名称",show:!1},difficulty_rating:{name:"难度星级",show:!0},cs:{name:"CS",show:!1},ar:{name:"AR",show:!1},accuracy:{name:"OD",show:!1},drain:{name:"HP",show:!1},max_combo:{name:"最大连击数",show:!1},count_circles:{name:"圆圈数",show:!1},count_sliders:{name:"滑条数",show:!1},count_spinners:{name:"转盘数",show:!1},passcount:{name:"过关次数",show:!1},playcount:{name:"游玩次数",show:!1},"beatmapset.covers.list@2x":{name:"封面图",show:!1},"beatmapset.id":{name:"谱面集ID",show:!1},"beatmapset.title":{name:"歌曲标题",show:!1},"beatmapset.title_unicode":{name:"歌曲标题(原语言)",show:!0},"beatmapset.artist":{name:"歌曲艺术家",show:!1},"beatmapset.artist_unicode":{name:"艺术家(原语言)",show:!0},"beatmapset.bpm":{name:"谱面集BPM",show:!1},"beatmapset.preview_url":{name:"试听链接",show:!1},"beatmapset.creator":{name:"谱面集作者",show:!0},"beatmapset.user_id":{name:"谱面集作者ID",show:!1},"beatmapset.source":{name:"谱面集来源",show:!1},"beatmapset.video":{name:"是否含视频",show:!1},"beatmapset.storyboard":{name:"是否含故事板",show:!1},"beatmapset.favourite_count":{name:"收藏数",show:!1},"beatmapset.rating":{name:"谱面评分",show:!1},"beatmapset.tags":{name:"标签",show:!1},"beatmapset.submitted_date":{name:"提交日期",show:!1},"beatmapset.last_updated":{name:"最后更新日期",show:!1},"beatmapset.ranked_date":{name:"Ranked 日期",show:!1}};function Ahe(t,e){return e.split(".").reduce((n,r)=>{if(n&&typeof n=="object")return n[r]},t)}function Hhe(){function t(r){const i=[];for(const o of Object.keys(FS)){const s=Ahe(r,o);typeof s<"u"?i.push(s):i.push(o==="isDone"?1:"")}return i}function e(){return Object.values(FS).map(r=>r.name)}function n(){return Object.values(FS).map(r=>r.show)}return{mapObject:t,getFieldNames:e,getFieldShows:n}}const Nhe={class:"grid-container"},Dhe={class:"content"},khe={key:0,class:"corner-icon"},Lhe={__name:"BeatmapInfoTable",props:["modelValue","hot","initialColHeaders"],emits:["selected"],setup(t,{emit:e}){const n=t,r=e,i=vr(!1),o=vr([]),s=vr([]);jh(()=>n.modelValue,c=>{if(i.value=c,c){o.value=n.initialColHeaders,s.value=new Array(n.initialColHeaders.length).fill(1);const h=n.hot.getPlugin("hiddenColumns");if(h)for(let d=0;d<o.value.length;d++){const f=n.hot.toVisualColumn(d);h.isHidden(f)&&(s.value[d]=0)}}});function a(c){s.value[c]=s.value[c]?0:1}function l(){r("selected",s.value),i.value=!1}function u(){r("selected",[]),i.value=!1}return(c,h)=>{const d=DN,f=BW,g=AW,w=aB;return Kn(),gd(w,{modelValue:i.value,"onUpdate:modelValue":h[0]||(h[0]=C=>i.value=C),title:"请选择",width:"60%",onClose:u},{footer:pr(()=>[Hi(g,{onClick:u},{default:pr(()=>h[1]||(h[1]=[Em("取消")])),_:1,__:[1]}),Hi(g,{type:"primary",onClick:l},{default:pr(()=>h[2]||(h[2]=[Em("确认")])),_:1,__:[2]})]),default:pr(()=>[vl("div",Nhe,[(Kn(!0),Ro(xW,null,OW(o.value.slice(1),(C,S)=>(Kn(),gd(f,{key:S+1,class:Lr([{selected:s.value[S+1]==1},"grid-item"]),onClick:v=>a(S+1)},{default:pr(()=>[vl("div",Dhe,Tm(C),1),s.value[S+1]==1?(Kn(),Ro("div",khe,[Hi(d,null,{default:pr(()=>[Hi(be(HW))]),_:1})])):nc("",!0)]),_:2},1032,["class","onClick"]))),128))])]),_:1},8,["modelValue"])}}},$he=PW(Lhe,[["__scopeId","data-v-bd6c8d37"]]);function CV(t,e){return function(){return t.apply(e,arguments)}}const{toString:Fhe}=Object.prototype,{getPrototypeOf:B_}=Object,{iterator:Tw,toStringTag:yV}=Symbol,_w=(t=>e=>{const n=Fhe.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ui=t=>(t=t.toLowerCase(),e=>_w(e)===t),Mw=t=>e=>typeof e===t,{isArray:Ic}=Array,Dd=Mw("undefined");function Vhe(t){return t!==null&&!Dd(t)&&t.constructor!==null&&!Dd(t.constructor)&&Cr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const bV=Ui("ArrayBuffer");function Whe(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&bV(t.buffer),e}const Bhe=Mw("string"),Cr=Mw("function"),SV=Mw("number"),Iw=t=>t!==null&&typeof t=="object",jhe=t=>t===!0||t===!1,ym=t=>{if(_w(t)!=="object")return!1;const e=B_(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(yV in t)&&!(Tw in t)},Uhe=Ui("Date"),zhe=Ui("File"),Yhe=Ui("Blob"),Ghe=Ui("FileList"),qhe=t=>Iw(t)&&Cr(t.pipe),Khe=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Cr(t.append)&&((e=_w(t))==="formdata"||e==="object"&&Cr(t.toString)&&t.toString()==="[object FormData]"))},Xhe=Ui("URLSearchParams"),[Zhe,Jhe,Qhe,ede]=["ReadableStream","Request","Response","Headers"].map(Ui),tde=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function hf(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),Ic(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{const o=n?Object.getOwnPropertyNames(t):Object.keys(t),s=o.length;let a;for(r=0;r<s;r++)a=o[r],e.call(null,t[a],a,t)}}function RV(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,i;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const wl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,EV=t=>!Dd(t)&&t!==wl;function UR(){const{caseless:t}=EV(this)&&this||{},e={},n=(r,i)=>{const o=t&&RV(e,i)||i;ym(e[o])&&ym(r)?e[o]=UR(e[o],r):ym(r)?e[o]=UR({},r):Ic(r)?e[o]=r.slice():e[o]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&hf(arguments[r],n);return e}const nde=(t,e,n,{allOwnKeys:r}={})=>(hf(e,(i,o)=>{n&&Cr(i)?t[o]=CV(i,n):t[o]=i},{allOwnKeys:r}),t),rde=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),ide=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},ode=(t,e,n,r)=>{let i,o,s;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),o=i.length;o-- >0;)s=i[o],(!r||r(s,t,e))&&!a[s]&&(e[s]=t[s],a[s]=!0);t=n!==!1&&B_(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},sde=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},ade=t=>{if(!t)return null;if(Ic(t))return t;let e=t.length;if(!SV(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},lde=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&B_(Uint8Array)),ude=(t,e)=>{const r=(t&&t[Tw]).call(t);let i;for(;(i=r.next())&&!i.done;){const o=i.value;e.call(t,o[0],o[1])}},cde=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},hde=Ui("HTMLFormElement"),dde=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),yN=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),fde=Ui("RegExp"),TV=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};hf(n,(i,o)=>{let s;(s=e(i,o,t))!==!1&&(r[o]=s||i)}),Object.defineProperties(t,r)},gde=t=>{TV(t,(e,n)=>{if(Cr(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Cr(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},mde=(t,e)=>{const n={},r=i=>{i.forEach(o=>{n[o]=!0})};return Ic(t)?r(t):r(String(t).split(e)),n},pde=()=>{},wde=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function vde(t){return!!(t&&Cr(t.append)&&t[yV]==="FormData"&&t[Tw])}const Cde=t=>{const e=new Array(10),n=(r,i)=>{if(Iw(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[i]=r;const o=Ic(r)?[]:{};return hf(r,(s,a)=>{const l=n(s,i+1);!Dd(l)&&(o[a]=l)}),e[i]=void 0,o}}return r};return n(t,0)},yde=Ui("AsyncFunction"),bde=t=>t&&(Iw(t)||Cr(t))&&Cr(t.then)&&Cr(t.catch),_V=((t,e)=>t?setImmediate:e?((n,r)=>(wl.addEventListener("message",({source:i,data:o})=>{i===wl&&o===n&&r.length&&r.shift()()},!1),i=>{r.push(i),wl.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Cr(wl.postMessage)),Sde=typeof queueMicrotask<"u"?queueMicrotask.bind(wl):typeof process<"u"&&process.nextTick||_V,Rde=t=>t!=null&&Cr(t[Tw]),z={isArray:Ic,isArrayBuffer:bV,isBuffer:Vhe,isFormData:Khe,isArrayBufferView:Whe,isString:Bhe,isNumber:SV,isBoolean:jhe,isObject:Iw,isPlainObject:ym,isReadableStream:Zhe,isRequest:Jhe,isResponse:Qhe,isHeaders:ede,isUndefined:Dd,isDate:Uhe,isFile:zhe,isBlob:Yhe,isRegExp:fde,isFunction:Cr,isStream:qhe,isURLSearchParams:Xhe,isTypedArray:lde,isFileList:Ghe,forEach:hf,merge:UR,extend:nde,trim:tde,stripBOM:rde,inherits:ide,toFlatObject:ode,kindOf:_w,kindOfTest:Ui,endsWith:sde,toArray:ade,forEachEntry:ude,matchAll:cde,isHTMLForm:hde,hasOwnProperty:yN,hasOwnProp:yN,reduceDescriptors:TV,freezeMethods:gde,toObjectSet:mde,toCamelCase:dde,noop:pde,toFiniteNumber:wde,findKey:RV,global:wl,isContextDefined:EV,isSpecCompliantForm:vde,toJSONObject:Cde,isAsyncFn:yde,isThenable:bde,setImmediate:_V,asap:Sde,isIterable:Rde};function Pe(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}z.inherits(Pe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:z.toJSONObject(this.config),code:this.code,status:this.status}}});const MV=Pe.prototype,IV={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{IV[t]={value:t}});Object.defineProperties(Pe,IV);Object.defineProperty(MV,"isAxiosError",{value:!0});Pe.from=(t,e,n,r,i,o)=>{const s=Object.create(MV);return z.toFlatObject(t,s,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),Pe.call(s,t.message,e,n,r,i),s.cause=t,s.name=t.name,o&&Object.assign(s,o),s};const Ede=null;function zR(t){return z.isPlainObject(t)||z.isArray(t)}function PV(t){return z.endsWith(t,"[]")?t.slice(0,-2):t}function bN(t,e,n){return t?t.concat(e).map(function(i,o){return i=PV(i),!n&&o?"["+i+"]":i}).join(n?".":""):e}function Tde(t){return z.isArray(t)&&!t.some(zR)}const _de=z.toFlatObject(z,{},null,function(e){return/^is[A-Z]/.test(e)});function Pw(t,e,n){if(!z.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=z.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,C){return!z.isUndefined(C[w])});const r=n.metaTokens,i=n.visitor||c,o=n.dots,s=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&z.isSpecCompliantForm(e);if(!z.isFunction(i))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(z.isDate(g))return g.toISOString();if(z.isBoolean(g))return g.toString();if(!l&&z.isBlob(g))throw new Pe("Blob is not supported. Use a Buffer instead.");return z.isArrayBuffer(g)||z.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function c(g,w,C){let S=g;if(g&&!C&&typeof g=="object"){if(z.endsWith(w,"{}"))w=r?w:w.slice(0,-2),g=JSON.stringify(g);else if(z.isArray(g)&&Tde(g)||(z.isFileList(g)||z.endsWith(w,"[]"))&&(S=z.toArray(g)))return w=PV(w),S.forEach(function(T,P){!(z.isUndefined(T)||T===null)&&e.append(s===!0?bN([w],P,o):s===null?w:w+"[]",u(T))}),!1}return zR(g)?!0:(e.append(bN(C,w,o),u(g)),!1)}const h=[],d=Object.assign(_de,{defaultVisitor:c,convertValue:u,isVisitable:zR});function f(g,w){if(!z.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+w.join("."));h.push(g),z.forEach(g,function(S,v){(!(z.isUndefined(S)||S===null)&&i.call(e,S,z.isString(v)?v.trim():v,w,d))===!0&&f(S,w?w.concat(v):[v])}),h.pop()}}if(!z.isObject(t))throw new TypeError("data must be an object");return f(t),e}function SN(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function j_(t,e){this._pairs=[],t&&Pw(t,this,e)}const OV=j_.prototype;OV.append=function(e,n){this._pairs.push([e,n])};OV.toString=function(e){const n=e?function(r){return e.call(this,r,SN)}:SN;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function Mde(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function xV(t,e,n){if(!e)return t;const r=n&&n.encode||Mde;z.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let o;if(i?o=i(e,n):o=z.isURLSearchParams(e)?e.toString():new j_(e,n).toString(r),o){const s=t.indexOf("#");s!==-1&&(t=t.slice(0,s)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class RN{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){z.forEach(this.handlers,function(r){r!==null&&e(r)})}}const AV={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ide=typeof URLSearchParams<"u"?URLSearchParams:j_,Pde=typeof FormData<"u"?FormData:null,Ode=typeof Blob<"u"?Blob:null,xde={isBrowser:!0,classes:{URLSearchParams:Ide,FormData:Pde,Blob:Ode},protocols:["http","https","file","blob","url","data"]},U_=typeof window<"u"&&typeof document<"u",YR=typeof navigator=="object"&&navigator||void 0,Ade=U_&&(!YR||["ReactNative","NativeScript","NS"].indexOf(YR.product)<0),Hde=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Nde=U_&&window.location.href||"http://localhost",Dde=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:U_,hasStandardBrowserEnv:Ade,hasStandardBrowserWebWorkerEnv:Hde,navigator:YR,origin:Nde},Symbol.toStringTag,{value:"Module"})),kn={...Dde,...xde};function kde(t,e){return Pw(t,new kn.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,o){return kn.isNode&&z.isBuffer(n)?(this.append(r,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function Lde(t){return z.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function $de(t){const e={},n=Object.keys(t);let r;const i=n.length;let o;for(r=0;r<i;r++)o=n[r],e[o]=t[o];return e}function HV(t){function e(n,r,i,o){let s=n[o++];if(s==="__proto__")return!0;const a=Number.isFinite(+s),l=o>=n.length;return s=!s&&z.isArray(i)?i.length:s,l?(z.hasOwnProp(i,s)?i[s]=[i[s],r]:i[s]=r,!a):((!i[s]||!z.isObject(i[s]))&&(i[s]=[]),e(n,r,i[s],o)&&z.isArray(i[s])&&(i[s]=$de(i[s])),!a)}if(z.isFormData(t)&&z.isFunction(t.entries)){const n={};return z.forEachEntry(t,(r,i)=>{e(Lde(r),i,n,0)}),n}return null}function Fde(t,e,n){if(z.isString(t))try{return(e||JSON.parse)(t),z.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const df={transitional:AV,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,o=z.isObject(e);if(o&&z.isHTMLForm(e)&&(e=new FormData(e)),z.isFormData(e))return i?JSON.stringify(HV(e)):e;if(z.isArrayBuffer(e)||z.isBuffer(e)||z.isStream(e)||z.isFile(e)||z.isBlob(e)||z.isReadableStream(e))return e;if(z.isArrayBufferView(e))return e.buffer;if(z.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return kde(e,this.formSerializer).toString();if((a=z.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Pw(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return o||i?(n.setContentType("application/json",!1),Fde(e)):e}],transformResponse:[function(e){const n=this.transitional||df.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(z.isResponse(e)||z.isReadableStream(e))return e;if(e&&z.isString(e)&&(r&&!this.responseType||i)){const s=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(s)throw a.name==="SyntaxError"?Pe.from(a,Pe.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:kn.classes.FormData,Blob:kn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};z.forEach(["delete","get","head","post","put","patch"],t=>{df.headers[t]={}});const Vde=z.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Wde=t=>{const e={};let n,r,i;return t&&t.split(`
`).forEach(function(s){i=s.indexOf(":"),n=s.substring(0,i).trim().toLowerCase(),r=s.substring(i+1).trim(),!(!n||e[n]&&Vde[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},EN=Symbol("internals");function Dh(t){return t&&String(t).trim().toLowerCase()}function bm(t){return t===!1||t==null?t:z.isArray(t)?t.map(bm):String(t)}function Bde(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const jde=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function VS(t,e,n,r,i){if(z.isFunction(r))return r.call(this,e,n);if(i&&(e=n),!!z.isString(e)){if(z.isString(r))return e.indexOf(r)!==-1;if(z.isRegExp(r))return r.test(e)}}function Ude(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function zde(t,e){const n=z.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(i,o,s){return this[r].call(this,e,i,o,s)},configurable:!0})})}let yr=class{constructor(e){e&&this.set(e)}set(e,n,r){const i=this;function o(a,l,u){const c=Dh(l);if(!c)throw new Error("header name must be a non-empty string");const h=z.findKey(i,c);(!h||i[h]===void 0||u===!0||u===void 0&&i[h]!==!1)&&(i[h||l]=bm(a))}const s=(a,l)=>z.forEach(a,(u,c)=>o(u,c,l));if(z.isPlainObject(e)||e instanceof this.constructor)s(e,n);else if(z.isString(e)&&(e=e.trim())&&!jde(e))s(Wde(e),n);else if(z.isObject(e)&&z.isIterable(e)){let a={},l,u;for(const c of e){if(!z.isArray(c))throw TypeError("Object iterator must return a key-value pair");a[u=c[0]]=(l=a[u])?z.isArray(l)?[...l,c[1]]:[l,c[1]]:c[1]}s(a,n)}else e!=null&&o(n,e,r);return this}get(e,n){if(e=Dh(e),e){const r=z.findKey(this,e);if(r){const i=this[r];if(!n)return i;if(n===!0)return Bde(i);if(z.isFunction(n))return n.call(this,i,r);if(z.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Dh(e),e){const r=z.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||VS(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let i=!1;function o(s){if(s=Dh(s),s){const a=z.findKey(r,s);a&&(!n||VS(r,r[a],a,n))&&(delete r[a],i=!0)}}return z.isArray(e)?e.forEach(o):o(e),i}clear(e){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const o=n[r];(!e||VS(this,this[o],o,e,!0))&&(delete this[o],i=!0)}return i}normalize(e){const n=this,r={};return z.forEach(this,(i,o)=>{const s=z.findKey(r,o);if(s){n[s]=bm(i),delete n[o];return}const a=e?Ude(o):String(o).trim();a!==o&&delete n[o],n[a]=bm(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return z.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=e&&z.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[EN]=this[EN]={accessors:{}}).accessors,i=this.prototype;function o(s){const a=Dh(s);r[a]||(zde(i,s),r[a]=!0)}return z.isArray(e)?e.forEach(o):o(e),this}};yr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);z.reduceDescriptors(yr.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});z.freezeMethods(yr);function WS(t,e){const n=this||df,r=e||n,i=yr.from(r.headers);let o=r.data;return z.forEach(t,function(a){o=a.call(n,o,i.normalize(),e?e.status:void 0)}),i.normalize(),o}function NV(t){return!!(t&&t.__CANCEL__)}function Pc(t,e,n){Pe.call(this,t??"canceled",Pe.ERR_CANCELED,e,n),this.name="CanceledError"}z.inherits(Pc,Pe,{__CANCEL__:!0});function DV(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new Pe("Request failed with status code "+n.status,[Pe.ERR_BAD_REQUEST,Pe.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Yde(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Gde(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i=0,o=0,s;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=r[o];s||(s=u),n[i]=l,r[i]=u;let h=o,d=0;for(;h!==i;)d+=n[h++],h=h%t;if(i=(i+1)%t,i===o&&(o=(o+1)%t),u-s<e)return;const f=c&&u-c;return f?Math.round(d*1e3/f):void 0}}function qde(t,e){let n=0,r=1e3/e,i,o;const s=(u,c=Date.now())=>{n=c,i=null,o&&(clearTimeout(o),o=null),t.apply(null,u)};return[(...u)=>{const c=Date.now(),h=c-n;h>=r?s(u,c):(i=u,o||(o=setTimeout(()=>{o=null,s(i)},r-h)))},()=>i&&s(i)]}const Rp=(t,e,n=3)=>{let r=0;const i=Gde(50,250);return qde(o=>{const s=o.loaded,a=o.lengthComputable?o.total:void 0,l=s-r,u=i(l),c=s<=a;r=s;const h={loaded:s,total:a,progress:a?s/a:void 0,bytes:l,rate:u||void 0,estimated:u&&a&&c?(a-s)/u:void 0,event:o,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(h)},n)},TN=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},_N=t=>(...e)=>z.asap(()=>t(...e)),Kde=kn.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,kn.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(kn.origin),kn.navigator&&/(msie|trident)/i.test(kn.navigator.userAgent)):()=>!0,Xde=kn.hasStandardBrowserEnv?{write(t,e,n,r,i,o){const s=[t+"="+encodeURIComponent(e)];z.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),z.isString(r)&&s.push("path="+r),z.isString(i)&&s.push("domain="+i),o===!0&&s.push("secure"),document.cookie=s.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Zde(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Jde(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function kV(t,e,n){let r=!Zde(e);return t&&(r||n==!1)?Jde(t,e):e}const MN=t=>t instanceof yr?{...t}:t;function Hl(t,e){e=e||{};const n={};function r(u,c,h,d){return z.isPlainObject(u)&&z.isPlainObject(c)?z.merge.call({caseless:d},u,c):z.isPlainObject(c)?z.merge({},c):z.isArray(c)?c.slice():c}function i(u,c,h,d){if(z.isUndefined(c)){if(!z.isUndefined(u))return r(void 0,u,h,d)}else return r(u,c,h,d)}function o(u,c){if(!z.isUndefined(c))return r(void 0,c)}function s(u,c){if(z.isUndefined(c)){if(!z.isUndefined(u))return r(void 0,u)}else return r(void 0,c)}function a(u,c,h){if(h in e)return r(u,c);if(h in t)return r(void 0,u)}const l={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(u,c,h)=>i(MN(u),MN(c),h,!0)};return z.forEach(Object.keys(Object.assign({},t,e)),function(c){const h=l[c]||i,d=h(t[c],e[c],c);z.isUndefined(d)&&h!==a||(n[c]=d)}),n}const LV=t=>{const e=Hl({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:o,headers:s,auth:a}=e;e.headers=s=yr.from(s),e.url=xV(kV(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&s.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(z.isFormData(n)){if(kn.hasStandardBrowserEnv||kn.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if((l=s.getContentType())!==!1){const[u,...c]=l?l.split(";").map(h=>h.trim()).filter(Boolean):[];s.setContentType([u||"multipart/form-data",...c].join("; "))}}if(kn.hasStandardBrowserEnv&&(r&&z.isFunction(r)&&(r=r(e)),r||r!==!1&&Kde(e.url))){const u=i&&o&&Xde.read(o);u&&s.set(i,u)}return e},Qde=typeof XMLHttpRequest<"u",efe=Qde&&function(t){return new Promise(function(n,r){const i=LV(t);let o=i.data;const s=yr.from(i.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:u}=i,c,h,d,f,g;function w(){f&&f(),g&&g(),i.cancelToken&&i.cancelToken.unsubscribe(c),i.signal&&i.signal.removeEventListener("abort",c)}let C=new XMLHttpRequest;C.open(i.method.toUpperCase(),i.url,!0),C.timeout=i.timeout;function S(){if(!C)return;const T=yr.from("getAllResponseHeaders"in C&&C.getAllResponseHeaders()),x={data:!a||a==="text"||a==="json"?C.responseText:C.response,status:C.status,statusText:C.statusText,headers:T,config:t,request:C};DV(function(M){n(M),w()},function(M){r(M),w()},x),C=null}"onloadend"in C?C.onloadend=S:C.onreadystatechange=function(){!C||C.readyState!==4||C.status===0&&!(C.responseURL&&C.responseURL.indexOf("file:")===0)||setTimeout(S)},C.onabort=function(){C&&(r(new Pe("Request aborted",Pe.ECONNABORTED,t,C)),C=null)},C.onerror=function(){r(new Pe("Network Error",Pe.ERR_NETWORK,t,C)),C=null},C.ontimeout=function(){let P=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const x=i.transitional||AV;i.timeoutErrorMessage&&(P=i.timeoutErrorMessage),r(new Pe(P,x.clarifyTimeoutError?Pe.ETIMEDOUT:Pe.ECONNABORTED,t,C)),C=null},o===void 0&&s.setContentType(null),"setRequestHeader"in C&&z.forEach(s.toJSON(),function(P,x){C.setRequestHeader(x,P)}),z.isUndefined(i.withCredentials)||(C.withCredentials=!!i.withCredentials),a&&a!=="json"&&(C.responseType=i.responseType),u&&([d,g]=Rp(u,!0),C.addEventListener("progress",d)),l&&C.upload&&([h,f]=Rp(l),C.upload.addEventListener("progress",h),C.upload.addEventListener("loadend",f)),(i.cancelToken||i.signal)&&(c=T=>{C&&(r(!T||T.type?new Pc(null,t,C):T),C.abort(),C=null)},i.cancelToken&&i.cancelToken.subscribe(c),i.signal&&(i.signal.aborted?c():i.signal.addEventListener("abort",c)));const v=Yde(i.url);if(v&&kn.protocols.indexOf(v)===-1){r(new Pe("Unsupported protocol "+v+":",Pe.ERR_BAD_REQUEST,t));return}C.send(o||null)})},tfe=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,i;const o=function(u){if(!i){i=!0,a();const c=u instanceof Error?u:this.reason;r.abort(c instanceof Pe?c:new Pc(c instanceof Error?c.message:c))}};let s=e&&setTimeout(()=>{s=null,o(new Pe(`timeout ${e} of ms exceeded`,Pe.ETIMEDOUT))},e);const a=()=>{t&&(s&&clearTimeout(s),s=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),t=null)};t.forEach(u=>u.addEventListener("abort",o));const{signal:l}=r;return l.unsubscribe=()=>z.asap(a),l}},nfe=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let r=0,i;for(;r<n;)i=r+e,yield t.slice(r,i),r=i},rfe=async function*(t,e){for await(const n of ife(t))yield*nfe(n,e)},ife=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},IN=(t,e,n,r)=>{const i=rfe(t,e);let o=0,s,a=l=>{s||(s=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:u,value:c}=await i.next();if(u){a(),l.close();return}let h=c.byteLength;if(n){let d=o+=h;n(d)}l.enqueue(new Uint8Array(c))}catch(u){throw a(u),u}},cancel(l){return a(l),i.return()}},{highWaterMark:2})},Ow=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",$V=Ow&&typeof ReadableStream=="function",ofe=Ow&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),FV=(t,...e)=>{try{return!!t(...e)}catch{return!1}},sfe=$V&&FV(()=>{let t=!1;const e=new Request(kn.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),PN=64*1024,GR=$V&&FV(()=>z.isReadableStream(new Response("").body)),Ep={stream:GR&&(t=>t.body)};Ow&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Ep[e]&&(Ep[e]=z.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new Pe(`Response type '${e}' is not supported`,Pe.ERR_NOT_SUPPORT,r)})})})(new Response);const afe=async t=>{if(t==null)return 0;if(z.isBlob(t))return t.size;if(z.isSpecCompliantForm(t))return(await new Request(kn.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(z.isArrayBufferView(t)||z.isArrayBuffer(t))return t.byteLength;if(z.isURLSearchParams(t)&&(t=t+""),z.isString(t))return(await ofe(t)).byteLength},lfe=async(t,e)=>{const n=z.toFiniteNumber(t.getContentLength());return n??afe(e)},ufe=Ow&&(async t=>{let{url:e,method:n,data:r,signal:i,cancelToken:o,timeout:s,onDownloadProgress:a,onUploadProgress:l,responseType:u,headers:c,withCredentials:h="same-origin",fetchOptions:d}=LV(t);u=u?(u+"").toLowerCase():"text";let f=tfe([i,o&&o.toAbortSignal()],s),g;const w=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let C;try{if(l&&sfe&&n!=="get"&&n!=="head"&&(C=await lfe(c,r))!==0){let x=new Request(e,{method:"POST",body:r,duplex:"half"}),_;if(z.isFormData(r)&&(_=x.headers.get("content-type"))&&c.setContentType(_),x.body){const[M,V]=TN(C,Rp(_N(l)));r=IN(x.body,PN,M,V)}}z.isString(h)||(h=h?"include":"omit");const S="credentials"in Request.prototype;g=new Request(e,{...d,signal:f,method:n.toUpperCase(),headers:c.normalize().toJSON(),body:r,duplex:"half",credentials:S?h:void 0});let v=await fetch(g,d);const T=GR&&(u==="stream"||u==="response");if(GR&&(a||T&&w)){const x={};["status","statusText","headers"].forEach(Y=>{x[Y]=v[Y]});const _=z.toFiniteNumber(v.headers.get("content-length")),[M,V]=a&&TN(_,Rp(_N(a),!0))||[];v=new Response(IN(v.body,PN,M,()=>{V&&V(),w&&w()}),x)}u=u||"text";let P=await Ep[z.findKey(Ep,u)||"text"](v,t);return!T&&w&&w(),await new Promise((x,_)=>{DV(x,_,{data:P,headers:yr.from(v.headers),status:v.status,statusText:v.statusText,config:t,request:g})})}catch(S){throw w&&w(),S&&S.name==="TypeError"&&/Load failed|fetch/i.test(S.message)?Object.assign(new Pe("Network Error",Pe.ERR_NETWORK,t,g),{cause:S.cause||S}):Pe.from(S,S&&S.code,t,g)}}),qR={http:Ede,xhr:efe,fetch:ufe};z.forEach(qR,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const ON=t=>`- ${t}`,cfe=t=>z.isFunction(t)||t===null||t===!1,VV={getAdapter:t=>{t=z.isArray(t)?t:[t];const{length:e}=t;let n,r;const i={};for(let o=0;o<e;o++){n=t[o];let s;if(r=n,!cfe(n)&&(r=qR[(s=String(n)).toLowerCase()],r===void 0))throw new Pe(`Unknown adapter '${s}'`);if(r)break;i[s||"#"+o]=r}if(!r){const o=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let s=e?o.length>1?`since :
`+o.map(ON).join(`
`):" "+ON(o[0]):"as no adapter specified";throw new Pe("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return r},adapters:qR};function BS(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Pc(null,t)}function xN(t){return BS(t),t.headers=yr.from(t.headers),t.data=WS.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),VV.getAdapter(t.adapter||df.adapter)(t).then(function(r){return BS(t),r.data=WS.call(t,t.transformResponse,r),r.headers=yr.from(r.headers),r},function(r){return NV(r)||(BS(t),r&&r.response&&(r.response.data=WS.call(t,t.transformResponse,r.response),r.response.headers=yr.from(r.response.headers))),Promise.reject(r)})}const WV="1.10.0",xw={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{xw[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const AN={};xw.transitional=function(e,n,r){function i(o,s){return"[Axios v"+WV+"] Transitional option '"+o+"'"+s+(r?". "+r:"")}return(o,s,a)=>{if(e===!1)throw new Pe(i(s," has been removed"+(n?" in "+n:"")),Pe.ERR_DEPRECATED);return n&&!AN[s]&&(AN[s]=!0,console.warn(i(s," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(o,s,a):!0}};xw.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function hfe(t,e,n){if(typeof t!="object")throw new Pe("options must be an object",Pe.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const o=r[i],s=e[o];if(s){const a=t[o],l=a===void 0||s(a,o,t);if(l!==!0)throw new Pe("option "+o+" must be "+l,Pe.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Pe("Unknown option "+o,Pe.ERR_BAD_OPTION)}}const Sm={assertOptions:hfe,validators:xw},lo=Sm.validators;let Sl=class{constructor(e){this.defaults=e||{},this.interceptors={request:new RN,response:new RN}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Hl(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:o}=n;r!==void 0&&Sm.assertOptions(r,{silentJSONParsing:lo.transitional(lo.boolean),forcedJSONParsing:lo.transitional(lo.boolean),clarifyTimeoutError:lo.transitional(lo.boolean)},!1),i!=null&&(z.isFunction(i)?n.paramsSerializer={serialize:i}:Sm.assertOptions(i,{encode:lo.function,serialize:lo.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Sm.assertOptions(n,{baseUrl:lo.spelling("baseURL"),withXsrfToken:lo.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let s=o&&z.merge(o.common,o[n.method]);o&&z.forEach(["delete","get","head","post","put","patch","common"],g=>{delete o[g]}),n.headers=yr.concat(s,o);const a=[];let l=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(n)===!1||(l=l&&w.synchronous,a.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let c,h=0,d;if(!l){const g=[xN.bind(this),void 0];for(g.unshift.apply(g,a),g.push.apply(g,u),d=g.length,c=Promise.resolve(n);h<d;)c=c.then(g[h++],g[h++]);return c}d=a.length;let f=n;for(h=0;h<d;){const g=a[h++],w=a[h++];try{f=g(f)}catch(C){w.call(this,C);break}}try{c=xN.call(this,f)}catch(g){return Promise.reject(g)}for(h=0,d=u.length;h<d;)c=c.then(u[h++],u[h++]);return c}getUri(e){e=Hl(this.defaults,e);const n=kV(e.baseURL,e.url,e.allowAbsoluteUrls);return xV(n,e.params,e.paramsSerializer)}};z.forEach(["delete","get","head","options"],function(e){Sl.prototype[e]=function(n,r){return this.request(Hl(r||{},{method:e,url:n,data:(r||{}).data}))}});z.forEach(["post","put","patch"],function(e){function n(r){return function(o,s,a){return this.request(Hl(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:s}))}}Sl.prototype[e]=n(),Sl.prototype[e+"Form"]=n(!0)});let dfe=class BV{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const r=this;this.promise.then(i=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](i);r._listeners=null}),this.promise.then=i=>{let o;const s=new Promise(a=>{r.subscribe(a),o=a}).then(i);return s.cancel=function(){r.unsubscribe(o)},s},e(function(o,s,a){r.reason||(r.reason=new Pc(o,s,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new BV(function(i){e=i}),cancel:e}}};function ffe(t){return function(n){return t.apply(null,n)}}function gfe(t){return z.isObject(t)&&t.isAxiosError===!0}const KR={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(KR).forEach(([t,e])=>{KR[e]=t});function jV(t){const e=new Sl(t),n=CV(Sl.prototype.request,e);return z.extend(n,Sl.prototype,e,{allOwnKeys:!0}),z.extend(n,e,null,{allOwnKeys:!0}),n.create=function(i){return jV(Hl(t,i))},n}const Kt=jV(df);Kt.Axios=Sl;Kt.CanceledError=Pc;Kt.CancelToken=dfe;Kt.isCancel=NV;Kt.VERSION=WV;Kt.toFormData=Pw;Kt.AxiosError=Pe;Kt.Cancel=Kt.CanceledError;Kt.all=function(e){return Promise.all(e)};Kt.spread=ffe;Kt.isAxiosError=gfe;Kt.mergeConfig=Hl;Kt.AxiosHeaders=yr;Kt.formToJSON=t=>HV(z.isHTMLForm(t)?new FormData(t):t);Kt.getAdapter=VV.getAdapter;Kt.HttpStatusCode=KR;Kt.default=Kt;const{Axios:kfe,AxiosError:Lfe,CanceledError:$fe,isCancel:Ffe,CancelToken:Vfe,VERSION:Wfe,all:Bfe,Cancel:jfe,isAxiosError:Ufe,spread:zfe,toFormData:Yfe,AxiosHeaders:Gfe,HttpStatusCode:qfe,formToJSON:Kfe,getAdapter:Xfe,mergeConfig:Zfe}=Kt,mfe={class:"container"},Jfe={__name:"TableView",setup(t){xhe();const{mapObject:e,getFieldNames:n,getFieldShows:r}=Hhe(),i=vr([[],[],[],[],[]]),o=vr(null);let s=null;const a=vr({}),l=vr(!1);let u;const c=v=>{l.value=!1,u&&(u(v),u=null)},h=async()=>(l.value=!0,new Promise(v=>{u=v})),d={colHeaders:n(),data:i.value,rowHeaders:!0,stretchH:"all",width:"100%",minCols:n().length,manualColumnResize:!0,manualColumnMove:!0,manualRowMove:!0,manualRowResize:!0,autoWrapRow:!0,themeName:"ht-theme-horizon",licenseKey:"non-commercial-and-evaluation",hiddenColumns:{copyPasteEnabled:!1},contextMenu:{async callback(v,T,P){const x=f(),_=g();switch(v){case"row:delete":{let M=0;_.forEach(V=>{this.alter("remove_row",V-M),M++});break}case"row:above":{this.alter("insert_row_above",_[0]);break}case"row:below":{this.alter("insert_row_below",_[0]);break}case"col:delete":{let M=0;x.forEach(V=>{this.toPhysicalColumn(V)>=n().length?(this.alter("remove_col",V-M),console.log(`删除列: ${V}`),M++):(this.getPlugin("hiddenColumns").hideColumn(V),console.log(`隐藏列: ${V}`))});break}case"col:left":{const M=this.getPlugin("manualColumnMove");this.alter("insert_col_end",this.countCols()),M.moveColumn(this.countCols()-1,x[0]);break}case"col:right":{const M=this.getPlugin("manualColumnMove");this.alter("insert_col_end",this.countCols()),M.moveColumn(this.countCols()-1,x[0]+1);break}case"data:row":{const M=[],V=[];for(let Y=0;Y<_.length;Y++){const O=_[Y],G=i.value[O][1];/^\d+$/.test(String(G).trim())&&(M.push(G),V.push(O))}if(M.length===0)return;for(;M.length>0;){const Y=M.splice(0,50),O=V.splice(0,50);await S(Y,O)}break}case"data:add":{const M=await h();if(!M||M.length===0)return;const V=this.getPlugin("hiddenColumns");for(let Y=1;Y<M.length;Y++){const O=this.toVisualColumn(Y);M[Y]&&V.isHidden(O)&&V.showColumn(O),!M[Y]&&!V.isHidden(O)&&V.hideColumn(O)}break}}console.log(v),this.render()},items:{row:{name:"行操作",submenu:{items:[{key:"row:delete",name:"删除选中行",disabled(){return C()}},{key:"row:above",name:"在上方插入行",disabled(){return g().length!==1}},{key:"row:below",name:"在下方插入行",disabled(){return g().length!==1}}]}},col:{name:"列操作",submenu:{items:[{key:"col:delete",name:"删除选中列",disabled(){return w()}},{key:"col:left",name:"在左侧插入列",disabled(){return f().length!==1}},{key:"col:right",name:"在右侧插入列",disabled(){return f().length!==1}}]}},data:{name:"数据操作",submenu:{items:[{key:"data:row",name:"获取选中行数据"},{key:"data:add",name:"添加谱面信息..."}]}},split:{name:"---------"},alignment:{name:"单元格对齐"}}},afterGetRowHeader(v,T){const P=a.value[v];T.classList.remove("row-header-success","row-header-failed","row-header-pending"),P==="success"?T.classList.add("row-header-success"):P==="failed"?T.classList.add("row-header-failed"):T.classList.add("row-header-pending")},afterGetColHeader(v,T){T.removeEventListener("dblclick",T._dblclickHandler);const P=()=>{const x=s.getColHeader(v),_=document.createElement("input");_.type="text",_.value=x,_.style.position="absolute";const M=T.getBoundingClientRect();_.style.left=M.left+"px",_.style.top=M.top+"px",_.style.width=M.width+"px",_.style.height=M.height+"px",_.style.zIndex=9999,document.body.appendChild(_),s.deselectCell(),_.focus(),_.addEventListener("blur",()=>{const V=_.value.trim()||x,Y=s.getSettings().colHeaders,O=s.toPhysicalColumn(v);Y[O]=V,s.updateSettings({colHeaders:Y}),document.body.removeChild(_)}),_.addEventListener("keydown",V=>{V.key==="Enter"&&_.blur()})};T._dblclickHandler=P,T.addEventListener("dblclick",P)}};function f(){const v=s.getSelectedRange(),T=new Set,P=s.getPlugin("hiddenColumns");return v?(v.forEach(x=>{const _=Math.min(x.from.col,x.to.col),M=Math.max(x.from.col,x.to.col);for(let V=_;V<=M;V++)V!==-1&&!P.isHidden(V)&&T.add(V)}),Array.from(T).sort((x,_)=>x-_)):[]}function g(){const v=s.getSelectedRange(),T=new Set;return v?(v.forEach(P=>{const x=Math.min(P.from.row,P.to.row),_=Math.max(P.from.row,P.to.row);for(let M=x;M<=_;M++)M!==-1&&T.add(M)}),Array.from(T).sort((P,x)=>P-x)):[]}function w(){const v=s.countCols(),T=s.getPlugin("hiddenColumns");let P=0;for(let _=0;_<v;_++)T.isHidden(_)||P++;return f().length===P}function C(){return s.countRows()===g().length}async function S(v,T){const P=v.map((O,G)=>G).sort((O,G)=>v[O]-v[G]);v.splice(0,v.length,...P.map(O=>v[O])),T.splice(0,T.length,...P.map(O=>T[O]));const _=(await Kt.get(`https://osu.xywork.top/?ids=${v.join(",")}`)).data.beatmaps.map(O=>e(O)),M=[];let V=0,Y=0;for(;V<T.length&&Y<_.length;)if(i.value[T[V]][1]==_[Y][1]){for(let O=0;O<_[Y].length;O++)i.value[T[V]][O]=_[Y][O];a.value[T[V]]="success",V++,Y++}else M.push(T[V]+1),a.value[T[V]]="failed",V++;s.render()}return JR(()=>{if(o.value){s=o.value.hotInstance;const v=s.getPlugin("hiddenColumns"),T=r().reduce((P,x,_)=>x?P:[...P,_],[]);v.hideColumns(T),s.render()}}),(v,T)=>(Kn(),Ro("div",mfe,[Hi(be(jT),{class:"handsontable",ref_key:"hotTable",ref:o,settings:d,width:"95vw",height:"95vh"},null,512),Hi($he,{modelValue:l.value,"onUpdate:modelValue":T[0]||(T[0]=P=>l.value=P),initialColHeaders:be(n)(),hot:be(s),onSelected:c},null,8,["modelValue","initialColHeaders","hot"])]))}};export{Jfe as default};
