import{_ as EF,r as TF,a as A_,o as _F,c as MF,b as IF,d as PF,w as OF,E as xF,e as HF,f as AF}from"./index-CMrnZC_t.js";var N_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},D_={},dc,k_;function Xt(){if(k_)return dc;k_=1;var t=function(e){return e&&e.Math===Math&&e};return dc=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof N_=="object"&&N_)||t(typeof dc=="object"&&dc)||function(){return this}()||Function("return this")(),dc}var tw={},nw,L_;function nn(){return L_||(L_=1,nw=function(t){try{return!!t()}catch{return!0}}),nw}var rw,$_;function Jr(){if($_)return rw;$_=1;var t=nn();return rw=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),rw}var iw,F_;function Km(){if(F_)return iw;F_=1;var t=nn();return iw=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),iw}var ow,V_;function rn(){if(V_)return ow;V_=1;var t=Km(),e=Function.prototype.call;return ow=t?e.bind(e):function(){return e.apply(e,arguments)},ow}var sw={},W_;function NF(){if(W_)return sw;W_=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return sw.f=n?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,sw}var aw,B_;function Xm(){return B_||(B_=1,aw=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),aw}var lw,j_;function Zt(){if(j_)return lw;j_=1;var t=Km(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return lw=t?r:function(i){return function(){return n.apply(i,arguments)}},lw}var uw,U_;function ml(){if(U_)return uw;U_=1;var t=Zt(),e=t({}.toString),n=t("".slice);return uw=function(r){return n(e(r),8,-1)},uw}var cw,z_;function DF(){if(z_)return cw;z_=1;var t=Zt(),e=nn(),n=ml(),r=Object,i=t("".split);return cw=e(function(){return!r("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?i(o,""):r(o)}:r,cw}var hw,Y_;function gR(){return Y_||(Y_=1,hw=function(t){return t==null}),hw}var dw,G_;function md(){if(G_)return dw;G_=1;var t=gR(),e=TypeError;return dw=function(n){if(t(n))throw new e("Can't call method on "+n);return n},dw}var fw,q_;function pd(){if(q_)return fw;q_=1;var t=DF(),e=md();return fw=function(n){return t(e(n))},fw}var gw,K_;function on(){if(K_)return gw;K_=1;var t=typeof document=="object"&&document.all;return gw=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},gw}var mw,X_;function ei(){if(X_)return mw;X_=1;var t=on();return mw=function(e){return typeof e=="object"?e!==null:t(e)},mw}var pw,Z_;function qu(){if(Z_)return pw;Z_=1;var t=Xt(),e=on(),n=function(r){return e(r)?r:void 0};return pw=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},pw}var ww,Q_;function wd(){if(Q_)return ww;Q_=1;var t=Zt();return ww=t({}.isPrototypeOf),ww}var vw,J_;function Zm(){if(J_)return vw;J_=1;var t=Xt(),e=t.navigator,n=e&&e.userAgent;return vw=n?String(n):"",vw}var Cw,eM;function kF(){if(eM)return Cw;eM=1;var t=Xt(),e=Zm(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),Cw=a,Cw}var yw,tM;function mR(){if(tM)return yw;tM=1;var t=kF(),e=nn(),n=Xt(),r=n.String;return yw=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),yw}var Sw,nM;function xA(){if(nM)return Sw;nM=1;var t=mR();return Sw=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Sw}var bw,rM;function pR(){if(rM)return bw;rM=1;var t=qu(),e=on(),n=wd(),r=xA(),i=Object;return bw=r?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&n(s.prototype,i(o))},bw}var Rw,iM;function Qm(){if(iM)return Rw;iM=1;var t=String;return Rw=function(e){try{return t(e)}catch{return"Object"}},Rw}var Ew,oM;function pr(){if(oM)return Ew;oM=1;var t=on(),e=Qm(),n=TypeError;return Ew=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},Ew}var Tw,sM;function vd(){if(sM)return Tw;sM=1;var t=pr(),e=gR();return Tw=function(n,r){var i=n[r];return e(i)?void 0:t(i)},Tw}var _w,aM;function LF(){if(aM)return _w;aM=1;var t=rn(),e=on(),n=ei(),r=TypeError;return _w=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!n(a=t(s,i))||e(s=i.valueOf)&&!n(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!n(a=t(s,i)))return a;throw new r("Can't convert object to primitive value")},_w}var Mw={exports:{}},Iw,lM;function na(){return lM||(lM=1,Iw=!1),Iw}var Pw,uM;function wR(){if(uM)return Pw;uM=1;var t=Xt(),e=Object.defineProperty;return Pw=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},Pw}var cM;function vR(){if(cM)return Mw.exports;cM=1;var t=na(),e=Xt(),n=wR(),r="__core-js_shared__",i=Mw.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.44.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Mw.exports}var Ow,hM;function HA(){if(hM)return Ow;hM=1;var t=vR();return Ow=function(e,n){return t[e]||(t[e]=n||{})},Ow}var xw,dM;function Ku(){if(dM)return xw;dM=1;var t=md(),e=Object;return xw=function(n){return e(t(n))},xw}var Hw,fM;function ti(){if(fM)return Hw;fM=1;var t=Zt(),e=Ku(),n=t({}.hasOwnProperty);return Hw=Object.hasOwn||function(i,o){return n(e(i),o)},Hw}var Aw,gM;function AA(){if(gM)return Aw;gM=1;var t=Zt(),e=0,n=Math.random(),r=t(1.1.toString);return Aw=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},Aw}var Nw,mM;function xi(){if(mM)return Nw;mM=1;var t=Xt(),e=HA(),n=ti(),r=AA(),i=mR(),o=xA(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||r;return Nw=function(u){return n(a,u)||(a[u]=i&&n(s,u)?s[u]:l("Symbol."+u)),a[u]},Nw}var Dw,pM;function $F(){if(pM)return Dw;pM=1;var t=rn(),e=ei(),n=pR(),r=vd(),i=LF(),o=xi(),s=TypeError,a=o("toPrimitive");return Dw=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Dw}var kw,wM;function NA(){if(wM)return kw;wM=1;var t=$F(),e=pR();return kw=function(n){var r=t(n,"string");return e(r)?r:r+""},kw}var Lw,vM;function CR(){if(vM)return Lw;vM=1;var t=Xt(),e=ei(),n=t.document,r=e(n)&&e(n.createElement);return Lw=function(i){return r?n.createElement(i):{}},Lw}var $w,CM;function DA(){if(CM)return $w;CM=1;var t=Jr(),e=nn(),n=CR();return $w=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),$w}var yM;function kA(){if(yM)return tw;yM=1;var t=Jr(),e=rn(),n=NF(),r=Xm(),i=pd(),o=NA(),s=ti(),a=DA(),l=Object.getOwnPropertyDescriptor;return tw.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return r(!e(n.f,c,h),c[h])},tw}var Fw={},Vw,SM;function LA(){if(SM)return Vw;SM=1;var t=Jr(),e=nn();return Vw=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Vw}var Ww,bM;function sn(){if(bM)return Ww;bM=1;var t=ei(),e=String,n=TypeError;return Ww=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},Ww}var RM;function ra(){if(RM)return Fw;RM=1;var t=Jr(),e=DA(),n=LA(),r=sn(),i=NA(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Fw.f=t?n?function(d,f,p){if(r(d),f=i(f),r(p),typeof d=="function"&&f==="prototype"&&"value"in p&&c in p&&!p[c]){var v=a(d,f);v&&v[c]&&(d[f]=p.value,p={configurable:u in p?p[u]:v[u],enumerable:l in p?p[l]:v[l],writable:!1})}return s(d,f,p)}:s:function(d,f,p){if(r(d),f=i(f),r(p),e)try{return s(d,f,p)}catch{}if("get"in p||"set"in p)throw new o("Accessors not supported");return"value"in p&&(d[f]=p.value),d},Fw}var Bw,EM;function Xu(){if(EM)return Bw;EM=1;var t=Jr(),e=ra(),n=Xm();return Bw=t?function(r,i,o){return e.f(r,i,n(1,o))}:function(r,i,o){return r[i]=o,r},Bw}var jw={exports:{}},Uw,TM;function FF(){if(TM)return Uw;TM=1;var t=Jr(),e=ti(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&r(n,"name").configurable);return Uw={EXISTS:i,PROPER:o,CONFIGURABLE:s},Uw}var zw,_M;function VF(){if(_M)return zw;_M=1;var t=Zt(),e=on(),n=vR(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),zw=n.inspectSource,zw}var Yw,MM;function WF(){if(MM)return Yw;MM=1;var t=Xt(),e=on(),n=t.WeakMap;return Yw=e(n)&&/native code/.test(String(n)),Yw}var Gw,IM;function yR(){if(IM)return Gw;IM=1;var t=HA(),e=AA(),n=t("keys");return Gw=function(r){return n[r]||(n[r]=e(r))},Gw}var qw,PM;function SR(){return PM||(PM=1,qw={}),qw}var Kw,OM;function $A(){if(OM)return Kw;OM=1;var t=WF(),e=Xt(),n=ei(),r=Xu(),i=ti(),o=vR(),s=yR(),a=SR(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,p=function(C){return f(C)?d(C):h(C,{})},v=function(C){return function(I){var H;if(!n(I)||(H=d(I)).type!==C)throw new u("Incompatible receiver, "+C+" required");return H}};if(t||o.state){var S=o.state||(o.state=new c);S.get=S.get,S.has=S.has,S.set=S.set,h=function(C,I){if(S.has(C))throw new u(l);return I.facade=C,S.set(C,I),I},d=function(C){return S.get(C)||{}},f=function(C){return S.has(C)}}else{var E=s("state");a[E]=!0,h=function(C,I){if(i(C,E))throw new u(l);return I.facade=C,r(C,E,I),I},d=function(C){return i(C,E)?C[E]:{}},f=function(C){return i(C,E)}}return Kw={set:h,get:d,has:f,enforce:p,getterFor:v},Kw}var xM;function FA(){if(xM)return jw.exports;xM=1;var t=Zt(),e=nn(),n=on(),r=ti(),i=Jr(),o=FF().CONFIGURABLE,s=VF(),a=$A(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),p=t([].join),v=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),S=String(String).split("String"),E=jw.exports=function(C,I,H){d(c(I),0,7)==="Symbol("&&(I="["+f(c(I),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),H&&H.getter&&(I="get "+I),H&&H.setter&&(I="set "+I),(!r(C,"name")||o&&C.name!==I)&&(i?h(C,"name",{value:I,configurable:!0}):C.name=I),v&&H&&r(H,"arity")&&C.length!==H.arity&&h(C,"length",{value:H.arity});try{H&&r(H,"constructor")&&H.constructor?i&&h(C,"prototype",{writable:!1}):C.prototype&&(C.prototype=void 0)}catch{}var $=l(C);return r($,"source")||($.source=p(S,typeof I=="string"?I:"")),C};return Function.prototype.toString=E(function(){return n(this)&&u(this).source||s(this)},"toString"),jw.exports}var Xw,HM;function bR(){if(HM)return Xw;HM=1;var t=on(),e=ra(),n=FA(),r=wR();return Xw=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&n(s,u,a),a.global)l?i[o]=s:r(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},Xw}var Zw={},Qw,AM;function BF(){if(AM)return Qw;AM=1;var t=Math.ceil,e=Math.floor;return Qw=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},Qw}var Jw,NM;function Cd(){if(NM)return Jw;NM=1;var t=BF();return Jw=function(e){var n=+e;return n!==n||n===0?0:t(n)},Jw}var ev,DM;function jF(){if(DM)return ev;DM=1;var t=Cd(),e=Math.max,n=Math.min;return ev=function(r,i){var o=t(r);return o<0?e(o+i,0):n(o,i)},ev}var tv,kM;function UF(){if(kM)return tv;kM=1;var t=Cd(),e=Math.min;return tv=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},tv}var nv,LM;function Zu(){if(LM)return nv;LM=1;var t=UF();return nv=function(e){return t(e.length)},nv}var rv,$M;function zF(){if($M)return rv;$M=1;var t=pd(),e=jF(),n=Zu(),r=function(i){return function(o,s,a){var l=t(o),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return rv={includes:r(!0),indexOf:r(!1)},rv}var iv,FM;function VA(){if(FM)return iv;FM=1;var t=Zt(),e=ti(),n=pd(),r=zF().indexOf,i=SR(),o=t([].push);return iv=function(s,a){var l=n(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||o(c,h));return c},iv}var ov,VM;function RR(){return VM||(VM=1,ov=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),ov}var WM;function YF(){if(WM)return Zw;WM=1;var t=VA(),e=RR(),n=e.concat("length","prototype");return Zw.f=Object.getOwnPropertyNames||function(i){return t(i,n)},Zw}var sv={},BM;function GF(){return BM||(BM=1,sv.f=Object.getOwnPropertySymbols),sv}var av,jM;function qF(){if(jM)return av;jM=1;var t=qu(),e=Zt(),n=YF(),r=GF(),i=sn(),o=e([].concat);return av=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?o(l,u(a)):l},av}var lv,UM;function WA(){if(UM)return lv;UM=1;var t=ti(),e=qF(),n=kA(),r=ra();return lv=function(i,o,s){for(var a=e(o),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},lv}var uv,zM;function KF(){if(zM)return uv;zM=1;var t=nn(),e=on(),n=/#|\.prototype\./,r=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},o=r.data={},s=r.NATIVE="N",a=r.POLYFILL="P";return uv=r,uv}var cv,YM;function ft(){if(YM)return cv;YM=1;var t=Xt(),e=kA().f,n=Xu(),r=bR(),i=wR(),o=WA(),s=KF();return cv=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,p,v,S,E;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(p in l){if(S=l[p],a.dontCallGetSet?(E=e(f,p),v=E&&E.value):v=f[p],d=s(c?p:u+(h?".":"#")+p,a.forced),!d&&v!==void 0){if(typeof S==typeof v)continue;o(S,v)}(a.sham||v&&v.sham)&&n(S,"sham",!0),r(f,p,S,a)}},cv}var hv,GM;function yd(){if(GM)return hv;GM=1;var t=Km(),e=Function.prototype,n=e.apply,r=e.call;return hv=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),hv}var dv,qM;function BA(){if(qM)return dv;qM=1;var t=Zt(),e=pr();return dv=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},dv}var fv,KM;function XF(){if(KM)return fv;KM=1;var t=ei();return fv=function(e){return t(e)||e===null},fv}var gv,XM;function ZF(){if(XM)return gv;XM=1;var t=XF(),e=String,n=TypeError;return gv=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},gv}var mv,ZM;function jA(){if(ZM)return mv;ZM=1;var t=BA(),e=ei(),n=md(),r=ZF();return mv=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),mv}var pv,QM;function QF(){if(QM)return pv;QM=1;var t=ra().f;return pv=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},pv}var wv,JM;function JF(){if(JM)return wv;JM=1;var t=on(),e=ei(),n=jA();return wv=function(r,i,o){var s,a;return n&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&n(r,a),r},wv}var vv,eI;function eV(){if(eI)return vv;eI=1;var t=xi(),e=t("toStringTag"),n={};return n[e]="z",vv=String(n)==="[object z]",vv}var Cv,tI;function UA(){if(tI)return Cv;tI=1;var t=eV(),e=on(),n=ml(),r=xi(),i=r("toStringTag"),o=Object,s=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return Cv=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},Cv}var yv,nI;function Jm(){if(nI)return yv;nI=1;var t=UA(),e=String;return yv=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},yv}var Sv,rI;function tV(){if(rI)return Sv;rI=1;var t=Jm();return Sv=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},Sv}var bv,iI;function nV(){if(iI)return bv;iI=1;var t=ei(),e=Xu();return bv=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},bv}var Rv,oI;function rV(){if(oI)return Rv;oI=1;var t=Zt(),e=Error,n=t("".replace),r=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(r);return Rv=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=n(s,i,"");return s},Rv}var Ev,sI;function iV(){if(sI)return Ev;sI=1;var t=nn(),e=Xm();return Ev=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),Ev}var Tv,aI;function oV(){if(aI)return Tv;aI=1;var t=Xu(),e=rV(),n=iV(),r=Error.captureStackTrace;return Tv=function(i,o,s,a){n&&(r?r(i,o):t(i,"stack",e(s,a)))},Tv}var _v,lI;function sV(){if(lI)return _v;lI=1;var t=qu(),e=ti(),n=Xu(),r=wd(),i=jA(),o=WA(),s=QF(),a=JF(),l=tV(),u=nV(),c=oV(),h=Jr(),d=na();return _v=function(f,p,v,S){var E="stackTraceLimit",C=S?2:1,I=f.split("."),H=I[I.length-1],$=t.apply(null,I);if($){var P=$.prototype;if(!d&&e(P,"cause")&&delete P.cause,!v)return $;var x=t("Error"),z=p(function(K,A){var Q=l(S?A:K,void 0),X=S?new $(K):new $;return Q!==void 0&&n(X,"message",Q),c(X,z,X.stack,2),this&&r(P,this)&&a(X,this,z),arguments.length>C&&u(X,arguments[C]),X});if(z.prototype=P,H!=="Error"?i?i(z,x):o(z,x,{name:!0}):h&&E in $&&(s(z,$,E),s(z,$,"prepareStackTrace")),o(z,$),!d)try{P.name!==H&&n(P,"name",H),P.constructor=z}catch{}return z}},_v}var uI;function aV(){if(uI)return D_;uI=1;var t=ft(),e=Xt(),n=yd(),r=sV(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=r(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),D_}aV();var cI={},Mv,hI;function zA(){if(hI)return Mv;hI=1;var t=ml();return Mv=Array.isArray||function(n){return t(n)==="Array"},Mv}var Iv,dI;function YA(){if(dI)return Iv;dI=1;var t=Jr(),e=zA(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return Iv=i?function(o,s){if(e(o)&&!r(o,"length").writable)throw new n("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},Iv}var Pv,fI;function GA(){if(fI)return Pv;fI=1;var t=TypeError,e=9007199254740991;return Pv=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},Pv}var gI;function lV(){if(gI)return cI;gI=1;var t=ft(),e=Ku(),n=Zu(),r=YA(),i=GA(),o=nn(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var p=0;p<f;p++)h[d]=arguments[p],d++;return r(h,d),d}}),cI}lV();var mI={},Ov,pI;function uV(){if(pI)return Ov;pI=1;var t=ml(),e=Zt();return Ov=function(n){if(t(n)==="Function")return e(n)},Ov}var xv,wI;function qA(){if(wI)return xv;wI=1;var t=uV(),e=pr(),n=Km(),r=t(t.bind);return xv=function(i,o){return e(i),o===void 0?i:n?r(i,o):function(){return i.apply(o,arguments)}},xv}var Hv,vI;function KA(){return vI||(vI=1,Hv={}),Hv}var Av,CI;function cV(){if(CI)return Av;CI=1;var t=xi(),e=KA(),n=t("iterator"),r=Array.prototype;return Av=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},Av}var Nv,yI;function ER(){if(yI)return Nv;yI=1;var t=UA(),e=vd(),n=gR(),r=KA(),i=xi(),o=i("iterator");return Nv=function(s){if(!n(s))return e(s,o)||e(s,"@@iterator")||r[t(s)]},Nv}var Dv,SI;function hV(){if(SI)return Dv;SI=1;var t=rn(),e=pr(),n=sn(),r=Qm(),i=ER(),o=TypeError;return Dv=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return n(t(l,s));throw new o(r(s)+" is not iterable")},Dv}var kv,bI;function wr(){if(bI)return kv;bI=1;var t=rn(),e=sn(),n=vd();return kv=function(r,i,o){var s,a;e(r);try{if(s=n(r,"return"),!s){if(i==="throw")throw o;return o}s=t(s,r)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},kv}var Lv,RI;function Qu(){if(RI)return Lv;RI=1;var t=qA(),e=rn(),n=sn(),r=Qm(),i=cV(),o=Zu(),s=wd(),a=hV(),l=ER(),u=wr(),c=TypeError,h=function(f,p){this.stopped=f,this.result=p},d=h.prototype;return Lv=function(f,p,v){var S=v&&v.that,E=!!(v&&v.AS_ENTRIES),C=!!(v&&v.IS_RECORD),I=!!(v&&v.IS_ITERATOR),H=!!(v&&v.INTERRUPTED),$=t(p,S),P,x,z,K,A,Q,X,se=function(ue){return P&&u(P,"normal"),new h(!0,ue)},ee=function(ue){return E?(n(ue),H?$(ue[0],ue[1],se):$(ue[0],ue[1])):H?$(ue,se):$(ue)};if(C)P=f.iterator;else if(I)P=f;else{if(x=l(f),!x)throw new c(r(f)+" is not iterable");if(i(x)){for(z=0,K=o(f);K>z;z++)if(A=ee(f[z]),A&&s(d,A))return A;return new h(!1)}P=a(f,x)}for(Q=C?f.next:P.next;!(X=e(Q,P)).done;){try{A=ee(X.value)}catch(ue){u(P,"throw",ue)}if(typeof A=="object"&&A&&s(d,A))return A}return new h(!1)},Lv}var $v,EI;function XA(){if(EI)return $v;EI=1;var t=Jr(),e=ra(),n=Xm();return $v=function(r,i,o){t?e.f(r,i,n(0,o)):r[i]=o},$v}var TI;function dV(){if(TI)return mI;TI=1;var t=ft(),e=Qu(),n=XA();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){n(o,s,a)},{AS_ENTRIES:!0}),o}}),mI}dV();var _I={},Fv,MI;function fo(){if(MI)return Fv;MI=1;var t=Zt(),e=Set.prototype;return Fv={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Fv}var Vv,II;function pl(){if(II)return Vv;II=1;var t=fo().has;return Vv=function(e){return t(e),e},Vv}var Wv,PI;function wl(){if(PI)return Wv;PI=1;var t=rn();return Wv=function(e,n,r){for(var i=r?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=n(s.value),a!==void 0)return a},Wv}var Bv,OI;function Sd(){if(OI)return Bv;OI=1;var t=Zt(),e=wl(),n=fo(),r=n.Set,i=n.proto,o=t(i.forEach),s=t(i.keys),a=s(new r).next;return Bv=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},Bv}var jv,xI;function TR(){if(xI)return jv;xI=1;var t=fo(),e=Sd(),n=t.Set,r=t.add;return jv=function(i){var o=new n;return e(i,function(s){r(o,s)}),o},jv}var Uv,HI;function bd(){if(HI)return Uv;HI=1;var t=BA(),e=fo();return Uv=t(e.proto,"size","get")||function(n){return n.size},Uv}var zv,AI;function go(){return AI||(AI=1,zv=function(t){return{iterator:t,next:t.next,done:!1}}),zv}var Yv,NI;function vl(){if(NI)return Yv;NI=1;var t=pr(),e=sn(),n=rn(),r=Cd(),i=go(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},Yv=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=r(h);if(d<0)throw new s(o);return new u(c,d)},Yv}var Gv,DI;function fV(){if(DI)return Gv;DI=1;var t=pl(),e=fo(),n=TR(),r=bd(),i=vl(),o=Sd(),s=wl(),a=e.has,l=e.remove;return Gv=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?o(h,function(p){d.includes(p)&&l(f,p)}):s(d.getIterator(),function(p){a(f,p)&&l(f,p)}),f},Gv}var qv,kI;function Cl(){if(kI)return qv;kI=1;var t=qu(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return qv=function(r,i){var o=t("Set");try{new o()[r](e(0));try{return new o()[r](e(-1)),!1}catch{if(!i)return!0;try{return new o()[r](n(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[r](n(1/0)))}}}catch{return!1}},qv}var LI;function gV(){if(LI)return _I;LI=1;var t=ft(),e=fV(),n=nn(),r=Cl(),i=!r("difference",function(s){return s.size===0}),o=i||n(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),_I}gV();var $I={},Kv,FI;function mV(){if(FI)return Kv;FI=1;var t=pl(),e=fo(),n=bd(),r=vl(),i=Sd(),o=wl(),s=e.Set,a=e.add,l=e.has;return Kv=function(c){var h=t(this),d=r(c),f=new s;return n(h)>d.size?o(d.getIterator(),function(p){l(h,p)&&a(f,p)}):i(h,function(p){d.includes(p)&&a(f,p)}),f},Kv}var VI;function pV(){if(VI)return $I;VI=1;var t=ft(),e=nn(),n=mV(),r=Cl(),i=!r("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),$I}pV();var WI={},Xv,BI;function wV(){if(BI)return Xv;BI=1;var t=pl(),e=fo().has,n=bd(),r=vl(),i=Sd(),o=wl(),s=wr();return Xv=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},Xv}var jI;function vV(){if(jI)return WI;jI=1;var t=ft(),e=wV(),n=Cl(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),WI}vV();var UI={},Zv,zI;function CV(){if(zI)return Zv;zI=1;var t=pl(),e=bd(),n=Sd(),r=vl();return Zv=function(o){var s=t(this),a=r(o);return e(s)>a.size?!1:n(s,function(l){if(!a.includes(l))return!1},!0)!==!1},Zv}var YI;function yV(){if(YI)return UI;YI=1;var t=ft(),e=CV(),n=Cl(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),UI}yV();var GI={},Qv,qI;function SV(){if(qI)return Qv;qI=1;var t=pl(),e=fo().has,n=bd(),r=vl(),i=wl(),o=wr();return Qv=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},Qv}var KI;function bV(){if(KI)return GI;KI=1;var t=ft(),e=SV(),n=Cl(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),GI}bV();var XI={},Jv,ZI;function RV(){if(ZI)return Jv;ZI=1;var t=pl(),e=fo(),n=TR(),r=vl(),i=wl(),o=e.add,s=e.has,a=e.remove;return Jv=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){s(c,f)?a(d,f):o(d,f)}),d},Jv}var eC,QI;function ZA(){return QI||(QI=1,eC=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[t](n);return r.size===1&&r.values().next().value===4}catch{return!1}}),eC}var JI;function EV(){if(JI)return XI;JI=1;var t=ft(),e=RV(),n=ZA(),r=Cl(),i=!r("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),XI}EV();var eP={},tC,tP;function TV(){if(tP)return tC;tP=1;var t=pl(),e=fo().add,n=TR(),r=vl(),i=wl();return tC=function(s){var a=t(this),l=r(s).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},tC}var nP;function _V(){if(nP)return eP;nP=1;var t=ft(),e=TV(),n=ZA(),r=Cl(),i=!r("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),eP}_V();var rP={},iP={},nC,oP;function MV(){if(oP)return nC;oP=1;var t=wd(),e=TypeError;return nC=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},nC}var rC,sP;function IV(){if(sP)return rC;sP=1;var t=nn();return rC=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),rC}var iC,aP;function QA(){if(aP)return iC;aP=1;var t=ti(),e=on(),n=Ku(),r=yR(),i=IV(),o=r("IE_PROTO"),s=Object,a=s.prototype;return iC=i?s.getPrototypeOf:function(l){var u=n(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},iC}var oC,lP;function PV(){if(lP)return oC;lP=1;var t=FA(),e=ra();return oC=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},oC}var sC={},aC,uP;function OV(){if(uP)return aC;uP=1;var t=VA(),e=RR();return aC=Object.keys||function(r){return t(r,e)},aC}var cP;function xV(){if(cP)return sC;cP=1;var t=Jr(),e=LA(),n=ra(),r=sn(),i=pd(),o=OV();return sC.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=o(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},sC}var lC,hP;function JA(){if(hP)return lC;hP=1;var t=qu();return lC=t("document","documentElement"),lC}var uC,dP;function _R(){if(dP)return uC;dP=1;var t=sn(),e=xV(),n=RR(),r=SR(),i=JA(),o=CR(),s=yR(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},f=function(C){return l+c+a+C+l+"/"+c+a},p=function(C){C.write(f("")),C.close();var I=C.parentWindow.Object;return C=null,I},v=function(){var C=o("iframe"),I="java"+c+":",H;return C.style.display="none",i.appendChild(C),C.src=String(I),H=C.contentWindow.document,H.open(),H.write(f("document.F=Object")),H.close(),H.F},S,E=function(){try{S=new ActiveXObject("htmlfile")}catch{}E=typeof document<"u"?document.domain&&S?p(S):v():p(S);for(var C=n.length;C--;)delete E[u][n[C]];return E()};return r[h]=!0,uC=Object.create||function(I,H){var $;return I!==null?(d[u]=t(I),$=new d,d[u]=null,$[h]=I):$=E(),H===void 0?$:e.f($,H)},uC}var cC,fP;function eN(){if(fP)return cC;fP=1;var t=nn(),e=on(),n=ei(),r=_R(),i=QA(),o=bR(),s=xi(),a=na(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var p={};return c[l].call(p)!==p});return f?c={}:a&&(c=r(c)),e(c[l])||o(c,l,function(){return this}),cC={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},cC}var gP;function HV(){if(gP)return iP;gP=1;var t=ft(),e=Xt(),n=MV(),r=sn(),i=on(),o=QA(),s=PV(),a=XA(),l=nn(),u=ti(),c=xi(),h=eN().IteratorPrototype,d=Jr(),f=na(),p="constructor",v="Iterator",S=c("toStringTag"),E=TypeError,C=e[v],I=f||!i(C)||C.prototype!==h||!l(function(){C({})}),H=function(){if(n(this,h),o(this)===h)throw new E("Abstract class Iterator not directly constructable")},$=function(P,x){d?s(h,P,{configurable:!0,get:function(){return x},set:function(z){if(r(this),this===h)throw new E("You can't redefine this property");u(this,P)?this[P]=z:a(this,P,z)}}):h[P]=x};return u(h,S)||$(S,v),(I||!u(h,p)||h[p]===Object)&&$(p,H),H.prototype=h,t({global:!0,constructor:!0,forced:I},{Iterator:H}),iP}var mP;function AV(){return mP||(mP=1,HV()),rP}AV();var pP={},wP={},hC,vP;function NV(){if(vP)return hC;vP=1;var t=bR();return hC=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},hC}var dC,CP;function DV(){return CP||(CP=1,dC=function(t,e){return{value:t,done:e}}),dC}var fC,yP;function kV(){if(yP)return fC;yP=1;var t=wr();return fC=function(e,n,r){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{r=t(e[i].iterator,n,r)}catch(o){n="throw",r=o}if(n==="throw")throw r;return r},fC}var gC,SP;function MR(){if(SP)return gC;SP=1;var t=rn(),e=_R(),n=Xu(),r=NV(),i=xi(),o=$A(),s=vd(),a=eN().IteratorPrototype,l=DV(),u=wr(),c=kV(),h=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",p="normal",v="throw",S=o.set,E=function(H){var $=o.getterFor(H?f:d);return r(e(a),{next:function(){var x=$(this);if(H)return x.nextHandler();if(x.done)return l(void 0,!0);try{var z=x.nextHandler();return x.returnHandlerResult?z:l(z,x.done)}catch(K){throw x.done=!0,K}},return:function(){var P=$(this),x=P.iterator;if(P.done=!0,H){var z=s(x,"return");return z?t(z,x):l(void 0,!0)}if(P.inner)try{u(P.inner.iterator,p)}catch(K){return u(x,v,K)}if(P.openIters)try{c(P.openIters,p)}catch(K){return u(x,v,K)}return x&&u(x,p),l(void 0,!0)}})},C=E(!0),I=E(!1);return n(I,h,"Iterator Helper"),gC=function(H,$,P){var x=function(K,A){A?(A.iterator=K.iterator,A.next=K.next):A=K,A.type=$?f:d,A.returnHandlerResult=!!P,A.nextHandler=H,A.counter=0,A.done=!1,S(this,A)};return x.prototype=$?C:I,x},gC}var mC,bP;function tN(){if(bP)return mC;bP=1;var t=sn(),e=wr();return mC=function(n,r,i,o){try{return o?r(t(i)[0],i[1]):r(i)}catch(s){e(n,"throw",s)}},mC}var pC,RP;function IR(){return RP||(RP=1,pC=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),pC}var wC,EP;function ia(){if(EP)return wC;EP=1;var t=Xt();return wC=function(e,n){var r=t.Iterator,i=r&&r.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof n||(s=!1)}if(!s)return o},wC}var TP;function LV(){if(TP)return wP;TP=1;var t=ft(),e=rn(),n=pr(),r=sn(),i=go(),o=MR(),s=tN(),a=na(),l=wr(),u=IR(),c=ia(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),f=a||h||d,p=o(function(){for(var v=this.iterator,S=this.predicate,E=this.next,C,I,H;;){if(C=r(e(E,v)),I=this.done=!!C.done,I)return;if(H=C.value,s(v,S,[H,this.counter++],!0))return H}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(S){r(this);try{n(S)}catch(E){l(this,"throw",E)}return d?e(d,this,S):new p(i(this),{predicate:S})}}),wP}var _P;function $V(){return _P||(_P=1,LV()),pP}$V();var MP={},IP={},PP;function FV(){if(PP)return IP;PP=1;var t=ft(),e=rn(),n=Qu(),r=pr(),i=sn(),o=go(),s=wr(),a=ia(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),IP}var OP;function VV(){return OP||(OP=1,FV()),MP}VV();var xP={},HP={},AP;function WV(){if(AP)return HP;AP=1;var t=ft(),e=rn(),n=pr(),r=sn(),i=go(),o=MR(),s=tN(),a=wr(),l=IR(),u=ia(),c=na(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),f=c||h||d,p=o(function(){var v=this.iterator,S=r(e(this.next,v)),E=this.done=!!S.done;if(!E)return s(v,this.mapper,[S.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(S){r(this);try{n(S)}catch(E){a(this,"throw",E)}return d?e(d,this,S):new p(i(this),{mapper:S})}}),HP}var NP;function BV(){return NP||(NP=1,WV()),xP}BV();var DP={},kP={},vC,LP;function PR(){if(LP)return vC;LP=1;var t=Zt();return vC=t([].slice),vC}var CC,$P;function nN(){if($P)return CC;$P=1;var t=TypeError;return CC=function(e,n){if(e<n)throw new t("Not enough arguments");return e},CC}var yC,FP;function jV(){if(FP)return yC;FP=1;var t=Zm();return yC=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),yC}var SC,VP;function rN(){if(VP)return SC;VP=1;var t=Xt(),e=Zm(),n=ml(),r=function(i){return e.slice(0,i.length)===i};return SC=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),SC}var bC,WP;function UV(){if(WP)return bC;WP=1;var t=rN();return bC=t==="NODE",bC}var RC,BP;function iN(){if(BP)return RC;BP=1;var t=Xt(),e=yd(),n=qA(),r=on(),i=ti(),o=nn(),s=JA(),a=PR(),l=CR(),u=nN(),c=jV(),h=UV(),d=t.setImmediate,f=t.clearImmediate,p=t.process,v=t.Dispatch,S=t.Function,E=t.MessageChannel,C=t.String,I=0,H={},$="onreadystatechange",P,x,z,K;o(function(){P=t.location});var A=function(ee){if(i(H,ee)){var ue=H[ee];delete H[ee],ue()}},Q=function(ee){return function(){A(ee)}},X=function(ee){A(ee.data)},se=function(ee){t.postMessage(C(ee),P.protocol+"//"+P.host)};return(!d||!f)&&(d=function(ue){u(arguments.length,1);var vt=r(ue)?ue:S(ue),Ne=a(arguments,1);return H[++I]=function(){e(vt,void 0,Ne)},x(I),I},f=function(ue){delete H[ue]},h?x=function(ee){p.nextTick(Q(ee))}:v&&v.now?x=function(ee){v.now(Q(ee))}:E&&!c?(z=new E,K=z.port2,z.port1.onmessage=X,x=n(K.postMessage,K)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&P&&P.protocol!=="file:"&&!o(se)?(x=se,t.addEventListener("message",X,!1)):$ in l("script")?x=function(ee){s.appendChild(l("script"))[$]=function(){s.removeChild(this),A(ee)}}:x=function(ee){setTimeout(Q(ee),0)}),RC={set:d,clear:f},RC}var jP;function zV(){if(jP)return kP;jP=1;var t=ft(),e=Xt(),n=iN().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),kP}var UP={},EC,zP;function YV(){if(zP)return EC;zP=1;var t=Xt(),e=yd(),n=on(),r=rN(),i=Zm(),o=PR(),s=nN(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return EC=function(u,c){var h=c?2:1;return l?function(d,f){var p=s(arguments.length,1)>h,v=n(d)?d:a(d),S=p?o(arguments,h):[],E=p?function(){e(v,this,S)}:v;return c?u(E,f):u(E)}:u},EC}var YP;function GV(){if(YP)return UP;YP=1;var t=ft(),e=Xt(),n=iN().set,r=YV(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),UP}var GP;function qV(){return GP||(GP=1,zV(),GV()),DP}qV();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:oN,setPrototypeOf:qP,isFrozen:KV,getPrototypeOf:XV,getOwnPropertyDescriptor:ZV}=Object;let{freeze:qn,seal:Zr,create:sN}=Object,{apply:ab,construct:lb}=typeof Reflect<"u"&&Reflect;qn||(qn=function(e){return e});Zr||(Zr=function(e){return e});ab||(ab=function(e,n,r){return e.apply(n,r)});lb||(lb=function(e,n){return new e(...n)});const Gd=Kn(Array.prototype.forEach),QV=Kn(Array.prototype.lastIndexOf),KP=Kn(Array.prototype.pop),fc=Kn(Array.prototype.push),JV=Kn(Array.prototype.splice),Og=Kn(String.prototype.toLowerCase),TC=Kn(String.prototype.toString),XP=Kn(String.prototype.match),gc=Kn(String.prototype.replace),eW=Kn(String.prototype.indexOf),tW=Kn(String.prototype.trim),wi=Kn(Object.prototype.hasOwnProperty),Fn=Kn(RegExp.prototype.test),mc=nW(TypeError);function Kn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return ab(t,e,r)}}function nW(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return lb(t,n)}}function De(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Og;qP&&qP(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(KV(e)||(e[r]=o),i=o)}t[i]=!0}return t}function rW(t){for(let e=0;e<t.length;e++)wi(t,e)||(t[e]=null);return t}function Do(t){const e=sN(null);for(const[n,r]of oN(t))wi(t,n)&&(Array.isArray(r)?e[n]=rW(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Do(r):e[n]=r);return e}function pc(t,e){for(;t!==null;){const r=ZV(t,e);if(r){if(r.get)return Kn(r.get);if(typeof r.value=="function")return Kn(r.value)}t=XV(t)}function n(){return null}return n}const ZP=qn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_C=qn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),MC=qn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),iW=qn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),IC=qn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),oW=qn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),QP=qn(["#text"]),JP=qn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),PC=qn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),eO=qn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),qd=qn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),sW=Zr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),aW=Zr(/<%[\w\W]*|[\w\W]*%>/gm),lW=Zr(/\$\{[\w\W]*/gm),uW=Zr(/^data-[\-\w.\u00B7-\uFFFF]+$/),cW=Zr(/^aria-[\-\w]+$/),aN=Zr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),hW=Zr(/^(?:\w+script|data):/i),dW=Zr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),lN=Zr(/^html$/i),fW=Zr(/^[a-z][.\w]*(-[.\w]+)+$/i);var tO=Object.freeze({__proto__:null,ARIA_ATTR:cW,ATTR_WHITESPACE:dW,CUSTOM_ELEMENT:fW,DATA_ATTR:uW,DOCTYPE_NAME:lN,ERB_EXPR:aW,IS_ALLOWED_URI:aN,IS_SCRIPT_OR_DATA:hW,MUSTACHE_EXPR:sW,TMPLIT_EXPR:lW});const wc={element:1,text:3,progressingInstruction:7,comment:8,document:9},gW=function(){return typeof window>"u"?null:window},mW=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},nO=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function uN(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gW();const e=pe=>uN(pe);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==wc.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,p=l.prototype,v=pc(p,"cloneNode"),S=pc(p,"remove"),E=pc(p,"nextSibling"),C=pc(p,"childNodes"),I=pc(p,"parentNode");if(typeof s=="function"){const pe=n.createElement("template");pe.content&&pe.content.ownerDocument&&(n=pe.content.ownerDocument)}let H,$="";const{implementation:P,createNodeIterator:x,createDocumentFragment:z,getElementsByTagName:K}=n,{importNode:A}=r;let Q=nO();e.isSupported=typeof oN=="function"&&typeof I=="function"&&P&&P.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:X,ERB_EXPR:se,TMPLIT_EXPR:ee,DATA_ATTR:ue,ARIA_ATTR:vt,IS_SCRIPT_OR_DATA:Ne,ATTR_WHITESPACE:$e,CUSTOM_ELEMENT:Ct}=tO;let{IS_ALLOWED_URI:rt}=tO,at=null;const mn=De({},[...ZP,..._C,...MC,...IC,...QP]);let g=null;const m=De({},[...JP,...PC,...eO,...qd]);let y=Object.seal(sN(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),N=null,F=null,B=!0,G=!0,w=!1,b=!0,R=!1,T=!0,M=!1,k=!1,W=!1,O=!1,L=!1,V=!1,j=!0,U=!1;const ie="user-content-";let oe=!0,be=!1,Fe={},Ve=null;const Re=De({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ye=null;const Je=De({},["audio","video","img","source","image","track"]);let Zn=null;const Co=De({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ai="http://www.w3.org/1998/Math/MathML",ln="http://www.w3.org/2000/svg",yt="http://www.w3.org/1999/xhtml";let _t=yt,gt=!1,Xe=null;const Hr=De({},[ai,ln,yt],TC);let $n=De({},["mi","mo","mn","ms","mtext"]),la=De({},["annotation-xml"]);const Yd=De({},["title","style","font","a","script"]);let cc=null;const CF=["application/xhtml+xml","text/html"],yF="text/html";let pn=null,_l=null;const SF=n.createElement("form"),S_=function(D){return D instanceof RegExp||D instanceof Function},Qp=function(){let D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(_l&&_l===D)){if((!D||typeof D!="object")&&(D={}),D=Do(D),cc=CF.indexOf(D.PARSER_MEDIA_TYPE)===-1?yF:D.PARSER_MEDIA_TYPE,pn=cc==="application/xhtml+xml"?TC:Og,at=wi(D,"ALLOWED_TAGS")?De({},D.ALLOWED_TAGS,pn):mn,g=wi(D,"ALLOWED_ATTR")?De({},D.ALLOWED_ATTR,pn):m,Xe=wi(D,"ALLOWED_NAMESPACES")?De({},D.ALLOWED_NAMESPACES,TC):Hr,Zn=wi(D,"ADD_URI_SAFE_ATTR")?De(Do(Co),D.ADD_URI_SAFE_ATTR,pn):Co,ye=wi(D,"ADD_DATA_URI_TAGS")?De(Do(Je),D.ADD_DATA_URI_TAGS,pn):Je,Ve=wi(D,"FORBID_CONTENTS")?De({},D.FORBID_CONTENTS,pn):Re,N=wi(D,"FORBID_TAGS")?De({},D.FORBID_TAGS,pn):Do({}),F=wi(D,"FORBID_ATTR")?De({},D.FORBID_ATTR,pn):Do({}),Fe=wi(D,"USE_PROFILES")?D.USE_PROFILES:!1,B=D.ALLOW_ARIA_ATTR!==!1,G=D.ALLOW_DATA_ATTR!==!1,w=D.ALLOW_UNKNOWN_PROTOCOLS||!1,b=D.ALLOW_SELF_CLOSE_IN_ATTR!==!1,R=D.SAFE_FOR_TEMPLATES||!1,T=D.SAFE_FOR_XML!==!1,M=D.WHOLE_DOCUMENT||!1,O=D.RETURN_DOM||!1,L=D.RETURN_DOM_FRAGMENT||!1,V=D.RETURN_TRUSTED_TYPE||!1,W=D.FORCE_BODY||!1,j=D.SANITIZE_DOM!==!1,U=D.SANITIZE_NAMED_PROPS||!1,oe=D.KEEP_CONTENT!==!1,be=D.IN_PLACE||!1,rt=D.ALLOWED_URI_REGEXP||aN,_t=D.NAMESPACE||yt,$n=D.MATHML_TEXT_INTEGRATION_POINTS||$n,la=D.HTML_INTEGRATION_POINTS||la,y=D.CUSTOM_ELEMENT_HANDLING||{},D.CUSTOM_ELEMENT_HANDLING&&S_(D.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(y.tagNameCheck=D.CUSTOM_ELEMENT_HANDLING.tagNameCheck),D.CUSTOM_ELEMENT_HANDLING&&S_(D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(y.attributeNameCheck=D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),D.CUSTOM_ELEMENT_HANDLING&&typeof D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(y.allowCustomizedBuiltInElements=D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),R&&(G=!1),L&&(O=!0),Fe&&(at=De({},QP),g=[],Fe.html===!0&&(De(at,ZP),De(g,JP)),Fe.svg===!0&&(De(at,_C),De(g,PC),De(g,qd)),Fe.svgFilters===!0&&(De(at,MC),De(g,PC),De(g,qd)),Fe.mathMl===!0&&(De(at,IC),De(g,eO),De(g,qd))),D.ADD_TAGS&&(at===mn&&(at=Do(at)),De(at,D.ADD_TAGS,pn)),D.ADD_ATTR&&(g===m&&(g=Do(g)),De(g,D.ADD_ATTR,pn)),D.ADD_URI_SAFE_ATTR&&De(Zn,D.ADD_URI_SAFE_ATTR,pn),D.FORBID_CONTENTS&&(Ve===Re&&(Ve=Do(Ve)),De(Ve,D.FORBID_CONTENTS,pn)),oe&&(at["#text"]=!0),M&&De(at,["html","head","body"]),at.table&&(De(at,["tbody"]),delete N.tbody),D.TRUSTED_TYPES_POLICY){if(typeof D.TRUSTED_TYPES_POLICY.createHTML!="function")throw mc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof D.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw mc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');H=D.TRUSTED_TYPES_POLICY,$=H.createHTML("")}else H===void 0&&(H=mW(f,i)),H!==null&&typeof $=="string"&&($=H.createHTML(""));qn&&qn(D),_l=D}},b_=De({},[..._C,...MC,...iW]),R_=De({},[...IC,...oW]),bF=function(D){let J=I(D);(!J||!J.tagName)&&(J={namespaceURI:_t,tagName:"template"});const ge=Og(D.tagName),Mt=Og(J.tagName);return Xe[D.namespaceURI]?D.namespaceURI===ln?J.namespaceURI===yt?ge==="svg":J.namespaceURI===ai?ge==="svg"&&(Mt==="annotation-xml"||$n[Mt]):!!b_[ge]:D.namespaceURI===ai?J.namespaceURI===yt?ge==="math":J.namespaceURI===ln?ge==="math"&&la[Mt]:!!R_[ge]:D.namespaceURI===yt?J.namespaceURI===ln&&!la[Mt]||J.namespaceURI===ai&&!$n[Mt]?!1:!R_[ge]&&(Yd[ge]||!b_[ge]):!!(cc==="application/xhtml+xml"&&Xe[D.namespaceURI]):!1},Ai=function(D){fc(e.removed,{element:D});try{I(D).removeChild(D)}catch{S(D)}},Ml=function(D,J){try{fc(e.removed,{attribute:J.getAttributeNode(D),from:J})}catch{fc(e.removed,{attribute:null,from:J})}if(J.removeAttribute(D),D==="is")if(O||L)try{Ai(J)}catch{}else try{J.setAttribute(D,"")}catch{}},E_=function(D){let J=null,ge=null;if(W)D="<remove></remove>"+D;else{const un=XP(D,/^[\r\n\t ]+/);ge=un&&un[0]}cc==="application/xhtml+xml"&&_t===yt&&(D='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+D+"</body></html>");const Mt=H?H.createHTML(D):D;if(_t===yt)try{J=new d().parseFromString(Mt,cc)}catch{}if(!J||!J.documentElement){J=P.createDocument(_t,"template",null);try{J.documentElement.innerHTML=gt?$:Mt}catch{}}const En=J.body||J.documentElement;return D&&ge&&En.insertBefore(n.createTextNode(ge),En.childNodes[0]||null),_t===yt?K.call(J,M?"html":"body")[0]:M?J.documentElement:En},T_=function(D){return x.call(D.ownerDocument||D,D,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Jp=function(D){return D instanceof h&&(typeof D.nodeName!="string"||typeof D.textContent!="string"||typeof D.removeChild!="function"||!(D.attributes instanceof c)||typeof D.removeAttribute!="function"||typeof D.setAttribute!="function"||typeof D.namespaceURI!="string"||typeof D.insertBefore!="function"||typeof D.hasChildNodes!="function")},__=function(D){return typeof a=="function"&&D instanceof a};function yo(pe,D,J){Gd(pe,ge=>{ge.call(e,D,J,_l)})}const M_=function(D){let J=null;if(yo(Q.beforeSanitizeElements,D,null),Jp(D))return Ai(D),!0;const ge=pn(D.nodeName);if(yo(Q.uponSanitizeElement,D,{tagName:ge,allowedTags:at}),T&&D.hasChildNodes()&&!__(D.firstElementChild)&&Fn(/<[/\w!]/g,D.innerHTML)&&Fn(/<[/\w!]/g,D.textContent)||D.nodeType===wc.progressingInstruction||T&&D.nodeType===wc.comment&&Fn(/<[/\w]/g,D.data))return Ai(D),!0;if(!at[ge]||N[ge]){if(!N[ge]&&P_(ge)&&(y.tagNameCheck instanceof RegExp&&Fn(y.tagNameCheck,ge)||y.tagNameCheck instanceof Function&&y.tagNameCheck(ge)))return!1;if(oe&&!Ve[ge]){const Mt=I(D)||D.parentNode,En=C(D)||D.childNodes;if(En&&Mt){const un=En.length;for(let Qn=un-1;Qn>=0;--Qn){const So=v(En[Qn],!0);So.__removalCount=(D.__removalCount||0)+1,Mt.insertBefore(So,E(D))}}}return Ai(D),!0}return D instanceof l&&!bF(D)||(ge==="noscript"||ge==="noembed"||ge==="noframes")&&Fn(/<\/no(script|embed|frames)/i,D.innerHTML)?(Ai(D),!0):(R&&D.nodeType===wc.text&&(J=D.textContent,Gd([X,se,ee],Mt=>{J=gc(J,Mt," ")}),D.textContent!==J&&(fc(e.removed,{element:D.cloneNode()}),D.textContent=J)),yo(Q.afterSanitizeElements,D,null),!1)},I_=function(D,J,ge){if(j&&(J==="id"||J==="name")&&(ge in n||ge in SF))return!1;if(!(G&&!F[J]&&Fn(ue,J))){if(!(B&&Fn(vt,J))){if(!g[J]||F[J]){if(!(P_(D)&&(y.tagNameCheck instanceof RegExp&&Fn(y.tagNameCheck,D)||y.tagNameCheck instanceof Function&&y.tagNameCheck(D))&&(y.attributeNameCheck instanceof RegExp&&Fn(y.attributeNameCheck,J)||y.attributeNameCheck instanceof Function&&y.attributeNameCheck(J))||J==="is"&&y.allowCustomizedBuiltInElements&&(y.tagNameCheck instanceof RegExp&&Fn(y.tagNameCheck,ge)||y.tagNameCheck instanceof Function&&y.tagNameCheck(ge))))return!1}else if(!Zn[J]){if(!Fn(rt,gc(ge,$e,""))){if(!((J==="src"||J==="xlink:href"||J==="href")&&D!=="script"&&eW(ge,"data:")===0&&ye[D])){if(!(w&&!Fn(Ne,gc(ge,$e,"")))){if(ge)return!1}}}}}}return!0},P_=function(D){return D!=="annotation-xml"&&XP(D,Ct)},O_=function(D){yo(Q.beforeSanitizeAttributes,D,null);const{attributes:J}=D;if(!J||Jp(D))return;const ge={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:g,forceKeepAttr:void 0};let Mt=J.length;for(;Mt--;){const En=J[Mt],{name:un,namespaceURI:Qn,value:So}=En,hc=pn(un),ew=So;let Tn=un==="value"?ew:tW(ew);if(ge.attrName=hc,ge.attrValue=Tn,ge.keepAttr=!0,ge.forceKeepAttr=void 0,yo(Q.uponSanitizeAttribute,D,ge),Tn=ge.attrValue,U&&(hc==="id"||hc==="name")&&(Ml(un,D),Tn=ie+Tn),T&&Fn(/((--!?|])>)|<\/(style|title)/i,Tn)){Ml(un,D);continue}if(ge.forceKeepAttr)continue;if(!ge.keepAttr){Ml(un,D);continue}if(!b&&Fn(/\/>/i,Tn)){Ml(un,D);continue}R&&Gd([X,se,ee],H_=>{Tn=gc(Tn,H_," ")});const x_=pn(D.nodeName);if(!I_(x_,hc,Tn)){Ml(un,D);continue}if(H&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Qn)switch(f.getAttributeType(x_,hc)){case"TrustedHTML":{Tn=H.createHTML(Tn);break}case"TrustedScriptURL":{Tn=H.createScriptURL(Tn);break}}if(Tn!==ew)try{Qn?D.setAttributeNS(Qn,un,Tn):D.setAttribute(un,Tn),Jp(D)?Ai(D):KP(e.removed)}catch{Ml(un,D)}}yo(Q.afterSanitizeAttributes,D,null)},RF=function pe(D){let J=null;const ge=T_(D);for(yo(Q.beforeSanitizeShadowDOM,D,null);J=ge.nextNode();)yo(Q.uponSanitizeShadowNode,J,null),M_(J),O_(J),J.content instanceof o&&pe(J.content);yo(Q.afterSanitizeShadowDOM,D,null)};return e.sanitize=function(pe){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},J=null,ge=null,Mt=null,En=null;if(gt=!pe,gt&&(pe="<!-->"),typeof pe!="string"&&!__(pe))if(typeof pe.toString=="function"){if(pe=pe.toString(),typeof pe!="string")throw mc("dirty is not a string, aborting")}else throw mc("toString is not a function");if(!e.isSupported)return pe;if(k||Qp(D),e.removed=[],typeof pe=="string"&&(be=!1),be){if(pe.nodeName){const So=pn(pe.nodeName);if(!at[So]||N[So])throw mc("root node is forbidden and cannot be sanitized in-place")}}else if(pe instanceof a)J=E_("<!---->"),ge=J.ownerDocument.importNode(pe,!0),ge.nodeType===wc.element&&ge.nodeName==="BODY"||ge.nodeName==="HTML"?J=ge:J.appendChild(ge);else{if(!O&&!R&&!M&&pe.indexOf("<")===-1)return H&&V?H.createHTML(pe):pe;if(J=E_(pe),!J)return O?null:V?$:""}J&&W&&Ai(J.firstChild);const un=T_(be?pe:J);for(;Mt=un.nextNode();)M_(Mt),O_(Mt),Mt.content instanceof o&&RF(Mt.content);if(be)return pe;if(O){if(L)for(En=z.call(J.ownerDocument);J.firstChild;)En.appendChild(J.firstChild);else En=J;return(g.shadowroot||g.shadowrootmode)&&(En=A.call(r,En,!0)),En}let Qn=M?J.outerHTML:J.innerHTML;return M&&at["!doctype"]&&J.ownerDocument&&J.ownerDocument.doctype&&J.ownerDocument.doctype.name&&Fn(lN,J.ownerDocument.doctype.name)&&(Qn="<!DOCTYPE "+J.ownerDocument.doctype.name+`>
`+Qn),R&&Gd([X,se,ee],So=>{Qn=gc(Qn,So," ")}),H&&V?H.createHTML(Qn):Qn},e.setConfig=function(){let pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Qp(pe),k=!0},e.clearConfig=function(){_l=null,k=!1},e.isValidAttribute=function(pe,D,J){_l||Qp({});const ge=pn(pe),Mt=pn(D);return I_(ge,Mt,J)},e.addHook=function(pe,D){typeof D=="function"&&fc(Q[pe],D)},e.removeHook=function(pe,D){if(D!==void 0){const J=QV(Q[pe],D);return J===-1?void 0:JV(Q[pe],J,1)[0]}return KP(Q[pe])},e.removeHooks=function(pe){Q[pe]=[]},e.removeAllHooks=function(){Q=nO()},e}var pW=uN();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var cN;function q(){return cN.apply(null,arguments)}function wW(t){cN=t}function Ii(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ol(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function OR(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Ze(t,e))return!1;return!0}function ar(t){return t===void 0}function es(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Rd(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function hN(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function $s(t,e){for(var n in e)Ze(e,n)&&(t[n]=e[n]);return Ze(e,"toString")&&(t.toString=e.toString),Ze(e,"valueOf")&&(t.valueOf=e.valueOf),t}function mo(t,e,n,r){return NN(t,e,n,r,!0).utc()}function vW(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ie(t){return t._pf==null&&(t._pf=vW()),t._pf}var ub;Array.prototype.some?ub=Array.prototype.some:ub=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function xR(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Ie(t),n=ub.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function ep(t){var e=mo(NaN);return t!=null?$s(Ie(e),t):Ie(e).userInvalidated=!0,e}var rO=q.momentProperties=[],OC=!1;function HR(t,e){var n,r,i,o=rO.length;if(ar(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),ar(e._i)||(t._i=e._i),ar(e._f)||(t._f=e._f),ar(e._l)||(t._l=e._l),ar(e._strict)||(t._strict=e._strict),ar(e._tzm)||(t._tzm=e._tzm),ar(e._isUTC)||(t._isUTC=e._isUTC),ar(e._offset)||(t._offset=e._offset),ar(e._pf)||(t._pf=Ie(e)),ar(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=rO[n],i=e[r],ar(i)||(t[r]=i);return t}function Ed(t){HR(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),OC===!1&&(OC=!0,q.updateOffset(this),OC=!1)}function Pi(t){return t instanceof Ed||t!=null&&t._isAMomentObject!=null}function dN(t){q.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function ni(t,e){var n=!0;return $s(function(){if(q.deprecationHandler!=null&&q.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Ze(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}dN(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var iO={};function fN(t,e){q.deprecationHandler!=null&&q.deprecationHandler(t,e),iO[t]||(dN(e),iO[t]=!0)}q.suppressDeprecationWarnings=!1;q.deprecationHandler=null;function po(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function CW(t){var e,n;for(n in t)Ze(t,n)&&(e=t[n],po(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function cb(t,e){var n=$s({},t),r;for(r in e)Ze(e,r)&&(ol(t[r])&&ol(e[r])?(n[r]={},$s(n[r],t[r]),$s(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)Ze(t,r)&&!Ze(e,r)&&ol(t[r])&&(n[r]=$s({},n[r]));return n}function AR(t){t!=null&&this.set(t)}var hb;Object.keys?hb=Object.keys:hb=function(t){var e,n=[];for(e in t)Ze(t,e)&&n.push(e);return n};var yW={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function SW(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return po(r)?r.call(e,n):r}function co(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var NR=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Kd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,xC={},Pu={};function we(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Pu[t]=i),e&&(Pu[e[0]]=function(){return co(i.apply(this,arguments),e[1],e[2])}),n&&(Pu[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function bW(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function RW(t){var e=t.match(NR),n,r;for(n=0,r=e.length;n<r;n++)Pu[e[n]]?e[n]=Pu[e[n]]:e[n]=bW(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=po(e[s])?e[s].call(i,t):e[s];return o}}function xg(t,e){return t.isValid()?(e=gN(e,t.localeData()),xC[e]=xC[e]||RW(e),xC[e](t)):t.localeData().invalidDate()}function gN(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Kd.lastIndex=0;n>=0&&Kd.test(t);)t=t.replace(Kd,r),Kd.lastIndex=0,n-=1;return t}var EW={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function TW(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(NR).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var _W="Invalid date";function MW(){return this._invalidDate}var IW="%d",PW=/\d{1,2}/;function OW(t){return this._ordinal.replace("%d",t)}var xW={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function HW(t,e,n,r){var i=this._relativeTime[n];return po(i)?i(t,e,n,r):i.replace(/%d/i,t)}function AW(t,e){var n=this._relativeTime[t>0?"future":"past"];return po(n)?n(e):n.replace(/%s/i,e)}var oO={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ri(t){return typeof t=="string"?oO[t]||oO[t.toLowerCase()]:void 0}function DR(t){var e={},n,r;for(r in t)Ze(t,r)&&(n=ri(r),n&&(e[n]=t[r]));return e}var NW={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function DW(t){var e=[],n;for(n in t)Ze(t,n)&&e.push({unit:n,priority:NW[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var mN=/\d/,xr=/\d\d/,pN=/\d{3}/,kR=/\d{4}/,tp=/[+-]?\d{6}/,Tt=/\d\d?/,wN=/\d\d\d\d?/,vN=/\d\d\d\d\d\d?/,np=/\d{1,3}/,LR=/\d{1,4}/,rp=/[+-]?\d{1,6}/,Ju=/\d+/,ip=/[+-]?\d+/,kW=/Z|[+-]\d\d:?\d\d/gi,op=/Z|[+-]\d\d(?::?\d\d)?/gi,LW=/[+-]?\d+(\.\d{1,3})?/,Td=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ec=/^[1-9]\d?/,$R=/^([1-9]\d|\d)/,Qg;Qg={};function le(t,e,n){Qg[t]=po(e)?e:function(r,i){return r&&n?n:e}}function $W(t,e){return Ze(Qg,t)?Qg[t](e._strict,e._locale):new RegExp(FW(t))}function FW(t){return Qo(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Qo(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Gr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Be(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Gr(e)),n}var db={};function ht(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),es(e)&&(r=function(o,s){s[e]=Be(o)}),i=t.length,n=0;n<i;n++)db[t[n]]=r}function _d(t,e){ht(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function VW(t,e,n){e!=null&&Ze(db,t)&&db[t](e,n._a,n,t)}function sp(t){return t%4===0&&t%100!==0||t%400===0}var Dn=0,zo=1,io=2,fn=3,Ei=4,Yo=5,Qa=6,WW=7,BW=8;we("Y",0,0,function(){var t=this.year();return t<=9999?co(t,4):"+"+t});we(0,["YY",2],0,function(){return this.year()%100});we(0,["YYYY",4],0,"year");we(0,["YYYYY",5],0,"year");we(0,["YYYYYY",6,!0],0,"year");le("Y",ip);le("YY",Tt,xr);le("YYYY",LR,kR);le("YYYYY",rp,tp);le("YYYYYY",rp,tp);ht(["YYYYY","YYYYYY"],Dn);ht("YYYY",function(t,e){e[Dn]=t.length===2?q.parseTwoDigitYear(t):Be(t)});ht("YY",function(t,e){e[Dn]=q.parseTwoDigitYear(t)});ht("Y",function(t,e){e[Dn]=parseInt(t,10)});function Rh(t){return sp(t)?366:365}q.parseTwoDigitYear=function(t){return Be(t)+(Be(t)>68?1900:2e3)};var CN=tc("FullYear",!0);function jW(){return sp(this.year())}function tc(t,e){return function(n){return n!=null?(yN(this,t,n),q.updateOffset(this,e),this):qh(this,t)}}function qh(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function yN(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!sp(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function UW(t){return t=ri(t),po(this[t])?this[t]():this}function zW(t,e){if(typeof t=="object"){t=DR(t);var n=DW(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=ri(t),po(this[t]))return this[t](e);return this}function YW(t,e){return(t%e+e)%e}var Yt;Array.prototype.indexOf?Yt=Array.prototype.indexOf:Yt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function FR(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=YW(e,12);return t+=(e-n)/12,n===1?sp(t)?29:28:31-n%7%2}we("M",["MM",2],"Mo",function(){return this.month()+1});we("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});we("MMMM",0,0,function(t){return this.localeData().months(this,t)});le("M",Tt,ec);le("MM",Tt,xr);le("MMM",function(t,e){return e.monthsShortRegex(t)});le("MMMM",function(t,e){return e.monthsRegex(t)});ht(["M","MM"],function(t,e){e[zo]=Be(t)-1});ht(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[zo]=i:Ie(n).invalidMonth=t});var GW="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),SN="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),bN=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,qW=Td,KW=Td;function XW(t,e){return t?Ii(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||bN).test(e)?"format":"standalone"][t.month()]:Ii(this._months)?this._months:this._months.standalone}function ZW(t,e){return t?Ii(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[bN.test(e)?"format":"standalone"][t.month()]:Ii(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function QW(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=mo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Yt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Yt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Yt.call(this._shortMonthsParse,s),i!==-1?i:(i=Yt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Yt.call(this._longMonthsParse,s),i!==-1?i:(i=Yt.call(this._shortMonthsParse,s),i!==-1?i:null))}function JW(t,e,n){var r,i,o;if(this._monthsParseExact)return QW.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=mo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function RN(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Be(e);else if(e=t.localeData().monthsParse(e),!es(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,FR(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function EN(t){return t!=null?(RN(this,t),q.updateOffset(this,!0),this):qh(this,"Month")}function eB(){return FR(this.year(),this.month())}function tB(t){return this._monthsParseExact?(Ze(this,"_monthsRegex")||TN.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Ze(this,"_monthsShortRegex")||(this._monthsShortRegex=qW),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function nB(t){return this._monthsParseExact?(Ze(this,"_monthsRegex")||TN.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Ze(this,"_monthsRegex")||(this._monthsRegex=KW),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function TN(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=mo([2e3,i]),s=Qo(this.monthsShort(o,"")),a=Qo(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function rB(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Kh(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Jg(t,e,n){var r=7+e-n,i=(7+Kh(t,0,r).getUTCDay()-e)%7;return-i+r-1}function _N(t,e,n,r,i){var o=(7+n-r)%7,s=Jg(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Rh(l)+a):a>Rh(t)?(l=t+1,u=a-Rh(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Xh(t,e,n){var r=Jg(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Jo(s,e,n)):i>Jo(t.year(),e,n)?(o=i-Jo(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Jo(t,e,n){var r=Jg(t,e,n),i=Jg(t+1,e,n);return(Rh(t)-r+i)/7}we("w",["ww",2],"wo","week");we("W",["WW",2],"Wo","isoWeek");le("w",Tt,ec);le("ww",Tt,xr);le("W",Tt,ec);le("WW",Tt,xr);_d(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Be(t)});function iB(t){return Xh(t,this._week.dow,this._week.doy).week}var oB={dow:0,doy:6};function sB(){return this._week.dow}function aB(){return this._week.doy}function lB(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function uB(t){var e=Xh(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}we("d",0,"do","day");we("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});we("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});we("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});we("e",0,0,"weekday");we("E",0,0,"isoWeekday");le("d",Tt);le("e",Tt);le("E",Tt);le("dd",function(t,e){return e.weekdaysMinRegex(t)});le("ddd",function(t,e){return e.weekdaysShortRegex(t)});le("dddd",function(t,e){return e.weekdaysRegex(t)});_d(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ie(n).invalidWeekday=t});_d(["d","e","E"],function(t,e,n,r){e[r]=Be(t)});function cB(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function hB(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function VR(t,e){return t.slice(e,7).concat(t.slice(0,e))}var dB="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),MN="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),fB="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),gB=Td,mB=Td,pB=Td;function wB(t,e){var n=Ii(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?VR(n,this._week.dow):t?n[t.day()]:n}function vB(t){return t===!0?VR(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function CB(t){return t===!0?VR(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function yB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=mo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Yt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Yt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Yt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Yt.call(this._weekdaysParse,s),i!==-1||(i=Yt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Yt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Yt.call(this._shortWeekdaysParse,s),i!==-1||(i=Yt.call(this._weekdaysParse,s),i!==-1)?i:(i=Yt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Yt.call(this._minWeekdaysParse,s),i!==-1||(i=Yt.call(this._weekdaysParse,s),i!==-1)?i:(i=Yt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function SB(t,e,n){var r,i,o;if(this._weekdaysParseExact)return yB.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=mo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function bB(t){if(!this.isValid())return t!=null?this:NaN;var e=qh(this,"Day");return t!=null?(t=cB(t,this.localeData()),this.add(t-e,"d")):e}function RB(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function EB(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=hB(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function TB(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||WR.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Ze(this,"_weekdaysRegex")||(this._weekdaysRegex=gB),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function _B(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||WR.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ze(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=mB),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function MB(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||WR.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ze(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=pB),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function WR(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=mo([2e3,1]).day(o),a=Qo(this.weekdaysMin(s,"")),l=Qo(this.weekdaysShort(s,"")),u=Qo(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function BR(){return this.hours()%12||12}function IB(){return this.hours()||24}we("H",["HH",2],0,"hour");we("h",["hh",2],0,BR);we("k",["kk",2],0,IB);we("hmm",0,0,function(){return""+BR.apply(this)+co(this.minutes(),2)});we("hmmss",0,0,function(){return""+BR.apply(this)+co(this.minutes(),2)+co(this.seconds(),2)});we("Hmm",0,0,function(){return""+this.hours()+co(this.minutes(),2)});we("Hmmss",0,0,function(){return""+this.hours()+co(this.minutes(),2)+co(this.seconds(),2)});function IN(t,e){we(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}IN("a",!0);IN("A",!1);function PN(t,e){return e._meridiemParse}le("a",PN);le("A",PN);le("H",Tt,$R);le("h",Tt,ec);le("k",Tt,ec);le("HH",Tt,xr);le("hh",Tt,xr);le("kk",Tt,xr);le("hmm",wN);le("hmmss",vN);le("Hmm",wN);le("Hmmss",vN);ht(["H","HH"],fn);ht(["k","kk"],function(t,e,n){var r=Be(t);e[fn]=r===24?0:r});ht(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});ht(["h","hh"],function(t,e,n){e[fn]=Be(t),Ie(n).bigHour=!0});ht("hmm",function(t,e,n){var r=t.length-2;e[fn]=Be(t.substr(0,r)),e[Ei]=Be(t.substr(r)),Ie(n).bigHour=!0});ht("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[fn]=Be(t.substr(0,r)),e[Ei]=Be(t.substr(r,2)),e[Yo]=Be(t.substr(i)),Ie(n).bigHour=!0});ht("Hmm",function(t,e,n){var r=t.length-2;e[fn]=Be(t.substr(0,r)),e[Ei]=Be(t.substr(r))});ht("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[fn]=Be(t.substr(0,r)),e[Ei]=Be(t.substr(r,2)),e[Yo]=Be(t.substr(i))});function PB(t){return(t+"").toLowerCase().charAt(0)==="p"}var OB=/[ap]\.?m?\.?/i,xB=tc("Hours",!0);function HB(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var ON={calendar:yW,longDateFormat:EW,invalidDate:_W,ordinal:IW,dayOfMonthOrdinalParse:PW,relativeTime:xW,months:GW,monthsShort:SN,week:oB,weekdays:dB,weekdaysMin:fB,weekdaysShort:MN,meridiemParse:OB},It={},vc={},Zh;function AB(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function sO(t){return t&&t.toLowerCase().replace("_","-")}function NB(t){for(var e=0,n,r,i,o;e<t.length;){for(o=sO(t[e]).split("-"),n=o.length,r=sO(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=ap(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&AB(o,r)>=n-1)break;n--}e++}return Zh}function DB(t){return!!(t&&t.match("^[^/\\\\]*$"))}function ap(t){var e=null,n;if(It[t]===void 0&&typeof module<"u"&&module&&module.exports&&DB(t))try{e=Zh._abbr,n=require,n("./locale/"+t),zs(e)}catch{It[t]=null}return It[t]}function zs(t,e){var n;return t&&(ar(e)?n=is(t):n=jR(t,e),n?Zh=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Zh._abbr}function jR(t,e){if(e!==null){var n,r=ON;if(e.abbr=t,It[t]!=null)fN("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=It[t]._config;else if(e.parentLocale!=null)if(It[e.parentLocale]!=null)r=It[e.parentLocale]._config;else if(n=ap(e.parentLocale),n!=null)r=n._config;else return vc[e.parentLocale]||(vc[e.parentLocale]=[]),vc[e.parentLocale].push({name:t,config:e}),null;return It[t]=new AR(cb(r,e)),vc[t]&&vc[t].forEach(function(i){jR(i.name,i.config)}),zs(t),It[t]}else return delete It[t],null}function kB(t,e){if(e!=null){var n,r,i=ON;It[t]!=null&&It[t].parentLocale!=null?It[t].set(cb(It[t]._config,e)):(r=ap(t),r!=null&&(i=r._config),e=cb(i,e),r==null&&(e.abbr=t),n=new AR(e),n.parentLocale=It[t],It[t]=n),zs(t)}else It[t]!=null&&(It[t].parentLocale!=null?(It[t]=It[t].parentLocale,t===zs()&&zs(t)):It[t]!=null&&delete It[t]);return It[t]}function is(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Zh;if(!Ii(t)){if(e=ap(t),e)return e;t=[t]}return NB(t)}function LB(){return hb(It)}function UR(t){var e,n=t._a;return n&&Ie(t).overflow===-2&&(e=n[zo]<0||n[zo]>11?zo:n[io]<1||n[io]>FR(n[Dn],n[zo])?io:n[fn]<0||n[fn]>24||n[fn]===24&&(n[Ei]!==0||n[Yo]!==0||n[Qa]!==0)?fn:n[Ei]<0||n[Ei]>59?Ei:n[Yo]<0||n[Yo]>59?Yo:n[Qa]<0||n[Qa]>999?Qa:-1,Ie(t)._overflowDayOfYear&&(e<Dn||e>io)&&(e=io),Ie(t)._overflowWeeks&&e===-1&&(e=WW),Ie(t)._overflowWeekday&&e===-1&&(e=BW),Ie(t).overflow=e),t}var $B=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,FB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,VB=/Z|[+-]\d\d(?::?\d\d)?/,Xd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],HC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],WB=/^\/?Date\((-?\d+)/i,BB=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,jB={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function xN(t){var e,n,r=t._i,i=$B.exec(r)||FB.exec(r),o,s,a,l,u=Xd.length,c=HC.length;if(i){for(Ie(t).iso=!0,e=0,n=u;e<n;e++)if(Xd[e][1].exec(i[1])){s=Xd[e][0],o=Xd[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(HC[e][1].exec(i[3])){a=(i[2]||" ")+HC[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(VB.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),YR(t)}else t._isValid=!1}function UB(t,e,n,r,i,o){var s=[zB(t),SN.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function zB(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function YB(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function GB(t,e,n){if(t){var r=MN.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ie(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function qB(t,e,n){if(t)return jB[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function HN(t){var e=BB.exec(YB(t._i)),n;if(e){if(n=UB(e[4],e[3],e[2],e[5],e[6],e[7]),!GB(e[1],n,t))return;t._a=n,t._tzm=qB(e[8],e[9],e[10]),t._d=Kh.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ie(t).rfc2822=!0}else t._isValid=!1}function KB(t){var e=WB.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(xN(t),t._isValid===!1)delete t._isValid;else return;if(HN(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:q.createFromInputFallback(t)}q.createFromInputFallback=ni("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function gu(t,e,n){return t??e??n}function XB(t){var e=new Date(q.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function zR(t){var e,n,r=[],i,o,s;if(!t._d){for(i=XB(t),t._w&&t._a[io]==null&&t._a[zo]==null&&ZB(t),t._dayOfYear!=null&&(s=gu(t._a[Dn],i[Dn]),(t._dayOfYear>Rh(s)||t._dayOfYear===0)&&(Ie(t)._overflowDayOfYear=!0),n=Kh(s,0,t._dayOfYear),t._a[zo]=n.getUTCMonth(),t._a[io]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[fn]===24&&t._a[Ei]===0&&t._a[Yo]===0&&t._a[Qa]===0&&(t._nextDay=!0,t._a[fn]=0),t._d=(t._useUTC?Kh:rB).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[fn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ie(t).weekdayMismatch=!0)}}function ZB(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=gu(e.GG,t._a[Dn],Xh(Et(),1,4).year),r=gu(e.W,1),i=gu(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Xh(Et(),o,s),n=gu(e.gg,t._a[Dn],u.year),r=gu(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Jo(n,o,s)?Ie(t)._overflowWeeks=!0:l!=null?Ie(t)._overflowWeekday=!0:(a=_N(n,r,i,o,s),t._a[Dn]=a.year,t._dayOfYear=a.dayOfYear)}q.ISO_8601=function(){};q.RFC_2822=function(){};function YR(t){if(t._f===q.ISO_8601){xN(t);return}if(t._f===q.RFC_2822){HN(t);return}t._a=[],Ie(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=gN(t._f,t._locale).match(NR)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match($W(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ie(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Pu[o]?(r?Ie(t).empty=!1:Ie(t).unusedTokens.push(o),VW(o,r,t)):t._strict&&!r&&Ie(t).unusedTokens.push(o);Ie(t).charsLeftOver=a-l,e.length>0&&Ie(t).unusedInput.push(e),t._a[fn]<=12&&Ie(t).bigHour===!0&&t._a[fn]>0&&(Ie(t).bigHour=void 0),Ie(t).parsedDateParts=t._a.slice(0),Ie(t).meridiem=t._meridiem,t._a[fn]=QB(t._locale,t._a[fn],t._meridiem),u=Ie(t).era,u!==null&&(t._a[Dn]=t._locale.erasConvertYear(u,t._a[Dn])),zR(t),UR(t)}function QB(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function JB(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ie(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=HR({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],YR(e),xR(e)&&(s=!0),o+=Ie(e).charsLeftOver,o+=Ie(e).unusedTokens.length*10,Ie(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));$s(t,n||e)}function ej(t){if(!t._d){var e=DR(t._i),n=e.day===void 0?e.date:e.day;t._a=hN([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),zR(t)}}function tj(t){var e=new Ed(UR(AN(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function AN(t){var e=t._i,n=t._f;return t._locale=t._locale||is(t._l),e===null||n===void 0&&e===""?ep({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Pi(e)?new Ed(UR(e)):(Rd(e)?t._d=e:Ii(n)?JB(t):n?YR(t):nj(t),xR(t)||(t._d=null),t))}function nj(t){var e=t._i;ar(e)?t._d=new Date(q.now()):Rd(e)?t._d=new Date(e.valueOf()):typeof e=="string"?KB(t):Ii(e)?(t._a=hN(e.slice(0),function(n){return parseInt(n,10)}),zR(t)):ol(e)?ej(t):es(e)?t._d=new Date(e):q.createFromInputFallback(t)}function NN(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(ol(t)&&OR(t)||Ii(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,tj(o)}function Et(t,e,n,r){return NN(t,e,n,r,!1)}var rj=ni("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:ep()}),ij=ni("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:ep()});function DN(t,e){var n,r;if(e.length===1&&Ii(e[0])&&(e=e[0]),!e.length)return Et();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function oj(){var t=[].slice.call(arguments,0);return DN("isBefore",t)}function sj(){var t=[].slice.call(arguments,0);return DN("isAfter",t)}var aj=function(){return Date.now?Date.now():+new Date},Cc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function lj(t){var e,n=!1,r,i=Cc.length;for(e in t)if(Ze(t,e)&&!(Yt.call(Cc,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Cc[r]]){if(n)return!1;parseFloat(t[Cc[r]])!==Be(t[Cc[r]])&&(n=!0)}return!0}function uj(){return this._isValid}function cj(){return Hi(NaN)}function lp(t){var e=DR(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=lj(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=is(),this._bubble()}function Hg(t){return t instanceof lp}function fb(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function hj(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Be(t[s])!==Be(e[s])&&o++;return o+i}function kN(t,e){we(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+co(~~(n/60),2)+e+co(~~n%60,2)})}kN("Z",":");kN("ZZ","");le("Z",op);le("ZZ",op);ht(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=GR(op,t)});var dj=/([\+\-]|\d\d)/gi;function GR(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(dj)||["-",0,0],o=+(i[1]*60)+Be(i[2]),o===0?0:i[0]==="+"?o:-o)}function qR(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Pi(t)||Rd(t)?t.valueOf():Et(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),q.updateOffset(n,!1),n):Et(t).local()}function gb(t){return-Math.round(t._d.getTimezoneOffset())}q.updateOffset=function(){};function fj(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=GR(op,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=gb(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?FN(this,Hi(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,q.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:gb(this)}function gj(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function mj(t){return this.utcOffset(0,t)}function pj(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(gb(this),"m")),this}function wj(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=GR(kW,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function vj(t){return this.isValid()?(t=t?Et(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function Cj(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function yj(){if(!ar(this._isDSTShifted))return this._isDSTShifted;var t={},e;return HR(t,this),t=AN(t),t._a?(e=t._isUTC?mo(t._a):Et(t._a),this._isDSTShifted=this.isValid()&&hj(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Sj(){return this.isValid()?!this._isUTC:!1}function bj(){return this.isValid()?this._isUTC:!1}function LN(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Rj=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Ej=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Hi(t,e){var n=t,r=null,i,o,s;return Hg(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:es(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=Rj.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Be(r[io])*i,h:Be(r[fn])*i,m:Be(r[Ei])*i,s:Be(r[Yo])*i,ms:Be(fb(r[Qa]*1e3))*i}):(r=Ej.exec(t))?(i=r[1]==="-"?-1:1,n={y:ua(r[2],i),M:ua(r[3],i),w:ua(r[4],i),d:ua(r[5],i),h:ua(r[6],i),m:ua(r[7],i),s:ua(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=Tj(Et(n.from),Et(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new lp(n),Hg(t)&&Ze(t,"_locale")&&(o._locale=t._locale),Hg(t)&&Ze(t,"_isValid")&&(o._isValid=t._isValid),o}Hi.fn=lp.prototype;Hi.invalid=cj;function ua(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function aO(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Tj(t,e){var n;return t.isValid()&&e.isValid()?(e=qR(e,t),t.isBefore(e)?n=aO(t,e):(n=aO(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function $N(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(fN(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=Hi(n,r),FN(this,i,t),this}}function FN(t,e,n,r){var i=e._milliseconds,o=fb(e._days),s=fb(e._months);t.isValid()&&(r=r??!0,s&&RN(t,qh(t,"Month")+s*n),o&&yN(t,"Date",qh(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&q.updateOffset(t,o||s))}var _j=$N(1,"add"),Mj=$N(-1,"subtract");function VN(t){return typeof t=="string"||t instanceof String}function Ij(t){return Pi(t)||Rd(t)||VN(t)||es(t)||Oj(t)||Pj(t)||t===null||t===void 0}function Pj(t){var e=ol(t)&&!OR(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||Ze(t,o);return e&&n}function Oj(t){var e=Ii(t),n=!1;return e&&(n=t.filter(function(r){return!es(r)&&VN(t)}).length===0),e&&n}function xj(t){var e=ol(t)&&!OR(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||Ze(t,o);return e&&n}function Hj(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Aj(t,e){arguments.length===1&&(arguments[0]?Ij(arguments[0])?(t=arguments[0],e=void 0):xj(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Et(),r=qR(n,this).startOf("day"),i=q.calendarFormat(this,r)||"sameElse",o=e&&(po(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Et(n)))}function Nj(){return new Ed(this)}function Dj(t,e){var n=Pi(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=ri(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function kj(t,e){var n=Pi(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=ri(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function Lj(t,e,n,r){var i=Pi(t)?t:Et(t),o=Pi(e)?e:Et(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function $j(t,e){var n=Pi(t)?t:Et(t),r;return this.isValid()&&n.isValid()?(e=ri(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function Fj(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function Vj(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function Wj(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=qR(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=ri(e),e){case"year":o=Ag(this,r)/12;break;case"month":o=Ag(this,r);break;case"quarter":o=Ag(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Gr(o)}function Ag(t,e){if(t.date()<e.date())return-Ag(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}q.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";q.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Bj(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function jj(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?xg(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):po(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",xg(n,"Z")):xg(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Uj(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function zj(t){t||(t=this.isUtc()?q.defaultFormatUtc:q.defaultFormat);var e=xg(this,t);return this.localeData().postformat(e)}function Yj(t,e){return this.isValid()&&(Pi(t)&&t.isValid()||Et(t).isValid())?Hi({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Gj(t){return this.from(Et(),t)}function qj(t,e){return this.isValid()&&(Pi(t)&&t.isValid()||Et(t).isValid())?Hi({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Kj(t){return this.to(Et(),t)}function WN(t){var e;return t===void 0?this._locale._abbr:(e=is(t),e!=null&&(this._locale=e),this)}var BN=ni("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function jN(){return this._locale}var em=1e3,Ou=60*em,tm=60*Ou,UN=(365*400+97)*24*tm;function xu(t,e){return(t%e+e)%e}function zN(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-UN:new Date(t,e,n).valueOf()}function YN(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-UN:Date.UTC(t,e,n)}function Xj(t){var e,n;if(t=ri(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?YN:zN,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=xu(e+(this._isUTC?0:this.utcOffset()*Ou),tm);break;case"minute":e=this._d.valueOf(),e-=xu(e,Ou);break;case"second":e=this._d.valueOf(),e-=xu(e,em);break}return this._d.setTime(e),q.updateOffset(this,!0),this}function Zj(t){var e,n;if(t=ri(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?YN:zN,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=tm-xu(e+(this._isUTC?0:this.utcOffset()*Ou),tm)-1;break;case"minute":e=this._d.valueOf(),e+=Ou-xu(e,Ou)-1;break;case"second":e=this._d.valueOf(),e+=em-xu(e,em)-1;break}return this._d.setTime(e),q.updateOffset(this,!0),this}function Qj(){return this._d.valueOf()-(this._offset||0)*6e4}function Jj(){return Math.floor(this.valueOf()/1e3)}function eU(){return new Date(this.valueOf())}function tU(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function nU(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function rU(){return this.isValid()?this.toISOString():null}function iU(){return xR(this)}function oU(){return $s({},Ie(this))}function sU(){return Ie(this).overflow}function aU(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}we("N",0,0,"eraAbbr");we("NN",0,0,"eraAbbr");we("NNN",0,0,"eraAbbr");we("NNNN",0,0,"eraName");we("NNNNN",0,0,"eraNarrow");we("y",["y",1],"yo","eraYear");we("y",["yy",2],0,"eraYear");we("y",["yyy",3],0,"eraYear");we("y",["yyyy",4],0,"eraYear");le("N",KR);le("NN",KR);le("NNN",KR);le("NNNN",vU);le("NNNNN",CU);ht(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ie(n).era=i:Ie(n).invalidEra=t});le("y",Ju);le("yy",Ju);le("yyy",Ju);le("yyyy",Ju);le("yo",yU);ht(["y","yy","yyy","yyyy"],Dn);ht(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Dn]=n._locale.eraYearOrdinalParse(t,i):e[Dn]=parseInt(t,10)});function lU(t,e){var n,r,i,o=this._eras||is("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=q(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=q(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function uU(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function cU(t,e){var n=t.since<=t.until?1:-1;return e===void 0?q(t.since).year():q(t.since).year()+(e-t.offset)*n}function hU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function dU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function fU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function gU(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-q(i[t].since).year())*n+i[t].offset;return this.year()}function mU(t){return Ze(this,"_erasNameRegex")||XR.call(this),t?this._erasNameRegex:this._erasRegex}function pU(t){return Ze(this,"_erasAbbrRegex")||XR.call(this),t?this._erasAbbrRegex:this._erasRegex}function wU(t){return Ze(this,"_erasNarrowRegex")||XR.call(this),t?this._erasNarrowRegex:this._erasRegex}function KR(t,e){return e.erasAbbrRegex(t)}function vU(t,e){return e.erasNameRegex(t)}function CU(t,e){return e.erasNarrowRegex(t)}function yU(t,e){return e._eraYearOrdinalRegex||Ju}function XR(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Qo(u[i].name),a=Qo(u[i].abbr),l=Qo(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}we(0,["gg",2],0,function(){return this.weekYear()%100});we(0,["GG",2],0,function(){return this.isoWeekYear()%100});function up(t,e){we(0,[t,t.length],0,e)}up("gggg","weekYear");up("ggggg","weekYear");up("GGGG","isoWeekYear");up("GGGGG","isoWeekYear");le("G",ip);le("g",ip);le("GG",Tt,xr);le("gg",Tt,xr);le("GGGG",LR,kR);le("gggg",LR,kR);le("GGGGG",rp,tp);le("ggggg",rp,tp);_d(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Be(t)});_d(["gg","GG"],function(t,e,n,r){e[r]=q.parseTwoDigitYear(t)});function SU(t){return GN.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function bU(t){return GN.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function RU(){return Jo(this.year(),1,4)}function EU(){return Jo(this.isoWeekYear(),1,4)}function TU(){var t=this.localeData()._week;return Jo(this.year(),t.dow,t.doy)}function _U(){var t=this.localeData()._week;return Jo(this.weekYear(),t.dow,t.doy)}function GN(t,e,n,r,i){var o;return t==null?Xh(this,r,i).year:(o=Jo(t,r,i),e>o&&(e=o),MU.call(this,t,e,n,r,i))}function MU(t,e,n,r,i){var o=_N(t,e,n,r,i),s=Kh(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}we("Q",0,"Qo","quarter");le("Q",mN);ht("Q",function(t,e){e[zo]=(Be(t)-1)*3});function IU(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}we("D",["DD",2],"Do","date");le("D",Tt,ec);le("DD",Tt,xr);le("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ht(["D","DD"],io);ht("Do",function(t,e){e[io]=Be(t.match(Tt)[0])});var qN=tc("Date",!0);we("DDD",["DDDD",3],"DDDo","dayOfYear");le("DDD",np);le("DDDD",pN);ht(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Be(t)});function PU(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}we("m",["mm",2],0,"minute");le("m",Tt,$R);le("mm",Tt,xr);ht(["m","mm"],Ei);var OU=tc("Minutes",!1);we("s",["ss",2],0,"second");le("s",Tt,$R);le("ss",Tt,xr);ht(["s","ss"],Yo);var xU=tc("Seconds",!1);we("S",0,0,function(){return~~(this.millisecond()/100)});we(0,["SS",2],0,function(){return~~(this.millisecond()/10)});we(0,["SSS",3],0,"millisecond");we(0,["SSSS",4],0,function(){return this.millisecond()*10});we(0,["SSSSS",5],0,function(){return this.millisecond()*100});we(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});we(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});we(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});we(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});le("S",np,mN);le("SS",np,xr);le("SSS",np,pN);var Fs,KN;for(Fs="SSSS";Fs.length<=9;Fs+="S")le(Fs,Ju);function HU(t,e){e[Qa]=Be(("0."+t)*1e3)}for(Fs="S";Fs.length<=9;Fs+="S")ht(Fs,HU);KN=tc("Milliseconds",!1);we("z",0,0,"zoneAbbr");we("zz",0,0,"zoneName");function AU(){return this._isUTC?"UTC":""}function NU(){return this._isUTC?"Coordinated Universal Time":""}var Z=Ed.prototype;Z.add=_j;Z.calendar=Aj;Z.clone=Nj;Z.diff=Wj;Z.endOf=Zj;Z.format=zj;Z.from=Yj;Z.fromNow=Gj;Z.to=qj;Z.toNow=Kj;Z.get=UW;Z.invalidAt=sU;Z.isAfter=Dj;Z.isBefore=kj;Z.isBetween=Lj;Z.isSame=$j;Z.isSameOrAfter=Fj;Z.isSameOrBefore=Vj;Z.isValid=iU;Z.lang=BN;Z.locale=WN;Z.localeData=jN;Z.max=ij;Z.min=rj;Z.parsingFlags=oU;Z.set=zW;Z.startOf=Xj;Z.subtract=Mj;Z.toArray=tU;Z.toObject=nU;Z.toDate=eU;Z.toISOString=jj;Z.inspect=Uj;typeof Symbol<"u"&&Symbol.for!=null&&(Z[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Z.toJSON=rU;Z.toString=Bj;Z.unix=Jj;Z.valueOf=Qj;Z.creationData=aU;Z.eraName=hU;Z.eraNarrow=dU;Z.eraAbbr=fU;Z.eraYear=gU;Z.year=CN;Z.isLeapYear=jW;Z.weekYear=SU;Z.isoWeekYear=bU;Z.quarter=Z.quarters=IU;Z.month=EN;Z.daysInMonth=eB;Z.week=Z.weeks=lB;Z.isoWeek=Z.isoWeeks=uB;Z.weeksInYear=TU;Z.weeksInWeekYear=_U;Z.isoWeeksInYear=RU;Z.isoWeeksInISOWeekYear=EU;Z.date=qN;Z.day=Z.days=bB;Z.weekday=RB;Z.isoWeekday=EB;Z.dayOfYear=PU;Z.hour=Z.hours=xB;Z.minute=Z.minutes=OU;Z.second=Z.seconds=xU;Z.millisecond=Z.milliseconds=KN;Z.utcOffset=fj;Z.utc=mj;Z.local=pj;Z.parseZone=wj;Z.hasAlignedHourOffset=vj;Z.isDST=Cj;Z.isLocal=Sj;Z.isUtcOffset=bj;Z.isUtc=LN;Z.isUTC=LN;Z.zoneAbbr=AU;Z.zoneName=NU;Z.dates=ni("dates accessor is deprecated. Use date instead.",qN);Z.months=ni("months accessor is deprecated. Use month instead",EN);Z.years=ni("years accessor is deprecated. Use year instead",CN);Z.zone=ni("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",gj);Z.isDSTShifted=ni("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",yj);function DU(t){return Et(t*1e3)}function kU(){return Et.apply(null,arguments).parseZone()}function XN(t){return t}var Qe=AR.prototype;Qe.calendar=SW;Qe.longDateFormat=TW;Qe.invalidDate=MW;Qe.ordinal=OW;Qe.preparse=XN;Qe.postformat=XN;Qe.relativeTime=HW;Qe.pastFuture=AW;Qe.set=CW;Qe.eras=lU;Qe.erasParse=uU;Qe.erasConvertYear=cU;Qe.erasAbbrRegex=pU;Qe.erasNameRegex=mU;Qe.erasNarrowRegex=wU;Qe.months=XW;Qe.monthsShort=ZW;Qe.monthsParse=JW;Qe.monthsRegex=nB;Qe.monthsShortRegex=tB;Qe.week=iB;Qe.firstDayOfYear=aB;Qe.firstDayOfWeek=sB;Qe.weekdays=wB;Qe.weekdaysMin=CB;Qe.weekdaysShort=vB;Qe.weekdaysParse=SB;Qe.weekdaysRegex=TB;Qe.weekdaysShortRegex=_B;Qe.weekdaysMinRegex=MB;Qe.isPM=PB;Qe.meridiem=HB;function nm(t,e,n,r){var i=is(),o=mo().set(r,e);return i[n](o,t)}function ZN(t,e,n){if(es(t)&&(e=t,t=void 0),t=t||"",e!=null)return nm(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=nm(t,r,n,"month");return i}function ZR(t,e,n,r){typeof t=="boolean"?(es(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,es(e)&&(n=e,e=void 0),e=e||"");var i=is(),o=t?i._week.dow:0,s,a=[];if(n!=null)return nm(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=nm(e,(s+o)%7,r,"day");return a}function LU(t,e){return ZN(t,e,"months")}function $U(t,e){return ZN(t,e,"monthsShort")}function FU(t,e,n){return ZR(t,e,n,"weekdays")}function VU(t,e,n){return ZR(t,e,n,"weekdaysShort")}function WU(t,e,n){return ZR(t,e,n,"weekdaysMin")}zs("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Be(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});q.lang=ni("moment.lang is deprecated. Use moment.locale instead.",zs);q.langData=ni("moment.langData is deprecated. Use moment.localeData instead.",is);var bo=Math.abs;function BU(){var t=this._data;return this._milliseconds=bo(this._milliseconds),this._days=bo(this._days),this._months=bo(this._months),t.milliseconds=bo(t.milliseconds),t.seconds=bo(t.seconds),t.minutes=bo(t.minutes),t.hours=bo(t.hours),t.months=bo(t.months),t.years=bo(t.years),this}function QN(t,e,n,r){var i=Hi(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function jU(t,e){return QN(this,t,e,1)}function UU(t,e){return QN(this,t,e,-1)}function lO(t){return t<0?Math.floor(t):Math.ceil(t)}function zU(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=lO(mb(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Gr(t/1e3),r.seconds=i%60,o=Gr(i/60),r.minutes=o%60,s=Gr(o/60),r.hours=s%24,e+=Gr(s/24),l=Gr(JN(e)),n+=l,e-=lO(mb(l)),a=Gr(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function JN(t){return t*4800/146097}function mb(t){return t*146097/4800}function YU(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=ri(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+JN(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(mb(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function os(t){return function(){return this.as(t)}}var eD=os("ms"),GU=os("s"),qU=os("m"),KU=os("h"),XU=os("d"),ZU=os("w"),QU=os("M"),JU=os("Q"),ez=os("y"),tz=eD;function nz(){return Hi(this)}function rz(t){return t=ri(t),this.isValid()?this[t+"s"]():NaN}function yl(t){return function(){return this.isValid()?this._data[t]:NaN}}var iz=yl("milliseconds"),oz=yl("seconds"),sz=yl("minutes"),az=yl("hours"),lz=yl("days"),uz=yl("months"),cz=yl("years");function hz(){return Gr(this.days()/7)}var Vo=Math.round,Ru={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function dz(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function fz(t,e,n,r){var i=Hi(t).abs(),o=Vo(i.as("s")),s=Vo(i.as("m")),a=Vo(i.as("h")),l=Vo(i.as("d")),u=Vo(i.as("M")),c=Vo(i.as("w")),h=Vo(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,dz.apply(null,d)}function gz(t){return t===void 0?Vo:typeof t=="function"?(Vo=t,!0):!1}function mz(t,e){return Ru[t]===void 0?!1:e===void 0?Ru[t]:(Ru[t]=e,t==="s"&&(Ru.ss=e-1),!0)}function pz(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Ru,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Ru,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=fz(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var AC=Math.abs;function Il(t){return(t>0)-(t<0)||+t}function cp(){if(!this.isValid())return this.localeData().invalidDate();var t=AC(this._milliseconds)/1e3,e=AC(this._days),n=AC(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Gr(t/60),i=Gr(r/60),t%=60,r%=60,o=Gr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Il(this._months)!==Il(a)?"-":"",c=Il(this._days)!==Il(a)?"-":"",h=Il(this._milliseconds)!==Il(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ge=lp.prototype;Ge.isValid=uj;Ge.abs=BU;Ge.add=jU;Ge.subtract=UU;Ge.as=YU;Ge.asMilliseconds=eD;Ge.asSeconds=GU;Ge.asMinutes=qU;Ge.asHours=KU;Ge.asDays=XU;Ge.asWeeks=ZU;Ge.asMonths=QU;Ge.asQuarters=JU;Ge.asYears=ez;Ge.valueOf=tz;Ge._bubble=zU;Ge.clone=nz;Ge.get=rz;Ge.milliseconds=iz;Ge.seconds=oz;Ge.minutes=sz;Ge.hours=az;Ge.days=lz;Ge.weeks=hz;Ge.months=uz;Ge.years=cz;Ge.humanize=pz;Ge.toISOString=cp;Ge.toString=cp;Ge.toJSON=cp;Ge.locale=WN;Ge.localeData=jN;Ge.toIsoString=ni("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",cp);Ge.lang=BN;we("X",0,0,"unix");we("x",0,0,"valueOf");le("x",ip);le("X",LW);ht("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});ht("x",function(t,e,n){n._d=new Date(Be(t))});//! moment.js
q.version="2.30.1";wW(Et);q.fn=Z;q.min=oj;q.max=sj;q.now=aj;q.utc=mo;q.unix=DU;q.months=LU;q.isDate=Rd;q.locale=zs;q.invalid=ep;q.duration=Hi;q.isMoment=Pi;q.weekdays=FU;q.parseZone=kU;q.localeData=is;q.isDuration=Hg;q.monthsShort=$U;q.weekdaysMin=WU;q.defineLocale=jR;q.updateLocale=kB;q.locales=LB;q.weekdaysShort=VU;q.normalizeUnits=ri;q.relativeTimeRounding=gz;q.relativeTimeThreshold=mz;q.calendarFormat=Hj;q.prototype=Z;q.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function tD(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function pb(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Eh(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function an(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Xs(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Le(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function _(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function nD(t){return an(t,(e,n)=>e+n,0)}function wz(t){return an(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function vz(t){return an(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function Cz(t){return t.length?nD(t)/t.length:0}function rD(t){return an(t,(e,n)=>e.concat(Array.isArray(n)?rD(n):n),[])}function iD(t){const e=[];return _(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function wb(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return _(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function yz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return _(i,s=>{o=o.filter(a=>s.includes(a))}),o}function Sz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return _(i,s=>{_(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function vb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const bz=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Cz,arrayEach:_,arrayFilter:Xs,arrayFlatten:rD,arrayMap:Le,arrayMax:wz,arrayMin:vz,arrayReduce:an,arraySum:nD,arrayUnique:iD,extendArray:pb,getDifferenceOfArrays:wb,getIntersectionOfArrays:yz,getUnionOfArrays:Sz,pivot:Eh,stringToArray:vb,to2dArray:tD},Symbol.toStringTag,{value:"Module"}));function nt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return an(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function wt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ae(t){return typeof t<"u"}function Rt(t){return typeof t>"u"}function kt(t){return t===null||t===""||Rt(t)}function oD(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const mh="length",Th=t=>parseInt(t,16),uO=t=>parseInt(t,10),rm=(t,e,n)=>t.substr(e,n),_h=t=>t.codePointAt(0)-65,Cb=t=>`${t}`.replace(/\-/g,""),Rz=t=>Th(rm(Cb(t),Th("12"),_h("F")))/(Th(rm(Cb(t),_h("B"),~~![][mh]))||9),Ez=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let cO=!1;const hO={invalid:()=>nt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return nt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>nt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},dO={invalid:()=>nt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return nt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>nt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function sD(t,e){const n=!kt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.0.0";let o,s="invalid",a="invalid";t=Cb(t||"");const l=Tz(t);if(n||r||l)if(l){const u=q("09/07/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=Rz(t);o=q((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(Ez()&&(s="valid",a="valid"),!cO&&s!=="valid"&&(hO[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](hO[s]({keyValidityDate:o,hotVersion:i})),cO=!0),a!=="valid"&&e&&dO[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=dO[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function Tz(t){let e=[][mh],n=e;if(t[mh]!==_h("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=_h(i.shift());o;o=_h(i.shift()||"A"))--o<""[mh]?n=n|(uO(`${uO(Th(r)+(Th(rm(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=rm(t,o,o?i[mh]===1?9:8:6);return n===e}const _z=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:sD,isDefined:ae,isEmpty:kt,isRegExp:oD,isUndefined:Rt,stringify:wt},Symbol.toStringTag,{value:"Module"}));function kn(t){return t[0].toUpperCase()+t.substr(1)}function Mz(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=wt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function QR(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function JR(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function eE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function yb(t){return hp(`${t}`,{ALLOWED_TAGS:[]})}function hp(t,e){return pW.sanitize(t,e)}const Iz=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Mz,isPercentValue:JR,randomString:QR,sanitize:hp,stripTags:yb,substitute:eE,toUpperCaseFirst:kn},Symbol.toStringTag,{value:"Module"})),oa=t=>["tabindex",t],Pz=()=>["role","treegrid"],Go=()=>["role","presentation"],Oz=()=>["role","gridcell"],xz=()=>["role","gridcell button"],Hz=()=>["role","rowheader"],aD=()=>["role","rowgroup"],Az=()=>["role","columnheader"],lD=()=>["role","row"],Nz=()=>["role","menu"],Dz=()=>["role","menuitem"],kz=()=>["role","menuitemcheckbox"],Lz=()=>["role","combobox"],uD=()=>["role","listbox"],$z=()=>["role","option"],Fz=()=>["role","checkbox"],Vz=()=>["scope","col"],Wz=()=>["scope","row"],Bz=()=>["type","text"],$u=t=>["aria-label",t],Sl=()=>["aria-hidden","true"],jz=()=>["aria-disabled","true"],Uz=()=>["aria-multiselectable","true"],cD=t=>["aria-haspopup",t],hD=t=>["aria-rowcount",t],dp=t=>["aria-colcount",t],dD=t=>["aria-rowindex",t],tE=t=>["aria-colindex",t],Xr=t=>["aria-expanded",t],zz=t=>["aria-sort",t],fO=()=>["aria-readonly","true"],gO=()=>["aria-invalid","true"],fD=t=>["aria-checked",t],nE=()=>["aria-selected","true"],Yz=()=>["aria-autocomplete","list"],Gz=t=>["aria-controls",t],qz=t=>["aria-activedescendant",t],Kz=t=>["aria-live",t],Xz=t=>["aria-relevant",t],Zz=t=>["aria-setsize",t],Qz=t=>["aria-posinset",t];var mO={},NC,pO;function Jz(){if(pO)return NC;pO=1;var t=Zt(),e=zA(),n=on(),r=ml(),i=Jm(),o=t([].push);return NC=function(s){if(n(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(f,p){if(d)return d=!1,p;if(e(this))return p;for(var v=0;v<h;v++)if(l[v]===f)return p}}},NC}var wO;function eY(){if(wO)return mO;wO=1;var t=ft(),e=qu(),n=yd(),r=rn(),i=Zt(),o=nn(),s=on(),a=pR(),l=PR(),u=Jz(),c=mR(),h=String,d=e("JSON","stringify"),f=i(/./.exec),p=i("".charAt),v=i("".charCodeAt),S=i("".replace),E=i(1.1.toString),C=/[\uD800-\uDFFF]/g,I=/^[\uD800-\uDBFF]$/,H=/^[\uDC00-\uDFFF]$/,$=!c||o(function(){var K=e("Symbol")("stringify detection");return d([K])!=="[null]"||d({a:K})!=="{}"||d(Object(K))!=="{}"}),P=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),x=function(K,A){var Q=l(arguments),X=u(A);if(!(!s(X)&&(K===void 0||a(K))))return Q[1]=function(se,ee){if(s(X)&&(ee=r(X,this,h(se),ee)),!a(ee))return ee},n(d,null,Q)},z=function(K,A,Q){var X=p(Q,A-1),se=p(Q,A+1);return f(I,K)&&!f(H,se)||f(H,K)&&!f(I,X)?"\\u"+E(v(K,0),16):K};return d&&t({target:"JSON",stat:!0,arity:3,forced:$||P},{stringify:function(A,Q,X){var se=l(arguments),ee=n($?x:d,null,se);return P&&typeof ee=="string"?S(ee,C,z):ee}}),mO}eY();function Fu(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Oe(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Fu(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Fu(n[0])]:e[r]=[]:e[r]=null)})),e}function gD(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Kt(t,e,n){const r=Array.isArray(n);return Oe(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Md(t,e){Oe(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Md(t[r],e[r])):t[r]=e[r]})}function Ln(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Oi(t){const e={};return Oe(t,(n,r)=>{e[r]=n}),e}function st(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return _(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Oe(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=p=>{let v=p;return(Array.isArray(v)||Pe(v))&&(v=Ln(v)),v};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function fp(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Pe(t){return Object.prototype.toString.call(t)==="[object Object]"}function wo(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Oe(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function mD(t,e){const n=e.split(".");let r=t;return Oe(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Ng(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(Gt(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function gp(t){if(!Pe(t))return 0;const e=function(n){let r=0;return Pe(n)?Oe(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function mr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Gt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const tY=Object.freeze(Object.defineProperty({__proto__:null,clone:Oi,createObjectPropListener:mr,deepClone:Ln,deepExtend:Md,deepObjectSize:gp,defineGetter:wo,duckSchema:Fu,extend:Kt,getProperty:mD,hasOwnProperty:Gt,inherit:gD,isObject:Pe,isObjectEqual:fp,mixin:st,objectEach:Oe,setProperty:Ng},Symbol.toStringTag,{value:"Module"}));function Qh(t){return window.requestAnimationFrame(t)}function Jh(t){window.cancelAnimationFrame(t)}function rE(){return"ontouchstart"in window}function pD(){return typeof window<"u"}let Pl;function wD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Pl||(typeof Intl=="object"?Pl=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Pl=(n,r)=>`${n}`.localeCompare(r):Pl=(n,r)=>n===r?0:n>r?-1:1,Pl)}const nY=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Jh,getComparisonFunction:wD,isCSR:pD,isTouchSupported:rE,requestAnimationFrame:Qh},Symbol.toStringTag,{value:"Module"})),Wr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},ss={chrome:Wr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Wr(t=>/CriOS/.test(t)),edge:Wr(t=>/Edge/.test(t)),edgeWebKit:Wr(t=>/EdgiOS/.test(t)),firefox:Wr(t=>/Firefox/.test(t)),firefoxWebKit:Wr(t=>/FxiOS/.test(t)),mobile:Wr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Wr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},nc={mac:Wr(t=>/^Mac/.test(t)),win:Wr(t=>/^Win/.test(t)),linux:Wr(t=>/^Linux/.test(t)),ios:Wr(t=>/iPhone|iPad|iPod/i.test(t))};function vD(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Oe(ss,n=>{let{test:r}=n;return void r(t,e)})}function CD(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Oe(nc,e=>{let{test:n}=e;return void n(t)})}pD()&&(vD(),CD());function iE(){return ss.chrome.value}function yD(){return ss.chromeWebKit.value}function Dg(){return ss.firefox.value}function SD(){return ss.firefoxWebKit.value}function Vu(){return ss.safari.value}function bD(){return ss.edge.value}function rY(){return ss.edgeWebKit.value}function Ti(){return ss.mobile.value}function oE(){return nc.ios.value}function sE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&nc.mac.value}function im(){return nc.win.value}function om(){return nc.mac.value}function iY(){return nc.linux.value}const oY=Object.freeze(Object.defineProperty({__proto__:null,isChrome:iE,isChromeWebKit:yD,isEdge:bD,isEdgeWebKit:rY,isFirefox:Dg,isFirefoxWebKit:SD,isIOS:oE,isIpadOS:sE,isLinuxOS:iY,isMacOS:om,isMobileBrowser:Ti,isSafari:Vu,isWindowsOS:im,setBrowserMeta:vD,setPlatformMeta:CD},Symbol.toStringTag,{value:"Module"}));function RD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Mh(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function ED(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function al(t){return ED(t)&&t.parent}function sY(t){return!!Object.getPrototypeOf(t.parent)}function Zs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function ph(t,e,n){const r=[];let i=t;for(;i&&(i=Zs(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function TD(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function Ys(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function _D(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function _s(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function MD(t){return!t||!t.length?[]:t.filter(e=>!!e)}function ID(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function Ce(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Y(t,e){typeof e=="string"&&(e=e.split(" ")),e=MD(e),e.length>0&&t.classList.add(...e)}function me(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=ID(e,!0);n=MD(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function ve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function bl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=ID(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function aE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)aE(e[n])}}function ho(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const PD=/(<(.*)>|&(.*);)/;function Rl(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;PD.test(e)?t.innerHTML=n?hp(e):e:Qs(t,e)}function Qs(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(ho(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ll(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return ll(r.host.impl);if(r.host)return ll(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function OD(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function bn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function lE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function mp(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function pp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?lE(e):t.scrollTop}function uE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?mp(e):t.scrollLeft}function ed(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function xD(t){return t.scrollHeight-t.clientHeight}function HD(t){return t.scrollWidth-t.clientWidth}function Wu(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function td(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function aY(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Bt(t){return t.offsetWidth}function qt(t){return t.offsetHeight}function Hu(t){return t.clientHeight||t.innerHeight}function cE(t){return t.clientWidth||t.innerWidth}function lY(t,e,n){t.addEventListener(e,n,!1)}function uY(t,e,n){t.removeEventListener(e,n,!1)}function hE(t){return t.selectionStart?t.selectionStart:0}function AD(t){return t.selectionEnd?t.selectionEnd:0}function cY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function Sb(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Id(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let DC;function dE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return im()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function hY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");Vu()&&!Ti()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i+dE(t)}function gn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return DC===void 0&&(DC=hY(t)),DC}function fE(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function gE(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function wp(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function dY(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Pd(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Ih(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function vp(t){return Ih(t)&&t.hasAttribute("data-hot-input")===!1}function fY(t){const e=t.ownerDocument.activeElement;vp(e)||t.select()}function mE(t){return!t.parentNode}function ND(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function pE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();ve(t,"contenteditable",!0),n&&ve(t,...Sl()),e&&Y(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function wE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&me(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function DD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;pE(t,n),e(),wE(t,n)}function lo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const gY=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:PD,addClass:Y,addEvent:lY,clearTextSelection:Sb,closest:Zs,closestDown:ph,empty:ho,fastInnerHTML:Rl,fastInnerText:Qs,findFirstParentWithClass:TD,getCaretPosition:hE,getCssTransform:dY,getFractionalScalingCompensation:dE,getFrameElement:ED,getMaximumScrollLeft:HD,getMaximumScrollTop:xD,getParent:RD,getParentWindow:al,getScrollLeft:uE,getScrollTop:pp,getScrollableElement:ed,getScrollbarWidth:gn,getSelectionEndPosition:AD,getSelectionText:cY,getStyle:td,getTrimmingContainer:Wu,getWindowScrollLeft:mp,getWindowScrollTop:lE,hasAccessToParentWindow:sY,hasClass:Ce,hasHorizontalScrollbar:gE,hasVerticalScrollbar:fE,hasZeroHeight:OD,index:_D,innerHeight:Hu,innerWidth:cE,isChildOf:Ys,isDetached:mE,isHTMLElement:lo,isInput:Ih,isInternalElement:Mh,isOutsideInput:vp,isVisible:ll,makeElementContentEditableAndSelectItsContent:pE,matchesCSSRules:aY,observeVisibilityChangeOnce:ND,offset:bn,outerHeight:qt,outerWidth:Bt,overlayContainsElement:_s,removeAttribute:bl,removeClass:me,removeContentEditableFromElementAndDeselect:wE,removeEvent:uY,removeTextNodes:aE,resetCssTransform:Pd,runWithSelectedContendEditableElement:DD,selectElementIfAllowed:fY,setAttribute:ve,setCaretPosition:Id,setOverlayPosition:wp},Symbol.toStringTag,{value:"Module"}));function tt(t){return typeof t=="function"}function kD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function mY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=kD(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function Od(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function pY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return an(i,(u,c)=>c(u),r.apply(this,a))}}function vE(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function LD(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function wY(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function sm(t,e,n,r,i,o,s,a){return ae(a)?t.call(e,n,r,i,o,s,a):ae(s)?t.call(e,n,r,i,o,s):ae(o)?t.call(e,n,r,i,o):ae(i)?t.call(e,n,r,i):ae(r)?t.call(e,n,r):ae(n)?t.call(e,n):t.call(e)}const vY=Object.freeze(Object.defineProperty({__proto__:null,curry:LD,curryRight:wY,debounce:Od,fastCall:sm,isFunction:tt,partial:vE,pipe:pY,throttle:kD,throttleAfterHits:mY},Symbol.toStringTag,{value:"Module"})),he={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Dg()?182:174,AUDIO_MUTE:Dg()?181:173,AUDIO_UP:Dg()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},CY=[he.ALT,he.ARROW_DOWN,he.ARROW_LEFT,he.ARROW_RIGHT,he.ARROW_UP,he.AUDIO_DOWN,he.AUDIO_MUTE,he.AUDIO_UP,he.BACKSPACE,he.CAPS_LOCK,he.DELETE,he.END,he.ENTER,he.ESCAPE,he.F1,he.F2,he.F3,he.F4,he.F5,he.F6,he.F7,he.F8,he.F9,he.F10,he.F11,he.F12,he.F13,he.F14,he.F15,he.F16,he.F17,he.F18,he.F19,he.HOME,he.INSERT,he.MEDIA_NEXT,he.MEDIA_PLAY_PAUSE,he.MEDIA_PREV,he.MEDIA_STOP,he.NULL,he.NUM_LOCK,he.PAGE_DOWN,he.PAGE_UP,he.PAUSE,he.SCROLL_LOCK,he.SHIFT,he.TAB];function $D(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function CE(t){return CY.includes(t)}function yY(t){const e=[];return om()?e.push(he.COMMAND_LEFT,he.COMMAND_RIGHT,he.COMMAND_FIREFOX):e.push(he.CONTROL),e.includes(t)}function FD(t){return[he.CONTROL,he.COMMAND_LEFT,he.COMMAND_RIGHT,he.COMMAND_FIREFOX].includes(t)}function rc(t,e){const n=e.split("|");let r=!1;return _(n,i=>{if(t===he[i])return r=!0,!1}),r}const SY=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:he,isCtrlKey:yY,isCtrlMetaKey:FD,isFunctionKey:CE,isKey:rc,isPrintableChar:$D},Symbol.toStringTag,{value:"Module"}));function ii(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ns(t){return t.isImmediatePropagationEnabled===!1}function Js(t){return t.button===2}function Cp(t){return t.button===0}function VD(t){return t instanceof TouchEvent}function WD(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!lo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const bY=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Ns,isLeftClick:Cp,isRightClick:Js,isTouchEvent:VD,offsetRelativeTo:WD,stopImmediatePropagation:ii},Symbol.toStringTag,{value:"Module"}));function Ke(){ae(console)&&console.warn(...arguments)}function yE(){ae(console)&&console.error(...arguments)}const Ka=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],kC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),LC=new Map([[]]);var vO={},$C,CO;function RY(){if(CO)return $C;CO=1;var t=Zu();return $C=function(e,n,r){for(var i=0,o=arguments.length>2?r:t(n),s=new e(o);o>i;)s[i]=n[i++];return s},$C}var FC,yO;function EY(){if(yO)return FC;yO=1;var t=Xt();return FC=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},FC}var VC,SO;function yp(){if(SO)return VC;SO=1;var t=xi(),e=_R(),n=ra().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),VC=function(o){i[r][o]=!0},VC}var bO;function TY(){if(bO)return vO;bO=1;var t=ft(),e=Zt(),n=pr(),r=pd(),i=RY(),o=EY(),s=yp(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),s("toSorted"),vO}TY();var RO={},EO={},TO;function _Y(){if(TO)return EO;TO=1;var t=ft(),e=rn(),n=Qu(),r=pr(),i=sn(),o=go(),s=wr(),a=ia(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,p){if(c(f,d++))return p(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),EO}var _O;function MY(){return _O||(_O=1,_Y()),RO}MY();function IY(t,e){BD(t,e),e.add(t)}function WC(t,e,n){BD(t,e),e.set(t,n)}function BD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MO(t,e,n){return t.set(am(t,e),n),n}function Sn(t,e){return t.get(am(t,e))}function am(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const PY=100;var Sr=new WeakMap,mu=new WeakMap,BC=new WeakMap,jC=new WeakSet;class IO{constructor(){IY(this,jC),WC(this,Sr,new Map),WC(this,mu,new Map),WC(this,BC,new Set),Ka.forEach(e=>am(jC,this,PO).call(this,e))}getHooks(e){var n;return(n=Sn(Sr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Sn(Sr,this).has(e)||(am(jC,this,PO).call(this,e),Ka.push(e));const i=Sn(Sr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Sn(BC,this).has(e);!u&&o!==0&&(u=!0,Sn(BC,this).add(e)),u&&i.length>1&&Sn(Sr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Sn(Sr,this).has(e)&&Sn(Sr,this).get(e).length>0}remove(e,n){if(!Sn(Sr,this).has(e))return!1;const r=Sn(Sr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=Sn(mu,this).get(e);return i.skip=!0,o+=1,o>PY&&(Sn(Sr,this).set(e,r.filter(s=>!s.skip)),o=0),Sn(mu,this).set(e,o),!0}return!1}destroy(){Sn(Sr,this).clear(),Sn(mu,this).clear(),MO(Sr,this,null),MO(mu,this,null)}}function PO(t){Sn(Sr,this).set(t,[]),Sn(mu,this).set(t,0)}function OY(t,e,n){return(e=xY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xY(t){var e=HY(t,"string");return typeof e=="symbol"?e:e+""}function HY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const AY=nt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ne{constructor(){OY(this,"globalBucket",new IO)}static getSingleton(){return DY()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new IO),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?_(n,o=>this.add(e,o,r)):(kC.has(e)&&Ke(eE(AY,{hookName:e,removedInVersion:kC.get(e)})),LC.has(e)&&Ke(LC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?_(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?_(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=sm(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=sm(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Ka.push(e)}deregister(e){this.isRegistered(e)&&Ka.splice(Ka.indexOf(e),1)}isDeprecated(e){return LC.has(e)||kC.has(e)}isRegistered(e){return Ka.indexOf(e)>=0}getRegistered(){return Ka}}const NY=new ne;function DY(){return NY}const Ja=new Map;function oi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Ja.has(t)||Ja.set(t,new Map);const e=Ja.get(t);function n(l,u){e.set(l,u)}function r(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){Ja.delete(t),e.clear()}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s,clear:a}}function kY(t,e){var n;return Ja==null||(n=Ja.get(t.guid))===null||n===void 0?void 0:n.get(e)}const bb=new WeakMap,{register:LY,getItem:jD,hasItem:UD,getNames:$Y,getValues:sue}=oi("editors");function FY(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ne.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function zD(t,e){let n;if(typeof t=="function")bb.get(t)||lr(null,t),n=bb.get(t);else if(typeof t=="string")n=jD(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function lm(t){if(typeof t=="function")return t;if(!UD(t))throw Error(`No registered editor found under "${t}" name`);return jD(t).getConstructor()}function lr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new FY(e);typeof t=="string"&&LY(t,n),bb.set(e,n)}function VY(t,e,n){return(e=WY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WY(t){var e=BY(t,"string");return typeof e=="symbol"?e:e+""}function BY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let kg=0;class Qr{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;VY(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,jY(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),kg+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),kg-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),kg-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function jY(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ii(this)},t}function UY(){return kg}function zY(t,e){YY(t,e),e.add(t)}function YY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ca(t,e,n){return(e=GY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GY(t){var e=qY(t,"string");return typeof e=="symbol"?e:e+""}function qY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zd=new WeakSet;class Rb{constructor(e,n,r){zY(this,Zd),ca(this,"hot",void 0),ca(this,"tableMeta",void 0),ca(this,"selection",void 0),ca(this,"eventManager",void 0),ca(this,"destroyed",!1),ca(this,"activeEditor",void 0),ca(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Qr(e),this.hot.addHook("afterDocumentKeyDown",i=>UC(Zd,this,OO).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>UC(Zd,this,OO).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>UC(Zd,this,KY).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=zD(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function OO(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ns(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!CE(n)&&!FD(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function KY(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const xO=new WeakMap;Rb.getInstance=function(t,e,n){let r=xO.get(t);return r||(r=new Rb(t,e,n),xO.set(t,r)),r};function XY(t,e){YD(t,e),e.add(t)}function yc(t,e,n){YD(t,e),e.set(t,n)}function YD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mt(t,e){return t.get(Uo(t,e))}function Sc(t,e,n){return t.set(Uo(t,e),n),n}function Uo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Au=Object.freeze({CELL:"cell",MIXED:"mixed"});var tn=new WeakMap,Qd=new WeakMap,Jd=new WeakMap,ef=new WeakMap,tf=new WeakMap,Ps=new WeakSet;class ZY{constructor(e){var n=this;XY(this,Ps),yc(this,tn,void 0),yc(this,Qd,void 0),yc(this,Jd,1),yc(this,ef,null),yc(this,tf,new Map);const r=e.getSettings();Sc(tn,this,e),Sc(Qd,this,r.imeFastEdit?Au.MIXED:Au.CELL),mt(tn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Uo(Ps,n,JY).call(n,...o)}),mt(tn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Uo(Ps,n,HO).call(n,...o)}),mt(tn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Uo(Ps,n,HO).call(n,...o)}),mt(tn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Uo(Ps,n,QY).call(n,...o)})}getFocusMode(){return mt(Qd,this)}setFocusMode(e){Object.values(Au).includes(e)?Sc(Qd,this,e):Ke(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return mt(Jd,this)}setRefocusDelay(e){Sc(Jd,this,e)}setRefocusElementGetter(e){Sc(ef,this,e)}getRefocusElement(){var e;return typeof mt(ef,this)=="function"?mt(ef,this).call(this):(e=mt(tn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=mt(tn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=mt(tn,this).runHooks("modifyFocusedElement",s.row,s.col,r);lo(a)||(a=r),a&&!((o=mt(tn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Uo(Ps,this,SE).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mt(Jd,this);if(mt(tn,this).getSettings().imeFastEdit&&!((e=mt(tn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=mt(tn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),mt(tf,this).has(n)||mt(tf,this).set(n,Od(()=>{if(!mt(tn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),mt(tf,this).get(n)()}}}function SE(t){var e;const n=(e=mt(tn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!mt(tn,this).selection.isCellVisible(n)){t(null);return}const r=mt(tn,this).getCell(n.row,n.col,!0);r===null?mt(tn,this).addHookOnce("afterScroll",()=>{t(mt(tn,this).getCell(n.row,n.col,!0))}):t(r)}function HO(){Uo(Ps,this,SE).call(this,t=>{const{activeElement:e}=mt(tn,this).rootDocument;e&&vp(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function QY(){Uo(Ps,this,SE).call(this,t=>{this.getFocusMode()===Au.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function JY(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Au.MIXED:Au.CELL)}var AO={},zC,NO;function eG(){if(NO)return zC;NO=1;var t=ei(),e=ml(),n=xi(),r=n("match");return zC=function(i){var o;return t(i)&&((o=i[r])!==void 0?!!o:e(i)==="RegExp")},zC}var YC,DO;function tG(){if(DO)return YC;DO=1;var t=Xt(),e=nn(),n=t.RegExp,r=!e(function(){var i=!0;try{n(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(o,d,{get:function(){return s+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(o);return h!==a||s!==a});return YC={correct:r},YC}var GC,kO;function nG(){if(kO)return GC;kO=1;var t=sn();return GC=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},GC}var qC,LO;function rG(){if(LO)return qC;LO=1;var t=rn(),e=ti(),n=wd(),r=tG(),i=nG(),o=RegExp.prototype;return qC=r.correct?function(s){return s.flags}:function(s){return!r.correct&&n(o,s)&&!e(s,"flags")?t(i,s):s.flags},qC}var KC,$O;function iG(){if($O)return KC;$O=1;var t=Zt(),e=Ku(),n=Math.floor,r=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return KC=function(l,u,c,h,d,f){var p=c+l.length,v=h.length,S=a;return d!==void 0&&(d=e(d),S=s),i(f,S,function(E,C){var I;switch(r(C,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,p);case"<":I=d[o(C,1,-1)];break;default:var H=+C;if(H===0)return E;if(H>v){var $=n(H/10);return $===0?E:$<=v?h[$-1]===void 0?r(C,1):h[$-1]+r(C,1):E}I=h[H-1]}return I===void 0?"":I})},KC}var FO;function oG(){if(FO)return AO;FO=1;var t=ft(),e=rn(),n=Zt(),r=md(),i=on(),o=ei(),s=eG(),a=Jm(),l=vd(),u=rG(),c=iG(),h=xi(),d=na(),f=h("replace"),p=TypeError,v=n("".indexOf),S=n("".replace),E=n("".slice),C=Math.max;return t({target:"String",proto:!0},{replaceAll:function(H,$){var P=r(this),x,z,K,A,Q,X,se,ee,ue,vt,Ne=0,$e="";if(o(H)){if(x=s(H),x&&(z=a(r(u(H))),!~v(z,"g")))throw new p("`.replaceAll` does not allow non-global regexes");if(K=l(H,f),K)return e(K,H,P,$);if(d&&x)return S(a(P),H,$)}for(A=a(P),Q=a(H),X=i($),X||($=a($)),se=Q.length,ee=C(1,se),ue=v(A,Q);ue!==-1;)vt=X?a($(Q,ue,A)):c(Q,A,ue,[],void 0,$),$e+=E(A,Ne,ue)+vt,Ne=ue+se,ue=ue+ee>A.length?-1:v(A,Q,ue+ee);return Ne<A.length&&($e+=E(A,Ne)),$e}}),AO}oG();var VO={},WO={},BO;function sG(){if(BO)return WO;BO=1;var t=ft(),e=Qu(),n=pr(),r=sn(),i=go(),o=wr(),s=ia(),a=yd(),l=nn(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){r(this);try{n(f)}catch(C){o(this,"throw",C)}var p=arguments.length<2,v=p?void 0:arguments[1];if(h)return a(h,this,p?[f]:[f,v]);var S=i(this),E=0;if(e(S,function(C){p?(p=!1,v=C):v=f(v,C,E),E++},{IS_RECORD:!0}),p)throw new u("Reduce of empty iterator with no initial value");return v}}),WO}var jO;function aG(){return jO||(jO=1,sG()),VO}aG();const GD={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},lG=new RegExp(Object.keys(GD).map(t=>`(${t})`).join("|"),"gi");function uG(t){return(t&&t.nodeName||"")==="TABLE"}function Eb(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,p=[];for(let S=0;S<s;S+=1){const E=!f&&n&&S===0;let C="";if(f)C=`<th>${t.getColHeader(S-c)}</th>`;else if(E)C=`<th>${t.getRowHeader(d-h)}</th>`;else{const I=i[d][S],{hidden:H,rowspan:$,colspan:P}=t.getCellMeta(d-h,S-c);if(!H){const x=[];if($&&x.push(`rowspan="${$}"`),P&&x.push(`colspan="${P}"`),kt(I))C=`<td ${x.join(" ")}></td>`;else{const z=I.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${x.join(" ")}>${z}</td>`}}}p.push(C)}const v=["<tr>",...p,"</tr>"].join("");f?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Tb(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=kt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function qD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const I=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,H=>{const $=H.match(/<td\b[^>]*?>/g)[0],P=/<p.*?>/g,x=H.substring($.length,H.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(P,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${$}${x}</td>`});i.insertAdjacentHTML("afterbegin",`${I}`),o=i.querySelector("table")}if(!o||!uG(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((I,H)=>I+H.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,p=0;if(o.tHead){const I=Array.from(o.tHead.rows).filter(H=>{const $=H.querySelector("td")!==null;return $&&h.push(H),!$});f=I.length,d=f>0,f>1?n.nestedHeaders=Array.from(I).reduce((H,$)=>{const P=Array.from($.cells).reduce((x,z,K)=>{if(a&&K===0)return x;const{colSpan:A,innerHTML:Q}=z,X=A>1?{label:Q,colspan:A}:Q;return x.push(X),x},[]);return H.push(P),H},[]):d&&(n.colHeaders=Array.from(I[0].children).reduce((H,$,P)=>(a&&P===0||H.push($.innerHTML),H),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((I,H)=>(I.push(...Array.from(H.rows)),I),[]),...c];p=v.length;const S=new Array(p);for(let I=0;I<p;I++)S[I]=new Array(u);const E=[],C=[];for(let I=0;I<p;I++){const H=v[I],$=Array.from(H.cells),P=$.length;for(let x=0;x<P;x++){const z=$[x],{nodeName:K,innerHTML:A,rowSpan:Q,colSpan:X}=z,se=S[I].findIndex(ee=>ee===void 0);if(K==="TD"){if(Q>1||X>1){for(let Ne=I;Ne<I+Q;Ne++)if(Ne<p)for(let $e=se;$e<se+X;$e++)S[Ne][$e]=null;const ue=z.getAttribute("style");ue&&ue.includes("mso-ignore:colspan")||E.push({col:se,row:I,rowspan:Q,colspan:X})}let ee="";s&&/excel/gi.test(s.content)?ee=A.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ee=A.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[I][se]=ee.replace(lG,ue=>GD[ue])}else C.push(A)}}return E.length&&(n.mergeCells=E),C.length&&(n.rowHeaders=C),S.length&&(n.data=S),n}const cG=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:Tb,htmlToGridSettings:qD,instanceToHTML:Eb},Symbol.toStringTag,{value:"Module"}));function An(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function KD(t){return An(t,[","])}function de(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function _b(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function bE(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function We(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const hG=Object.freeze(Object.defineProperty({__proto__:null,clamp:We,isNumeric:An,isNumericLike:KD,rangeEach:de,rangeEachReverse:_b,valueAccordingPercent:bE},Symbol.toStringTag,{value:"Module"})),Mb="asc",dG="desc",UO=new Map([[Mb,[-1,1]],[dG,[1,-1]]]),fG=t=>`The priority '${t}' is already declared in a map.`,gG=t=>`The priority '${t}' is not a number.`;function mG(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=tt(t)?t:fG,e=tt(e)?e:gG;function r(o,s){if(!An(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Mb;const[s,a]=UO.get(o)||UO.get(Mb);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const pG=t=>`The id '${t}' is already declared in a map.`;function Sp(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=tt(t)?t:pG;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const wG=t=>`'${t}' value is already declared in a unique set.`;function vG(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=tt(t)?t:wG;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const RE=t=>`There is already registered "${t}" plugin.`,CG=t=>`There is already registered plugin on priority "${t}".`,yG=t=>`The priority "${t}" is not a number.`,XD=mG({errorPriorityExists:CG,errorPriorityNaN:yG}),ZD=vG({errorItemExists:RE}),Ib=Sp({errorIdExists:RE});function EE(){return[...XD.getItems(),...ZD.getItems()]}function xd(t){const e=kn(t);return Ib.getItem(e)}function SG(t){return!!xd(t)}function je(t,e,n){[t,e,n]=RG(t,e,n),xd(t)===void 0&&bG(t,e,n)}function bG(t,e,n){const r=kn(t);if(Ib.hasItem(r))throw new Error(RE(r));n===void 0?ZD.addItem(r):XD.addItem(n,r),Ib.addItem(r,e)}function RG(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:EG,getItem:TG,hasItem:QD,getNames:_G,getValues:aue}=oi("renderers");function um(t){if(typeof t=="function")return t;if(!QD(t))throw Error(`No registered renderer found under "${t}" name`);return TG(t)}function Rr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),EG(t,e)}const{register:MG,getItem:IG,hasItem:JD,getNames:PG,getValues:lue}=oi("validators");function TE(t){if(typeof t=="function")return t;if(!JD(t))throw Error(`No registered validator found under "${t}" name`);return IG(t)}function Xa(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),MG(t,e)}var zO={},YO;function OG(){if(YO)return zO;YO=1;var t=ft(),e=Ku(),n=Zu(),r=Cd(),i=yp();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=n(a),u=r(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),zO}OG();var GO={},qO;function xG(){if(qO)return GO;qO=1;var t=ft(),e=Zt(),n=md(),r=Cd(),i=Jm(),o=nn(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:s(c,f)}}),GO}xG();function bc(t,e,n){return(e=HG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HG(t){var e=AG(t,"string");return typeof e=="symbol"?e:e+""}function AG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NG{constructor(){bc(this,"count",0),bc(this,"startColumn",null),bc(this,"endColumn",null),bc(this,"startPosition",null),bc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const p=u[this.endColumn]+c-u[this.startColumn-1];if(p<=i&&(this.startColumn-=1),p>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Rc(t,e,n){return(e=DG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DG(t){var e=kG(t,"string");return typeof e=="symbol"?e:e+""}function kG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LG{constructor(){Rc(this,"count",0),Rc(this,"startRow",null),Rc(this,"endRow",null),Rc(this,"startPosition",null),Rc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ec(t,e,n){return(e=$G(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $G(t){var e=FG(t,"string");return typeof e=="symbol"?e:e+""}function FG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ek{constructor(){Ec(this,"count",0),Ec(this,"startColumn",null),Ec(this,"endColumn",null),Ec(this,"startPosition",null),Ec(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Tc(t,e,n){return(e=VG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VG(t){var e=WG(t,"string");return typeof e=="symbol"?e:e+""}function WG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tk{constructor(){Tc(this,"count",0),Tc(this,"startRow",null),Tc(this,"endRow",null),Tc(this,"startPosition",null),Tc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _c(t,e,n){return(e=BG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BG(t){var e=jG(t,"string");return typeof e=="symbol"?e:e+""}function jG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UG{constructor(){_c(this,"count",0),_c(this,"startColumn",0),_c(this,"endColumn",0),_c(this,"startPosition",0),_c(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Mc(t,e,n){return(e=zG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zG(t){var e=YG(t,"string");return typeof e=="symbol"?e:e+""}function YG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GG{constructor(){Mc(this,"count",0),Mc(this,"startRow",0),Mc(this,"endRow",0),Mc(this,"startPosition",0),Mc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function KO(t,e,n){return(e=qG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qG(t){var e=KG(t,"string");return typeof e=="symbol"?e:e+""}function KG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XG extends ek{constructor(){super(...arguments),KO(this,"columnStartOffset",0),KO(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function XO(t,e,n){return(e=ZG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZG(t){var e=QG(t,"string");return typeof e=="symbol"?e:e+""}function QG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JG extends tk{constructor(){super(...arguments),XO(this,"rowStartOffset",0),XO(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ZO(t,e,n){return(e=e2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e2(t){var e=t2(t,"string");return typeof e=="symbol"?e:e+""}function t2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nk{constructor(e){ZO(this,"calculationTypes",[]),ZO(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function li(t,e,n){return(e=n2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n2(t){var e=r2(t,"string");return typeof e=="symbol"?e:e+""}function r2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Bu=50;class i2 extends nk{constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),li(this,"viewportWidth",0),li(this,"scrollOffset",0),li(this,"zeroBasedScrollOffset",0),li(this,"totalColumns",0),li(this,"columnWidthFn",null),li(this,"columnWidth",0),li(this,"overrideFn",null),li(this,"inlineStartOffset",0),li(this,"totalCalculatedWidth",0),li(this,"startPositions",[]),li(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Bu:n}}function Ar(t,e,n){return(e=o2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o2(t){var e=s2(t,"string");return typeof e=="symbol"?e:e+""}function s2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a2 extends nk{constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),Ar(this,"viewportHeight",0),Ar(this,"scrollOffset",0),Ar(this,"zeroBasedScrollOffset",0),Ar(this,"totalRows",0),Ar(this,"rowHeightFn",null),Ar(this,"rowHeight",0),Ar(this,"overrideFn",null),Ar(this,"horizontalScrollbarHeight",0),Ar(this,"innerViewportHeight",0),Ar(this,"totalCalculatedHeight",0),Ar(this,"startPositions",[]),Ar(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function l2(t,e,n){u2(t,e),e.set(t,n)}function u2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QO(t,e,n){return(e=c2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c2(t){var e=h2(t,"string");return typeof e=="symbol"?e:e+""}function h2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ol(t,e){return t.get(rk(t,e))}function JO(t,e,n){return t.set(rk(t,e),n),n}function rk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ro=new WeakMap;class ul{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;QO(this,"row",null),QO(this,"col",null),l2(this,Ro,!1),JO(Ro,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Ol(Ro,this)}isSouthEastOf(e){return this.row>=e.row&&(Ol(Ro,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Ol(Ro,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Ol(Ro,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Ol(Ro,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof ul&&JO(Ro,this,e.isRtl()),this}clone(){return new ul(this.row,this.col,Ol(Ro,this))}toObject(){return{row:this.row,col:this.col}}}function d2(t,e,n){f2(t,e),e.set(t,n)}function f2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XC(t,e,n){return(e=g2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g2(t){var e=m2(t,"string");return typeof e=="symbol"?e:e+""}function m2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nr(t,e){return t.get(ik(t,e))}function p2(t,e,n){return t.set(ik(t,e),n),n}function ik(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jn=new WeakMap;class Hd{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;XC(this,"highlight",null),XC(this,"from",null),XC(this,"to",null),d2(this,Jn,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),p2(Jn,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Nr(Jn,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Nr(Jn,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Nr(Jn,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Nr(Jn,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Nr(Jn,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Nr(Jn,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Nr(Jn,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Nr(Jn,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof ul))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(Nr(Jn,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(Nr(Jn,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new Hd(this.highlight,this.from,this.to,Nr(Jn,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new ul(e,n,Nr(Jn,this))}}function Ni(t,e,n){w2(t,e),e.set(t,n)}function w2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fe(t,e){return t.get(ok(t,e))}function us(t,e,n){return t.set(ok(t,e),n),n}function ok(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Dr=new WeakMap,ZC=new WeakMap,wn=new WeakMap,xl=new WeakMap,nf=new WeakMap,ui=new WeakMap,QC=new WeakMap,Ic=new WeakMap,ha=new WeakMap,Di=new WeakMap;let sk=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Ni(this,Dr,void 0),Ni(this,ZC,void 0),Ni(this,wn,void 0),Ni(this,xl,void 0),Ni(this,nf,void 0),Ni(this,ui,void 0),Ni(this,QC,void 0),Ni(this,Ic,void 0),Ni(this,ha,[null,null]),Ni(this,Di,[null,null]),us(Dr,this,r),us(ZC,this,n),us(wn,this,o),us(xl,this,s),us(nf,this,a),us(ui,this,i),us(QC,this,e),this.registerEvents()}registerEvents(){fe(ui,this).addEventListener(fe(wn,this).holder,"contextmenu",r=>this.onContextMenu(r)),fe(ui,this).addEventListener(fe(wn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),fe(ui,this).addEventListener(fe(wn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{fe(ui,this).addEventListener(fe(wn,this).holder,"touchstart",r=>this.onTouchStart(r)),fe(ui,this).addEventListener(fe(wn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),fe(ui,this).addEventListener(fe(wn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||fe(Dr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,fe(Dr,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{fe(ui,this).addEventListener(fe(wn,this).holder,"mouseup",r=>this.onMouseUp(r)),fe(ui,this).addEventListener(fe(wn,this).holder,"mousedown",r=>this.onMouseDown(r))};Ti()?e():(rE()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(fe(Ic,this)&&r){const[i,o]=[r.row,fe(Ic,this).from.row],[s,a]=[r.col,fe(Ic,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=fe(wn,this).TABLE,i=ph(e,["TD","TH"],r);return i?(n.coords=fe(wn,this).getCoords(i),n.TD=i):Ce(e,"wtBorder")&&Ce(e,"current")?(n.coords=fe(xl,this).getFocusSelection().cellRange.highlight,n.TD=fe(wn,this).getCell(n.coords)):Ce(e,"wtBorder")&&Ce(e,"area")&&fe(xl,this).getAreaSelection().cellRange&&(n.coords=fe(xl,this).getAreaSelection().cellRange.to,n.TD=fe(wn,this).getCell(n.coords)),n}onMouseDown(e){const n=fe(ZC,this).rootDocument.activeElement,r=vE(RD,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);Ce(i,"corner")?fe(Dr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&fe(Dr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(fe(Di,this)[0]=o.TD,clearTimeout(fe(ha,this)[0]),fe(ha,this)[0]=setTimeout(()=>{fe(Di,this)[0]=null},1e3))}onContextMenu(e){if(fe(Dr,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!fe(Dr,this).has("onCellMouseOver"))return;const n=fe(wn,this).TABLE,r=ph(e.target,["TD","TH"],n),i=fe(nf,this)||this;r&&r!==i.lastMouseOver&&Ys(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,fe(wn,this).getCoords(r),r))}onMouseOut(e){if(!fe(Dr,this).has("onCellMouseOut"))return;const n=fe(wn,this).TABLE,r=ph(e.target,["TD","TH"],n),i=ph(e.relatedTarget,["TD","TH"],n),o=fe(nf,this)||this;r&&r!==i&&Ys(r,n)&&(this.callListener("onCellMouseOut",e,fe(wn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&fe(Dr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===fe(Di,this)[0]&&n.TD===fe(Di,this)[1]?(Ce(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),fe(Di,this)[0]=null,fe(Di,this)[1]=null):n.TD===fe(Di,this)[0]&&(fe(Di,this)[1]=n.TD,clearTimeout(fe(ha,this)[1]),fe(ha,this)[1]=setTimeout(()=>{fe(Di,this)[1]=null},500)))}onTouchStart(e){us(Ic,this,fe(xl,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ae(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&fe(Dr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];oE()&&(yD()||SD())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=fe(Dr,this).getSettingPure(e);o&&o(n,r,i,fe(QC,this).call(this))}destroy(){clearTimeout(fe(ha,this)[0]),clearTimeout(fe(ha,this)[1]),fe(ui,this).destroy()}};function JC(t,e,n){return(e=v2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v2(t){var e=C2(t,"string");return typeof e=="symbol"?e:e+""}function C2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y2{constructor(e,n,r){JC(this,"offset",void 0),JC(this,"total",void 0),JC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function ey(t,e,n){return(e=S2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S2(t){var e=b2(t,"string");return typeof e=="symbol"?e:e+""}function b2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R2{constructor(e,n,r){ey(this,"offset",void 0),ey(this,"total",void 0),ey(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function rf(t,e,n){return(e=E2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E2(t){var e=T2(t,"string");return typeof e=="symbol"?e:e+""}function T2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _2{constructor(){rf(this,"currentSize",0),rf(this,"nextSize",0),rf(this,"currentOffset",0),rf(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const M2=0,ex=1,Pb=2;function ty(t,e,n){return(e=I2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I2(t){var e=P2(t,"string");return typeof e=="symbol"?e:e+""}function P2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O2{constructor(){ty(this,"size",new _2),ty(this,"workingSpace",M2),ty(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=ex,e.workingSpace=Pb,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Pb,e.workingSpace=ex,this.sharedSize=e.getViewSize()}}var tx={},ny,nx;function x2(){if(nx)return ny;nx=1;var t=Qm(),e=TypeError;return ny=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},ny}var rx;function H2(){if(rx)return tx;rx=1;var t=ft(),e=Ku(),n=Zu(),r=YA(),i=x2(),o=GA(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){o(d+f);for(var p=d;p--;){var v=p+f;p in h?h[v]=h[p]:i(h,v)}for(var S=0;S<f;S++)h[S]=arguments[S]}return r(h,d+f)}}),tx}H2();function A2(t,e,n){return(e=N2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N2(t){var e=D2(t,"string");return typeof e=="symbol"?e:e+""}function D2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ix{constructor(e,n){A2(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function k2(t,e,n){return(e=L2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L2(t){var e=$2(t,"string");return typeof e=="symbol"?e:e+""}function $2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F2{constructor(e){k2(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new ix(o,n),l=new ix(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(Pb)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Hl(t,e,n){return(e=V2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V2(t){var e=W2(t,"string");return typeof e=="symbol"?e:e+""}function W2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ak{constructor(e,n){Hl(this,"rootNode",void 0),Hl(this,"nodesPool",void 0),Hl(this,"sizeSet",new O2),Hl(this,"collectedNodes",[]),Hl(this,"viewDiffer",new F2(this.sizeSet)),Hl(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class lk extends ak{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function ox(t,e,n){return(e=B2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B2(t){var e=j2(t,"string");return typeof e=="symbol"?e:e+""}function j2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U2{constructor(e){ox(this,"nodeType",void 0),ox(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Pc(t,e,n){return(e=z2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z2(t){var e=Y2(t,"string");return typeof e=="symbol"?e:e+""}function Y2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ad{constructor(e,n){Pc(this,"nodesPool",null),Pc(this,"nodeType",void 0),Pc(this,"rootNode",void 0),Pc(this,"table",null),Pc(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new U2(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function sx(t,e,n){return(e=G2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G2(t){var e=q2(t,"string");return typeof e=="symbol"?e:e+""}function q2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K2 extends Ad{constructor(){super("TH"),sx(this,"orderViews",new WeakMap),sx(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new lk(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),bl(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(d,[Hz(),Wz(),tE(h+1),oa(-1)]),n[h](a,d,h)}u.end()}}}class X2 extends Ad{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&ho(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&ve(this.rootNode,[aD()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&ve(s,[lD(),dD(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),bl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(u,[tE(a+1+this.table.rowHeadersCount),oa(-1),Az(),...a>=0?[Vz()]:[xz(),$u("Select whole grid")]]),r[n](l,u,n)}}}}let ax=!1;class Z2 extends Ad{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!ax&&e>1e3&&(ax=!0,Ke(nt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&Y(r,"rowHeader")}}function Q2(t,e,n){return(e=J2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J2(t){var e=eq(t,"string");return typeof e=="symbol"?e:e+""}function eq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Al={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let lx=!1;class tq extends Ad{constructor(e){super("TR",e),Q2(this,"orderView",void 0),this.orderView=new ak(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!lx&&e>1e3&&(lx=!0,Ke(nt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ve(this.rootNode,[aD()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;ve(o,[lD(),dD(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?Ce(o,Al.rowEven)||(me(o,Al.rowOdd),Y(o,Al.rowEven)):Ce(o,Al.rowOdd)||(me(o,Al.rowEven),Y(o,Al.rowOdd))}this.orderView.end()}}function ux(t,e,n){return(e=nq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nq(t){var e=rq(t,"string");return typeof e=="symbol"?e:e+""}function rq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iq extends Ad{constructor(){super("TD"),ux(this,"orderViews",new WeakMap),ux(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new lk(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),p=c.getCurrentNode();if(Ce(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),bl(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,p),this.table.isAriaEnabled()){var o,s;ve(p,[...p.hasAttribute("role")?[]:[Oz()],oa(-1),tE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function Jt(t,e,n){return(e=oq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oq(t){var e=sq(t,"string");return typeof e=="symbol"?e:e+""}function sq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aq{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Jt(this,"rootNode",void 0),Jt(this,"rootDocument",void 0),Jt(this,"rowHeaders",null),Jt(this,"columnHeaders",null),Jt(this,"colGroup",null),Jt(this,"rows",null),Jt(this,"cells",null),Jt(this,"rowFilter",null),Jt(this,"columnFilter",null),Jt(this,"rowUtils",null),Jt(this,"columnUtils",null),Jt(this,"rowsToRender",0),Jt(this,"columnsToRender",0),Jt(this,"rowHeaderFunctions",[]),Jt(this,"rowHeadersCount",0),Jt(this,"columnHeaderFunctions",[]),Jt(this,"columnHeadersCount",0),Jt(this,"cellRenderer",void 0),Jt(this,"activeOverlayName",void 0),Jt(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class lq{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new aq(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new K2,columnHeaders:new X2(n),colGroup:new Z2(r),rows:new tq(i),cells:new iq}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function ry(t,e,n){return(e=uq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uq(t){var e=cq(t,"string");return typeof e=="symbol"?e:e+""}function cq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hq{constructor(e,n){ry(this,"dataAccessObject",void 0),ry(this,"wtSettings",void 0),ry(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function cx(t,e,n){return(e=dq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dq(t){var e=fq(t,"string");return typeof e=="symbol"?e:e+""}function fq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gq{constructor(e,n){cx(this,"dataAccessObject",void 0),cx(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function ki(t,e,n){return(e=mq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mq(t){var e=pq(t,"string");return typeof e=="symbol"?e:e+""}function pq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ic{constructor(e,n,r,i,o){ki(this,"wtSettings",null),ki(this,"domBindings",void 0),ki(this,"TBODY",null),ki(this,"THEAD",null),ki(this,"COLGROUP",null),ki(this,"hasTableHeight",!0),ki(this,"hasTableWidth",!0),ki(this,"isTableVisible",!1),ki(this,"tableOffset",0),ki(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,aE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new gq(this.dataAccessObject,this.wtSettings),this.columnUtils=new hq(this.dataAccessObject,this.wtSettings),this.tableRenderer=new lq({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ve(r,[Go()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(r,[Go()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",this.isMaster&&ve(r,[oa(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ve(r.parentNode,[Go()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(r,[Go()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=bn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,p!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=bn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),p=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new R2(f,o,c),this.columnFilter=new y2(p,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const S={};this.wtSettings.getSetting("beforeDraw",!0,S),v=S.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(oo)||this.is(Gs))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(oo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(oo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Hu(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(oo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Zs(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=_D(r),s=n.cellIndex;_s(dl,n,this.wtRootElement)||_s(cl,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):_s(Gs,n,this.wtRootElement)||_s(oo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),_s(dl,n,this.wtRootElement)||_s(hl,n,this.wtRootElement)||_s(Gs,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),r=e*n.getDefaultRowHeight(),i=Hu(this.TBODY)-1,o=n.areCellsBorderBox(),s=o?qt:Hu,a=o?0:1,l=o?1:0;let u,c,h,d,f;if(!(r===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const p=h===0?l:0;f?c=s(f):c=s(d)-a,(!u&&n.getDefaultRowHeight()<c-p||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Bt(this.TABLE)}getHeight(){return qt(this.TABLE)}getTotalWidth(){const e=Bt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=qt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ll(this.TABLE)}_modifyRowHeaderWidth(e){let n=tt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const wq="stickyRowsBottom",_E={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};wo(_E,"MIXIN_NAME",wq,{writable:!1,enumerable:!1});const vq="stickyColumnsStart",bp={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};wo(bp,"MIXIN_NAME",vq,{writable:!1,enumerable:!1});class ME extends ic{constructor(e,n,r,i){super(e,n,r,i,Gs)}}st(ME,_E);st(ME,bp);const cl="top",oo="bottom",hl="inline_start",dl="top_inline_start_corner",Gs="bottom_inline_start_corner",uk=[cl,oo,hl,dl,Gs],Cq=new Map([[cl,`ht_clone_${cl}`],[oo,`ht_clone_${oo}`],[hl,`ht_clone_${hl} ht_clone_left`],[dl,`ht_clone_${dl} ht_clone_top_left_corner`],[Gs,`ht_clone_${Gs} ht_clone_bottom_left_corner`]]);function yq(t,e){Sq(t,e),e.add(t)}function Sq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bq(t,e,n){return(e=Rq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rq(t){var e=Eq(t,"string");return typeof e=="symbol"?e:e+""}function Eq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function of(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Oc=new WeakSet;class Tq{constructor(e){yq(this,Oc),bq(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=mr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=mr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return of(Oc,this,dx).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return of(Oc,this,dx).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return of(Oc,this,hx).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return of(Oc,this,hx).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function hx(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=bn(r.wtRootElement).left;const u=Math.abs(uE(s,s));if(l>u){const c=cE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function dx(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=bn(n.wtRootElement),a=pp(o,o);if(s.top>a){const l=Hu(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function kr(t,e,n){return(e=_q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _q(t){var e=Mq(t,"string");return typeof e=="symbol"?e:e+""}function Mq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IE{get eventManager(){return new Qr(this)}constructor(e,n){kr(this,"wtTable",void 0),kr(this,"wtScroll",void 0),kr(this,"wtViewport",void 0),kr(this,"wtOverlays",void 0),kr(this,"selectionManager",void 0),kr(this,"wtEvent",void 0),kr(this,"guid",`wt_${QR()}`),kr(this,"drawInterrupted",!1),kr(this,"drawn",!1),kr(this,"activeOverlayName","master"),kr(this,"domBindings",void 0),kr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Tq(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Qs(r,e[n])}])}}createCellCoords(e,n){return new ul(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new Hd(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||OD(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function fx(t,e,n){return(e=Iq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iq(t){var e=Pq(t,"string");return typeof e=="symbol"?e:e+""}function Pq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oq extends IE{constructor(e,n,r){super(e,n),fx(this,"cloneSource",void 0),fx(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new sk(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function xq(t,e,n){return(e=Hq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hq(t){var e=Aq(t,"string");return typeof e=="symbol"?e:e+""}function Aq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nd{constructor(e,n,r,i,o){xq(this,"wtSettings",null),wo(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Wu(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Wu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=ed(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){Ke(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+gn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(uk.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${Cq.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&ve(o,[Go()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===cl||u==="vertical"&&this.type===hl?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=ed(e.TABLE),new Oq(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class Nq extends Nd{constructor(e,n,r,i,o,s){super(e,n,Gs,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new ME(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Pd(n),this.repositionOverlay();let r=qt(this.clone.wtTable.TABLE);const i=Bt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=gn(r)),i.style.bottom=`${o}px`}}const Dq="calculatedColumns",Rp={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};wo(Rp,"MIXIN_NAME",Dq,{writable:!1,enumerable:!1});class PE extends ic{constructor(e,n,r,i){super(e,n,r,i,oo)}}st(PE,_E);st(PE,Rp);function kq(t,e,n){return(e=Lq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lq(t){var e=$q(t,"string");return typeof e=="symbol"?e:e+""}function $q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fq extends Nd{constructor(e,n,r,i){super(e,n,oo,r,i),kq(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new PE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=gn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(mp(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=gn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=qt(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=gn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return pp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=Ce(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Y(s,"innerBorderBottom"),o=!a):(me(s,"innerBorderBottom"),o=a)}return o}}const Vq="calculatedRows",OE={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};wo(OE,"MIXIN_NAME",Vq,{writable:!1,enumerable:!1});class xE extends ic{constructor(e,n,r,i){super(e,n,r,i,hl)}}st(xE,OE);st(xE,bp);const Wq="localHooks",Rn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)sm(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};wo(Rn,"MIXIN_NAME",Wq,{writable:!1,enumerable:!1});let ck=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};st(ck,Rn);const hk="active-header",HE="header",AE="area",cm="focus",Bq="fill",jq="row",Uq="column",zq="custom-selection",NE=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var gx={},mx;function Yq(){if(mx)return gx;mx=1;var t=yp();return t("flat"),gx}Yq();function Gq(t,e){dk(t,e),e.add(t)}function px(t,e,n){dk(t,e),e.set(t,n)}function dk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ht(t,e){return t.get(Ph(t,e))}function wx(t,e,n){return t.set(Ph(t,e),n),n}function Ph(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mi=new WeakMap,Pn=new WeakMap,sf=new WeakSet;class qq{constructor(){Gq(this,sf),px(this,mi,void 0),px(this,Pn,void 0)}setActiveOverlay(e){return wx(Pn,this,e),this}setActiveSelection(e){return wx(mi,this,e),this}scan(){const e=Ht(mi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Ht(mi,this).getCorners(),{wtTable:s}=Ht(Pn,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let p=s.getColumnHeader(h,f);const v=Ht(Pn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Ht(mi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});v!==null&&(v!==h&&(p=s.getColumnHeader(v,f)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Ht(mi,this).getCorners(),{wtTable:s}=Ht(Pn,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let p=s.getRowHeader(h,f);const v=Ht(Pn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Ht(mi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==h&&(p=s.getRowHeader(v,f)),e(p))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Ht(Pn,this);Ph(sf,this,Kq).call(this,(r,i)=>{const o=n.getCell(Ht(Pn,this).createCellCoords(r,i)),s=Ht(Pn,this).getSetting("onAfterDrawSelection",r,i,Ht(mi,this).settings.layerLevel);typeof s=="string"&&Y(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Ht(mi,this).getCorners(),{wtTable:i}=Ht(Pn,this);Ph(sf,this,vx).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Ht(Pn,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Ht(mi,this).getCorners(),{wtTable:i}=Ht(Pn,this);Ph(sf,this,vx).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Ht(Pn,this).createCellCoords(o,s));e(a)}})}}function Kq(t){let[e,n,r,i]=Ht(mi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Ht(Pn,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Ht(Pn,this).createCellCoords(e,n));if(!lo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function vx(t){const{wtTable:e}=Ht(Pn,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class Cx{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=NE(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ii(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ti()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,r=n.getSetting("stylesHandler"),i=r.getCSSVariableValue("cell-mobile-handle-size"),o=r.getCSSVariableValue("cell-mobile-handle-border-radius"),s=r.getCSSVariableValue("cell-mobile-handle-background-color"),a=r.getCSSVariableValue("cell-mobile-handle-border-width"),l=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};Oe(h,(f,p)=>{this.selectionHandles.styles.bottomHitArea[p]=f,this.selectionHandles.styles.topHitArea[p]=f});const d=r.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};Oe(d,(f,p)=>{this.selectionHandles.styles.bottom[p]=f,this.selectionHandles.styles.top[p]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),p=parseInt(u.width,10),v=parseInt(c.width,10),S=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-p-1,10)}px`,u[l]=`${parseInt(i-p-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const C=Math.min(parseInt(i+o,10),S-p-f*2),I=Math.min(parseInt(i+o-v/4,10),S-v-f*2);h[l]=`${C}px`,d[l]=`${I}px`;const H=Math.min(parseInt(r+s,10),E-p-f*2),$=Math.min(parseInt(r+s-v/4,10),E-v-f*2);h.top=`${H}px`,d.top=`${$}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),f=s.getFirstRenderedColumn(),p=s.getLastRenderedColumn();if(f<0&&p<0||h<0&&d<0){this.disappear();return}let v;if(u){if(r=Math.max(r,f),o=Math.min(o,p),n=Math.max(n,h),i=Math.min(i,d),o<r||i<n){this.disappear();return}v=s.getCell(this.wot.createCellCoords(n,r))}else if(v=s.getCell(this.wot.createCellCoords(n,r)),!lo(v)){this.disappear();return}const S=u?s.getCell(this.wot.createCellCoords(i,o)):v,E=bn(v),C=u?bn(S):E,I=bn(s.TABLE),H=E.top,$=E.left,P=this.wot.wtSettings.getSetting("rtlMode");let x=0,z=0;if(P){const $e=Bt(s.TABLE),Ct=Bt(v),rt=l.innerWidth-I.left-$e;z=$+Ct-C.left,x=l.innerWidth-$-Ct-rt-1}else z=C.left+Bt(S)-$,x=$-I.left-1;if(this.isEntireColumnSelected(n,i)){const $e=n,Ct=this.getDimensionsFromHeader("columns",r,o,$e,I);let rt=null;Ct&&([rt,x,z]=Ct),rt&&(v=rt)}let K=H-I.top-1,A=C.top+qt(S)-H;if(this.isEntireRowSelected(r,o)){const $e=r,Ct=this.getDimensionsFromHeader("rows",n,i,$e,I);let rt=null;Ct&&([rt,K,A]=Ct),rt&&(v=rt)}const Q=l.getComputedStyle(v);parseInt(Q.borderTopWidth,10)>0&&(K+=1,A=A>0?A-1:0),parseInt(Q[P?"borderRightWidth":"borderLeftWidth"],10)>0&&(x+=1,z=z>0?z-1:0);const X=P?"right":"left",se=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${K}px`,this.topStyle[X]=`${x}px`,this.topStyle.width=`${z+se}px`,this.topStyle.display="block",this.startStyle.top=`${K}px`,this.startStyle[X]=`${x}px`,this.startStyle.height=`${A+se}px`,this.startStyle.display="block",this.bottomStyle.top=`${K+A-parseInt(this.bottomStyle.height,10)+se}px`,this.bottomStyle[X]=`${x}px`,this.bottomStyle.width=`${z+se}px`,this.bottomStyle.display="block",this.endStyle.top=`${K}px`,this.endStyle[X]=`${x+z-parseInt(this.endStyle.width,10)+se}px`,this.endStyle.height=`${A+se}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const ue=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[vt,Ne]=[i,o];if(ue&&Array.isArray(ue)&&([,,vt,Ne]=ue),Ti()||!ee||this.isPartRange(vt,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top=`${K+A+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[X]=`${x+z+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let $e=Wu(s.TABLE);const Ct=$e===l;Ct&&($e=a.documentElement);const rt=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,at=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),mn=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const g=Ct?S.getBoundingClientRect().left:S.offsetLeft;let m=!1,y=0;if(P?(y=g-parseInt(this.cornerDefaultStyle.width,10)/2,m=y<0):(y=g+Bt(S)+parseInt(this.cornerDefaultStyle.width,10)/2,m=y>=cE($e)),m){const N=Math.floor(x+z+this.cornerCenterPointOffset-at-rt);c?(this.cornerStyle[X]=`${N}px`,this.cornerStyle[P?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[X]=`${N-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(Ct?S.getBoundingClientRect().top:S.offsetTop)+qt(S)+parseInt(this.cornerDefaultStyle.height,10)/2>=Hu($e)){const N=Math.floor(K+A+this.cornerCenterPointOffset-mn-rt);c?(this.cornerStyle.top=`${N}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${N-1}px`}this.cornerStyle.display="block"}Ti()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,K,x,z,A)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,p=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return qt(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Bt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const S=this.wot.getSetting("columnHeaders").length;if(p=l(n,S-i),v=l(r,S-i),!p||!v)return!1;const E=bn(p),C=bn(v);return p&&v&&(h=E[f]-o[f]-1,d=C[f]+u(v)-E[f]),[p,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?Y(this[e],"hidden"):(Ce(this[e],"hidden")&&me(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?Y(this[e],"hidden"):me(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ti()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function Xq(t,e){fk(t,e),e.add(t)}function Nl(t,e,n){fk(t,e),e.set(t,n)}function fk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(DE(t,e))}function yx(t,e,n){return t.set(DE(t,e),n),n}function DE(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var On=new WeakMap,ur=new WeakMap,iy=new WeakMap,wh=new WeakMap,oy=new WeakMap,da=new WeakMap,Sx=new WeakSet;class Zq{constructor(e){Xq(this,Sx),Nl(this,On,void 0),Nl(this,ur,void 0),Nl(this,iy,new qq),Nl(this,wh,new WeakMap),Nl(this,oy,new WeakSet),Nl(this,da,new Map),yx(ur,this,e)}setActiveOverlay(e){return yx(On,this,e),xe(iy,this).setActiveOverlay(xe(On,this)),xe(wh,this).has(xe(On,this))||xe(wh,this).set(xe(On,this),new Set),this}getFocusSelection(){return xe(ur,this)!==null?xe(ur,this).getFocus():null}getAreaSelection(){return xe(ur,this)!==null?xe(ur,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(xe(da,this).has(e)){const r=xe(da,this).get(e);if(r.has(xe(On,this)))return r.get(xe(On,this));const i=new Cx(xe(On,this),e.settings);return r.set(xe(On,this),i),i}const n=new Cx(xe(On,this),e.settings);return xe(da,this).set(e,new Map([[xe(On,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=xe(da,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){xe(da,this).get(e).forEach(n=>n.destroy()),xe(da,this).delete(e)}render(e){if(xe(ur,this)===null)return;e&&DE(Sx,this,Qq).call(this);const n=Array.from(xe(ur,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;xe(oy,this).has(s)||(xe(oy,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&xe(iy,this).setActiveSelection(s).scan().forEach(p=>{if(r.has(p)){const v=r.get(p);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else r.set(p,new Map([[a,1]]));l&&(i.has(p)||i.set(p,[]),p.nodeName==="TH"&&i.get(p).push(...l))});const d=s.getCorners();xe(On,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>xe(wh,this).get(xe(On,this)).add(u)),Y(s,l),s.nodeName==="TD"&&Array.isArray((a=xe(ur,this).options)===null||a===void 0?void 0:a.cellAttributes)&&ve(s,xe(ur,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{ve(o,[...i.get(o)])})}}function Qq(){const t=xe(wh,this).get(xe(On,this)),e=xe(On,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=xe(On,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=xe(ur,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=xe(ur,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=xe(ur,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...xe(ur,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)me(o[a],n),bl(o[a],s)}),t.clear()}class Jq extends Nd{constructor(e,n,r,i){super(e,n,hl,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new xE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),wp(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Pd(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,lE(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=gn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Bt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=NE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!Ce(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=gn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,HD(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(uE(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?me(r,"emptyRows"):Y(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)Y(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=Ce(r,"innerBorderInlineStart");e?(Y(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(me(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const eK="stickyRowsTop",kE={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};wo(kE,"MIXIN_NAME",eK,{writable:!1,enumerable:!1});class LE extends ic{constructor(e,n,r,i){super(e,n,r,i,dl)}}st(LE,kE);st(LE,bp);function bx(t,e,n){return(e=tK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tK(t){var e=nK(t,"string");return typeof e=="symbol"?e:e+""}function nK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rK extends Nd{constructor(e,n,r,i,o,s){super(e,n,dl,r,i),bx(this,"topOverlay",void 0),bx(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new LE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();wp(e,`${i}px`,`${o}px`)}else Pd(e);let n=qt(this.clone.wtTable.TABLE);const r=Bt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class $E extends ic{constructor(e,n,r,i){super(e,n,r,i,cl)}}st($E,kE);st($E,Rp);function iK(t,e,n){return(e=oK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oK(t){var e=sK(t,"string");return typeof e=="symbol"?e:e+""}function sK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aK extends Nd{constructor(e,n,r,i){super(e,n,cl,r,i),iK(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new $E(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),wp(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Pd(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(mp(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=gn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=qt(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=NE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Ce(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=gn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,xD(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return pp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?me(i,"emptyColumns"):Y(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=Ce(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(Y(i,"innerBorderTop"),a=!h):(me(i,"innerBorderTop"),a=h)}}return a}}function af(t,e,n){lK(t,e),e.set(t,n)}function lK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eo(t,e,n){return(e=uK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:e+""}function cK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fa(t,e,n){return t.set(gk(t,e),n),n}function To(t,e){return t.get(gk(t,e))}function gk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Dl=new WeakMap,lf=new WeakMap,kl=new WeakMap,uf=new WeakMap;class hK{constructor(e,n,r,i,o,s){Eo(this,"wot",null),af(this,Dl,[]),Eo(this,"topOverlay",null),Eo(this,"bottomOverlay",null),Eo(this,"inlineStartOverlay",null),Eo(this,"topInlineStartCornerOverlay",null),Eo(this,"bottomInlineStartCornerOverlay",null),Eo(this,"browserLineHeight",void 0),Eo(this,"wtSettings",null),af(this,lf,!1),af(this,kl,0),af(this,uf,null),Eo(this,"resizeObserver",new ResizeObserver(c=>{Qh(()=>{!Array.isArray(c)||!c.length||(fa(kl,this,To(kl,this)+1),To(kl,this)===100&&(Ke("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),To(uf,this)!==null&&clearTimeout(To(uf,this)),fa(uf,this,setTimeout(()=>{fa(kl,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=gn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:ed(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...To(Dl,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new aK(...e),this.bottomOverlay=new Fq(...e),this.inlineStartOverlay=new Jq(...e),this.topInlineStartCornerOverlay=new rK(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Nq(...e,this.bottomOverlay,this.inlineStartOverlay),fa(Dl,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){fa(lf,this,To(Dl,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),To(Dl,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),To(Dl,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!iE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Qh(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{fa(kl,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=rc(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!To(lf,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),fa(lf,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=ed(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),p=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),v=f()?1:0,S=p()?1:0;d.width=`${c+S}px`,d.height=`${u+v}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return _(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];_(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function Rx(t,e,n){return(e=dK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dK(t){var e=fK(t,"string");return typeof e=="symbol"?e:e+""}function fK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gK{constructor(e){Rx(this,"settings",{}),Rx(this,"defaults",Object.freeze(this.getDefaults())),Oe(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Qs(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?Oe(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class FE extends ic{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Wu(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=td(e,"height",n),o=td(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=ll(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}st(FE,OE);st(FE,Rp);class mK{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new GG:new JG],["fullyVisible",()=>new LG],["partiallyVisible",()=>new tk]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new UG:new XG],["fullyVisible",()=>new NG],["partiallyVisible",()=>new ek]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=qt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return bn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=qt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=Bt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=gn(this.domBindings.rootDocument),new a2({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=gn(this.domBindings.rootDocument)),new i2({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){Oe(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}class pK extends IE{constructor(e,n){super(e,new gK(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new FE(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new mK(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Zq(this.wtSettings.getSetting("selections")),this.wtEvent=new sk(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new hK(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Oe(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),me(this.wtTable.wtRootElement.parentNode,n),Y(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!uk.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class VE{constructor(e){e instanceof IE?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new VE(n);return()=>r},this._wot=new pK(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function Ex(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function wK(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}function vK(t){let{isLeftClick:e,selection:n,cellRangeMapper:r}=t;if(!e||n.settings.selectionMode!=="multiple")return;const i=n.getSelectedRange(),o=i.clone().map(a=>r.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!n.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),n.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),n.refresh())}}const CK=new Map([["touchstart",Ex],["mousedown",Ex],["mouseover",wK],["mouseup",vK]]);function sy(t,e){CK.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:Cp(t)||t.type==="touchstart",isRightClick:Js(t),...e})}const mk=new WeakMap,WE=Symbol("rootInstance");function yK(t){mk.set(t,!0)}function SK(t){return t===WE}function pu(t){return mk.has(t)}function bK(t,e){pk(t,e),e.add(t)}function cs(t,e,n){pk(t,e),e.set(t,n)}function pk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hs(t,e,n){return(e=RK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RK(t){var e=EK(t,"string");return typeof e=="symbol"?e:e+""}function EK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ut(t,e){return t.get(Nu(t,e))}function er(t,e,n){return t.set(Nu(t,e),n),n}function Nu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ay=new WeakMap,cf=new WeakMap,hf=new WeakMap,_o=new WeakMap,ci=new WeakMap,ly=new WeakMap,uy=new WeakMap,Ll=new WeakMap,vh=new WeakSet;let TK=class{constructor(e){bK(this,vh),hs(this,"hot",void 0),hs(this,"eventManager",void 0),hs(this,"settings",void 0),hs(this,"THEAD",void 0),hs(this,"TBODY",void 0),hs(this,"_wt",void 0),hs(this,"activeWt",void 0),cs(this,ay,0),cs(this,cf,0),hs(this,"postponedAdjustElementsSize",!1),cs(this,hf,!1),cs(this,_o,void 0),cs(this,ci,void 0),cs(this,ly,0),cs(this,uy,0),cs(this,Ll,null),this.hot=e,this.eventManager=new Qr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Nu(vh,this,MK).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),Y(e,"handsontable"),er(ci,this,n.createElement("TABLE")),Y(Ut(ci,this),"htCore"),this.hot.getSettings().tableClassName&&Y(Ut(ci,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(ve(Ut(ci,this),[Go()]),ve(e,[Pz(),hD(-1),dp(this.hot.countCols()),Uz()])),this.THEAD=n.createElement("THEAD"),Ut(ci,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Ut(ci,this).appendChild(this.TBODY),this.hot.table=Ut(ci,this),this.hot.container.insertBefore(Ut(ci,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{er(hf,this,!0),this.isTextSelectionAllowed(a.target)||(Sb(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{er(hf,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Ut(hf,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&Sb(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&Cp(a)&&r.finish(),er(_o,this,!1);const l=vp(n.activeElement);Ih(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Js(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&Js(a)&&(r.finish(),er(_o,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),er(_o,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Ut(_o,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const p=gn(n);if(n.elementFromPoint(u+p,c)!==d||n.elementFromPoint(u,c+p)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=al(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=al(s);this.eventManager.addEventListener(Ut(ci,this),"selectstart",a=>{this.settings.fragmentSelection||Ih(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&Y(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&me(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Ut(ci,this),isDataViewInstance:()=>pu(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),er(cf,this,o.length),this.hot.getSettings().ariaTags&&Nu(vh,this,wk).call(this)===this.hot.countCols()&&Nu(vh,this,_K).call(this,Ut(cf,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),er(ay,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),p=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,f)),this.hot.runHooks("beforeRenderer",a,l,u,p,v,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,p,v,f),this.hot.runHooks("afterRenderer",a,l,u,p,v,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ll(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,er(_o,this,!0),er(Ll,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ns(o)&&(sy(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,er(_o,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ns(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ns(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ns(o)&&(Ut(_o,this)&&(!Ut(Ll,this)||Ut(Ll,this).x!==o.clientX||Ut(Ll,this).y!==o.clientY)&&sy(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,er(Ll,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ns(o)||this.hot.isDestroyed)&&(sy(o,{coords:u,selection:this.hot.selection,cellRangeMapper:kY(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[p,v,S,E]=f;return[p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,S>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(S,-1)):S,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new VE(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Ih(e))return!0;const n=Ys(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Ut(_o,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Ce(r,"relative")){ho(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;Ce(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",Y(s,["relative",...o()])):(ho(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(ve(a,...Go()),ve(l,...Go())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ce(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Ce(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Rl(e,r(n,i)):(Qs(e,"Â "),Y(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){er(ly,this,e),er(uy,this,n)}getLastSize(){return{width:Ut(ly,this),height:Ut(uy,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Ut(ay,this)}getRowHeadersCount(){return Ut(cf,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};function wk(){return parseInt(this.hot.rootElement.getAttribute(dp()[0]),10)}function _K(t){const e=Nu(vh,this,wk).call(this)+t;ve(this.hot.rootElement,...dp(e))}function MK(){const t=this.hot.rootElement;this.hasVerticalScroll()?Y(t,"htHasScrollY"):me(t,"htHasScrollY"),this.hasHorizontalScroll()?Y(t,"htHasScrollX"):me(t,"htHasScrollX")}var Tx={},_x={},Mx;function IK(){if(Mx)return _x;Mx=1;var t=ft(),e=rn(),n=Qu(),r=pr(),i=sn(),o=go(),s=wr(),a=ia(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return!n(h,function(f,p){if(!c(f,d++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),_x}var Ix;function PK(){return Ix||(Ix=1,IK()),Tx}PK();const vk="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Ob=vk.length;function Ep(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%Ob,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/Ob,10);return n}function OK(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Ob**r*(vk.indexOf(t[n])+1);return e-=1,e}function xK(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Ep(i)+(r+1));n.push(o)}return n}function HK(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Ep(i)+(r+1);n.push(o)}return n}function AK(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function BE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function jE(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Pe(t[0])&&(e=gp(t[0]))),e}function Ck(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function yk(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const NK=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:jE,createEmptySpreadsheetData:AK,createSpreadsheetData:xK,createSpreadsheetObjectData:HK,dataRowToChangesArray:BE,isArrayOfArrays:Ck,isArrayOfObjects:yk,spreadsheetColumnIndex:OK,spreadsheetColumnLabel:Ep},Symbol.toStringTag,{value:"Module"}));function xc(t,e,n){return(e=DK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DK(t){var e=kK(t,"string");return typeof e=="symbol"?e:e+""}function kK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LK{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];xc(this,"hot",void 0),xc(this,"data",void 0),xc(this,"dataType","array"),xc(this,"colToProp",()=>{}),xc(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return _(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):de(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(Pe(a)||tt(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;de(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?Ng(l,d,f):l[d]=f}})}else Oe(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Ng(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=mr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:Ng(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?mD(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=mr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return de(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return jE(this.data)}destroy(){this.data=null,this.hot=null}}var Px={},Ox={},xx;function $K(){if(xx)return Ox;xx=1;var t=ft(),e=rn(),n=Qu(),r=pr(),i=sn(),o=go(),s=wr(),a=ia(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,p){if(c(f,d++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),Ox}var Hx;function FK(){return Hx||(Hx=1,$K()),Px}FK();function Ax(t,e,n){return(e=VK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VK(t){var e=WK(t,"string");return typeof e=="symbol"?e:e+""}function WK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class El{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ax(this,"indexedValues",[]),Ax(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,tt(this.initValueOrFn)?de(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):de(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}st(El,Rn);function UE(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>tt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function zE(t,e){return Xs(t,(n,r)=>e.includes(r)===!1)}class sa extends El{insert(e,n){this.indexedValues=UE(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=zE(this.indexedValues,e),super.remove(e)}}class Tp extends sa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return an(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function YE(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function nd(t,e){return Xs(t,n=>e.includes(n)===!1)}function GE(t,e){return Le(t,n=>n-e.filter(r=>r<n).length)}function qE(t,e){const n=e[0],r=e.length;return Le(t,i=>i>=n?i+r:i)}function BK(t,e,n){return(e=jK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jK(t){var e=UK(t,"string");return typeof e=="symbol"?e:e+""}function UK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _p extends El{constructor(){super(...arguments),BK(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=nd(this.orderOfIndexes,[e]),tt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=UE(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=qE(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=zE(this.indexedValues,e),this.orderOfIndexes=nd(this.orderOfIndexes,e),this.orderOfIndexes=GE(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Dd extends sa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return an(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const Nx=new Map([["indexesSequence",{getListWithInsertedItems:YE,getListWithRemovedItems:nd}],["physicallyIndexed",{getListWithInsertedItems:UE,getListWithRemovedItems:zE}]]),Sk=t=>{if(Nx.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return Nx.get(t)};class bk extends El{constructor(){super(e=>e)}insert(e,n){const r=qE(this.indexedValues,n);this.indexedValues=YE(r,e,n),super.insert(e,n)}remove(e){const n=nd(this.indexedValues,e);this.indexedValues=GE(n,e),super.remove(e)}}const Dx=new Map([["hiding",Tp],["index",El],["linkedPhysicalIndexToValue",_p],["physicalIndexToValue",sa],["trimming",Dd]]);function zK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Dx.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(Dx.get(t))(e)}function YK(t,e,n){return(e=GK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GK(t){var e=qK(t,"string");return typeof e=="symbol"?e:e+""}function qK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let xb=0;class KE{constructor(){YK(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),xb+=1)}unregister(e){const n=this.collection.get(e);ae(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),xb-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Rt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}st(KE,Rn);function KK(){return xb}function cy(t,e,n){return(e=XK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XK(t){var e=ZK(t,"string");return typeof e=="symbol"?e:e+""}function ZK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kx extends KE{constructor(e,n){super(),cy(this,"mergedValuesCache",[]),cy(this,"aggregationFunction",void 0),cy(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Le(this.get(),o=>o.getValues()),r=[],i=ae(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Le(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ae(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function QK(t,e,n){JK(t,e),e.set(t,n)}function JK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function e3(t,e,n){return t.set(Rk(t,e),n),n}function t3(t,e){return t.get(Rk(t,e))}function Rk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hy=new WeakMap;class Ek{constructor(){QK(this,hy,[])}subscribe(e){return this.addLocalHook("change",e),this._write(t3(hy,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){e3(hy,this,e)}}st(Ek,Rn);function Lx(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Hc(t,e,n){n3(t,e),e.set(t,n)}function n3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lr(t,e){return t.get(Tk(t,e))}function df(t,e,n){return t.set(Tk(t,e),n),n}function Tk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ff=new WeakMap,Ac=new WeakMap,gf=new WeakMap,mf=new WeakMap,pf=new WeakMap;class r3{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Hc(this,ff,new Set),Hc(this,Ac,[]),Hc(this,gf,[]),Hc(this,mf,!1),Hc(this,pf,!1),df(pf,this,e??!1)}createObserver(){const e=new Ek;return Lr(ff,this).add(e),e.addLocalHook("unsubscribe",()=>{Lr(ff,this).delete(e)}),e._writeInitialChanges(Lx(Lr(Ac,this),Lr(gf,this))),e}emit(e){let n=Lr(gf,this);(!Lr(mf,this)||Lr(Ac,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Lr(pf,this)):df(Ac,this,new Array(e.length).fill(Lr(pf,this))),Lr(mf,this)||(df(mf,this,!0),n=Lr(Ac,this)));const r=Lx(n,e);Lr(ff,this).forEach(i=>i._write(r)),df(gf,this,e)}}function Vn(t,e,n){return(e=i3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i3(t){var e=o3(t,"string");return typeof e=="symbol"?e:e+""}function o3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hb{constructor(){Vn(this,"indexesSequence",new bk),Vn(this,"trimmingMapsCollection",new kx(e=>e.some(n=>n===!0),!1)),Vn(this,"hidingMapsCollection",new kx(e=>e.some(n=>n===!0),!1)),Vn(this,"variousMapsCollection",new KE),Vn(this,"hidingChangesObservable",new r3({initialIndexValue:!1})),Vn(this,"notTrimmedIndexesCache",[]),Vn(this,"notHiddenIndexesCache",[]),Vn(this,"isBatched",!1),Vn(this,"indexesSequenceChanged",!1),Vn(this,"indexesChangeSource",void 0),Vn(this,"trimmedIndexesChanged",!1),Vn(this,"hiddenIndexesChanged",!1),Vn(this,"renderablePhysicalIndexesCache",[]),Vn(this,"fromPhysicalToVisualIndexesCache",new Map),Vn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,zK(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Dd?this.trimmingMapsCollection.register(e,n):n instanceof Tp?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ae(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ae(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ae(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ae(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Le(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=nd(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(YE(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=ae(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=Le(new Array(n).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=r==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}st(Hb,Rn);function s3(t,e){return Oe(e,(n,r)=>{Rt(t[r])&&(t[r]=n)}),t}function _k(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Mk(t){ae(t)&&yE(nt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function a3(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:l3,getValues:u3}=oi("phraseFormatters");function c3(t,e){l3(t,e)}function h3(){return u3()}c3("pluralize",a3);const Ik="ContextMenu:items",Te=Ik,XE=`${Te}.noItems`,ZE=`${Te}.insertRowAbove`,QE=`${Te}.insertRowBelow`,JE=`${Te}.insertColumnOnTheLeft`,e0=`${Te}.insertColumnOnTheRight`,t0=`${Te}.removeRow`,n0=`${Te}.removeColumn`,r0=`${Te}.undo`,i0=`${Te}.redo`,hm=`${Te}.readOnly`,o0=`${Te}.clearColumn`,s0=`${Te}.copy`,a0=`${Te}.copyWithHeaders`,l0=`${Te}.copyWithGroupHeaders`,u0=`${Te}.copyHeadersOnly`,c0=`${Te}.cut`,h0=`${Te}.freezeColumn`,d0=`${Te}.unfreezeColumn`,f0=`${Te}.mergeCells`,g0=`${Te}.unmergeCells`,m0=`${Te}.addComment`,p0=`${Te}.editComment`,w0=`${Te}.removeComment`,v0=`${Te}.readOnlyComment`,C0=`${Te}.align`,y0=`${Te}.align.left`,S0=`${Te}.align.center`,b0=`${Te}.align.right`,R0=`${Te}.align.justify`,E0=`${Te}.align.top`,T0=`${Te}.align.middle`,_0=`${Te}.align.bottom`,M0=`${Te}.borders`,I0=`${Te}.borders.top`,P0=`${Te}.borders.right`,O0=`${Te}.borders.bottom`,x0=`${Te}.borders.left`,H0=`${Te}.borders.remove`,A0=`${Te}.nestedHeaders.insertChildRow`,N0=`${Te}.nestedHeaders.detachFromParent`,D0=`${Te}.hideColumn`,k0=`${Te}.showColumn`,L0=`${Te}.hideRow`,$0=`${Te}.showRow`,Xn="Filters:",Lt=`${Xn}conditions`,Mp=`${Lt}.none`,F0=`${Lt}.isEmpty`,V0=`${Lt}.isNotEmpty`,W0=`${Lt}.isEqualTo`,B0=`${Lt}.isNotEqualTo`,j0=`${Lt}.beginsWith`,U0=`${Lt}.endsWith`,z0=`${Lt}.contains`,Y0=`${Lt}.doesNotContain`,d3=`${Lt}.byValue`,G0=`${Lt}.greaterThan`,q0=`${Lt}.greaterThanOrEqualTo`,K0=`${Lt}.lessThan`,X0=`${Lt}.lessThanOrEqualTo`,Z0=`${Lt}.isBetween`,Q0=`${Lt}.isNotBetween`,J0=`${Lt}.after`,eT=`${Lt}.before`,tT=`${Lt}.today`,nT=`${Lt}.tomorrow`,rT=`${Lt}.yesterday`,iT=`${Xn}labels.filterByCondition`,oT=`${Xn}labels.filterByValue`,sT=`${Xn}labels.conjunction`,Ip=`${Xn}labels.disjunction`,dm=`${Xn}values.blankCells`,aT=`${Xn}buttons.selectAll`,lT=`${Xn}buttons.clear`,uT=`${Xn}buttons.ok`,cT=`${Xn}buttons.cancel`,hT=`${Xn}buttons.placeholder.search`,dT=`${Xn}buttons.placeholder.value`,fT=`${Xn}buttons.placeholder.secondValue`,gT="CheckboxRenderer:",mT=`${gT}checked`,pT=`${gT}unchecked`,f3=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:mT,CHECKBOX_RENDERER_NAMESPACE:gT,CHECKBOX_UNCHECKED:pT,CONTEXTMENU_ITEMS_ADD_COMMENT:m0,CONTEXTMENU_ITEMS_ALIGNMENT:C0,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:_0,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:S0,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:R0,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:y0,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:T0,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:b0,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:E0,CONTEXTMENU_ITEMS_BORDERS:M0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:O0,CONTEXTMENU_ITEMS_BORDERS_LEFT:x0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:P0,CONTEXTMENU_ITEMS_BORDERS_TOP:I0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:o0,CONTEXTMENU_ITEMS_COPY:s0,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:u0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:l0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:a0,CONTEXTMENU_ITEMS_CUT:c0,CONTEXTMENU_ITEMS_EDIT_COMMENT:p0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:h0,CONTEXTMENU_ITEMS_HIDE_COLUMN:D0,CONTEXTMENU_ITEMS_HIDE_ROW:L0,CONTEXTMENU_ITEMS_INSERT_LEFT:JE,CONTEXTMENU_ITEMS_INSERT_RIGHT:e0,CONTEXTMENU_ITEMS_MERGE_CELLS:f0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:N0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:A0,CONTEXTMENU_ITEMS_NO_ITEMS:XE,CONTEXTMENU_ITEMS_READ_ONLY:hm,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:v0,CONTEXTMENU_ITEMS_REDO:i0,CONTEXTMENU_ITEMS_REMOVE_BORDERS:H0,CONTEXTMENU_ITEMS_REMOVE_COLUMN:n0,CONTEXTMENU_ITEMS_REMOVE_COMMENT:w0,CONTEXTMENU_ITEMS_REMOVE_ROW:t0,CONTEXTMENU_ITEMS_ROW_ABOVE:ZE,CONTEXTMENU_ITEMS_ROW_BELOW:QE,CONTEXTMENU_ITEMS_SHOW_COLUMN:k0,CONTEXTMENU_ITEMS_SHOW_ROW:$0,CONTEXTMENU_ITEMS_UNDO:r0,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:d0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:g0,CONTEXT_MENU_ITEMS_NAMESPACE:Ik,FILTERS_BUTTONS_CANCEL:cT,FILTERS_BUTTONS_CLEAR:lT,FILTERS_BUTTONS_OK:uT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:hT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:fT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:dT,FILTERS_BUTTONS_SELECT_ALL:aT,FILTERS_CONDITIONS_AFTER:J0,FILTERS_CONDITIONS_BEFORE:eT,FILTERS_CONDITIONS_BEGINS_WITH:j0,FILTERS_CONDITIONS_BETWEEN:Z0,FILTERS_CONDITIONS_BY_VALUE:d3,FILTERS_CONDITIONS_CONTAINS:z0,FILTERS_CONDITIONS_EMPTY:F0,FILTERS_CONDITIONS_ENDS_WITH:U0,FILTERS_CONDITIONS_EQUAL:W0,FILTERS_CONDITIONS_GREATER_THAN:G0,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:q0,FILTERS_CONDITIONS_LESS_THAN:K0,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:X0,FILTERS_CONDITIONS_NAMESPACE:Lt,FILTERS_CONDITIONS_NONE:Mp,FILTERS_CONDITIONS_NOT_BETWEEN:Q0,FILTERS_CONDITIONS_NOT_CONTAIN:Y0,FILTERS_CONDITIONS_NOT_EMPTY:V0,FILTERS_CONDITIONS_NOT_EQUAL:B0,FILTERS_CONDITIONS_TODAY:tT,FILTERS_CONDITIONS_TOMORROW:nT,FILTERS_CONDITIONS_YESTERDAY:rT,FILTERS_DIVS_FILTER_BY_CONDITION:iT,FILTERS_DIVS_FILTER_BY_VALUE:oT,FILTERS_LABELS_CONJUNCTION:sT,FILTERS_LABELS_DISJUNCTION:Ip,FILTERS_NAMESPACE:Xn,FILTERS_VALUES_BLANK_CELLS:dm},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Pk={languageCode:"en-US",[XE]:"No available options",[ZE]:"Insert row above",[QE]:"Insert row below",[JE]:"Insert column left",[e0]:"Insert column right",[t0]:["Remove row","Remove rows"],[n0]:["Remove column","Remove columns"],[r0]:"Undo",[i0]:"Redo",[hm]:"Read only",[o0]:"Clear column",[C0]:"Alignment",[y0]:"Left",[S0]:"Center",[b0]:"Right",[R0]:"Justify",[E0]:"Top",[T0]:"Middle",[_0]:"Bottom",[h0]:"Freeze column",[d0]:"Unfreeze column",[M0]:"Borders",[I0]:"Top",[P0]:"Right",[O0]:"Bottom",[x0]:"Left",[H0]:"Remove border(s)",[m0]:"Add comment",[p0]:"Edit comment",[w0]:"Delete comment",[v0]:"Read-only comment",[f0]:"Merge cells",[g0]:"Unmerge cells",[s0]:"Copy",[a0]:["Copy with header","Copy with headers"],[l0]:["Copy with group header","Copy with group headers"],[u0]:["Copy header only","Copy headers only"],[c0]:"Cut",[A0]:"Insert child row",[N0]:"Detach from parent",[D0]:["Hide column","Hide columns"],[k0]:["Show column","Show columns"],[L0]:["Hide row","Hide rows"],[$0]:["Show row","Show rows"],[Mp]:"None",[F0]:"Is empty",[V0]:"Is not empty",[W0]:"Is equal to",[B0]:"Is not equal to",[j0]:"Begins with",[U0]:"Ends with",[z0]:"Contains",[Y0]:"Does not contain",[G0]:"Greater than",[q0]:"Greater than or equal to",[K0]:"Less than",[X0]:"Less than or equal to",[Z0]:"Is between",[Q0]:"Is not between",[J0]:"After",[eT]:"Before",[tT]:"Today",[nT]:"Tomorrow",[rT]:"Yesterday",[dm]:"Blank cells",[iT]:"Filter by condition",[oT]:"Filter by value",[sT]:"And",[Ip]:"Or",[aT]:"Select all",[lT]:"Clear",[uT]:"OK",[cT]:"Cancel",[hT]:"Search",[dT]:"Value",[fT]:"Second value",[mT]:"Checked",[pT]:"Unchecked"},g3=f3,Ab=Pk.languageCode,{register:m3,getItem:Ok,hasItem:p3,getValues:w3}=oi("languagesDictionaries");xk(Pk);function xk(t,e){let n=t,r=e;return Pe(t)&&(r=t,n=r.languageCode),v3(n,r),m3(n,Ln(r)),Ln(r)}function v3(t,e){t!==Ab&&s3(e,Ok(Ab))}function Hk(t){return wT(t)?Ln(Ok(t)):null}function wT(t){return p3(t)}function C3(){return w3()}function Ak(t,e,n){const r=Hk(t);if(r===null)return null;const i=r[e];if(Rt(i))return null;const o=y3(i,n);return Array.isArray(o)?o[0]:o}function y3(t,e){let n=t;return _(h3(),r=>{n=r(t,e)}),n}function S3(t){let e=_k(t);return wT(e)||(e=Ab,Mk(t)),e}function b3(t,e,n){return(e=R3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R3(t){var e=E3(t,"string");return typeof e=="symbol"?e:e+""}function E3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class as extends ck{constructor(e,n){super(e,null),b3(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function dy(t){let{activeHeaderClassName:e,...n}=t;return new as({className:e,...n,selectionType:hk})}function T3(t){let{areaCornerVisible:e,...n}=t;return new as({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:AE})}function _3(t){let{...e}=t;return new as({className:"highlight",...e,selectionType:AE})}function M3(t){let{columnClassName:e,...n}=t;return new as({className:e,...n,selectionType:Uq})}function I3(t){let{cellCornerVisible:e,...n}=t;return new as({className:"current",headerAttributes:[nE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:cm})}function P3(t){let{border:e,visualCellRange:n,...r}=t;return new as({...e,...r,selectionType:zq},n)}function O3(t){let{...e}=t;return new as({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Bq})}function $x(t){let{headerClassName:e,...n}=t;return new as({className:e,...n,selectionType:HE})}function x3(t){let{rowClassName:e,...n}=t;return new as({className:e,...n,selectionType:jq})}function H3(t,e){A3(t,e),e.add(t)}function A3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tr(t,e,n){return(e=N3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N3(t){var e=D3(t,"string");return typeof e=="symbol"?e:e+""}function D3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Li=new WeakSet;class k3{constructor(e){H3(this,Li),tr(this,"options",void 0),tr(this,"layerLevel",0),tr(this,"focus",void 0),tr(this,"fill",void 0),tr(this,"layeredAreas",new Map),tr(this,"areas",new Map),tr(this,"rowHeaders",new Map),tr(this,"columnHeaders",new Map),tr(this,"activeRowHeaders",new Map),tr(this,"activeColumnHeaders",new Map),tr(this,"activeCornerHeaders",new Map),tr(this,"rowHighlights",new Map),tr(this,"columnHighlights",new Map),tr(this,"customSelections",[]),this.options=e,this.focus=I3(e),this.fill=O3(e)}isEnabledFor(e,n){let r=e;e===cm&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Mo(Li,this,Io).call(this,this.layeredAreas,T3)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Mo(Li,this,Io).call(this,this.areas,_3)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Mo(Li,this,Io).call(this,this.rowHeaders,$x)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Mo(Li,this,Io).call(this,this.columnHeaders,$x)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Mo(Li,this,Io).call(this,this.activeRowHeaders,dy)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Mo(Li,this,Io).call(this,this.activeColumnHeaders,dy)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Mo(Li,this,Io).call(this,this.activeCornerHeaders,dy)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Mo(Li,this,Io).call(this,this.rowHighlights,x3)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Mo(Li,this,Io).call(this,this.columnHighlights,M3)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(P3({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),_(this.areas.values(),e=>void e.clear()),_(this.layeredAreas.values(),e=>void e.clear()),_(this.rowHeaders.values(),e=>void e.clear()),_(this.columnHeaders.values(),e=>void e.clear()),_(this.activeRowHeaders.values(),e=>void e.clear()),_(this.activeColumnHeaders.values(),e=>void e.clear()),_(this.activeCornerHeaders.values(),e=>void e.clear()),_(this.rowHighlights.values(),e=>void e.clear()),_(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Io(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function Fx(t,e,n){return(e=L3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L3(t){var e=$3(t,"string");return typeof e=="symbol"?e:e+""}function $3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vT{constructor(e){Fx(this,"ranges",[]),Fx(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((r,i)=>r.includes(e)&&n(r,i))}findAll(e){const n=[];return this.ranges.forEach((r,i)=>{r.isEqual(e)&&n.push({range:r,layer:i})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(r=>r.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,r)=>!e.includes(r)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new vT(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,r)=>e(n,r)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function F3(t,e){Nk(t,e),e.add(t)}function fy(t,e,n){Nk(t,e),e.set(t,n)}function Nk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ye(t,e){return t.get(en(t,e))}function wf(t,e,n){return t.set(en(t,e),n),n}function en(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vf=new WeakMap,pt=new WeakMap,_i=new WeakMap,hn=new WeakSet;class Nb{constructor(e,n){F3(this,hn),fy(this,vf,void 0),fy(this,pt,void 0),fy(this,_i,{x:0,y:0}),wf(vf,this,e),wf(pt,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Ye(pt,this).createCellCoords(e,n);let o=Ye(vf,this).current().highlight;const s=Ye(pt,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=en(hn,this,Dk).call(this),{row:h,col:d}=en(hn,this,Wx).call(this,o),f=Ye(pt,this).fixedRowsBottom(),p=Ye(pt,this).minSpareRows(),v=Ye(pt,this).minSpareCols(),S=Ye(pt,this).autoWrapRow(),E=Ye(pt,this).autoWrapCol(),C=Ye(pt,this).createCellCoords(h+i.row,d+i.col);if(C.row>=c){const $=mr(r&&p>0&&f===0),P=C.col+1,x=Ye(pt,this).createCellCoords(C.row-c,P>=u?P-u:P);this.runLocalHooks("beforeColumnWrap",$,en(hn,this,$l).call(this,x),P>=u),$.value?this.runLocalHooks("insertRowRequire",Ye(pt,this).countRenderableRows()):E&&C.assign(x)}else if(C.row<0){const $=mr(E),P=C.col-1,x=Ye(pt,this).createCellCoords(c+C.row,P<0?u+P:P);this.runLocalHooks("beforeColumnWrap",$,en(hn,this,$l).call(this,x),P<0),E&&C.assign(x)}if(C.col>=u){const $=mr(r&&v>0),P=C.row+1,x=Ye(pt,this).createCellCoords(P>=c?P-c:P,C.col-u);this.runLocalHooks("beforeRowWrap",$,en(hn,this,$l).call(this,x),P>=c),$.value?this.runLocalHooks("insertColRequire",Ye(pt,this).countRenderableColumns()):S&&C.assign(x)}else if(C.col<0){const $=mr(S),P=C.row-1,x=Ye(pt,this).createCellCoords(P<0?c+P:P,u+C.col);this.runLocalHooks("beforeRowWrap",$,en(hn,this,$l).call(this,x),P<0),S&&C.assign(x)}const{rowDir:I,colDir:H}=en(hn,this,Vx).call(this,C);a=I,l=H,o=en(hn,this,$l).call(this,C)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Ye(pt,this).createCellCoords(e,n),i=Ye(vf,this).current(),o=Ye(pt,this).visualToRenderableCoords(i.highlight),s=en(hn,this,gy).call(this,i.to.row,i.from.row),a=en(hn,this,my).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=en(hn,this,Wx).call(this,i.highlight),f=Ye(pt,this).createCellCoords(s+r.row,a+r.col),p=i.getTopStartCorner(),v=i.getTopEndCorner(),S=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const H=f.col-d;f.col=en(hn,this,my).call(this,p.col,v.col)+H}else if(r.col>0&&a<=d&&f.col>d){const H=en(hn,this,my).call(this,v.col,p.col),$=Math.max(f.col-H,1);f.col=H+$}if(r.row<0&&s>=h&&f.row<h){const H=f.row-h;f.row=en(hn,this,gy).call(this,p.row,S.row)+H}else if(r.row>0&&s<=h&&f.row>h){const H=en(hn,this,gy).call(this,S.row,p.row),$=Math.max(f.row-H,1);f.row=H+$}const{rowDir:E,colDir:C}=en(hn,this,Vx).call(this,f);u=E,c=C;const I=en(hn,this,$l).call(this,f);r.row===0&&r.col!==0?l.col=I.col:r.row!==0&&r.col===0?l.row=I.row:(l.row=I.row,l.col=I.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;wf(_i,this,{x:n,y:r})}resetOffsetSize(){wf(_i,this,{x:0,y:0})}}function Vx(t){const{width:e,height:n}=en(hn,this,Dk).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function Dk(){return{width:Ye(_i,this).x+Ye(pt,this).countRenderableColumns(),height:Ye(_i,this).y+Ye(pt,this).countRenderableRows()}}function gy(t,e){const n=Ye(pt,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Ye(_i,this).y+n}function my(t,e){const n=Ye(pt,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Ye(_i,this).x+n}function Wx(t){const{row:e,col:n}=Ye(pt,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Ye(pt,this).createCellCoords(Ye(_i,this).y+e,Ye(_i,this).x+n)}function $l(t){const e=t.clone();return e.col=t.col-Ye(_i,this).x,e.row=t.row-Ye(_i,this).y,Ye(pt,this).renderableToVisualCoords(e)}st(Nb,Rn);const Pp=0,Op=1,kk=2,CT=3,V3=[CT,kk],W3=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],py=Symbol("root"),Bx=Symbol("child");function ju(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:py;if(e!==py&&e!==Bx)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===py;let i=Pp;if(n){const o=t[0];t.length===0?i=Op:r&&o instanceof Hd?i=CT:r&&Array.isArray(o)?i=ju(o,Bx):t.length>=2&&t.length<=4&&!t.some((a,l)=>!W3[l].includes(typeof a))&&(i=kk)}return i}function rd(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!V3.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===CT;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Rt(u)&&(u=a),Rt(c)&&(c=l),!r){const f=a,p=l,v=u,S=c;a=Math.min(f,v),l=Math.min(p,S),u=Math.max(f,v),c=Math.max(p,S)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function B3(t){const e=ju(t.getSelected());if(e===Pp||e===Op)return[];const n=rd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;_(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;_(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return an(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function j3(t){const e=ju(t.getSelected());if(e===Pp||e===Op)return[];const n=rd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;_(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;_(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return an(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Fl(t,e,n){U3(t,e),e.set(t,n)}function U3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ga(t,e,n){return(e=z3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z3(t){var e=Y3(t,"string");return typeof e=="symbol"?e:e+""}function Y3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function St(t,e){return t.get(Lk(t,e))}function $i(t,e,n){return t.set(Lk(t,e),n),n}function Lk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _n=new WeakMap,ma=new WeakMap,Cf=new WeakMap,Nc=new WeakMap,yf=new WeakMap,Dc=new WeakMap;class $k{constructor(e,n){var r=this;ga(this,"settings",void 0),ga(this,"tableProps",void 0),ga(this,"inProgress",!1),ga(this,"selectedRange",new vT((i,o,s)=>this.tableProps.createCellRange(i,o,s))),ga(this,"highlight",void 0),Fl(this,_n,void 0),Fl(this,ma,void 0),ga(this,"selectedByRowHeader",new Set),ga(this,"selectedByColumnHeader",new Set),Fl(this,Cf,!1),Fl(this,Nc,!1),Fl(this,yf,"unknown"),Fl(this,Dc,-1),this.settings=e,this.tableProps=n,this.highlight=new k3({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[nE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),$i(_n,this,new Nb(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),$i(ma,this,new Nb(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),St(_n,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),St(_n,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),St(_n,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),St(_n,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),St(_n,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),St(_n,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),St(_n,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),St(_n,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),St(ma,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),St(ma,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){$i(yf,this,e)}markEndSource(){$i(yf,this,"unknown")}getSelectionSource(){return St(yf,this)}setExpectedLayers(e){$i(Dc,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,$i(Dc,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Rt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();$i(Cf,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Rt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=St(Dc,this)===-1||this.selectedRange.size()===St(Dc,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(_(this.highlight.getAreas(),p=>void p.clear()),_(this.highlight.getLayeredAreas(),p=>void p.clear()),_(this.highlight.getRowHeaders(),p=>void p.clear()),_(this.highlight.getColumnHeaders(),p=>void p.clear()),_(this.highlight.getActiveRowHeaders(),p=>void p.clear()),_(this.highlight.getActiveColumnHeaders(),p=>void p.clear()),_(this.highlight.getActiveCornerHeaders(),p=>void p.clear()),_(this.highlight.getRowHighlights(),p=>void p.clear()),_(this.highlight.getColumnHighlights(),p=>void p.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(AE,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const p=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(p.from).commit().syncWith(p),this.highlight.createLayeredArea().add(p.from).commit().syncWith(p),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(HE,e.highlight)){if(!e.isSingleHeader()){const S=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),C=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),I=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(S).commit(),l.add(C).commit(),d.add(S).commit(),f.add(C).commit()):(a.add(S).add(E).commit(),l.add(C).add(I).commit(),d.add(S).add(E).commit(),f.add(C).add(I).commit())}const p=!St(Nc,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!St(Nc,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());p&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),p&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(cm,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||($i(Cf,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?St(_n,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):St(_n,this).resetOffsetSize(),this.setRangeStart(St(_n,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?St(_n,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):St(_n,this).resetOffsetSize(),this.setRangeEnd(St(_n,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?St(ma,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):St(ma,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=St(ma,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(We(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(We(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(We(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,We(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,We(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,We(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const n=mr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&St(Cf,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;$i(Nc,this,f),d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(We(d.row,u,o-1),We(d.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(p,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),$i(Nc,this,!1)}selectCells(e){var n=this;const r=ju(e);if(r===Op)return!1;if(r===Pp)throw new Error(nt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=rd(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),_(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,p=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(f=We(r.row,u,s-1),p=We(r.col,Math.min(i,o),Math.max(i,o))):(f=We(r,u,s-1),p=i);const v=this.tableProps.createCellCoords(f,p),S=l===0?0:We(v.row,u,-1),E=s-1,C=this.tableProps.createCellCoords(S,i),I=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",C,I,v),C.row=S,I.row=E,this.setRangeStartOnly(C,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(I),this.runLocalHooks("afterSelectColumns",C,I,v),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(h=We(r.row,Math.min(e,n),Math.max(e,n)),d=We(r.col,a,o-1)):(h=e,d=We(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),p=s===0?0:We(f.col,a,-1),v=o-1,S=this.tableProps.createCellCoords(e,p),E=this.tableProps.createCellCoords(n,v);this.runLocalHooks("beforeSelectRows",S,E,f),S.col=p,E.col=v,this.setRangeStartOnly(S,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",S,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(r.length),r.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=n-1;u.assign({row:We(u.row,this.settings.navigableHeaders?-1/0:0,c),col:We(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:We(a.row,-1/0,c),col:We(a.col,-1/0,h)}),l.assign({row:We(l.row,-1/0,c),col:We(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(cm,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}st($k,Rn);const jx=/^(\r\n|\n\r|\r|\n)/,G3=/^[^\t\r\n]+/,Ux=/^\t/;function q3(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(Ux))t=t.replace(Ux,""),n+=1,e[r][n]="";else if(t.match(jx))t=t.replace(jx,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(G3);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Oh(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function pa(t,e,n){return(e=K3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K3(t){var e=X3(t,"string");return typeof e=="symbol"?e:e+""}function X3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){pa(this,"hot",void 0),pa(this,"metaManager",void 0),pa(this,"tableMeta",void 0),pa(this,"dataSource",void 0),pa(this,"duckSchema",void 0),pa(this,"colToPropCache",void 0),pa(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=gp(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Pe(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return jE(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Oe(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ae(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ae(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Fu(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=Ln(this.getSchema()):(p=[],de(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},Md(p,this.getSchema())),d.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,n,r)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let f=0;for(let p=d;f<n&&l+f<s;p++){if(typeof c!="number"||c>=l+f)if(u>0)for(let v=0;v<u;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<u;v++)o[v].splice(p,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(c,f,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ae(this.tableMeta.columns)||ae(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];pb(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return tD(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];pb(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Gt(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=mr(a);this.hot.runHooks("modifyData",e,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=mr(o);this.hot.runHooks("modifyData",e,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Gt(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Eu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Eu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return Oh(this.getRange(e,n,Eu.DESTINATION_RENDERER))}getCopyableText(e,n){return Oh(this.getRange(e,n,Eu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:Z3,getItem:Q3,hasItem:Fk,getNames:J3,getValues:due}=oi("cellTypes");function yT(t){if(!Fk(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Q3(t)}function Fr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&lr(t,n),r&&Rr(t,r),i&&Xa(t,i),Z3(t,e)}function eX(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Gt(e,t)}function xp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?yT(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Oe(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Pe(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Oe(r,(o,s)=>{if(eX(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Kt(t,i)}function tX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}gD(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Lg(t){return Number.isInteger(t)&&t>=0}function $g(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Sf(t){return t==null}const Vk=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),kt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),kt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),fp(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function zx(t,e,n){return(e=nX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nX(t){var e=rX(t,"string");return typeof e=="symbol"?e:e+""}function rX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iX(){return class{}}class oX{constructor(e){zx(this,"metaCtor",iX()),zx(this,"meta",void 0),this.meta=this.metaCtor.prototype,Kt(this.meta,Vk()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Kt(this.meta,e),xp(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function sX(t,e,n){return(e=aX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aX(t){var e=lX(t,"string");return typeof e=="symbol"?e:e+""}function lX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uX{constructor(e){sX(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Kt(this.meta,e),xp(this.meta,e,e)}}function bf(t,e,n){return(e=cX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cX(t){var e=hX(t,"string");return typeof e=="symbol"?e:e+""}function hX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fm{constructor(e){bf(this,"valueFactory",void 0),bf(this,"data",[]),bf(this,"index",[]),bf(this,"holes",new Set),this.valueFactory=e}obtain(e){$g(()=>Lg(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;$g(()=>Lg(e)||Sf(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Sf(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;$g(()=>Lg(e)||Sf(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Sf(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function Yx(t,e,n){return(e=dX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dX(t){var e=fX(t,"string");return typeof e=="symbol"?e:e+""}function fX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gX=["data","width"];class mX{constructor(e){Yx(this,"globalMeta",void 0),Yx(this,"metas",new fm(()=>this._createMeta())),this.globalMeta=e,this.metas=new fm(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);Kt(r,n),xp(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return tX(this.globalMeta.getMetaConstructor(),gX).prototype}}function Gx(t,e,n){return(e=pX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pX(t){var e=wX(t,"string");return typeof e=="symbol"?e:e+""}function wX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vX{constructor(e){Gx(this,"columnMeta",void 0),Gx(this,"metas",new fm(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);Kt(i,r),xp(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)ae(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){$g(()=>Lg(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new fm(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class Wk{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new oX(e),this.tableMeta=new uX(this.globalMeta),this.columnMeta=new mX(this.globalMeta),this.cellMeta=new vX(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}st(Wk,Rn);function qx(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=kn(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":tt(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Eu(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=f.getSchema();t=[];let v,S=0,E=0;for(S=0,E=d.startRows;S<E;S++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=Ln(p),t.push(v);else if(i.dataType==="array")v=Ln(p[0]),t.push(v);else{v=[];for(let C=0,I=d.startCols;C<I;C++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&ve(i.rootElement,[hD(-1),dp(i.countCols()+(i.view?i.countRowHeaders():0))])}function Kx(t,e,n){return(e=CX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CX(t){var e=yX(t,"string");return typeof e=="symbol"?e:e+""}function yX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SX{constructor(e){var n=this;Kx(this,"metaManager",void 0),Kx(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),ne.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Gt(e,"type")?e.type:null;let c=tt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function bX(t,e,n){RX(t,e),e.set(t,n)}function RX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wy(t,e,n){return(e=EX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EX(t){var e=TX(t,"string");return typeof e=="symbol"?e:e+""}function TX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _X(t,e){return t.get(MX(t,e))}function MX(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xx=new WeakMap;class IX{constructor(e){wy(this,"metaManager",void 0),wy(this,"usageTracker",new Set),wy(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),bX(this,Xx,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,_X(Xx,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const Bk="gridDefault",aa="editorManager.handlingEditor",PX={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},OX="hooksRefRegisterer",jk={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){_(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Oe(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};wo(jk,"MIXIN_NAME",OX,{writable:!1,enumerable:!1});function hi(t,e,n){return(e=xX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xX(t){var e=HX(t,"string");return typeof e=="symbol"?e:e+""}function HX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const AX="base",Vt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class oc{static get EDITOR_TYPE(){return AX}constructor(e){hi(this,"hot",void 0),hi(this,"state",Vt.VIRGIN),hi(this,"_opened",!1),hi(this,"_fullEditMode",!1),hi(this,"_closeCallback",null),hi(this,"TD",null),hi(this,"row",null),hi(this,"col",null),hi(this,"prop",null),hi(this,"originalValue",null),hi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Vt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Vt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Vt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:wt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Vt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Vt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Vt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Vt.FINISHED,this.discardEditor(s)}):(this.state=Vt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Vt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Vt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Vt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Vt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Vt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=bn(n),a=Bt(n),l=bn(this.hot.rootElement),u=Bt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,S=v.name,E=["master","inline_start"].includes(S)?d:0,C=["master","top","bottom"].includes(S)?f:0,I=s.top===l.top?0:1;let H=s.top-l.top-I-E,$=0;this.hot.isRtl()?$=o.innerWidth-s.left-a-p-1+C:$=s.left-l.left-1-C,["top","top_inline_start_corner"].includes(S)&&(H+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(S)&&($+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const P=this.hot.hasColHeaders(),x=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),A=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(P&&x<=0||x===A)&&(H+=1),z<=0&&($+=1);const Q=i.rowsRenderCalculator.startPosition,X=i.columnsRenderCalculator.startPosition,se=Math.abs(r.inlineStartOverlay.getScrollPosition()),ee=r.topOverlay.getScrollPosition(),ue=gn(this.hot.rootDocument);let vt=n.offsetTop;if(["inline_start","master"].includes(S)&&(vt+=Q-ee),["bottom","bottom_inline_start_corner"].includes(S)){const{wtViewport:B,wtTable:G}=r.bottomOverlay.clone;vt+=B.getWorkspaceHeight()-G.getHeight()-ue}let Ne=n.offsetLeft;this.hot.isRtl()?(Ne>=0?Ne=v.getWidth()-n.offsetLeft:Ne=Math.abs(Ne),Ne+=X-se-a):["top","master","bottom"].includes(S)&&(Ne+=X-se);const $e=o.getComputedStyle(this.TD),Ct=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",rt=parseInt($e[Ct],10)>0?0:1,at=parseInt($e.borderTopWidth,10)>0?0:1,mn=Bt(n)+rt,g=qt(n)+at,m=fE(c)?ue:0,y=gE(h)?ue:0,N=this.hot.view.maximumVisibleElementWidth(Ne)-m+rt,F=Math.max(this.hot.view.maximumVisibleElementHeight(vt)-y+at,this.hot.stylesHandler.getDefaultRowHeight());return{top:H,start:$,height:g,maxHeight:F,width:mn,maxWidth:N}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}st(oc,jk);const NX={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Vt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},DX={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},kX={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},LX={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},$X={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),ii(e))}};function FX(){return[PX,NX,DX,kX,LX,$X]}const VX={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},WX={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},BX={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},jX={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},UX={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},zX={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},YX={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},GX={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},qX={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},KX={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},XX={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},ZX={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},QX={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},JX={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function e4(){return[VX,WX,BX,jX,UX,zX,YX,GX,qX,KX,XX,ZX,QX,JX]}const t4={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},n4={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},r4={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},i4={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},o4={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},s4={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},a4={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},l4={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},u4={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},c4={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},h4={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},d4={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},f4={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},g4={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},m4={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},p4={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function w4(){return[t4,n4,r4,i4,o4,s4,a4,l4,u4,c4,h4,d4,f4,g4,m4,p4]}const v4={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},C4={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},y4={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},S4={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},b4={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},R4=[...FX(),...e4(),...w4(),v4,C4,y4,S4,b4];function Uk(t){const e={};return R4.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function E4(t){const e=t.getShortcutManager().addContext("editor"),n=Uk(t),r={group:aa};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function T4(t){const e=t.getShortcutManager().addContext("grid"),n=Uk(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ae(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Bk};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:aa,runOnlyIf:()=>ae(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function _4(t){[T4,E4].forEach(e=>e(t))}function M4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=Zx(t),i=Zx(t);return r.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),n.before(r),n.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function Zx(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&ve(n,[$u("Focus catcher")]),n}function I4(t){const e=P4(t);let n;const{activate:r,deactivate:i}=M4(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:Db(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:kb(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,p,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var S;n=(S=t.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Bk,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?Db(t):kb(t)),u(),!1;h.preventDefault()},position:"after"}])}function Db(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function kb(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function P4(t){return e=>{if(!e)return null;const n=Db(t),r=kb(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function sc(t){lo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Hp(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,p=r.getBottomEndCorner().row,v=f<=h,S=p>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:v&&S?r.highlight.row:v?f:S?p:E.row}}}function O4(t){return e=>{const n=Hp(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;sc(t.getCell(r?-1:0,n,!0))})}}function x4(){return()=>{}}function H4(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;sc(t.getCell(n,r,!0))})}}function A4(t){return e=>{const n=Hp(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;sc(t.getCell(i,o,!0))})}}function N4(t){return e=>{const n=Hp(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;sc(t.getCell(i,o,!0))})}}function D4(t){return e=>{const n=Hp(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;sc(t.getCell(n,r?-1:0,!0))})}}function k4(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{sc(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function L4(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=H4(t):e.isSelectedByCorner()?s=x4():e.isSelectedByRowHeader()?s=D4(t):e.isSelectedByColumnHeader()?s=O4(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=A4(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=k4(t):e.getSelectedRange().size()>1&&(s=N4(t)),(o=s)===null||o===void 0||o(i)}}}const Qx=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Rf=t=>t.map(e=>{const n=e.toLowerCase();return Qx.has(n)?Qx.get(n):n}).sort().join("+"),$4=t=>t.split("+"),Jx=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),vy=t=>{let{which:e,key:n}=t;if(Jx.has(e))return Jx.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},zk=Symbol("shortcut-context");function Yk(t){return Pe(t)&&t.__kindOf===zk}const F4=t=>{const e=Sp({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:p=!1,relativeToGroup:v,position:S,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Rt(c))throw new Error("You need to define the shortcut's group.");if(tt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(nt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:p};ae(v)&&(C.relativeToGroup=v,C.position=S),Yk(E)&&(C.forwardToContext=E),l.forEach(I=>{const H=Rf(I);if(e.hasItem(H)){const P=e.getItem(H);let x=P.findIndex(z=>z.group===v);x!==-1?S==="before"?x-=1:x+=1:x=P.length,P.splice(x,0,C)}else e.addItem(H,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Oe(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=Rf(l);e.removeItem(u)};return{__kindOf:zk,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Rf(l),c=e.getItem(u);return ae(c)?c.slice():[]},hasShortcut:l=>{const u=Rf(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(p=>p.group!==l);f.length===0?i($4(h)):(d.length=0,d.push(...f))})}}};function V4(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const W4=["meta","alt","shift","control"],kc=V4(),Lc=[];let Ef=0;function B4(t,e,n,r,i){const o=f=>W4.includes(f),s=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return f.altKey&&v.push("alt"),p&&(f.ctrlKey||f.metaKey)?v.push("control/meta"):(f.ctrlKey&&v.push("control"),f.metaKey&&v.push("meta")),f.shiftKey&&v.push("shift"),v},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Ns(f))return;const v=vy(f);let S=[];o(v)||(S=s(f));const E=[v].concat(S);!i(f,E)&&(om()&&S.includes("meta")||!om()&&S.includes("control"))&&i(f,[v].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const p=vy(f);o(p)&&kc.press(p)}},u=f=>{if(typeof f.key=="string"){const p=vy(f);o(p)&&kc.release(p)}},c=()=>{kc.releaseAll()};return{mount:()=>{let f=t;for(Ef+=1;f;)Ef===1&&(f.document.documentElement.addEventListener("keydown",l),Lc.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Lc.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=al(f)},unmount:()=>{let f=t;for(Ef-=1;f;){if(Ef===0){for(let p=0;p<Lc.length;p++){const{event:v,listener:S}=Lc[p];f.document.documentElement.removeEventListener(v,S)}Lc.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=al(f)}},isPressed:f=>kc.isPressed(f),releasePressedKeys:()=>kc.releaseAll()}}const j4=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Sp({errorIdExists:p=>`The "${p}" context name is already registered.`});let s="grid";const a=p=>{const v=F4(p);return o.addItem(p,v),v},l=()=>s,u=p=>o.getItem(p),c=p=>{if(!o.hasItem(p))throw new Error(nt`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p};let h=!1;const d=function(p,v){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=Yk(S)?S:u(S);let C=!1;if(!E.hasShortcut(v))return C;const I=E.getShortcuts(v);for(let H=0;H<I.length;H++){const{callback:$,runOnlyIf:P,preventDefault:x,stopPropagation:z,captureCtrl:K,forwardToContext:A}=I[H];if(P(p)===!0){if(h=K,C=$(p,v)===!1,h=!1,x&&p.preventDefault(),z&&(ii(p),p.stopPropagation()),C)break;A&&d(p,v,A)}}return C},f=B4(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function eH(t){const{classNames:e}=TD(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function U4(t,e){Gk(t,e),e.add(t)}function wa(t,e,n){Gk(t,e),e.set(t,n)}function Gk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hn(t,e){return t.get(bi(t,e))}function Br(t,e,n){return t.set(bi(t,e),n),n}function bi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tH=23;var va=new WeakMap,gm=new WeakMap,ST=new WeakMap,Lb=new WeakMap,Ms=new WeakMap,Ch=new WeakMap,id=new WeakMap,Qi=new WeakSet;class z4{constructor(e,n){U4(this,Qi),wa(this,va,void 0),wa(this,gm,void 0),wa(this,ST,void 0),wa(this,Lb,void 0),wa(this,Ms,!0),wa(this,Ch,{}),wa(this,id,{}),Br(gm,this,e),Br(Lb,this,n)}isClassicTheme(){return Hn(Ms,this)}getCSSVariableValue(e){var n;if(Hn(Ms,this))return null;if(Hn(Ch,this)[`--ht-${e}`])return Hn(Ch,this)[`--ht-${e}`];const r=(n=bi(Qi,this,q4).call(this,`--ht-${e}`))!==null&&n!==void 0?n:bi(Qi,this,qk).call(this,`--ht-${e}`);if(r!==null)return Hn(Ch,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=Hn(id,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Hn(Ms,this))return tH;const e=bi(Qi,this,Y4).call(this);return e||tH}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Br(va,this,void 0),Br(Ms,this,!0),bi(Qi,this,Cy).call(this);return}if(e&&e!==Hn(va,this)){if(!/ht-theme-.*/.test(e)){Ke(`Invalid theme name: ${e}. Please provide a valid theme name.`),Br(va,this,void 0),Br(Ms,this,!1),bi(Qi,this,Cy).call(this);return}Hn(va,this)&&bi(Qi,this,K4).call(this),Br(va,this,e),Br(Ms,this,!1),bi(Qi,this,Cy).call(this)}}getThemeName(){return Hn(va,this)}}function Y4(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Cy(){this.isClassicTheme()||Br(ST,this,getComputedStyle(Hn(gm,this)));const t=bi(Qi,this,G4).call(this,["box-sizing","border-bottom-width"]);Hn(id,this).td={...Hn(id,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function G4(t){const e=Hn(Lb,this),n=Hn(gm,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function q4(t){const e=Math.ceil(parseFloat(bi(Qi,this,qk).call(this,t)));return Number.isNaN(e)?null:e}function qk(t){const e=Hn(ST,this).getPropertyValue(t);return e===""?null:e}function K4(){Br(id,this,{}),Br(Ch,this,{}),Br(Ms,this,!0)}function X4(t,e){Kk(t,e),e.add(t)}function nH(t,e,n){Kk(t,e),e.set(t,n)}function Kk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rH(t,e){return t.get(Uu(t,e))}function iH(t,e,n){return t.set(Uu(t,e),n),n}function Uu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $b=new WeakMap,Fb=new WeakMap,xh=new WeakSet;class Z4{constructor(e){let{rowIndexMapper:n,columnIndexMapper:r}=e;X4(this,xh),nH(this,$b,void 0),nH(this,Fb,void 0),iH($b,this,n),iH(Fb,this,r)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,i=Uu(xh,this,oH).call(this,e.from,n,r);if(i===null)return null;const o=Uu(xh,this,oH).call(this,e.to,-n,-r);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function oH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const r=Uu(xh,this,sH).call(this,rH($b,this),t.row,e);if(r===null)return null;const i=Uu(xh,this,sH).call(this,rH(Fb,this),t.col,n);return i===null?null:t.clone().assign({row:r,col:i})}function sH(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}let yy=null;const Sy=new Map;function Xk(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Qr(o);let a,l,u,c,h,d,f=!0;SK(i)&&yK(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=pu(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,pu(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),Y(this.rootElement,"ht-wrapper"),Y(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),Y(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(n=e?.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new z4(o.rootElement,o.rootDocument),e.language=S3(e.language);const S=Object.fromEntries(Object.entries(e).filter(g=>{let[m]=g;return!(ne.getSingleton().isRegistered(m)||ne.getSingleton().isDeprecated(m))})),E=new Wk(o,S,[SX,IX]),C=E.getTableMeta(),I=E.getGlobalMeta(),H=Sp();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),pu(this)&&sD(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${QR()}`,Sy.set(this.guid,this),this.columnIndexMapper=new Hb,this.rowIndexMapper=new Hb,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{o.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{o.runHooks("afterRowSequenceChange",g)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",g=>{o.runHooks("beforeCompositionStart",g)}),l=new LK(o);const $=oi(this.guid);$.register("cellRangeMapper",new Z4({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const P=g=>{const{row:m,col:y}=g;return o._createCellCoords(m>=0?o.rowIndexMapper.getRenderableFromVisualIndex(m):m,y>=0?o.columnIndexMapper.getRenderableFromVisualIndex(y):y)},x=g=>{const{row:m,col:y}=g;return o._createCellCoords(m>=0?o.rowIndexMapper.getVisualFromRenderableIndex(m):m,y>=0?o.columnIndexMapper.getVisualFromRenderableIndex(y):y)},z=(g,m)=>{const y=m>g?1:-1,N=Math.min(g,m),F=Math.max(g,m),B=o.rowIndexMapper.getNearestNotHiddenIndex(g,y);return B===null||y===1&&B>F||y===-1&&B<N?null:B>=0?o.rowIndexMapper.getRenderableFromVisualIndex(B):B},K=(g,m)=>{const y=m>g?1:-1,N=Math.min(g,m),F=Math.max(g,m),B=o.columnIndexMapper.getNearestNotHiddenIndex(g,y);return B===null||y===1&&B>F||y===-1&&B<N?null:B>=0?o.columnIndexMapper.getRenderableFromVisualIndex(B):B};let A=new $k(C,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:g=>a.propToCol(g),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(g,m)=>o._createCellCoords(g,m),createCellRange:(g,m,y)=>o._createCellRange(g,m,y),visualToRenderableCoords:P,renderableToVisualCoords:x,findFirstNonHiddenRenderableRow:z,findFirstNonHiddenRenderableColumn:K,isDisabledCellSelection:(g,m)=>g<0||m<0?o.getSettings().disableVisualSelection:o.getCellMeta(g,m).disableVisualSelection});this.selection=A;const Q=g=>{let{hiddenIndexesChanged:m}=g;this.forceFullRender=!0,m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Q),this.rowIndexMapper.addLocalHook("cacheUpdated",Q),this.selection.addLocalHook("afterSetRangeEnd",(g,m)=>{const y=mr(!1),N=this.selection.getSelectedRange(),{from:F,to:B}=N.current(),G=N.size()-1;this.runHooks("afterSelection",F.row,F.col,B.row,B.col,y,G),this.runHooks("afterSelectionByProp",F.row,o.colToProp(F.col),B.row,o.colToProp(B.col),y,G),m&&(!y.isTouched()||y.isTouched()&&!y.value)&&d.scrollTo(g);const w=A.isSelectedByRowHeader(),b=A.isSelectedByColumnHeader();w&&b?Y(this.rootElement,["ht__selection--rows","ht__selection--columns"]):w?(me(this.rootElement,"ht__selection--columns"),Y(this.rootElement,"ht__selection--rows")):b?(me(this.rootElement,"ht__selection--rows"),Y(this.rootElement,"ht__selection--columns")):me(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(A.getSelectionSource())||c.closeEditor(null),A.getSelectionSource()!=="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const m=mr(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&d.scrollTo(g),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const m=g.length-1,{from:y,to:N}=g[m];this.runHooks("afterSelectionEnd",y.row,y.col,N.row,N.col,m),this.runHooks("afterSelectionEndByProp",y.row,o.colToProp(y.col),N.row,o.colToProp(N.col),m),A.getSelectionSource()==="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const m=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),me(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,m=new Array(g),y=0;y<g;y++)m[y]=arguments[y];return r.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),u={alter(g,m){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,N=arguments.length>3?arguments[3]:void 0,F=arguments.length>4?arguments[4]:void 0;const B=G=>{if(G.length===0)return[];const w=[...G];return w.sort((R,T)=>{let[M]=R,[k]=T;return M===k?0:M>k?1:-1}),an(w,(R,T)=>{let[M,k]=T;const W=R[R.length-1],[O,L]=W,V=O+L;if(M<=V){const j=Math.max(k-(V-M),0);W[1]+=j}else R.push([M,k]);return R},[w[0]])};switch(g){case"insert_row_below":case"insert_row_above":const G=o.countSourceRows();if(C.maxRows===G)return;const w=g==="insert_row_below"?"below":"above";m=m??(w==="below"?G:0);const{delta:b,startPhysicalIndex:R}=a.createRow(m,y,{source:N,mode:w});A.shiftRows(o.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const T=g==="insert_col_end"?"end":"start";m=m??(T==="end"?o.countSourceCols():0);const{delta:M,startPhysicalIndex:k}=a.createCol(m,y,{source:N,mode:T});if(M){if(Array.isArray(C.colHeaders)){const L=[o.toVisualColumn(k),0];L.length+=M,Array.prototype.splice.apply(C.colHeaders,L)}A.shiftColumns(o.toVisualColumn(k),M)}break;case"remove_row":const W=L=>{let V=0;_(L,j=>{let[U,ie]=j;const oe=kt(U)?o.countRows()-1:Math.max(U-V,0);if(Number.isInteger(U)&&(U=Math.max(U-V,0)),!a.removeRow(U,ie,N))return;if(A.isSelected()){const{row:ye}=o.getSelectedRangeLast().highlight;ye>=U&&ye<=U+ie-1&&c.closeEditor(!0)}const Fe=o.countRows(),Ve=C.fixedRowsTop;Ve>=oe+1&&(C.fixedRowsTop-=Math.min(ie,Ve-oe));const Re=C.fixedRowsBottom;if(Re&&oe>=Fe-Re&&(C.fixedRowsBottom-=Math.min(ie,Re)),Fe===0)A.deselect();else if(N==="ContextMenu.removeRow"){const ye=A.getSelectedRange(),Je=ye.pop();ye.clear().set(Je.from).current().setTo(Je.to),A.refresh()}else A.shiftRows(U,-ie);V+=ie})};Array.isArray(m)?W(B(m)):W([[m,y]]);break;case"remove_col":const O=L=>{let V=0;_(L,j=>{let[U,ie]=j;const oe=kt(U)?o.countCols()-1:Math.max(U-V,0);let be=o.toPhysicalColumn(oe);if(Number.isInteger(U)&&(U=Math.max(U-V,0)),!a.removeCol(U,ie,N))return;if(A.isSelected()){const{col:ye}=o.getSelectedRangeLast().highlight;ye>=U&&ye<=U+ie-1&&c.closeEditor(!0)}if(o.countCols()===0)A.deselect();else if(N==="ContextMenu.removeColumn"){const ye=A.getSelectedRange(),Je=ye.pop();ye.clear().set(Je.from).current().setTo(Je.to),A.refresh()}else A.shiftColumns(U,-ie);const Re=C.fixedColumnsStart;Re>=oe+1&&(C.fixedColumnsStart-=Math.min(ie,Re-oe)),Array.isArray(C.colHeaders)&&(typeof be>"u"&&(be=-1),C.colHeaders.splice(be,ie)),V+=ie})};Array.isArray(m)?O(B(m)):O([[m,y]]);break;default:throw new Error(`There is no such action "${g}"`)}F||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const g=C.minRows,m=C.minSpareRows,y=C.minCols,N=C.minSpareCols;if(g){const F=o.countRows();F<g&&a.createRow(F,g-F,{source:"auto"})}if(m){const F=o.countEmptyRows(!0);if(F<m){const B=m-F,G=Math.min(B,C.maxRows-o.countSourceRows());a.createRow(o.countRows(),G,{source:"auto"})}}{let F;(y||N)&&(F=o.countEmptyCols(!0));let B=o.countCols();if(y&&!C.columns&&B<y){const G=y-B;F+=G,a.createCol(B,G,{source:"auto"})}if(N&&!C.columns&&o.dataType==="array"&&F<N){B=o.countCols();const G=N-F,w=Math.min(G,C.maxCols-B);a.createCol(B,w,{source:"auto"})}}},populateFromArray(g,m,y,N,F){let B,G,w,b;const R=[],T={},M=[],k=g.row,W=g.col;if(G=m.length,G===0)return!1;let O=0,L=0;switch(Pe(y)&&(O=y.col-W+1,L=y.row-k+1),F){case"shift_down":const V=Eh(m),j=V.length,U=Math.max(j,O),ie=o.getData().slice(k),oe=Eh(ie).slice(W,W+U);for(w=0;w<U;w+=1)if(w<j){for(B=0,G=V[w].length;B<L-G;B+=1)V[w].push(V[w][B%G]);w<oe.length?M.push(V[w].concat(oe[w])):M.push(V[w].concat(new Array(ie.length).fill(null)))}else M.push(V[w%j].concat(oe[w]));o.populateFromArray(k,W,Eh(M));break;case"shift_right":const be=m.length,Fe=Math.max(be,L),Ve=o.getData().slice(k).map(yt=>yt.slice(W));for(B=0;B<Fe;B+=1)if(B<be){for(w=0,b=m[B].length;w<O-b;w+=1)m[B].push(m[B][w%b]);if(B<Ve.length)for(let yt=0;yt<Ve[B].length;yt+=1)m[B].push(Ve[B][yt]);else m[B].push(...new Array(Ve[0].length).fill(null))}else m.push(m[B%G].slice(0,Fe).concat(Ve[B]));o.populateFromArray(k,W,m);break;case"overwrite":default:T.row=g.row,T.col=g.col;let Re=0,ye=0,Je=!0,Zn;const Co=function(_t){let gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Xe=m[_t%m.length];return gt!==null?Xe[gt%Xe.length]:Xe},ai=m.length,ln=y?y.row-g.row+1:0;for(y?G=ln:G=Math.max(ai,ln),B=0;B<G&&!(y&&T.row>y.row&&ln>ai||!C.allowInsertRow&&T.row>o.countRows()-1||T.row>=C.maxRows);B++){const yt=B-Re,_t=Co(yt).length,gt=y?y.col-g.col+1:0;if(y?b=gt:b=Math.max(_t,gt),T.col=g.col,Zn=o.getCellMeta(T.row,T.col),(N==="CopyPaste.paste"||N==="Autofill.fill")&&Zn.skipRowOnPaste){Re+=1,T.row+=1,G+=1;continue}for(ye=0,w=0;w<b&&!(y&&T.col>y.col&&gt>_t||!C.allowInsertColumn&&T.col>o.countCols()-1||T.col>=C.maxCols);w++){if(Zn=o.getCellMeta(T.row,T.col),(N==="CopyPaste.paste"||N==="Autofill.fill")&&Zn.skipColumnOnPaste){ye+=1,T.col+=1,b+=1;continue}if(Zn.readOnly&&N!=="UndoRedo.undo"){T.col+=1;continue}const Xe=w-ye;let Hr=Co(yt,Xe),$n=o.getDataAtCell(T.row,T.col);if(Hr!==null&&typeof Hr=="object")if(Array.isArray(Hr)&&$n===null&&($n=[]),$n===null||typeof $n!="object")Je=!1;else{const la=Fu(Array.isArray($n)?$n:$n[0]||$n),Yd=Fu(Array.isArray(Hr)?Hr:Hr[0]||Hr);fp(la,Yd)||Array.isArray(la)&&Array.isArray(Yd)?Hr=Ln(Hr):Je=!1}else $n!==null&&typeof $n=="object"&&(Je=!1);Je&&R.push([T.row,T.col,Hr]),Je=!0,T.col+=1}T.row+=1}o.setDataAtCell(R,null,null,N||"populateFromArray");break}}};function X(g){const m=_k(g);wT(m)?(o.runHooks("beforeLanguageChange",m),I.language=m,o.runHooks("afterLanguageChange",m)):Mk(g)}function se(g,m){const y=g==="className"?o.rootElement:o.table;if(f)Y(y,m);else{let N=[],F=[];I[g]&&(N=Array.isArray(I[g])?I[g]:vb(I[g])),m&&(F=Array.isArray(m)?m:vb(m));const B=wb(N,F),G=wb(F,N);B.length&&me(y,B),G.length&&Y(y,G)}I[g]=m}this.init=function(){l.setData(C.data),o.runHooks("beforeInit"),(Ti()||sE())&&Y(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new TK(this);const g=C.themeName||eH(o.rootContainer);o.useTheme(g),c=Rb.getInstance(o,C,A),d=L4(o),h=new ZY(o),pu(this)&&I4(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&ND(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function ee(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function ue(g){const m=g.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):g}function vt(g,m,y){if(!g.length){y();return}const N=o.getActiveEditor(),F=new ee;let B=!0;F.onQueueEmpty=()=>{N&&B&&N.cancelChanges(),y()};for(let G=g.length-1;G>=0;G--){const[w,b]=g[G],R=a.propToCol(b);let T;Number.isInteger(R)?T=o.getCellMeta(w,R):T={...Object.getPrototypeOf(C),...C},o.getCellValidator(T)&&(F.addValidatorToQueue(),o.validateCell(g[G][3],T,function(M,k){return function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&k.allowInvalid===!1&&(B=!1,g.splice(M,1),k.valid=!0),F.removeValidatorFormQueue()}}(G,T),m))}F.checkIfQueueIsEmpty()}function Ne(g,m){for(let N=g.length-1;N>=0;N--){let F=!1;if(g[N]===null){g.splice(N,1);continue}if(!((g[N][2]===null||g[N][2]===void 0)&&(g[N][3]===null||g[N][3]===void 0))){if(C.allowInsertRow)for(;g[N][0]>o.countRows()-1;){const{delta:B}=a.createRow(void 0,void 0,{source:"auto"});if(B===0){F=!0;break}}if(o.dataType==="array"&&(!C.columns||C.columns.length===0)&&C.allowInsertColumn)for(;a.propToCol(g[N][1])>o.countCols()-1;){const{delta:B}=a.createCol(void 0,void 0,{source:"auto"});if(B===0){F=!0;break}}F||a.set(g[N][0],g[N][1],g[N][3])}}if(g.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",g,m),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",g,m||"edit");const N=o.getActiveEditor();N&&ae(N.refreshValue)&&N.refreshValue()}else o.render()}this._createCellCoords=function(g,m){return o.view._wt.createCellCoords(g,m)},this._createCellRange=function(g,m,y){return o.view._wt.createCellRange(g,m,y)},this.validateCell=function(g,m,y,N){let F=o.getCellValidator(m);function B(G){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){y(G);return}const b=m.visualCol,R=m.visualRow,T=o.getCell(R,b,!0);if(T&&T.nodeName!=="TH"){const M=o.rowIndexMapper.getRenderableFromVisualIndex(R),k=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",M,k,T)}y(G)}oD(F)&&(F=function(G){return function(w,b){b(G.test(w))}}(F)),tt(F)?(g=o.runHooks("beforeValidate",g,m.visualRow,m.prop,N),o._registerImmediate(()=>{F.call(m,g,G=>{o&&(G=o.runHooks("afterValidate",G,g,m.visualRow,m.prop,N),m.valid=G,B(G),o.runHooks("postAfterValidate",G,g,m.visualRow,m.prop,N))})})):o._registerImmediate(()=>{m.valid=!0,B(m.valid,!1)})};function $e(g,m,y){return Array.isArray(g)?g:[[g,m,y]]}function Ct(g,m){const y=o.runHooks("beforeChange",g,m||"edit"),N=g.filter(B=>B!==null);if(y===!1||N.length===0){var F;return(F=o.getActiveEditor())===null||F===void 0||F.cancelChanges(),[]}for(let B=N.length-1;B>=0;B--){const[G,w,,b]=N[B],R=a.propToCol(w);let T;Number.isInteger(R)?T=o.getCellMeta(G,R):T={...Object.getPrototypeOf(C),...C};const{type:M,checkedTemplate:k,uncheckedTemplate:W}=T;if(M==="numeric"&&typeof b=="string"&&KD(b)&&(N[B][3]=ue(b)),M==="checkbox"){const O=wt(b),L=O===wt(k),V=O===wt(W);(L||V)&&(N[B][3]=L?k:W)}}return N}this.setDataAtCell=function(g,m,y,N){const F=$e(g,m,y),B=[];let G=N,w,b,R;for(w=0,b=F.length;w<b;w++){if(typeof F[w]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof F[w][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");F[w][1]>=this.countCols()?R=F[w][1]:R=a.colToProp(F[w][1]),B.push([F[w][0],R,l.getAtCell(this.toPhysicalRow(F[w][0]),F[w][1]),F[w][2]])}!G&&typeof g=="object"&&(G=m);const T=Ct(B,G);o.runHooks("afterSetDataAtCell",T,G),vt(T,G,()=>{Ne(T,G)})},this.setDataAtRowProp=function(g,m,y,N){const F=$e(g,m,y),B=[];let G=N,w,b;for(w=0,b=F.length;w<b;w++)B.push([F[w][0],F[w][1],l.getAtCell(this.toPhysicalRow(F[w][0]),F[w][1]),F[w][2]]);!G&&typeof g=="object"&&(G=m);const R=Ct(B,N);o.runHooks("afterSetDataAtRowProp",R,G),vt(R,G,()=>{Ne(R,G)})},this.listen=function(){o&&!o.isListening()&&(Sy.forEach(g=>{o!==g&&g.unlisten()}),yy=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(yy=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return yy===o.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(g),o.view.render(),m&&A.isSelected()&&c.prepareEditor()},this.populateFromArray=function(g,m,y,N,F,B,G){if(!(typeof y=="object"&&typeof y[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const w=typeof N=="number"?o._createCellCoords(N,F):null;return u.populateFromArray(o._createCellCoords(g,m),y,w,B,G)},this.spliceCol=function(g,m,y){for(var N=arguments.length,F=new Array(N>3?N-3:0),B=3;B<N;B++)F[B-3]=arguments[B];return a.spliceCol(g,m,y,...F)},this.spliceRow=function(g,m,y){for(var N=arguments.length,F=new Array(N>3?N-3:0),B=3;B<N;B++)F[B-3]=arguments[B];return a.spliceRow(g,m,y,...F)},this.getSelected=function(){if(A.isSelected())return Le(A.getSelectedRange(),g=>{let{from:m,to:y}=g;return[m.row,m.col,y.row,y.col]})},this.getSelectedLast=function(){const g=this.getSelected();let m;return g&&g.length>0&&(m=g[g.length-1]),m},this.getSelectedRange=function(){if(A.isSelected())return Array.from(A.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let m;return g&&g.length>0&&(m=g[g.length-1]),m},this.emptySelectedCells=function(g){if(!A.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];_(A.getSelectedRange(),y=>{if(y.isSingleHeader())return;const N=y.getTopStartCorner(),F=y.getBottomEndCorner();de(N.row,F.row,B=>{de(N.col,F.col,G=>{this.getCellMeta(B,G).readOnly||m.push([B,G,null])})})}),m.length>0&&this.setDataAtCell(m,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(g){this.suspendRender();const m=g();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const y=g();return this.resumeExecution(m),y},this.batch=function(g){this.suspendRender(),this.suspendExecution();const m=g();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!o.view)return;const g=o.view,{width:m,height:y}=g.getLastSize(),{width:N,height:F}=o.rootElement.getBoundingClientRect(),B=N!==m||F!==y;o.runHooks("beforeRefreshDimensions",{width:m,height:y},{width:N,height:F},B)!==!1&&((B||g._wt.wtOverlays.scrollableElement===o.rootWindow)&&(g.setLastSize(N,F),o.render(),g.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:m,height:y},{width:N,height:F},B))},this.updateData=function(g,m){qx(g,y=>{a=y},y=>{a=y,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),A.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:m,metaManager:E,firstRun:f})},this.loadData=function(g,m){qx(g,y=>{a=y},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),A.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:m,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const g=C.columns;let m=0;if(Array.isArray(g))m=g.length;else if(tt(g))if(o.dataType==="array"){const y=this.countSourceCols();for(let N=0;N<y;N+=1)g(N)&&(m+=1)}else(o.dataType==="object"||o.dataType==="function")&&(m=a.colToPropCache.length);else if(ae(C.dataSchema)){const y=a.getSchema();m=Array.isArray(y)?y.length:gp(y)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,m,y,N){return Rt(g)?a.getAll():a.getRange(o._createCellCoords(g,m),o._createCellCoords(y,N),a.DESTINATION_RENDERER)},this.getCopyableText=function(g,m,y,N){return a.getCopyableText(o._createCellCoords(g,m),o._createCellCoords(y,N))},this.getCopyableData=function(g,m){return a.getCopyable(g,a.colToProp(m))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=(f?o.loadData:o.updateData).bind(this);let N=!1,F,B;if(ae(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ae(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ae(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');g.language&&X(g.language);for(F in g)if(!(F==="data"||F==="language"))if(F==="className")se("className",g.className);else if(F==="tableClassName"&&o.table)se("tableClassName",g.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ne.getSingleton().isRegistered(F)||ne.getSingleton().isDeprecated(F)){const T=g[F];tt(T)?(ne.getSingleton().addAsFixed(F,T,o),C[F]=T):Array.isArray(T)&&(ne.getSingleton().add(F,T,o),C[F]=T)}else!m&&Gt(g,F)&&(I[F]=g[F]);g.data===void 0&&C.data===void 0?y(null,"updateSettings"):g.data!==void 0?y(g.data,"updateSettings"):g.columns!==void 0&&(a.createMap(),o.initIndexMappers());const G=o.countCols(),w=C.columns;if(w&&tt(w)&&(N=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&E.clearCache(),G>0)for(F=0,B=0;F<G;F++){if(w){const T=N?w(F):w[B];T&&E.updateColumnMeta(B,T)}B+=1}ae(g.cell)&&Oe(g.cell,T=>{o.setCellMetaObject(T.row,T.col,T)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let R=g.height;if(tt(R)&&(R=R()),m&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const T=o.rootElement.getAttribute("data-initialstyle");T&&(T.indexOf("height")>-1||T.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",T):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let T=g.width;tt(T)&&(T=T()),o.rootElement.style.width=isNaN(T)?`${T}`:`${T}px`}if(!m){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const T=o.getCurrentThemeName();Gt(g,"themeName")&&T!==g.themeName&&o.useTheme(g.themeName)}o.runHooks("afterUpdateSettings",g)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!m&&o.view&&(b===""||R===""||R===void 0)&&b!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=o.getSelectedLast();if(C.getValue){if(tt(C.getValue))return C.getValue.call(o);if(g)return o.getData()[g[0][0]][C.getValue]}else if(g)return o.getDataAtCell(g[0],g[1])},this.getSettings=function(){return C},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,m,y,N,F){u.alter(g,m,y,N,F)},this.getCell=function(g,m){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,N=m,F=g;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;N=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;F=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return F===null||N===null||F===void 0||N===void 0?null:o.view.getCellAtCoords(o._createCellCoords(F,N),y)},this.getCoords=function(g){const m=this.view._wt.wtTable.getCoords(g);if(m===null)return null;const{row:y,col:N}=m;let F=y,B=N;return y>=0&&(F=this.rowIndexMapper.getVisualFromRenderableIndex(y)),N>=0&&(B=this.columnIndexMapper.getVisualFromRenderableIndex(N)),o._createCellCoords(F,B)},this.colToProp=function(g){return a.colToProp(g)},this.propToCol=function(g){return a.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,m){return a.get(g,a.colToProp(m))},this.getDataAtRowProp=function(g,m){return a.get(g,m)},this.getDataAtCol=function(g){const m=[],y=a.getRange(o._createCellCoords(0,g),o._createCellCoords(C.data.length-1,g),a.DESTINATION_RENDERER);for(let N=0;N<y.length;N+=1)for(let F=0;F<y[N].length;F+=1)m.push(y[N][F]);return m},this.getDataAtProp=function(g){const m=[],y=a.getRange(o._createCellCoords(0,a.propToCol(g)),o._createCellCoords(C.data.length-1,a.propToCol(g)),a.DESTINATION_RENDERER);for(let N=0;N<y.length;N+=1)for(let F=0;F<y[N].length;F+=1)m.push(y[N][F]);return m},this.getSourceData=function(g,m,y,N){let F;return g===void 0?F=l.getData():F=l.getByRange(o._createCellCoords(g,m),o._createCellCoords(y,N)),F},this.getSourceDataArray=function(g,m,y,N){let F;return g===void 0?F=l.getData(!0):F=l.getByRange(o._createCellCoords(g,m),o._createCellCoords(y,N),!0),F},this.getSourceDataAtCol=function(g){return l.getAtColumn(g)},this.setSourceDataAtCell=function(g,m,y,N){const F=$e(g,m,y),B=this.hasHook("afterSetSourceDataAtCell"),G=[];B&&_(F,b=>{let[R,T,M]=b;G.push([R,T,l.getAtCell(R,T),M])}),_(F,b=>{let[R,T,M]=b;l.setAtCell(R,T,M)}),B&&this.runHooks("afterSetSourceDataAtCell",G,N),this.render();const w=o.getActiveEditor();w&&ae(w.refreshValue)&&w.refreshValue()},this.getSourceDataAtRow=function(g){return l.getAtRow(g)},this.getSourceDataAtCell=function(g,m){return l.getAtCell(g,m)},this.getDataAtRow=function(g){return a.getRange(o._createCellCoords(g,0),o._createCellCoords(g,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,m,y,N){const F=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,m,y,N],[B,G]=F;let[,,w,b]=F,R=null,T=null;w===void 0&&(w=B),b===void 0&&(b=G);let M="mixed";return de(Math.max(Math.min(B,w),0),Math.max(B,w),k=>{let W=!0;return de(Math.max(Math.min(G,b),0),Math.max(G,b),O=>(T=this.getCellMeta(k,O).type,R?W=R===T:R=T,W)),M=W?T:"mixed",W}),M},this.removeCellMeta=function(g,m,y){const[N,F]=[this.toPhysicalRow(g),this.toPhysicalColumn(m)];let B=E.getCellMetaKeyValue(N,F,y);o.runHooks("beforeRemoveCellMeta",g,m,y,B)!==!1&&(E.removeCellMeta(N,F,y),o.runHooks("afterRemoveCellMeta",g,m,y,B)),B=null},this.spliceCellsMeta=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var y=arguments.length,N=new Array(y>2?y-2:0),F=2;F<y;F++)N[F-2]=arguments[F];if(N.length>0&&!Array.isArray(N[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&E.removeRow(this.toPhysicalRow(g),m),N.length>0&&_(N.reverse(),B=>{E.createRow(this.toPhysicalRow(g)),_(B,(G,w)=>this.setCellMetaObject(g,w,G))}),o.render()},this.setCellMetaObject=function(g,m,y){typeof y=="object"&&Oe(y,(N,F)=>{this.setCellMeta(g,m,F,N)})},this.setCellMeta=function(g,m,y,N){if(o.runHooks("beforeSetCellMeta",g,m,y,N)===!1)return;let B=g,G=m;g<this.countRows()&&(B=this.toPhysicalRow(g)),m<this.countCols()&&(G=this.toPhysicalColumn(m)),E.setCellMeta(B,G,y,N),o.runHooks("afterSetCellMeta",g,m,y,N)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(g,m){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},N=this.toPhysicalRow(g),F=this.toPhysicalColumn(m);return N===null&&(N=g),F===null&&(F=m),E.getCellMeta(N,F,{visualRow:g,visualColumn:m,...y})},this.getColumnMeta=function(g){return E.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return E.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||C.columns)},this.getCellRenderer=function(g,m){const y=typeof g=="number"?o.getCellMeta(g,m).renderer:g.renderer;return typeof y=="string"?um(y):Rt(y)?um("text"):y},this.getCellEditor=function(g,m){const y=typeof g=="number"?o.getCellMeta(g,m).editor:g.editor;return typeof y=="string"?lm(y):Rt(y)?lm("text"):y},this.getCellValidator=function(g,m){const y=typeof g=="number"?o.getCellMeta(g,m).validator:g.validator;return typeof y=="string"?TE(y):y},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,m){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,g)},this.validateColumns=function(g,m){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,g)},this._validateCells=function(g,m,y){const N=new ee;g&&(N.onQueueEmpty=g);let F=o.countRows()-1;for(;F>=0;){if(m!==void 0&&m.indexOf(F)===-1){F-=1;continue}let B=o.countCols()-1;for(;B>=0;){if(y!==void 0&&y.indexOf(B)===-1){B-=1;continue}N.addValidatorToQueue(),o.validateCell(o.getDataAtCell(F,B),o.getCellMeta(F,B),G=>{if(typeof G!="boolean")throw new Error("Validation error: result is not boolean");G===!1&&(N.valid=!1),N.removeValidatorFormQueue()},"validateCells"),B-=1}F-=1}N.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let m=C.rowHeaders,y=g;return y!==void 0&&(y=o.runHooks("modifyRowHeader",y)),y===void 0?(m=[],de(o.countRows()-1,N=>{m.push(o.getRowHeader(N))})):Array.isArray(m)&&m[y]!==void 0?m=m[y]:tt(m)?m=m(y):m&&typeof m!="string"&&typeof m!="number"&&(m=y+1),m},this.hasRowHeaders=function(){return!!C.rowHeaders},this.hasColHeaders=function(){if(C.colHeaders!==void 0&&C.colHeaders!==null)return!!C.colHeaders;for(let g=0,m=o.countCols();g<m;g++)if(o.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const y=o.runHooks("modifyColHeader",g);if(y===void 0){const w=[],b=o.countCols();for(let R=0;R<b;R++)w.push(o.getColHeader(R));return w}let N=C.colHeaders;const F=function(w){const b=[],R=o.countCols();let T=0;for(;T<R;T++)tt(C.columns)&&C.columns(T)&&b.push(T);return b[w]},B=o.toPhysicalColumn(y),G=F(B);return C.colHeaders===!1?N=null:C.columns&&tt(C.columns)&&C.columns(G)&&C.columns(G).title?N=C.columns(G).title:C.columns&&C.columns[B]&&C.columns[B].title?N=C.columns[B].title:Array.isArray(C.colHeaders)&&C.colHeaders[B]!==void 0?N=C.colHeaders[B]:tt(C.colHeaders)?N=C.colHeaders(B):C.colHeaders&&typeof C.colHeaders!="string"&&typeof C.colHeaders!="number"&&(N=Ep(y)),N=o.runHooks("modifyColumnHeaderValue",N,g,m),N},this._getColWidthFromSettings=function(g){let m;if(g>=0&&(m=o.getCellMeta(0,g).width),(m===void 0||m===C.width)&&(m=C.colWidths),m!=null){switch(typeof m){case"object":m=m[g];break;case"function":m=m(g);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(g,m){let y=o._getColWidthFromSettings(g);return y=o.runHooks("modifyColWidth",y,g,m),y===void 0&&(y=Bu),y},this._getRowHeightFromSettings=function(g){const m=o.stylesHandler.getDefaultRowHeight();let y=C.rowHeights;if(y!=null){switch(typeof y){case"object":y=y[g];break;case"function":y=y(g);break}typeof y=="string"&&(y=parseInt(y,10))}return y!=null&&y<m?m:y},this.getRowHeight=function(g,m){let y=o._getRowHeightFromSettings(g);return y=o.runHooks("modifyRowHeight",y,g,m),y},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const g=C.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,m)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return _b(o.countRows()-1,y=>{if(o.isEmptyRow(y))m+=1;else if(g===!0)return!1}),m},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return _b(o.countCols()-1,y=>{if(o.isEmptyCol(y))m+=1;else if(g===!0)return!1}),m},this.isEmptyRow=function(g){return C.isEmptyRow.call(o,g)},this.isEmptyCol=function(g){return C.isEmptyCol.call(o,g)},this.selectCell=function(g,m,y,N){let F=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Rt(g)||Rt(m)?!1:this.selectCells([[g,m,y,N]],F,B)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&d.suspend();const N=A.selectCells(g);return N&&y&&o.listen(),d.resume(),N},this.selectColumns=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return A.selectColumns(g,m,y)},this.selectRows=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return A.selectRows(g,m,y)},this.deselectCell=function(){A.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),A.selectAll(g,m,y)};const rt=(g,m)=>g.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(g,m){if(typeof g=="number"){var y;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(y=arguments[4])!==null&&y!==void 0?y:!0}}const{row:N,col:F,considerHiddenIndexes:B}=g??{};let G=N,w=F;if(tt(m)&&this.addHookOnce("afterScroll",m),B===void 0||B){const M=Number.isInteger(N)&&N>=0,k=Number.isInteger(F)&&F>=0,W=M?rt(this.rowIndexMapper,N):void 0,O=k?rt(this.columnIndexMapper,F):void 0;if(W===null||O===null)return!1;G=M?o.rowIndexMapper.getRenderableFromVisualIndex(W):N,w=k?o.columnIndexMapper.getRenderableFromVisualIndex(O):F}const b=Number.isInteger(G),R=Number.isInteger(w);let T=!1;return b&&G>=0&&R&&w>=0?T=o.view.scrollViewport(o._createCellCoords(G,w),g.horizontalSnap,g.verticalSnap):b&&G>=0&&(R&&w<0||!R)?T=o.view.scrollViewportVertically(G,g.verticalSnap):R&&w>=0&&(b&&G<0||!b)&&(T=o.view.scrollViewportHorizontally(w,g.horizontalSnap)),tt(m)&&(T?this.view.render():(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m()))),T},this.scrollToFocusedCell=function(g){if(!this.selection.isSelected())return!1;tt(g)&&this.addHookOnce("afterScroll",g);const{highlight:m}=this.getSelectedRangeLast(),y=this.scrollViewportTo(m.toObject());return y?this.view.render():tt(g)&&(this.removeHook("afterScroll",g),this._registerMicrotask(()=>g())),y},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),$.clear(),E.clearCache(),Sy.delete(this.guid),s.destroy(),c&&c.destroy(),o.rootContainer&&ho(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),H.getItems().forEach(g=>{let[,m]=g;m.destroy()}),H.clear(),o.runHooks("afterDestroy")},!0),ne.getSingleton().destroy(o),Oe(o,(g,m,y)=>{tt(g)?y[m]=at(m):m!=="guid"&&(y[m]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,A=null,c=null,o=null};function at(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(g){return H.getItem(kn(g))},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:H.getId(g)},this.getInstance=function(){return o},this.addHook=function(g,m,y){ne.getSingleton().add(g,m,o,y)},this.hasHook=function(g){return ne.getSingleton().has(g,o)||ne.getSingleton().has(g)},this.addHookOnce=function(g,m,y){ne.getSingleton().once(g,m,o,y)},this.removeHook=function(g,m){ne.getSingleton().remove(g,m,o)},this.runHooks=function(g,m,y,N,F,B,G){return ne.getSingleton().run(o,g,m,y,N,F,B,G)},this.getTranslatedPhrase=function(g,m){return Ak(C.language,g,m)},this.toHTML=()=>Eb(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",Eb(this)),g.firstElementChild},this.timeouts=[],this.useTheme=g=>{const m=!!f;this.stylesHandler.useTheme(g);const y=this.stylesHandler.getThemeName();pu(this)&&(me(this.rootWrapperElement,/ht-theme-.*/g),me(this.rootPortalElement,/ht-theme-.*/g),y&&(Y(this.rootWrapperElement,y),Y(this.rootPortalElement,y),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Ke(`The "${y}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),m||(o.render(),o.scrollViewportTo(0,0),eH(this.rootContainer)&&(me(this.rootContainer,/ht-theme-.*/g),y&&Y(this.rootContainer,y))),this.runHooks("afterSetTheme",y,m)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=g;typeof y=="function"&&(y=setTimeout(y,m)),this.timeouts.push(y)},this._clearTimeouts=function(){_(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){_(this.immediates,g=>{clearImmediate(g)})},this._registerMicrotask=function(g){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||g()})},this._getEditorManager=function(){return c};const mn=j4({handleEvent(){return o.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&mn.releasePressedKeys()}),this.getShortcutManager=function(){return mn},this.getFocusManager=function(){return h},EE().forEach(g=>{const m=xd(g);H.addItem(g,new m(this))}),_4(o),mn.setActiveContextName("grid"),ne.getSingleton().run(o,"construct")}function aH(t,e,n){t.addEventListener(e,n,!1)}function lH(t,e,n){t.removeEventListener(e,n,!1)}function Tf(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Zk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Tf(s).fontSize,o.style.fontFamily=Tf(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=Tf(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),p=parseInt(((d=Tf(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+f+p+1;r.removeChild(o);const S=s.style;S.height=`${n.minHeight}px`,n.minWidth>v?S.width=`${n.minWidth}px`:v>n.maxWidth?S.width=`${n.maxWidth}px`:S.width=`${v}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?S.height=`${n.minHeight}px`:n.maxHeight<E?(S.height=`${n.maxHeight}px`,S.overflowY="visible"):S.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(aH(s,"input",a),aH(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){lH(s,"input",a),lH(s,"keydown",l)}}}function uH(t,e){const n=hE(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Id(e,i)}function Ca(t,e,n){return(e=Q4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q4(t){var e=J4(t,"string");return typeof e=="symbol"?e:e+""}function J4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const e9="ht_editor_visible",_f="ht_editor_hidden",cH="textEditor",t9="text";class Tl extends oc{static get EDITOR_TYPE(){return t9}constructor(e){super(e),Ca(this,"eventManager",new Qr(this)),Ca(this,"autoResize",Zk(this.hot.rootDocument)),Ca(this,"TEXTAREA",void 0),Ca(this,"textareaStyle",void 0),Ca(this,"TEXTAREA_PARENT",void 0),Ca(this,"textareaParentStyle",void 0),Ca(this,"layerClass",void 0),this.eventManager=new Qr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Mh(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Vt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Vt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Id(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),ve(this.TEXTAREA,[["data-hot-input",""],oa(-1)]),Y(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Y(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ce(this.TEXTAREA_PARENT,this.layerClass)&&me(this.TEXTAREA_PARENT,this.layerClass),Y(this.TEXTAREA_PARENT,_f),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){bD()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",me(this.TEXTAREA_PARENT,this.layerClass),Y(this.TEXTAREA_PARENT,_f)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;de(e.length-1,r=>{const i=e[r];if(Ce(i,"handsontableEditor"))return n=!0,!1}),Ce(this.TEXTAREA_PARENT,_f)&&me(this.TEXTAREA_PARENT,_f),n?(this.layerClass=e9,Y(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Y(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Vt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){oE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Vt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Vt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>ae(this.hot.getSelected()),group:cH},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;uH(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;uH(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(cH)}}const n9="base",r9="htTextEllipsis";function kd(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&Y(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(fO())):a&&c.push(fO()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(gO())):(u.push(s.invalidCellClassName),a&&c.push(gO()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(r9),me(e,u),Y(e,l),bl(e,c),ve(e,h)}kd.RENDERER_TYPE=n9;const i9="text";function ls(t,e,n,r,i,o,s){kd.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=wt(a),s.trimWhitespace&&(a=a.trim()),Qs(e,a)}ls.RENDERER_TYPE=i9;const o9="text",Qk={CELL_TYPE:o9,editor:Tl,renderer:ls};Fr(Qk);Se.editors={BaseEditor:oc};function Se(t,e){const n=new Xk(t,e||{},WE);return n.init(),n}Se.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Xk(t,e,WE)};Se.DefaultSettings=Vk();Se.hooks=ne.getSingleton();Se.CellCoords=ul;Se.CellRange=Hd;Se.packageName="handsontable";Se.buildDate="09/07/2025 09:58:41";Se.version="16.0.0";Se.languages={dictionaryKeys:g3,getLanguageDictionary:Hk,getLanguagesDictionaries:C3,registerLanguageDictionary:xk,getTranslatedPhrase:Ak};function hH(t,e,n){return(e=s9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s9(t){var e=a9(t,"string");return typeof e=="symbol"?e:e+""}function a9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dH="handsontableEditor",l9="handsontable";class bT extends Tl{constructor(){super(...arguments),hH(this,"isFlippedVertically",!1),hH(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return l9}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Id(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Kt(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getDropdownHeight(),o=e.getWorkspaceHeight()-r-n.height,s=i>o&&r>o+n.height;return s?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:s,spaceAbove:r,spaceBelow:o}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;r=Math.max(r+a,0)}const i=this.getDropdownWidth(),o=e.getWorkspaceWidth()-r+n.width,s=i>o&&r>o;return s?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:s,spaceInlineStart:r,spaceInlineEnd:o}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:dH,relativeToGroup:aa,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||this.isFlippedVertically&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),ii(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&this.isFlippedVertically?a=s.countRows()-1:s.getSelectedLast()&&(this.isFlippedVertically?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!this.isFlippedVertically)a=0;else if(s.getSelectedLast()){if(this.isFlippedVertically)a=s.getSelectedLast()[0]+1;else if(!this.isFlippedVertically){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(dH)}}function u9(t,e){Jk(t,e),e.add(t)}function fH(t,e,n){Jk(t,e),e.set(t,n)}function Jk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mf(t,e,n){return(e=c9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c9(t){var e=h9(t,"string");return typeof e=="symbol"?e:e+""}function h9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function by(t,e){return t.get(Vb(t,e))}function Vb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const d9="autocomplete";var Ry=new WeakMap,gH=new WeakMap,Ey=new WeakSet;class RT extends bT{constructor(){super(...arguments),u9(this,Ey),Mf(this,"query",null),Mf(this,"strippedChoices",[]),Mf(this,"rawChoices",[]),fH(this,Ry,this.hot.guid.slice(0,9)),fH(this,gH,Od(()=>{this.focus()},100)),Mf(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=yb(wt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return d9}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ae(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Y(this.htContainer,"autocompleteEditor"),Y(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[Bz(),Lz(),cD("listbox"),Yz()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[Xr("false"),Gz(`${by(Ry,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r?.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",by(gH,this)),this.htEditor.updateSettings({colWidths:e?[Bt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{ls(a,l,u,c,h,d,f);const{filteringCaseSensitive:p,allowHtml:v,locale:S}=this.cellProperties,E=this.query;let C=wt(d),I,H;C&&!v&&(I=p===!0?C.indexOf(E):C.toLocaleLowerCase(S).indexOf(E.toLocaleLowerCase(S)),I!==-1&&(H=C.substr(I,E.length),C=C.replace(H,`<strong>${H}</strong>`))),n&&ve(l,[$z(),...r?[Zz(i)]:[],...r?[Qz(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=C},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{ve(h,[nE()]),ve(this.TEXTAREA,...qz(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(ve(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Go()),ve(this.htEditor.rootElement,[uD(),Kz("polite"),Xz("text"),["id",`${by(Ry,this)}-listbox-${o}-${s}`]]),ve(this.TEXTAREA,...Xr("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[Xr("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=hE(this.TEXTAREA),r=AD(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Eh([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Id(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:r,spaceBelow:i}=e;return this.limitDropdownIfNeeded(n?r:i),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let r=0,i=0,o=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),r+=i;while(r<e);o=r-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(r-i)}}updateDropdownDimensions(){const e=dE(),n=this.getTargetEditorWidth()+e,r=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:r}),Vb(Ey,this,mH).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),Vb(Ey,this,mH).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(i,o)=>o).reduce((i,o)=>{const s=this.hot.stylesHandler.getDefaultRowHeight()+(o===0?1:0);return i+s},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Le(e,o=>wt(o));return Le(r,o=>n?o:yb(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===he.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===he.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if($D(e.keyCode)||e.keyCode===he.BACKSPACE||e.keyCode===he.DELETE||e.keyCode===he.INSERT){let n=10;if(e.keyCode===he.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function mH(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+gn(this.hot.rootDocument)})}const f9="checkbox";class eL extends oc{static get EDITOR_TYPE(){return f9}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');Ce(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Vs=()=>window,Yr=()=>window.document,Wb=(t,e)=>window.setTimeout(t,e),Xi=function(t,e,n,r){t.addEventListener(e,n,!!r)},Po=function(t,e,n,r){t.removeEventListener(e,n,!!r)},g9=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},br=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},Ty=function(t,e){br(t,e)||(t.className=t.className===""?e:t.className+" "+e)},_y=function(t,e){t.className=g9((" "+t.className+" ").replace(" "+e+" "," "))},ET=function(t){return/Array/.test(Object.prototype.toString.call(t))},Mr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},m9=function(t){let e=t.getDay();return e===0||e===6},p9=function(t){return t%4===0&&t%100!==0||t%400===0},pH=function(t,e){return[31,p9(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},If=function(t){Mr(t)&&t.setHours(0,0,0,0)},Pf=function(t,e){return t.getTime()===e.getTime()},mm=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Mr(e[r])?n&&(t[r]=new Date(e[r].getTime())):ET(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=mm({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},wH=function(t,e,n){let r=Yr().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=mm(r,n),t.dispatchEvent(r)},vH=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Fi={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},CH=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},w9=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},v9=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},C9=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():v9(o,i))+"</td>"},y9=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},S9=function(t){return"<tbody>"+t.join("")+"</tbody>"},b9=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+CH(t,e)+'">'+CH(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},R9=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,p,v=!0,S=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",ET(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return p='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=p+f:d+=f+p,c&&(r===0||u.minMonth>=r)&&(v=!1),h&&(r===11||u.maxMonth<=r)&&(S=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(S?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},E9=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+b9(t)+S9(e)+"</table>"};function Bb(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Vs().event;let o=i.target||i.srcElement;if(o)if(br(o,"is-disabled")||(br(o,"pika-button")&&!br(o,"is-empty")&&!br(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&Wb(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):br(o,"pika-prev")?e.prevMonth():br(o,"pika-next")&&e.nextMonth()),br(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Vs().event;let o=i.target||i.srcElement;o&&(br(o,"pika-select-month")?e.gotoMonth(o.value):br(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Vs().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Mr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Yr().activeElement;do if(br(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=Wb(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Vs().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&br(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Xi(o,"change",e._onChange)));do if(br(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Yr().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Xi(e.el,"mousedown",e._onMouseDown,!0),Xi(e.el,"touchend",e._onMouseDown,!0),Xi(e.el,"change",e._onChange),n.keyboardInput&&Xi(Yr(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Yr().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Xi(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Mr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Xi(n.trigger,"click",e._onInputClick),Xi(n.trigger,"focus",e._onInputFocus),Xi(n.trigger,"blur",e._onInputBlur)):this.show()}Bb.prototype={config:function(t){this._o||(this._o=mm({},Fi,!0));let e=mm(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Mr(e.minDate)||(e.minDate=!1),Mr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),ET(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Fi.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Mr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Mr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",wH(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Mr(t))return;let n=this._o.minDate,r=this._o.maxDate;Mr(n)&&t<n?t=n:Mr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),If(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),wH(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Mr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=vH(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=vH({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(If(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Fi.minDate,this._o.minYear=Fi.minYear,this._o.minMonth=Fi.minMonth,this._o.startRange=Fi.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(If(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Fi.maxDate,this._o.maxYear=Fi.maxYear,this._o.maxMonth=Fi.maxMonth,this._o.endRange=Fi.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+R9(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&Wb(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Vs().innerWidth||Yr().documentElement.clientWidth,i=Vs().innerHeight||Yr().documentElement.clientHeight,o=Yr().body.scrollTop||Yr().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Vs().pageXOffset,a=l.bottom+Vs().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",Ty(this.el,u?"left-aligned":"right-aligned"),Ty(this.el,c?"bottom-aligned":"top-aligned"),_y(this.el,u?"right-aligned":"left-aligned"),_y(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=pH(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];If(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=pH(h,u),p=o+s,v=p;for(;v>7;)v-=7;p+=7-v;let S=!1;for(let E=0,C=0;E<p;E++){let I=new Date(t,e,1+(E-s)),H=Mr(this._d)?Pf(I,this._d):!1,$=Pf(I,i),P=r.events.indexOf(I.toDateString())!==-1,x=E<s||E>=o+s,z=1+(E-s),K=e,A=t,Q=r.startRange&&Pf(r.startRange,I),X=r.endRange&&Pf(r.endRange,I),se=r.startRange&&r.endRange&&r.startRange<I&&I<r.endRange,ee=r.minDate&&I<r.minDate||r.maxDate&&I>r.maxDate||r.disableWeekends&&m9(I)||r.disableDayFn&&r.disableDayFn(I);x&&(E<s?(z=f+z,K=u,A=h):(z=z-o,K=c,A=d));let ue={day:z,month:K,year:A,hasEvent:P,isSelected:H,isToday:$,isDisabled:ee,isEmpty:x,isStartRange:Q,isEndRange:X,isInRange:se,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&H&&(S=!0),l.push(w9(ue)),++C===7&&(r.showWeekNumber&&l.unshift(C9(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(y9(l,r.isRTL,r.pickWholeWeek,S)),l=[],C=0,S=!1)}return E9(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),_y(this.el,"is-hidden"),this._o.bound&&(Xi(Yr(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Po(Yr(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Ty(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Po(this.el,"mousedown",this._onMouseDown,!0),Po(this.el,"touchend",this._onMouseDown,!0),Po(this.el,"change",this._onChange),t.keyboardInput&&Po(Yr(),"keydown",this._onKeyChange),t.field&&(Po(t.field,"change",this._onInputChange),t.bound&&(Po(t.trigger,"click",this._onInputClick),Po(t.trigger,"focus",this._onInputFocus),Po(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function T9(t,e){_9(t,e),e.add(t)}function _9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yH(t,e,n){return(e=M9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M9(t){var e=I9(t,"string");return typeof e=="symbol"?e:e+""}function I9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function My(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tL="date",SH="dateEditor",P9="DD/MM/YYYY";var Of=new WeakSet;class nL extends Tl{constructor(){super(...arguments),T9(this,Of),yH(this,"parentDestroyed",!1),yH(this,"$datePicker",null)}static get EDITOR_TYPE(){return tL}init(){if(typeof q!="function")throw new Error("You need to include moment.js to your project.");if(typeof Bb!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Y(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Ce(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:SH})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SH),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=My(Of,this,Iy).call(this),r=this.hot.view.isMouseDown(),i=e?CE(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new Bb(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(q),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,q(o,n,!0).isValid()&&this.$datePicker.setMoment(q(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,q(o,n,!0).isValid()&&this.$datePicker.setMoment(q(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&Md(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:My(Of,this,Iy).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=q(a).format(My(Of,this,Iy).call(this))),this.setValue(a),i&&i(),Ti()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Vt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+qt(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Bt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function Iy(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:P9}const O9="dropdown";class rL extends RT{static get EDITOR_TYPE(){return O9}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const x9="numeric";class iL extends Tl{static get EDITOR_TYPE(){return x9}}function H9(t,e,n){return(e=A9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A9(t){var e=N9(t,"string");return typeof e=="symbol"?e:e+""}function N9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const D9="password";class oL extends Tl{constructor(){super(...arguments),H9(this,"autoResize",Zk(this.hot.rootDocument,{textContent:e=>"â¢".repeat(e.value.length)}))}static get EDITOR_TYPE(){return D9}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ho(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...oa(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Py="ht_editor_visible",bH="selectEditor",k9="select";class sL extends oc{static get EDITOR_TYPE(){return k9}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Sl()),e.appendChild(this.hot.rootDocument.createTextNode("â¼")),Y(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ce(this.selectWrapper,Py)&&me(this.selectWrapper,Py),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ho(this.select),Oe(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Rl(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Vt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",Y(this.selectWrapper,Py)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:bH};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(bH)}}const L9="time";class aL extends Tl{static get EDITOR_TYPE(){return L9}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function $9(){lr(oc),lr(RT),lr(eL),lr(nL),lr(rL),lr(bT),lr(iL),lr(oL),lr(sL),lr(Tl),lr(aL)}const F9="html";function TT(t,e,n,r,i,o,s){kd.apply(this,[t,e,n,r,i,o,s]),Rl(e,o??"",!1)}TT.RENDERER_TYPE=F9;const V9="autocomplete";function ac(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?TT:ls,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Sl()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),Y(e,"htAutocomplete"),!t.acArrowListener){const h=new Qr(t);t.acArrowListener=function(d){Ce(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}ac.RENDERER_TYPE=V9;const W9="dropdown";function _T(t,e,n,r,i,o,s){ac.apply(this,[t,e,n,r,i,o,s])}_T.RENDERER_TYPE=W9;const RH=new WeakMap,EH=new WeakMap,B9="htBadValue",zu="data-row",Yu="data-col",j9="checkboxRenderer",lL="checkbox";ne.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===lL){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function MT(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;kd.apply(this,[t,e,n,r,i,o,s]),U9(t);let u=z9(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),ho(e),o===s.checkedTemplate||wt(o).toLocaleLowerCase(s.locale)===wt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||wt(o).toLocaleLowerCase(s.locale)===wt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:kt(o)?Y(u,"noValue"):(u.style.display="none",Y(u,B9),h=!0),ve(u,[[zu,n],[Yu,r]]),l&&ve(u,[$u(u.checked?t.getTranslatedPhrase(mT):t.getTranslatedPhrase(pT)),fD(u.checked),Fz()]),!h&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);v=E!==null?E:""}const S=Y9(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(S),e.appendChild(u)):(S.appendChild(u),u=S):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(S)):(S.insertBefore(u,S.firstChild),u=S))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),RH.has(t)||(RH.set(t,!0),d());function d(){const S=t.getShortcutManager().getContext("grid"),E={group:j9,relativeToGroup:aa,position:"before"};S.addShortcuts([{keys:[["space"]],callback:()=>(f(),!p()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!p()),runOnlyIf:()=>{const C=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&C?.highlight.isCell()&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!p()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}}],E)}function f(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=t.getSelectedRange(),E=[],C=new Map;let I=[],H=0;if(S){for(let $=0;$<S.length;$++){const{row:P,col:x}=S[$].getTopStartCorner(),{row:z,col:K}=S[$].getBottomEndCorner();for(let A=P;A<=z;A+=1)for(let Q=x;Q<=K;Q+=1){const X=t.getCellMeta(A,Q);if(X.hidden)continue;const se={checkedTemplate:X.checkedTemplate,uncheckedTemplate:X.uncheckedTemplate};if(X.type!=="checkbox"){v===!0&&!X.readOnly&&(C.has(E.length)?C.set(E.length,[...C.get(E.length),[A,Q,null]]):C.set(E.length,[[A,Q,null]]));continue}if(X.readOnly===!0)continue;typeof X.checkedTemplate>"u"&&(X.checkedTemplate=!0),typeof X.uncheckedTemplate>"u"&&(X.uncheckedTemplate=!1);const ee=t.getDataAtCell(A,Q);v===!1?[X.checkedTemplate,X.checkedTemplate.toString()].includes(ee)?I.push([A,Q,X.uncheckedTemplate,se]):[X.uncheckedTemplate,X.uncheckedTemplate.toString(),null,void 0].includes(ee)&&I.push([A,Q,X.checkedTemplate,se]):I.push([A,Q,X.uncheckedTemplate,se]),H+=1}E.push(H),H=0}I.every($=>{let[,,P]=$;return P===I[0][2]})?I=I.map($=>{let[P,x,z]=$;return[P,x,z]}):I=I.map($=>{let[P,x,,z]=$;return[P,x,z.checkedTemplate]}),I.length>0&&E.forEach(($,P)=>{let x=I.splice(0,$);C.size&&C.has(P)&&(x=[...x,...C.get(P)]),t.setDataAtCell(x)})}}function p(){const v=t.getSelectedRange();if(v){for(let S=0;S<v.length;S++){const E=v[S].getTopStartCorner(),C=v[S].getBottomEndCorner();for(let I=E.row;I<=C.row;I++)for(let H=E.col;H<=C.col;H++){if(t.getCellMeta(I,H).readOnly)continue;const P=t.getCell(I,H);if(lo(P)&&P.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}MT.RENDERER_TYPE=lL;function U9(t){let e=EH.get(t);if(!e){const{rootElement:n}=t;e=new Qr(t),e.addEventListener(n,"click",r=>q9(r,t)),e.addEventListener(n,"mouseup",r=>G9(r,t)),e.addEventListener(n,"change",r=>K9(r,t)),EH.set(t,e)}return e}function z9(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Y9(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function G9(t,e){const{target:n}=t;IT(n)&&(!n.hasAttribute(zu)||!n.hasAttribute(Yu)||setTimeout(e.listen,10))}function q9(t,e){const{target:n}=t;if(!IT(n)||!n.hasAttribute(zu)||!n.hasAttribute(Yu))return;const r=parseInt(n.getAttribute(zu),10),i=parseInt(n.getAttribute(Yu),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function K9(t,e){const{target:n}=t;if(!IT(n)||!n.hasAttribute(zu)||!n.hasAttribute(Yu))return;const r=parseInt(n.getAttribute(zu),10),i=parseInt(n.getAttribute(Yu),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function IT(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const X9="handsontable";function PT(t,e,n,r,i,o,s){ac.apply(this,[t,e,n,r,i,o,s])}PT.RENDERER_TYPE=X9;var Z9=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Q9(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Oy,TH;function J9(){return TH||(TH=1,Oy={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),Oy}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var xy,_H;function uL(){if(_H)return xy;_H=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,p){if(!isNaN(+l))return+l;let v="",S=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(S!==l)return-1*n(S,u,c,h,d,f);for(let P=0;P<t.length;P++){let x=t[P];if(v=l.replace(RegExp(`([0-9 ])(${x.key})$`),"$1"),v!==l)return n(v,u,c,h,d,f)*x.factor}if(v=l.replace("%",""),v!==l)return n(v,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let C=h(E);if(C&&C!=="."&&(v=l.replace(new RegExp(`${e(C)}$`),""),v!==l))return n(v,u,c,h,d,f);let I={};Object.keys(f).forEach(P=>{I[f[P]]=P});let H=Object.keys(I).sort().reverse(),$=H.length;for(let P=0;P<$;P++){let x=H[P],z=I[x];if(v=l.replace(x,""),v!==l){let K;switch(z){case"thousand":K=Math.pow(10,3);break;case"million":K=Math.pow(10,6);break;case"billion":K=Math.pow(10,9);break;case"trillion":K=Math.pow(10,12);break}return n(v,u,c,h,d,f)*K}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,p){if(l==="")return;if(l===d)return 0;let v=r(l,u,c);return n(v,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],p=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(p)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=HT();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),p=c.getZeroFormat(),v=c.currentAbbreviations(),S;if(typeof l=="string")o(l,h)?S=s(l):S=i(l,h,d,f,p,v);else if(typeof l=="number")S=l;else return;if(S!==void 0)return S}return xy={unformat:a},xy}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Hy,MH;function OT(){if(MH)return Hy;MH=1;let t=uL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(S,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:S=>S.output==="byte"},characteristic:{type:"number",restriction:S=>S>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(S,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:S=>S>=0,message:"value must be positive"},{restriction:(S,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:S=>S>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(S,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:S=>S.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(S,E){let C=d(S),I=p(E);return C&&I}function d(S){return t.unformat(S)!==void 0}function f(S,E,C,I=!1){let H=Object.keys(S).map($=>{if(!E[$])return console.error(`${C} Invalid key: ${$}`),!1;let P=S[$],x=E[$];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!f(P,u,`[Validate ${$}]`,!0))return!1}else if(typeof P!==x.type)return console.error(`${C} ${$} type mismatched: "${x.type}" expected, "${typeof P}" provided`),!1;if(x.restrictions&&x.restrictions.length){let z=x.restrictions.length;for(let K=0;K<z;K++){let{restriction:A,message:Q}=x.restrictions[K];if(!A(P,S))return console.error(`${C} ${$} invalid value: ${Q}`),!1}}return x.restriction&&!x.restriction(P,S)?(console.error(`${C} ${$} invalid value: ${x.message}`),!1):x.validValues&&x.validValues.indexOf(P)===-1?(console.error(`${C} ${$} invalid value: must be among ${JSON.stringify(x.validValues)}, "${P}" provided`),!1):!(x.children&&!f(P,x.children,`[Validate ${$}]`))});return I||H.push(...Object.keys(E).map($=>{let P=E[$];if(typeof P=="string"&&(P={type:P}),P.mandatory){let x=P.mandatory;if(typeof x=="function"&&(x=x(S)),x&&S[$]===void 0)return console.error(`${C} Missing mandatory key "${$}"`),!1}return!0})),H.reduce(($,P)=>$&&P,!0)}function p(S){return f(S,u,"[Validate format]")}function v(S){return f(S,c,"[Validate language]")}return Hy={validate:h,validateFormat:p,validateInput:d,validateLanguage:v},Hy}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function e6(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function t6(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function n6(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function r6(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function i6(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function o6(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function s6(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function a6(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function l6(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function u6(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function c6(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function h6(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function d6(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function f6(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function g6(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function m6(t,e={}){return typeof t!="string"?t:(t=e6(t,e),t=t6(t,e),n6(t,e),o6(t,e),s6(t,e),d6(t,e),u6(t,e),c6(t,e),a6(t,e),h6(t,e),l6(t,e),r6(t,e),i6(t,e),f6(t,e),g6(t,e),e)}var xT={parseFormat:m6};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Ay,IH;function HT(){if(IH)return Ay;IH=1;const t=J9(),e=OT(),n=xT;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(p=>p.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,Ay=r,Ay}function p6(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function w6(t,e){t.forEach(n=>{let r;try{r=p6(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var v6=t=>({loadLanguagesInNode:e=>w6(e,t)}),cL={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function p(P){var x,z,K,A=m.prototype={constructor:m,toString:null,valueOf:null},Q=new m(1),X=20,se=4,ee=-7,ue=21,vt=-1e7,Ne=1e7,$e=!1,Ct=1,rt=0,at={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},mn="0123456789abcdefghijklmnopqrstuvwxyz",g=!0;function m(w,b){var R,T,M,k,W,O,L,V,j=this;if(!(j instanceof m))return new m(w,b);if(b==null){if(w&&w._isBigNumber===!0){j.s=w.s,!w.c||w.e>Ne?j.c=j.e=null:w.e<vt?j.c=[j.e=0]:(j.e=w.e,j.c=w.c.slice());return}if((O=typeof w=="number")&&w*0==0){if(j.s=1/w<0?(w=-w,-1):1,w===~~w){for(k=0,W=w;W>=10;W/=10,k++);k>Ne?j.c=j.e=null:(j.e=k,j.c=[w]);return}V=String(w)}else{if(!r.test(V=String(w)))return K(j,V,O);j.s=V.charCodeAt(0)==45?(V=V.slice(1),-1):1}(k=V.indexOf("."))>-1&&(V=V.replace(".","")),(W=V.search(/e/i))>0?(k<0&&(k=W),k+=+V.slice(W+1),V=V.substring(0,W)):k<0&&(k=V.length)}else{if(C(b,2,mn.length,"Base"),b==10&&g)return j=new m(w),B(j,X+j.e+1,se);if(V=String(w),O=typeof w=="number"){if(w*0!=0)return K(j,V,O,b);if(j.s=1/w<0?(V=V.slice(1),-1):1,m.DEBUG&&V.replace(/^0\.0*|\./,"").length>15)throw Error(a+w)}else j.s=V.charCodeAt(0)===45?(V=V.slice(1),-1):1;for(R=mn.slice(0,b),k=W=0,L=V.length;W<L;W++)if(R.indexOf(T=V.charAt(W))<0){if(T=="."){if(W>k){k=L;continue}}else if(!M&&(V==V.toUpperCase()&&(V=V.toLowerCase())||V==V.toLowerCase()&&(V=V.toUpperCase()))){M=!0,W=-1,k=0;continue}return K(j,String(w),O,b)}O=!1,V=z(V,b,10,j.s),(k=V.indexOf("."))>-1?V=V.replace(".",""):k=V.length}for(W=0;V.charCodeAt(W)===48;W++);for(L=V.length;V.charCodeAt(--L)===48;);if(V=V.slice(W,++L)){if(L-=W,O&&m.DEBUG&&L>15&&(w>c||w!==o(w)))throw Error(a+j.s*w);if((k=k-W-1)>Ne)j.c=j.e=null;else if(k<vt)j.c=[j.e=0];else{if(j.e=k,j.c=[],W=(k+1)%u,k<0&&(W+=u),W<L){for(W&&j.c.push(+V.slice(0,W)),L-=u;W<L;)j.c.push(+V.slice(W,W+=u));W=u-(V=V.slice(W)).length}else W-=L;for(;W--;V+="0");j.c.push(+V)}}else j.c=[j.e=0]}m.clone=p,m.ROUND_UP=0,m.ROUND_DOWN=1,m.ROUND_CEIL=2,m.ROUND_FLOOR=3,m.ROUND_HALF_UP=4,m.ROUND_HALF_DOWN=5,m.ROUND_HALF_EVEN=6,m.ROUND_HALF_CEIL=7,m.ROUND_HALF_FLOOR=8,m.EUCLID=9,m.config=m.set=function(w){var b,R;if(w!=null)if(typeof w=="object"){if(w.hasOwnProperty(b="DECIMAL_PLACES")&&(R=w[b],C(R,0,f,b),X=R),w.hasOwnProperty(b="ROUNDING_MODE")&&(R=w[b],C(R,0,8,b),se=R),w.hasOwnProperty(b="EXPONENTIAL_AT")&&(R=w[b],R&&R.pop?(C(R[0],-f,0,b),C(R[1],0,f,b),ee=R[0],ue=R[1]):(C(R,-f,f,b),ee=-(ue=R<0?-R:R))),w.hasOwnProperty(b="RANGE"))if(R=w[b],R&&R.pop)C(R[0],-f,-1,b),C(R[1],1,f,b),vt=R[0],Ne=R[1];else if(C(R,-f,f,b),R)vt=-(Ne=R<0?-R:R);else throw Error(s+b+" cannot be zero: "+R);if(w.hasOwnProperty(b="CRYPTO"))if(R=w[b],R===!!R)if(R)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))$e=R;else throw $e=!R,Error(s+"crypto unavailable");else $e=R;else throw Error(s+b+" not true or false: "+R);if(w.hasOwnProperty(b="MODULO_MODE")&&(R=w[b],C(R,0,9,b),Ct=R),w.hasOwnProperty(b="POW_PRECISION")&&(R=w[b],C(R,0,f,b),rt=R),w.hasOwnProperty(b="FORMAT"))if(R=w[b],typeof R=="object")at=R;else throw Error(s+b+" not an object: "+R);if(w.hasOwnProperty(b="ALPHABET"))if(R=w[b],typeof R=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(R))g=R.slice(0,10)=="0123456789",mn=R;else throw Error(s+b+" invalid: "+R)}else throw Error(s+"Object expected: "+w);return{DECIMAL_PLACES:X,ROUNDING_MODE:se,EXPONENTIAL_AT:[ee,ue],RANGE:[vt,Ne],CRYPTO:$e,MODULO_MODE:Ct,POW_PRECISION:rt,FORMAT:at,ALPHABET:mn}},m.isBigNumber=function(w){if(!w||w._isBigNumber!==!0)return!1;if(!m.DEBUG)return!0;var b,R,T=w.c,M=w.e,k=w.s;e:if({}.toString.call(T)=="[object Array]"){if((k===1||k===-1)&&M>=-f&&M<=f&&M===o(M)){if(T[0]===0){if(M===0&&T.length===1)return!0;break e}if(b=(M+1)%u,b<1&&(b+=u),String(T[0]).length==b){for(b=0;b<T.length;b++)if(R=T[b],R<0||R>=l||R!==o(R))break e;if(R!==0)return!0}}}else if(T===null&&M===null&&(k===null||k===1||k===-1))return!0;throw Error(s+"Invalid BigNumber: "+w)},m.maximum=m.max=function(){return N(arguments,-1)},m.minimum=m.min=function(){return N(arguments,1)},m.random=function(){var w=9007199254740992,b=Math.random()*w&2097151?function(){return o(Math.random()*w)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(R){var T,M,k,W,O,L=0,V=[],j=new m(Q);if(R==null?R=X:C(R,0,f),W=i(R/u),$e)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(W*=2));L<W;)O=T[L]*131072+(T[L+1]>>>11),O>=9e15?(M=crypto.getRandomValues(new Uint32Array(2)),T[L]=M[0],T[L+1]=M[1]):(V.push(O%1e14),L+=2);L=W/2}else if(crypto.randomBytes){for(T=crypto.randomBytes(W*=7);L<W;)O=(T[L]&31)*281474976710656+T[L+1]*1099511627776+T[L+2]*4294967296+T[L+3]*16777216+(T[L+4]<<16)+(T[L+5]<<8)+T[L+6],O>=9e15?crypto.randomBytes(7).copy(T,L):(V.push(O%1e14),L+=7);L=W/7}else throw $e=!1,Error(s+"crypto unavailable");if(!$e)for(;L<W;)O=b(),O<9e15&&(V[L++]=O%1e14);for(W=V[--L],R%=u,W&&R&&(O=h[u-R],V[L]=o(W/O)*O);V[L]===0;V.pop(),L--);if(L<0)V=[k=0];else{for(k=-1;V[0]===0;V.splice(0,1),k-=u);for(L=1,O=V[0];O>=10;O/=10,L++);L<u&&(k-=u-L)}return j.e=k,j.c=V,j}}(),m.sum=function(){for(var w=1,b=arguments,R=new m(b[0]);w<b.length;)R=R.plus(b[w++]);return R},z=function(){var w="0123456789";function b(R,T,M,k){for(var W,O=[0],L,V=0,j=R.length;V<j;){for(L=O.length;L--;O[L]*=T);for(O[0]+=k.indexOf(R.charAt(V++)),W=0;W<O.length;W++)O[W]>M-1&&(O[W+1]==null&&(O[W+1]=0),O[W+1]+=O[W]/M|0,O[W]%=M)}return O.reverse()}return function(R,T,M,k,W){var O,L,V,j,U,ie,oe,be,Fe=R.indexOf("."),Ve=X,Re=se;for(Fe>=0&&(j=rt,rt=0,R=R.replace(".",""),be=new m(T),ie=be.pow(R.length-Fe),rt=j,be.c=b($(S(ie.c),ie.e,"0"),10,M,w),be.e=be.c.length),oe=b(R,T,M,W?(O=mn,w):(O=w,mn)),V=j=oe.length;oe[--j]==0;oe.pop());if(!oe[0])return O.charAt(0);if(Fe<0?--V:(ie.c=oe,ie.e=V,ie.s=k,ie=x(ie,be,Ve,Re,M),oe=ie.c,U=ie.r,V=ie.e),L=V+Ve+1,Fe=oe[L],j=M/2,U=U||L<0||oe[L+1]!=null,U=Re<4?(Fe!=null||U)&&(Re==0||Re==(ie.s<0?3:2)):Fe>j||Fe==j&&(Re==4||U||Re==6&&oe[L-1]&1||Re==(ie.s<0?8:7)),L<1||!oe[0])R=U?$(O.charAt(1),-Ve,O.charAt(0)):O.charAt(0);else{if(oe.length=L,U)for(--M;++oe[--L]>M;)oe[L]=0,L||(++V,oe=[1].concat(oe));for(j=oe.length;!oe[--j];);for(Fe=0,R="";Fe<=j;R+=O.charAt(oe[Fe++]));R=$(R,V,O.charAt(0))}return R}}(),x=function(){function w(T,M,k){var W,O,L,V,j=0,U=T.length,ie=M%d,oe=M/d|0;for(T=T.slice();U--;)L=T[U]%d,V=T[U]/d|0,W=oe*L+V*ie,O=ie*L+W%d*d+j,j=(O/k|0)+(W/d|0)+oe*V,T[U]=O%k;return j&&(T=[j].concat(T)),T}function b(T,M,k,W){var O,L;if(k!=W)L=k>W?1:-1;else for(O=L=0;O<k;O++)if(T[O]!=M[O]){L=T[O]>M[O]?1:-1;break}return L}function R(T,M,k,W){for(var O=0;k--;)T[k]-=O,O=T[k]<M[k]?1:0,T[k]=O*W+T[k]-M[k];for(;!T[0]&&T.length>1;T.splice(0,1));}return function(T,M,k,W,O){var L,V,j,U,ie,oe,be,Fe,Ve,Re,ye,Je,Zn,Co,ai,ln,yt,_t=T.s==M.s?1:-1,gt=T.c,Xe=M.c;if(!gt||!gt[0]||!Xe||!Xe[0])return new m(!T.s||!M.s||(gt?Xe&&gt[0]==Xe[0]:!Xe)?NaN:gt&&gt[0]==0||!Xe?_t*0:_t/0);for(Fe=new m(_t),Ve=Fe.c=[],V=T.e-M.e,_t=k+V+1,O||(O=l,V=v(T.e/u)-v(M.e/u),_t=_t/u|0),j=0;Xe[j]==(gt[j]||0);j++);if(Xe[j]>(gt[j]||0)&&V--,_t<0)Ve.push(1),U=!0;else{for(Co=gt.length,ln=Xe.length,j=0,_t+=2,ie=o(O/(Xe[0]+1)),ie>1&&(Xe=w(Xe,ie,O),gt=w(gt,ie,O),ln=Xe.length,Co=gt.length),Zn=ln,Re=gt.slice(0,ln),ye=Re.length;ye<ln;Re[ye++]=0);yt=Xe.slice(),yt=[0].concat(yt),ai=Xe[0],Xe[1]>=O/2&&ai++;do{if(ie=0,L=b(Xe,Re,ln,ye),L<0){if(Je=Re[0],ln!=ye&&(Je=Je*O+(Re[1]||0)),ie=o(Je/ai),ie>1)for(ie>=O&&(ie=O-1),oe=w(Xe,ie,O),be=oe.length,ye=Re.length;b(oe,Re,be,ye)==1;)ie--,R(oe,ln<be?yt:Xe,be,O),be=oe.length,L=1;else ie==0&&(L=ie=1),oe=Xe.slice(),be=oe.length;if(be<ye&&(oe=[0].concat(oe)),R(Re,oe,ye,O),ye=Re.length,L==-1)for(;b(Xe,Re,ln,ye)<1;)ie++,R(Re,ln<ye?yt:Xe,ye,O),ye=Re.length}else L===0&&(ie++,Re=[0]);Ve[j++]=ie,Re[0]?Re[ye++]=gt[Zn]||0:(Re=[gt[Zn]],ye=1)}while((Zn++<Co||Re[0]!=null)&&_t--);U=Re[0]!=null,Ve[0]||Ve.splice(0,1)}if(O==l){for(j=1,_t=Ve[0];_t>=10;_t/=10,j++);B(Fe,k+(Fe.e=j+V*u-1)+1,W,U)}else Fe.e=V,Fe.r=+U;return Fe}}();function y(w,b,R,T){var M,k,W,O,L;if(R==null?R=se:C(R,0,8),!w.c)return w.toString();if(M=w.c[0],W=w.e,b==null)L=S(w.c),L=T==1||T==2&&(W<=ee||W>=ue)?H(L,W):$(L,W,"0");else if(w=B(new m(w),b,R),k=w.e,L=S(w.c),O=L.length,T==1||T==2&&(b<=k||k<=ee)){for(;O<b;L+="0",O++);L=H(L,k)}else if(b-=W,L=$(L,k,"0"),k+1>O){if(--b>0)for(L+=".";b--;L+="0");}else if(b+=k-O,b>0)for(k+1==O&&(L+=".");b--;L+="0");return w.s<0&&M?"-"+L:L}function N(w,b){for(var R,T,M=1,k=new m(w[0]);M<w.length;M++)T=new m(w[M]),(!T.s||(R=E(k,T))===b||R===0&&k.s===b)&&(k=T);return k}function F(w,b,R){for(var T=1,M=b.length;!b[--M];b.pop());for(M=b[0];M>=10;M/=10,T++);return(R=T+R*u-1)>Ne?w.c=w.e=null:R<vt?w.c=[w.e=0]:(w.e=R,w.c=b),w}K=function(){var w=/^(-?)0([xbo])(?=\w[\w.]*$)/i,b=/^([^.]+)\.$/,R=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,M=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(k,W,O,L){var V,j=O?W:W.replace(M,"");if(T.test(j))k.s=isNaN(j)?null:j<0?-1:1;else{if(!O&&(j=j.replace(w,function(U,ie,oe){return V=(oe=oe.toLowerCase())=="x"?16:oe=="b"?2:8,!L||L==V?ie:U}),L&&(V=L,j=j.replace(b,"$1").replace(R,"0.$1")),W!=j))return new m(j,V);if(m.DEBUG)throw Error(s+"Not a"+(L?" base "+L:"")+" number: "+W);k.s=null}k.c=k.e=null}}();function B(w,b,R,T){var M,k,W,O,L,V,j,U=w.c,ie=h;if(U){e:{for(M=1,O=U[0];O>=10;O/=10,M++);if(k=b-M,k<0)k+=u,W=b,L=U[V=0],j=o(L/ie[M-W-1]%10);else if(V=i((k+1)/u),V>=U.length)if(T){for(;U.length<=V;U.push(0));L=j=0,M=1,k%=u,W=k-u+1}else break e;else{for(L=O=U[V],M=1;O>=10;O/=10,M++);k%=u,W=k-u+M,j=W<0?0:o(L/ie[M-W-1]%10)}if(T=T||b<0||U[V+1]!=null||(W<0?L:L%ie[M-W-1]),T=R<4?(j||T)&&(R==0||R==(w.s<0?3:2)):j>5||j==5&&(R==4||T||R==6&&(k>0?W>0?L/ie[M-W]:0:U[V-1])%10&1||R==(w.s<0?8:7)),b<1||!U[0])return U.length=0,T?(b-=w.e+1,U[0]=ie[(u-b%u)%u],w.e=-b||0):U[0]=w.e=0,w;if(k==0?(U.length=V,O=1,V--):(U.length=V+1,O=ie[u-k],U[V]=W>0?o(L/ie[M-W]%ie[W])*O:0),T)for(;;)if(V==0){for(k=1,W=U[0];W>=10;W/=10,k++);for(W=U[0]+=O,O=1;W>=10;W/=10,O++);k!=O&&(w.e++,U[0]==l&&(U[0]=1));break}else{if(U[V]+=O,U[V]!=l)break;U[V--]=0,O=1}for(k=U.length;U[--k]===0;U.pop());}w.e>Ne?w.c=w.e=null:w.e<vt&&(w.c=[w.e=0])}return w}function G(w){var b,R=w.e;return R===null?w.toString():(b=S(w.c),b=R<=ee||R>=ue?H(b,R):$(b,R,"0"),w.s<0?"-"+b:b)}return A.absoluteValue=A.abs=function(){var w=new m(this);return w.s<0&&(w.s=1),w},A.comparedTo=function(w,b){return E(this,new m(w,b))},A.decimalPlaces=A.dp=function(w,b){var R,T,M,k=this;if(w!=null)return C(w,0,f),b==null?b=se:C(b,0,8),B(new m(k),w+k.e+1,b);if(!(R=k.c))return null;if(T=((M=R.length-1)-v(this.e/u))*u,M=R[M])for(;M%10==0;M/=10,T--);return T<0&&(T=0),T},A.dividedBy=A.div=function(w,b){return x(this,new m(w,b),X,se)},A.dividedToIntegerBy=A.idiv=function(w,b){return x(this,new m(w,b),0,1)},A.exponentiatedBy=A.pow=function(w,b){var R,T,M,k,W,O,L,V,j,U=this;if(w=new m(w),w.c&&!w.isInteger())throw Error(s+"Exponent not an integer: "+G(w));if(b!=null&&(b=new m(b)),O=w.e>14,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!w.c||!w.c[0])return j=new m(Math.pow(+G(U),O?w.s*(2-I(w)):+G(w))),b?j.mod(b):j;if(L=w.s<0,b){if(b.c?!b.c[0]:!b.s)return new m(NaN);T=!L&&U.isInteger()&&b.isInteger(),T&&(U=U.mod(b))}else{if(w.e>9&&(U.e>0||U.e<-1||(U.e==0?U.c[0]>1||O&&U.c[1]>=24e7:U.c[0]<8e13||O&&U.c[0]<=9999975e7)))return k=U.s<0&&I(w)?-0:0,U.e>-1&&(k=1/k),new m(L?1/k:k);rt&&(k=i(rt/u+2))}for(O?(R=new m(.5),L&&(w.s=1),V=I(w)):(M=Math.abs(+G(w)),V=M%2),j=new m(Q);;){if(V){if(j=j.times(U),!j.c)break;k?j.c.length>k&&(j.c.length=k):T&&(j=j.mod(b))}if(M){if(M=o(M/2),M===0)break;V=M%2}else if(w=w.times(R),B(w,w.e+1,1),w.e>14)V=I(w);else{if(M=+G(w),M===0)break;V=M%2}U=U.times(U),k?U.c&&U.c.length>k&&(U.c.length=k):T&&(U=U.mod(b))}return T?j:(L&&(j=Q.div(j)),b?j.mod(b):k?B(j,rt,se,W):j)},A.integerValue=function(w){var b=new m(this);return w==null?w=se:C(w,0,8),B(b,b.e+1,w)},A.isEqualTo=A.eq=function(w,b){return E(this,new m(w,b))===0},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(w,b){return E(this,new m(w,b))>0},A.isGreaterThanOrEqualTo=A.gte=function(w,b){return(b=E(this,new m(w,b)))===1||b===0},A.isInteger=function(){return!!this.c&&v(this.e/u)>this.c.length-2},A.isLessThan=A.lt=function(w,b){return E(this,new m(w,b))<0},A.isLessThanOrEqualTo=A.lte=function(w,b){return(b=E(this,new m(w,b)))===-1||b===0},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return this.s>0},A.isZero=function(){return!!this.c&&this.c[0]==0},A.minus=function(w,b){var R,T,M,k,W=this,O=W.s;if(w=new m(w,b),b=w.s,!O||!b)return new m(NaN);if(O!=b)return w.s=-b,W.plus(w);var L=W.e/u,V=w.e/u,j=W.c,U=w.c;if(!L||!V){if(!j||!U)return j?(w.s=-b,w):new m(U?W:NaN);if(!j[0]||!U[0])return U[0]?(w.s=-b,w):new m(j[0]?W:se==3?-0:0)}if(L=v(L),V=v(V),j=j.slice(),O=L-V){for((k=O<0)?(O=-O,M=j):(V=L,M=U),M.reverse(),b=O;b--;M.push(0));M.reverse()}else for(T=(k=(O=j.length)<(b=U.length))?O:b,O=b=0;b<T;b++)if(j[b]!=U[b]){k=j[b]<U[b];break}if(k&&(M=j,j=U,U=M,w.s=-w.s),b=(T=U.length)-(R=j.length),b>0)for(;b--;j[R++]=0);for(b=l-1;T>O;){if(j[--T]<U[T]){for(R=T;R&&!j[--R];j[R]=b);--j[R],j[T]+=l}j[T]-=U[T]}for(;j[0]==0;j.splice(0,1),--V);return j[0]?F(w,j,V):(w.s=se==3?-1:1,w.c=[w.e=0],w)},A.modulo=A.mod=function(w,b){var R,T,M=this;return w=new m(w,b),!M.c||!w.s||w.c&&!w.c[0]?new m(NaN):!w.c||M.c&&!M.c[0]?new m(M):(Ct==9?(T=w.s,w.s=1,R=x(M,w,0,3),w.s=T,R.s*=T):R=x(M,w,0,Ct),w=M.minus(R.times(w)),!w.c[0]&&Ct==1&&(w.s=M.s),w)},A.multipliedBy=A.times=function(w,b){var R,T,M,k,W,O,L,V,j,U,ie,oe,be,Fe,Ve,Re=this,ye=Re.c,Je=(w=new m(w,b)).c;if(!ye||!Je||!ye[0]||!Je[0])return!Re.s||!w.s||ye&&!ye[0]&&!Je||Je&&!Je[0]&&!ye?w.c=w.e=w.s=null:(w.s*=Re.s,!ye||!Je?w.c=w.e=null:(w.c=[0],w.e=0)),w;for(T=v(Re.e/u)+v(w.e/u),w.s*=Re.s,L=ye.length,U=Je.length,L<U&&(be=ye,ye=Je,Je=be,M=L,L=U,U=M),M=L+U,be=[];M--;be.push(0));for(Fe=l,Ve=d,M=U;--M>=0;){for(R=0,ie=Je[M]%Ve,oe=Je[M]/Ve|0,W=L,k=M+W;k>M;)V=ye[--W]%Ve,j=ye[W]/Ve|0,O=oe*V+j*ie,V=ie*V+O%Ve*Ve+be[k]+R,R=(V/Fe|0)+(O/Ve|0)+oe*j,be[k--]=V%Fe;be[k]=R}return R?++T:be.splice(0,1),F(w,be,T)},A.negated=function(){var w=new m(this);return w.s=-w.s||null,w},A.plus=function(w,b){var R,T=this,M=T.s;if(w=new m(w,b),b=w.s,!M||!b)return new m(NaN);if(M!=b)return w.s=-b,T.minus(w);var k=T.e/u,W=w.e/u,O=T.c,L=w.c;if(!k||!W){if(!O||!L)return new m(M/0);if(!O[0]||!L[0])return L[0]?w:new m(O[0]?T:M*0)}if(k=v(k),W=v(W),O=O.slice(),M=k-W){for(M>0?(W=k,R=L):(M=-M,R=O),R.reverse();M--;R.push(0));R.reverse()}for(M=O.length,b=L.length,M-b<0&&(R=L,L=O,O=R,b=M),M=0;b;)M=(O[--b]=O[b]+L[b]+M)/l|0,O[b]=l===O[b]?0:O[b]%l;return M&&(O=[M].concat(O),++W),F(w,O,W)},A.precision=A.sd=function(w,b){var R,T,M,k=this;if(w!=null&&w!==!!w)return C(w,1,f),b==null?b=se:C(b,0,8),B(new m(k),w,b);if(!(R=k.c))return null;if(M=R.length-1,T=M*u+1,M=R[M]){for(;M%10==0;M/=10,T--);for(M=R[0];M>=10;M/=10,T++);}return w&&k.e+1>T&&(T=k.e+1),T},A.shiftedBy=function(w){return C(w,-c,c),this.times("1e"+w)},A.squareRoot=A.sqrt=function(){var w,b,R,T,M,k=this,W=k.c,O=k.s,L=k.e,V=X+4,j=new m("0.5");if(O!==1||!W||!W[0])return new m(!O||O<0&&(!W||W[0])?NaN:W?k:1/0);if(O=Math.sqrt(+G(k)),O==0||O==1/0?(b=S(W),(b.length+L)%2==0&&(b+="0"),O=Math.sqrt(+b),L=v((L+1)/2)-(L<0||L%2),O==1/0?b="5e"+L:(b=O.toExponential(),b=b.slice(0,b.indexOf("e")+1)+L),R=new m(b)):R=new m(O+""),R.c[0]){for(L=R.e,O=L+V,O<3&&(O=0);;)if(M=R,R=j.times(M.plus(x(k,M,V,1))),S(M.c).slice(0,O)===(b=S(R.c)).slice(0,O))if(R.e<L&&--O,b=b.slice(O-3,O+1),b=="9999"||!T&&b=="4999"){if(!T&&(B(M,M.e+X+2,0),M.times(M).eq(k))){R=M;break}V+=4,O+=4,T=1}else{(!+b||!+b.slice(1)&&b.charAt(0)=="5")&&(B(R,R.e+X+2,1),w=!R.times(R).eq(k));break}}return B(R,R.e+X+1,se,w)},A.toExponential=function(w,b){return w!=null&&(C(w,0,f),w++),y(this,w,b,1)},A.toFixed=function(w,b){return w!=null&&(C(w,0,f),w=w+this.e+1),y(this,w,b)},A.toFormat=function(w,b,R){var T,M=this;if(R==null)w!=null&&b&&typeof b=="object"?(R=b,b=null):w&&typeof w=="object"?(R=w,w=b=null):R=at;else if(typeof R!="object")throw Error(s+"Argument not an object: "+R);if(T=M.toFixed(w,b),M.c){var k,W=T.split("."),O=+R.groupSize,L=+R.secondaryGroupSize,V=R.groupSeparator||"",j=W[0],U=W[1],ie=M.s<0,oe=ie?j.slice(1):j,be=oe.length;if(L&&(k=O,O=L,L=k,be-=k),O>0&&be>0){for(k=be%O||O,j=oe.substr(0,k);k<be;k+=O)j+=V+oe.substr(k,O);L>0&&(j+=V+oe.slice(k)),ie&&(j="-"+j)}T=U?j+(R.decimalSeparator||"")+((L=+R.fractionGroupSize)?U.replace(new RegExp("\\d{"+L+"}\\B","g"),"$&"+(R.fractionGroupSeparator||"")):U):j}return(R.prefix||"")+T+(R.suffix||"")},A.toFraction=function(w){var b,R,T,M,k,W,O,L,V,j,U,ie,oe=this,be=oe.c;if(w!=null&&(O=new m(w),!O.isInteger()&&(O.c||O.s!==1)||O.lt(Q)))throw Error(s+"Argument "+(O.isInteger()?"out of range: ":"not an integer: ")+G(O));if(!be)return new m(oe);for(b=new m(Q),V=R=new m(Q),T=L=new m(Q),ie=S(be),k=b.e=ie.length-oe.e-1,b.c[0]=h[(W=k%u)<0?u+W:W],w=!w||O.comparedTo(b)>0?k>0?b:V:O,W=Ne,Ne=1/0,O=new m(ie),L.c[0]=0;j=x(O,b,0,1),M=R.plus(j.times(T)),M.comparedTo(w)!=1;)R=T,T=M,V=L.plus(j.times(M=V)),L=M,b=O.minus(j.times(M=b)),O=M;return M=x(w.minus(R),T,0,1),L=L.plus(M.times(V)),R=R.plus(M.times(T)),L.s=V.s=oe.s,k=k*2,U=x(V,T,k,se).minus(oe).abs().comparedTo(x(L,R,k,se).minus(oe).abs())<1?[V,T]:[L,R],Ne=W,U},A.toNumber=function(){return+G(this)},A.toPrecision=function(w,b){return w!=null&&C(w,1,f),y(this,w,b,2)},A.toString=function(w){var b,R=this,T=R.s,M=R.e;return M===null?T?(b="Infinity",T<0&&(b="-"+b)):b="NaN":(w==null?b=M<=ee||M>=ue?H(S(R.c),M):$(S(R.c),M,"0"):w===10&&g?(R=B(new m(R),X+M+1,se),b=$(S(R.c),R.e,"0")):(C(w,2,mn.length,"Base"),b=z($(S(R.c),M,"0"),10,w,T,!0)),T<0&&R.c[0]&&(b="-"+b)),b},A.valueOf=A.toJSON=function(){return G(this)},A._isBigNumber=!0,P!=null&&m.set(P),m}function v(P){var x=P|0;return P>0||P===x?x:x-1}function S(P){for(var x,z,K=1,A=P.length,Q=P[0]+"";K<A;){for(x=P[K++]+"",z=u-x.length;z--;x="0"+x);Q+=x}for(A=Q.length;Q.charCodeAt(--A)===48;);return Q.slice(0,A+1||1)}function E(P,x){var z,K,A=P.c,Q=x.c,X=P.s,se=x.s,ee=P.e,ue=x.e;if(!X||!se)return null;if(z=A&&!A[0],K=Q&&!Q[0],z||K)return z?K?0:-se:X;if(X!=se)return X;if(z=X<0,K=ee==ue,!A||!Q)return K?0:!A^z?1:-1;if(!K)return ee>ue^z?1:-1;for(se=(ee=A.length)<(ue=Q.length)?ee:ue,X=0;X<se;X++)if(A[X]!=Q[X])return A[X]>Q[X]^z?1:-1;return ee==ue?0:ee>ue^z?1:-1}function C(P,x,z,K){if(P<x||P>z||P!==o(P))throw Error(s+(K||"Argument")+(typeof P=="number"?P<x||P>z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(P))}function I(P){var x=P.c.length-1;return v(P.e/u)==x&&P.c[x]%2!=0}function H(P,x){return(P.length>1?P.charAt(0)+"."+P.slice(1):P)+(x<0?"e":"e+")+x}function $(P,x,z){var K,A;if(x<0){for(A=z+".";++x;A+=z);P=A+P}else if(K=P.length,++x>K){for(A=z,x-=K;--x;A+=z);P+=A}else x<K&&(P=P.slice(0,x)+"."+P.slice(x));return P}n=p(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(Z9)})(cL);var hL=cL.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const vi=HT(),C6=OT(),y6=xT,S6=hL,yn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Ld={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:dL,decimalSuffixes:pm}=vi.currentBytes(),AT={general:{scale:1024,suffixes:pm},binary:{scale:1024,suffixes:dL},decimal:{scale:1e3,suffixes:pm}};function b6(t,e={},n){if(typeof e=="string"&&(e=y6.parseFormat(e)),!C6.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=R6(t,e,n);return s=B6(s,i),s=j6(s,o),s}function R6(t,e,n){switch(e.output){case"currency":return e=wu(e,vi.currentCurrencyDefaultFormat()),x6(t,e,vi);case"percent":return e=wu(e,vi.currentPercentageDefaultFormat()),O6(t,e,vi,n);case"byte":return e=wu(e,vi.currentByteDefaultFormat()),M6(t,e,vi,n);case"time":return e=wu(e,vi.currentTimeDefaultFormat()),P6(t);case"ordinal":return e=wu(e,vi.currentOrdinalDefaultFormat()),I6(t,e,vi);case"number":default:return $d({instance:t,providedFormat:e})}}function E6(t){let e=AT.decimal;return Ap(t._value,e.suffixes,e.scale).suffix}function T6(t){let e=AT.binary;return Ap(t._value,e.suffixes,e.scale).suffix}function _6(t){let e=AT.general;return Ap(t._value,e.suffixes,e.scale).suffix}function Ap(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function M6(t,e,n,r){let i=e.base||"binary",o=Object.assign({},Ld,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||pm,marker:"bd"},binary:{scale:1024,suffixes:s||dL,marker:"b"},decimal:{scale:1e3,suffixes:a||pm,marker:"d"}}[i],{value:c,suffix:h}=Ap(t._value,u.suffixes,u.scale);return`${$d({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function I6(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Ld,e),o=$d({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function P6(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function O6(t,e,n,r){let i=e.prefixSymbol,o=$d({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Ld,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function x6(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},Ld,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=$d({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function H6({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&yn[e]?(a=r[e],t=t/yn[e]):l>=yn.trillion||n&&s(l/yn.trillion)===1?(a=r.trillion,t=t/yn.trillion):l<yn.trillion&&l>=yn.billion||n&&s(l/yn.billion)===1?(a=r.billion,t=t/yn.billion):l<yn.billion&&l>=yn.million||n&&s(l/yn.million)===1?(a=r.million,t=t/yn.million):(l<yn.million&&l>=yn.thousand||n&&s(l/yn.thousand)===1)&&(a=r.thousand,t=t/yn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function A6({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function xf(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function N6(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+xf(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(xf(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=xf(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${xf(e)}`),n}function D6(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?N6(t,e):new S6(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function k6(t,e,n,r,i,o){if(r===-1)return t;let s=D6(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function L6(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function $6(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function F6(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),$6(u.length,a).forEach((f,p)=>{u=u.slice(0,f+p)+s+u.slice(f+p)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function V6(t,e){return t+e}function W6(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function B6(t,e){return e+t}function j6(t,e){return t+e}function $d({instance:t,providedFormat:e,state:n=vi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Ld,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,p=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,v=s.trimMantissa,S=s.thousandSeparated,E=s.spaceSeparated,C=s.negative,I=s.forceSign,H=s.exponential,$=s.roundingFunction,P="";if(d){let z=H6({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:$,totalLength:a});o=z.value,P+=z.abbreviation,a&&(f=z.mantissaPrecision)}if(H){let z=A6({value:o,characteristicPrecision:l});o=z.value,P=z.abbreviation+P}let x=k6(o.toString(),o,p,f,v,$);return x=L6(x,o,u,l),x=F6(x,o,S,n,r),(d||H)&&(x=V6(x,P)),(I||o<0)&&(x=W6(x,o,C)),x}function wu(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var U6=t=>({format:(...e)=>b6(...e,t),getByteUnit:(...e)=>_6(...e,t),getBinaryByteUnit:(...e)=>T6(...e,t),getDecimalByteUnit:(...e)=>E6(...e,t),formatOrDefault:wu});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ts=hL;function z6(t,e,n){let r=new ts(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ts(i),t._value=r.plus(i).toNumber(),t}function fL(t,e,n){let r=new ts(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ts(i),t._value=r.minus(i).toNumber(),t}function Y6(t,e,n){let r=new ts(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ts(i),t._value=r.times(i).toNumber(),t}function G6(t,e,n){let r=new ts(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ts(i),t._value=r.dividedBy(i).toNumber(),t}function q6(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function K6(t,e,n){let r=n(t._value);return fL(r,e,n),Math.abs(r._value)}var X6=t=>({add:(e,n)=>z6(e,n,t),subtract:(e,n)=>fL(e,n,t),multiply:(e,n)=>Y6(e,n,t),divide:(e,n)=>G6(e,n,t),set:(e,n)=>q6(e,n,t),difference:(e,n)=>K6(e,n,t),BigNumber:ts});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Z6="2.5.0",vo=HT(),Q6=OT(),J6=v6(jt),e8=uL();let ya=U6(jt),Ya=X6(jt);const t8=xT;class gL{constructor(e){this._value=e}clone(){return jt(this._value)}format(e={}){return ya.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=t8.parseFormat(e)),e=ya.formatOrDefault(e,vo.currentCurrencyDefaultFormat()),e.output="currency",ya.format(this,e)}formatTime(e={}){return e.output="time",ya.format(this,e)}binaryByteUnits(){return ya.getBinaryByteUnit(this)}decimalByteUnits(){return ya.getDecimalByteUnit(this)}byteUnits(){return ya.getByteUnit(this)}difference(e){return Ya.difference(this,e)}add(e){return Ya.add(this,e)}subtract(e){return Ya.subtract(this,e)}multiply(e){return Ya.multiply(this,e)}divide(e){return Ya.divide(this,e)}set(e){return Ya.set(this,mL(e))}value(){return this._value}valueOf(){return this._value}}function mL(t){let e=t;return jt.isNumbro(t)?e=t._value:typeof t=="string"?e=jt.unformat(t):isNaN(t)&&(e=NaN),e}function jt(t){return new gL(mL(t))}jt.version=Z6;jt.isNumbro=function(t){return t instanceof gL};jt.language=vo.currentLanguage;jt.registerLanguage=vo.registerLanguage;jt.setLanguage=vo.setLanguage;jt.languages=vo.languages;jt.languageData=vo.languageData;jt.zeroFormat=vo.setZeroFormat;jt.defaultFormat=vo.currentDefaults;jt.setDefaults=vo.setDefaults;jt.defaultCurrencyFormat=vo.currentCurrencyDefaultFormat;jt.validate=Q6.validate;jt.loadLanguagesInNode=J6.loadLanguagesInNode;jt.unformat=e8.unformat;jt.BigNumber=Ya.BigNumber;var n8=jt,Sa=Q9(n8);const r8="numeric";function pL(t,e){if(An(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!Sa.languages()[r]){const o=r.replace("-",""),s=Sa.allLanguages?Sa.allLanguages[r]:Sa[o];s&&Sa.registerLanguage(s)}Sa.setLanguage(r),t=Sa(t).format(i||"0")}return t}function NT(t,e,n,r,i,o,s){let a=o;if(An(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=pL(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}ls(t,e,n,r,i,a,s)}NT.RENDERER_TYPE=r8;const i8="password";function DT(t,e,n,r,i,o,s){ls.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";de(a-1,()=>{u+=l}),Rl(e,u)}DT.RENDERER_TYPE=i8;const o8="select";function kT(t,e,n,r,i,o,s){ls.apply(this,[t,e,n,r,i,o,s])}kT.RENDERER_TYPE=o8;const s8="time";function LT(t,e,n,r,i,o,s){ls.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}LT.RENDERER_TYPE=s8;function a8(){Rr(ac),Rr(kd),Rr(MT),Rr(_T),Rr(PT),Rr(TT),Rr(NT),Rr(DT),Rr(kT),Rr(ls),Rr(LT)}const l8="autocomplete";function Np(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,PH(n,e)):PH(n,e)(this.source):e(!0)}Np.VALIDATOR_TYPE=l8;function PH(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function wL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const u8=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:wL},Symbol.toStringTag,{value:"Module"})),c8="date";function $T(t,e){const n=zD(tL,this.instance);let r=t,i=!0;r==null&&(r="");let o=q(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=q(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=h8(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}$T.VALIDATOR_TYPE=c8;function h8(t,e){const n=q(wL(t)),r=q(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const d8="dropdown";function FT(t,e){Np.apply(this,[t,e])}FT.VALIDATOR_TYPE=d8;const f8="numeric";function VT(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:An(t))}VT.VALIDATOR_TYPE=f8;const g8=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],m8="time";function WT(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=q(i,g8,!0).isValid()?q(i):q(i,n);let a=s.isValid(),l=q(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}WT.VALIDATOR_TYPE=m8;function p8(){Xa(Np),Xa(FT),Xa($T),Xa(VT),Xa(WT)}const w8="autocomplete",v8={CELL_TYPE:w8,editor:RT,renderer:ac,validator:Np},C8="checkbox",y8={CELL_TYPE:C8,editor:eL,renderer:MT},S8="date";function vL(t,e,n,r,i,o,s){ac.apply(this,[t,e,n,r,i,o,s])}vL.RENDERER_TYPE=S8;const b8="date",R8={CELL_TYPE:b8,editor:nL,renderer:vL,validator:$T},E8="dropdown",T8={CELL_TYPE:E8,editor:rL,renderer:_T,validator:FT,filter:!1,strict:!0},_8="handsontable",M8={CELL_TYPE:_8,editor:bT,renderer:PT},I8="numeric",P8={CELL_TYPE:I8,editor:iL,renderer:NT,validator:VT,dataType:"number"},O8="password",x8={CELL_TYPE:O8,editor:oL,renderer:DT,copyable:!1},H8="select",A8={CELL_TYPE:H8,editor:sL,renderer:kT},N8="time",D8={CELL_TYPE:N8,editor:aL,renderer:LT,validator:WT};function k8(){Fr(v8),Fr(y8),Fr(R8),Fr(T8),Fr(M8),Fr(P8),Fr(x8),Fr(A8),Fr(Qk),Fr(D8)}function L8(t,e){CL(t,e),e.add(t)}function $8(t,e,n){CL(t,e),e.set(t,n)}function CL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vl(t,e,n){return(e=F8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F8(t){var e=V8(t,"string");return typeof e=="symbol"?e:e+""}function V8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wl(t,e){return t.get(yL(t,e))}function yL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OH=new Map([["plugin",SG],["cell-type",Fk],["editor",UD],["renderer",QD],["validator",JD]]),SL=Symbol("mainSetting"),W8="base",Hf=[];let ba=null;var Ra=new WeakMap,xH=new WeakSet;class Ue{static get PLUGIN_KEY(){return W8}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){L8(this,xH),Vl(this,"eventManager",new Qr(this)),Vl(this,"pluginName",null),Vl(this,"pluginsInitializedCallbacks",[]),Vl(this,"isPluginsReady",!1),Vl(this,"enabled",!1),Vl(this,"initialized",!1),$8(this,Ra,{}),wo(this,"hot",e,{writable:!1}),ba=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!OH.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);OH.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Hf.push(o)}}if(ba||(ba=EE()),ba.indexOf(this.pluginName)>=0&&ba.splice(ba.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ba.length===0){if(Hf.length>0){const i=[`${Hf.join(`
`)}
`,"You have to import and register them manually."].join("");throw Hf.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||Pe(n))&&r[SL]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(Pe(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){Wl(Ra,this)[e]=Wl(Ra,this)[e]||[];const i=Wl(Ra,this)[e];this.hot.addHook(e,n,r),i.push(n),Wl(Ra,this)[e]=i}removeHooks(e){_(Wl(Ra,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Wl(Ra,this);Oe(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){_(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=yL(xH,this,B8).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Oe(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function B8(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Ea(t,e,n){return(e=j8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j8(t){var e=U8(t,"string");return typeof e=="symbol"?e:e+""}function U8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let BT=class{constructor(e){Ea(this,"hot",null),Ea(this,"container",null),Ea(this,"injected",!1),Ea(this,"rows",[]),Ea(this,"columns",[]),Ea(this,"samples",null),Ea(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&Y(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),_(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),_(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{_(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{_(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{_(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),_(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{_(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),Y(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return Y(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Af(t,e,n){return(e=z8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z8(t){var e=Y8(t,"string");return typeof e=="symbol"?e:e+""}function Y8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dp{static get SAMPLE_COUNT(){return 3}constructor(e){Af(this,"samples",null),Af(this,"dataFactory",null),Af(this,"customSampleCount",null),Af(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Dp.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return de(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return de(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Pe(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${wt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function G8(t,e){bL(t,e),e.add(t)}function Ny(t,e,n){bL(t,e),e.set(t,n)}function bL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $c(t,e,n){return(e=q8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q8(t){var e=K8(t,"string");return typeof e=="symbol"?e:e+""}function K8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ws(t,e){return t.get(hr(t,e))}function wm(t,e,n){return t.set(hr(t,e),n),n}function hr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("modifyAutoColumnSizeSeed");const Dy="autoColumnSize",X8=10,Z8="autoColumnSize";var jT=new WeakMap,vu=new WeakMap,Gu=new WeakMap,Tr=new WeakSet;class Hh extends Ue{static get PLUGIN_KEY(){return Dy}static get PLUGIN_PRIORITY(){return X8}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),G8(this,Tr),$c(this,"ghostTable",new BT(this.hot)),$c(this,"samplesGenerator",new Dp((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),$c(this,"inProgress",!1),$c(this,"measuredColumns",0),$c(this,"columnWidthsMap",new sa),Ny(this,jT,!1),Ny(this,vu,[]),Ny(this,Gu,[]),this.hot.columnIndexMapper.registerMap(Z8,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>hr(Tr,this,HH).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Dy]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hr(Tr,e,e7).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hr(Tr,e,t7).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hr(Tr,e,r7).call(e,...i)}),this.addHook("beforeRender",()=>hr(Tr,this,J8).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>hr(Tr,this,n7).call(this)),super.enablePlugin()}updatePlugin(){wm(Gu,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>hr(Tr,this,HH).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;de(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&hr(Tr,this,RL).call(this,s,o)}),this.ghostTable.columns.length&&(hr(Tr,this,EL).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Jh(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Hh.CALCULATION_STEP,i)},e,n),r=r+Hh.CALCULATION_STEP+1,r<i?o=Qh(s):(Jh(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Dy];let n=Hh.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Pe(e)&&(n=e.syncLimit,JR(n)?n=bE(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Bu))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Ws(vu,this).length;return(s-1<o||Ws(vu,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Ws(vu,this).push(i):Ws(vu,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Q8(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||hr(Tr,this,RL).call(this,n,e))}),this.ghostTable.columns.length&&(hr(Tr,this,EL).call(this),this.ghostTable.clean())}function RL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function EL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function J8(){this.calculateVisibleColumnsWidth(),this.inProgress||(hr(Tr,this,Q8).call(this,Ws(Gu,this)),wm(Gu,this,[]))}function e7(t,e){e||this.recalculateAllColumnsWidth()}function t7(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Ws(Gu,this).push(...e)}function HH(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function n7(){wm(vu,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),wm(jT,this,!0)}function r7(t){if(!Ws(jT,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Ws(Gu,this).push(...e)}const el={horizontal:"horizontal",vertical:"vertical"};function i7(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function o7(t){const e={};return t===!0?(e.directions=Object.keys(el),e.autoInsertRow=!0):Pe(t)?(ae(t.autoInsertRow)?t.direction===el.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ae(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(el)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function s7(t,e){a7(t,e),e.add(t)}function a7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bl(t,e,n){return(e=l7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l7(t){var e=u7(t,"string");return typeof e=="symbol"?e:e+""}function u7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("modifyAutofillRange");ne.getSingleton().register("beforeAutofill");ne.getSingleton().register("afterAutofill");const AH="autofill",c7=20,h7=["fillHandle"],d7="insert_row_below",f7=200;var jl=new WeakSet;class g7 extends Ue{constructor(){super(...arguments),s7(this,jl),Bl(this,"addingStarted",!1),Bl(this,"mouseDownOnCellCorner",!1),Bl(this,"mouseDragOutside",!1),Bl(this,"handleDraggedCells",0),Bl(this,"directions",[]),Bl(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return AH}static get PLUGIN_PRIORITY(){return c7}static get SETTING_KEYS(){return[AH,...h7]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Fc(jl,this,p7).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Fc(jl,this,m7).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Fc(jl,this,w7).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return _(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),_(a,c=>{const h=[];_(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=i7(l,u,(f,p)=>this.hot._createCellCoords(f,p));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),p=o.clone(),v=this.hot._createCellRange(h,h,d),S=this.hot.runHooks("beforeAutofill",f,p,v,c);if(S===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=S;const C=S;if(["up","left"].indexOf(c)>-1&&!(C.length===1&&C[0].length===0))if(E=[],c==="up"){const I=d.row-h.row+1,H=I%C.length;for(let $=0;$<I;$++)E.push(C[($+(C.length-H))%C.length])}else{const I=d.col-h.col+1,H=I%C[0].length;for(let $=0;$<C.length;$++){E.push([]);for(let P=0;P<I;P++)E[$].push(C[$][(P+(C[$].length-H))%C[$].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,p,v,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(el.vertical)&&this.directions.includes(el.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(el.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(el.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(d7,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},f7)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!kt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!kt(s)||!kt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Le(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=bn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+qt(this.hot.table),i=bn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Bt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Fc(jl,this,v7).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Fc(jl,this,C7).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=o7(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function m7(){this.selectAdjacent()&&this.fillIn()}function p7(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function w7(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function v7(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function C7(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function y7(t,e){TL(t,e),e.add(t)}function NH(t,e,n){TL(t,e),e.set(t,n)}function TL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ul(t,e,n){return(e=S7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S7(t){var e=b7(t,"string");return typeof e=="symbol"?e:e+""}function b7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _L(t,e,n){return t.set(no(t,e),n),n}function vm(t,e){return t.get(no(t,e))}function no(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ky="autoRowSize",R7=40,E7="autoRowSize";var od=new WeakMap,UT=new WeakMap,ko=new WeakSet;class Ah extends Ue{static get PLUGIN_KEY(){return ky}static get PLUGIN_PRIORITY(){return R7}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),y7(this,ko),Ul(this,"headerHeight",null),Ul(this,"ghostTable",new BT(this.hot)),Ul(this,"samplesGenerator",new Dp((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),Ul(this,"inProgress",!1),Ul(this,"measuredRows",0),Ul(this,"rowHeightsMap",new sa),NH(this,od,[]),NH(this,UT,!1),this.hot.rowIndexMapper.registerMap(E7,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>no(ko,this,DH).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[ky];return e===!0||Pe(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return no(ko,e,M7).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return no(ko,e,I7).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return no(ko,e,O7).call(e,...i)}),this.addHook("beforeRender",()=>no(ko,this,_7).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>no(ko,this,P7).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>no(ko,this,DH).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}de(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Jh(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Ah.CALCULATION_STEP,i)},e,n),r=r+Ah.CALCULATION_STEP+1,r<i?o=Qh(s):(Jh(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[ky];let n=Ah.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Pe(e)&&(n=e.syncLimit,JR(n)?n=bE(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{de(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function T7(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function _7(){this.calculateVisibleRowsHeight(),this.inProgress||(no(ko,this,T7).call(this,vm(od,this)),_L(od,this,[]))}function DH(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function M7(t,e){e||this.recalculateAllRowsHeight()}function I7(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);vm(od,this).push(...e)}function P7(){this.recalculateAllRowsHeight(),_L(UT,this,!0)}function O7(t){if(!vm(UT,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);vm(od,this).push(...e)}const{getListWithInsertedItems:x7,getListWithRemovedItems:H7}=Sk("physicallyIndexed");class A7 extends El{constructor(){super(e=>e)}insert(e,n){const r=qE(this.indexedValues,n);this.indexedValues=x7(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=H7(this.indexedValues,e);this.indexedValues=GE(n,e),super.remove(e)}}const{getListWithInsertedItems:N7,getListWithRemovedItems:D7}=Sk("physicallyIndexed");class k7 extends El{constructor(){super(e=>e)}insert(e,n){this.indexedValues=N7(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=D7(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function L7(t,e){$7(t,e),e.add(t)}function $7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function F7(t,e,n){return(e=V7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V7(t){var e=W7(t,"string");return typeof e=="symbol"?e:e+""}function W7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B7(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kH="bindRowsWithHeaders",j7=210,U7="loose",LH=new Map([["loose",A7],["strict",k7]]);var $H=new WeakSet;class z7 extends Ue{constructor(){super(...arguments),L7(this,$H),F7(this,"headerIndexes",null)}static get PLUGIN_KEY(){return kH}static get PLUGIN_PRIORITY(){return j7}isEnabled(){return!!this.hot.getSettings()[kH]}enablePlugin(){var e;if(this.enabled)return;const n=(e=LH.get(this.getSetting()))!==null&&e!==void 0?e:LH.get(U7);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>B7($H,this,Y7).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Y7(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function G7(t,e){ML(t,e),e.add(t)}function q7(t,e,n){ML(t,e),e.set(t,n)}function ML(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FH(t,e,n){return(e=K7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K7(t){var e=X7(t,"string");return typeof e=="symbol"?e:e+""}function X7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VH(t,e){return t.get(Tu(t,e))}function Ly(t,e,n){return t.set(Tu(t,e),n),n}function Tu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fg="collapsibleColumns",Z7=290,Q7=["nestedHeaders"],Du="collapsibleIndicator",WH=Fg,BH=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var zl=new WeakMap,Vc=new WeakSet;class J7 extends Ue{constructor(){super(...arguments),G7(this,Vc),FH(this,"nestedHeadersPlugin",null),FH(this,"headerStateManager",null),q7(this,zl,null)}static get PLUGIN_KEY(){return Fg}static get PLUGIN_PRIORITY(){return Z7}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Fg,...Q7]}isEnabled(){return!!this.hot.getSettings()[Fg]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Ke("You need to configure the Nested Headers plugin in order to use collapsible headers."),Ly(zl,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Tu(Vc,this,n5).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Tu(Vc,e,r5).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Tu(Vc,e,e5).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Tu(Vc,this,t5).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ly(zl,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:WH,relativeToGroup:aa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(WH)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};de(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;de(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Du}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Du}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Du}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!BH.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Xs(e,f=>{let{row:p}=f;return p<0});let i=r.length>0;_(r,f=>{var p;let{row:v,col:S}=f;const{collapsible:E,isCollapsed:C}=(p=this.headerStateManager.getHeaderSettings(v,S))!==null&&p!==void 0?p:{};if(!E||C&&n==="collapse"||!C&&n==="expand")return i=!1,!1});const o=[],s=[];i&&_(r,f=>{let{row:p,col:v}=f;const{colspanCompensation:S,affectedColumns:E,rollbackModification:C}=this.headerStateManager.triggerNodeModification(n,p,v);S>0&&(s.push(...E),o.push(C))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=iD([...a,...s]):n==="expand"&&(l=Xs(a,f=>!s.includes(f)));const u=BH.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){_(o,f=>{f()});return}this.hot.batchExecution(()=>{_(s,f=>{VH(zl,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:p}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(p))&&s.includes(p)){const S=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=p>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(p,1,!0):p;S!==null&&E!==null&&this.hot.selectCell(S,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return VH(zl,this).getHiddenIndexes()}destroy(){Ly(zl,this,null),super.destroy()}}function e5(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Du}`);if(bl(e,[Xr("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),Y(u,Du),e.querySelector("div:first-child").appendChild(u)),me(u,["collapsed","expanded"]),s?(Y(u,"collapsed"),Qs(u,"+"),l&&ve(e,...Xr(!1))):(Y(u,"expanded"),Qs(u,"-"),l&&ve(e,...Xr(!0))),l&&ve(u,...Sl());else{var c;(c=u)===null||c===void 0||c.remove()}}function t5(t,e){Ce(t.target,Du)&&(Ce(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ce(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),ii(t))}function n5(){this.updatePlugin()}function r5(t,e){e||this.updatePlugin()}function Ta(t,e,n){return(e=i5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i5(t){var e=o5(t,"string");return typeof e=="symbol"?e:e+""}function o5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const s5=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],a5=!1,l5=!0,u5=!0;class c5{constructor(e,n){Ta(this,"hot",void 0),Ta(this,"sortingStates",new _p),Ta(this,"sortEmptyCells",a5),Ta(this,"indicator",l5),Ta(this,"headerAction",u5),Ta(this,"compareFunctionFactory",void 0),Ta(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Pe(e)&&Oe(e,(n,r)=>{s5.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Pe(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ae(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function IL(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?uo:kt(i)?kt(o)?uo:s&&t==="asc"?Nt:Dt:kt(o)?s&&t==="asc"?Dt:Nt:isNaN(i)&&!isNaN(o)?t==="asc"?Dt:Nt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Nt:Dt:i>o?t==="asc"?Dt:Nt:uo}}const PL="default";function h5(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return uo;if(a){if(kt(r))return t==="asc"?Nt:Dt;if(kt(i))return t==="asc"?Dt:Nt}return isNaN(o)?Dt:isNaN(s)?Nt:o<s?t==="asc"?Nt:Dt:o>s?t==="asc"?Dt:Nt:uo}}const d5="numeric";function f5(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=kt(s),u=kt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Dt;if(l===!1&&u)return Nt}return d===!1&&f?t==="asc"?Nt:Dt:d&&f===!1?t==="asc"?Dt:Nt:d===!1&&f===!1?IL(t,e,n)(s,a):c===i&&h===r?t==="asc"?Nt:Dt:c===r&&h===i?t==="asc"?Dt:Nt:uo}}const g5="checkbox";function m5(t,e,n){return DL(t,e.dateFormat,n)}const p5="date";function w5(t,e,n){return DL(t,e.timeFormat,n)}const v5="time",{register:Fd,getItem:jH,hasItem:C5}=oi("sorting.compareFunctionFactory"),{register:OL,getItem:y5}=oi("sorting.mainSortComparator");function xL(t){return C5(t)?jH(t):jH(PL)}Fd(g5,f5);Fd(p5,m5);Fd(PL,IL);Fd(d5,h5);Fd(v5,w5);const uo=0,Nt=-1,Dt=1;function S5(t,e){const n=y5(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Cm="asc",ym="desc",HL="colHeader";function b5(t){if(Pe(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Cm,ym].includes(n)}function R5(t){if(t.some(n=>b5(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function UH(t){if(t!==ym)return t===Cm?ym:Cm}function AL(t){return t.querySelector(`.${HL}`)}function NL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function zT(t,e,n){return t===-1&&e>=0&&Js(n)===!1}function DL(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return uo;if(kt(r))return kt(i)?uo:o&&t==="asc"?Nt:Dt;if(kt(i))return o&&t==="asc"?Dt:Nt;const s=q(r,e),a=q(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Nt:Dt:a.isBefore(s)?t==="asc"?Dt:Nt:uo:Nt:Dt}}function E5(t,e){Ke(nt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const T5="ascending",_5="descending",kL="indicatorDisabled",LL="columnSorting",$L="sortAction",FL=new Map([[Cm,T5],[ym,_5]]);function M5(t,e,n,r){const i=[LL];if(r&&i.push($L),n===!1)return i.push(kL),i;const o=t.getSortOrderOfColumn(e);return ae(o)&&i.push(FL.get(o)),i}function I5(){return Array.from(FL.values()).concat($L,kL,LL)}function P5(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:xL(u.type))(l,u,d)(c,h)}(0)}}function O5(t,e){x5(t,e),e.add(t)}function x5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nf(t,e,n){return(e=H5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H5(t){var e=A5(t,"string");return typeof e=="symbol"?e:e+""}function A5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sm="columnSorting",N5=50,bm="append",D5="replace",zH=Sm;OL(Sm,P5);ne.getSingleton().register("beforeColumnSort");ne.getSingleton().register("afterColumnSort");const Wc=new WeakMap;var Ga=new WeakSet;class VL extends Ue{constructor(){super(...arguments),O5(this,Ga),Nf(this,"columnStatesManager",null),Nf(this,"columnMetaCache",null),Nf(this,"pluginKey",Sm),Nf(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Sm}static get PLUGIN_PRIORITY(){return N5}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Wc.has(this.hot)&&Wc.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),E5(Wc.get(this.hot),this.pluginKey);return}this.enabled||(Wc.set(this.hot,this.pluginKey),this.columnStatesManager=new c5(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new sa(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Cu(Ga,this,k5).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cu(Ga,e,$5).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Cu(Ga,this,jb).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cu(Ga,e,L5).call(e,...r)}),this.hot.view&&Cu(Ga,this,jb).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=AL(r);NL(n,r)===!1||i===null||this.updateHeaderClasses(i)};Wc.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:aa,position:"before",group:zH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zH)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new bk),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ae(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return R5(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Le(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ae(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Le(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ae(n)){const i=UH(n);return ae(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:UH()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bm;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Rt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===bm)return[...o.slice(0,r),...o.slice(r+1),s];if(n===D5)return[...o.slice(0,r),s,...o.slice(r+1)]}return ae(s)?o.concat(s):o}getPluginColumnConfig(e){if(Pe(e)){const n=e[this.pluginKey];if(Pe(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):tt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Le(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Le(n,u=>u[0]);S5(n,this.pluginKey,Le(e,u=>u.sortOrder),Le(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Le(n,u=>u[0]),a=new Map(Le(o,(u,c)=>[u,s[c]])),l=Le(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Pe(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Pe(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(me(e,I5()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Y(e,M5(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ae(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Ce(e.target,HL)}onAfterOnCellMouseDown(e,n){if(zT(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function jb(){const t=this.getAllSavedSortSettings();if(Pe(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function k5(t,e){const n=AL(e);if(NL(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);ve(e,...zz(s?`${s}ending`:"none"))}}function L5(t){t===!0&&this.hot.view&&Cu(Ga,this,jb).call(this)}function $5(t,e,n,r){zT(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function _a(t,e,n){return(e=F5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F5(t){var e=V5(t,"string");return typeof e=="symbol"?e:e+""}function V5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W5{constructor(e,n){_a(this,"plugin",void 0),_a(this,"hot",void 0),_a(this,"endpoints",[]),_a(this,"settings",void 0),_a(this,"settingsType","array"),_a(this,"currentEndpoint",null),_a(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),_(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();_(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;_(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?_(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):_(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){_(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];_(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),_(i,o=>{let s=[];_(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,_(e.ranges,r=>{_(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],_(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],_(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],_(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&_(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),_(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ke("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function $y(t){return t==null||isNaN(t)}function B5(t,e){j5(t,e),e.add(t)}function j5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U5(t,e,n){return(e=z5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z5(t){var e=Y5(t,"string");return typeof e=="symbol"?e:e+""}function Y5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Df(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fy="columnSummary",G5=220;var Bc=new WeakSet;class q5 extends Ue{constructor(){super(...arguments),B5(this,Bc),U5(this,"endpoints",null)}static get PLUGIN_KEY(){return Fy}static get PLUGIN_PRIORITY(){return G5}isEnabled(){return!!this.hot.getSettings()[Fy]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Fy],this.endpoints=new W5(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Df(Bc,e,K5).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Df(Bc,e,Z5).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Df(Bc,e,X5).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Df(Bc,e,Q5).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Oe(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=$y(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Oe(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=$y(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=$y(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Oe(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(nt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function K5(){this.endpoints.initEndpoints()}function X5(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function Z5(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Q5(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function J5(t,e){WL(t,e),e.add(t)}function Vy(t,e,n){WL(t,e),e.set(t,n)}function WL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yu(t,e){return t.get(YT(t,e))}function Ub(t,e,n){return t.set(YT(t,e),n),n}function YT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rm=new WeakMap,kf=new WeakMap,Lf=new WeakMap,YH=new WeakSet;class BL{constructor(){J5(this,YH),Vy(this,Rm,!0),Vy(this,kf,null),Vy(this,Lf,new ResizeObserver(e=>YT(YH,this,eZ).call(this,e)))}setObservedElement(e){Ub(kf,this,e)}unobserve(){yu(Lf,this).unobserve(yu(kf,this))}observe(){Ub(Rm,this,!0),yu(Lf,this).observe(yu(kf,this))}destroy(){yu(Lf,this).disconnect()}}function eZ(t){if(yu(Rm,this)||!Array.isArray(t)||!t.length){Ub(Rm,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}st(BL,Rn);function ds(t,e,n){tZ(t,e),e.set(t,n)}function tZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lt(t,e){return t.get(jL(t,e))}function Vi(t,e,n){return t.set(jL(t,e),n),n}function jL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yl=new WeakMap,Wy=new WeakMap,By=new WeakMap,Oo=new WeakMap,fs=new WeakMap,gs=new WeakMap,$f=new WeakMap,Gl=new WeakMap;class tl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,r){var i=this;ds(this,Yl,void 0),ds(this,Wy,void 0),ds(this,By,!1),ds(this,Oo,null),ds(this,fs,void 0),ds(this,gs,void 0),ds(this,$f,!0),ds(this,Gl,new BL),Vi(Yl,this,e),Vi(Wy,this,r),Vi(By,this,n),Vi(fs,this,this.createEditor()),Vi(gs,this,lt(fs,this).style),lt(Gl,this).setObservedElement(this.getInputElement()),lt(Gl,this).addLocalHook("resize",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){lt(gs,this).left=`${e}px`,lt(gs,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:Bt(this.getInputElement()),height:qt(this.getInputElement())}}observeSize(){lt(Gl,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){lt(gs,this).display="block",Vi($f,this,!1)}hide(){lt(Gl,this).unobserve(),lt($f,this)||(lt(gs,this).display="none"),Vi($f,this,!0)}isVisible(){return lt(gs,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return lt(Yl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=lt(Yl,this).createElement("div"),n=lt(Yl,this).createElement("textarea");return e.style.display="none",Vi(Oo,this,lt(Yl,this).createElement("div")),lt(Oo,this).setAttribute("dir",lt(By,this)?"rtl":"ltr"),Y(lt(Oo,this),tl.CLASS_EDITOR_CONTAINER),lt(Wy,this).appendChild(lt(Oo,this)),Y(e,tl.CLASS_EDITOR),Y(n,tl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),lt(Oo,this).appendChild(e),e}getInputElement(){return lt(fs,this).querySelector(`.${tl.CLASS_INPUT}`)}getEditorElement(){return lt(fs,this)}destroy(){const e=lt(Oo,this)?lt(Oo,this).parentNode:null;lt(fs,this).parentNode.removeChild(lt(fs,this)),Vi(fs,this,null),Vi(gs,this,null),lt(Gl,this).destroy(),e&&e.removeChild(lt(Oo,this))}}st(tl,Rn);function jy(t,e,n){return(e=nZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nZ(t){var e=rZ(t,"string");return typeof e=="symbol"?e:e+""}function rZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const iZ=250,oZ=250;class UL{constructor(e){jy(this,"wasLastActionShow",!0),jy(this,"showDebounced",null),jy(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},oZ)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:iZ;this.showDebounced=Od(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}st(UL,Rn);function sZ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function aZ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ma(t,e){const n={};return _(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Is(t,e,n,r,i){_(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&lZ(s,a,e,n,r,i)})})}function lZ(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=sZ(s.className,r):a=aZ(s.className,r)),o(t,e,"className",a)}function zL(t){return`<span class="selected">â</span>${t}`}function Vg(t,e){let n=!1;return Array.isArray(t)&&_(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function kp(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Ae="---------";function uZ(){return{name:Ae}}const jr="alignment";function cZ(){return{key:jr,name(){return this.getTranslatedPhrase(C0)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${jr}:left`,name(){return this.getTranslatedPhrase(y0)},callback(){const t=this.getSelectedRange(),e=Ma(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${jr}:center`,name(){return this.getTranslatedPhrase(S0)},callback(){const t=this.getSelectedRange(),e=Ma(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${jr}:right`,name(){return this.getTranslatedPhrase(b0)},callback(){const t=this.getSelectedRange(),e=Ma(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${jr}:justify`,name(){return this.getTranslatedPhrase(R0)},callback(){const t=this.getSelectedRange(),e=Ma(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Ae},{key:`${jr}:top`,name(){return this.getTranslatedPhrase(E0)},callback(){const t=this.getSelectedRange(),e=Ma(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${jr}:middle`,name(){return this.getTranslatedPhrase(T0)},callback(){const t=this.getSelectedRange(),e=Ma(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${jr}:bottom`,name(){return this.getTranslatedPhrase(_0)},callback(){const t=this.getSelectedRange(),e=Ma(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Lp="clear_column";function hZ(){return{key:Lp,name(){return this.getTranslatedPhrase(o0)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Vd="col_left";function dZ(){return{key:Vd,name(){return this.getTranslatedPhrase(JE)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Wd="col_right";function fZ(){return{key:Wd,name(){return this.getTranslatedPhrase(e0)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Bd="make_read_only";function gZ(){return{key:Bd,checkable:!0,ariaChecked(){return Vg(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(hm)},name(){let t=this.getTranslatedPhrase(hm);return Vg(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=zL(t)),t},callback(){const t=this.getSelectedRange(),e=Vg(t,(n,r)=>this.getCellMeta(n,r).readOnly);_(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const $p="redo";function mZ(){return{key:$p,name(){return this.getTranslatedPhrase(i0)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const jd="remove_col";function pZ(){return{key:jd,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(n0,e)},callback(){this.alter("remove_col",B3(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Fp="remove_row";function wZ(){return{key:Fp,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(t0,e)},callback(){this.alter("remove_row",j3(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Vp="row_above";function vZ(){return{key:Vp,name(){return this.getTranslatedPhrase(ZE)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const Wp="row_below";function CZ(){return{key:Wp,name(){return this.getTranslatedPhrase(QE)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const sd="no_items";function yZ(){return{key:sd,name(){return this.getTranslatedPhrase(XE)},disabled:!0,isCommand:!1}}const Bp="undo";function SZ(){return{key:Bp,name(){return this.getTranslatedPhrase(r0)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const bZ=[Vp,Wp,Vd,Wd,Lp,Fp,jd,Bp,$p,Bd,jr,Ae,sd],RZ={[Ae]:uZ,[sd]:yZ,[Vp]:vZ,[Wp]:CZ,[Vd]:dZ,[Wd]:fZ,[Lp]:hZ,[Fp]:wZ,[jd]:pZ,[Bp]:SZ,[$p]:mZ,[Bd]:gZ,[jr]:cZ};function YL(){const t={};return Oe(RZ,(e,n)=>{t[n]=e()}),t}function EZ(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(p0):this.getTranslatedPhrase(m0)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function TZ(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(w0)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function _Z(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(v0);return Vg(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Wg))?zL(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Wg);t.updateCommentMeta(n,r,{[Wg]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function MZ(t,e){GL(t,e),e.add(t)}function ql(t,e,n){GL(t,e),e.set(t,n)}function GL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IZ(t,e,n){return(e=PZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PZ(t){var e=OZ(t,"string");return typeof e=="symbol"?e:e+""}function OZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bs(t,e,n){return t.set(Er(t,e),n),n}function He(t,e){return t.get(Er(t,e))}function Er(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Em="comments",xZ=60,Wo="comment",yh="value",qL="style",Wg="readOnly",jc=Em,zb=`plugin:${Em}`;var ct=new WeakMap,Ji=new WeakMap,jp=new WeakMap,Bg=new WeakMap,Yb=new WeakMap,Tm=new WeakMap,$r=new WeakSet;class HZ extends Ue{constructor(){super(...arguments),MZ(this,$r),IZ(this,"range",{}),ql(this,ct,null),ql(this,Ji,null),ql(this,jp,!1),ql(this,Bg,!1),ql(this,Yb,null),ql(this,Tm,"")}static get PLUGIN_KEY(){return Em}static get PLUGIN_PRIORITY(){return xZ}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Em]}enablePlugin(){var e=this;this.enabled||(He(ct,this)||(Bs(ct,this,new tl(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),He(ct,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Er($r,e,VZ).call(e,...r)}),this.hot.addHook("afterSetTheme",(n,r)=>{r||this.hide()})),He(Ji,this)||Bs(Ji,this,new UL(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Er($r,this,LZ).call(this,n,a)),this.addHook("afterScroll",()=>Er($r,this,WZ).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Er($r,this,GH).call(this,n)),this.addHook("beforeCompositionStart",n=>Er($r,this,GH).call(this,n)),He(Ji,this).addLocalHook("hide",()=>this.hide()),He(Ji,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){He(Ji,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(zb);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Bs(Bg,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(zb),this.hot._registerTimeout(()=>{Bs(Bg,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:jc}),r.addShortcut({keys:[["Escape"]],callback:()=>{He(ct,this).setValue(He(Tm,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(ct,this).isVisible()&&He(ct,this).isFocused(),group:jc}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(ct,this).isVisible()&&He(ct,this).isFocused(),group:jc}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{He(ct,this).setValue(He(ct,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:jc})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jc)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Er($r,this,DZ).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Er($r,this,AZ).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Er($r,this,kZ).call(this)),this.eventManager.addEventListener(n,"focus",()=>Er($r,this,FZ).call(this)),this.eventManager.addEventListener(n,"blur",()=>Er($r,this,$Z).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Er($r,this,NZ).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Zs(e.target,"TD","TBODY");return!!(n&&Ce(n,"htCommentCell")&&Zs(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=He(ct,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[yh]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Wo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,yh)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,yh)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return He(Ji,this).cancelHiding(),He(ct,this).setValue((e=i[Wo]?i[Wo][yh]:null)!==null&&e!==void 0?e:""),He(ct,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){He(ct,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!He(ct,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;He(ct,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,p=d.getCell({row:s,col:a},!0),v=this.getCommentMeta(i,o,qL);v?He(ct,this).setSize(v.width,v.height):He(ct,this).resetSize();const S=c?0:f.getColumnWidth(a),E=l&&!u?qt(p):0,{left:C,top:I,width:H,height:$}=p.getBoundingClientRect(),{width:P,height:x}=He(ct,this).getSize(),{innerWidth:z,innerHeight:K}=this.hot.rootWindow,A=this.hot.rootDocument.documentElement,Q=gn(this.hot.rootDocument),X=fE(this.hot.rootWindow)?Q:0,se=gE(this.hot.rootWindow)?Q:0;let ee=C+h.scrollX+S,ue=I+h.scrollY+E;this.hot.isRtl()&&(ee-=P+S),this.hot.isLtr()&&C+H+P>z-X?ee=C+h.scrollX-P-1:this.hot.isRtl()&&ee<-(A.scrollWidth-A.clientWidth)&&(ee=C+h.scrollX+S+1),I+x>K-se&&(ue-=x-$+1),He(ct,this).setPosition(ee,ue),He(ct,this).setReadOnlyState(this.getCommentMeta(i,o,Wg)),He(ct,this).observeSize()}focusEditor(){He(ct,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Wo];let o;i?(o=Ln(i),Md(o,r)):o=r,this.hot.setCellMeta(e,n,Wo,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Wo])return i[Wo][r]}addToContextMenu(e){e.items.push({name:Ae},EZ(this),TZ(this),_Z(this))}getEditorInputElement(){return He(ct,this).getInputElement()}destroy(){var e,n;(e=He(ct,this))===null||e===void 0||e.destroy(),(n=He(Ji,this))===null||n===void 0||n.destroy(),super.destroy()}}function AZ(t){if(!(!this.hot.view||!this.hot.view._wt)&&!He(jp,this)&&!this.targetIsCommentTextArea(t)){const e=Zs(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function NZ(t){t.stopPropagation()}function DZ(t){const{rootDocument:e}=this.hot;if(!(He(jp,this)||He(ct,this).isFocused()||Ce(t.target,"wtBorder")||He(Yb,this)===t.target||!He(ct,this)))if(Bs(Yb,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));He(Ji,this).show(n)}else Ys(t.target,e)&&!this.targetIsCommentTextArea(t)&&He(Ji,this).hide()}function kZ(){Bs(jp,this,!1)}function LZ(t,e){e[Wo]&&e[Wo][yh]&&Y(t,e.commentedCellClassName)}function $Z(){Bs(Tm,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function FZ(){Bs(Tm,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(zb)}function VZ(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[qL]:{width:t,height:e}})}function GH(t){He(ct,this).isFocused()&&ii(t)}function WZ(){He(Bg,this)||this.hide()}function Uy(t,e,n){return(e=BZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BZ(t){var e=jZ(t,"string");return typeof e=="symbol"?e:e+""}function jZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KL{constructor(e){Uy(this,"hot",void 0),Uy(this,"commands",{}),Uy(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=UZ(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Gt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),_(u,c=>c.apply(this.hot,r))}}function UZ(t,e){let n;return _(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function zy(t,e,n){return(e=zZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zZ(t){var e=YZ(t,"string");return typeof e=="symbol"?e:e+""}function YZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;zy(this,"hot",void 0),zy(this,"predefinedItems",YL()),zy(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Oe(e,(r,i)=>{let o="";r.name===Ae?(n[Ae]=r,o=Ae):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return GZ(e,this.defaultOrderPattern,this.predefinedItems)}}function GZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Pe(i)?Oe(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Pe(o)?Kt(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):_(i,(o,s)=>{let a=n[o];!a&&bZ.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Pe(o)&&Kt(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ms(t,e,n){return(e=qZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qZ(t){var e=KZ(t,"string");return typeof e=="symbol"?e:e+""}function KZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XZ{constructor(e,n){ms(this,"top",void 0),ms(this,"topRelative",void 0),ms(this,"left",void 0),ms(this,"leftRelative",void 0),ms(this,"scrollTop",void 0),ms(this,"scrollLeft",void 0),ms(this,"cellHeight",void 0),ms(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Uc(t,e,n){ZZ(t,e),e.set(t,n)}function ZZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _e(t,e){return t.get(ZL(t,e))}function Ff(t,e,n){return t.set(ZL(t,e),n),n}function ZL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wn=new WeakMap,nr=new WeakMap,rr=new WeakMap,Yy=new WeakMap,Kl=new WeakMap;class QZ{constructor(e){Uc(this,Wn,void 0),Uc(this,nr,void 0),Uc(this,rr,void 0),Uc(this,Yy,!1),Uc(this,Kl,{above:0,below:0,left:0,right:0}),Ff(Yy,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return _e(Kl,this)[e]=n,this}setElement(e){return Ff(Wn,this,e),this}setParentElement(e){return Ff(nr,this,e),this}updatePosition(e){Ff(rr,this,new XZ(e,_e(Wn,this).ownerDocument.defaultView)),_e(Yy,this)?(_e(rr,this).fitsBelow(_e(Wn,this))?this.setPositionBelowCursor():_e(rr,this).fitsAbove(_e(Wn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){_e(Wn,this).dir==="rtl"?_e(rr,this).fitsOnLeft(_e(Wn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():_e(rr,this).fitsOnRight(_e(Wn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=_e(Kl,this).above+_e(rr,this).top-_e(Wn,this).offsetHeight;if(_e(nr,this)){const r=_e(nr,this).ownerDocument.defaultView.getComputedStyle(_e(nr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=_e(rr,this).top+_e(rr,this).cellHeight-_e(Wn,this).scrollHeight+i+o}_e(Wn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=_e(Kl,this).below+_e(rr,this).top+1;if(_e(nr,this)){const r=_e(nr,this).ownerDocument.defaultView.getComputedStyle(_e(nr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=_e(rr,this).top-i-o-1}_e(Wn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=_e(rr,this).left;if(_e(nr,this)){const n=_e(nr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(_e(nr,this).querySelector(".htCore")).borderRightWidth,10);e+=_e(rr,this).cellWidth+r}else e+=_e(Kl,this).right;_e(Wn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=_e(Kl,this).left+_e(rr,this).left-_e(Wn,this).offsetWidth;if(_e(nr,this)){const n=_e(nr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(_e(nr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}_e(Wn,this).style.left=`${e}px`}}function QL(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=We(e,-1,v()-1);function a(E,C){const I=v()-1;return E<0&&(E=I),E>I&&(E=0),o.has(E)?-1:(o.add(E),r(E,!1)===!1&&(E=a(C===1?++E:--E,C)),E)}function l(E){E>-1&&E<v()&&r(E,!0)!==!1&&(s=E)}function u(E){E>-1&&E<v()&&(s=E)}function c(){return s}function h(){v()>0&&(o.clear(),s=a(0,1))}function d(){v()>0&&(o.clear(),s=a(v()-1,-1))}function f(){v()>0&&(o.clear(),s=a(++s,1))}function p(){v()>0&&(o.clear(),s=a(--s,-1))}function v(){return Math.max(n(),0)}function S(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:p,getSize:v,clear:S}}function JZ(t){return Le(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Gb(t){return Gt(t,"submenu")}function qb(t){return new RegExp(Ae,"i").test(t.name)}function jg(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function qH(t){return Gt(t,"disableSelection")}function eQ(t){return Ce(t,"htSeparator")}function tQ(t){return Ce(t,"htSubmenu")}function nQ(t){return Ce(t,"htDisabled")}function rQ(t){return Ce(t,"htSelectionDisabled")}function iQ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function JL(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function oQ(t,e){let n=t.slice(0);return n.reverse(),n=JL(n,e),n.reverse(),n}function sQ(t){const e=[];return _(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function aQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ae,n=t.slice(0);return n=JL(n,e),n=oQ(n,e),n=sQ(n),n}function lQ(t){return t.checkable===!0}function uQ(t){return QL({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||eQ(r)||nQ(r)||rQ(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function cQ(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const e$="menu",KH=e$;function hQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(cQ(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:e$})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(p=>h.removeShortcutsByKeys(p))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${KH}:${u}`:KH}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function dQ(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(ho(n),Y(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!jg(a,t)&&!qH(a)&&!qb(a);ve(n,[...lQ(a)?[kz(),$u(c),fD(h)]:[Dz(),$u(u)],...d?[oa(-1)]:[],...jg(a,t)?[jz()]:[],...Gb(a)?[Xr(!1)]:[]])}n.className="",n.appendChild(l),qb(a)?Y(n,"htSeparator"):typeof a.renderer=="function"?(Y(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Rl(l,u),jg(a,t)?Y(n,"htDisabled"):qH(a)?Y(n,"htSelectionDisabled"):Gb(a)&&Y(n,"htSubmenu")}}function Gy(t,e,n){fQ(t,e),e.set(t,n)}function fQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wi(t,e,n){return(e=gQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gQ(t){var e=mQ(t,"string");return typeof e=="symbol"?e:e+""}function mQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qy(t,e,n){return t.set(t$(t,e),n),n}function ps(t,e){return t.get(t$(t,e))}function t$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const XH=215;var Xl=new WeakMap,Vf=new WeakMap,Wf=new WeakMap;class lc{get tableBorderWidth(){return ps(Wf,this)===void 0&&this.hotMenu&&qy(Wf,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ps(Wf,this)}constructor(e,n){var r=this;Wi(this,"hot",void 0),Wi(this,"options",void 0),Wi(this,"eventManager",new Qr(this)),Wi(this,"container",void 0),Wi(this,"positioner",void 0),Wi(this,"hotMenu",null),Wi(this,"hotSubMenus",{}),Wi(this,"parentMenu",void 0),Wi(this,"menuItems",null),Wi(this,"origOutsideClickDeselects",null),Gy(this,Xl,void 0),Gy(this,Vf,void 0),Gy(this,Wf,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:XH,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new QZ(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(me(this.options.container,/ht-theme-.*/g),Y(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=al(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ps(Xl,this)}getKeyboardShortcutsCtrl(){return ps(Vf,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Od(a=>this.openSubMenu(a),300),n=this.options.minWidth||XH;let r=!1,i=Xs(this.menuItems,a=>(a.key===sd&&(r=!0),iQ(a,this.hot)));if(i.length<1&&!r)i.push(YL()[sd]);else if(i.length===0)return;i=aQ(i,Ae);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ae(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:dQ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?ps(Xl,this).setCurrentPage(l.row):ps(Xl,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),im()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!im()||!Js(a))&&o&&this.hasSelectedItem()&&(Ti()||sE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),qy(Xl,this,uQ(this.hotMenu)),qy(Vf,this,hQ(this)),ps(Vf,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ps(Xl,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);ve(r,[Xr(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!tQ(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new lc(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&ve(n,[Xr(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&ve(i,[Xr(!1)])}}closeAllSubMenus(){_(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?JZ(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||qb(e)||jg(e,this.hot)||Gb(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=an(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?qt(this.hotMenu.getCell(u,0)):0;return a+(l.name===Ae?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(tt(r)&&(r=r.call(this.hot),r===null||Rt(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),Y(i,`htMenu handsontable ${this.options.className}`),r&&Y(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&ve(this.hotMenu.rootElement,[Nz(),oa(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ys(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ys(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ce(e.target,"htCore")&&Ys(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}st(lc,Rn);function pQ(t,e){wQ(t,e),e.add(t)}function wQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ky(t,e,n){return(e=vQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vQ(t){var e=CQ(t,"string");return typeof e=="symbol"?e:e+""}function CQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sh="contextMenu",yQ=70,ZH=Sh;ne.getSingleton().register("afterContextMenuDefaultOptions");ne.getSingleton().register("beforeContextMenuShow");ne.getSingleton().register("afterContextMenuShow");ne.getSingleton().register("afterContextMenuHide");ne.getSingleton().register("afterContextMenuExecute");var zc=new WeakSet;class Up extends Ue{constructor(){super(...arguments),pQ(this,zc),Ky(this,"commandExecutor",new KL(this.hot)),Ky(this,"itemsFactory",null),Ky(this,"menu",null)}static get PLUGIN_KEY(){return Sh}static get PLUGIN_PRIORITY(){return yQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Vp,Wp,Ae,Vd,Wd,Ae,Fp,jd,Ae,Bp,$p,Ae,Bd,Ae,jr]}isEnabled(){return!!this.hot.getSettings()[Sh]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Sh];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new lc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Bf(zc,this,bQ).call(this)),this.menu.addLocalHook("afterOpen",()=>Bf(zc,this,RQ).call(this)),this.menu.addLocalHook("afterClose",()=>Bf(zc,this,EQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Bf(zc,this,SQ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=kp(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:ZH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ZH)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Oe(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new XL(this.hot,Up.DEFAULT_ITEMS);const e=this.hot.getSettings()[Sh],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),_(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function SQ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Ce(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(Ce(o,"current")&&Ce(o,"wtBorder"))))return;const s=kp(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function bQ(){this.hot.runHooks("beforeContextMenuShow",this)}function RQ(){this.hot.runHooks("afterContextMenuShow",this)}function EQ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Up.SEPARATOR={name:Ae};function TQ(t){return{key:"copy",name(){return this.getTranslatedPhrase(s0)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function _Q(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?We(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(u0,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function MQ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?We(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(l0,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function IQ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?We(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(a0,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function PQ(t){return{key:"cut",name(){return this.getTranslatedPhrase(c0)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class OQ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class xQ{constructor(){this.clipboardData=new OQ}preventDefault(){}composedPath(){return[]}}function HQ(t,e){n$(t,e),e.add(t)}function Zl(t,e,n){n$(t,e),e.set(t,n)}function n$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Un(t,e){return t.get(_u(t,e))}function Ql(t,e,n){return t.set(_u(t,e),n),n}function _u(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ws=new WeakMap,Xy=new WeakMap,Yc=new WeakMap,Kb=new WeakMap,Xb=new WeakMap,Gc=new WeakMap,qc=new WeakSet;class AQ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;HQ(this,qc),Zl(this,ws,void 0),Zl(this,Xy,void 0),Zl(this,Yc,void 0),Zl(this,Kb,void 0),Zl(this,Xb,void 0),Zl(this,Gc,void 0),Ql(Xy,this,n),Ql(Yc,this,r),Ql(Kb,this,i),Ql(Xb,this,o),Ql(Gc,this,s)}setSelectedRange(e){Ql(ws,this,e)}getCellsRange(){if(Un(Xy,this).call(this)===0||Un(Yc,this).call(this)===0)return null;const{row:e,col:n}=Un(ws,this).getTopStartCorner(),{row:r,col:i}=Un(ws,this).getBottomEndCorner(),o=_u(qc,this,NQ).call(this,e,r),s=_u(qc,this,Zy).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Un(Yc,this).call(this)===0||Un(Gc,this).call(this)===0)return null;const{col:e}=Un(ws,this).getTopStartCorner(),{col:n}=Un(ws,this).getBottomEndCorner(),r=_u(qc,this,Zy).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Un(Yc,this).call(this)===0||Un(Gc,this).call(this)===0)return null;const{col:e}=Un(ws,this).getTopStartCorner(),{col:n}=Un(ws,this).getBottomEndCorner(),r=_u(qc,this,Zy).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Un(Gc,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Zy(t,e){return Math.min(e,Math.max(t+Un(Xb,this).call(this)-1,t))}function NQ(t,e){return Math.min(e,Math.max(t+Un(Kb,this).call(this)-1,t))}function r$(t){const e=[],n=[];return _(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);de(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);de(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function DQ(t,e){i$(t,e),e.add(t)}function vs(t,e,n){i$(t,e),e.set(t,n)}function i$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kc(t,e,n){return(e=kQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kQ(t){var e=LQ(t,"string");return typeof e=="symbol"?e:e+""}function LQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cr(t,e){return t.get(dr(t,e))}function pi(t,e,n){return t.set(dr(t,e),n),n}function dr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("afterCopyLimit");ne.getSingleton().register("modifyCopyableRange");ne.getSingleton().register("beforeCut");ne.getSingleton().register("afterCut");ne.getSingleton().register("beforePaste");ne.getSingleton().register("afterPaste");ne.getSingleton().register("beforeCopy");ne.getSingleton().register("afterCopy");const Qy="copyPaste",$Q=80,FQ=["fragmentSelection"],QH=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Zb=new WeakMap,Qb=new WeakMap,Jb=new WeakMap,Jl=new WeakMap,jf=new WeakMap,Uf=new WeakMap,eu=new WeakMap,_m=new WeakMap,_r=new WeakSet;class VQ extends Ue{constructor(){super(...arguments),DQ(this,_r),Kc(this,"columnsLimit",1/0),Kc(this,"rowsLimit",1/0),Kc(this,"pasteMode","overwrite"),Kc(this,"uiContainer",this.hot.rootDocument.body),vs(this,Zb,!1),vs(this,Qb,!1),vs(this,Jb,!1),vs(this,Jl,"cells-only"),vs(this,jf,!1),vs(this,Uf,!1),vs(this,eu,new AQ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),vs(this,_m,!1),Kc(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Qy}static get SETTING_KEYS(){return[Qy,...FQ]}static get PLUGIN_PRIORITY(){return $Q}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Qy]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),pi(Zb,this,this.getSetting("copyColumnHeaders")),pi(Qb,this,this.getSetting("copyColumnGroupHeaders")),pi(Jb,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>dr(_r,this,jQ).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return dr(_r,r,UQ).call(r,...o)}),this.addHook("afterSelectionEnd",()=>dr(_r,this,zQ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),Vu()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return dr(_r,r,YQ).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return dr(_r,r,GQ).call(r,...o)}),this.addHook("afterSelection",()=>dr(_r,this,qQ).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";pi(Jl,this,e),pi(jf,this,!0),dr(_r,this,JH).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){pi(Uf,this,!0),dr(_r,this,JH).call(this,"cut")}getRangedCopyableData(e){return Oh(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=r$(e);return _(r,o=>{const s=[];_(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new xQ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}cr(eu,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);cr(Jl,this)==="column-headers-only"?n.set("headers",cr(eu,this).getMostBottomColumnHeadersRange()):(cr(Jl,this)==="with-column-headers"?n.set("headers",cr(eu,this).getMostBottomColumnHeadersRange()):cr(Jl,this)==="with-column-group-headers"&&n.set("headers",cr(eu,this).getAllColumnHeadersRange()),n.set("cells",cr(eu,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:p,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,p===!0)continue;d=v,h=a;const S=[],E=o.length%r;for(;S.length<i||h<=u;){const{skipColumnOnPaste:C,visualCol:I}=this.hot.getCellMeta(s,h);if(h=I+1,C===!0)continue;f=I;const H=S.length%i;S.push(e[E][H])}o.push(S)}return pi(_m,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!cr(jf,this)||this.isEditorOpened()||lo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Mh(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),pi(jf,this,!1);const o=this.getRangedData(this.copyableRanges),s=dr(_r,this,WQ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=Oh(o);if(e&&e.clipboardData){const u=Tb(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[QH,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}pi(Jl,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!cr(Uf,this)||this.isEditorOpened()||lo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Mh(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),pi(Uf,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=Oh(o);if(e&&e.clipboardData){const l=Tb(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[QH,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||lo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Mh(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=hp(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=qD(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=q3(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function JH(t){if(Vu()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&DD(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function WQ(t){const{rows:e}=r$(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function BQ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&pE(r)}}}function o$(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&wE(r)}}}function jQ(t){t.items.push({name:"---------"},TQ(this)),cr(Zb,this)&&t.items.push(IQ(this)),cr(Qb,this)&&t.items.push(MQ(this)),cr(Jb,this)&&t.items.push(_Q(this)),t.items.push(PQ(this))}function UQ(t,e,n,r,i){cr(_m,this)&&(i.value=!0),pi(_m,this,!1)}function zQ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function YQ(){dr(_r,this,o$).call(this)}function GQ(){dr(_r,this,BQ).call(this)}function qQ(){dr(_r,this,o$).call(this)}function s$(t,e){return`border_row${t}col${e}`}function bh(){return{width:1,color:"#000"}}function qo(){return{hide:!0}}function KQ(){return{width:1,color:"#000",cornerVisible:!1}}function Jy(t){if(ae(t.start)||ae(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ae(t.end)||ae(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Xc(t){return ae(t.start)&&(t.left=t.start),ae(t.end)&&(t.right=t.end),t}function eS(t,e){return{id:s$(t,e),border:KQ(),row:t,col:e,top:qo(),bottom:qo(),start:qo(),end:qo()}}function XQ(t,e){return Gt(e,"border")&&e.border&&(t.border=e.border),Gt(e,"top")&&ae(e.top)&&(e.top?(Pe(e.top)||(e.top=bh()),t.top=e.top):(e.top=qo(),t.top=e.top)),Gt(e,"bottom")&&ae(e.bottom)&&(e.bottom?(Pe(e.bottom)||(e.bottom=bh()),t.bottom=e.bottom):(e.bottom=qo(),t.bottom=e.bottom)),Gt(e,"start")&&ae(e.start)&&(e.start?(Pe(e.start)||(e.start=bh()),t.start=e.start):(e.start=qo(),t.start=e.start)),Gt(e,"end")&&ae(e.end)&&(e.end?(Pe(e.end)||(e.end=bh()),t.end=e.end):(e.end=qo(),t.end=e.end)),t}function ns(t,e){let n=!1;return _(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Gt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function zp(t){return`<span class="selected">â</span>${t}`}function ZQ(t){return t.some(e=>ae(e.left)||ae(e.right))}function QQ(t){return t.some(e=>ae(e.start)||ae(e.end))}const JQ=new Map([["left","start"],["right","end"]]);function eJ(t){var e;return(e=JQ.get(t))!==null&&e!==void 0?e:t}function tJ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(O0);return ns(this,"bottom")&&(e=zp(e)),e},callback(e,n){const r=ns(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function nJ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(x0);return ns(this,e)&&(n=zp(n)),n},callback(n,r){const i=ns(this,e);t.prepareBorder(r,e,i)}}}function rJ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(H0)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!ns(this)}}}function iJ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(P0);return ns(this,e)&&(n=zp(n)),n},callback(n,r){const i=ns(this,e);t.prepareBorder(r,e,i)}}}function oJ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(I0);return ns(this,"top")&&(e=zp(e)),e},callback(e,n){const r=ns(this,"top");t.prepareBorder(n,"top",r)}}}function sJ(t,e){aJ(t,e),e.add(t)}function aJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lJ(t,e,n){return(e=uJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uJ(t){var e=cJ(t,"string");return typeof e=="symbol"?e:e+""}function cJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function e1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ug="customBorders",hJ=90;var tS=new WeakSet;class dJ extends Ue{constructor(){super(...arguments),sJ(this,tS),lJ(this,"savedBorders",[])}static get PLUGIN_KEY(){return Ug}static get PLUGIN_PRIORITY(){return hJ}isEnabled(){return!!this.hot.getSettings()[Ug]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>e1(tS,this,fJ).call(this,e)),this.addHook("init",()=>e1(tS,this,gJ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Jy(n));const o=ju(e),s=rd(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});_(e,a=>{s(a).forAll((l,u)=>{_(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,eJ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=ju(e),r=rd(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return _(e,o=>{r(o).forAll((s,a)=>{_(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Xc(l))})})}),i}clearBorders(e){e?this.setBorders(e):(_(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=eS(e,n);r&&(a=XQ(a,r),_(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Xc(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);de(e.from.row,r,o=>{de(e.from.col,i,s=>{const a=eS(o,s);let l=0;o===e.from.row&&Gt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Gt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Gt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Gt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Xc(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=s$(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=eS(e,n):o=Jy(o),i?(o[r]=qo(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Xc(o)))):(o[r]=bh(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Xc(o)))}prepareBorder(e,n,r){_(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":de(o.col,s.col,a=>{de(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":de(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":de(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":de(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":de(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){_(e,n=>{const r=Jy(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return an([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Le(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){_(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){_(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Le(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):_(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return _(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return _(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):_(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);_(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Ug];if(Array.isArray(e)){const n=Ln(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=ZQ(e),r=QQ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function fJ(t){this.hot.getSettings()[Ug]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(M0)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[oJ(this),iJ(this),tJ(this),nJ(this),rJ(this)]}})}function gJ(){this.changeBorderSettings()}function mJ(t,e){pJ(t,e),e.add(t)}function pJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nS(t,e,n){return(e=wJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wJ(t){var e=vJ(t,"string");return typeof e=="symbol"?e:e+""}function vJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function t1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const n1="dragToScroll",CJ=100;var rS=new WeakSet;class yJ extends Ue{constructor(){super(...arguments),mJ(this,rS),nS(this,"boundaries",null),nS(this,"callback",null),nS(this,"listening",!1)}static get PLUGIN_KEY(){return n1}static get PLUGIN_PRIORITY(){return CJ}isEnabled(){return!!this.hot.getSettings()[n1]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>t1(rS,this,r1).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>t1(rS,this,r1).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=al(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function r1(t){if(Js(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function SJ(t,e){a$(t,e),e.add(t)}function bJ(t,e,n){a$(t,e),e.set(t,n)}function a$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iS(t,e,n){return(e=RJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RJ(t){var e=EJ(t,"string");return typeof e=="symbol"?e:e+""}function EJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TJ(t,e){return t.get(Ur(t,e))}function l$(t,e,n){return t.set(Ur(t,e),n),n}function Ur(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("afterDropdownMenuDefaultOptions");ne.getSingleton().register("beforeDropdownMenuShow");ne.getSingleton().register("afterDropdownMenuShow");ne.getSingleton().register("afterDropdownMenuHide");ne.getSingleton().register("afterDropdownMenuExecute");const zg="dropdownMenu",_J=230,ad="changeType",oS=zg;var Yp=new WeakMap,Ci=new WeakSet;class Gp extends Ue{static get PLUGIN_KEY(){return zg}static get PLUGIN_PRIORITY(){return _J}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Vd,Wd,Ae,jd,Ae,Lp,Ae,Bd,Ae,jr]}constructor(e){super(e),SJ(this,Ci),iS(this,"commandExecutor",new KL(this.hot)),iS(this,"itemsFactory",null),iS(this,"menu",null),bJ(this,Yp,!1),this.hot.addHook("afterGetColHeader",(n,r)=>Ur(Ci,this,IJ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[zg]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new XL(this.hot,Gp.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ur(Ci,e,NJ).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ur(Ci,e,AJ).call(e,...o)});const n=this.hot.getSettings()[zg],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new lc(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Ur(Ci,this,PJ).call(this)),this.menu.addLocalHook("afterOpen",()=>Ur(Ci,this,OJ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Ur(Ci,this,xJ).call(this,o)),this.menu.addLocalHook("afterClose",()=>Ur(Ci,this,HJ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),_(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=kp(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${ad}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:oS},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:oS}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(oS)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Ur(Ci,this,MJ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Oe(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function u$(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function MJ(t){if(Ce(t.target,ad)){const e=kp(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),l$(Yp,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function IJ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${ad}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=ad,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(ve(s,[Sl(),$u(" ")]),ve(e,[cD("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function PJ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function OJ(){this.hot.runHooks("afterDropdownMenuShow",this),Ur(Ci,this,u$).call(this,this.menu)}function xJ(t){Ur(Ci,this,u$).call(this,t)}function HJ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function AJ(t){return TJ(Yp,this)?null:t}function NJ(t){Ce(t.target,ad)&&l$(Yp,this,!0)}Gp.SEPARATOR={name:Ae};function i1(t,e,n){return(e=DJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DJ(t){var e=kJ(t,"string");return typeof e=="symbol"?e:e+""}function kJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LJ{constructor(e){i1(this,"hot",void 0),i1(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return de(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(de(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();de(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();de(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function o1(t,e,n){return(e=$J(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $J(t){var e=FJ(t,"string");return typeof e=="symbol"?e:e+""}function FJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GT{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){o1(this,"dataProvider",void 0),o1(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Oi(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=Kt(Oi(GT.DEFAULT_OPTIONS),n),n=Kt(n,e),n.filename=eE(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function VJ(t,e){WJ(t,e),e.add(t)}function WJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const c$="\r",BJ='"',jJ=`
`,UJ="=",zJ="+",YJ="-",GJ="@",qJ="	";var sS=new WeakSet;class KJ extends GT{constructor(){super(...arguments),VJ(this,sS)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Le(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),_(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=wt(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=s1(sS,this,ZJ).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=s1(sS,this,XJ).call(this,i)),(n||i.indexOf(c$)>=0||i.indexOf(BJ)>=0||i.indexOf(jJ)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function XJ(t){return t.startsWith(UJ)||t.startsWith(zJ)||t.startsWith(YJ)||t.startsWith(GJ)||t.startsWith(qJ)||t.startsWith(c$)?`'${t}`:t}function ZJ(t,e){return e.test(t)?`'${t}`:t}const QJ="csv",eR={[QJ]:KJ};function JJ(t,e,n){return typeof eR[t]=="function"?new eR[t](e,n):null}const eee="exportFile",tee=240;class nee extends Ue{static get PLUGIN_KEY(){return eee}static get PLUGIN_PRIORITY(){return tee}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!eR[e])throw new Error(`Export format type "${e}" is not supported.`);return JJ(e,new LJ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function tu(t,e,n){return(e=ree(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ree(t){var e=iee(t,"string");return typeof e=="symbol"?e:e+""}function iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ud{constructor(e,n){let{id:r,stateless:i=!0}=n;tu(this,"hot",void 0),tu(this,"id",void 0),tu(this,"elements",[]),tu(this,"hidden",!1),tu(this,"stateId",""),tu(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new _p)}getElements(){return this.elements}reset(){_(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),_(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}st(Ud,Rn);const ld={};function ea(t,e){if(!ld[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=ld[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function nl(t){if(!ld[t])throw Error(`Filter condition "${t}" does not exist.`);return ld[t].descriptor}function Qt(t,e,n){n.key=t,ld[t]={condition:e,descriptor:n}}const Cn="none";function oee(){return!0}Qt(Cn,oee,{name:Mp,inputsCount:0,showOperators:!1});const Nh="empty";function see(t){return kt(t.value)}Qt(Nh,see,{name:F0,inputsCount:0,showOperators:!0});const Yg="not_empty";function aee(t,e){return!ea(Nh,e)(t)}Qt(Yg,aee,{name:V0,inputsCount:0,showOperators:!0});const Dh="eq";function lee(t,e){let[n]=e;return wt(t.value).toLocaleLowerCase(t.meta.locale)===wt(n)}Qt(Dh,lee,{name:W0,inputsCount:1,showOperators:!0});const Gg="neq";function uee(t,e){return!ea(Dh,e)(t)}Qt(Gg,uee,{name:B0,inputsCount:1,showOperators:!0});const h$="gt";function cee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Qt(h$,cee,{name:G0,inputsCount:1,showOperators:!0});const d$="gte";function hee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Qt(d$,hee,{name:q0,inputsCount:1,showOperators:!0});const f$="lt";function dee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Qt(f$,dee,{name:K0,inputsCount:1,showOperators:!0});const g$="lte";function fee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Qt(g$,fee,{name:X0,inputsCount:1,showOperators:!0});const qT="date_after";function gee(t,e){let[n]=e;const r=q(t.value,t.meta.dateFormat),i=q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Qt(qT,gee,{name:J0,inputsCount:1,showOperators:!0});const KT="date_before";function mee(t,e){let[n]=e;const r=q(t.value,t.meta.dateFormat),i=q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Qt(KT,mee,{name:eT,inputsCount:1,showOperators:!0});const Mm="between";function pee(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=ea(KT,[o]),a=ea(qT,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Qt(Mm,pee,{name:Z0,inputsCount:2,showOperators:!0});const m$="not_between";function wee(t,e){return!ea(Mm,e)(t)}Qt(m$,wee,{name:Q0,inputsCount:2,showOperators:!0});const p$="begins_with";function vee(t,e){let[n]=e;return wt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(wt(n))}Qt(p$,vee,{name:j0,inputsCount:1,showOperators:!0});const w$="ends_with";function Cee(t,e){let[n]=e;return wt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(wt(n))}Qt(w$,Cee,{name:U0,inputsCount:1,showOperators:!0});const XT="contains";function yee(t,e){let[n]=e;return wt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(wt(n))>=0}Qt(XT,yee,{name:z0,inputsCount:1,showOperators:!0});const v$="not_contains";function See(t,e){return!ea(XT,e)(t)}Qt(v$,See,{name:Y0,inputsCount:1,showOperators:!0});const C$="date_tomorrow";function bee(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().subtract(-1,"days").startOf("day"),"d"):!1}Qt(C$,bee,{name:nT,inputsCount:0});const y$="date_today";function Ree(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().startOf("day"),"d"):!1}Qt(y$,Ree,{name:tT,inputsCount:0});const S$="date_yesterday";function Eee(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().subtract(1,"days").startOf("day"),"d"):!1}Qt(S$,Eee,{name:rT,inputsCount:0});wD();function Tee(t,e){let n=t;return n===""&&(n=`(${e})`),n}function zd(t){const e=new Set(t);return function(n){return e.has(n)}}function ZT(t){return t??""}function tR(t){return Array.from(new Set(t)).map(e=>ZT(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function a1(t,e,n,r){const i=[],o=t===e;let s;return o||(s=zd(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Tee(a,n)};r&&r(u),i.push(u)}),i}const rl="by_value";function _ee(t,e){let[n]=e;return n(t.value)}Qt(rl,_ee,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[zd(e)]},showOperators:!1});const ud={};function Mee(t){if(!ud[t])throw Error(`Operation with id "${t}" does not exist.`);const e=ud[t].func;return function(n,r){return e(n,r)}}function Iee(t){return ud[t].name}function QT(t,e,n){ud[t]={name:e,func:n}}const qs="conjunction",Pee=sT;function Oee(t,e){return t.every(n=>n.func(e))}QT(qs,Pee,Oee);const Im="disjunction",xee=Ip;function Hee(t,e){return t.some(n=>n.func(e))}QT(Im,xee,Hee);const JT="disjunctionWithExtraCondition",Aee=Ip;function Nee(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}QT(JT,Aee,Nee);const Dee="numeric",b$="text",kee="date",l1={[Dee]:[Cn,Ae,Nh,Yg,Ae,Dh,Gg,Ae,h$,d$,f$,g$,Mm,m$],[b$]:[Cn,Ae,Nh,Yg,Ae,Dh,Gg,Ae,p$,w$,Ae,XT,v$],[kee]:[Cn,Ae,Nh,Yg,Ae,Dh,Gg,Ae,KT,qT,Mm,Ae,C$,y$,S$]};function Lee(t){const e=[];let n=t;return l1[n]||(n=b$),_(l1[n],r=>{let i;r===Ae?i={name:Ae}:i=Oi(nl(r)),e.push(i)}),e}function Zc(t,e,n){return(e=$ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ee(t){var e=Fee(t,"string");return typeof e=="symbol"?e:e+""}function Fee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const aS="built",lS="building",u1=["click","input","keydown","keypress","keyup","focus","blur","change"];let Mi=class R${static get DEFAULTS(){return Oi({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Zc(this,"hot",void 0),Zc(this,"eventManager",new Qr(this)),Zc(this,"options",void 0),Zc(this,"_element",void 0),Zc(this,"buildState",void 0),this.hot=e,this.options=Kt(R$.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===lS?this._element:this.buildState===aS?(this.update(),this._element):(this.buildState=lS,this.build(),this.buildState=aS,this._element)}isBuilt(){return this.buildState===aS}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Xn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=lS),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Y(this._element,this.options.className),this.options.children.length)_(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Oe(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),_(u1,r=>e(n,r))}else _(u1,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};st(Mi,Rn);function Vee(t,e){E$(t,e),e.add(t)}function Wee(t,e,n){E$(t,e),e.set(t,n)}function E$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zf(t,e){return t.get(e_(t,e))}function Bee(t,e,n){return t.set(e_(t,e),n),n}function e_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nu=new WeakMap,c1=new WeakSet;class Ks extends Mi{static get DEFAULTS(){return Oi({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,Kt(Ks.DEFAULTS,n)),Vee(this,c1),Wee(this,nu,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>e_(c1,this,jee).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Bee(nu,this,this._element.firstChild),Y(this._element,"htUIInput"),Y(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(zf(nu,this).type=this.options.type,zf(nu,this).placeholder=this.translateIfPossible(this.options.placeholder),zf(nu,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&zf(nu,this).focus()}}function jee(t){this.options.value=t.target.value}function Uee(t,e){T$(t,e),e.add(t)}function Qc(t,e,n){T$(t,e),e.set(t,n)}function T$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ru(t,e,n){return t.set(kh(t,e),n),n}function Pt(t,e){return t.get(kh(t,e))}function kh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cn=new WeakMap,Yf=new WeakMap,Gf=new WeakMap,uS=new WeakMap,qf=new WeakMap,Kf=new WeakSet;class cd extends Mi{static get DEFAULTS(){return Oi({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,Kt(cd.DEFAULTS,n)),Uee(this,Kf),Qc(this,cn,null),Qc(this,Yf,[]),Qc(this,Gf,void 0),Qc(this,uS,void 0),Qc(this,qf,void 0),this.registerHooks()}getMenu(){return Pt(cn,this)}registerHooks(){this.addLocalHook("click",()=>kh(Kf,this,Gee).call(this))}setItems(e){ru(Yf,this,this.translateNames(e)),Pt(cn,this)&&Pt(cn,this).setMenuItems(Pt(Yf,this))}translateNames(e){return _(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),ru(cn,this,new lc(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Pt(cn,this).setMenuItems(Pt(Yf,this));const e=new Mi(this.hot,{className:"htUISelectCaption"}),n=new Mi(this.hot,{className:"htUISelectDropdown"});ru(Gf,this,e),ru(uS,this,e.element),ru(qf,this,n),this.hot.getSettings().ariaTags&&(ve(n.element,[Sl()]),ve(this._element,[uD()])),_([e,n],r=>this._element.appendChild(r.element)),Pt(cn,this).addLocalHook("select",r=>kh(Kf,this,zee).call(this,r)),Pt(cn,this).addLocalHook("afterClose",()=>kh(Kf,this,Yee).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Pt(cn,this).hot.getTranslatedPhrase(Mp),Pt(uS,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Pt(cn,this)&&(Pt(cn,this).open(),Pt(cn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Pt(cn,this).getNavigator().toFirstItem(),Pt(cn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Pt(cn,this)&&Pt(cn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Pt(cn,this)&&(Pt(cn,this).destroy(),ru(cn,this,null)),Pt(Gf,this)&&Pt(Gf,this).destroy(),Pt(qf,this)&&Pt(qf,this).destroy(),super.destroy()}}function zee(t){t.name!==Ae&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Yee(){this.runLocalHooks("afterClose")}function Gee(){this.openOptions()}function qee(t,e){Kee(t,e),e.add(t)}function Kee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h1(t,e,n){return(e=Xee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xee(t){var e=Zee(t,"string");return typeof e=="symbol"?e:e+""}function Zee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cS=new WeakSet;class nR extends Ud{constructor(e,n){super(e,{id:n.id,stateless:!1}),qee(this,cS),h1(this,"name",""),h1(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new cd(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Ks(this.hot,{placeholder:dT})),this.elements.push(new Ks(this.hot,{placeholder:fT})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>d1(cS,this,Qee).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),_(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>d1(cS,this,Jee).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Oi(e.command);n.name.startsWith(Lt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),_(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||nl(Cn),n=[];return _(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=nl(e?e.name:Cn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||_(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof cd)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Ks)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Y(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Y(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return Y(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||_(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[nl(Cn)];if(e!==null){const{visualIndex:r}=e;n=Lee(this.hot.getDataType(0,r,this.hot.countRows(),r))}_(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Qee(t){_(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Jee(t){rc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ii(t))}function f1(t,e,n){ete(t,e),e.set(t,n)}function ete(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jc(t,e){return t.get(_$(t,e))}function g1(t,e,n){return t.set(_$(t,e),n),n}function _$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var iu=new WeakMap,hS=new WeakMap;class Pm extends Mi{static get DEFAULTS(){return Oi({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Kt(Pm.DEFAULTS,n)),f1(this,iu,void 0),f1(this,hS,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),g1(hS,this,e),g1(iu,this,this._element.firstChild),Jc(iu,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Jc(hS,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Jc(iu,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Jc(iu,this).checked=e)}focus(){this.isBuilt()&&Jc(iu,this).focus()}}function tte(t,e){nte(t,e),e.add(t)}function nte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rte(t,e,n){return(e=ite(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ite(t){var e=ote(t,"string");return typeof e=="symbol"?e:e+""}function ote(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ste(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const m1=0;var p1=new WeakSet;class ate extends Ud{constructor(e,n){super(e,{id:n.id,stateless:!1}),tte(this,p1),rte(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Y(n.parentNode,"htFiltersMenuOperators"),_(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[qs,Im];_(e,n=>{const r=new Pm(this.hot,{name:"operator",label:{htmlFor:n,textContent:Iee(n)},value:n,checked:n===e[m1],id:n});r.addLocalHook("change",i=>ste(p1,this,lte).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(nt`Radio button with index ${e} doesn't exist.`);_(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Pm&&n.isChecked());return e?e.getValue():qs}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&_(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qs,n=arguments.length>1?arguments[1]:void 0,r=e;r===JT&&(r=Im),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(m1)}}function lte(t){this.setState(t.target.value)}function ute(t,e,n){cte(t,e),e.set(t,n)}function cte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dS(t,e){return t.get(M$(t,e))}function hte(t,e,n){return t.set(M$(t,e),n),n}function M$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var eh=new WeakMap;class hd extends Mi{static get DEFAULTS(){return Oi({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,Kt(hd.DEFAULTS,n)),ute(this,eh,void 0)}build(){super.build(),hte(eh,this,this._element.firstChild)}update(){this.isBuilt()&&(dS(eh,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&dS(eh,this).focus()}activate(){dS(eh,this).click()}}function dte(t,e){I$(t,e),e.add(t)}function ou(t,e,n){I$(t,e),e.set(t,n)}function I$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Me(t,e){return t.get(Mu(t,e))}function di(t,e,n){return t.set(Mu(t,e),n),n}function Mu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const w1="multipleSelect.itemBox";var yi=new WeakMap,zt=new WeakMap,fS=new WeakMap,xo=new WeakMap,Cs=new WeakMap,ys=new WeakMap,th=new WeakSet;class dd extends Mi{static get DEFAULTS(){return Oi({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Kt(dd.DEFAULTS,n)),dte(this,th),ou(this,yi,[]),ou(this,zt,void 0),ou(this,fS,void 0),ou(this,xo,void 0),ou(this,Cs,void 0),ou(this,ys,void 0),di(xo,this,new Ks(this.hot,{placeholder:hT,className:"htUIMultipleSelectSearch"})),di(Cs,this,new hd(this.hot,{textContent:aT,className:"htUISelectAll"})),di(ys,this,new hd(this.hot,{textContent:lT,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Me(zt,this)}registerHooks(){Me(xo,this).addLocalHook("keydown",e=>Mu(th,this,gte).call(this,e)),Me(xo,this).addLocalHook("input",e=>Mu(th,this,fte).call(this,e)),Me(Cs,this).addLocalHook("click",e=>Mu(th,this,mte).call(this,e)),Me(ys,this).addLocalHook("click",e=>Mu(th,this,pte).call(this,e))}setItems(e){var n;di(yi,this,e),(n=Me(zt,this))===null||n===void 0||n.loadData(Me(yi,this))}setLocale(e){di(fS,this,e)}getLocale(){return Me(fS,this)}getItems(){return[...Me(yi,this)]}getValue(){return vte(Me(yi,this))}getSearchInputElement(){return Me(xo,this)}getSelectAllElement(){return Me(Cs,this)}getClearAllElement(){return Me(ys,this)}isSelectedAllValues(){return Me(yi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Mi(this.hot,{className:"htUISelectionControls",children:[Me(Cs,this),Me(ys,this)]});this._element.appendChild(Me(xo,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Me(zt,this))===null||s===void 0||s.destroy(),Y(o,"htUIMultipleSelectHot"),di(zt,this,new this.hot.constructor(o,{data:Me(yi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,p)=>{u.title=p.instance.getDataAtRowProp(c,p.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Me(zt,this).listen()},modifyColWidth:u=>{const c=Me(zt,this).container.scrollWidth-gn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Me(zt,this).init();const l=Me(zt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:w1}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Me(zt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:w1})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Me(zt,this).listen()}reset(){Me(xo,this).reset(),Me(Cs,this).reset(),Me(ys,this).reset()}update(){this.isBuilt()&&(Me(zt,this).loadData(wte(Me(yi,this),this.options.value)),super.update())}destroy(){var e;(e=Me(zt,this))===null||e===void 0||e.destroy(),Me(xo,this).destroy(),Me(ys,this).destroy(),Me(Cs,this).destroy(),di(xo,this,null),di(ys,this,null),di(Cs,this,null),di(zt,this,null),di(yi,this,null),super.destroy()}}function fte(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Me(yi,this)]:n=Me(yi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Me(zt,this).loadData(n)}function gte(t){this.runLocalHooks("keydown",t,this),vE(rc,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),ii(t),Me(zt,this).listen(),Me(zt,this).selectCell(0,0))}function mte(t){const e=[];t.preventDefault(),Me(zt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(BE(n,r)[0])}),Me(zt,this).setSourceDataAtCell(e)}function pte(t){const e=[];t.preventDefault(),Me(zt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(BE(n,r)[0])}),Me(zt,this).setSourceDataAtCell(e)}function wte(t,e){const n=zd(e);return t.map(r=>(r.checked=n(r.value),r))}function vte(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Cte(t,e){yte(t,e),e.add(t)}function yte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ste(t,e,n){return(e=bte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bte(t){var e=Rte(t,"string");return typeof e=="symbol"?e:e+""}function Rte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nh=new WeakSet;class Ete extends Ud{constructor(e,n){super(e,{id:n.id,stateless:!1}),Cte(this,nh),Ste(this,"name",""),this.name=n.name,this.elements.push(new dd(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Xf(nh,this,Tte).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Xf(nh,this,_te).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===rl){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Cn:rl},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Xs(i,h=>h.name===rl),u={},c=this.hot.getTranslatedPhrase(dm);if(l){const h=s(r,a),d=Le(h,C=>C.value),f=new Map(h.map(C=>[C.value,this.hot.getCellMeta(C.meta.visualRow,C.meta.visualCol)])),p=tR(d);o&&(l.args[0]=o);const v=[],S=a1(p,l.args[0],c,C=>{C.checked&&v.push(C.value),Xf(nh,this,v1).call(this,C,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[v],u.command=nl(rl),u.itemsSnapshot=S}else u.args=[],u.command=nl(Cn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof dd)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Y(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return Y(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||_(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(dm),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=tR(r),s=a1(o,o,e,l=>{Xf(nh,this,v1).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Le(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:ZT(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function Tte(t){rc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ii(t))}function v1(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function _te(t,e){switch(e.type){case"numeric":return pL(t,e);default:return t}}var P$;function Mte(t,e){Ite(t,e),e.add(t)}function Ite(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pte(t,e,n){return(e=Ote(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ote(t){var e=xte(t,"string");return typeof e=="symbol"?e:e+""}function xte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hte(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var C1=new WeakSet;class fd extends Ud{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Mte(this,C1),Pte(this,"name",""),this.name=n.name,this.elements.push(new Ks(this.hot,{type:"button",value:uT,className:"htUIButton htUIButtonOK",identifier:fd.BUTTON_OK})),this.elements.push(new Ks(this.hot,{type:"button",value:cT,className:"htUIButton htUIButtonCancel",identifier:fd.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){_(this.elements,e=>{e.addLocalHook("click",(n,r)=>Hte(C1,this,Ate).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Y(n.parentNode,"htFiltersMenuActionBar"),_(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}P$=fd;function Ate(t,e){e.options.identifier===P$.BUTTON_OK?this.accept():this.cancel()}function gS(t,e,n){return(e=Nte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nte(t){var e=Dte(t,"string");return typeof e=="symbol"?e:e+""}function Dte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const y1="ConditionCollection.filteringStates";class t_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;gS(this,"hot",void 0),gS(this,"isMapRegistrable",void 0),gS(this,"filteringStates",new _p),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(y1,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i?.conditions)!==null&&r!==void 0?r:[],s=i?.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:qs;return e.length?Mee(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:qs,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(nt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Rt(ud[r]))throw new Error(nt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:ea(a,s)}]},i):u.push({name:a,args:s,func:ea(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(y1),this.filteringStates=null,this.clearLocalHooks()}}st(t_,Rn);function S1(t,e,n){return(e=kte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kte(t){var e=Lte(t,"string");return typeof e=="symbol"?e:e+""}function Lte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];S1(this,"conditionCollection",void 0),S1(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return _(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return _(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return _(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function $te(t,e){Fte(t,e),e.add(t)}function Fte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ia(t,e,n){return(e=Vte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vte(t){var e=Wte(t,"string");return typeof e=="symbol"?e:e+""}function Wte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zf=new WeakSet;class x${constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];$te(this,Zf),Ia(this,"hot",void 0),Ia(this,"conditionCollection",void 0),Ia(this,"columnDataFactory",void 0),Ia(this,"changes",[]),Ia(this,"grouping",!1),Ia(this,"latestEditedColumnPosition",-1),Ia(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>mS(Zf,this,Bte).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>mS(Zf,this,jte).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>mS(Zf,this,Ute).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,_(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=LD(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new t_(r.hot,!1),p=[].concat(c,d);f.importAllConditions(p);const v=r.columnDataFactory(h);let S;f.isEmpty()?S=v:S=new O$(f,C=>r.columnDataFactory(C)).filter(),S=Le(S,C=>C.meta.visualRow);const E=zd(S);return f.destroy(),Xs(v,C=>E(C.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Oe(this,(e,n)=>{this[n]=null})}}function Bte(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function jte(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Ute(){_(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}st(x$,Rn);function zte(t){return QL({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof dd)return r;if(i.element&&!ll(i.element))return!1;i.focus()}})}const rh="filters";function Yte(t,e){let n=-1,r;const i=zte(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(rh),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof Mi&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(rh),callback:()=>{h.isSubMenu()&&h.close(),d.listen(rh)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:p=>{const v=r.getNavigator();v.getCurrentPage()>-1&&(n=v.getCurrentPage()),v.clear(),p.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:p=>{const v=e[i.getCurrentPage()];v instanceof cd&&(v.openOptions(),p.preventDefault()),v instanceof hd&&(v.activate(),p.preventDefault()),v instanceof Mi||p.preventDefault()}}],rh)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(rh)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function Gte(t,e){H$(t,e),e.add(t)}function pS(t,e,n){H$(t,e),e.set(t,n)}function H$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ih(t,e,n){return(e=qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qte(t){var e=Kte(t,"string");return typeof e=="symbol"?e:e+""}function Kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qg(t,e,n){return t.set(sr(t,e),n),n}function zr(t,e){return t.get(sr(t,e))}function sr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rR="filters",Xte=250,b1=rR;var Lo=new WeakMap,iR=new WeakMap,Za=new WeakMap,vr=new WeakSet;class Zte extends Ue{static get PLUGIN_KEY(){return rR}static get PLUGIN_PRIORITY(){return Xte}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,Gte(this,vr),ih(this,"dropdownMenuPlugin",null),ih(this,"conditionCollection",null),ih(this,"conditionUpdateObserver",null),ih(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),ih(this,"filtersRowsMap",null),pS(this,Lo,void 0),pS(this,iR,new WeakSet),pS(this,Za,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return sr(vr,n,ine).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[rR]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Dd),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>sr(vr,this,R1).call(this,"accept")),a.addLocalHook("cancel",()=>sr(vr,this,R1).call(this,"cancel")),a.addLocalHook("change",l=>sr(vr,this,rne).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(iT)}:`,s=()=>`${this.hot.getTranslatedPhrase(oT)}:`;if(!this.components.get("filter_by_condition")){const a=new nR(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>sr(vr,this,E1).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new ate(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new nR(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>sr(vr,this,E1).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new Ete(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new fd(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new t_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new x$(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>sr(vr,this,one).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return sr(vr,e,nne).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>sr(vr,this,tne).call(this)),this.addHook("afterDropdownMenuShow",()=>sr(vr,this,Jte).call(this)),this.addHook("afterDropdownMenuHide",()=>sr(vr,this,ene).call(this)),this.addHook("afterChange",a=>sr(vr,this,Qte).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!zr(Lo,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=zr(Lo,this).getMenu(),c=u.getNavigator(),h=zr(Lo,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];qg(Lo,this,Yte(this.dropdownMenuPlugin.menu,a));const l=u=>{zr(Lo,this).listen(),u.preventDefault(),rc(u.keyCode,"TAB")&&(u.shiftKey?zr(Lo,this).toPreviousItem():zr(Lo,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:b1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(b1)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:qs;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,zr(Za,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Le(n.filter(),u=>u.meta.visualRow);const l=zd(i);de(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),_(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),qg(Za,this,this.exportConditions())}else s!==!1&&!r?(qg(Za,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(zr(Za,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return _(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:p}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:p},value:ZT(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=tR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Im&&n.command.key!==Cn&&r.command.key!==Cn&&i.command.key!==Cn?o=JT:i.command.key!==Cn&&(n.command.key===Cn||r.command.key===Cn)&&(o=qs),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new O$(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _(i,s=>{_(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Qte(t){t&&_(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Jte(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function ene(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function tne(){const t=this.dropdownMenuPlugin.menu;zr(iR,this).has(t)||zr(Lo,this).setMenu(t),zr(iR,this).add(t)}function nne(t){t.items.push({name:Ae}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function R1(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==Cn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==Cn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==Cn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function rne(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===nR&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function E1(){this.setListeningDropdownMenu()}function ine(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?Y(e,"htFiltersActive"):me(e,"htFiltersActive")}function one(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&qg(Za,this,zr(Za,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===rl),s=n.filter(a=>a.name!==rl);if(o.length>=2||s.length>=3)Ke(nt`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const A$="internal-use-in-handsontable",oR={licenseKey:A$,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function N$(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Nn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function D$(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function sne(t){var e;const n=t[Nn],r=D$(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=N$(t);return{...oR,...r,...i}}function ane(t){var e;const n=t[Nn],r=D$(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=N$(t);return{...r,...i}}function lne(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function qp(){const t="engine_relationship",e=oi(Nn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function n_(){const t="shared_engine_usage",e=oi(Nn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function une(t){const e=t.getSettings(),n=e[Nn],r=n?.engine;if(n===!0||Rt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return cne((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Rt(r.hyperformula)){const o=qp(),s=n_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:A$}),(r.getConfig().leapYear1900!==oR.leapYear1900||fp(r.getConfig().nullDate,oR.nullDate)===!1)&&Ke(nt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function cne(t,e,n){const r=e[Nn],i=sne(e),o=qp(),s=n_();hne(t,r.functions),dne(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),fne(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function T1(t){var e;const n=qp(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function _1(t,e){if(t){const n=qp(),r=n.get(t),i=n_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function hne(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){Ke(s.message)}})}function dne(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){Ke(r.message)}}}function fne(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){Ke(a.message)}}),t.resumeEvaluation())}function gne(t,e){return(Rt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const k$="DD/MM/YYYY";function mne(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function pne(t){return mne(t)?t.substr(1):t}function wne(t){return typeof t=="string"&&t.startsWith("=")}function r_(t,e){return typeof t=="string"&&e==="date"}function L$(t,e){return q(t,e,!0).isValid()}function $$(t,e){return q(t,e,!0).format(k$)}function vne(t,e){return q(t,k$,!0).format(e)}function F$(t,e){const r=new Date(Date.UTC(0,0,t+-1));return q(r).format(e)}function Cne(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function yne(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Sne(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function i_(t,e,n){const r=yne(t,Cne(t,e,n));return Sne(r)}function Pa(t,e,n){bne(t,e),e.set(t,n)}function bne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){return t.get(V$(t,e))}function Ss(t,e,n){return t.set(V$(t,e),n),n}function V$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oh=new WeakMap,bs=new WeakMap,Cr=new WeakMap,Qf=new WeakMap,wS=new WeakMap,vS=new WeakMap,Jf=new WeakMap;class M1{constructor(e,n,r){Pa(this,oh,void 0),Pa(this,bs,void 0),Pa(this,Cr,void 0),Pa(this,Qf,[]),Pa(this,wS,[]),Pa(this,vS,void 0),Pa(this,Jf,[]),Ss(oh,this,e),Ss(bs,this,n),Ss(Cr,this,r)}setRemovedHfIndexes(e){return Ss(Jf,this,e.map(n=>{const r=bt(bs,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),bt(Jf,this)}getRemovedHfIndexes(){return bt(Jf,this)}getHfIndexFromVisualIndex(e){const n=bt(bs,this).getIndexesSequence(),r=bt(bs,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${kn(bt(oh,this))}s`;bt(Cr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&bt(Cr,this).getEngine()[r](bt(Cr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Ss(wS,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Ss(vS,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(bt(Cr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=i_(bt(wS,this),bt(vS,this),bt(bs,this).getNumberOfIndexes());bt(Cr,this).getSheetId()===null?bt(Cr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${kn(bt(oh,this))}Order`;return n=>{if(bt(Cr,this).isPerformingUndoRedo())return;const r=bt(bs,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=bt(Qf,this).map(l=>r.indexOf(l)),o=bt(Cr,this).getEngine().getSheetDimensions(bt(Cr,this).getSheetId());let s;bt(oh,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);bt(Cr,this).getEngine()[e](bt(Cr,this).getSheetId(),i)}Ss(Qf,this,r)}}init(){Ss(Qf,this,bt(bs,this).getIndexesSequence())}}function Oa(t,e,n){Rne(t,e),e.set(t,n)}function Rne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ho(t,e){return t.get(W$(t,e))}function xa(t,e,n){return t.set(W$(t,e),n),n}function W$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var eg=new WeakMap,tg=new WeakMap,CS=new WeakMap,yS=new WeakMap,SS=new WeakMap,bS=new WeakMap,RS=new WeakMap;class Ene{constructor(e,n,r){Oa(this,eg,void 0),Oa(this,tg,void 0),Oa(this,CS,void 0),Oa(this,yS,!1),Oa(this,SS,!1),Oa(this,bS,null),Oa(this,RS,null),xa(eg,this,new M1("row",e,this)),xa(tg,this,new M1("column",n,this)),xa(CS,this,r)}getForAxis(e){return e==="row"?Ho(eg,this):Ho(tg,this)}setPerformUndo(e){xa(yS,this,e)}setPerformRedo(e){xa(SS,this,e)}isPerformingUndoRedo(){return Ho(yS,this)||Ho(SS,this)}getSheetId(){return Ho(RS,this)}getEngine(){return Ho(bS,this)}getPostponeAction(){return Ho(CS,this)}setupSyncEndpoint(e,n){xa(bS,this,e),xa(RS,this,n),Ho(eg,this).init(),Ho(tg,this).init()}}function Tne(t,e){B$(t,e),e.add(t)}function Ha(t,e,n){return(e=_ne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ne(t){var e=Mne(t,"string");return typeof e=="symbol"?e:e+""}function Mne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ES(t,e,n){B$(t,e),e.set(t,n)}function B$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ta(t,e,n){return t.set(ze(t,e),n),n}function sl(t,e){return t.get(ze(t,e))}function ze(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Nn="formulas",Ine=["maxRows","maxColumns","language"],Pne=260;ne.getSingleton().register("afterNamedExpressionAdded");ne.getSingleton().register("afterNamedExpressionRemoved");ne.getSingleton().register("afterSheetAdded");ne.getSingleton().register("afterSheetRemoved");ne.getSingleton().register("afterSheetRenamed");ne.getSingleton().register("afterFormulasValuesUpdate");const uc=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var rs=new WeakMap,Kp=new WeakMap,sh=new WeakMap,qe=new WeakSet;class One extends Ue{constructor(){var e;super(...arguments),e=this,Tne(this,qe),ES(this,rs,!1),ES(this,Kp,!1),ES(this,sh,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,Yne).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,Gne).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,qne).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,Kne).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,Xne).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,Zne).call(e,...r)}]]),Ha(this,"staticRegister",oi("formulas")),Ha(this,"engine",null),Ha(this,"sheetId",null),Ha(this,"sheetName",null),Ha(this,"indexSyncer",null),Ha(this,"rowAxisSyncer",null),Ha(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Nn}static get PLUGIN_PRIORITY(){return Pne}static get SETTING_KEYS(){return[Nn,...Ine]}isEnabled(){return!!this.hot.getSettings()[Nn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=une(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Ke("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&ze(qe,this,Lh).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,I1).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,P1).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,I1).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,P1).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Nne).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Dne).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,xne).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,kne).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,O1).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,O1).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Lne).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,$ne).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Wne).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Bne).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Fne).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Vne).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,jne).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Une).call(n,...i)}),this.indexSyncer=new Ene(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Ane).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,zne).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Hne).call(n,...i)}),sl(sh,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){sl(sh,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),_1(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=ane(this.hot.getSettings());lne(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Nn];if(ae(r)&&ae(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Nn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());ze(qe,this,Lh).call(this,o)}}super.updatePlugin(e)}destroy(){sl(sh,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),ta(sh,this,null),_1(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ae(n)&&!Ck(n))return Ke("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Ke("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return Ke(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){yE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}ze(qe,this,Lh).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${kn(Nn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),T1(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o?.address)!==null&&s!==void 0?s:{};return ae(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ae(l)===!1||ae(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=T1(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Ke(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return r_(r,o.type)&&(L$(r,o.dateFormat)?r=$$(r,o.dateFormat):wne(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Lh(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function xne(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&An(s)&&(s=F$(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Hne(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:p,col:v}=h.start,{row:S,col:E}=h.end,C=S-p+1,I=E-v+1;for(let H=0;H<f.length;H+=1)for(let $=0;$<f[H].length;$+=1){const P=f[H][$],x=p+H%C,z=v+$%I,K=this.hot.getCellMeta(x,z);r_(P,K.type)&&(P.startsWith("'")?f[H][$]=P.slice(1):this.isFormulaCellType(x,z,this.sheetId)===!1&&(f[H][$]=vne(P,K.dateFormat)))}return f}function I1(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(kn(Nn))||ta(Kp,this,Rt(this.hot.getSettings().data))}function Ane(){if(sl(Kp,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;r_(i,s.type)&&(L$(i,a)?t[r][o]=$$(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),ta(rs,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),ta(rs,this,!1)}function P1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(kn(Nn)))return;const r=gne(this.engine,this.hot.getSettings()[Nn].sheetName);if(ze(qe,this,Lh).call(this,r),n!=="updateSettings")if(sl(Kp,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){ta(rs,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),ta(rs,this,!1)}}}function Nne(t,e,n,r){if(r!=="get"||sl(rs,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){n.value=pne(n.value);return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let s=this.engine.getCellValue(o);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&An(s)&&(s=F$(s,a.dateFormat)),n.value=typeof s=="object"&&s!==null?s.value:s}function Dne(t,e,n,r){if(r!=="get"||sl(rs,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function O1(t,e){if(uc(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function kne(t,e){if(uc(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!An(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Ke(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Lne(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function $ne(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Fne(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Vne(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Wne(t,e,n){if(uc(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Bne(t,e,n){if(uc(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function jne(t,e,n,r){if(uc(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Une(t,e,n,r){if(uc(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function zne(t,e,n){var r;ta(rs,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());ta(rs,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Yne(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Gne(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function qne(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Kne(t){this.hot.runHooks("afterSheetAdded",t)}function Xne(t,e){ze(qe,this,Lh).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function Zne(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Qne(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(D0,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Jne(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(k0,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Le(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return _(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function ere(t,e){j$(t,e),e.add(t)}function tre(t,e,n){j$(t,e),e.set(t,n)}function j$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aa(t,e){return t.get(Os(t,e))}function x1(t,e,n){return t.set(Os(t,e),n),n}function Os(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeHideColumns");ne.getSingleton().register("afterHideColumns");ne.getSingleton().register("beforeUnhideColumns");ne.getSingleton().register("afterUnhideColumns");const H1="hiddenColumns",nre=310;var Bi=new WeakMap,Na=new WeakSet;class rre extends Ue{constructor(){super(...arguments),ere(this,Na),tre(this,Bi,null)}static get PLUGIN_KEY(){return H1}static get PLUGIN_PRIORITY(){return nre}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[H1]}enablePlugin(){var e=this;this.enabled||(x1(Bi,this,new Tp),Aa(Bi,this).addLocalHook("init",()=>Os(Na,this,ure).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Aa(Bi,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Os(Na,e,lre).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Os(Na,this,ore).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Os(Na,this,ire).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Os(Na,e,are).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Os(Na,this,sre).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Aa(Bi,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));_(l,u=>{o[u]=!1}),i=an(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Aa(Bi,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{Aa(Bi,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Le(Aa(Bi,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Aa(Bi,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){_(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){x1(Bi,this,null),super.destroy()}}function ire(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function ore(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function sre(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return _(t,r=>{let i=!0,o=0;de(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function are(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Y(e,n)}function lre(t){t.items.push({name:Ae},Qne(this),Jne(this))}function ure(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function cre(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(L0,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function hre(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase($0,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Le(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return _(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function dre(t,e){U$(t,e),e.add(t)}function fre(t,e,n){U$(t,e),e.set(t,n)}function U$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Da(t,e){return t.get(xs(t,e))}function A1(t,e,n){return t.set(xs(t,e),n),n}function xs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeHideRows");ne.getSingleton().register("afterHideRows");ne.getSingleton().register("beforeUnhideRows");ne.getSingleton().register("afterUnhideRows");const N1="hiddenRows",gre=320;var ji=new WeakMap,ka=new WeakSet;class mre extends Ue{constructor(){super(...arguments),dre(this,ka),fre(this,ji,null)}static get PLUGIN_KEY(){return N1}static get PLUGIN_PRIORITY(){return gre}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[N1]}enablePlugin(){var e=this;this.enabled||(A1(ji,this,new Tp),Da(ji,this).addLocalHook("init",()=>xs(ka,this,Sre).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Da(ji,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xs(ka,e,yre).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>xs(ka,this,wre).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>xs(ka,this,pre).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xs(ka,e,Cre).call(e,...r)}),this.addHook("modifyCopyableRange",n=>xs(ka,this,vre).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Da(ji,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));_(l,u=>{o[u]=!1}),i=an(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Da(ji,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{Da(ji,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Le(Da(ji,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Da(ji,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){_(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){A1(ji,this,null),super.destroy()}}function pre(t,e){return this.isHidden(e)?0:t}function wre(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function vre(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return _(t,r=>{let i=!0,o=0;de(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Cre(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Y(e,n)}function yre(t){t.items.push({name:Ae},cre(this),hre(this))}function Sre(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function bre(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(h0)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Rre(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(d0)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Ere(t,e){z$(t,e),e.add(t)}function Tre(t,e,n){z$(t,e),e.set(t,n)}function z$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sR(t,e){return t.get(Om(t,e))}function TS(t,e,n){return t.set(Om(t,e),n),n}function Om(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeColumnFreeze");ne.getSingleton().register("afterColumnFreeze");ne.getSingleton().register("beforeColumnUnfreeze");ne.getSingleton().register("afterColumnUnfreeze");const D1="manualColumnFreeze",_re=110;var qa=new WeakMap,_S=new WeakSet;class Mre extends Ue{constructor(){super(...arguments),Ere(this,_S),Tre(this,qa,!1)}static get PLUGIN_KEY(){return D1}static get PLUGIN_PRIORITY(){return _re}isEnabled(){return!!this.hot.getSettings()[D1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Om(_S,this,Ire).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Om(_S,this,Pre).call(this,e,n)),super.enablePlugin())}disablePlugin(){TS(qa,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;sR(qa,this)||TS(qa,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;sR(qa,this)||TS(qa,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Ire(t){t.items.push({name:"---------"},bre(this),Rre(this))}function Pre(t,e){if(sR(qa,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function ng(t,e,n){return(e=Ore(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ore(t){var e=xre(t,"string");return typeof e=="symbol"?e:e+""}function xre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const MS=0,k1=1,L1=2,su="px";let Y$=class{constructor(e){ng(this,"hot",void 0),ng(this,"_element",null),ng(this,"state",MS),ng(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=L1}build(){this.state===MS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=k1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=MS}isAppended(){return this.state===L1}isBuilt(){return this.state>=k1}setPosition(e,n){An(e)&&(this._element.style.top=e+su),An(n)&&(this._element.style[this.inlineProperty]=n+su)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){An(e)&&(this._element.style.width=e+su),An(n)&&(this._element.style.height=n+su)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){An(e)&&(this._element.style.marginTop=e+su),An(n)&&(this._element.style[`margin${kn(this.inlineProperty)}`]=n+su)}getOffset(){const e=this._element.style,n=`margin${kn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Hre="ht__manualColumnMove--backlight";let Are=class extends Y${build(){super.build(),Y(this._element,Hre)}};const Nre="ht__manualColumnMove--guideline";let Dre=class extends Y${build(){super.build(),Y(this._element,Nre)}};function kre(t,e){G$(t,e),e.add(t)}function fi(t,e,n){G$(t,e),e.set(t,n)}function G$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fr(t,e,n){return t.set(Hs(t,e),n),n}function ce(t,e){return t.get(Hs(t,e))}function Hs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeColumnMove");ne.getSingleton().register("afterColumnMove");const IS="manualColumnMove",Lre=120,$1="ht__manualColumnMove",xm="show-ui",aR="on-moving--columns",lR="after-selection--columns";var Yn=new WeakMap,Ds=new WeakMap,Ko=new WeakMap,Kg=new WeakMap,js=new WeakMap,zn=new WeakMap,rg=new WeakMap,Vr=new WeakMap,Su=new WeakMap,Hm=new WeakMap,$h=new WeakMap,La=new WeakSet;class $re extends Ue{constructor(){super(...arguments),kre(this,La),fi(this,Yn,new Are(this.hot)),fi(this,Ds,new Dre(this.hot)),fi(this,Ko,[]),fi(this,Kg,0),fi(this,js,!1),fi(this,zn,{}),fi(this,rg,void 0),fi(this,Vr,void 0),fi(this,Su,void 0),fi(this,Hm,void 0),fi(this,$h,void 0)}static get PLUGIN_KEY(){return IS}static get PLUGIN_PRIORITY(){return Lre}isEnabled(){return!!this.hot.getSettings()[IS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hs(La,e,Fre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hs(La,e,Wre).call(e,...r)}),this.addHook("afterScrollVertically",()=>Hs(La,this,jre).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hs(La,e,Ure).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Y(this.hot.rootElement,$1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){me(this.hot.rootElement,$1),this.unregisterEvents(),ce(Yn,this).destroy(),ce(Ds,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=ce(rg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(fr(rg,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return fr(rg,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=an(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[IS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return de(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ce(Vr,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ce(Vr,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ce(Yn,this).getOffset().start,u=ce(Yn,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const p=this.hot.rootWindow,v=Bt(this.hot.rootElement),S=p.innerWidth-ce(Su,this)-v;h=p.innerWidth-ce(zn,this).eventPageX-S-(r.scrollX===void 0?i:0)}else h=ce(zn,this).eventPageX-(ce(Su,this)-(r.scrollX===void 0?i:0));if(ce(Hm,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ce(Vr,this))&&(o+=i),o+=c,ce(Vr,this)<0)ce($h,this)>0?ce(zn,this).col=0:ce(zn,this).col=e>0?e-1:e;else if(ce(zn,this).TD.offsetWidth/2+o<=h){const p=ce(Vr,this)>=ce(Kg,this)?ce(Kg,this)-1:ce(Vr,this);ce(zn,this).col=p+1,o+=ce(zn,this).TD.offsetWidth}else ce(zn,this).col=ce(Vr,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&ce(Vr,this)<ce($h,this)&&(f-=ce(Su,this)<=r.scrollX?ce(Su,this):0),ce(Yn,this).setPosition(null,d),ce(Ds,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Hs(La,this,Vre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Hs(La,this,Bre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ce(Yn,this).build(),ce(Ds,this).build()}destroy(){ce(Yn,this).destroy(),ce(Ds,this).destroy(),super.destroy()}}function Fre(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Ce(t.target,"sortAction");if(!s||!o||ce(js,this)||t.button!==0||a){fr(js,this,!1),ce(Ko,this).length=0,me(this.hot.rootElement,[aR,xm]);return}const l=ce(Ds,this).isBuilt()&&!ce(Ds,this).isAppended(),u=ce(Yn,this).isBuilt()&&!ce(Yn,this).isAppended();l&&u&&(ce(Ds,this).appendTo(i.hider),ce(Yn,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,fr(js,this,!0);const p=n.firstChild?WD(t,n.firstChild).x:t.offsetX;ce(zn,this).eventPageX=t.pageX,fr(Vr,this,e.col),ce(zn,this).TD=n,ce(zn,this).col=e.col,fr(Ko,this,this.prepareColumnsToMoving(d,f)),fr(Hm,this,!!this.hot.getSettings().rowHeaders),fr(Kg,this,this.hot.countCols()),fr($h,this,this.hot.getSettings().fixedColumnsStart),fr(Su,this,bn(this.hot.rootElement).left);const v=ce(Hm,this)?-1:0,S=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<ce($h,this),C=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),I=Math.abs(p-(this.hot.isRtl()?n.offsetWidth:0)),H=this.getColumnsWidth(d,e.col-1)+I,$=this.getColumnsWidth(v,d-1)+(E?C:0)+H;ce(Yn,this).setPosition(S,$),ce(Yn,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-S),ce(Yn,this).setOffset(null,-H),Y(this.hot.rootElement,aR)}else me(this.hot.rootElement,lR),fr(js,this,!1),ce(Ko,this).length=0}function Vre(t){ce(js,this)&&(ce(zn,this).eventPageX=t.pageX,this.refreshPositions())}function Wre(t,e,n,r){!this.hot.getSelectedRangeLast()||!ce(js,this)||(ce(Ko,this).indexOf(e.col)>-1?me(this.hot.rootElement,xm):Y(this.hot.rootElement,xm),r.row=!0,r.column=!0,r.cell=!0,fr(Vr,this,e.col),ce(zn,this).TD=n)}function Bre(){const t=ce(zn,this).col,e=ce(Ko,this).length;if(fr(Vr,this,void 0),fr(js,this,!1),me(this.hot.rootElement,[aR,xm,lR]),this.hot.selection.isSelectedByColumnHeader()&&Y(this.hot.rootElement,lR),e<1||t===void 0)return;const n=ce(Ko,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(ce(Ko,this),t);if(ce(Ko,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function jre(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;ce(Yn,this).setPosition(r),ce(Yn,this).setSize(null,t.hider.offsetHeight-r)}function Ure(){this.moveBySettingsOrLoad()}function zre(t,e){q$(t,e),e.add(t)}function Mn(t,e,n){q$(t,e),e.set(t,n)}function q$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wt(t,e,n){return t.set(Si(t,e),n),n}function re(t,e){return t.get(Si(t,e))}function Si(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Am="manualColumnResize",Yre=130,F1="manualColumnWidths";var Bo=new WeakMap,ig=new WeakMap,Ir=new WeakMap,Nm=new WeakMap,so=new WeakMap,Gre=new WeakMap,ku=new WeakMap,og=new WeakMap,or=new WeakMap,$o=new WeakMap,fl=new WeakMap,Dm=new WeakMap,Fh=new WeakMap,Vh=new WeakMap,Or=new WeakMap,Wh=new WeakMap,Ui=new WeakSet;class qre extends Ue{static get PLUGIN_KEY(){return Am}static get PLUGIN_PRIORITY(){return Yre}constructor(e){super(e),zre(this,Ui),Mn(this,Bo,null),Mn(this,ig,null),Mn(this,Ir,[]),Mn(this,Nm,null),Mn(this,so,null),Mn(this,Gre,null),Mn(this,ku,null),Mn(this,og,null),Mn(this,or,this.hot.rootDocument.createElement("DIV")),Mn(this,$o,this.hot.rootDocument.createElement("DIV")),Mn(this,fl,null),Mn(this,Dm,!1),Mn(this,Fh,0),Mn(this,Vh,null),Mn(this,Or,void 0),Mn(this,Wh,void 0),Y(re(or,this),"manualColumnResizer"),Y(re($o,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Am]}enablePlugin(){var e=this;this.enabled||(Wt(Or,this,new sa),re(Or,this).addLocalHook("init",()=>Si(Ui,this,Kre).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,re(Or,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Si(Ui,e,tie).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Si(Ui,e,nie).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Si(Ui,e,rie).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Wt(Wh,this,re(Or,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",F1,re(Or,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",F1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return re(Or,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);re(Or,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Wt(Bo,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(re(Bo,this)),i=r.col;if(i<0)return;const o=qt(re(Bo,this)),s=re(Bo,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(re(Bo,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(re(Bo,this),r.row,r.col)),Wt(ig,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Wt(Ir,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();_(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;de(d,f,p=>{re(Ir,this).includes(p)||re(Ir,this).push(p)})})}re(Ir,this).includes(re(ig,this))||Wt(Ir,this,[re(ig,this)]),Wt(og,this,l.start-6),Wt(ku,this,parseInt(s.width,10)),re(or,this).style.top=`${l.top}px`,re(or,this).style[this.inlineDir]=`${re(og,this)+re(ku,this)}px`,re(or,this).style.height=`${o}px`,this.hot.rootElement.appendChild(re(or,this))}refreshHandlePosition(){re(or,this).style[this.inlineDir]=`${re(og,this)+re(Nm,this)}px`}setupGuidePosition(){const e=parseInt(qt(re(or,this)),10),n=parseInt(re(or,this).style.top,10)+e,r=this.hot.view.getTableHeight();Y(re(or,this),"active"),Y(re($o,this),"active"),re($o,this).style.top=`${n}px`,this.refreshGuidePosition(),re($o,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(re($o,this))}refreshGuidePosition(){re($o,this).style[this.inlineDir]=re(or,this).style[this.inlineDir]}hideHandleAndGuide(){me(re(or,this),"active"),me(re($o,this),"active")}checkIfColumnHeader(e){const n=Zs(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",re(so,this),r,!0);o!==void 0&&Wt(so,this,o),this.setManualSize(r,re(so,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",re(so,this),r,!0),i&&e()};re(Fh,this)>=2&&(re(Ir,this).length>1?(_(re(Ir,this),i=>{n(i)}),e()):_(re(Ir,this),i=>{n(i,!0)})),Wt(Fh,this,0),Wt(Vh,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Si(Ui,this,Xre).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Si(Ui,this,Zre).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Si(Ui,this,Qre).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Si(Ui,this,Jre).call(this)),this.eventManager.addEventListener(re(or,this),"contextmenu",()=>Si(Ui,this,eie).call(this))}destroy(){super.destroy()}}function Kre(){const t=this.hot.getSettings()[Am],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{re(Or,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{re(Or,this).setValueAtIndex(r,n)})},!0),Wt(Wh,this,t)):t===!0&&Array.isArray(re(Wh,this))&&this.hot.batchExecution(()=>{re(Wh,this).forEach((n,r)=>{re(Or,this).setValueAtIndex(r,n)})},!0)}function Xre(t){if(!mE(t.target)&&re(Dm,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(re(fl,this)||this.setupHandlePosition(e))}}function Zre(t){t.target.parentNode===this.hot.rootElement&&Ce(t.target,"manualColumnResizer")&&(this.setupHandlePosition(re(Bo,this)),this.setupGuidePosition(),Wt(fl,this,!0),re(Vh,this)===null&&(Wt(Vh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(re(Vh,this))),Wt(Fh,this,re(Fh,this)+1),this.startX=t.pageX,Wt(so,this,re(ku,this)))}function Qre(t){if(re(fl,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Wt(Nm,this,re(ku,this)+e),_(re(Ir,this),n=>{Wt(so,this,this.setManualSize(n,re(Nm,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Jre(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",re(so,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",re(so,this),n,!1)};re(fl,this)&&(this.hideHandleAndGuide(),Wt(fl,this,!1),re(so,this)!==re(ku,this)&&(re(Ir,this).length>1?(_(re(Ir,this),r=>{e(r)}),t()):_(re(Ir,this),r=>{e(r,!0)})),this.setupHandlePosition(re(Bo,this)))}function eie(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(re(or,this)),this.hot.rootElement.removeChild(re($o,this)),Wt(fl,this,!1),Wt(Dm,this,!0),this.hot._registerImmediate(()=>{Wt(Dm,this,!1)})}function tie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=re(Or,this).getValueAtIndex(r);this.hot.getSettings()[Am]&&i&&(n=i)}return n}function nie(t,e){const n=re(Or,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function rie(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function PS(t,e,n){return(e=iie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iie(t){var e=oie(t,"string");return typeof e=="symbol"?e:e+""}function oie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const OS=0,V1=1,W1=2,au="px";let K$=class{constructor(e){PS(this,"hot",void 0),PS(this,"_element",null),PS(this,"state",OS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=W1}build(){this.state===OS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=V1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=OS}isAppended(){return this.state===W1}isBuilt(){return this.state>=V1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+au),n!==void 0&&(this._element.style.left=n+au)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+au),n&&(this._element.style.height=n+au)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+au),n&&(this._element.style.marginLeft=n+au)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const sie="ht__manualRowMove--backlight";class aie extends K${build(){super.build(),Y(this._element,sie)}}const lie="ht__manualRowMove--guideline";class uie extends K${build(){super.build(),Y(this._element,lie)}}function cie(t,e){X$(t,e),e.add(t)}function lu(t,e,n){X$(t,e),e.set(t,n)}function X$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function il(t,e,n){return t.set(As(t,e),n),n}function Ee(t,e){return t.get(As(t,e))}function As(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeRowMove");ne.getSingleton().register("afterRowMove");const xS="manualRowMove",hie=140,B1="ht__manualRowMove",km="show-ui",uR="on-moving--rows",cR="after-selection--rows";var Gn=new WeakMap,ks=new WeakMap,Xo=new WeakMap,Us=new WeakMap,gr=new WeakMap,sg=new WeakMap,$a=new WeakSet;class die extends Ue{constructor(){super(...arguments),cie(this,$a),lu(this,Gn,new aie(this.hot)),lu(this,ks,new uie(this.hot)),lu(this,Xo,[]),lu(this,Us,void 0),lu(this,gr,{}),lu(this,sg,void 0)}static get PLUGIN_KEY(){return xS}static get PLUGIN_PRIORITY(){return hie}isEnabled(){return!!this.hot.getSettings()[xS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return As($a,e,fie).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return As($a,e,mie).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>As($a,this,wie).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return As($a,e,vie).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Y(this.hot.rootElement,B1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){me(this.hot.rootElement,B1),this.unregisterEvents(),Ee(Gn,this).destroy(),Ee(ks,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Ee(sg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(il(sg,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return il(sg,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=an(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[xS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return de(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Ee(gr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Ee(gr,this).TD,a=this.hot.rootElement,l=bn(a),u=Wu(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Ee(gr,this).eventPageY-d+c,p=o.hider.offsetHeight,v=o.TBODY.offsetTop,S=Ee(Gn,this).getOffset().top,E=Ee(Gn,this).getSize().height,C=s.offsetHeight/2,I=s.offsetHeight;let H=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const $=f>=H+C;this.isFixedRowTop(e.row)&&(H+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Ee(gr,this).row=n>0?n-1:n:$?(Ee(gr,this).row=e.row+1,H+=e.row===0?I-1:I):Ee(gr,this).row=e.row;let P=f,x=H;f+E+S>=p?P=p-E-S:f+S<v&&(P=v+Math.abs(S)),H>=p-1&&(x=p-1),Ee(Gn,this).setPosition(P),Ee(ks,this).setPosition(x)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>As($a,this,gie).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>As($a,this,pie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ee(Gn,this).build(),Ee(ks,this).build()}destroy(){Ee(Gn,this).destroy(),Ee(ks,this).destroy(),super.destroy()}}function fie(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Ee(Us,this)||t.button!==0){il(Us,this,!1),Ee(Xo,this).length=0,me(this.hot.rootElement,[uR,km]);return}const l=Ee(ks,this).isBuilt()&&!Ee(ks,this).isAppended(),u=Ee(Gn,this).isBuilt()&&!Ee(Gn,this).isAppended();l&&u&&(Ee(ks,this).appendTo(i.hider),Ee(Gn,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,il(Us,this,!0),Ee(gr,this).eventPageY=t.pageY,Ee(gr,this).coords=e,Ee(gr,this).TD=n,il(Xo,this,this.prepareRowsToMoving());const p=i.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Ee(Gn,this).setPosition(null,p),Ee(Gn,this).setSize(i.hider.offsetWidth-p,this.getRowsHeight(d,f)),Ee(Gn,this).setOffset(-v,null),Y(this.hot.rootElement,uR),this.refreshPositions()}else me(this.hot.rootElement,cR),il(Us,this,!1),Ee(Xo,this).length=0}function gie(t){Ee(Us,this)&&(Ee(gr,this).eventPageY=t.pageY,this.refreshPositions())}function mie(t,e,n,r){!this.hot.getSelectedRangeLast()||!Ee(Us,this)||(Ee(Xo,this).indexOf(e.row)>-1?me(this.hot.rootElement,km):Y(this.hot.rootElement,km),r.row=!0,r.column=!0,r.cell=!0,Ee(gr,this).coords=e,Ee(gr,this).TD=n)}function pie(){const t=Ee(gr,this).row,e=Ee(Xo,this).length;if(il(Us,this,!1),me(this.hot.rootElement,[uR,km,cR]),this.hot.selection.isSelectedByRowHeader()&&Y(this.hot.rootElement,cR),e<1||t===void 0)return;const n=Ee(Xo,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Ee(Xo,this),t);if(Ee(Xo,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function wie(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Ee(Gn,this).setPosition(null,r),Ee(Gn,this).setSize(t.hider.offsetWidth-r)}function vie(){this.moveBySettingsOrLoad()}function Cie(t,e){Z$(t,e),e.add(t)}function In(t,e,n){Z$(t,e),e.set(t,n)}function Z$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(t,e,n){return t.set(jo(t,e),n),n}function te(t,e){return t.get(jo(t,e))}function jo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lm="manualRowResize",yie=30,j1="manualRowHeights";var eo=new WeakMap,ag=new WeakMap,Pr=new WeakMap,Bh=new WeakMap,Ls=new WeakMap,o_=new WeakMap,Lu=new WeakMap,lg=new WeakMap,jn=new WeakMap,Zi=new WeakMap,gl=new WeakMap,$m=new WeakMap,jh=new WeakMap,Uh=new WeakMap,Ri=new WeakMap,zh=new WeakMap,Rs=new WeakSet;class Sie extends Ue{static get PLUGIN_KEY(){return Lm}static get PLUGIN_PRIORITY(){return yie}constructor(e){super(e),Cie(this,Rs),In(this,eo,null),In(this,ag,null),In(this,Pr,[]),In(this,Bh,null),In(this,Ls,null),In(this,o_,null),In(this,Lu,null),In(this,lg,null),In(this,jn,this.hot.rootDocument.createElement("DIV")),In(this,Zi,this.hot.rootDocument.createElement("DIV")),In(this,gl,!1),In(this,$m,!1),In(this,jh,0),In(this,Uh,null),In(this,Ri,void 0),In(this,zh,void 0),Y(te(jn,this),"manualRowResizer"),Y(te(Zi,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Lm]}enablePlugin(){this.enabled||(At(Ri,this,new sa),te(Ri,this).addLocalHook("init",()=>jo(Rs,this,Iie).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,te(Ri,this)),this.addHook("modifyRowHeight",(e,n)=>jo(Rs,this,Mie).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){At(zh,this,te(Ri,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",j1,te(Ri,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",j1,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return te(Ri,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return te(Bh,this)}setupHandlePosition(e){At(eo,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(te(eo,this)),o=i.row;if(o<0)return;const s=Bt(te(eo,this)),a=te(eo,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(te(eo,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(te(eo,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(te(eo,this),i.row,i.col)),At(ag,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),At(Pr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();_(d,f=>{const p=f.getTopStartCorner().row,v=f.getBottomStartCorner().row;de(p,v,S=>{te(Pr,this).includes(S)||te(Pr,this).push(S)})})}te(Pr,this).includes(te(ag,this))||At(Pr,this,[te(ag,this)]),At(lg,this,c.top-6),At(Lu,this,parseInt(a.height,10)),te(jn,this).style.top=`${te(lg,this)+te(Lu,this)}px`,te(jn,this).style[this.inlineDir]=`${c.start}px`,te(jn,this).style.width=`${s}px`,this.hot.rootElement.appendChild(te(jn,this))}refreshHandlePosition(){te(jn,this).style.top=`${te(lg,this)+te(Bh,this)}px`}setupGuidePosition(){const e=parseInt(Bt(te(jn,this)),10),n=parseInt(te(jn,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();Y(te(jn,this),"active"),Y(te(Zi,this),"active"),te(Zi,this).style.top=te(jn,this).style.top,te(Zi,this).style[this.inlineDir]=`${n}px`,te(Zi,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(te(Zi,this))}refreshGuidePosition(){te(Zi,this).style.top=te(jn,this).style.top}hideHandleAndGuide(){me(te(jn,this),"active"),me(te(Zi,this),"active")}checkIfRowHeader(e){const n=Zs(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&te(Ls,this)<n?n:te(Ls,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&At(Ls,this,o),this.setManualSize(r,te(Ls,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};te(jh,this)>=2&&(te(Pr,this).length>1?(_(te(Pr,this),i=>{n(i)}),e()):_(te(Pr,this),i=>{n(i,!0)})),At(jh,this,0),At(Uh,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>jo(Rs,this,bie).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>jo(Rs,this,Rie).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>jo(Rs,this,Eie).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>jo(Rs,this,Tie).call(this)),this.eventManager.addEventListener(te(jn,this),"contextmenu",()=>jo(Rs,this,_ie).call(this))}destroy(){super.destroy()}}function bie(t){if(!mE(t.target)&&te($m,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(te(gl,this)||this.setupHandlePosition(e))}}function Rie(t){Ce(t.target,"manualRowResizer")&&(this.setupHandlePosition(te(eo,this)),this.setupGuidePosition(),At(gl,this,!0),te(Uh,this)===null&&(At(Uh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(te(Uh,this))),At(jh,this,te(jh,this)+1),At(o_,this,t.pageY),At(Ls,this,te(Lu,this)))}function Eie(t){te(gl,this)&&(At(Bh,this,te(Lu,this)+(t.pageY-te(o_,this))),_(te(Pr,this),e=>{At(Ls,this,this.setManualSize(e,te(Bh,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Tie(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};te(gl,this)&&(this.hideHandleAndGuide(),At(gl,this,!1),te(Ls,this)!==te(Lu,this)&&(te(Pr,this).length>1?(_(te(Pr,this),r=>{e(r)}),t()):_(te(Pr,this),r=>{e(r,!0)})),this.setupHandlePosition(te(eo,this)))}function _ie(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(te(jn,this)),this.hot.rootElement.removeChild(te(Zi,this)),At(gl,this,!1),At($m,this,!0),this.hot._registerImmediate(()=>{At($m,this,!1)})}function Mie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=te(Ri,this).getValueAtIndex(r);this.hot.getSettings()[Lm]&&i&&(n=i)}return n}function Iie(){const t=this.hot.getSettings()[Lm],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{te(Ri,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{te(Ri,this).setValueAtIndex(r,n)}),At(zh,this,t)):t===!0&&Array.isArray(te(zh,this))&&te(zh,this).forEach((n,r)=>{te(Ri,this).setValueAtIndex(r,n)})},!0)}var U1={},z1;function Pie(){if(z1)return U1;z1=1;var t=yp();return t("flatMap"),U1}Pie();var Y1={},G1={},HS,q1;function Oie(){if(q1)return HS;q1=1;var t=rn(),e=sn(),n=go(),r=ER();return HS=function(i,o){(!o||typeof i!="string")&&e(i);var s=r(i);return n(e(s!==void 0?t(s,i):i))},HS}var K1;function xie(){if(K1)return G1;K1=1;var t=ft(),e=rn(),n=pr(),r=sn(),i=go(),o=Oie(),s=MR(),a=wr(),l=na(),u=IR(),c=ia(),h=!l&&!u("flatMap",function(){}),d=!l&&!h&&c("flatMap",TypeError),f=l||h||d,p=s(function(){for(var v=this.iterator,S=this.mapper,E,C;;){if(C=this.inner)try{if(E=r(e(C.next,C.iterator)),!E.done)return E.value;this.inner=null}catch(I){a(v,"throw",I)}if(E=r(e(this.next,v)),this.done=!!E.done)return;try{this.inner=o(S(E.value,this.counter++),!1)}catch(I){a(v,"throw",I)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(S){r(this);try{n(S)}catch(E){a(this,"throw",E)}return d?e(d,this,S):new p(i(this),{mapper:S,inner:null})}}),G1}var X1;function Hie(){return X1||(X1=1,xie()),Y1}Hie();function Aie(t,e,n){Nie(t,e),e.set(t,n)}function Nie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fa(t,e,n){return(e=Die(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Die(t){var e=kie(t,"string");return typeof e=="symbol"?e:e+""}function kie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Z1(t,e){return t.get(Q$(t,e))}function ug(t,e,n){return t.set(Q$(t,e),n),n}function Q$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Va=new WeakMap;class to{constructor(e,n,r,i,o,s){Fa(this,"row",void 0),Fa(this,"col",void 0),Fa(this,"rowspan",void 0),Fa(this,"colspan",void 0),Fa(this,"removed",!1),Fa(this,"cellCoordsFactory",void 0),Fa(this,"cellRangeFactory",void 0),Aie(this,Va,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return nt`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),ug(Va,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,ug(Va,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return ug(Va,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return Z1(Va,this)||ug(Va,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),Z1(Va,this)}}function Lie(t,e){$ie(t,e),e.add(t)}function $ie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cg(t,e,n){return(e=Fie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fie(t){var e=Vie(t,"string");return typeof e=="symbol"?e:e+""}function Vie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Es=new WeakSet;class Fm{constructor(e){Lie(this,Es),cg(this,"plugin",void 0),cg(this,"mergedCells",[]),cg(this,"mergedCellsMatrix",new Map),cg(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){Ke(Fm.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new to(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Wa(Es,this,Q1).call(this,a),a):(u&&Ke(Fm.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Wa(Es,this,Wie).call(this,r),r):!1}clear(){_(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;de(n,n+i,s=>{de(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=We(u,i,i+s-1),d=We(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Wa(Es,this,hg).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Wa(Es,this,hg).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Wa(Es,this,hg).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Wa(Es,this,hg).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Wa(Es,this,Q1).call(this,s)})}}function hg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function Q1(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Wie(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function AS(t,e,n){return(e=Bie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bie(t){var e=jie(t,"string");return typeof e=="symbol"?e:e+""}function jie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uie{constructor(e){AS(this,"plugin",void 0),AS(this,"mergedCellsCollection",void 0),AS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,p=s-f,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const S=v.row+v.rowspan-a-p;o[2]+S>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?S:0}else if(r==="right"){const S=v.col+v.colspan-l-p;o[3]+S>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?S:0}else if(r==="up"){const S=u-p-v.row+1;o[0]+S<0?o[0]+=p:o[0]-=p?S:0}else if(r==="left"){const S=c-p-v.col+1;o[1]+S<0?o[1]+=p:o[1]-=p?S:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Kt(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,p=Math.floor(d/f)*f,v=d-p;let S=null,E=null,C=null;switch(r){case"up":S="includesVertically",C=c-v+1;break;case"left":S="includesHorizontally",C=c-v+1;break;case"down":S="includesVertically",C=h+v-1;break;case"right":S="includesHorizontally",C=h+v-1;break}return _(i,I=>{I[S](C)&&I.isFarther(E,r)&&(E=I)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return _(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(p=>{let{colspan:v}=p;return v===h.getWidth()}):!f.every(p=>{let{rowspan:v}=p;return v===h.getHeight()})}}function NS(t,e,n){return(e=zie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zie(t){var e=Yie(t,"string");return typeof e=="symbol"?e:e+""}function Yie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gie{constructor(e){NS(this,"plugin",void 0),NS(this,"hot",void 0),NS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function qie(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(g0)}return this.getTranslatedPhrase(f0)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?to.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Yh(t,e,n){return(e=Kie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kie(t){var e=Xie(t,"string");return typeof e=="symbol"?e:e+""}function Xie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J1{constructor(e){Yh(this,"data",void 0),Yh(this,"next",null),Yh(this,"prev",null),this.data=e}}class dg{constructor(){Yh(this,"first",null),Yh(this,"last",null)}push(e){const n=new J1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new J1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function Zie(t,e){J$(t,e),e.add(t)}function Ba(t,e,n){J$(t,e),e.set(t,n)}function J$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function et(t,e){return t.get(Vm(t,e))}function yr(t,e,n){return t.set(Vm(t,e),n),n}function Vm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zi=new WeakMap,Yi=new WeakMap,Gi=new WeakMap,qi=new WeakMap,hR=new WeakMap,fg=new WeakMap,gg=new WeakMap,DS=new WeakSet;class Qie{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;Zie(this,DS),Ba(this,zi,new dg),Ba(this,Yi,new dg),Ba(this,Gi,null),Ba(this,qi,null),Ba(this,hR,null),Ba(this,fg,null),Ba(this,gg,null),yr(hR,this,n),yr(fg,this,r),yr(gg,this,i)}getCurrentVerticalNode(){return et(qi,this).data}getFirstVerticalNode(){return et(Yi,this).first.data}getNextVerticalNode(){return et(qi,this).next.data}getPrevVerticalNode(){return et(qi,this).prev.data}getCurrentHorizontalNode(){return et(Gi,this).data}getFirstHorizontalNode(){return et(zi,this).first.data}getNextHorizontalNode(){return et(Gi,this).next.data}getPrevHorizontalNode(){return et(Gi,this).prev.data}setPrevNodeAsActive(){yr(qi,this,et(qi,this).prev),yr(Gi,this,et(Gi,this).prev)}setNextNodeAsActive(){yr(qi,this,et(qi,this).next),yr(Gi,this,et(Gi,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;yr(zi,this,new dg);for(let s=n.row;s<=r.row;s++)if(!et(fg,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(et(gg,this).isHidden(a))continue;const l=Vm(DS,this,eA).call(this,e,et(zi,this),i,s,a);l&&yr(Gi,this,l)}et(zi,this).first&&(et(zi,this).first.prev=et(zi,this).last,et(zi,this).last.next=et(zi,this).first);const o=new WeakSet;yr(Yi,this,new dg);for(let s=n.col;s<=r.col;s++)if(!et(gg,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(et(fg,this).isHidden(a))continue;const l=Vm(DS,this,eA).call(this,e,et(Yi,this),o,a,s);l&&yr(qi,this,l)}et(Yi,this).first&&(et(Yi,this).first.prev=et(Yi,this).last,et(Yi,this).last.next=et(Yi,this).first)}setActiveNode(e,n){return et(zi,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return yr(Gi,this,r),!1}),et(Yi,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return yr(qi,this,r),!1}),this}}function eA(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=et(hR,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function eF(t,e,n){const{rowIndexMapper:r,stylesHandler:i}=t,o=i.getDefaultRowHeight();let s=0;for(let l=e;l<e+n;l++)if(!r.isHidden(l)){var a;s+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:o,l===0&&!i.isClassicTheme()&&(s+=1)}return s}function Jie(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!Pe(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),Vu()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:p}=c,[v,S]=t.translateMergedCellToRenderable(h,p,d,f),E=t.getSetting("virtualized");if(Vu()&&d===0&&!e.getSettings().rowHeaders){const A=eF(e,h,p);i.set(l,A/p)}const C=n.getRenderableFromVisualIndex(l),I=r.getRenderableFromVisualIndex(u),H=v-C+1,$=S-I+1;let P=n.getNearestNotHiddenIndex(h,1),x=r.getNearestNotHiddenIndex(d,1);if(E){const A=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(A)||(P=Math.max(P,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(A)||(x=Math.max(x,e.getFirstRenderedVisibleColumn()))}const z=Math.min(p,H),K=Math.min(f,$);P===l&&x===u?(a.setAttribute("rowspan",z),a.setAttribute("colspan",K)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function eoe(t,e){tF(t,e),e.add(t)}function mg(t,e,n){tF(t,e),e.set(t,n)}function tF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kS(t,e,n){return(e=toe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function toe(t){var e=noe(t,"string");return typeof e=="symbol"?e:e+""}function noe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gd(t,e,n){return t.set(it(t,e),n),n}function dt(t,e){return t.get(it(t,e))}function it(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeMergeCells");ne.getSingleton().register("afterMergeCells");ne.getSingleton().register("beforeUnmergeCells");ne.getSingleton().register("afterUnmergeCells");const dR="mergeCells",roe=150,tA=dR;var qr=new WeakMap,Kr=new WeakMap,ao=new WeakMap,nA=new WeakMap,ut=new WeakSet;class ioe extends Ue{constructor(){super(...arguments),eoe(this,ut),kS(this,"mergedCellsCollection",null),kS(this,"autofillCalculations",null),kS(this,"selectionCalculations",null),mg(this,qr,null),mg(this,Kr,{row:0,col:0}),mg(this,ao,new Qie({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),mg(this,nA,Jie(this))}static get PLUGIN_KEY(){return dR}static get PLUGIN_PRIORITY(){return roe}static get DEFAULT_SETTINGS(){return{[SL]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[dR]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Fm(this),this.autofillCalculations=new Uie(this),this.selectionCalculations=new Gie(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,ooe).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,aoe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,loe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,uoe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,coe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,iA).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,iA).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,doe).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,foe).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,goe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,rA).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,rA).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,soe).call(e,...r)}),this.addHook("afterRenderer",function(){return dt(nA,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,hoe).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,moe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,poe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,woe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,voe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Coe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,yoe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Soe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,boe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Roe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Eoe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Toe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,_oe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Moe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Ioe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!iE())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>o?.name==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=td(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=td(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?to.containsNegativeValues(e)?(Ke(to.NEGATIVE_VALUES_WARNING(e)),!1):to.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ke(to.IS_OUT_OF_BOUNDS_WARNING(e)),!1):to.isSingleCell(e)?(Ke(to.IS_SINGLE_CELL(e)),!1):to.containsZeroSpan(e)?(Ke(to.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),de(0,s.rowspan-1,c=>{de(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),_(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),de(0,i.rowspan-1,o=>{de(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:tA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tA)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Pe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Pe(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Pe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Pe(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function ooe(){this.generateFromSettings(),this.hot.render()}function soe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function aoe(t){dt(Kr,this).row=t.row,dt(Kr,this).col=t.col}function loe(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;dt(qr,this)&&(i.getRenderableFromVisualIndex(dt(qr,this).row)!==null&&(n.row=dt(qr,this).row),r.getRenderableFromVisualIndex(dt(qr,this).col)!==null&&(n.col=dt(qr,this).col),gd(qr,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function uoe(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function coe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){gd(qr,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);gd(qr,this,e.clone()),n&&e.assign(n)}function rA(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),p=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[We(p,u,h),We(v,c,d),We(this.hot.getLastRenderedVisibleRow(),u,h),We(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function hoe(t){t.items.push({name:"---------"},qie(this))}function iA(){gd(qr,this,null)}function doe(){if(dt(qr,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=dt(qr,this).clone().normalize();dt(ao,this).setActiveNode(r.row,r.col),dt(Kr,this).row>0||dt(Kr,this).col>0?dt(ao,this).setPrevNodeAsActive():(n==="E-W"&&dt(Kr,this).col<0||e==="S-N"&&dt(Kr,this).row<0)&&dt(ao,this).setNextNodeAsActive()}function foe(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(dt(Kr,this).col<0){const{rowEnd:a,colEnd:l}=dt(ao,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(dt(Kr,this).col>0){const{rowStart:a,colStart:l}=dt(ao,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(dt(Kr,this).row<0){const{rowEnd:a,colEnd:l}=dt(ao,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(dt(Kr,this).row>0){const{rowStart:a,colStart:l}=dt(ao,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}dt(ao,this).setActiveNode(t,e),gd(Kr,this,{row:0,col:0})}function goe(){this.hot.getSelectedRangeLast().isHeader()||dt(ao,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function moe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function poe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function woe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function voe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function Coe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function yoe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Soe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function boe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Roe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Eoe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);_(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Toe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function _oe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Moe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function Ioe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:p}=f;return Math.max(d,p)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,p=0;n==="top"||n==="top_inline_start_corner"?p=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):p=f-h,t=Math.max(t??0,eF(this.hot,e,p))}),t}function Poe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,p=(d.compareFunctionFactory?d.compareFunctionFactory:xL(u.type))(l,u,d)(c,h);if(p===uo){const v=a+1;if(typeof e[v]<"u")return s(v)}return p}(0)}}const nF="sort";function Ooe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${nF}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function xoe(t){const e=t.className.split(" "),n=new RegExp(`^${nF}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Hoe(t,e,n){return(e=Aoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aoe(t){var e=Noe(t,"string");return typeof e=="symbol"?e:e+""}function Noe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Wm="multiColumnSorting",Doe=170,oA=Wm;OL(Wm,Poe);class koe extends VL{constructor(){super(...arguments),Hoe(this,"pluginKey",Wm)}static get PLUGIN_KEY(){return Wm}static get PLUGIN_PRIORITY(){return Doe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,bm)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:aa,position:"before",group:oA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(oA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),me(e,xoe(e)),this.enabled!==!1&&Y(e,Ooe(...r))}onAfterOnCellMouseDown(e,n){zT(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,bm))):this.sort(this.getColumnNextConfig(n.col)))}}function sA(t,e,n){return(e=Loe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Loe(t){var e=$oe(t,"string");return typeof e=="symbol"?e:e+""}function $oe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Foe="multipleSelectionHandles",Voe=160;class Woe extends Ue{constructor(){super(...arguments),sA(this,"dragged",[]),sA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Foe}static get PLUGIN_PRIORITY(){return Voe}isEnabled(){return Ti()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(Ce(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(Ce(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(Ce(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Ce(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function fR(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function rF(){return{label:"",isPlaceholder:!0}}function Boe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;_(t,i=>{const o=[];let s=0;n.push(o),_(i,a=>{const l=fR();if(Pe(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=wt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=wt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(rF());return!u})});const r=Math.max(...Le(n,i=>i.length));return _(n,i=>{if(i.length<r){const o=Le(new Array(r-i.length),()=>fR());i.splice(i.length,0,...o)}}),n}function LS(t,e,n){joe(t,e),e.set(t,n)}function joe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gi(t,e){return t.get(iF(t,e))}function ah(t,e,n){return t.set(iF(t,e),n),n}function iF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const aA=["label","collapsible"];var Ao=new WeakMap,ja=new WeakMap,$S=new WeakMap;class Uoe{constructor(){LS(this,Ao,[]),LS(this,ja,0),LS(this,$S,1/0)}setColumnsLimit(e){ah($S,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];ah(Ao,this,Boe(e,gi($S,this))),ah(ja,this,gi(Ao,this).length)}getData(){return gi(Ao,this)}mergeWith(e){_(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&Kt(s,o,aA)})}map(e){_(gi(Ao,this),n=>{_(n,r=>{const i=e({...r});Pe(i)&&Kt(r,i,aA)})})}getHeaderSettings(e,n){var r;if(e>=gi(ja,this)||e<0)return null;const i=gi(Ao,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=gi(ja,this)||e<0)return i;const o=gi(Ao,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return gi(ja,this)}getColumnsCount(){return gi(ja,this)>0?gi(Ao,this)[0].length:0}clear(){ah(Ao,this,[]),ah(ja,this,0)}}function FS(t,e,n){return(e=zoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zoe(t){var e=Yoe(t,"string");return typeof e=="symbol"?e:e+""}function Yoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oF="DF-pre-order";function sF(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=sF.call(this.childs[r],t,e)}return n}const Goe="DF-post-order";function aF(t,e){for(let n=0;n<this.childs.length;n++)if(aF.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const lF="BF";function qoe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const Koe=lF,lA=new Map([[oF,sF],[Goe,aF],[lF,qoe]]);class Bm{constructor(e){FS(this,"data",{}),FS(this,"parent",null),FS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Bm({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Koe;if(!lA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);lA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function VS(t,e,n){Xoe(t,e),e.set(t,n)}function Xoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bn(t,e){return t.get(uF(t,e))}function Zoe(t,e,n){return t.set(uF(t,e),n),n}function uF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uu=new WeakMap,Ua=new WeakMap,cu=new WeakMap;class Qoe{constructor(e){VS(this,uu,new Map),VS(this,Ua,new Map),VS(this,cu,null),Zoe(cu,this,e)}getRoots(){return Array.from(Bn(uu,this).values())}getRootByColumn(e){let n;return Bn(Ua,this).has(e)&&(n=Bn(uu,this).get(Bn(Ua,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Bn(Ua,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Bn(Ua,this).clear(),_(Bn(uu,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Bn(Ua,this).set(i,e);e+=r})}buildTree(){this.clear();const e=Bn(cu,this).getColumnsCount();let n=0;for(;n<e;){const r=Bn(cu,this).getHeaderSettings(0,n),i=new Bm;Bn(uu,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Bn(cu,this).getHeadersSettings(r,n,i);r+=1,_(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new Bm(a),e.addChild(l)),r<Bn(cu,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Bn(uu,this).clear(),Bn(Ua,this).clear()}}function cF(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function jm(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Um(t){return jm(t,"origColspan")===t.data.origColspan}function s_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Um(t))return s_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)_(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,cF(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Um(a)&&(l.isCollapsed=jm(a,"isCollapsed"))}),{rollbackModification:()=>a_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function a_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Um(t))return a_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)_(o,l=>{cF(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=jm(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Um(l)&&(u.isCollapsed=jm(l,"isCollapsed"))}),{rollbackModification:()=>s_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function Joe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(nt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function ese(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(nt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const uA=new Map([["collapse",a_],["expand",s_],["hide-column",Joe],["show-column",ese]]);function tse(t,e,n){if(!uA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return uA.get(t)(e,n)}function pg(t){const e=[];return _(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=rse(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(rF());else{const f=nse(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function nse(t){const{crossHiddenColumns:e,...n}=fR(t);return n}function rse(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function WS(t,e,n){ise(t,e),e.set(t,n)}function ise(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lh(t,e,n){return t.set(hF(t,e),n),n}function Ot(t,e){return t.get(hF(t,e))}function hF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ki=new WeakMap,ir=new WeakMap,za=new WeakMap;class ose{constructor(){WS(this,Ki,new Uoe),WS(this,ir,new Qoe(Ot(Ki,this))),WS(this,za,[[]])}setState(e){Ot(Ki,this).setData(e);let n=!1;try{Ot(ir,this).buildTree()}catch{Ot(ir,this).clear(),Ot(Ki,this).clear(),n=!0}return lh(za,this,pg(Ot(ir,this).getRoots())),n}setColumnsLimit(e){Ot(Ki,this).setColumnsLimit(e)}mergeStateWith(e){const n=Le(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Ot(Ki,this).mergeWith(n),Ot(ir,this).buildTree(),lh(za,this,pg(Ot(ir,this).getRoots()))}mapState(e){Ot(Ki,this).map(e),Ot(ir,this).buildTree(),lh(za,this,pg(Ot(ir,this).getRoots()))}mapNodes(e){return an(Ot(ir,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Ot(ir,this).getNode(n,r);let o;return i&&(o=tse(e,i,r),lh(za,this,pg(Ot(ir,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Ot(za,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Ot(ir,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Ot(ir,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},oF)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Ot(Ki,this).getLayersCount()}getColumnsCount(){return Ot(Ki,this).getColumnsCount()}clear(){lh(za,this,[]),Ot(Ki,this).clear(),Ot(ir,this).clear()}}function uh(t,e,n){return(e=sse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sse(t){var e=ase(t,"string");return typeof e=="symbol"?e:e+""}function ase(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lse{constructor(e,n){uh(this,"hot",void 0),uh(this,"nestedHeaderSettingsGetter",void 0),uh(this,"layersCount",0),uh(this,"container",void 0),uh(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let p=f.label;s&&(p+='<button class="changeType"></button>'),Rl(d,p),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function use(t,e){dF(t,e),e.add(t)}function cA(t,e,n){return(e=cse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cse(t){var e=hse(t,"string");return typeof e=="symbol"?e:e+""}function hse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ch(t,e,n){dF(t,e),e.set(t,n)}function dF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zo(t,e,n){return t.set(xt(t,e),n),n}function ke(t,e){return t.get(xt(t,e))}function xt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hA="nestedHeaders",dse=280;var ot=new WeakMap,Ts=new WeakMap,Gh=new WeakMap,Xp=new WeakMap,zm=new WeakMap,$t=new WeakSet;class fse extends Ue{constructor(){super(...arguments),use(this,$t),ch(this,ot,new ose),ch(this,Ts,null),ch(this,Gh,null),ch(this,Xp,!1),ch(this,zm,null),cA(this,"ghostTable",new lse(this.hot,(e,n)=>this.getHeaderSettings(e,n))),cA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return hA}static get PLUGIN_PRIORITY(){return dse}isEnabled(){return!!this.hot.getSettings()[hA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Ke(nt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>xt($t,this,Pse).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,Ose).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,wse).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,vse).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,Cse).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,yse).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,Sse).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,bse).call(e,...i)}),this.addHook("afterSelection",()=>xt($t,this,wg).call(this)),this.addHook("afterSelectionFocusSet",()=>xt($t,this,wg).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,gse).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>xt($t,this,Ese).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,_se).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,Mse).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,mse).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,pse).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,Rse).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,Tse).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt($t,e,Ise).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>xt($t,this,wg).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>xt($t,this,wg).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();ke(ot,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=ke(ot,this).setState(e)),this.detectedOverlappedHeaders&&Ke(nt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";ke(ot,this).triggerColumnModification(i,r)}),!ke(Ts,this)&&this.enabled&&Zo(Ts,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";ke(ot,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),ke(ot,this).clear(),ke(Ts,this).unsubscribe(),Zo(Ts,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return ke(ot,this)}getLayersCount(){return ke(ot,this).getLayersCount()}getHeaderSettings(e,n){return ke(ot,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),me(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),me(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),me(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),me(o,"hiddenHeader"),me(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=ke(ot,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)Y(o,"hiddenHeader");else if(c>1){var p,v,S;const{wtOverlays:E}=l._wt,C=(p=E.topInlineStartCornerOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),I=(v=E.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o);((S=E.topOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(o))&&u<r&&Y(o,"hiddenHeaderText");const $=C||I?Math.min(c,r-i):c;$>1&&o.setAttribute("colspan",$)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(me(E,this.hot.getColumnMeta(u).headerClassName),Y(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=ke(ot,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Zo(ot,this,null),ke(Ts,this)!==null&&(ke(Ts,this).unsubscribe(),Zo(Ts,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return ke(ot,this).getHeaderTreeNodeData(e.row,e.col)}}function wg(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=ke(ot,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function gse(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=ke(zm,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(Zo(zm,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=ke(ot,this).findLeftMostColumnIndex(a,l),p=ke(ot,this).findRightMostColumnIndex(a,l),v=p-f+1;if(f<c&&p>h)return f;if(s){let S=null;return f>=c&&p>h?v>d?(e.value="start",S=f):(e.value="end",S=p):f<c&&p<=h&&(v>d?(e.value="end",S=p):(e.value="start",S=f)),S}return f<=c?f:p}function mse(t,e,n){const r=ke(ot,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=ke(ot,this).getHeaderSettings(e,t);if(o===HE){if(!a)return r.columnIndex}else if(o===hk&&(l>s-i||!a))return null;return t}function pse(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const p=c+f,v=d-a;if(v===0)continue;((i=ke(ot,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[p][v]="")}}}function wse(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function vse(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Zo(Gh,this,e.clone()),Zo(Xp,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Cp(t)||Js(t)&&l||VD(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Cse(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=We(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function yse(){Zo(Xp,this,!1)}function Sse(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!ke(Xp,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=ke(ot,this).getHeaderTreeNodeData(ke(Gh,this).row,ke(Gh,this).col);if(e.setHighlight(ke(Gh,this)),o>e.getWidth()||i<n||i+o-1>r){const s=ke(ot,this).findTopMostEntireHeaderLevel(We(n,i,i+o-1),We(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function bse(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=ke(ot,this).findLeftMostColumnIndex(n.row,n.col),o=ke(ot,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Rse(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});Zo(zm,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function Ese(t){if(ke(ot,this).getLayersCount()>0){t.length=0;for(let e=0;e<ke(ot,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function Tse(t){const e=ke(ot,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=ke(ot,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),An(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?ke(ot,this).getHeaderTreeNodeData(0,n).columnIndex:n}function _se(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Mse(t,e,n){var r;const{label:i}=(r=ke(ot,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Ise(t,e){if(t<0)return this.hot.getCell(t,ke(ot,this).findLeftMostColumnIndex(t,e),!0)}function Pse(){this.updatePlugin()}function Ose(t,e){e||this.updatePlugin()}function hh(t,e,n){return(e=xse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xse(t){var e=Hse(t,"string");return typeof e=="symbol"?e:e+""}function Hse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ase{constructor(e,n){hh(this,"hot",void 0),hh(this,"data",null),hh(this,"plugin",void 0),hh(this,"parentReference",new WeakMap),hh(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},de(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&_(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&_(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Oe(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(_(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(de(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),de(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];_(r,o=>{i.push(this.getDataObject(o))}),_(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function dA(t,e,n){return(e=Nse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nse(t){var e=Dse(t,"string");return typeof e=="symbol"?e:e+""}function Dse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l_{constructor(e,n){dA(this,"hot",void 0),dA(this,"plugin",void 0),this.hot=n,this.plugin=e}}class ro extends l_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(_(l,c=>{c&&s.removeChild(c)}),Y(n,ro.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",de(0,i-1,()=>{const d=c.createElement("SPAN");Y(d,ro.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&ve(c,[Sl()]),Y(n,ro.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(Y(c,`${ro.CSS_CLASSES.button} ${ro.CSS_CLASSES.expandButton}`),u&&ve(n,[Xr(!1)])):(Y(c,`${ro.CSS_CLASSES.button} ${ro.CSS_CLASSES.collapseButton}`),u&&ve(n,[Xr(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let r=11;this.hot.stylesHandler.isClassicTheme()||(r=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}class kse extends l_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),_(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{de(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&_(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];_(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return _(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);_(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return _(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);_(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&_(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];_(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];_(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];_(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{_(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{_(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&_(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Ce(e.target,ro.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),ii(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Lse(t,e,n){$se(t,e),e.set(t,n)}function $se(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fse(t,e,n){return(e=Vse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vse(t){var e=Wse(t,"string");return typeof e=="symbol"?e:e+""}function Wse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bse(t,e){return t.get(jse(t,e))}function jse(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fA=new WeakMap;class Use extends l_{constructor(){super(...arguments),Fse(this,"dataManager",this.plugin.dataManager),Lse(this,fA,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(A0)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(N0)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return de(0,e.items.length-1,r=>{if(r===0)return _(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return de(0,e.items.length-1,n=>{const r=Bse(fA,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function vg(t,e,n){return(e=zse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zse(t){var e=Yse(t,"string");return typeof e=="symbol"?e:e+""}function Yse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gse{constructor(e){vg(this,"plugin",void 0),vg(this,"hot",void 0),vg(this,"dataManager",void 0),vg(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(p=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(p);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Rt(i)&&(Ke(nt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function qse(t,e){fF(t,e),e.add(t)}function gA(t,e,n){fF(t,e),e.set(t,n)}function fF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BS(t,e,n){return(e=Kse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kse(t){var e=Xse(t,"string");return typeof e=="symbol"?e:e+""}function Xse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xg(t,e){return t.get(dn(t,e))}function Ym(t,e,n){return t.set(dn(t,e),n),n}function dn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Gm="nestedRows",Zse=300,mA=Gm,Qse="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Zp=new WeakMap,hu=new WeakMap,vn=new WeakSet;class Jse extends Ue{constructor(){super(...arguments),qse(this,vn),BS(this,"dataManager",null),BS(this,"headersUI",null),BS(this,"collapsedRowsMap",null),gA(this,Zp,!1),gA(this,hu,!1)}static get PLUGIN_KEY(){return Gm}static get PLUGIN_PRIORITY(){return Zse}isEnabled(){return!!this.hot.getSettings()[Gm]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Dd),this.dataManager=new Ase(this,this.hot),this.collapsingUI=new kse(this,this.hot),this.headersUI=new ro(this,this.hot),this.contextMenuUI=new Use(this,this.hot),this.rowMoveController=new Gse(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,fae).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,gae).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,nae).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,rae).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,iae).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,tae).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,aae).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,sae).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,lae).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,uae).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,cae).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,hae).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,oae).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,dae).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(vn,e,eae).call(e,...r)}),this.addHook("beforeLoadData",n=>dn(vn,this,pA).call(this,n)),this.addHook("beforeUpdateData",n=>dn(vn,this,pA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:mA,relativeToGroup:aa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mA)}disableCoreAPIModifiers(){Ym(hu,this,!0)}enableCoreAPIModifiers(){Ym(hu,this,!1)}onModifyRowData(e){if(!Xg(hu,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Xg(hu,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Xg(hu,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function eae(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function tae(t,e,n){this.collapsingUI.toggleState(t,e,n)}function nae(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Ym(Zp,this,!0),this.dataManager.getData().slice()}function rae(t){return this.contextMenuUI.appendOptions(t)}function iae(t,e){this.headersUI.appendLevelIndicators(t,e)}function oae(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function sae(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{Ym(Zp,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function aae(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function lae(){this.collapsingUI.collapsedRowsStash.stash()}function uae(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function cae(){this.collapsingUI.collapsedRowsStash.stash()}function hae(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function dae(){this.dataManager.rewriteCache()}function fae(){this.headersUI.updateRowHeaderWidth()}function gae(t,e){Xg(Zp,this)&&(e.skipRender=!0)}function pA(t){if(!yk(t)){yE(Qse),this.hot.getSettings()[Gm]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function jS(t,e,n){return(e=mae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mae(t){var e=pae(t,"string");return typeof e=="symbol"?e:e+""}function pae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wae{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;jS(this,"rootWindow",void 0),jS(this,"prefix",void 0),jS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){_(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function vae(t,e,n){return(e=Cae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cae(t){var e=yae(t,"string");return typeof e=="symbol"?e:e+""}function yae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ne.getSingleton().register("persistentStateSave");ne.getSingleton().register("persistentStateLoad");ne.getSingleton().register("persistentStateReset");const wA="persistentState",Sae=0;class bae extends Ue{constructor(){super(...arguments),vae(this,"storage",void 0)}static get PLUGIN_KEY(){return wA}static get PLUGIN_PRIORITY(){return Sae}isEnabled(){return!!this.hot.getSettings()[wA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new wae(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Rae(t,e){Eae(t,e),e.add(t)}function Eae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function US(t,e,n){return(e=Tae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tae(t){var e=_ae(t,"string");return typeof e=="symbol"?e:e+""}function _ae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zS="search",Mae=190,Iae="htSearchResult",Pae=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Oae=function(t,e,n){return Rt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Rt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var YS=new WeakSet;class xae extends Ue{constructor(){super(...arguments),Rae(this,YS),US(this,"callback",Pae),US(this,"queryMethod",Oae),US(this,"searchResultClass",Iae)}static get PLUGIN_KEY(){return zS}static get PLUGIN_PRIORITY(){return Mae}isEnabled(){return this.hot.getSettings()[zS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[zS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vA(YS,e,CA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vA(YS,e,CA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return de(0,i-1,l=>{de(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,p=(h.search.queryMethod||r)(e,c,h);if(p){const v={row:l,col:u,data:c};s.push(v)}d&&d(a,l,u,c,p)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Pe(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function CA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Cg(t,e,n){return(e=Hae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hae(t){var e=Aae(t,"string");return typeof e=="symbol"?e:e+""}function Aae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gF{constructor(e){Cg(this,"viewportWidth",void 0),Cg(this,"overwriteColumnWidthFn",void 0),Cg(this,"baseWidths",new Map),Cg(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Nae extends gF{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),p=this.overwriteColumnWidthFn(f,d);f===p&&f>=Bu?(i.push([d,p]),a+=p):f!==p&&(i.push([d,p]),o.push(d),s-=p)}),s<=Bu){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,p]=h,v=p;o.includes(f)||(v=Math.round(p*l)),this.stretchedWidths.set(f,v),u=f,d<i.length-1&&(c+=v)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function yA(t,e,n){Dae(t,e),e.set(t,n)}function Dae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GS(t,e){return t.get(mF(t,e))}function yg(t,e,n){return t.set(mF(t,e),n),n}function mF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sg=new WeakMap,dh=new WeakMap;class kae extends gF{constructor(){super(...arguments),yA(this,Sg,0),yA(this,dh,-1)}prepare(e){super.prepare(e),yg(Sg,this,0),yg(dh,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),yg(dh,this,e),yg(Sg,this,n)}calculate(){if(GS(dh,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+GS(Sg,this),0);this.stretchedWidths.set(GS(dh,this),n)}}function Lae(t,e){pF(t,e),e.add(t)}function bg(t,e,n){pF(t,e),e.set(t,n)}function pF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e){return t.get(Iu(t,e))}function qS(t,e,n){return t.set(Iu(t,e),n),n}function Iu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $ae="stretchColumns";var xn=new WeakMap,du=new WeakMap,KS=new WeakMap,Rg=new WeakMap,fh=new WeakSet;class Fae{constructor(e){Lae(this,fh),bg(this,xn,void 0),bg(this,du,void 0),bg(this,KS,new Map([["all",new Nae(Iu(fh,this,SA).bind(this))],["last",new kae(Iu(fh,this,SA).bind(this))]])),bg(this,Rg,"none"),qS(xn,this,e),qS(du,this,Ft(xn,this).columnIndexMapper.createAndRegisterIndexMap($ae,"physicalIndexToValue"))}useStrategy(e){qS(Rg,this,Ft(KS,this).has(e)?e:"none")}refreshStretching(){if(Ft(Rg,this)==="none"){Ft(du,this).clear();return}Ft(xn,this).batchExecution(()=>{Ft(du,this).clear();const e=Ft(KS,this).get(Ft(Rg,this));let r=Ft(xn,this).view.getViewportWidth();Iu(fh,this,Vae).call(this)&&(r-=gn(Ft(xn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Ft(xn,this).countCols();i++)Ft(xn,this).columnIndexMapper.isHidden(Ft(xn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Iu(fh,this,Wae).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;Ft(du,this).setValueAtIndex(Ft(xn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return Ft(du,this).getValueAtIndex(Ft(xn,this).toPhysicalColumn(e))}}function Vae(){const{view:t,stylesHandler:e}=Ft(xn,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),r=Ft(xn,this).countRows(),i=e.getDefaultRowHeight();let o=0,s=!1;for(let l=0;l<r;l++){var a;if(o+=((a=Ft(xn,this).getRowHeight(l))!==null&&a!==void 0?a:i)+(l===0?1:0),o>n){s=!0;break}}return s}function Wae(t){var e;return(e=Ft(xn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Bu}function SA(t,e){return Ft(xn,this).runHooks("beforeStretchingColumnWidth",t,e)}function Bae(t,e){wF(t,e),e.add(t)}function XS(t,e,n){wF(t,e),e.set(t,n)}function wF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZS(t,e,n){return t.set(qm(t,e),n),n}function Fo(t,e){return t.get(qm(t,e))}function qm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jae="stretchColumns",Uae=155;var bu=new WeakMap,Eg=new WeakMap,gh=new WeakMap,QS=new WeakSet;class zae extends Ue{constructor(){super(...arguments),Bae(this,QS),XS(this,bu,new Fae(this.hot)),XS(this,Eg,null),XS(this,gh,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;Fo(Eg,this)!==null&&Fo(Eg,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),ZS(Eg,this,i.width)})})}))}static get PLUGIN_KEY(){return jae}static get PLUGIN_PRIORITY(){return Uae}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Fo(bu,this).useStrategy(this.hot.getSettings().stretchH),Fo(gh,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qm(QS,e,Gae).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qm(QS,e,Yae).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Fo(bu,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Fo(gh,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Fo(bu,this).getStretchedWidth(e)}destroy(){Fo(gh,this).disconnect(),ZS(gh,this,null),ZS(bu,this,null),super.destroy()}}function Yae(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function Gae(t){t&&Fo(bu,this).refreshStretching()}function qae(t,e){Kae(t,e),e.add(t)}function Kae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tg(t,e,n){return(e=Xae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xae(t){var e=Zae(t,"string");return typeof e=="symbol"?e:e+""}function Zae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qae="touchScroll",Jae=200;var _g=new WeakSet;class ele extends Ue{constructor(){super(...arguments),qae(this,_g),Tg(this,"scrollbars",[]),Tg(this,"clones",[]),Tg(this,"lockedCollection",!1),Tg(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Qae}static get PLUGIN_PRIORITY(){return Jae}static get SETTING_KEYS(){return!0}isEnabled(){return rE()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>JS(_g,this,tle).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>JS(_g,this,nle).call(this)),this.addHook("afterMomentumScroll",()=>JS(_g,this,rle).call(this))}}function tle(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function nle(){this.freezeOverlays=!0,_(this.clones,t=>{Y(t,"hide-tween")})}function rle(){this.freezeOverlays=!1,_(this.clones,t=>{me(t,"hide-tween"),Y(t,"show-tween")}),this.hot._registerTimeout(()=>{_(this.clones,t=>{me(t,"show-tween")})},400),_(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function ile(t,e){ole(t,e),e.add(t)}function ole(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sle(t,e,n){return(e=ale(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ale(t){var e=lle(t,"string");return typeof e=="symbol"?e:e+""}function lle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ule(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zg="trimRows",cle=330;var bA=new WeakSet;class hle extends Ue{constructor(){super(...arguments),ile(this,bA),sle(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Zg}static get PLUGIN_PRIORITY(){return cle}isEnabled(){return!!this.hot.getSettings()[Zg]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Dd),this.trimmedRowsMap.addLocalHook("init",()=>ule(bA,this,dle).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Zg];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),_(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(_(e,l=>{o[l]=!1}),i=an(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function dle(){const t=this.hot.getSettings()[Zg];Array.isArray(t)&&this.hot.batchExecution(()=>{_(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function fle(t,e,n){return(e=gle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gle(t){var e=mle(t,"string");return typeof e=="symbol"?e:e+""}function mle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class si{constructor(e){fle(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Mg(t,e,n){return(e=ple(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ple(t){var e=wle(t,"string");return typeof e=="symbol"?e:e+""}function wle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u_ extends si{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),Mg(this,"stateBefore",void 0),Mg(this,"range",void 0),Mg(this,"type",void 0),Mg(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new u_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){_(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Is(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function RA(t,e,n){return(e=vle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vle(t){var e=Cle(t,"string");return typeof e=="symbol"?e:e+""}function Cle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c_ extends si{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),RA(this,"columns",void 0),RA(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new c_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),i_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function EA(t,e,n){return(e=yle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yle(t){var e=Sle(t,"string");return typeof e=="symbol"?e:e+""}function Sle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h_ extends si{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),EA(this,"previousSortState",void 0),EA(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new h_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function TA(t,e,n){return(e=ble(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ble(t){var e=Rle(t,"string");return typeof e=="symbol"?e:e+""}function Rle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class d_ extends si{constructor(e){let{index:n,amount:r}=e;super("insert_col"),TA(this,"index",void 0),TA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new d_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function _A(t,e,n){return(e=Ele(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ele(t){var e=Tle(t,"string");return typeof e=="symbol"?e:e+""}function Tle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f_ extends si{constructor(e){let{index:n,amount:r}=e;super("insert_row"),_A(this,"index",void 0),_A(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new f_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Ig(t,e,n){return(e=_le(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _le(t){var e=Mle(t,"string");return typeof e=="symbol"?e:e+""}function Mle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g_ extends si{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Ig(this,"changes",void 0),Ig(this,"selected",void 0),Ig(this,"countCols",void 0),Ig(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new g_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=Ln(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=Ln(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function MA(t,e,n){return(e=Ile(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ile(t){var e=Ple(t,"string");return typeof e=="symbol"?e:e+""}function Ple(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m_ extends si{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),MA(this,"conditionsStack",void 0),MA(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new m_({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function Ole(t,e,n){return(e=xle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xle(t){var e=Hle(t,"string");return typeof e=="symbol"?e:e+""}function Hle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p_ extends si{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),Ole(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new p_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function vF(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return de(r,i,l=>{de(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function No(t,e,n){return(e=Ale(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ale(t){var e=Nle(t,"string");return typeof e=="symbol"?e:e+""}function Nle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w_ extends si{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),No(this,"index",void 0),No(this,"indexes",void 0),No(this,"data",void 0),No(this,"amount",void 0),No(this,"headers",void 0),No(this,"columnPositions",void 0),No(this,"rowPositions",void 0),No(this,"fixedColumnsStart",void 0),No(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return de(l.length-1,p=>{const v=[],S=l[p];de(u,c,E=>{v.push(S[e.toPhysicalColumn(E)])}),h.push(v)}),de(i-1,p=>{f.push(e.toPhysicalColumn(u+p))}),Array.isArray(e.getSettings().colHeaders)&&de(i-1,p=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+p)]||null)}),new w_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:vF(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Le(this.data[c],o));const l=Le(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),_(e.getSourceDataArray(),(c,h)=>{_(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&_(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function fu(t,e,n){return(e=Dle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dle(t){var e=kle(t,"string");return typeof e=="symbol"?e:e+""}function kle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v_ extends si{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),fu(this,"index",void 0),fu(this,"data",void 0),fu(this,"fixedRowsBottom",void 0),fu(this,"fixedRowsTop",void 0),fu(this,"rowIndexesSequence",void 0),fu(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Ln(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new v_({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:vF(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function IA(t,e,n){return(e=Lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lle(t){var e=$le(t,"string");return typeof e=="symbol"?e:e+""}function $le(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C_ extends si{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),IA(this,"rows",void 0),IA(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new C_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),i_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Fle(t,e,n){return(e=Vle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vle(t){var e=Wle(t,"string");return typeof e=="symbol"?e:e+""}function Wle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y_ extends si{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),Fle(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new y_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function Ble(t,e){[u_,c_,h_,d_,f_,g_,m_,p_,w_,v_,C_,y_].forEach(n=>n.startRegisteringEvents(t,e))}function jle(t,e){Ule(t,e),e.add(t)}function Ule(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eb(t,e,n){return(e=zle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zle(t){var e=Yle(t,"string");return typeof e=="symbol"?e:e+""}function Yle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const PA="undoRedo",Gle="undoRedo",qle=1e3;ne.getSingleton().register("beforeUndo");ne.getSingleton().register("afterUndo");ne.getSingleton().register("beforeRedo");ne.getSingleton().register("afterRedo");const OA=new Set;var Pg=new WeakSet;class Kle extends Ue{static get PLUGIN_KEY(){return Gle}static get PLUGIN_PRIORITY(){return qle}static get SETTING_KEYS(){return!0}constructor(e){super(e),jle(this,Pg),eb(this,"doneActions",[]),eb(this,"undoneActions",[]),eb(this,"ignoreNewActions",!1),Ble(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return tb(Pg,e,Xle).call(e,...r)}),this.registerShortcuts(),tb(Pg,this,Zle).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),tb(Pg,this,Qle).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:PA};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(PA)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Ln(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Ln(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function Xle(t,e){e==="loadData"&&this.clear()}function Zle(){const t=e=>{OA.has(e)||(Ke(nt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),OA.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Qle(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function Jle(){je(Hh),je(g7),je(Ah),je(z7),je(J7),je(VL),je(q5),je(HZ),je(Up),je(VQ),je(dJ),je(yJ),je(Gp),je(nee),je(Zte),je(One),je(rre),je(mre),je(Mre),je($re),je(qre),je(die),je(Sie),je(ioe),je(koe),je(Woe),je(fse),je(Jse),je(bae),je(xae),je(zae),je(ele),je(hle),je(Kle)}function eue(){$9(),a8(),p8(),k8(),Jle()}function tue(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var nb,rb,ib,ob,sb;eue();tue(Se);Se.__GhostTable=BT;Se._getListenersCounter=UY;Se._getRegisteredMapsCounter=KK;Se.EventManager=Qr;const nue=[bz,oY,NK,u8,nY,vY,_z,hG,tY,Iz,SY,cG],rue=[gY,bY];Se.helper={};Se.dom={};_(nue,t=>{_(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.helper[e]=t[e])})});_(rue,t=>{_(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.dom[e]=t[e])})});Se.cellTypes=(nb=Se.cellTypes)!==null&&nb!==void 0?nb:{};_(J3(),t=>{Se.cellTypes[t]=yT(t)});Se.cellTypes.registerCellType=Fr;Se.cellTypes.getCellType=yT;Se.editors=(rb=Se.editors)!==null&&rb!==void 0?rb:{};_($Y(),t=>{Se.editors[`${kn(t)}Editor`]=lm(t)});Se.editors.registerEditor=lr;Se.editors.getEditor=lm;Se.renderers=(ib=Se.renderers)!==null&&ib!==void 0?ib:{};_(_G(),t=>{const e=um(t);t==="base"&&(Se.renderers.cellDecorator=e),Se.renderers[`${kn(t)}Renderer`]=e});Se.renderers.registerRenderer=Rr;Se.renderers.getRenderer=um;Se.validators=(ob=Se.validators)!==null&&ob!==void 0?ob:{};_(PG(),t=>{Se.validators[`${kn(t)}Validator`]=TE(t)});Se.validators.registerValidator=Xa;Se.validators.getValidator=TE;Se.plugins=(sb=Se.plugins)!==null&&sb!==void 0?sb:{};_(EE(),t=>{Se.plugins[t]=xd(t)});Se.plugins[`${kn(Ue.PLUGIN_KEY)}Plugin`]=Ue;Se.plugins.registerPlugin=je;Se.plugins.getPlugin=xd;const iue={__name:"TableView",setup(t){const e=TF(null);let n=null;const r=()=>{colHeaders.push("aaa")};A_(["é¾åº¦æçº§","è°±é¢ID","æ¨¡å¼","ç¶æ","é³é¢æ»æ¶é¿(ç§)","é¾åº¦åç§°","OD","AR","BPM","ååæ°","æ»æ¡æ°","è½¬çæ°","CS","HP","æ¸¸ç©é¿åº¦(ç§)","è¿å³æ¬¡æ°","æ¸¸ç©æ¬¡æ°","è°±é¢é¾æ¥","æå¤§è¿å»æ°","è°±é¢å¶ä½è","ä½èID","ä½èç¨æ·å","è°±é¢éä¿¡æ¯","æ­æ²èºæ¯å®¶","èºæ¯å®¶(åè¯­è¨)","å°é¢å¾","è°±é¢éå¶ä½è","æ¶èæ°","è°±é¢éID","è¯å¬é¾æ¥","æ­æ²æ é¢","æ­æ²æ é¢(åè¯­è¨)","è°±é¢éä½èID","æ¯å¦å«è§é¢","è°±é¢éBPM","æåæ´æ°æ¥æ","Ranked æ¥æ","è°±é¢è¯å","æ¯å¦å«æäºæ¿","æäº¤æ¥æ","æ ç­¾"]);const i=A_(["è°±é¢ID","è¯´æ","æ­æ²æ é¢(åè¯­è¨)","èºæ¯å®¶(åè¯­è¨)","é¾åº¦æçº§"]);return _F(()=>{n=new Se(e.value,{colHeaders:i,rowHeaders:!0,stretchH:"all",width:"100%",height:400,minCols:i.length,manualColumnResize:!0,manualColumnMove:!0,manualRowMove:!0,manualRowResize:!0,autoWrapRow:!0,themeName:"ht-theme-horizon",licenseKey:"non-commercial-and-evaluation",contextMenu:{items:{row_above:{name:"å¨ä¸æ¹æå¥è¡"},row_below:{name:"å¨ä¸æ¹æå¥è¡"},col_left:{name:"å¨å·¦ä¾§æå¥å"},col_right:{name:"å¨å³ä¾§æå¥å"},remove_row:{name:"å é¤è¡"},remove_col:{name:"å é¤å"},undo:{name:"æ¤é"},redo:{name:"éå"},alignment:{name:"å¯¹é½"}}},afterColumnMove(o,s,a,l,u){if(u&&l){const c=this.getColHeader();console.log("newHeaders",c)}}}),n.addHook("afterRender",()=>{if(!e.value)return;const o=e.value.querySelectorAll(".ht_clone_top th");o.length&&o.forEach((s,a)=>{s.ondblclick=null,s.ondblclick=l=>{const u=n.getColHeader(a-1),c=document.createElement("input");c.type="text",c.value=u,c.style.position="absolute",c.style.left=s.getBoundingClientRect().left+"px",c.style.top=s.getBoundingClientRect().top+"px",c.style.width=s.offsetWidth+"px",c.style.height=s.offsetHeight+"px",c.style.zIndex=9999,document.body.appendChild(c),n.deselectCell(),c.focus(),c.addEventListener("blur",()=>{const h=c.value.trim()||u,d=n.getSettings().colHeaders,f=n.toPhysicalColumn(a-1);d[f]=h,n.updateSettings({colHeaders:d}),document.body.removeChild(c)}),c.addEventListener("keydown",h=>{h.key==="Enter"&&c.blur()})}})})}),(o,s)=>{const a=xF;return HF(),MF("div",null,[IF("div",{class:"handsontable",ref_key:"hotContainer",ref:e},null,512),PF(a,{onClick:r},{default:OF(()=>s[0]||(s[0]=[AF("æµè¯")])),_:1,__:[0]})])}}},yue=EF(iue,[["__scopeId","data-v-11ee5399"]]);export{yue as default};
