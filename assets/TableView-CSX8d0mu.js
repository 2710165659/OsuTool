import{g as Wm,i as yl,c as si,u as pe,a as qW,r as Kt,b as lc,d as ED,e as KW,f as XW,o as bc,h as jp,j as AM,_ as qd,k as Bi,l as $n,w as aa,n as fR,m as ZW,p as TD,q as Kd,s as Td,t as uc,v as Fn,T as JW,x as yE,y as Up,z as To,A as cc,B as bl,C as $r,D as Bm,E as jm,F as bE,N as nv,G as Ni,H as QW,I as eB,J as tB,K as gR,L as nB,M as vr,O as rB,P as iB,Q as _D,R as oB,S as HM,U as sB,V as aB,W as lB,X as uB,Y as cB,Z as hB,$ as NM,a0 as dB,a1 as fB,a2 as gB,a3 as mB,a4 as pB,a5 as wB,a6 as vB,a7 as CB,a8 as yB,a9 as bB,aa as SB,ab as RB,ac as EB}from"./index-D0ZRCKfb.js";var TB=typeof global=="object"&&global&&global.Object===Object&&global,_B=typeof self=="object"&&self&&self.Object===Object&&self,SE=TB||_B||Function("return this")(),hc=SE.Symbol,MD=Object.prototype,MB=MD.hasOwnProperty,IB=MD.toString,jc=hc?hc.toStringTag:void 0;function PB(t){var e=MB.call(t,jc),n=t[jc];try{t[jc]=void 0;var r=!0}catch{}var i=IB.call(t);return r&&(e?t[jc]=n:delete t[jc]),i}var OB=Object.prototype,xB=OB.toString;function AB(t){return xB.call(t)}var HB="[object Null]",NB="[object Undefined]",DM=hc?hc.toStringTag:void 0;function ID(t){return t==null?t===void 0?NB:HB:DM&&DM in Object(t)?PB(t):AB(t)}function DB(t){return t!=null&&typeof t=="object"}var kB="[object Symbol]";function RE(t){return typeof t=="symbol"||DB(t)&&ID(t)==kB}function LB(t,e){for(var n=-1,r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var EE=Array.isArray,kM=hc?hc.prototype:void 0,LM=kM?kM.toString:void 0;function PD(t){if(typeof t=="string")return t;if(EE(t))return LB(t,PD)+"";if(RE(t))return LM?LM.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function OD(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var $B="[object AsyncFunction]",FB="[object Function]",VB="[object GeneratorFunction]",WB="[object Proxy]";function BB(t){if(!OD(t))return!1;var e=ID(t);return e==FB||e==VB||e==$B||e==WB}var rv=SE["__core-js_shared__"],$M=function(){var t=/[^.]+$/.exec(rv&&rv.keys&&rv.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function jB(t){return!!$M&&$M in t}var UB=Function.prototype,zB=UB.toString;function YB(t){if(t!=null){try{return zB.call(t)}catch{}try{return t+""}catch{}}return""}var GB=/[\\^$.*+?()[\]{}|]/g,qB=/^\[object .+?Constructor\]$/,KB=Function.prototype,XB=Object.prototype,ZB=KB.toString,JB=XB.hasOwnProperty,QB=RegExp("^"+ZB.call(JB).replace(GB,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ej(t){if(!OD(t)||jB(t))return!1;var e=BB(t)?QB:qB;return e.test(YB(t))}function tj(t,e){return t?.[e]}function xD(t,e){var n=tj(t,e);return ej(n)?n:void 0}function nj(t,e){return t===e||t!==t&&e!==e}var rj=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ij=/^\w*$/;function oj(t,e){if(EE(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||RE(t)?!0:ij.test(t)||!rj.test(t)||e!=null&&t in Object(e)}var _d=xD(Object,"create");function sj(){this.__data__=_d?_d(null):{},this.size=0}function aj(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var lj="__lodash_hash_undefined__",uj=Object.prototype,cj=uj.hasOwnProperty;function hj(t){var e=this.__data__;if(_d){var n=e[t];return n===lj?void 0:n}return cj.call(e,t)?e[t]:void 0}var dj=Object.prototype,fj=dj.hasOwnProperty;function gj(t){var e=this.__data__;return _d?e[t]!==void 0:fj.call(e,t)}var mj="__lodash_hash_undefined__";function pj(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=_d&&e===void 0?mj:e,this}function _l(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}_l.prototype.clear=sj;_l.prototype.delete=aj;_l.prototype.get=hj;_l.prototype.has=gj;_l.prototype.set=pj;function wj(){this.__data__=[],this.size=0}function zp(t,e){for(var n=t.length;n--;)if(nj(t[n][0],e))return n;return-1}var vj=Array.prototype,Cj=vj.splice;function yj(t){var e=this.__data__,n=zp(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():Cj.call(e,n,1),--this.size,!0}function bj(t){var e=this.__data__,n=zp(e,t);return n<0?void 0:e[n][1]}function Sj(t){return zp(this.__data__,t)>-1}function Rj(t,e){var n=this.__data__,r=zp(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function Sc(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Sc.prototype.clear=wj;Sc.prototype.delete=yj;Sc.prototype.get=bj;Sc.prototype.has=Sj;Sc.prototype.set=Rj;var Ej=xD(SE,"Map");function Tj(){this.size=0,this.__data__={hash:new _l,map:new(Ej||Sc),string:new _l}}function _j(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Yp(t,e){var n=t.__data__;return _j(e)?n[typeof e=="string"?"string":"hash"]:n.map}function Mj(t){var e=Yp(this,t).delete(t);return this.size-=e?1:0,e}function Ij(t){return Yp(this,t).get(t)}function Pj(t){return Yp(this,t).has(t)}function Oj(t,e){var n=Yp(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function $l(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}$l.prototype.clear=Tj;$l.prototype.delete=Mj;$l.prototype.get=Ij;$l.prototype.has=Pj;$l.prototype.set=Oj;var xj="Expected a function";function TE(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(xj);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(TE.Cache||$l),n}TE.Cache=$l;var Aj=500;function Hj(t){var e=TE(t,function(r){return n.size===Aj&&n.clear(),r}),n=e.cache;return e}var Nj=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dj=/\\(\\)?/g,kj=Hj(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Nj,function(n,r,i,o){e.push(i?o.replace(Dj,"$1"):r||n)}),e});function Lj(t){return t==null?"":PD(t)}function $j(t,e){return EE(t)?t:oj(t,e)?[t]:kj(Lj(t))}function Fj(t){if(typeof t=="string"||RE(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function Vj(t,e){e=$j(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[Fj(e[n++])];return n&&n==r?t:void 0}function Wj(t,e,n){var r=t==null?void 0:Vj(t,e);return r===void 0?n:r}function Bj(t){return t==null}class jj extends Error{constructor(e){super(e),this.name="ElementPlusError"}}function Uj(t,e){throw new jj(`[${t}] ${e}`)}const FM={current:0},VM=Kt(0),zj=2e3,WM=Symbol("elZIndexContextKey"),Yj=Symbol("zIndexContextKey"),Gj=t=>{const e=Wm()?yl(WM,FM):FM,n=Wm()?yl(Yj,void 0):void 0,r=si(()=>{const s=pe(n);return qW(s)?s:zj}),i=si(()=>r.value+VM.value),o=()=>(e.current++,VM.value=e.current,i.value);return!lc&&yl(WM),{initialZIndex:r,currentZIndex:i,nextZIndex:o}};var qj={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const Kj=t=>(e,n)=>Xj(e,n,pe(t)),Xj=(t,e,n)=>Wj(n,t,t).replace(/\{(\w+)\}/g,(r,i)=>{var o;return`${(o=e?.[i])!=null?o:`{${i}}`}`}),Zj=t=>{const e=si(()=>pe(t).name),n=ED(t)?t:Kt(t);return{lang:e,locale:n,t:Kj(t)}},Jj=Symbol("localeContextKey"),Qj=t=>{const e=yl(Jj,Kt());return Zj(si(()=>e.value||qj))},AD="update:modelValue";let If;const eU=t=>{var e;if(!lc)return 0;if(If!==void 0)return If;const n=document.createElement("div");n.className=`${t}-scrollbar__wrap`,n.style.visibility="hidden",n.style.width="100px",n.style.position="absolute",n.style.top="-9999px",document.body.appendChild(n);const r=n.offsetWidth;n.style.overflow="scroll";const i=document.createElement("div");i.style.width="100%",n.appendChild(i);const o=i.offsetWidth;return(e=n.parentNode)==null||e.removeChild(n),If=r-o,If},BM={prefix:Math.floor(Math.random()*1e4),current:0},tU=Symbol("elIdInjection"),nU=()=>Wm()?yl(tU,BM):BM,jM=t=>{const e=nU(),n=KW();return XW(()=>pe(t)||`${n.value}-id-${e.prefix}-${e.current++}`)},rU=t=>{if(t.tabIndex>0||t.tabIndex===0&&t.getAttribute("tabIndex")!==null)return!0;if(t.tabIndex<0||t.hasAttribute("disabled")||t.getAttribute("aria-disabled")==="true")return!1;switch(t.nodeName){case"A":return!!t.href&&t.rel!=="ignore";case"INPUT":return!(t.type==="hidden"||t.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},iv="focus-trap.focus-after-trapped",ov="focus-trap.focus-after-released",iU="focus-trap.focusout-prevented",UM={cancelable:!0,bubbles:!1},oU={cancelable:!0,bubbles:!1},zM="focusAfterTrapped",YM="focusAfterReleased",HD=Symbol("elFocusTrap"),_E=Kt(),Gp=Kt(0),ME=Kt(0);let Pf=0;const ND=t=>{const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0||r===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e},GM=(t,e)=>{for(const n of t)if(!sU(n,e))return n},sU=(t,e)=>{if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1},aU=t=>{const e=ND(t),n=GM(e,t),r=GM(e.reverse(),t);return[n,r]},lU=t=>t instanceof HTMLInputElement&&"select"in t,js=(t,e)=>{if(t&&t.focus){const n=document.activeElement;let r=!1;AM(t)&&!rU(t)&&!t.getAttribute("tabindex")&&(t.setAttribute("tabindex","-1"),r=!0),t.focus({preventScroll:!0}),ME.value=window.performance.now(),t!==n&&lU(t)&&e&&t.select(),AM(t)&&r&&t.removeAttribute("tabindex")}};function qM(t,e){const n=[...t],r=t.indexOf(e);return r!==-1&&n.splice(r,1),n}const uU=()=>{let t=[];return{push:r=>{const i=t[0];i&&r!==i&&i.pause(),t=qM(t,r),t.unshift(r)},remove:r=>{var i,o;t=qM(t,r),(o=(i=t[0])==null?void 0:i.resume)==null||o.call(i)}}},cU=(t,e=!1)=>{const n=document.activeElement;for(const r of t)if(js(r,e),document.activeElement!==n)return},KM=uU(),hU=()=>Gp.value>ME.value,Of=()=>{_E.value="pointer",Gp.value=window.performance.now()},XM=()=>{_E.value="keyboard",Gp.value=window.performance.now()},dU=()=>(bc(()=>{Pf===0&&(document.addEventListener("mousedown",Of),document.addEventListener("touchstart",Of),document.addEventListener("keydown",XM)),Pf++}),jp(()=>{Pf--,Pf<=0&&(document.removeEventListener("mousedown",Of),document.removeEventListener("touchstart",Of),document.removeEventListener("keydown",XM))}),{focusReason:_E,lastUserFocusTimestamp:Gp,lastAutomatedFocusTimestamp:ME}),xf=t=>new CustomEvent(iU,{...oU,detail:t}),DD={tab:"Tab",esc:"Escape"};let ku=[];const ZM=t=>{t.code===DD.esc&&ku.forEach(e=>e(t))},fU=t=>{bc(()=>{ku.length===0&&document.addEventListener("keydown",ZM),lc&&ku.push(t)}),jp(()=>{ku=ku.filter(e=>e!==t),ku.length===0&&lc&&document.removeEventListener("keydown",ZM)})},gU=Bi({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[zM,YM,"focusin","focusout","focusout-prevented","release-requested"],setup(t,{emit:e}){const n=Kt();let r,i;const{focusReason:o}=dU();fU(g=>{t.trapped&&!s.paused&&e("release-requested",g)});const s={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},a=g=>{if(!t.loop&&!t.trapped||s.paused)return;const{code:w,altKey:C,ctrlKey:S,metaKey:v,currentTarget:E,shiftKey:P}=g,{loop:x}=t,_=w===DD.tab&&!C&&!S&&!v,M=document.activeElement;if(_&&M){const V=E,[z,O]=aU(V);if(z&&O){if(!P&&M===O){const Z=xf({focusReason:o.value});e("focusout-prevented",Z),Z.defaultPrevented||(g.preventDefault(),x&&js(z,!0))}else if(P&&[z,V].includes(M)){const Z=xf({focusReason:o.value});e("focusout-prevented",Z),Z.defaultPrevented||(g.preventDefault(),x&&js(O,!0))}}else if(M===V){const Z=xf({focusReason:o.value});e("focusout-prevented",Z),Z.defaultPrevented||g.preventDefault()}}};TD(HD,{focusTrapRef:n,onKeydown:a}),aa(()=>t.focusTrapEl,g=>{g&&(n.value=g)},{immediate:!0}),aa([n],([g],[w])=>{g&&(g.addEventListener("keydown",a),g.addEventListener("focusin",c),g.addEventListener("focusout",h)),w&&(w.removeEventListener("keydown",a),w.removeEventListener("focusin",c),w.removeEventListener("focusout",h))});const l=g=>{e(zM,g)},u=g=>e(YM,g),c=g=>{const w=pe(n);if(!w)return;const C=g.target,S=g.relatedTarget,v=C&&w.contains(C);t.trapped||S&&w.contains(S)||(r=S),v&&e("focusin",g),!s.paused&&t.trapped&&(v?i=C:js(i,!0))},h=g=>{const w=pe(n);if(!(s.paused||!w))if(t.trapped){const C=g.relatedTarget;!Bj(C)&&!w.contains(C)&&setTimeout(()=>{if(!s.paused&&t.trapped){const S=xf({focusReason:o.value});e("focusout-prevented",S),S.defaultPrevented||js(i,!0)}},0)}else{const C=g.target;C&&w.contains(C)||e("focusout",g)}};async function d(){await fR();const g=pe(n);if(g){KM.push(s);const w=g.contains(document.activeElement)?r:document.activeElement;if(r=w,!g.contains(w)){const S=new Event(iv,UM);g.addEventListener(iv,l),g.dispatchEvent(S),S.defaultPrevented||fR(()=>{let v=t.focusStartEl;ZW(v)||(js(v),document.activeElement!==v&&(v="first")),v==="first"&&cU(ND(g),!0),(document.activeElement===w||v==="container")&&js(g)})}}}function f(){const g=pe(n);if(g){g.removeEventListener(iv,l);const w=new CustomEvent(ov,{...UM,detail:{focusReason:o.value}});g.addEventListener(ov,u),g.dispatchEvent(w),!w.defaultPrevented&&(o.value=="keyboard"||!hU()||g.contains(document.activeElement))&&js(r??document.body),g.removeEventListener(ov,u),KM.remove(s)}}return bc(()=>{t.trapped&&d(),aa(()=>t.trapped,g=>{g?d():f()})}),jp(()=>{t.trapped&&f(),n.value&&(n.value.removeEventListener("keydown",a),n.value.removeEventListener("focusin",c),n.value.removeEventListener("focusout",h),n.value=void 0)}),{onKeydown:a}}});function mU(t,e,n,r,i,o){return $n(t.$slots,"default",{handleKeydown:t.onKeydown})}var pU=qd(gU,[["render",mU],["__file","focus-trap.vue"]]);const kD=Kd({to:{type:Td([String,Object]),required:!0},disabled:Boolean}),wU=Bi({__name:"teleport",props:kD,setup(t){return(e,n)=>e.disabled?$n(e.$slots,"default",{key:0}):(Fn(),uc(JW,{key:1,to:e.to},[$n(e.$slots,"default")],8,["to"]))}});var vU=qd(wU,[["__file","teleport.vue"]]);const CU=yE(vU);var JM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};const yU=Kd({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:Td([String,Object,Array]),default:""},headerClass:String,bodyClass:String,footerClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),bU=Bi({name:"ElCard"}),SU=Bi({...bU,props:yU,setup(t){const e=Up("card");return(n,r)=>(Fn(),To("div",{class:$r([pe(e).b(),pe(e).is(`${n.shadow}-shadow`)])},[n.$slots.header||n.header?(Fn(),To("div",{key:0,class:$r([pe(e).e("header"),n.headerClass])},[$n(n.$slots,"header",{},()=>[Bm(jm(n.header),1)])],2)):cc("v-if",!0),bl("div",{class:$r([pe(e).e("body"),n.bodyClass]),style:bE(n.bodyStyle)},[$n(n.$slots,"default")],6),n.$slots.footer||n.footer?(Fn(),To("div",{key:1,class:$r([pe(e).e("footer"),n.footerClass])},[$n(n.$slots,"footer",{},()=>[Bm(jm(n.footer),1)])],2)):cc("v-if",!0)],2))}});var RU=qd(SU,[["__file","card.vue"]]);const EU=yE(RU);var mm=(t=>(t[t.TEXT=1]="TEXT",t[t.CLASS=2]="CLASS",t[t.STYLE=4]="STYLE",t[t.PROPS=8]="PROPS",t[t.FULL_PROPS=16]="FULL_PROPS",t[t.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",t[t.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",t[t.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",t[t.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",t[t.NEED_PATCH=512]="NEED_PATCH",t[t.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",t[t.HOISTED=-1]="HOISTED",t[t.BAIL=-2]="BAIL",t))(mm||{});const LD=t=>{if(!t)return{onClick:nv,onMousedown:nv,onMouseup:nv};let e=!1,n=!1;return{onClick:s=>{e&&n&&t(s),e=n=!1},onMousedown:s=>{e=s.target===s.currentTarget},onMouseup:s=>{n=s.target===s.currentTarget}}},TU=Kd({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:Td([String,Array,Object])},zIndex:{type:Td([String,Number])}}),_U={click:t=>t instanceof MouseEvent},MU="overlay";var IU=Bi({name:"ElOverlay",props:TU,emits:_U,setup(t,{slots:e,emit:n}){const r=Up(MU),i=l=>{n("click",l)},{onClick:o,onMousedown:s,onMouseup:a}=LD(t.customMaskEvent?void 0:i);return()=>t.mask?Ni("div",{class:[r.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:o,onMousedown:s,onMouseup:a},[$n(e,"default")],mm.STYLE|mm.CLASS|mm.PROPS,["onClick","onMouseup","onMousedown"]):QW("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[$n(e,"default")])}});const PU=IU,$D=Symbol("dialogInjectionKey"),FD=Kd({center:Boolean,alignCenter:Boolean,closeIcon:{type:eB},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,headerClass:String,bodyClass:String,footerClass:String,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),OU={close:()=>!0},xU=(t,e,n,r)=>{const i={offsetX:0,offsetY:0},o=(h,d)=>{if(t.value){const{offsetX:f,offsetY:g}=i,w=t.value.getBoundingClientRect(),C=w.left,S=w.top,v=w.width,E=w.height,P=document.documentElement.clientWidth,x=document.documentElement.clientHeight,_=-C+f,M=-S+g,V=P-C-v+f,z=x-S-(E<x?E:0)+g;r?.value||(h=Math.min(Math.max(h,_),V),d=Math.min(Math.max(d,M),z)),i.offsetX=h,i.offsetY=d,t.value.style.transform=`translate(${gR(h)}, ${gR(d)})`}},s=h=>{const d=h.clientX,f=h.clientY,{offsetX:g,offsetY:w}=i,C=v=>{const E=g+v.clientX-d,P=w+v.clientY-f;o(E,P)},S=()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",S)};document.addEventListener("mousemove",C),document.addEventListener("mouseup",S)},a=()=>{e.value&&t.value&&(e.value.addEventListener("mousedown",s),window.addEventListener("resize",c))},l=()=>{e.value&&t.value&&(e.value.removeEventListener("mousedown",s),window.removeEventListener("resize",c))},u=()=>{i.offsetX=0,i.offsetY=0,t.value&&(t.value.style.transform="")},c=()=>{const{offsetX:h,offsetY:d}=i;o(h,d)};return bc(()=>{tB(()=>{n.value?a():l()})}),jp(()=>{l()}),{resetPosition:u,updatePosition:c}},AU=(...t)=>e=>{t.forEach(n=>{nB(n)?n(e):n.value=e})},HU=Bi({name:"ElDialogContent"}),NU=Bi({...HU,props:FD,emits:OU,setup(t,{expose:e}){const n=t,{t:r}=Qj(),{Close:i}=iB,{dialogRef:o,headerRef:s,bodyId:a,ns:l,style:u}=yl($D),{focusTrapRef:c}=yl(HD),h=si(()=>[l.b(),l.is("fullscreen",n.fullscreen),l.is("draggable",n.draggable),l.is("align-center",n.alignCenter),{[l.m("center")]:n.center}]),d=AU(c,o),f=si(()=>n.draggable),g=si(()=>n.overflow),{resetPosition:w,updatePosition:C}=xU(o,s,f,g);return e({resetPosition:w,updatePosition:C}),(S,v)=>(Fn(),To("div",{ref:pe(d),class:$r(pe(h)),style:bE(pe(u)),tabindex:"-1"},[bl("header",{ref_key:"headerRef",ref:s,class:$r([pe(l).e("header"),S.headerClass,{"show-close":S.showClose}])},[$n(S.$slots,"header",{},()=>[bl("span",{role:"heading","aria-level":S.ariaLevel,class:$r(pe(l).e("title"))},jm(S.title),11,["aria-level"])]),S.showClose?(Fn(),To("button",{key:0,"aria-label":pe(r)("el.dialog.close"),class:$r(pe(l).e("headerbtn")),type:"button",onClick:E=>S.$emit("close")},[Ni(pe(_D),{class:$r(pe(l).e("close"))},{default:vr(()=>[(Fn(),uc(rB(S.closeIcon||pe(i))))]),_:1},8,["class"])],10,["aria-label","onClick"])):cc("v-if",!0)],2),bl("div",{id:pe(a),class:$r([pe(l).e("body"),S.bodyClass])},[$n(S.$slots,"default")],10,["id"]),S.$slots.footer?(Fn(),To("footer",{key:0,class:$r([pe(l).e("footer"),S.footerClass])},[$n(S.$slots,"footer")],2)):cc("v-if",!0)],6))}});var DU=qd(NU,[["__file","dialog-content.vue"]]);const kU=Kd({...FD,appendToBody:Boolean,appendTo:{type:kD.to.type,default:"body"},beforeClose:{type:Td(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,headerClass:String,bodyClass:String,footerClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),LU={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[AD]:t=>oB(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},$U=(t,e={})=>{ED(t)||Uj("[useLockscreen]","You need to pass a ref param to this function");const n=e.ns||Up("popup"),r=si(()=>n.bm("parent","hidden"));if(!lc||HM(document.body,r.value))return;let i=0,o=!1,s="0";const a=()=>{setTimeout(()=>{typeof document>"u"||o&&document&&(document.body.style.width=s,uB(document.body,r.value))},200)};aa(t,l=>{if(!l){a();return}o=!HM(document.body,r.value),o&&(s=document.body.style.width,sB(document.body,r.value)),i=eU(n.namespace.value);const u=document.documentElement.clientHeight<document.body.scrollHeight,c=aB(document.body,"overflowY");i>0&&(u||c==="scroll")&&o&&(document.body.style.width=`calc(100% - ${i}px)`)}),lB(()=>a())},FU=(t,e)=>{var n;const i=Wm().emit,{nextZIndex:o}=Gj();let s="";const a=jM(),l=jM(),u=Kt(!1),c=Kt(!1),h=Kt(!1),d=Kt((n=t.zIndex)!=null?n:o());let f,g;const w=cB("namespace",hB),C=si(()=>{const ne={},Fe=`--${w.value}-dialog`;return t.fullscreen||(t.top&&(ne[`${Fe}-margin-top`]=t.top),t.width&&(ne[`${Fe}-width`]=gR(t.width))),ne}),S=si(()=>t.alignCenter?{display:"flex"}:{});function v(){i("opened")}function E(){i("closed"),i(AD,!1),t.destroyOnClose&&(h.value=!1)}function P(){i("close")}function x(){g?.(),f?.(),t.openDelay&&t.openDelay>0?{stop:f}=NM(()=>z(),t.openDelay):z()}function _(){f?.(),g?.(),t.closeDelay&&t.closeDelay>0?{stop:g}=NM(()=>O(),t.closeDelay):O()}function M(){function ne(Fe){Fe||(c.value=!0,u.value=!1)}t.beforeClose?t.beforeClose(ne):_()}function V(){t.closeOnClickModal&&M()}function z(){lc&&(u.value=!0)}function O(){u.value=!1}function G(){i("openAutoFocus")}function Z(){i("closeAutoFocus")}function ae(ne){var Fe;((Fe=ne.detail)==null?void 0:Fe.focusReason)==="pointer"&&ne.preventDefault()}t.lockScroll&&$U(u);function te(){t.closeOnPressEscape&&M()}return aa(()=>t.zIndex,()=>{var ne;d.value=(ne=t.zIndex)!=null?ne:o()}),aa(()=>t.modelValue,ne=>{var Fe;ne?(c.value=!1,x(),h.value=!0,d.value=(Fe=t.zIndex)!=null?Fe:o(),fR(()=>{i("open"),e.value&&(e.value.parentElement.scrollTop=0,e.value.parentElement.scrollLeft=0,e.value.scrollTop=0)})):u.value&&_()}),aa(()=>t.fullscreen,ne=>{e.value&&(ne?(s=e.value.style.transform,e.value.style.transform=""):e.value.style.transform=s)}),bc(()=>{t.modelValue&&(u.value=!0,h.value=!0,x())}),{afterEnter:v,afterLeave:E,beforeLeave:P,handleClose:M,onModalClick:V,close:_,doClose:O,onOpenAutoFocus:G,onCloseAutoFocus:Z,onCloseRequested:te,onFocusoutPrevented:ae,titleId:a,bodyId:l,closed:c,style:C,overlayDialogStyle:S,rendered:h,visible:u,zIndex:d}},VU=Bi({name:"ElDialog",inheritAttrs:!1}),WU=Bi({...VU,props:kU,emits:LU,setup(t,{expose:e}){const n=t,r=dB();fB({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},si(()=>!!r.title));const i=Up("dialog"),o=Kt(),s=Kt(),a=Kt(),{visible:l,titleId:u,bodyId:c,style:h,overlayDialogStyle:d,rendered:f,zIndex:g,afterEnter:w,afterLeave:C,beforeLeave:S,handleClose:v,onModalClick:E,onOpenAutoFocus:P,onCloseAutoFocus:x,onCloseRequested:_,onFocusoutPrevented:M}=FU(n,o);TD($D,{dialogRef:o,headerRef:s,bodyId:c,ns:i,rendered:f,style:h});const V=LD(E),z=si(()=>n.draggable&&!n.fullscreen);return e({visible:l,dialogContentRef:a,resetPosition:()=>{var G;(G=a.value)==null||G.resetPosition()},handleClose:v}),(G,Z)=>(Fn(),uc(pe(CU),{to:G.appendTo,disabled:G.appendTo!=="body"?!1:!G.appendToBody},{default:vr(()=>[Ni(gB,{name:"dialog-fade",onAfterEnter:pe(w),onAfterLeave:pe(C),onBeforeLeave:pe(S),persisted:""},{default:vr(()=>[mB(Ni(pe(PU),{"custom-mask-event":"",mask:G.modal,"overlay-class":G.modalClass,"z-index":pe(g)},{default:vr(()=>[bl("div",{role:"dialog","aria-modal":"true","aria-label":G.title||void 0,"aria-labelledby":G.title?void 0:pe(u),"aria-describedby":pe(c),class:$r(`${pe(i).namespace.value}-overlay-dialog`),style:bE(pe(d)),onClick:pe(V).onClick,onMousedown:pe(V).onMousedown,onMouseup:pe(V).onMouseup},[Ni(pe(pU),{loop:"",trapped:pe(l),"focus-start-el":"container",onFocusAfterTrapped:pe(P),onFocusAfterReleased:pe(x),onFocusoutPrevented:pe(M),onReleaseRequested:pe(_)},{default:vr(()=>[pe(f)?(Fn(),uc(DU,pB({key:0,ref_key:"dialogContentRef",ref:a},G.$attrs,{center:G.center,"align-center":G.alignCenter,"close-icon":G.closeIcon,draggable:pe(z),overflow:G.overflow,fullscreen:G.fullscreen,"header-class":G.headerClass,"body-class":G.bodyClass,"footer-class":G.footerClass,"show-close":G.showClose,title:G.title,"aria-level":G.headerAriaLevel,onClose:pe(v)}),wB({header:vr(()=>[G.$slots.title?$n(G.$slots,"title",{key:1}):$n(G.$slots,"header",{key:0,close:pe(v),titleId:pe(u),titleClass:pe(i).e("title")})]),default:vr(()=>[$n(G.$slots,"default")]),_:2},[G.$slots.footer?{name:"footer",fn:vr(()=>[$n(G.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","header-class","body-class","footer-class","show-close","title","aria-level","onClose"])):cc("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[vB,pe(l)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var BU=qd(WU,[["__file","dialog.vue"]]);const jU=yE(BU);var QM={},Uc,eI;function Zt(){if(eI)return Uc;eI=1;var t=function(e){return e&&e.Math===Math&&e};return Uc=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof JM=="object"&&JM)||t(typeof Uc=="object"&&Uc)||function(){return this}()||Function("return this")(),Uc}var sv={},av,tI;function an(){return tI||(tI=1,av=function(t){try{return!!t()}catch{return!0}}),av}var lv,nI;function ui(){if(nI)return lv;nI=1;var t=an();return lv=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),lv}var uv,rI;function qp(){if(rI)return uv;rI=1;var t=an();return uv=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),uv}var cv,iI;function ln(){if(iI)return cv;iI=1;var t=qp(),e=Function.prototype.call;return cv=t?e.bind(e):function(){return e.apply(e,arguments)},cv}var hv={},oI;function UU(){if(oI)return hv;oI=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return hv.f=n?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,hv}var dv,sI;function Kp(){return sI||(sI=1,dv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),dv}var fv,aI;function Jt(){if(aI)return fv;aI=1;var t=qp(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return fv=t?r:function(i){return function(){return n.apply(i,arguments)}},fv}var gv,lI;function Fl(){if(lI)return gv;lI=1;var t=Jt(),e=t({}.toString),n=t("".slice);return gv=function(r){return n(e(r),8,-1)},gv}var mv,uI;function zU(){if(uI)return mv;uI=1;var t=Jt(),e=an(),n=Fl(),r=Object,i=t("".split);return mv=e(function(){return!r("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?i(o,""):r(o)}:r,mv}var pv,cI;function IE(){return cI||(cI=1,pv=function(t){return t==null}),pv}var wv,hI;function Xd(){if(hI)return wv;hI=1;var t=IE(),e=TypeError;return wv=function(n){if(t(n))throw new e("Can't call method on "+n);return n},wv}var vv,dI;function Zd(){if(dI)return vv;dI=1;var t=zU(),e=Xd();return vv=function(n){return t(e(n))},vv}var Cv,fI;function un(){if(fI)return Cv;fI=1;var t=typeof document=="object"&&document.all;return Cv=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},Cv}var yv,gI;function ci(){if(gI)return yv;gI=1;var t=un();return yv=function(e){return typeof e=="object"?e!==null:t(e)},yv}var bv,mI;function Rc(){if(mI)return bv;mI=1;var t=Zt(),e=un(),n=function(r){return e(r)?r:void 0};return bv=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},bv}var Sv,pI;function Jd(){if(pI)return Sv;pI=1;var t=Jt();return Sv=t({}.isPrototypeOf),Sv}var Rv,wI;function Xp(){if(wI)return Rv;wI=1;var t=Zt(),e=t.navigator,n=e&&e.userAgent;return Rv=n?String(n):"",Rv}var Ev,vI;function YU(){if(vI)return Ev;vI=1;var t=Zt(),e=Xp(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),Ev=a,Ev}var Tv,CI;function PE(){if(CI)return Tv;CI=1;var t=YU(),e=an(),n=Zt(),r=n.String;return Tv=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Tv}var _v,yI;function VD(){if(yI)return _v;yI=1;var t=PE();return _v=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",_v}var Mv,bI;function OE(){if(bI)return Mv;bI=1;var t=Rc(),e=un(),n=Jd(),r=VD(),i=Object;return Mv=r?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&n(s.prototype,i(o))},Mv}var Iv,SI;function Zp(){if(SI)return Iv;SI=1;var t=String;return Iv=function(e){try{return t(e)}catch{return"Object"}},Iv}var Pv,RI;function Sr(){if(RI)return Pv;RI=1;var t=un(),e=Zp(),n=TypeError;return Pv=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},Pv}var Ov,EI;function Qd(){if(EI)return Ov;EI=1;var t=Sr(),e=IE();return Ov=function(n,r){var i=n[r];return e(i)?void 0:t(i)},Ov}var xv,TI;function GU(){if(TI)return xv;TI=1;var t=ln(),e=un(),n=ci(),r=TypeError;return xv=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!n(a=t(s,i))||e(s=i.valueOf)&&!n(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!n(a=t(s,i)))return a;throw new r("Can't convert object to primitive value")},xv}var Av={exports:{}},Hv,_I;function ga(){return _I||(_I=1,Hv=!1),Hv}var Nv,MI;function xE(){if(MI)return Nv;MI=1;var t=Zt(),e=Object.defineProperty;return Nv=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},Nv}var II;function AE(){if(II)return Av.exports;II=1;var t=ga(),e=Zt(),n=xE(),r="__core-js_shared__",i=Av.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.44.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Av.exports}var Dv,PI;function WD(){if(PI)return Dv;PI=1;var t=AE();return Dv=function(e,n){return t[e]||(t[e]=n||{})},Dv}var kv,OI;function Ec(){if(OI)return kv;OI=1;var t=Xd(),e=Object;return kv=function(n){return e(t(n))},kv}var Lv,xI;function hi(){if(xI)return Lv;xI=1;var t=Jt(),e=Ec(),n=t({}.hasOwnProperty);return Lv=Object.hasOwn||function(i,o){return n(e(i),o)},Lv}var $v,AI;function BD(){if(AI)return $v;AI=1;var t=Jt(),e=0,n=Math.random(),r=t(1.1.toString);return $v=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},$v}var Fv,HI;function ji(){if(HI)return Fv;HI=1;var t=Zt(),e=WD(),n=hi(),r=BD(),i=PE(),o=VD(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||r;return Fv=function(u){return n(a,u)||(a[u]=i&&n(s,u)?s[u]:l("Symbol."+u)),a[u]},Fv}var Vv,NI;function qU(){if(NI)return Vv;NI=1;var t=ln(),e=ci(),n=OE(),r=Qd(),i=GU(),o=ji(),s=TypeError,a=o("toPrimitive");return Vv=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Vv}var Wv,DI;function jD(){if(DI)return Wv;DI=1;var t=qU(),e=OE();return Wv=function(n){var r=t(n,"string");return e(r)?r:r+""},Wv}var Bv,kI;function HE(){if(kI)return Bv;kI=1;var t=Zt(),e=ci(),n=t.document,r=e(n)&&e(n.createElement);return Bv=function(i){return r?n.createElement(i):{}},Bv}var jv,LI;function UD(){if(LI)return jv;LI=1;var t=ui(),e=an(),n=HE();return jv=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),jv}var $I;function zD(){if($I)return sv;$I=1;var t=ui(),e=ln(),n=UU(),r=Kp(),i=Zd(),o=jD(),s=hi(),a=UD(),l=Object.getOwnPropertyDescriptor;return sv.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return r(!e(n.f,c,h),c[h])},sv}var Uv={},zv,FI;function YD(){if(FI)return zv;FI=1;var t=ui(),e=an();return zv=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),zv}var Yv,VI;function cn(){if(VI)return Yv;VI=1;var t=ci(),e=String,n=TypeError;return Yv=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},Yv}var WI;function ma(){if(WI)return Uv;WI=1;var t=ui(),e=UD(),n=YD(),r=cn(),i=jD(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Uv.f=t?n?function(d,f,g){if(r(d),f=i(f),r(g),typeof d=="function"&&f==="prototype"&&"value"in g&&c in g&&!g[c]){var w=a(d,f);w&&w[c]&&(d[f]=g.value,g={configurable:u in g?g[u]:w[u],enumerable:l in g?g[l]:w[l],writable:!1})}return s(d,f,g)}:s:function(d,f,g){if(r(d),f=i(f),r(g),e)try{return s(d,f,g)}catch{}if("get"in g||"set"in g)throw new o("Accessors not supported");return"value"in g&&(d[f]=g.value),d},Uv}var Gv,BI;function Tc(){if(BI)return Gv;BI=1;var t=ui(),e=ma(),n=Kp();return Gv=t?function(r,i,o){return e.f(r,i,n(1,o))}:function(r,i,o){return r[i]=o,r},Gv}var qv={exports:{}},Kv,jI;function KU(){if(jI)return Kv;jI=1;var t=ui(),e=hi(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&r(n,"name").configurable);return Kv={EXISTS:i,PROPER:o,CONFIGURABLE:s},Kv}var Xv,UI;function XU(){if(UI)return Xv;UI=1;var t=Jt(),e=un(),n=AE(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),Xv=n.inspectSource,Xv}var Zv,zI;function ZU(){if(zI)return Zv;zI=1;var t=Zt(),e=un(),n=t.WeakMap;return Zv=e(n)&&/native code/.test(String(n)),Zv}var Jv,YI;function NE(){if(YI)return Jv;YI=1;var t=WD(),e=BD(),n=t("keys");return Jv=function(r){return n[r]||(n[r]=e(r))},Jv}var Qv,GI;function DE(){return GI||(GI=1,Qv={}),Qv}var eC,qI;function GD(){if(qI)return eC;qI=1;var t=ZU(),e=Zt(),n=ci(),r=Tc(),i=hi(),o=AE(),s=NE(),a=DE(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,g=function(v){return f(v)?d(v):h(v,{})},w=function(v){return function(E){var P;if(!n(E)||(P=d(E)).type!==v)throw new u("Incompatible receiver, "+v+" required");return P}};if(t||o.state){var C=o.state||(o.state=new c);C.get=C.get,C.has=C.has,C.set=C.set,h=function(v,E){if(C.has(v))throw new u(l);return E.facade=v,C.set(v,E),E},d=function(v){return C.get(v)||{}},f=function(v){return C.has(v)}}else{var S=s("state");a[S]=!0,h=function(v,E){if(i(v,S))throw new u(l);return E.facade=v,r(v,S,E),E},d=function(v){return i(v,S)?v[S]:{}},f=function(v){return i(v,S)}}return eC={set:h,get:d,has:f,enforce:g,getterFor:w},eC}var KI;function qD(){if(KI)return qv.exports;KI=1;var t=Jt(),e=an(),n=un(),r=hi(),i=ui(),o=KU().CONFIGURABLE,s=XU(),a=GD(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),g=t([].join),w=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),C=String(String).split("String"),S=qv.exports=function(v,E,P){d(c(E),0,7)==="Symbol("&&(E="["+f(c(E),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),P&&P.getter&&(E="get "+E),P&&P.setter&&(E="set "+E),(!r(v,"name")||o&&v.name!==E)&&(i?h(v,"name",{value:E,configurable:!0}):v.name=E),w&&P&&r(P,"arity")&&v.length!==P.arity&&h(v,"length",{value:P.arity});try{P&&r(P,"constructor")&&P.constructor?i&&h(v,"prototype",{writable:!1}):v.prototype&&(v.prototype=void 0)}catch{}var x=l(v);return r(x,"source")||(x.source=g(C,typeof E=="string"?E:"")),v};return Function.prototype.toString=S(function(){return n(this)&&u(this).source||s(this)},"toString"),qv.exports}var tC,XI;function kE(){if(XI)return tC;XI=1;var t=un(),e=ma(),n=qD(),r=xE();return tC=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&n(s,u,a),a.global)l?i[o]=s:r(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},tC}var nC={},rC,ZI;function JU(){if(ZI)return rC;ZI=1;var t=Math.ceil,e=Math.floor;return rC=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},rC}var iC,JI;function ef(){if(JI)return iC;JI=1;var t=JU();return iC=function(e){var n=+e;return n!==n||n===0?0:t(n)},iC}var oC,QI;function QU(){if(QI)return oC;QI=1;var t=ef(),e=Math.max,n=Math.min;return oC=function(r,i){var o=t(r);return o<0?e(o+i,0):n(o,i)},oC}var sC,eP;function ez(){if(eP)return sC;eP=1;var t=ef(),e=Math.min;return sC=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},sC}var aC,tP;function _c(){if(tP)return aC;tP=1;var t=ez();return aC=function(e){return t(e.length)},aC}var lC,nP;function tz(){if(nP)return lC;nP=1;var t=Zd(),e=QU(),n=_c(),r=function(i){return function(o,s,a){var l=t(o),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return lC={includes:r(!0),indexOf:r(!1)},lC}var uC,rP;function KD(){if(rP)return uC;rP=1;var t=Jt(),e=hi(),n=Zd(),r=tz().indexOf,i=DE(),o=t([].push);return uC=function(s,a){var l=n(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||o(c,h));return c},uC}var cC,iP;function LE(){return iP||(iP=1,cC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),cC}var oP;function nz(){if(oP)return nC;oP=1;var t=KD(),e=LE(),n=e.concat("length","prototype");return nC.f=Object.getOwnPropertyNames||function(i){return t(i,n)},nC}var hC={},sP;function rz(){return sP||(sP=1,hC.f=Object.getOwnPropertySymbols),hC}var dC,aP;function iz(){if(aP)return dC;aP=1;var t=Rc(),e=Jt(),n=nz(),r=rz(),i=cn(),o=e([].concat);return dC=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?o(l,u(a)):l},dC}var fC,lP;function XD(){if(lP)return fC;lP=1;var t=hi(),e=iz(),n=zD(),r=ma();return fC=function(i,o,s){for(var a=e(o),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},fC}var gC,uP;function oz(){if(uP)return gC;uP=1;var t=an(),e=un(),n=/#|\.prototype\./,r=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},o=r.data={},s=r.NATIVE="N",a=r.POLYFILL="P";return gC=r,gC}var mC,cP;function pt(){if(cP)return mC;cP=1;var t=Zt(),e=zD().f,n=Tc(),r=kE(),i=xE(),o=XD(),s=oz();return mC=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,g,w,C,S;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(g in l){if(C=l[g],a.dontCallGetSet?(S=e(f,g),w=S&&S.value):w=f[g],d=s(c?g:u+(h?".":"#")+g,a.forced),!d&&w!==void 0){if(typeof C==typeof w)continue;o(C,w)}(a.sham||w&&w.sham)&&n(C,"sham",!0),r(f,g,C,a)}},mC}var pC,hP;function tf(){if(hP)return pC;hP=1;var t=qp(),e=Function.prototype,n=e.apply,r=e.call;return pC=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),pC}var wC,dP;function ZD(){if(dP)return wC;dP=1;var t=Jt(),e=Sr();return wC=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},wC}var vC,fP;function sz(){if(fP)return vC;fP=1;var t=ci();return vC=function(e){return t(e)||e===null},vC}var CC,gP;function az(){if(gP)return CC;gP=1;var t=sz(),e=String,n=TypeError;return CC=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},CC}var yC,mP;function JD(){if(mP)return yC;mP=1;var t=ZD(),e=ci(),n=Xd(),r=az();return yC=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),yC}var bC,pP;function lz(){if(pP)return bC;pP=1;var t=ma().f;return bC=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},bC}var SC,wP;function uz(){if(wP)return SC;wP=1;var t=un(),e=ci(),n=JD();return SC=function(r,i,o){var s,a;return n&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&n(r,a),r},SC}var RC,vP;function cz(){if(vP)return RC;vP=1;var t=ji(),e=t("toStringTag"),n={};return n[e]="z",RC=String(n)==="[object z]",RC}var EC,CP;function QD(){if(CP)return EC;CP=1;var t=cz(),e=un(),n=Fl(),r=ji(),i=r("toStringTag"),o=Object,s=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return EC=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},EC}var TC,yP;function Jp(){if(yP)return TC;yP=1;var t=QD(),e=String;return TC=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},TC}var _C,bP;function hz(){if(bP)return _C;bP=1;var t=Jp();return _C=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},_C}var MC,SP;function dz(){if(SP)return MC;SP=1;var t=ci(),e=Tc();return MC=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},MC}var IC,RP;function fz(){if(RP)return IC;RP=1;var t=Jt(),e=Error,n=t("".replace),r=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(r);return IC=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=n(s,i,"");return s},IC}var PC,EP;function gz(){if(EP)return PC;EP=1;var t=an(),e=Kp();return PC=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),PC}var OC,TP;function mz(){if(TP)return OC;TP=1;var t=Tc(),e=fz(),n=gz(),r=Error.captureStackTrace;return OC=function(i,o,s,a){n&&(r?r(i,o):t(i,"stack",e(s,a)))},OC}var xC,_P;function pz(){if(_P)return xC;_P=1;var t=Rc(),e=hi(),n=Tc(),r=Jd(),i=JD(),o=XD(),s=lz(),a=uz(),l=hz(),u=dz(),c=mz(),h=ui(),d=ga();return xC=function(f,g,w,C){var S="stackTraceLimit",v=C?2:1,E=f.split("."),P=E[E.length-1],x=t.apply(null,E);if(x){var _=x.prototype;if(!d&&e(_,"cause")&&delete _.cause,!w)return x;var M=t("Error"),V=g(function(z,O){var G=l(C?O:z,void 0),Z=C?new x(z):new x;return G!==void 0&&n(Z,"message",G),c(Z,V,Z.stack,2),this&&r(_,this)&&a(Z,this,V),arguments.length>v&&u(Z,arguments[v]),Z});if(V.prototype=_,P!=="Error"?i?i(V,M):o(V,M,{name:!0}):h&&S in x&&(s(V,x,S),s(V,x,"prepareStackTrace")),o(V,x),!d)try{_.name!==P&&n(_,"name",P),_.constructor=V}catch{}return V}},xC}var MP;function wz(){if(MP)return QM;MP=1;var t=pt(),e=Zt(),n=tf(),r=pz(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=r(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),QM}wz();var IP={},AC,PP;function ek(){if(PP)return AC;PP=1;var t=Fl();return AC=Array.isArray||function(n){return t(n)==="Array"},AC}var HC,OP;function tk(){if(OP)return HC;OP=1;var t=ui(),e=ek(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return HC=i?function(o,s){if(e(o)&&!r(o,"length").writable)throw new n("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},HC}var NC,xP;function nk(){if(xP)return NC;xP=1;var t=TypeError,e=9007199254740991;return NC=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},NC}var AP;function vz(){if(AP)return IP;AP=1;var t=pt(),e=Ec(),n=_c(),r=tk(),i=nk(),o=an(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var g=0;g<f;g++)h[d]=arguments[g],d++;return r(h,d),d}}),IP}vz();var HP={},DC,NP;function Cz(){if(NP)return DC;NP=1;var t=Fl(),e=Jt();return DC=function(n){if(t(n)==="Function")return e(n)},DC}var kC,DP;function rk(){if(DP)return kC;DP=1;var t=Cz(),e=Sr(),n=qp(),r=t(t.bind);return kC=function(i,o){return e(i),o===void 0?i:n?r(i,o):function(){return i.apply(o,arguments)}},kC}var LC,kP;function ik(){return kP||(kP=1,LC={}),LC}var $C,LP;function yz(){if(LP)return $C;LP=1;var t=ji(),e=ik(),n=t("iterator"),r=Array.prototype;return $C=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},$C}var FC,$P;function $E(){if($P)return FC;$P=1;var t=QD(),e=Qd(),n=IE(),r=ik(),i=ji(),o=i("iterator");return FC=function(s){if(!n(s))return e(s,o)||e(s,"@@iterator")||r[t(s)]},FC}var VC,FP;function bz(){if(FP)return VC;FP=1;var t=ln(),e=Sr(),n=cn(),r=Zp(),i=$E(),o=TypeError;return VC=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return n(t(l,s));throw new o(r(s)+" is not iterable")},VC}var WC,VP;function Rr(){if(VP)return WC;VP=1;var t=ln(),e=cn(),n=Qd();return WC=function(r,i,o){var s,a;e(r);try{if(s=n(r,"return"),!s){if(i==="throw")throw o;return o}s=t(s,r)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},WC}var BC,WP;function Mc(){if(WP)return BC;WP=1;var t=rk(),e=ln(),n=cn(),r=Zp(),i=yz(),o=_c(),s=Jd(),a=bz(),l=$E(),u=Rr(),c=TypeError,h=function(f,g){this.stopped=f,this.result=g},d=h.prototype;return BC=function(f,g,w){var C=w&&w.that,S=!!(w&&w.AS_ENTRIES),v=!!(w&&w.IS_RECORD),E=!!(w&&w.IS_ITERATOR),P=!!(w&&w.INTERRUPTED),x=t(g,C),_,M,V,z,O,G,Z,ae=function(ne){return _&&u(_,"normal"),new h(!0,ne)},te=function(ne){return S?(n(ne),P?x(ne[0],ne[1],ae):x(ne[0],ne[1])):P?x(ne,ae):x(ne)};if(v)_=f.iterator;else if(E)_=f;else{if(M=l(f),!M)throw new c(r(f)+" is not iterable");if(i(M)){for(V=0,z=o(f);z>V;V++)if(O=te(f[V]),O&&s(d,O))return O;return new h(!1)}_=a(f,M)}for(G=v?f.next:_.next;!(Z=e(G,_)).done;){try{O=te(Z.value)}catch(ne){u(_,"throw",ne)}if(typeof O=="object"&&O&&s(d,O))return O}return new h(!1)},BC}var jC,BP;function ok(){if(BP)return jC;BP=1;var t=ui(),e=ma(),n=Kp();return jC=function(r,i,o){t?e.f(r,i,n(0,o)):r[i]=o},jC}var jP;function Sz(){if(jP)return HP;jP=1;var t=pt(),e=Mc(),n=ok();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){n(o,s,a)},{AS_ENTRIES:!0}),o}}),HP}Sz();var UP={},UC,zP;function Po(){if(zP)return UC;zP=1;var t=Jt(),e=Set.prototype;return UC={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},UC}var zC,YP;function Vl(){if(YP)return zC;YP=1;var t=Po().has;return zC=function(e){return t(e),e},zC}var YC,GP;function Wl(){if(GP)return YC;GP=1;var t=ln();return YC=function(e,n,r){for(var i=r?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=n(s.value),a!==void 0)return a},YC}var GC,qP;function nf(){if(qP)return GC;qP=1;var t=Jt(),e=Wl(),n=Po(),r=n.Set,i=n.proto,o=t(i.forEach),s=t(i.keys),a=s(new r).next;return GC=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},GC}var qC,KP;function FE(){if(KP)return qC;KP=1;var t=Po(),e=nf(),n=t.Set,r=t.add;return qC=function(i){var o=new n;return e(i,function(s){r(o,s)}),o},qC}var KC,XP;function rf(){if(XP)return KC;XP=1;var t=ZD(),e=Po();return KC=t(e.proto,"size","get")||function(n){return n.size},KC}var XC,ZP;function Oo(){return ZP||(ZP=1,XC=function(t){return{iterator:t,next:t.next,done:!1}}),XC}var ZC,JP;function Bl(){if(JP)return ZC;JP=1;var t=Sr(),e=cn(),n=ln(),r=ef(),i=Oo(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},ZC=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=r(h);if(d<0)throw new s(o);return new u(c,d)},ZC}var JC,QP;function Rz(){if(QP)return JC;QP=1;var t=Vl(),e=Po(),n=FE(),r=rf(),i=Bl(),o=nf(),s=Wl(),a=e.has,l=e.remove;return JC=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?o(h,function(g){d.includes(g)&&l(f,g)}):s(d.getIterator(),function(g){a(f,g)&&l(f,g)}),f},JC}var QC,eO;function jl(){if(eO)return QC;eO=1;var t=Rc(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return QC=function(r,i){var o=t("Set");try{new o()[r](e(0));try{return new o()[r](e(-1)),!1}catch{if(!i)return!0;try{return new o()[r](n(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[r](n(1/0)))}}}catch{return!1}},QC}var tO;function Ez(){if(tO)return UP;tO=1;var t=pt(),e=Rz(),n=an(),r=jl(),i=!r("difference",function(s){return s.size===0}),o=i||n(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),UP}Ez();var nO={},ey,rO;function Tz(){if(rO)return ey;rO=1;var t=Vl(),e=Po(),n=rf(),r=Bl(),i=nf(),o=Wl(),s=e.Set,a=e.add,l=e.has;return ey=function(c){var h=t(this),d=r(c),f=new s;return n(h)>d.size?o(d.getIterator(),function(g){l(h,g)&&a(f,g)}):i(h,function(g){d.includes(g)&&a(f,g)}),f},ey}var iO;function _z(){if(iO)return nO;iO=1;var t=pt(),e=an(),n=Tz(),r=jl(),i=!r("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),nO}_z();var oO={},ty,sO;function Mz(){if(sO)return ty;sO=1;var t=Vl(),e=Po().has,n=rf(),r=Bl(),i=nf(),o=Wl(),s=Rr();return ty=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},ty}var aO;function Iz(){if(aO)return oO;aO=1;var t=pt(),e=Mz(),n=jl(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),oO}Iz();var lO={},ny,uO;function Pz(){if(uO)return ny;uO=1;var t=Vl(),e=rf(),n=nf(),r=Bl();return ny=function(o){var s=t(this),a=r(o);return e(s)>a.size?!1:n(s,function(l){if(!a.includes(l))return!1},!0)!==!1},ny}var cO;function Oz(){if(cO)return lO;cO=1;var t=pt(),e=Pz(),n=jl(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),lO}Oz();var hO={},ry,dO;function xz(){if(dO)return ry;dO=1;var t=Vl(),e=Po().has,n=rf(),r=Bl(),i=Wl(),o=Rr();return ry=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},ry}var fO;function Az(){if(fO)return hO;fO=1;var t=pt(),e=xz(),n=jl(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),hO}Az();var gO={},iy,mO;function Hz(){if(mO)return iy;mO=1;var t=Vl(),e=Po(),n=FE(),r=Bl(),i=Wl(),o=e.add,s=e.has,a=e.remove;return iy=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){s(c,f)?a(d,f):o(d,f)}),d},iy}var oy,pO;function sk(){return pO||(pO=1,oy=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[t](n);return r.size===1&&r.values().next().value===4}catch{return!1}}),oy}var wO;function Nz(){if(wO)return gO;wO=1;var t=pt(),e=Hz(),n=sk(),r=jl(),i=!r("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),gO}Nz();var vO={},sy,CO;function Dz(){if(CO)return sy;CO=1;var t=Vl(),e=Po().add,n=FE(),r=Bl(),i=Wl();return sy=function(s){var a=t(this),l=r(s).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},sy}var yO;function kz(){if(yO)return vO;yO=1;var t=pt(),e=Dz(),n=sk(),r=jl(),i=!r("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),vO}kz();var bO={},SO={},ay,RO;function Lz(){if(RO)return ay;RO=1;var t=Jd(),e=TypeError;return ay=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},ay}var ly,EO;function $z(){if(EO)return ly;EO=1;var t=an();return ly=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),ly}var uy,TO;function ak(){if(TO)return uy;TO=1;var t=hi(),e=un(),n=Ec(),r=NE(),i=$z(),o=r("IE_PROTO"),s=Object,a=s.prototype;return uy=i?s.getPrototypeOf:function(l){var u=n(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},uy}var cy,_O;function Fz(){if(_O)return cy;_O=1;var t=qD(),e=ma();return cy=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},cy}var hy={},dy,MO;function Vz(){if(MO)return dy;MO=1;var t=KD(),e=LE();return dy=Object.keys||function(r){return t(r,e)},dy}var IO;function Wz(){if(IO)return hy;IO=1;var t=ui(),e=YD(),n=ma(),r=cn(),i=Zd(),o=Vz();return hy.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=o(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},hy}var fy,PO;function lk(){if(PO)return fy;PO=1;var t=Rc();return fy=t("document","documentElement"),fy}var gy,OO;function VE(){if(OO)return gy;OO=1;var t=cn(),e=Wz(),n=LE(),r=DE(),i=lk(),o=HE(),s=NE(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},f=function(v){return l+c+a+v+l+"/"+c+a},g=function(v){v.write(f("")),v.close();var E=v.parentWindow.Object;return v=null,E},w=function(){var v=o("iframe"),E="java"+c+":",P;return v.style.display="none",i.appendChild(v),v.src=String(E),P=v.contentWindow.document,P.open(),P.write(f("document.F=Object")),P.close(),P.F},C,S=function(){try{C=new ActiveXObject("htmlfile")}catch{}S=typeof document<"u"?document.domain&&C?g(C):w():g(C);for(var v=n.length;v--;)delete S[u][n[v]];return S()};return r[h]=!0,gy=Object.create||function(E,P){var x;return E!==null?(d[u]=t(E),x=new d,d[u]=null,x[h]=E):x=S(),P===void 0?x:e.f(x,P)},gy}var my,xO;function uk(){if(xO)return my;xO=1;var t=an(),e=un(),n=ci(),r=VE(),i=ak(),o=kE(),s=ji(),a=ga(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var g={};return c[l].call(g)!==g});return f?c={}:a&&(c=r(c)),e(c[l])||o(c,l,function(){return this}),my={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},my}var AO;function Bz(){if(AO)return SO;AO=1;var t=pt(),e=Zt(),n=Lz(),r=cn(),i=un(),o=ak(),s=Fz(),a=ok(),l=an(),u=hi(),c=ji(),h=uk().IteratorPrototype,d=ui(),f=ga(),g="constructor",w="Iterator",C=c("toStringTag"),S=TypeError,v=e[w],E=f||!i(v)||v.prototype!==h||!l(function(){v({})}),P=function(){if(n(this,h),o(this)===h)throw new S("Abstract class Iterator not directly constructable")},x=function(_,M){d?s(h,_,{configurable:!0,get:function(){return M},set:function(V){if(r(this),this===h)throw new S("You can't redefine this property");u(this,_)?this[_]=V:a(this,_,V)}}):h[_]=M};return u(h,C)||x(C,w),(E||!u(h,g)||h[g]===Object)&&x(g,P),P.prototype=h,t({global:!0,constructor:!0,forced:E},{Iterator:P}),SO}var HO;function jz(){return HO||(HO=1,Bz()),bO}jz();var NO={},DO={},py,kO;function Uz(){if(kO)return py;kO=1;var t=kE();return py=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},py}var wy,LO;function zz(){return LO||(LO=1,wy=function(t,e){return{value:t,done:e}}),wy}var vy,$O;function Yz(){if($O)return vy;$O=1;var t=Rr();return vy=function(e,n,r){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{r=t(e[i].iterator,n,r)}catch(o){n="throw",r=o}if(n==="throw")throw r;return r},vy}var Cy,FO;function WE(){if(FO)return Cy;FO=1;var t=ln(),e=VE(),n=Tc(),r=Uz(),i=ji(),o=GD(),s=Qd(),a=uk().IteratorPrototype,l=zz(),u=Rr(),c=Yz(),h=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",g="normal",w="throw",C=o.set,S=function(P){var x=o.getterFor(P?f:d);return r(e(a),{next:function(){var M=x(this);if(P)return M.nextHandler();if(M.done)return l(void 0,!0);try{var V=M.nextHandler();return M.returnHandlerResult?V:l(V,M.done)}catch(z){throw M.done=!0,z}},return:function(){var _=x(this),M=_.iterator;if(_.done=!0,P){var V=s(M,"return");return V?t(V,M):l(void 0,!0)}if(_.inner)try{u(_.inner.iterator,g)}catch(z){return u(M,w,z)}if(_.openIters)try{c(_.openIters,g)}catch(z){return u(M,w,z)}return M&&u(M,g),l(void 0,!0)}})},v=S(!0),E=S(!1);return n(E,h,"Iterator Helper"),Cy=function(P,x,_){var M=function(z,O){O?(O.iterator=z.iterator,O.next=z.next):O=z,O.type=x?f:d,O.returnHandlerResult=!!_,O.nextHandler=P,O.counter=0,O.done=!1,C(this,O)};return M.prototype=x?v:E,M},Cy}var yy,VO;function ck(){if(VO)return yy;VO=1;var t=cn(),e=Rr();return yy=function(n,r,i,o){try{return o?r(t(i)[0],i[1]):r(i)}catch(s){e(n,"throw",s)}},yy}var by,WO;function BE(){return WO||(WO=1,by=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),by}var Sy,BO;function pa(){if(BO)return Sy;BO=1;var t=Zt();return Sy=function(e,n){var r=t.Iterator,i=r&&r.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof n||(s=!1)}if(!s)return o},Sy}var jO;function Gz(){if(jO)return DO;jO=1;var t=pt(),e=ln(),n=Sr(),r=cn(),i=Oo(),o=WE(),s=ck(),a=ga(),l=Rr(),u=BE(),c=pa(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),f=a||h||d,g=o(function(){for(var w=this.iterator,C=this.predicate,S=this.next,v,E,P;;){if(v=r(e(S,w)),E=this.done=!!v.done,E)return;if(P=v.value,s(w,C,[P,this.counter++],!0))return P}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(C){r(this);try{n(C)}catch(S){l(this,"throw",S)}return d?e(d,this,C):new g(i(this),{predicate:C})}}),DO}var UO;function qz(){return UO||(UO=1,Gz()),NO}qz();var zO={},YO={},GO;function Kz(){if(GO)return YO;GO=1;var t=pt(),e=ln(),n=Mc(),r=Sr(),i=cn(),o=Oo(),s=Rr(),a=pa(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),YO}var qO;function Xz(){return qO||(qO=1,Kz()),zO}Xz();var KO={},XO={},ZO;function Zz(){if(ZO)return XO;ZO=1;var t=pt(),e=ln(),n=Sr(),r=cn(),i=Oo(),o=WE(),s=ck(),a=Rr(),l=BE(),u=pa(),c=ga(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),f=c||h||d,g=o(function(){var w=this.iterator,C=r(e(this.next,w)),S=this.done=!!C.done;if(!S)return s(w,this.mapper,[C.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(C){r(this);try{n(C)}catch(S){a(this,"throw",S)}return d?e(d,this,C):new g(i(this),{mapper:C})}}),XO}var JO;function Jz(){return JO||(JO=1,Zz()),KO}Jz();var QO={},ex={},Ry,tx;function jE(){if(tx)return Ry;tx=1;var t=Jt();return Ry=t([].slice),Ry}var Ey,nx;function hk(){if(nx)return Ey;nx=1;var t=TypeError;return Ey=function(e,n){if(e<n)throw new t("Not enough arguments");return e},Ey}var Ty,rx;function Qz(){if(rx)return Ty;rx=1;var t=Xp();return Ty=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),Ty}var _y,ix;function dk(){if(ix)return _y;ix=1;var t=Zt(),e=Xp(),n=Fl(),r=function(i){return e.slice(0,i.length)===i};return _y=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),_y}var My,ox;function eY(){if(ox)return My;ox=1;var t=dk();return My=t==="NODE",My}var Iy,sx;function fk(){if(sx)return Iy;sx=1;var t=Zt(),e=tf(),n=rk(),r=un(),i=hi(),o=an(),s=lk(),a=jE(),l=HE(),u=hk(),c=Qz(),h=eY(),d=t.setImmediate,f=t.clearImmediate,g=t.process,w=t.Dispatch,C=t.Function,S=t.MessageChannel,v=t.String,E=0,P={},x="onreadystatechange",_,M,V,z;o(function(){_=t.location});var O=function(te){if(i(P,te)){var ne=P[te];delete P[te],ne()}},G=function(te){return function(){O(te)}},Z=function(te){O(te.data)},ae=function(te){t.postMessage(v(te),_.protocol+"//"+_.host)};return(!d||!f)&&(d=function(ne){u(arguments.length,1);var Fe=r(ne)?ne:C(ne),ke=a(arguments,1);return P[++E]=function(){e(Fe,void 0,ke)},M(E),E},f=function(ne){delete P[ne]},h?M=function(te){g.nextTick(G(te))}:w&&w.now?M=function(te){w.now(G(te))}:S&&!c?(V=new S,z=V.port2,V.port1.onmessage=Z,M=n(z.postMessage,z)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&_&&_.protocol!=="file:"&&!o(ae)?(M=ae,t.addEventListener("message",Z,!1)):x in l("script")?M=function(te){s.appendChild(l("script"))[x]=function(){s.removeChild(this),O(te)}}:M=function(te){setTimeout(G(te),0)}),Iy={set:d,clear:f},Iy}var ax;function tY(){if(ax)return ex;ax=1;var t=pt(),e=Zt(),n=fk().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),ex}var lx={},Py,ux;function nY(){if(ux)return Py;ux=1;var t=Zt(),e=tf(),n=un(),r=dk(),i=Xp(),o=jE(),s=hk(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return Py=function(u,c){var h=c?2:1;return l?function(d,f){var g=s(arguments.length,1)>h,w=n(d)?d:a(d),C=g?o(arguments,h):[],S=g?function(){e(w,this,C)}:w;return c?u(S,f):u(S)}:u},Py}var cx;function rY(){if(cx)return lx;cx=1;var t=pt(),e=Zt(),n=fk().set,r=nY(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),lx}var hx;function iY(){return hx||(hx=1,tY(),rY()),QO}iY();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:gk,setPrototypeOf:dx,isFrozen:oY,getPrototypeOf:sY,getOwnPropertyDescriptor:aY}=Object;let{freeze:Jn,seal:li,create:mk}=Object,{apply:mR,construct:pR}=typeof Reflect<"u"&&Reflect;Jn||(Jn=function(e){return e});li||(li=function(e){return e});mR||(mR=function(e,n,r){return e.apply(n,r)});pR||(pR=function(e,n){return new e(...n)});const Af=Qn(Array.prototype.forEach),lY=Qn(Array.prototype.lastIndexOf),fx=Qn(Array.prototype.pop),zc=Qn(Array.prototype.push),uY=Qn(Array.prototype.splice),pm=Qn(String.prototype.toLowerCase),Oy=Qn(String.prototype.toString),gx=Qn(String.prototype.match),Yc=Qn(String.prototype.replace),cY=Qn(String.prototype.indexOf),hY=Qn(String.prototype.trim),Mi=Qn(Object.prototype.hasOwnProperty),Bn=Qn(RegExp.prototype.test),Gc=dY(TypeError);function Qn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return mR(t,e,r)}}function dY(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return pR(t,n)}}function Le(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:pm;dx&&dx(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(oY(e)||(e[r]=o),i=o)}t[i]=!0}return t}function fY(t){for(let e=0;e<t.length;e++)Mi(t,e)||(t[e]=null);return t}function Xo(t){const e=mk(null);for(const[n,r]of gk(t))Mi(t,n)&&(Array.isArray(r)?e[n]=fY(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Xo(r):e[n]=r);return e}function qc(t,e){for(;t!==null;){const r=aY(t,e);if(r){if(r.get)return Qn(r.get);if(typeof r.value=="function")return Qn(r.value)}t=sY(t)}function n(){return null}return n}const mx=Jn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),xy=Jn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ay=Jn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),gY=Jn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Hy=Jn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mY=Jn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),px=Jn(["#text"]),wx=Jn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ny=Jn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),vx=Jn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Hf=Jn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),pY=li(/\{\{[\w\W]*|[\w\W]*\}\}/gm),wY=li(/<%[\w\W]*|[\w\W]*%>/gm),vY=li(/\$\{[\w\W]*/gm),CY=li(/^data-[\-\w.\u00B7-\uFFFF]+$/),yY=li(/^aria-[\-\w]+$/),pk=li(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bY=li(/^(?:\w+script|data):/i),SY=li(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),wk=li(/^html$/i),RY=li(/^[a-z][.\w]*(-[.\w]+)+$/i);var Cx=Object.freeze({__proto__:null,ARIA_ATTR:yY,ATTR_WHITESPACE:SY,CUSTOM_ELEMENT:RY,DATA_ATTR:CY,DOCTYPE_NAME:wk,ERB_EXPR:wY,IS_ALLOWED_URI:pk,IS_SCRIPT_OR_DATA:bY,MUSTACHE_EXPR:pY,TMPLIT_EXPR:vY});const Kc={element:1,text:3,progressingInstruction:7,comment:8,document:9},EY=function(){return typeof window>"u"?null:window},TY=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},yx=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function vk(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:EY();const e=we=>vk(we);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Kc.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,w=qc(g,"cloneNode"),C=qc(g,"remove"),S=qc(g,"nextSibling"),v=qc(g,"childNodes"),E=qc(g,"parentNode");if(typeof s=="function"){const we=n.createElement("template");we.content&&we.content.ownerDocument&&(n=we.content.ownerDocument)}let P,x="";const{implementation:_,createNodeIterator:M,createDocumentFragment:V,getElementsByTagName:z}=n,{importNode:O}=r;let G=yx();e.isSupported=typeof gk=="function"&&typeof E=="function"&&_&&_.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Z,ERB_EXPR:ae,TMPLIT_EXPR:te,DATA_ATTR:ne,ARIA_ATTR:Fe,IS_SCRIPT_OR_DATA:ke,ATTR_WHITESPACE:Ve,CUSTOM_ELEMENT:yt}=Cx;let{IS_ALLOWED_URI:ot}=Cx,ut=null;const wn=Le({},[...mx,...xy,...Ay,...Hy,...px]);let m=null;const p=Le({},[...wx,...Ny,...vx,...Hf]);let b=Object.seal(mk(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),D=null,F=null,j=!0,K=!0,y=!1,R=!0,T=!1,I=!0,A=!1,L=!1,B=!1,N=!1,$=!1,W=!1,U=!0,q=!1;const se="user-content-";let le=!0,Re=!1,We={},Be=null;const Ee=Le({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Se=null;const nt=Le({},["audio","video","img","source","image","track"]);let nr=null;const No=Le({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pi="http://www.w3.org/1998/Math/MathML",hn="http://www.w3.org/2000/svg",bt="http://www.w3.org/1999/xhtml";let _t=bt,wt=!1,Qe=null;const Br=Le({},[pi,hn,bt],Oy);let Wn=Le({},["mi","mo","mn","ms","mtext"]),ba=Le({},["annotation-xml"]);const Mf=Le({},["title","style","font","a","script"]);let Wc=null;const jW=["application/xhtml+xml","text/html"],UW="text/html";let vn=null,ql=null;const zW=n.createElement("form"),yM=function(k){return k instanceof RegExp||k instanceof Function},Qw=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ql&&ql===k)){if((!k||typeof k!="object")&&(k={}),k=Xo(k),Wc=jW.indexOf(k.PARSER_MEDIA_TYPE)===-1?UW:k.PARSER_MEDIA_TYPE,vn=Wc==="application/xhtml+xml"?Oy:pm,ut=Mi(k,"ALLOWED_TAGS")?Le({},k.ALLOWED_TAGS,vn):wn,m=Mi(k,"ALLOWED_ATTR")?Le({},k.ALLOWED_ATTR,vn):p,Qe=Mi(k,"ALLOWED_NAMESPACES")?Le({},k.ALLOWED_NAMESPACES,Oy):Br,nr=Mi(k,"ADD_URI_SAFE_ATTR")?Le(Xo(No),k.ADD_URI_SAFE_ATTR,vn):No,Se=Mi(k,"ADD_DATA_URI_TAGS")?Le(Xo(nt),k.ADD_DATA_URI_TAGS,vn):nt,Be=Mi(k,"FORBID_CONTENTS")?Le({},k.FORBID_CONTENTS,vn):Ee,D=Mi(k,"FORBID_TAGS")?Le({},k.FORBID_TAGS,vn):Xo({}),F=Mi(k,"FORBID_ATTR")?Le({},k.FORBID_ATTR,vn):Xo({}),We=Mi(k,"USE_PROFILES")?k.USE_PROFILES:!1,j=k.ALLOW_ARIA_ATTR!==!1,K=k.ALLOW_DATA_ATTR!==!1,y=k.ALLOW_UNKNOWN_PROTOCOLS||!1,R=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,T=k.SAFE_FOR_TEMPLATES||!1,I=k.SAFE_FOR_XML!==!1,A=k.WHOLE_DOCUMENT||!1,N=k.RETURN_DOM||!1,$=k.RETURN_DOM_FRAGMENT||!1,W=k.RETURN_TRUSTED_TYPE||!1,B=k.FORCE_BODY||!1,U=k.SANITIZE_DOM!==!1,q=k.SANITIZE_NAMED_PROPS||!1,le=k.KEEP_CONTENT!==!1,Re=k.IN_PLACE||!1,ot=k.ALLOWED_URI_REGEXP||pk,_t=k.NAMESPACE||bt,Wn=k.MATHML_TEXT_INTEGRATION_POINTS||Wn,ba=k.HTML_INTEGRATION_POINTS||ba,b=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&yM(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(b.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&yM(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(b.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(b.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),T&&(K=!1),$&&(N=!0),We&&(ut=Le({},px),m=[],We.html===!0&&(Le(ut,mx),Le(m,wx)),We.svg===!0&&(Le(ut,xy),Le(m,Ny),Le(m,Hf)),We.svgFilters===!0&&(Le(ut,Ay),Le(m,Ny),Le(m,Hf)),We.mathMl===!0&&(Le(ut,Hy),Le(m,vx),Le(m,Hf))),k.ADD_TAGS&&(ut===wn&&(ut=Xo(ut)),Le(ut,k.ADD_TAGS,vn)),k.ADD_ATTR&&(m===p&&(m=Xo(m)),Le(m,k.ADD_ATTR,vn)),k.ADD_URI_SAFE_ATTR&&Le(nr,k.ADD_URI_SAFE_ATTR,vn),k.FORBID_CONTENTS&&(Be===Ee&&(Be=Xo(Be)),Le(Be,k.FORBID_CONTENTS,vn)),le&&(ut["#text"]=!0),A&&Le(ut,["html","head","body"]),ut.table&&(Le(ut,["tbody"]),delete D.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw Gc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Gc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');P=k.TRUSTED_TYPES_POLICY,x=P.createHTML("")}else P===void 0&&(P=TY(f,i)),P!==null&&typeof x=="string"&&(x=P.createHTML(""));Jn&&Jn(k),ql=k}},bM=Le({},[...xy,...Ay,...gY]),SM=Le({},[...Hy,...mY]),YW=function(k){let ee=E(k);(!ee||!ee.tagName)&&(ee={namespaceURI:_t,tagName:"template"});const ge=pm(k.tagName),Mt=pm(ee.tagName);return Qe[k.namespaceURI]?k.namespaceURI===hn?ee.namespaceURI===bt?ge==="svg":ee.namespaceURI===pi?ge==="svg"&&(Mt==="annotation-xml"||Wn[Mt]):!!bM[ge]:k.namespaceURI===pi?ee.namespaceURI===bt?ge==="math":ee.namespaceURI===hn?ge==="math"&&ba[Mt]:!!SM[ge]:k.namespaceURI===bt?ee.namespaceURI===hn&&!ba[Mt]||ee.namespaceURI===pi&&!Wn[Mt]?!1:!SM[ge]&&(Mf[ge]||!bM[ge]):!!(Wc==="application/xhtml+xml"&&Qe[k.namespaceURI]):!1},Gi=function(k){zc(e.removed,{element:k});try{E(k).removeChild(k)}catch{C(k)}},Kl=function(k,ee){try{zc(e.removed,{attribute:ee.getAttributeNode(k),from:ee})}catch{zc(e.removed,{attribute:null,from:ee})}if(ee.removeAttribute(k),k==="is")if(N||$)try{Gi(ee)}catch{}else try{ee.setAttribute(k,"")}catch{}},RM=function(k){let ee=null,ge=null;if(B)k="<remove></remove>"+k;else{const dn=gx(k,/^[\r\n\t ]+/);ge=dn&&dn[0]}Wc==="application/xhtml+xml"&&_t===bt&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const Mt=P?P.createHTML(k):k;if(_t===bt)try{ee=new d().parseFromString(Mt,Wc)}catch{}if(!ee||!ee.documentElement){ee=_.createDocument(_t,"template",null);try{ee.documentElement.innerHTML=wt?x:Mt}catch{}}const _n=ee.body||ee.documentElement;return k&&ge&&_n.insertBefore(n.createTextNode(ge),_n.childNodes[0]||null),_t===bt?z.call(ee,A?"html":"body")[0]:A?ee.documentElement:_n},EM=function(k){return M.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},ev=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},TM=function(k){return typeof a=="function"&&k instanceof a};function Do(we,k,ee){Af(we,ge=>{ge.call(e,k,ee,ql)})}const _M=function(k){let ee=null;if(Do(G.beforeSanitizeElements,k,null),ev(k))return Gi(k),!0;const ge=vn(k.nodeName);if(Do(G.uponSanitizeElement,k,{tagName:ge,allowedTags:ut}),I&&k.hasChildNodes()&&!TM(k.firstElementChild)&&Bn(/<[/\w!]/g,k.innerHTML)&&Bn(/<[/\w!]/g,k.textContent)||k.nodeType===Kc.progressingInstruction||I&&k.nodeType===Kc.comment&&Bn(/<[/\w]/g,k.data))return Gi(k),!0;if(!ut[ge]||D[ge]){if(!D[ge]&&IM(ge)&&(b.tagNameCheck instanceof RegExp&&Bn(b.tagNameCheck,ge)||b.tagNameCheck instanceof Function&&b.tagNameCheck(ge)))return!1;if(le&&!Be[ge]){const Mt=E(k)||k.parentNode,_n=v(k)||k.childNodes;if(_n&&Mt){const dn=_n.length;for(let rr=dn-1;rr>=0;--rr){const ko=w(_n[rr],!0);ko.__removalCount=(k.__removalCount||0)+1,Mt.insertBefore(ko,S(k))}}}return Gi(k),!0}return k instanceof l&&!YW(k)||(ge==="noscript"||ge==="noembed"||ge==="noframes")&&Bn(/<\/no(script|embed|frames)/i,k.innerHTML)?(Gi(k),!0):(T&&k.nodeType===Kc.text&&(ee=k.textContent,Af([Z,ae,te],Mt=>{ee=Yc(ee,Mt," ")}),k.textContent!==ee&&(zc(e.removed,{element:k.cloneNode()}),k.textContent=ee)),Do(G.afterSanitizeElements,k,null),!1)},MM=function(k,ee,ge){if(U&&(ee==="id"||ee==="name")&&(ge in n||ge in zW))return!1;if(!(K&&!F[ee]&&Bn(ne,ee))){if(!(j&&Bn(Fe,ee))){if(!m[ee]||F[ee]){if(!(IM(k)&&(b.tagNameCheck instanceof RegExp&&Bn(b.tagNameCheck,k)||b.tagNameCheck instanceof Function&&b.tagNameCheck(k))&&(b.attributeNameCheck instanceof RegExp&&Bn(b.attributeNameCheck,ee)||b.attributeNameCheck instanceof Function&&b.attributeNameCheck(ee))||ee==="is"&&b.allowCustomizedBuiltInElements&&(b.tagNameCheck instanceof RegExp&&Bn(b.tagNameCheck,ge)||b.tagNameCheck instanceof Function&&b.tagNameCheck(ge))))return!1}else if(!nr[ee]){if(!Bn(ot,Yc(ge,Ve,""))){if(!((ee==="src"||ee==="xlink:href"||ee==="href")&&k!=="script"&&cY(ge,"data:")===0&&Se[k])){if(!(y&&!Bn(ke,Yc(ge,Ve,"")))){if(ge)return!1}}}}}}return!0},IM=function(k){return k!=="annotation-xml"&&gx(k,yt)},PM=function(k){Do(G.beforeSanitizeAttributes,k,null);const{attributes:ee}=k;if(!ee||ev(k))return;const ge={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:m,forceKeepAttr:void 0};let Mt=ee.length;for(;Mt--;){const _n=ee[Mt],{name:dn,namespaceURI:rr,value:ko}=_n,Bc=vn(dn),tv=ko;let Mn=dn==="value"?tv:hY(tv);if(ge.attrName=Bc,ge.attrValue=Mn,ge.keepAttr=!0,ge.forceKeepAttr=void 0,Do(G.uponSanitizeAttribute,k,ge),Mn=ge.attrValue,q&&(Bc==="id"||Bc==="name")&&(Kl(dn,k),Mn=se+Mn),I&&Bn(/((--!?|])>)|<\/(style|title)/i,Mn)){Kl(dn,k);continue}if(ge.forceKeepAttr)continue;if(!ge.keepAttr){Kl(dn,k);continue}if(!R&&Bn(/\/>/i,Mn)){Kl(dn,k);continue}T&&Af([Z,ae,te],xM=>{Mn=Yc(Mn,xM," ")});const OM=vn(k.nodeName);if(!MM(OM,Bc,Mn)){Kl(dn,k);continue}if(P&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!rr)switch(f.getAttributeType(OM,Bc)){case"TrustedHTML":{Mn=P.createHTML(Mn);break}case"TrustedScriptURL":{Mn=P.createScriptURL(Mn);break}}if(Mn!==tv)try{rr?k.setAttributeNS(rr,dn,Mn):k.setAttribute(dn,Mn),ev(k)?Gi(k):fx(e.removed)}catch{Kl(dn,k)}}Do(G.afterSanitizeAttributes,k,null)},GW=function we(k){let ee=null;const ge=EM(k);for(Do(G.beforeSanitizeShadowDOM,k,null);ee=ge.nextNode();)Do(G.uponSanitizeShadowNode,ee,null),_M(ee),PM(ee),ee.content instanceof o&&we(ee.content);Do(G.afterSanitizeShadowDOM,k,null)};return e.sanitize=function(we){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ee=null,ge=null,Mt=null,_n=null;if(wt=!we,wt&&(we="<!-->"),typeof we!="string"&&!TM(we))if(typeof we.toString=="function"){if(we=we.toString(),typeof we!="string")throw Gc("dirty is not a string, aborting")}else throw Gc("toString is not a function");if(!e.isSupported)return we;if(L||Qw(k),e.removed=[],typeof we=="string"&&(Re=!1),Re){if(we.nodeName){const ko=vn(we.nodeName);if(!ut[ko]||D[ko])throw Gc("root node is forbidden and cannot be sanitized in-place")}}else if(we instanceof a)ee=RM("<!---->"),ge=ee.ownerDocument.importNode(we,!0),ge.nodeType===Kc.element&&ge.nodeName==="BODY"||ge.nodeName==="HTML"?ee=ge:ee.appendChild(ge);else{if(!N&&!T&&!A&&we.indexOf("<")===-1)return P&&W?P.createHTML(we):we;if(ee=RM(we),!ee)return N?null:W?x:""}ee&&B&&Gi(ee.firstChild);const dn=EM(Re?we:ee);for(;Mt=dn.nextNode();)_M(Mt),PM(Mt),Mt.content instanceof o&&GW(Mt.content);if(Re)return we;if(N){if($)for(_n=V.call(ee.ownerDocument);ee.firstChild;)_n.appendChild(ee.firstChild);else _n=ee;return(m.shadowroot||m.shadowrootmode)&&(_n=O.call(r,_n,!0)),_n}let rr=A?ee.outerHTML:ee.innerHTML;return A&&ut["!doctype"]&&ee.ownerDocument&&ee.ownerDocument.doctype&&ee.ownerDocument.doctype.name&&Bn(wk,ee.ownerDocument.doctype.name)&&(rr="<!DOCTYPE "+ee.ownerDocument.doctype.name+`>
`+rr),T&&Af([Z,ae,te],ko=>{rr=Yc(rr,ko," ")}),P&&W?P.createHTML(rr):rr},e.setConfig=function(){let we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Qw(we),L=!0},e.clearConfig=function(){ql=null,L=!1},e.isValidAttribute=function(we,k,ee){ql||Qw({});const ge=vn(we),Mt=vn(k);return MM(ge,Mt,ee)},e.addHook=function(we,k){typeof k=="function"&&zc(G[we],k)},e.removeHook=function(we,k){if(k!==void 0){const ee=lY(G[we],k);return ee===-1?void 0:uY(G[we],ee,1)[0]}return fx(G[we])},e.removeHooks=function(we){G[we]=[]},e.removeAllHooks=function(){G=yx()},e}var _Y=vk();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Ck;function J(){return Ck.apply(null,arguments)}function MY(t){Ck=t}function $i(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Sl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function et(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function UE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(et(t,e))return!1;return!0}function dr(t){return t===void 0}function ps(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function of(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function yk(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function ea(t,e){for(var n in e)et(e,n)&&(t[n]=e[n]);return et(e,"toString")&&(t.toString=e.toString),et(e,"valueOf")&&(t.valueOf=e.valueOf),t}function xo(t,e,n,r){return jk(t,e,n,r,!0).utc()}function IY(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Oe(t){return t._pf==null&&(t._pf=IY()),t._pf}var wR;Array.prototype.some?wR=Array.prototype.some:wR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function zE(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Oe(t),n=wR.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function Qp(t){var e=xo(NaN);return t!=null?ea(Oe(e),t):Oe(e).userInvalidated=!0,e}var bx=J.momentProperties=[],Dy=!1;function YE(t,e){var n,r,i,o=bx.length;if(dr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),dr(e._i)||(t._i=e._i),dr(e._f)||(t._f=e._f),dr(e._l)||(t._l=e._l),dr(e._strict)||(t._strict=e._strict),dr(e._tzm)||(t._tzm=e._tzm),dr(e._isUTC)||(t._isUTC=e._isUTC),dr(e._offset)||(t._offset=e._offset),dr(e._pf)||(t._pf=Oe(e)),dr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=bx[n],i=e[r],dr(i)||(t[r]=i);return t}function sf(t){YE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Dy===!1&&(Dy=!0,J.updateOffset(this),Dy=!1)}function Fi(t){return t instanceof sf||t!=null&&t._isAMomentObject!=null}function bk(t){J.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function di(t,e){var n=!0;return ea(function(){if(J.deprecationHandler!=null&&J.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])et(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}bk(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var Sx={};function Sk(t,e){J.deprecationHandler!=null&&J.deprecationHandler(t,e),Sx[t]||(bk(e),Sx[t]=!0)}J.suppressDeprecationWarnings=!1;J.deprecationHandler=null;function Ao(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function PY(t){var e,n;for(n in t)et(t,n)&&(e=t[n],Ao(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function vR(t,e){var n=ea({},t),r;for(r in e)et(e,r)&&(Sl(t[r])&&Sl(e[r])?(n[r]={},ea(n[r],t[r]),ea(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)et(t,r)&&!et(e,r)&&Sl(t[r])&&(n[r]=ea({},n[r]));return n}function GE(t){t!=null&&this.set(t)}var CR;Object.keys?CR=Object.keys:CR=function(t){var e,n=[];for(e in t)et(t,e)&&n.push(e);return n};var OY={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function xY(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Ao(r)?r.call(e,n):r}function Mo(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var qE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Nf=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ky={},Qu={};function Ce(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Qu[t]=i),e&&(Qu[e[0]]=function(){return Mo(i.apply(this,arguments),e[1],e[2])}),n&&(Qu[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function AY(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function HY(t){var e=t.match(qE),n,r;for(n=0,r=e.length;n<r;n++)Qu[e[n]]?e[n]=Qu[e[n]]:e[n]=AY(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Ao(e[s])?e[s].call(i,t):e[s];return o}}function wm(t,e){return t.isValid()?(e=Rk(e,t.localeData()),ky[e]=ky[e]||HY(e),ky[e](t)):t.localeData().invalidDate()}function Rk(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Nf.lastIndex=0;n>=0&&Nf.test(t);)t=t.replace(Nf,r),Nf.lastIndex=0,n-=1;return t}var NY={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function DY(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(qE).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var kY="Invalid date";function LY(){return this._invalidDate}var $Y="%d",FY=/\d{1,2}/;function VY(t){return this._ordinal.replace("%d",t)}var WY={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function BY(t,e,n,r){var i=this._relativeTime[n];return Ao(i)?i(t,e,n,r):i.replace(/%d/i,t)}function jY(t,e){var n=this._relativeTime[t>0?"future":"past"];return Ao(n)?n(e):n.replace(/%s/i,e)}var Rx={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function fi(t){return typeof t=="string"?Rx[t]||Rx[t.toLowerCase()]:void 0}function KE(t){var e={},n,r;for(r in t)et(t,r)&&(n=fi(r),n&&(e[n]=t[r]));return e}var UY={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function zY(t){var e=[],n;for(n in t)et(t,n)&&e.push({unit:n,priority:UY[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var Ek=/\d/,Wr=/\d\d/,Tk=/\d{3}/,XE=/\d{4}/,ew=/[+-]?\d{6}/,Tt=/\d\d?/,_k=/\d\d\d\d?/,Mk=/\d\d\d\d\d\d?/,tw=/\d{1,3}/,ZE=/\d{1,4}/,nw=/[+-]?\d{1,6}/,Ic=/\d+/,rw=/[+-]?\d+/,YY=/Z|[+-]\d\d:?\d\d/gi,iw=/Z|[+-]\d\d(?::?\d\d)?/gi,GY=/[+-]?\d+(\.\d{1,3})?/,af=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Pc=/^[1-9]\d?/,JE=/^([1-9]\d|\d)/,Um;Um={};function ce(t,e,n){Um[t]=Ao(e)?e:function(r,i){return r&&n?n:e}}function qY(t,e){return et(Um,t)?Um[t](e._strict,e._locale):new RegExp(KY(t))}function KY(t){return fs(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function fs(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ri(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Ue(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=ri(e)),n}var yR={};function gt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),ps(e)&&(r=function(o,s){s[e]=Ue(o)}),i=t.length,n=0;n<i;n++)yR[t[n]]=r}function lf(t,e){gt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function XY(t,e,n){e!=null&&et(yR,t)&&yR[t](e,n._a,n,t)}function ow(t){return t%4===0&&t%100!==0||t%400===0}var Vn=0,ss=1,yo=2,pn=3,Di=4,as=5,dl=6,ZY=7,JY=8;Ce("Y",0,0,function(){var t=this.year();return t<=9999?Mo(t,4):"+"+t});Ce(0,["YY",2],0,function(){return this.year()%100});Ce(0,["YYYY",4],0,"year");Ce(0,["YYYYY",5],0,"year");Ce(0,["YYYYYY",6,!0],0,"year");ce("Y",rw);ce("YY",Tt,Wr);ce("YYYY",ZE,XE);ce("YYYYY",nw,ew);ce("YYYYYY",nw,ew);gt(["YYYYY","YYYYYY"],Vn);gt("YYYY",function(t,e){e[Vn]=t.length===2?J.parseTwoDigitYear(t):Ue(t)});gt("YY",function(t,e){e[Vn]=J.parseTwoDigitYear(t)});gt("Y",function(t,e){e[Vn]=parseInt(t,10)});function td(t){return ow(t)?366:365}J.parseTwoDigitYear=function(t){return Ue(t)+(Ue(t)>68?1900:2e3)};var Ik=Oc("FullYear",!0);function QY(){return ow(this.year())}function Oc(t,e){return function(n){return n!=null?(Pk(this,t,n),J.updateOffset(this,e),this):Md(this,t)}}function Md(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function Pk(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!ow(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function eG(t){return t=fi(t),Ao(this[t])?this[t]():this}function tG(t,e){if(typeof t=="object"){t=KE(t);var n=zY(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=fi(t),Ao(this[t]))return this[t](e);return this}function nG(t,e){return(t%e+e)%e}var Gt;Array.prototype.indexOf?Gt=Array.prototype.indexOf:Gt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function QE(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=nG(e,12);return t+=(e-n)/12,n===1?ow(t)?29:28:31-n%7%2}Ce("M",["MM",2],"Mo",function(){return this.month()+1});Ce("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ce("MMMM",0,0,function(t){return this.localeData().months(this,t)});ce("M",Tt,Pc);ce("MM",Tt,Wr);ce("MMM",function(t,e){return e.monthsShortRegex(t)});ce("MMMM",function(t,e){return e.monthsRegex(t)});gt(["M","MM"],function(t,e){e[ss]=Ue(t)-1});gt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ss]=i:Oe(n).invalidMonth=t});var rG="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ok="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),xk=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,iG=af,oG=af;function sG(t,e){return t?$i(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||xk).test(e)?"format":"standalone"][t.month()]:$i(this._months)?this._months:this._months.standalone}function aG(t,e){return t?$i(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[xk.test(e)?"format":"standalone"][t.month()]:$i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function lG(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=xo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Gt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Gt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Gt.call(this._shortMonthsParse,s),i!==-1?i:(i=Gt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Gt.call(this._longMonthsParse,s),i!==-1?i:(i=Gt.call(this._shortMonthsParse,s),i!==-1?i:null))}function uG(t,e,n){var r,i,o;if(this._monthsParseExact)return lG.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=xo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function Ak(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ue(e);else if(e=t.localeData().monthsParse(e),!ps(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,QE(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function Hk(t){return t!=null?(Ak(this,t),J.updateOffset(this,!0),this):Md(this,"Month")}function cG(){return QE(this.year(),this.month())}function hG(t){return this._monthsParseExact?(et(this,"_monthsRegex")||Nk.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(et(this,"_monthsShortRegex")||(this._monthsShortRegex=iG),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function dG(t){return this._monthsParseExact?(et(this,"_monthsRegex")||Nk.call(this),t?this._monthsStrictRegex:this._monthsRegex):(et(this,"_monthsRegex")||(this._monthsRegex=oG),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function Nk(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=xo([2e3,i]),s=fs(this.monthsShort(o,"")),a=fs(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function fG(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Id(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function zm(t,e,n){var r=7+e-n,i=(7+Id(t,0,r).getUTCDay()-e)%7;return-i+r-1}function Dk(t,e,n,r,i){var o=(7+n-r)%7,s=zm(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=td(l)+a):a>td(t)?(l=t+1,u=a-td(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Pd(t,e,n){var r=zm(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+gs(s,e,n)):i>gs(t.year(),e,n)?(o=i-gs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function gs(t,e,n){var r=zm(t,e,n),i=zm(t+1,e,n);return(td(t)-r+i)/7}Ce("w",["ww",2],"wo","week");Ce("W",["WW",2],"Wo","isoWeek");ce("w",Tt,Pc);ce("ww",Tt,Wr);ce("W",Tt,Pc);ce("WW",Tt,Wr);lf(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Ue(t)});function gG(t){return Pd(t,this._week.dow,this._week.doy).week}var mG={dow:0,doy:6};function pG(){return this._week.dow}function wG(){return this._week.doy}function vG(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function CG(t){var e=Pd(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ce("d",0,"do","day");Ce("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ce("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ce("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ce("e",0,0,"weekday");Ce("E",0,0,"isoWeekday");ce("d",Tt);ce("e",Tt);ce("E",Tt);ce("dd",function(t,e){return e.weekdaysMinRegex(t)});ce("ddd",function(t,e){return e.weekdaysShortRegex(t)});ce("dddd",function(t,e){return e.weekdaysRegex(t)});lf(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Oe(n).invalidWeekday=t});lf(["d","e","E"],function(t,e,n,r){e[r]=Ue(t)});function yG(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function bG(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function e0(t,e){return t.slice(e,7).concat(t.slice(0,e))}var SG="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),kk="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),RG="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),EG=af,TG=af,_G=af;function MG(t,e){var n=$i(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?e0(n,this._week.dow):t?n[t.day()]:n}function IG(t){return t===!0?e0(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function PG(t){return t===!0?e0(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function OG(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=xo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Gt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Gt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Gt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Gt.call(this._weekdaysParse,s),i!==-1||(i=Gt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Gt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Gt.call(this._shortWeekdaysParse,s),i!==-1||(i=Gt.call(this._weekdaysParse,s),i!==-1)?i:(i=Gt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Gt.call(this._minWeekdaysParse,s),i!==-1||(i=Gt.call(this._weekdaysParse,s),i!==-1)?i:(i=Gt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function xG(t,e,n){var r,i,o;if(this._weekdaysParseExact)return OG.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=xo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function AG(t){if(!this.isValid())return t!=null?this:NaN;var e=Md(this,"Day");return t!=null?(t=yG(t,this.localeData()),this.add(t-e,"d")):e}function HG(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function NG(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=bG(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function DG(t){return this._weekdaysParseExact?(et(this,"_weekdaysRegex")||t0.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(et(this,"_weekdaysRegex")||(this._weekdaysRegex=EG),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function kG(t){return this._weekdaysParseExact?(et(this,"_weekdaysRegex")||t0.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(et(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=TG),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function LG(t){return this._weekdaysParseExact?(et(this,"_weekdaysRegex")||t0.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(et(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=_G),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function t0(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=xo([2e3,1]).day(o),a=fs(this.weekdaysMin(s,"")),l=fs(this.weekdaysShort(s,"")),u=fs(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function n0(){return this.hours()%12||12}function $G(){return this.hours()||24}Ce("H",["HH",2],0,"hour");Ce("h",["hh",2],0,n0);Ce("k",["kk",2],0,$G);Ce("hmm",0,0,function(){return""+n0.apply(this)+Mo(this.minutes(),2)});Ce("hmmss",0,0,function(){return""+n0.apply(this)+Mo(this.minutes(),2)+Mo(this.seconds(),2)});Ce("Hmm",0,0,function(){return""+this.hours()+Mo(this.minutes(),2)});Ce("Hmmss",0,0,function(){return""+this.hours()+Mo(this.minutes(),2)+Mo(this.seconds(),2)});function Lk(t,e){Ce(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}Lk("a",!0);Lk("A",!1);function $k(t,e){return e._meridiemParse}ce("a",$k);ce("A",$k);ce("H",Tt,JE);ce("h",Tt,Pc);ce("k",Tt,Pc);ce("HH",Tt,Wr);ce("hh",Tt,Wr);ce("kk",Tt,Wr);ce("hmm",_k);ce("hmmss",Mk);ce("Hmm",_k);ce("Hmmss",Mk);gt(["H","HH"],pn);gt(["k","kk"],function(t,e,n){var r=Ue(t);e[pn]=r===24?0:r});gt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});gt(["h","hh"],function(t,e,n){e[pn]=Ue(t),Oe(n).bigHour=!0});gt("hmm",function(t,e,n){var r=t.length-2;e[pn]=Ue(t.substr(0,r)),e[Di]=Ue(t.substr(r)),Oe(n).bigHour=!0});gt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[pn]=Ue(t.substr(0,r)),e[Di]=Ue(t.substr(r,2)),e[as]=Ue(t.substr(i)),Oe(n).bigHour=!0});gt("Hmm",function(t,e,n){var r=t.length-2;e[pn]=Ue(t.substr(0,r)),e[Di]=Ue(t.substr(r))});gt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[pn]=Ue(t.substr(0,r)),e[Di]=Ue(t.substr(r,2)),e[as]=Ue(t.substr(i))});function FG(t){return(t+"").toLowerCase().charAt(0)==="p"}var VG=/[ap]\.?m?\.?/i,WG=Oc("Hours",!0);function BG(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var Fk={calendar:OY,longDateFormat:NY,invalidDate:kY,ordinal:$Y,dayOfMonthOrdinalParse:FY,relativeTime:WY,months:rG,monthsShort:Ok,week:mG,weekdays:SG,weekdaysMin:RG,weekdaysShort:kk,meridiemParse:VG},It={},Xc={},Od;function jG(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function Ex(t){return t&&t.toLowerCase().replace("_","-")}function UG(t){for(var e=0,n,r,i,o;e<t.length;){for(o=Ex(t[e]).split("-"),n=o.length,r=Ex(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=sw(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&jG(o,r)>=n-1)break;n--}e++}return Od}function zG(t){return!!(t&&t.match("^[^/\\\\]*$"))}function sw(t){var e=null,n;if(It[t]===void 0&&typeof module<"u"&&module&&module.exports&&zG(t))try{e=Od._abbr,n=require,n("./locale/"+t),la(e)}catch{It[t]=null}return It[t]}function la(t,e){var n;return t&&(dr(e)?n=bs(t):n=r0(t,e),n?Od=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Od._abbr}function r0(t,e){if(e!==null){var n,r=Fk;if(e.abbr=t,It[t]!=null)Sk("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=It[t]._config;else if(e.parentLocale!=null)if(It[e.parentLocale]!=null)r=It[e.parentLocale]._config;else if(n=sw(e.parentLocale),n!=null)r=n._config;else return Xc[e.parentLocale]||(Xc[e.parentLocale]=[]),Xc[e.parentLocale].push({name:t,config:e}),null;return It[t]=new GE(vR(r,e)),Xc[t]&&Xc[t].forEach(function(i){r0(i.name,i.config)}),la(t),It[t]}else return delete It[t],null}function YG(t,e){if(e!=null){var n,r,i=Fk;It[t]!=null&&It[t].parentLocale!=null?It[t].set(vR(It[t]._config,e)):(r=sw(t),r!=null&&(i=r._config),e=vR(i,e),r==null&&(e.abbr=t),n=new GE(e),n.parentLocale=It[t],It[t]=n),la(t)}else It[t]!=null&&(It[t].parentLocale!=null?(It[t]=It[t].parentLocale,t===la()&&la(t)):It[t]!=null&&delete It[t]);return It[t]}function bs(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Od;if(!$i(t)){if(e=sw(t),e)return e;t=[t]}return UG(t)}function GG(){return CR(It)}function i0(t){var e,n=t._a;return n&&Oe(t).overflow===-2&&(e=n[ss]<0||n[ss]>11?ss:n[yo]<1||n[yo]>QE(n[Vn],n[ss])?yo:n[pn]<0||n[pn]>24||n[pn]===24&&(n[Di]!==0||n[as]!==0||n[dl]!==0)?pn:n[Di]<0||n[Di]>59?Di:n[as]<0||n[as]>59?as:n[dl]<0||n[dl]>999?dl:-1,Oe(t)._overflowDayOfYear&&(e<Vn||e>yo)&&(e=yo),Oe(t)._overflowWeeks&&e===-1&&(e=ZY),Oe(t)._overflowWeekday&&e===-1&&(e=JY),Oe(t).overflow=e),t}var qG=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,KG=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,XG=/Z|[+-]\d\d(?::?\d\d)?/,Df=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Ly=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ZG=/^\/?Date\((-?\d+)/i,JG=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,QG={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Vk(t){var e,n,r=t._i,i=qG.exec(r)||KG.exec(r),o,s,a,l,u=Df.length,c=Ly.length;if(i){for(Oe(t).iso=!0,e=0,n=u;e<n;e++)if(Df[e][1].exec(i[1])){s=Df[e][0],o=Df[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(Ly[e][1].exec(i[3])){a=(i[2]||" ")+Ly[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(XG.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),s0(t)}else t._isValid=!1}function e2(t,e,n,r,i,o){var s=[t2(t),Ok.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function t2(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function n2(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function r2(t,e,n){if(t){var r=kk.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Oe(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function i2(t,e,n){if(t)return QG[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function Wk(t){var e=JG.exec(n2(t._i)),n;if(e){if(n=e2(e[4],e[3],e[2],e[5],e[6],e[7]),!r2(e[1],n,t))return;t._a=n,t._tzm=i2(e[8],e[9],e[10]),t._d=Id.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Oe(t).rfc2822=!0}else t._isValid=!1}function o2(t){var e=ZG.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(Vk(t),t._isValid===!1)delete t._isValid;else return;if(Wk(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:J.createFromInputFallback(t)}J.createFromInputFallback=di("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Lu(t,e,n){return t??e??n}function s2(t){var e=new Date(J.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function o0(t){var e,n,r=[],i,o,s;if(!t._d){for(i=s2(t),t._w&&t._a[yo]==null&&t._a[ss]==null&&a2(t),t._dayOfYear!=null&&(s=Lu(t._a[Vn],i[Vn]),(t._dayOfYear>td(s)||t._dayOfYear===0)&&(Oe(t)._overflowDayOfYear=!0),n=Id(s,0,t._dayOfYear),t._a[ss]=n.getUTCMonth(),t._a[yo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[pn]===24&&t._a[Di]===0&&t._a[as]===0&&t._a[dl]===0&&(t._nextDay=!0,t._a[pn]=0),t._d=(t._useUTC?Id:fG).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[pn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Oe(t).weekdayMismatch=!0)}}function a2(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=Lu(e.GG,t._a[Vn],Pd(Et(),1,4).year),r=Lu(e.W,1),i=Lu(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Pd(Et(),o,s),n=Lu(e.gg,t._a[Vn],u.year),r=Lu(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>gs(n,o,s)?Oe(t)._overflowWeeks=!0:l!=null?Oe(t)._overflowWeekday=!0:(a=Dk(n,r,i,o,s),t._a[Vn]=a.year,t._dayOfYear=a.dayOfYear)}J.ISO_8601=function(){};J.RFC_2822=function(){};function s0(t){if(t._f===J.ISO_8601){Vk(t);return}if(t._f===J.RFC_2822){Wk(t);return}t._a=[],Oe(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=Rk(t._f,t._locale).match(qE)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(qY(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Oe(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Qu[o]?(r?Oe(t).empty=!1:Oe(t).unusedTokens.push(o),XY(o,r,t)):t._strict&&!r&&Oe(t).unusedTokens.push(o);Oe(t).charsLeftOver=a-l,e.length>0&&Oe(t).unusedInput.push(e),t._a[pn]<=12&&Oe(t).bigHour===!0&&t._a[pn]>0&&(Oe(t).bigHour=void 0),Oe(t).parsedDateParts=t._a.slice(0),Oe(t).meridiem=t._meridiem,t._a[pn]=l2(t._locale,t._a[pn],t._meridiem),u=Oe(t).era,u!==null&&(t._a[Vn]=t._locale.erasConvertYear(u,t._a[Vn])),o0(t),i0(t)}function l2(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function u2(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Oe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=YE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],s0(e),zE(e)&&(s=!0),o+=Oe(e).charsLeftOver,o+=Oe(e).unusedTokens.length*10,Oe(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));ea(t,n||e)}function c2(t){if(!t._d){var e=KE(t._i),n=e.day===void 0?e.date:e.day;t._a=yk([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),o0(t)}}function h2(t){var e=new sf(i0(Bk(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Bk(t){var e=t._i,n=t._f;return t._locale=t._locale||bs(t._l),e===null||n===void 0&&e===""?Qp({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Fi(e)?new sf(i0(e)):(of(e)?t._d=e:$i(n)?u2(t):n?s0(t):d2(t),zE(t)||(t._d=null),t))}function d2(t){var e=t._i;dr(e)?t._d=new Date(J.now()):of(e)?t._d=new Date(e.valueOf()):typeof e=="string"?o2(t):$i(e)?(t._a=yk(e.slice(0),function(n){return parseInt(n,10)}),o0(t)):Sl(e)?c2(t):ps(e)?t._d=new Date(e):J.createFromInputFallback(t)}function jk(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Sl(t)&&UE(t)||$i(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,h2(o)}function Et(t,e,n,r){return jk(t,e,n,r,!1)}var f2=di("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Qp()}),g2=di("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Qp()});function Uk(t,e){var n,r;if(e.length===1&&$i(e[0])&&(e=e[0]),!e.length)return Et();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function m2(){var t=[].slice.call(arguments,0);return Uk("isBefore",t)}function p2(){var t=[].slice.call(arguments,0);return Uk("isAfter",t)}var w2=function(){return Date.now?Date.now():+new Date},Zc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function v2(t){var e,n=!1,r,i=Zc.length;for(e in t)if(et(t,e)&&!(Gt.call(Zc,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Zc[r]]){if(n)return!1;parseFloat(t[Zc[r]])!==Ue(t[Zc[r]])&&(n=!0)}return!0}function C2(){return this._isValid}function y2(){return Ui(NaN)}function aw(t){var e=KE(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=v2(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=bs(),this._bubble()}function vm(t){return t instanceof aw}function bR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function b2(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Ue(t[s])!==Ue(e[s])&&o++;return o+i}function zk(t,e){Ce(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Mo(~~(n/60),2)+e+Mo(~~n%60,2)})}zk("Z",":");zk("ZZ","");ce("Z",iw);ce("ZZ",iw);gt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=a0(iw,t)});var S2=/([\+\-]|\d\d)/gi;function a0(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(S2)||["-",0,0],o=+(i[1]*60)+Ue(i[2]),o===0?0:i[0]==="+"?o:-o)}function l0(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Fi(t)||of(t)?t.valueOf():Et(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),J.updateOffset(n,!1),n):Et(t).local()}function SR(t){return-Math.round(t._d.getTimezoneOffset())}J.updateOffset=function(){};function R2(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=a0(iw,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=SR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?qk(this,Ui(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,J.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:SR(this)}function E2(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function T2(t){return this.utcOffset(0,t)}function _2(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(SR(this),"m")),this}function M2(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=a0(YY,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function I2(t){return this.isValid()?(t=t?Et(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function P2(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function O2(){if(!dr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return YE(t,this),t=Bk(t),t._a?(e=t._isUTC?xo(t._a):Et(t._a),this._isDSTShifted=this.isValid()&&b2(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function x2(){return this.isValid()?!this._isUTC:!1}function A2(){return this.isValid()?this._isUTC:!1}function Yk(){return this.isValid()?this._isUTC&&this._offset===0:!1}var H2=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,N2=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ui(t,e){var n=t,r=null,i,o,s;return vm(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:ps(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=H2.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Ue(r[yo])*i,h:Ue(r[pn])*i,m:Ue(r[Di])*i,s:Ue(r[as])*i,ms:Ue(bR(r[dl]*1e3))*i}):(r=N2.exec(t))?(i=r[1]==="-"?-1:1,n={y:Sa(r[2],i),M:Sa(r[3],i),w:Sa(r[4],i),d:Sa(r[5],i),h:Sa(r[6],i),m:Sa(r[7],i),s:Sa(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=D2(Et(n.from),Et(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new aw(n),vm(t)&&et(t,"_locale")&&(o._locale=t._locale),vm(t)&&et(t,"_isValid")&&(o._isValid=t._isValid),o}Ui.fn=aw.prototype;Ui.invalid=y2;function Sa(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Tx(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function D2(t,e){var n;return t.isValid()&&e.isValid()?(e=l0(e,t),t.isBefore(e)?n=Tx(t,e):(n=Tx(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Gk(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(Sk(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=Ui(n,r),qk(this,i,t),this}}function qk(t,e,n,r){var i=e._milliseconds,o=bR(e._days),s=bR(e._months);t.isValid()&&(r=r??!0,s&&Ak(t,Md(t,"Month")+s*n),o&&Pk(t,"Date",Md(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&J.updateOffset(t,o||s))}var k2=Gk(1,"add"),L2=Gk(-1,"subtract");function Kk(t){return typeof t=="string"||t instanceof String}function $2(t){return Fi(t)||of(t)||Kk(t)||ps(t)||V2(t)||F2(t)||t===null||t===void 0}function F2(t){var e=Sl(t)&&!UE(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||et(t,o);return e&&n}function V2(t){var e=$i(t),n=!1;return e&&(n=t.filter(function(r){return!ps(r)&&Kk(t)}).length===0),e&&n}function W2(t){var e=Sl(t)&&!UE(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||et(t,o);return e&&n}function B2(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function j2(t,e){arguments.length===1&&(arguments[0]?$2(arguments[0])?(t=arguments[0],e=void 0):W2(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Et(),r=l0(n,this).startOf("day"),i=J.calendarFormat(this,r)||"sameElse",o=e&&(Ao(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Et(n)))}function U2(){return new sf(this)}function z2(t,e){var n=Fi(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=fi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function Y2(t,e){var n=Fi(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=fi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function G2(t,e,n,r){var i=Fi(t)?t:Et(t),o=Fi(e)?e:Et(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function q2(t,e){var n=Fi(t)?t:Et(t),r;return this.isValid()&&n.isValid()?(e=fi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function K2(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function X2(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function Z2(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=l0(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=fi(e),e){case"year":o=Cm(this,r)/12;break;case"month":o=Cm(this,r);break;case"quarter":o=Cm(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:ri(o)}function Cm(t,e){if(t.date()<e.date())return-Cm(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}J.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";J.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function J2(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Q2(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?wm(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ao(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",wm(n,"Z")):wm(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function eq(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function tq(t){t||(t=this.isUtc()?J.defaultFormatUtc:J.defaultFormat);var e=wm(this,t);return this.localeData().postformat(e)}function nq(t,e){return this.isValid()&&(Fi(t)&&t.isValid()||Et(t).isValid())?Ui({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function rq(t){return this.from(Et(),t)}function iq(t,e){return this.isValid()&&(Fi(t)&&t.isValid()||Et(t).isValid())?Ui({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function oq(t){return this.to(Et(),t)}function Xk(t){var e;return t===void 0?this._locale._abbr:(e=bs(t),e!=null&&(this._locale=e),this)}var Zk=di("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function Jk(){return this._locale}var Ym=1e3,ec=60*Ym,Gm=60*ec,Qk=(365*400+97)*24*Gm;function tc(t,e){return(t%e+e)%e}function eL(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-Qk:new Date(t,e,n).valueOf()}function tL(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-Qk:Date.UTC(t,e,n)}function sq(t){var e,n;if(t=fi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?tL:eL,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=tc(e+(this._isUTC?0:this.utcOffset()*ec),Gm);break;case"minute":e=this._d.valueOf(),e-=tc(e,ec);break;case"second":e=this._d.valueOf(),e-=tc(e,Ym);break}return this._d.setTime(e),J.updateOffset(this,!0),this}function aq(t){var e,n;if(t=fi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?tL:eL,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Gm-tc(e+(this._isUTC?0:this.utcOffset()*ec),Gm)-1;break;case"minute":e=this._d.valueOf(),e+=ec-tc(e,ec)-1;break;case"second":e=this._d.valueOf(),e+=Ym-tc(e,Ym)-1;break}return this._d.setTime(e),J.updateOffset(this,!0),this}function lq(){return this._d.valueOf()-(this._offset||0)*6e4}function uq(){return Math.floor(this.valueOf()/1e3)}function cq(){return new Date(this.valueOf())}function hq(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function dq(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function fq(){return this.isValid()?this.toISOString():null}function gq(){return zE(this)}function mq(){return ea({},Oe(this))}function pq(){return Oe(this).overflow}function wq(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ce("N",0,0,"eraAbbr");Ce("NN",0,0,"eraAbbr");Ce("NNN",0,0,"eraAbbr");Ce("NNNN",0,0,"eraName");Ce("NNNNN",0,0,"eraNarrow");Ce("y",["y",1],"yo","eraYear");Ce("y",["yy",2],0,"eraYear");Ce("y",["yyy",3],0,"eraYear");Ce("y",["yyyy",4],0,"eraYear");ce("N",u0);ce("NN",u0);ce("NNN",u0);ce("NNNN",Iq);ce("NNNNN",Pq);gt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Oe(n).era=i:Oe(n).invalidEra=t});ce("y",Ic);ce("yy",Ic);ce("yyy",Ic);ce("yyyy",Ic);ce("yo",Oq);gt(["y","yy","yyy","yyyy"],Vn);gt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Vn]=n._locale.eraYearOrdinalParse(t,i):e[Vn]=parseInt(t,10)});function vq(t,e){var n,r,i,o=this._eras||bs("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=J(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=J(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function Cq(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function yq(t,e){var n=t.since<=t.until?1:-1;return e===void 0?J(t.since).year():J(t.since).year()+(e-t.offset)*n}function bq(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function Sq(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function Rq(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function Eq(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-J(i[t].since).year())*n+i[t].offset;return this.year()}function Tq(t){return et(this,"_erasNameRegex")||c0.call(this),t?this._erasNameRegex:this._erasRegex}function _q(t){return et(this,"_erasAbbrRegex")||c0.call(this),t?this._erasAbbrRegex:this._erasRegex}function Mq(t){return et(this,"_erasNarrowRegex")||c0.call(this),t?this._erasNarrowRegex:this._erasRegex}function u0(t,e){return e.erasAbbrRegex(t)}function Iq(t,e){return e.erasNameRegex(t)}function Pq(t,e){return e.erasNarrowRegex(t)}function Oq(t,e){return e._eraYearOrdinalRegex||Ic}function c0(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=fs(u[i].name),a=fs(u[i].abbr),l=fs(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ce(0,["gg",2],0,function(){return this.weekYear()%100});Ce(0,["GG",2],0,function(){return this.isoWeekYear()%100});function lw(t,e){Ce(0,[t,t.length],0,e)}lw("gggg","weekYear");lw("ggggg","weekYear");lw("GGGG","isoWeekYear");lw("GGGGG","isoWeekYear");ce("G",rw);ce("g",rw);ce("GG",Tt,Wr);ce("gg",Tt,Wr);ce("GGGG",ZE,XE);ce("gggg",ZE,XE);ce("GGGGG",nw,ew);ce("ggggg",nw,ew);lf(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Ue(t)});lf(["gg","GG"],function(t,e,n,r){e[r]=J.parseTwoDigitYear(t)});function xq(t){return nL.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Aq(t){return nL.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Hq(){return gs(this.year(),1,4)}function Nq(){return gs(this.isoWeekYear(),1,4)}function Dq(){var t=this.localeData()._week;return gs(this.year(),t.dow,t.doy)}function kq(){var t=this.localeData()._week;return gs(this.weekYear(),t.dow,t.doy)}function nL(t,e,n,r,i){var o;return t==null?Pd(this,r,i).year:(o=gs(t,r,i),e>o&&(e=o),Lq.call(this,t,e,n,r,i))}function Lq(t,e,n,r,i){var o=Dk(t,e,n,r,i),s=Id(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ce("Q",0,"Qo","quarter");ce("Q",Ek);gt("Q",function(t,e){e[ss]=(Ue(t)-1)*3});function $q(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ce("D",["DD",2],"Do","date");ce("D",Tt,Pc);ce("DD",Tt,Wr);ce("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});gt(["D","DD"],yo);gt("Do",function(t,e){e[yo]=Ue(t.match(Tt)[0])});var rL=Oc("Date",!0);Ce("DDD",["DDDD",3],"DDDo","dayOfYear");ce("DDD",tw);ce("DDDD",Tk);gt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Ue(t)});function Fq(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ce("m",["mm",2],0,"minute");ce("m",Tt,JE);ce("mm",Tt,Wr);gt(["m","mm"],Di);var Vq=Oc("Minutes",!1);Ce("s",["ss",2],0,"second");ce("s",Tt,JE);ce("ss",Tt,Wr);gt(["s","ss"],as);var Wq=Oc("Seconds",!1);Ce("S",0,0,function(){return~~(this.millisecond()/100)});Ce(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ce(0,["SSS",3],0,"millisecond");Ce(0,["SSSS",4],0,function(){return this.millisecond()*10});Ce(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ce(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ce(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ce(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ce(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ce("S",tw,Ek);ce("SS",tw,Wr);ce("SSS",tw,Tk);var ta,iL;for(ta="SSSS";ta.length<=9;ta+="S")ce(ta,Ic);function Bq(t,e){e[dl]=Ue(("0."+t)*1e3)}for(ta="S";ta.length<=9;ta+="S")gt(ta,Bq);iL=Oc("Milliseconds",!1);Ce("z",0,0,"zoneAbbr");Ce("zz",0,0,"zoneName");function jq(){return this._isUTC?"UTC":""}function Uq(){return this._isUTC?"Coordinated Universal Time":""}var Q=sf.prototype;Q.add=k2;Q.calendar=j2;Q.clone=U2;Q.diff=Z2;Q.endOf=aq;Q.format=tq;Q.from=nq;Q.fromNow=rq;Q.to=iq;Q.toNow=oq;Q.get=eG;Q.invalidAt=pq;Q.isAfter=z2;Q.isBefore=Y2;Q.isBetween=G2;Q.isSame=q2;Q.isSameOrAfter=K2;Q.isSameOrBefore=X2;Q.isValid=gq;Q.lang=Zk;Q.locale=Xk;Q.localeData=Jk;Q.max=g2;Q.min=f2;Q.parsingFlags=mq;Q.set=tG;Q.startOf=sq;Q.subtract=L2;Q.toArray=hq;Q.toObject=dq;Q.toDate=cq;Q.toISOString=Q2;Q.inspect=eq;typeof Symbol<"u"&&Symbol.for!=null&&(Q[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Q.toJSON=fq;Q.toString=J2;Q.unix=uq;Q.valueOf=lq;Q.creationData=wq;Q.eraName=bq;Q.eraNarrow=Sq;Q.eraAbbr=Rq;Q.eraYear=Eq;Q.year=Ik;Q.isLeapYear=QY;Q.weekYear=xq;Q.isoWeekYear=Aq;Q.quarter=Q.quarters=$q;Q.month=Hk;Q.daysInMonth=cG;Q.week=Q.weeks=vG;Q.isoWeek=Q.isoWeeks=CG;Q.weeksInYear=Dq;Q.weeksInWeekYear=kq;Q.isoWeeksInYear=Hq;Q.isoWeeksInISOWeekYear=Nq;Q.date=rL;Q.day=Q.days=AG;Q.weekday=HG;Q.isoWeekday=NG;Q.dayOfYear=Fq;Q.hour=Q.hours=WG;Q.minute=Q.minutes=Vq;Q.second=Q.seconds=Wq;Q.millisecond=Q.milliseconds=iL;Q.utcOffset=R2;Q.utc=T2;Q.local=_2;Q.parseZone=M2;Q.hasAlignedHourOffset=I2;Q.isDST=P2;Q.isLocal=x2;Q.isUtcOffset=A2;Q.isUtc=Yk;Q.isUTC=Yk;Q.zoneAbbr=jq;Q.zoneName=Uq;Q.dates=di("dates accessor is deprecated. Use date instead.",rL);Q.months=di("months accessor is deprecated. Use month instead",Hk);Q.years=di("years accessor is deprecated. Use year instead",Ik);Q.zone=di("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",E2);Q.isDSTShifted=di("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",O2);function zq(t){return Et(t*1e3)}function Yq(){return Et.apply(null,arguments).parseZone()}function oL(t){return t}var tt=GE.prototype;tt.calendar=xY;tt.longDateFormat=DY;tt.invalidDate=LY;tt.ordinal=VY;tt.preparse=oL;tt.postformat=oL;tt.relativeTime=BY;tt.pastFuture=jY;tt.set=PY;tt.eras=vq;tt.erasParse=Cq;tt.erasConvertYear=yq;tt.erasAbbrRegex=_q;tt.erasNameRegex=Tq;tt.erasNarrowRegex=Mq;tt.months=sG;tt.monthsShort=aG;tt.monthsParse=uG;tt.monthsRegex=dG;tt.monthsShortRegex=hG;tt.week=gG;tt.firstDayOfYear=wG;tt.firstDayOfWeek=pG;tt.weekdays=MG;tt.weekdaysMin=PG;tt.weekdaysShort=IG;tt.weekdaysParse=xG;tt.weekdaysRegex=DG;tt.weekdaysShortRegex=kG;tt.weekdaysMinRegex=LG;tt.isPM=FG;tt.meridiem=BG;function qm(t,e,n,r){var i=bs(),o=xo().set(r,e);return i[n](o,t)}function sL(t,e,n){if(ps(t)&&(e=t,t=void 0),t=t||"",e!=null)return qm(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=qm(t,r,n,"month");return i}function h0(t,e,n,r){typeof t=="boolean"?(ps(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,ps(e)&&(n=e,e=void 0),e=e||"");var i=bs(),o=t?i._week.dow:0,s,a=[];if(n!=null)return qm(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=qm(e,(s+o)%7,r,"day");return a}function Gq(t,e){return sL(t,e,"months")}function qq(t,e){return sL(t,e,"monthsShort")}function Kq(t,e,n){return h0(t,e,n,"weekdays")}function Xq(t,e,n){return h0(t,e,n,"weekdaysShort")}function Zq(t,e,n){return h0(t,e,n,"weekdaysMin")}la("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Ue(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});J.lang=di("moment.lang is deprecated. Use moment.locale instead.",la);J.langData=di("moment.langData is deprecated. Use moment.localeData instead.",bs);var Lo=Math.abs;function Jq(){var t=this._data;return this._milliseconds=Lo(this._milliseconds),this._days=Lo(this._days),this._months=Lo(this._months),t.milliseconds=Lo(t.milliseconds),t.seconds=Lo(t.seconds),t.minutes=Lo(t.minutes),t.hours=Lo(t.hours),t.months=Lo(t.months),t.years=Lo(t.years),this}function aL(t,e,n,r){var i=Ui(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function Qq(t,e){return aL(this,t,e,1)}function eK(t,e){return aL(this,t,e,-1)}function _x(t){return t<0?Math.floor(t):Math.ceil(t)}function tK(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=_x(RR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=ri(t/1e3),r.seconds=i%60,o=ri(i/60),r.minutes=o%60,s=ri(o/60),r.hours=s%24,e+=ri(s/24),l=ri(lL(e)),n+=l,e-=_x(RR(l)),a=ri(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function lL(t){return t*4800/146097}function RR(t){return t*146097/4800}function nK(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=fi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+lL(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(RR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Ss(t){return function(){return this.as(t)}}var uL=Ss("ms"),rK=Ss("s"),iK=Ss("m"),oK=Ss("h"),sK=Ss("d"),aK=Ss("w"),lK=Ss("M"),uK=Ss("Q"),cK=Ss("y"),hK=uL;function dK(){return Ui(this)}function fK(t){return t=fi(t),this.isValid()?this[t+"s"]():NaN}function Ul(t){return function(){return this.isValid()?this._data[t]:NaN}}var gK=Ul("milliseconds"),mK=Ul("seconds"),pK=Ul("minutes"),wK=Ul("hours"),vK=Ul("days"),CK=Ul("months"),yK=Ul("years");function bK(){return ri(this.days()/7)}var ts=Math.round,Gu={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function SK(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function RK(t,e,n,r){var i=Ui(t).abs(),o=ts(i.as("s")),s=ts(i.as("m")),a=ts(i.as("h")),l=ts(i.as("d")),u=ts(i.as("M")),c=ts(i.as("w")),h=ts(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,SK.apply(null,d)}function EK(t){return t===void 0?ts:typeof t=="function"?(ts=t,!0):!1}function TK(t,e){return Gu[t]===void 0?!1:e===void 0?Gu[t]:(Gu[t]=e,t==="s"&&(Gu.ss=e-1),!0)}function _K(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Gu,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Gu,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=RK(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var $y=Math.abs;function Xl(t){return(t>0)-(t<0)||+t}function uw(){if(!this.isValid())return this.localeData().invalidDate();var t=$y(this._milliseconds)/1e3,e=$y(this._days),n=$y(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=ri(t/60),i=ri(r/60),t%=60,r%=60,o=ri(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Xl(this._months)!==Xl(a)?"-":"",c=Xl(this._days)!==Xl(a)?"-":"",h=Xl(this._milliseconds)!==Xl(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ke=aw.prototype;Ke.isValid=C2;Ke.abs=Jq;Ke.add=Qq;Ke.subtract=eK;Ke.as=nK;Ke.asMilliseconds=uL;Ke.asSeconds=rK;Ke.asMinutes=iK;Ke.asHours=oK;Ke.asDays=sK;Ke.asWeeks=aK;Ke.asMonths=lK;Ke.asQuarters=uK;Ke.asYears=cK;Ke.valueOf=hK;Ke._bubble=tK;Ke.clone=dK;Ke.get=fK;Ke.milliseconds=gK;Ke.seconds=mK;Ke.minutes=pK;Ke.hours=wK;Ke.days=vK;Ke.weeks=bK;Ke.months=CK;Ke.years=yK;Ke.humanize=_K;Ke.toISOString=uw;Ke.toString=uw;Ke.toJSON=uw;Ke.locale=Xk;Ke.localeData=Jk;Ke.toIsoString=di("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",uw);Ke.lang=Zk;Ce("X",0,0,"unix");Ce("x",0,0,"valueOf");ce("x",rw);ce("X",GY);gt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});gt("x",function(t,e,n){n._d=new Date(Ue(t))});//! moment.js
J.version="2.30.1";MY(Et);J.fn=Q;J.min=m2;J.max=p2;J.now=w2;J.utc=xo;J.unix=zq;J.months=Gq;J.isDate=of;J.locale=la;J.invalid=Qp;J.duration=Ui;J.isMoment=Fi;J.weekdays=Kq;J.parseZone=Yq;J.localeData=bs;J.isDuration=vm;J.monthsShort=qq;J.weekdaysMin=Zq;J.defineLocale=r0;J.updateLocale=YG;J.locales=GG;J.weekdaysShort=Xq;J.normalizeUnits=fi;J.relativeTimeRounding=EK;J.relativeTimeThreshold=TK;J.calendarFormat=B2;J.prototype=Q;J.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function MK(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function Mx(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function ym(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Er(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Ml(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function je(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function H(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function IK(t){const e=[];return H(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function Ix(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return H(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function Px(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function it(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Er(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Ot(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ue(t){return typeof t<"u"}function Pt(t){return typeof t>"u"}function jt(t){return t===null||t===""||Pt(t)}function PK(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const qh="length",nd=t=>parseInt(t,16),Ox=t=>parseInt(t,10),Km=(t,e,n)=>t.substr(e,n),rd=t=>t.codePointAt(0)-65,ER=t=>`${t}`.replace(/\-/g,""),OK=t=>nd(Km(ER(t),nd("12"),rd("F")))/(nd(Km(ER(t),rd("B"),~~![][qh]))||9),xK=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let xx=!1;const Ax={invalid:()=>it`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return it`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>it`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Hx={invalid:()=>it`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return it`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>it`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function AK(t,e){const n=!jt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.0.1";let o,s="invalid",a="invalid";t=ER(t||"");const l=HK(t);if(n||r||l)if(l){const u=J("10/07/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=OK(t);o=J((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(xK()&&(s="valid",a="valid"),!xx&&s!=="valid"&&(Ax[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](Ax[s]({keyValidityDate:o,hotVersion:i})),xx=!0),a!=="valid"&&e&&Hx[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=Hx[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function HK(t){let e=[][qh],n=e;if(t[qh]!==rd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=rd(i.shift());o;o=rd(i.shift()||"A"))--o<""[qh]?n=n|(Ox(`${Ox(nd(r)+(nd(Km(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Km(t,o,o?i[qh]===1?9:8:6);return n===e}function Vi(t){return t[0].toUpperCase()+t.substr(1)}function cL(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function hL(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function dL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function Nx(t){return d0(`${t}`,{ALLOWED_TAGS:[]})}function d0(t,e){return _Y.sanitize(t,e)}const wa=t=>["tabindex",t],NK=()=>["role","treegrid"],ls=()=>["role","presentation"],DK=()=>["role","gridcell"],kK=()=>["role","gridcell button"],LK=()=>["role","rowheader"],fL=()=>["role","rowgroup"],$K=()=>["role","columnheader"],gL=()=>["role","row"],FK=()=>["role","menu"],VK=()=>["role","menuitem"],WK=()=>["role","menuitemcheckbox"],BK=()=>["role","combobox"],mL=()=>["role","listbox"],jK=()=>["role","option"],UK=()=>["role","checkbox"],zK=()=>["scope","col"],YK=()=>["scope","row"],GK=()=>["type","text"],dc=t=>["aria-label",t],zl=()=>["aria-hidden","true"],qK=()=>["aria-disabled","true"],KK=()=>["aria-multiselectable","true"],pL=t=>["aria-haspopup",t],wL=t=>["aria-rowcount",t],cw=t=>["aria-colcount",t],vL=t=>["aria-rowindex",t],f0=t=>["aria-colindex",t],ai=t=>["aria-expanded",t],XK=t=>["aria-sort",t],Dx=()=>["aria-readonly","true"],kx=()=>["aria-invalid","true"],CL=t=>["aria-checked",t],g0=()=>["aria-selected","true"],ZK=()=>["aria-autocomplete","list"],JK=t=>["aria-controls",t],QK=t=>["aria-activedescendant",t],e3=t=>["aria-live",t],t3=t=>["aria-relevant",t],n3=t=>["aria-setsize",t],r3=t=>["aria-posinset",t];var Lx={},Fy,$x;function i3(){if($x)return Fy;$x=1;var t=Jt(),e=ek(),n=un(),r=Fl(),i=Jp(),o=t([].push);return Fy=function(s){if(n(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(f,g){if(d)return d=!1,g;if(e(this))return g;for(var w=0;w<h;w++)if(l[w]===f)return g}}},Fy}var Fx;function o3(){if(Fx)return Lx;Fx=1;var t=pt(),e=Rc(),n=tf(),r=ln(),i=Jt(),o=an(),s=un(),a=OE(),l=jE(),u=i3(),c=PE(),h=String,d=e("JSON","stringify"),f=i(/./.exec),g=i("".charAt),w=i("".charCodeAt),C=i("".replace),S=i(1.1.toString),v=/[\uD800-\uDFFF]/g,E=/^[\uD800-\uDBFF]$/,P=/^[\uDC00-\uDFFF]$/,x=!c||o(function(){var z=e("Symbol")("stringify detection");return d([z])!=="[null]"||d({a:z})!=="{}"||d(Object(z))!=="{}"}),_=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),M=function(z,O){var G=l(arguments),Z=u(O);if(!(!s(Z)&&(z===void 0||a(z))))return G[1]=function(ae,te){if(s(Z)&&(te=r(Z,this,h(ae),te)),!a(te))return te},n(d,null,G)},V=function(z,O,G){var Z=g(G,O-1),ae=g(G,O+1);return f(E,z)&&!f(P,ae)||f(P,z)&&!f(E,Z)?"\\u"+S(w(z,0),16):z};return d&&t({target:"JSON",stat:!0,arity:3,forced:x||_},{stringify:function(O,G,Z){var ae=l(arguments),te=n(x?M:d,null,ae);return _&&typeof te=="string"?C(te,v,V):te}}),Lx}o3();function xd(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},De(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=xd(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[xd(n[0])]:e[r]=[]:e[r]=null)})),e}function s3(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function sn(t,e,n){const r=Array.isArray(n);return De(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function hw(t,e){De(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),hw(t[r],e[r])):t[r]=e[r]})}function er(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Io(t){const e={};return De(t,(n,r)=>{e[r]=n}),e}function ft(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return H(n,i=>{t.MIXINS.push(i.MIXIN_NAME),De(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let w=g;return(Array.isArray(w)||Ne(w))&&(w=er(w)),w};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function m0(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ne(t){return Object.prototype.toString.call(t)==="[object Object]"}function Rs(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function De(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function a3(t,e){const n=e.split(".");let r=t;return De(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Vy(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(rn(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function p0(t){if(!Ne(t))return 0;const e=function(n){let r=0;return Ne(n)?De(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Fr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function rn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Xm(t){return window.requestAnimationFrame(t)}function Zm(t){window.cancelAnimationFrame(t)}function yL(){return"ontouchstart"in window}function l3(){return typeof window<"u"}let Zl;function u3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Zl||(typeof Intl=="object"?Zl=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Zl=(n,r)=>`${n}`.localeCompare(r):Zl=(n,r)=>n===r?0:n>r?-1:1,Zl)}const Zr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},va={chrome:Zr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Zr(t=>/CriOS/.test(t)),edge:Zr(t=>/Edge/.test(t)),edgeWebKit:Zr(t=>/EdgiOS/.test(t)),firefox:Zr(t=>/Firefox/.test(t)),firefoxWebKit:Zr(t=>/FxiOS/.test(t)),mobile:Zr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Zr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},uf={mac:Zr(t=>/^Mac/.test(t)),win:Zr(t=>/^Win/.test(t)),linux:Zr(t=>/^Linux/.test(t)),ios:Zr(t=>/iPhone|iPad|iPod/i.test(t))};function c3(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};De(va,n=>{let{test:r}=n;return void r(t,e)})}function h3(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};De(uf,e=>{let{test:n}=e;return void n(t)})}l3()&&(c3(),h3());function bL(){return va.chrome.value}function d3(){return va.chromeWebKit.value}function Wy(){return va.firefox.value}function f3(){return va.firefoxWebKit.value}function Ad(){return va.safari.value}function g3(){return va.edge.value}function Eo(){return va.mobile.value}function SL(){return uf.ios.value}function RL(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&uf.mac.value}function TR(){return uf.win.value}function Vx(){return uf.mac.value}function m3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function bm(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function p3(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function fc(t){return p3(t)&&t.parent}function Il(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function kf(t,e,n){const r=[];let i=t;for(;i&&(i=Il(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function w3(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function Rl(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function v3(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Ra(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function EL(t){return!t||!t.length?[]:t.filter(e=>!!e)}function TL(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function be(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function X(t,e){typeof e=="string"&&(e=e.split(" ")),e=EL(e),e.length>0&&t.classList.add(...e)}function ve(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=TL(e,!0);n=EL(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function ye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function xc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=TL(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function _L(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)_L(e[n])}}function ws(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const C3=/(<(.*)>|&(.*);)/;function Ac(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;C3.test(e)?t.innerHTML=n?d0(e):e:Pl(t,e)}function Pl(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(ws(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function gc(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return gc(r.host.impl);if(r.host)return gc(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function y3(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function kn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function ML(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function w0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function v0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?ML(e):t.scrollTop}function IL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?w0(e):t.scrollLeft}function Jm(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function b3(t){return t.scrollHeight-t.clientHeight}function S3(t){return t.scrollWidth-t.clientWidth}function Hd(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Qm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function qt(t){return t.offsetWidth}function on(t){return t.offsetHeight}function id(t){return t.clientHeight||t.innerHeight}function PL(t){return t.clientWidth||t.innerWidth}function OL(t){return t.selectionStart?t.selectionStart:0}function R3(t){return t.selectionEnd?t.selectionEnd:0}function Wx(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function dw(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let By;function xL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return TR()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function E3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");Ad()&&!Eo()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i+xL(t)}function Sn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return By===void 0&&(By=E3(t)),By}function AL(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function HL(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function C0(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function fw(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Sm(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function NL(t){return Sm(t)&&t.hasAttribute("data-hot-input")===!1}function DL(t){return!t.parentNode}function T3(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function kL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();ye(t,"contenteditable",!0),n&&ye(t,...zl()),e&&X(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function LL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&ve(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function _3(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;kL(t,n),e(),LL(t,n)}function ms(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}function at(t){return typeof t=="function"}function gw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function $L(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function M3(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function _R(t,e,n,r,i,o,s,a){return ue(a)?t.call(e,n,r,i,o,s,a):ue(s)?t.call(e,n,r,i,o,s):ue(o)?t.call(e,n,r,i,o):ue(i)?t.call(e,n,r,i):ue(r)?t.call(e,n,r):ue(n)?t.call(e,n):t.call(e)}const me={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Wy()?182:174,AUDIO_MUTE:Wy()?181:173,AUDIO_UP:Wy()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},I3=[me.ALT,me.ARROW_DOWN,me.ARROW_LEFT,me.ARROW_RIGHT,me.ARROW_UP,me.AUDIO_DOWN,me.AUDIO_MUTE,me.AUDIO_UP,me.BACKSPACE,me.CAPS_LOCK,me.DELETE,me.END,me.ENTER,me.ESCAPE,me.F1,me.F2,me.F3,me.F4,me.F5,me.F6,me.F7,me.F8,me.F9,me.F10,me.F11,me.F12,me.F13,me.F14,me.F15,me.F16,me.F17,me.F18,me.F19,me.HOME,me.INSERT,me.MEDIA_NEXT,me.MEDIA_PLAY_PAUSE,me.MEDIA_PREV,me.MEDIA_STOP,me.NULL,me.NUM_LOCK,me.PAGE_DOWN,me.PAGE_UP,me.PAUSE,me.SCROLL_LOCK,me.SHIFT,me.TAB];function P3(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function FL(t){return I3.includes(t)}function O3(t){return[me.CONTROL,me.COMMAND_LEFT,me.COMMAND_RIGHT,me.COMMAND_FIREFOX].includes(t)}function cf(t,e){const n=e.split("|");let r=!1;return H(n,i=>{if(t===me[i])return r=!0,!1}),r}function zi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ul(t){return t.isImmediatePropagationEnabled===!1}function Ol(t){return t.button===2}function y0(t){return t.button===0}function x3(t){return t instanceof TouchEvent}function A3(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!ms(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}function Ze(){ue(console)&&console.warn(...arguments)}function b0(){ue(console)&&console.error(...arguments)}const cl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],jy=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Uy=new Map([[]]);var Bx={},zy,jx;function H3(){if(jx)return zy;jx=1;var t=_c();return zy=function(e,n,r){for(var i=0,o=arguments.length>2?r:t(n),s=new e(o);o>i;)s[i]=n[i++];return s},zy}var Yy,Ux;function N3(){if(Ux)return Yy;Ux=1;var t=Zt();return Yy=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},Yy}var Gy,zx;function mw(){if(zx)return Gy;zx=1;var t=ji(),e=VE(),n=ma().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),Gy=function(o){i[r][o]=!0},Gy}var Yx;function D3(){if(Yx)return Bx;Yx=1;var t=pt(),e=Jt(),n=Sr(),r=Zd(),i=H3(),o=N3(),s=mw(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),s("toSorted"),Bx}D3();var Gx={},qx={},Kx;function k3(){if(Kx)return qx;Kx=1;var t=pt(),e=ln(),n=Mc(),r=Sr(),i=cn(),o=Oo(),s=Rr(),a=pa(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,g){if(c(f,d++))return g(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),qx}var Xx;function L3(){return Xx||(Xx=1,k3()),Gx}L3();function $3(t,e){VL(t,e),e.add(t)}function qy(t,e,n){VL(t,e),e.set(t,n)}function VL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zx(t,e,n){return t.set(ep(t,e),n),n}function En(t,e){return t.get(ep(t,e))}function ep(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const F3=100;var Ir=new WeakMap,$u=new WeakMap,Ky=new WeakMap,Xy=new WeakSet;class Jx{constructor(){$3(this,Xy),qy(this,Ir,new Map),qy(this,$u,new Map),qy(this,Ky,new Set),cl.forEach(e=>ep(Xy,this,Qx).call(this,e))}getHooks(e){var n;return(n=En(Ir,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};En(Ir,this).has(e)||(ep(Xy,this,Qx).call(this,e),cl.push(e));const i=En(Ir,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=En(Ky,this).has(e);!u&&o!==0&&(u=!0,En(Ky,this).add(e)),u&&i.length>1&&En(Ir,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return En(Ir,this).has(e)&&En(Ir,this).get(e).length>0}remove(e,n){if(!En(Ir,this).has(e))return!1;const r=En(Ir,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=En($u,this).get(e);return i.skip=!0,o+=1,o>F3&&(En(Ir,this).set(e,r.filter(s=>!s.skip)),o=0),En($u,this).set(e,o),!0}return!1}destroy(){En(Ir,this).clear(),En($u,this).clear(),Zx(Ir,this,null),Zx($u,this,null)}}function Qx(t){En(Ir,this).set(t,[]),En($u,this).set(t,0)}function V3(t,e,n){return(e=W3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W3(t){var e=B3(t,"string");return typeof e=="symbol"?e:e+""}function B3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const j3=it`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ie{constructor(){V3(this,"globalBucket",new Jx)}static getSingleton(){return z3()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new Jx),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?H(n,o=>this.add(e,o,r)):(jy.has(e)&&Ze(dL(j3,{hookName:e,removedInVersion:jy.get(e)})),Uy.has(e)&&Ze(Uy.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?H(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?H(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=_R(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=_R(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||cl.push(e)}deregister(e){this.isRegistered(e)&&cl.splice(cl.indexOf(e),1)}isDeprecated(e){return Uy.has(e)||jy.has(e)}isRegistered(e){return cl.indexOf(e)>=0}getRegistered(){return cl}}const U3=new ie;function z3(){return U3}const fl=new Map;function gi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";fl.has(t)||fl.set(t,new Map);const e=fl.get(t);function n(l,u){e.set(l,u)}function r(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){fl.delete(t),e.clear()}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s,clear:a}}function Y3(t,e){var n;return fl==null||(n=fl.get(t.guid))===null||n===void 0?void 0:n.get(e)}const MR=new WeakMap,{register:G3,getItem:WL,hasItem:BL,getNames:Qme,getValues:epe}=gi("editors");function q3(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ie.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function jL(t,e){let n;if(typeof t=="function")MR.get(t)||Or(null,t),n=MR.get(t);else if(typeof t=="string")n=WL(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function eA(t){if(typeof t=="function")return t;if(!BL(t))throw Error(`No registered editor found under "${t}" name`);return WL(t).getConstructor()}function Or(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new q3(e);typeof t=="string"&&G3(t,n),MR.set(e,n)}function K3(t,e,n){return(e=X3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X3(t){var e=Z3(t,"string");return typeof e=="symbol"?e:e+""}function Z3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;K3(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,J3(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function J3(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),zi(this)},t}function Q3(t,e){eX(t,e),e.add(t)}function eX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ea(t,e,n){return(e=tX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tX(t){var e=nX(t,"string");return typeof e=="symbol"?e:e+""}function nX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lf=new WeakSet;class IR{constructor(e,n,r){Q3(this,Lf),Ea(this,"hot",void 0),Ea(this,"tableMeta",void 0),Ea(this,"selection",void 0),Ea(this,"eventManager",void 0),Ea(this,"destroyed",!1),Ea(this,"activeEditor",void 0),Ea(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Wi(e),this.hot.addHook("afterDocumentKeyDown",i=>Zy(Lf,this,tA).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>Zy(Lf,this,tA).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>Zy(Lf,this,rX).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=jL(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function tA(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ul(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!FL(n)&&!O3(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function rX(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const nA=new WeakMap;IR.getInstance=function(t,e,n){let r=nA.get(t);return r||(r=new IR(t,e,n),nA.set(t,r)),r};function iX(t,e){UL(t,e),e.add(t)}function Jc(t,e,n){UL(t,e),e.set(t,n)}function UL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){return t.get(os(t,e))}function Qc(t,e,n){return t.set(os(t,e),n),n}function os(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nc=Object.freeze({CELL:"cell",MIXED:"mixed"});var nn=new WeakMap,$f=new WeakMap,Ff=new WeakMap,Vf=new WeakMap,Wf=new WeakMap,Ys=new WeakSet;class oX{constructor(e){var n=this;iX(this,Ys),Jc(this,nn,void 0),Jc(this,$f,void 0),Jc(this,Ff,1),Jc(this,Vf,null),Jc(this,Wf,new Map);const r=e.getSettings();Qc(nn,this,e),Qc($f,this,r.imeFastEdit?nc.MIXED:nc.CELL),vt(nn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return os(Ys,n,aX).call(n,...o)}),vt(nn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return os(Ys,n,rA).call(n,...o)}),vt(nn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return os(Ys,n,rA).call(n,...o)}),vt(nn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return os(Ys,n,sX).call(n,...o)})}getFocusMode(){return vt($f,this)}setFocusMode(e){Object.values(nc).includes(e)?Qc($f,this,e):Ze(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return vt(Ff,this)}setRefocusDelay(e){Qc(Ff,this,e)}setRefocusElementGetter(e){Qc(Vf,this,e)}getRefocusElement(){var e;return typeof vt(Vf,this)=="function"?vt(Vf,this).call(this):(e=vt(nn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=vt(nn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=vt(nn,this).runHooks("modifyFocusedElement",s.row,s.col,r);ms(a)||(a=r),a&&!((o=vt(nn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):os(Ys,this,S0).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vt(Ff,this);if(vt(nn,this).getSettings().imeFastEdit&&!((e=vt(nn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=vt(nn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),vt(Wf,this).has(n)||vt(Wf,this).set(n,gw(()=>{if(!vt(nn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),vt(Wf,this).get(n)()}}}function S0(t){var e;const n=(e=vt(nn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!vt(nn,this).selection.isCellVisible(n)){t(null);return}const r=vt(nn,this).getCell(n.row,n.col,!0);r===null?vt(nn,this).addHookOnce("afterScroll",()=>{t(vt(nn,this).getCell(n.row,n.col,!0))}):t(r)}function rA(){os(Ys,this,S0).call(this,t=>{const{activeElement:e}=vt(nn,this).rootDocument;e&&NL(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function sX(){os(Ys,this,S0).call(this,t=>{this.getFocusMode()===nc.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function aX(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?nc.MIXED:nc.CELL)}var iA={},Jy,oA;function lX(){if(oA)return Jy;oA=1;var t=ci(),e=Fl(),n=ji(),r=n("match");return Jy=function(i){var o;return t(i)&&((o=i[r])!==void 0?!!o:e(i)==="RegExp")},Jy}var Qy,sA;function uX(){if(sA)return Qy;sA=1;var t=Zt(),e=an(),n=t.RegExp,r=!e(function(){var i=!0;try{n(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(o,d,{get:function(){return s+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(o);return h!==a||s!==a});return Qy={correct:r},Qy}var eb,aA;function cX(){if(aA)return eb;aA=1;var t=cn();return eb=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},eb}var tb,lA;function hX(){if(lA)return tb;lA=1;var t=ln(),e=hi(),n=Jd(),r=uX(),i=cX(),o=RegExp.prototype;return tb=r.correct?function(s){return s.flags}:function(s){return!r.correct&&n(o,s)&&!e(s,"flags")?t(i,s):s.flags},tb}var nb,uA;function dX(){if(uA)return nb;uA=1;var t=Jt(),e=Ec(),n=Math.floor,r=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return nb=function(l,u,c,h,d,f){var g=c+l.length,w=h.length,C=a;return d!==void 0&&(d=e(d),C=s),i(f,C,function(S,v){var E;switch(r(v,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,g);case"<":E=d[o(v,1,-1)];break;default:var P=+v;if(P===0)return S;if(P>w){var x=n(P/10);return x===0?S:x<=w?h[x-1]===void 0?r(v,1):h[x-1]+r(v,1):S}E=h[P-1]}return E===void 0?"":E})},nb}var cA;function fX(){if(cA)return iA;cA=1;var t=pt(),e=ln(),n=Jt(),r=Xd(),i=un(),o=ci(),s=lX(),a=Jp(),l=Qd(),u=hX(),c=dX(),h=ji(),d=ga(),f=h("replace"),g=TypeError,w=n("".indexOf),C=n("".replace),S=n("".slice),v=Math.max;return t({target:"String",proto:!0},{replaceAll:function(P,x){var _=r(this),M,V,z,O,G,Z,ae,te,ne,Fe,ke=0,Ve="";if(o(P)){if(M=s(P),M&&(V=a(r(u(P))),!~w(V,"g")))throw new g("`.replaceAll` does not allow non-global regexes");if(z=l(P,f),z)return e(z,P,_,x);if(d&&M)return C(a(_),P,x)}for(O=a(_),G=a(P),Z=i(x),Z||(x=a(x)),ae=G.length,te=v(1,ae),ne=w(O,G);ne!==-1;)Fe=Z?a(x(G,ne,O)):c(G,O,ne,[],void 0,x),Ve+=S(O,ke,ne)+Fe,ke=ne+ae,ne=ne+te>O.length?-1:w(O,G,ne+te);return ke<O.length&&(Ve+=S(O,ke)),Ve}}),iA}fX();var hA={},dA={},fA;function gX(){if(fA)return dA;fA=1;var t=pt(),e=Mc(),n=Sr(),r=cn(),i=Oo(),o=Rr(),s=pa(),a=tf(),l=an(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){r(this);try{n(f)}catch(v){o(this,"throw",v)}var g=arguments.length<2,w=g?void 0:arguments[1];if(h)return a(h,this,g?[f]:[f,w]);var C=i(this),S=0;if(e(C,function(v){g?(g=!1,w=v):w=f(w,v,S),S++},{IS_RECORD:!0}),g)throw new u("Reduce of empty iterator with no initial value");return w}}),dA}var gA;function mX(){return gA||(gA=1,gX()),hA}mX();const zL={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},pX=new RegExp(Object.keys(zL).map(t=>`(${t})`).join("|"),"gi");function wX(t){return(t&&t.nodeName||"")==="TABLE"}function mA(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let C=0;C<s;C+=1){const S=!f&&n&&C===0;let v="";if(f)v=`<th>${t.getColHeader(C-c)}</th>`;else if(S)v=`<th>${t.getRowHeader(d-h)}</th>`;else{const E=i[d][C],{hidden:P,rowspan:x,colspan:_}=t.getCellMeta(d-h,C-c);if(!P){const M=[];if(x&&M.push(`rowspan="${x}"`),_&&M.push(`colspan="${_}"`),jt(E))v=`<td ${M.join(" ")}></td>`;else{const V=E.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${M.join(" ")}>${V}</td>`}}}g.push(v)}const w=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,w):u.splice(-1,0,w)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function pA(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=jt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function vX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const E=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,P=>{const x=P.match(/<td\b[^>]*?>/g)[0],_=/<p.*?>/g,M=P.substring(x.length,P.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(_,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${x}${M}</td>`});i.insertAdjacentHTML("afterbegin",`${E}`),o=i.querySelector("table")}if(!o||!wX(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((E,P)=>E+P.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const E=Array.from(o.tHead.rows).filter(P=>{const x=P.querySelector("td")!==null;return x&&h.push(P),!x});f=E.length,d=f>0,f>1?n.nestedHeaders=Array.from(E).reduce((P,x)=>{const _=Array.from(x.cells).reduce((M,V,z)=>{if(a&&z===0)return M;const{colSpan:O,innerHTML:G}=V,Z=O>1?{label:G,colspan:O}:G;return M.push(Z),M},[]);return P.push(_),P},[]):d&&(n.colHeaders=Array.from(E[0].children).reduce((P,x,_)=>(a&&_===0||P.push(x.innerHTML),P),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const w=[...h,...Array.from(o.tBodies).reduce((E,P)=>(E.push(...Array.from(P.rows)),E),[]),...c];g=w.length;const C=new Array(g);for(let E=0;E<g;E++)C[E]=new Array(u);const S=[],v=[];for(let E=0;E<g;E++){const P=w[E],x=Array.from(P.cells),_=x.length;for(let M=0;M<_;M++){const V=x[M],{nodeName:z,innerHTML:O,rowSpan:G,colSpan:Z}=V,ae=C[E].findIndex(te=>te===void 0);if(z==="TD"){if(G>1||Z>1){for(let ke=E;ke<E+G;ke++)if(ke<g)for(let Ve=ae;Ve<ae+Z;Ve++)C[ke][Ve]=null;const ne=V.getAttribute("style");ne&&ne.includes("mso-ignore:colspan")||S.push({col:ae,row:E,rowspan:G,colspan:Z})}let te="";s&&/excel/gi.test(s.content)?te=O.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):te=O.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[E][ae]=te.replace(pX,ne=>zL[ne])}else v.push(O)}}return S.length&&(n.mergeCells=S),v.length&&(n.rowHeaders=v),C.length&&(n.data=C),n}function Zn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function CX(t){return Zn(t,[","])}function de(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function wA(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function YL(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ze(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const PR="asc",yX="desc",vA=new Map([[PR,[-1,1]],[yX,[1,-1]]]),bX=t=>`The priority '${t}' is already declared in a map.`,SX=t=>`The priority '${t}' is not a number.`;function RX(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=at(t)?t:bX,e=at(e)?e:SX;function r(o,s){if(!Zn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:PR;const[s,a]=vA.get(o)||vA.get(PR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const EX=t=>`The id '${t}' is already declared in a map.`;function pw(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=at(t)?t:EX;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const TX=t=>`'${t}' value is already declared in a unique set.`;function _X(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=at(t)?t:TX;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const R0=t=>`There is already registered "${t}" plugin.`,MX=t=>`There is already registered plugin on priority "${t}".`,IX=t=>`The priority "${t}" is not a number.`,GL=RX({errorPriorityExists:MX,errorPriorityNaN:IX}),qL=_X({errorItemExists:R0}),OR=pw({errorIdExists:R0});function KL(){return[...GL.getItems(),...qL.getItems()]}function E0(t){const e=Vi(t);return OR.getItem(e)}function PX(t){return!!E0(t)}function Ye(t,e,n){[t,e,n]=xX(t,e,n),E0(t)===void 0&&OX(t,e,n)}function OX(t,e,n){const r=Vi(t);if(OR.hasItem(r))throw new Error(R0(r));n===void 0?qL.addItem(r):GL.addItem(n,r),OR.addItem(r,e)}function xX(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:AX,getItem:HX,hasItem:XL,getNames:tpe,getValues:npe}=gi("renderers");function CA(t){if(typeof t=="function")return t;if(!XL(t))throw Error(`No registered renderer found under "${t}" name`);return HX(t)}function Kr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),AX(t,e)}const{register:NX,getItem:DX,hasItem:ZL,getNames:rpe,getValues:ipe}=gi("validators");function kX(t){if(typeof t=="function")return t;if(!ZL(t))throw Error(`No registered validator found under "${t}" name`);return DX(t)}function Fu(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),NX(t,e)}var yA={},bA;function LX(){if(bA)return yA;bA=1;var t=pt(),e=Ec(),n=_c(),r=ef(),i=mw();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=n(a),u=r(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),yA}LX();var SA={},RA;function $X(){if(RA)return SA;RA=1;var t=pt(),e=Jt(),n=Xd(),r=ef(),i=Jp(),o=an(),s=e("".charAt),a=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:s(c,f)}}),SA}$X();function eh(t,e,n){return(e=FX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FX(t){var e=VX(t,"string");return typeof e=="symbol"?e:e+""}function VX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WX{constructor(){eh(this,"count",0),eh(this,"startColumn",null),eh(this,"endColumn",null),eh(this,"startPosition",null),eh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function th(t,e,n){return(e=BX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BX(t){var e=jX(t,"string");return typeof e=="symbol"?e:e+""}function jX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UX{constructor(){th(this,"count",0),th(this,"startRow",null),th(this,"endRow",null),th(this,"startPosition",null),th(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function nh(t,e,n){return(e=zX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zX(t){var e=YX(t,"string");return typeof e=="symbol"?e:e+""}function YX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JL{constructor(){nh(this,"count",0),nh(this,"startColumn",null),nh(this,"endColumn",null),nh(this,"startPosition",null),nh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function rh(t,e,n){return(e=GX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GX(t){var e=qX(t,"string");return typeof e=="symbol"?e:e+""}function qX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QL{constructor(){rh(this,"count",0),rh(this,"startRow",null),rh(this,"endRow",null),rh(this,"startPosition",null),rh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ih(t,e,n){return(e=KX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KX(t){var e=XX(t,"string");return typeof e=="symbol"?e:e+""}function XX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZX{constructor(){ih(this,"count",0),ih(this,"startColumn",0),ih(this,"endColumn",0),ih(this,"startPosition",0),ih(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function oh(t,e,n){return(e=JX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JX(t){var e=QX(t,"string");return typeof e=="symbol"?e:e+""}function QX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e4{constructor(){oh(this,"count",0),oh(this,"startRow",0),oh(this,"endRow",0),oh(this,"startPosition",0),oh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function EA(t,e,n){return(e=t4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t4(t){var e=n4(t,"string");return typeof e=="symbol"?e:e+""}function n4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class r4 extends JL{constructor(){super(...arguments),EA(this,"columnStartOffset",0),EA(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function TA(t,e,n){return(e=i4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i4(t){var e=o4(t,"string");return typeof e=="symbol"?e:e+""}function o4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s4 extends QL{constructor(){super(...arguments),TA(this,"rowStartOffset",0),TA(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _A(t,e,n){return(e=a4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a4(t){var e=l4(t,"string");return typeof e=="symbol"?e:e+""}function l4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e${constructor(e){_A(this,"calculationTypes",[]),_A(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function wi(t,e,n){return(e=u4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u4(t){var e=c4(t,"string");return typeof e=="symbol"?e:e+""}function c4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mc=50;class h4 extends e${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),wi(this,"viewportWidth",0),wi(this,"scrollOffset",0),wi(this,"zeroBasedScrollOffset",0),wi(this,"totalColumns",0),wi(this,"columnWidthFn",null),wi(this,"columnWidth",0),wi(this,"overrideFn",null),wi(this,"inlineStartOffset",0),wi(this,"totalCalculatedWidth",0),wi(this,"startPositions",[]),wi(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?mc:n}}function jr(t,e,n){return(e=d4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d4(t){var e=f4(t,"string");return typeof e=="symbol"?e:e+""}function f4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g4 extends e${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),jr(this,"viewportHeight",0),jr(this,"scrollOffset",0),jr(this,"zeroBasedScrollOffset",0),jr(this,"totalRows",0),jr(this,"rowHeightFn",null),jr(this,"rowHeight",0),jr(this,"overrideFn",null),jr(this,"horizontalScrollbarHeight",0),jr(this,"innerViewportHeight",0),jr(this,"totalCalculatedHeight",0),jr(this,"startPositions",[]),jr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function m4(t,e,n){p4(t,e),e.set(t,n)}function p4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MA(t,e,n){return(e=w4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w4(t){var e=v4(t,"string");return typeof e=="symbol"?e:e+""}function v4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jl(t,e){return t.get(t$(t,e))}function IA(t,e,n){return t.set(t$(t,e),n),n}function t$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $o=new WeakMap;class xl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;MA(this,"row",null),MA(this,"col",null),m4(this,$o,!1),IA($o,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Jl($o,this)}isSouthEastOf(e){return this.row>=e.row&&(Jl($o,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Jl($o,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Jl($o,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Jl($o,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof xl&&IA($o,this,e.isRtl()),this}clone(){return new xl(this.row,this.col,Jl($o,this))}toObject(){return{row:this.row,col:this.col}}}function C4(t,e,n){y4(t,e),e.set(t,n)}function y4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rb(t,e,n){return(e=b4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b4(t){var e=S4(t,"string");return typeof e=="symbol"?e:e+""}function S4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ur(t,e){return t.get(n$(t,e))}function R4(t,e,n){return t.set(n$(t,e),n),n}function n$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ir=new WeakMap;class hf{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;rb(this,"highlight",null),rb(this,"from",null),rb(this,"to",null),C4(this,ir,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),R4(ir,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Ur(ir,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Ur(ir,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Ur(ir,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Ur(ir,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Ur(ir,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Ur(ir,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Ur(ir,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Ur(ir,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof xl))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(Ur(ir,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(Ur(ir,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new hf(this.highlight,this.from,this.to,Ur(ir,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new xl(e,n,Ur(ir,this))}}function qi(t,e,n){E4(t,e),e.set(t,n)}function E4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fe(t,e){return t.get(r$(t,e))}function _s(t,e,n){return t.set(r$(t,e),n),n}function r$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zr=new WeakMap,ib=new WeakMap,Cn=new WeakMap,Ql=new WeakMap,Bf=new WeakMap,vi=new WeakMap,ob=new WeakMap,sh=new WeakMap,Ta=new WeakMap,Ki=new WeakMap;let i$=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;qi(this,zr,void 0),qi(this,ib,void 0),qi(this,Cn,void 0),qi(this,Ql,void 0),qi(this,Bf,void 0),qi(this,vi,void 0),qi(this,ob,void 0),qi(this,sh,void 0),qi(this,Ta,[null,null]),qi(this,Ki,[null,null]),_s(zr,this,r),_s(ib,this,n),_s(Cn,this,o),_s(Ql,this,s),_s(Bf,this,a),_s(vi,this,i),_s(ob,this,e),this.registerEvents()}registerEvents(){fe(vi,this).addEventListener(fe(Cn,this).holder,"contextmenu",r=>this.onContextMenu(r)),fe(vi,this).addEventListener(fe(Cn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),fe(vi,this).addEventListener(fe(Cn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{fe(vi,this).addEventListener(fe(Cn,this).holder,"touchstart",r=>this.onTouchStart(r)),fe(vi,this).addEventListener(fe(Cn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),fe(vi,this).addEventListener(fe(Cn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||fe(zr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,fe(zr,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{fe(vi,this).addEventListener(fe(Cn,this).holder,"mouseup",r=>this.onMouseUp(r)),fe(vi,this).addEventListener(fe(Cn,this).holder,"mousedown",r=>this.onMouseDown(r))};Eo()?e():(yL()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(fe(sh,this)&&r){const[i,o]=[r.row,fe(sh,this).from.row],[s,a]=[r.col,fe(sh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=fe(Cn,this).TABLE,i=kf(e,["TD","TH"],r);return i?(n.coords=fe(Cn,this).getCoords(i),n.TD=i):be(e,"wtBorder")&&be(e,"current")?(n.coords=fe(Ql,this).getFocusSelection().cellRange.highlight,n.TD=fe(Cn,this).getCell(n.coords)):be(e,"wtBorder")&&be(e,"area")&&fe(Ql,this).getAreaSelection().cellRange&&(n.coords=fe(Ql,this).getAreaSelection().cellRange.to,n.TD=fe(Cn,this).getCell(n.coords)),n}onMouseDown(e){const n=fe(ib,this).rootDocument.activeElement,r=$L(m3,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);be(i,"corner")?fe(zr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&fe(zr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(fe(Ki,this)[0]=o.TD,clearTimeout(fe(Ta,this)[0]),fe(Ta,this)[0]=setTimeout(()=>{fe(Ki,this)[0]=null},1e3))}onContextMenu(e){if(fe(zr,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!fe(zr,this).has("onCellMouseOver"))return;const n=fe(Cn,this).TABLE,r=kf(e.target,["TD","TH"],n),i=fe(Bf,this)||this;r&&r!==i.lastMouseOver&&Rl(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,fe(Cn,this).getCoords(r),r))}onMouseOut(e){if(!fe(zr,this).has("onCellMouseOut"))return;const n=fe(Cn,this).TABLE,r=kf(e.target,["TD","TH"],n),i=kf(e.relatedTarget,["TD","TH"],n),o=fe(Bf,this)||this;r&&r!==i&&Rl(r,n)&&(this.callListener("onCellMouseOut",e,fe(Cn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&fe(zr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===fe(Ki,this)[0]&&n.TD===fe(Ki,this)[1]?(be(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),fe(Ki,this)[0]=null,fe(Ki,this)[1]=null):n.TD===fe(Ki,this)[0]&&(fe(Ki,this)[1]=n.TD,clearTimeout(fe(Ta,this)[1]),fe(Ta,this)[1]=setTimeout(()=>{fe(Ki,this)[1]=null},500)))}onTouchStart(e){_s(sh,this,fe(Ql,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&fe(zr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];SL()&&(d3()||f3())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=fe(zr,this).getSettingPure(e);o&&o(n,r,i,fe(ob,this).call(this))}destroy(){clearTimeout(fe(Ta,this)[0]),clearTimeout(fe(Ta,this)[1]),fe(vi,this).destroy()}};function sb(t,e,n){return(e=T4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T4(t){var e=_4(t,"string");return typeof e=="symbol"?e:e+""}function _4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M4{constructor(e,n,r){sb(this,"offset",void 0),sb(this,"total",void 0),sb(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function ab(t,e,n){return(e=I4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I4(t){var e=P4(t,"string");return typeof e=="symbol"?e:e+""}function P4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O4{constructor(e,n,r){ab(this,"offset",void 0),ab(this,"total",void 0),ab(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function jf(t,e,n){return(e=x4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x4(t){var e=A4(t,"string");return typeof e=="symbol"?e:e+""}function A4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H4{constructor(){jf(this,"currentSize",0),jf(this,"nextSize",0),jf(this,"currentOffset",0),jf(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const N4=0,PA=1,xR=2;function lb(t,e,n){return(e=D4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D4(t){var e=k4(t,"string");return typeof e=="symbol"?e:e+""}function k4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L4{constructor(){lb(this,"size",new H4),lb(this,"workingSpace",N4),lb(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=PA,e.workingSpace=xR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=xR,e.workingSpace=PA,this.sharedSize=e.getViewSize()}}var OA={},ub,xA;function $4(){if(xA)return ub;xA=1;var t=Zp(),e=TypeError;return ub=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},ub}var AA;function F4(){if(AA)return OA;AA=1;var t=pt(),e=Ec(),n=_c(),r=tk(),i=$4(),o=nk(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){o(d+f);for(var g=d;g--;){var w=g+f;g in h?h[w]=h[g]:i(h,w)}for(var C=0;C<f;C++)h[C]=arguments[C]}return r(h,d+f)}}),OA}F4();function V4(t,e,n){return(e=W4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W4(t){var e=B4(t,"string");return typeof e=="symbol"?e:e+""}function B4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HA{constructor(e,n){V4(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function j4(t,e,n){return(e=U4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U4(t){var e=z4(t,"string");return typeof e=="symbol"?e:e+""}function z4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y4{constructor(e){j4(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new HA(o,n),l=new HA(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(xR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function eu(t,e,n){return(e=G4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G4(t){var e=q4(t,"string");return typeof e=="symbol"?e:e+""}function q4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o${constructor(e,n){eu(this,"rootNode",void 0),eu(this,"nodesPool",void 0),eu(this,"sizeSet",new L4),eu(this,"collectedNodes",[]),eu(this,"viewDiffer",new Y4(this.sizeSet)),eu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class s$ extends o${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function NA(t,e,n){return(e=K4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K4(t){var e=X4(t,"string");return typeof e=="symbol"?e:e+""}function X4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z4{constructor(e){NA(this,"nodeType",void 0),NA(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function ah(t,e,n){return(e=J4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J4(t){var e=Q4(t,"string");return typeof e=="symbol"?e:e+""}function Q4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class df{constructor(e,n){ah(this,"nodesPool",null),ah(this,"nodeType",void 0),ah(this,"rootNode",void 0),ah(this,"table",null),ah(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Z4(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function DA(t,e,n){return(e=e6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e6(t){var e=t6(t,"string");return typeof e=="symbol"?e:e+""}function t6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n6 extends df{constructor(){super("TH"),DA(this,"orderViews",new WeakMap),DA(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new s$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),xc(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ye(d,[LK(),YK(),f0(h+1),wa(-1)]),n[h](a,d,h)}u.end()}}}class r6 extends df{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&ws(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&ye(this.rootNode,[fL()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&ye(s,[gL(),vL(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),xc(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ye(u,[f0(a+1+this.table.rowHeadersCount),wa(-1),$K(),...a>=0?[zK()]:[kK(),dc("Select whole grid")]]),r[n](l,u,n)}}}}let kA=!1;class i6 extends df{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!kA&&e>1e3&&(kA=!0,Ze(it`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&X(r,"rowHeader")}}function o6(t,e,n){return(e=s6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s6(t){var e=a6(t,"string");return typeof e=="symbol"?e:e+""}function a6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let LA=!1;class l6 extends df{constructor(e){super("TR",e),o6(this,"orderView",void 0),this.orderView=new o$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!LA&&e>1e3&&(LA=!0,Ze(it`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ye(this.rootNode,[fL()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;ye(o,[gL(),vL(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?be(o,tu.rowEven)||(ve(o,tu.rowOdd),X(o,tu.rowEven)):be(o,tu.rowOdd)||(ve(o,tu.rowEven),X(o,tu.rowOdd))}this.orderView.end()}}function $A(t,e,n){return(e=u6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u6(t){var e=c6(t,"string");return typeof e=="symbol"?e:e+""}function c6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h6 extends df{constructor(){super("TD"),$A(this,"orderViews",new WeakMap),$A(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new s$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(be(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),xc(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;ye(g,[...g.hasAttribute("role")?[]:[DK()],wa(-1),f0(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function en(t,e,n){return(e=d6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d6(t){var e=f6(t,"string");return typeof e=="symbol"?e:e+""}function f6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g6{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};en(this,"rootNode",void 0),en(this,"rootDocument",void 0),en(this,"rowHeaders",null),en(this,"columnHeaders",null),en(this,"colGroup",null),en(this,"rows",null),en(this,"cells",null),en(this,"rowFilter",null),en(this,"columnFilter",null),en(this,"rowUtils",null),en(this,"columnUtils",null),en(this,"rowsToRender",0),en(this,"columnsToRender",0),en(this,"rowHeaderFunctions",[]),en(this,"rowHeadersCount",0),en(this,"columnHeaderFunctions",[]),en(this,"columnHeadersCount",0),en(this,"cellRenderer",void 0),en(this,"activeOverlayName",void 0),en(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class m6{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new g6(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new n6,columnHeaders:new r6(n),colGroup:new i6(r),rows:new l6(i),cells:new h6}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function cb(t,e,n){return(e=p6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p6(t){var e=w6(t,"string");return typeof e=="symbol"?e:e+""}function w6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v6{constructor(e,n){cb(this,"dataAccessObject",void 0),cb(this,"wtSettings",void 0),cb(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function FA(t,e,n){return(e=C6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C6(t){var e=y6(t,"string");return typeof e=="symbol"?e:e+""}function y6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b6{constructor(e,n){FA(this,"dataAccessObject",void 0),FA(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function Xi(t,e,n){return(e=S6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S6(t){var e=R6(t,"string");return typeof e=="symbol"?e:e+""}function R6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hc{constructor(e,n,r,i,o){Xi(this,"wtSettings",null),Xi(this,"domBindings",void 0),Xi(this,"TBODY",null),Xi(this,"THEAD",null),Xi(this,"COLGROUP",null),Xi(this,"hasTableHeight",!0),Xi(this,"hasTableWidth",!0),Xi(this,"isTableVisible",!1),Xi(this,"tableOffset",0),Xi(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,_L(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new b6(this.dataAccessObject,this.wtSettings),this.columnUtils=new v6(this.dataAccessObject,this.wtSettings),this.tableRenderer=new m6({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!be(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ye(r,[ls()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!be(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ye(r,[ls()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!be(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",this.isMaster&&ye(r,[wa(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ye(r.parentNode,[ls()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ye(r,[ls()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=kn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=kn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new O4(f,o,c),this.columnFilter=new M4(g,s,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),w=C.skipRender!==!0}w&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(bo)||this.is(ua))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(bo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(bo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=id(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(bo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Il(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=v3(r),s=n.cellIndex;Ra(Nl,n,this.wtRootElement)||Ra(Al,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Ra(ua,n,this.wtRootElement)||Ra(bo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Ra(Nl,n,this.wtRootElement)||Ra(Hl,n,this.wtRootElement)||Ra(ua,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),r=e*n.getDefaultRowHeight(),i=id(this.TBODY)-1,o=n.areCellsBorderBox(),s=o?on:id,a=o?0:1,l=o?1:0;let u,c,h,d,f;if(!(r===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const g=h===0?l:0;f?c=s(f):c=s(d)-a,(!u&&n.getDefaultRowHeight()<c-g||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return qt(this.TABLE)}getHeight(){return on(this.TABLE)}getTotalWidth(){const e=qt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=on(this.hider);return e!==0?e:this.getHeight()}isVisible(){return gc(this.TABLE)}_modifyRowHeaderWidth(e){let n=at(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const E6="stickyRowsBottom",T0={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Rs(T0,"MIXIN_NAME",E6,{writable:!1,enumerable:!1});const T6="stickyColumnsStart",ww={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Rs(ww,"MIXIN_NAME",T6,{writable:!1,enumerable:!1});class _0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,ua)}}ft(_0,T0);ft(_0,ww);const Al="top",bo="bottom",Hl="inline_start",Nl="top_inline_start_corner",ua="bottom_inline_start_corner",a$=[Al,bo,Hl,Nl,ua],_6=new Map([[Al,`ht_clone_${Al}`],[bo,`ht_clone_${bo}`],[Hl,`ht_clone_${Hl} ht_clone_left`],[Nl,`ht_clone_${Nl} ht_clone_top_left_corner`],[ua,`ht_clone_${ua} ht_clone_bottom_left_corner`]]);function M6(t,e){I6(t,e),e.add(t)}function I6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function P6(t,e,n){return(e=O6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O6(t){var e=x6(t,"string");return typeof e=="symbol"?e:e+""}function x6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lh=new WeakSet;class A6{constructor(e){M6(this,lh),P6(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Fr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Fr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Uf(lh,this,WA).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Uf(lh,this,WA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Uf(lh,this,VA).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Uf(lh,this,VA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function VA(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=kn(r.wtRootElement).left;const u=Math.abs(IL(s,s));if(l>u){const c=PL(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function WA(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=kn(n.wtRootElement),a=v0(o,o);if(s.top>a){const l=id(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Yr(t,e,n){return(e=H6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H6(t){var e=N6(t,"string");return typeof e=="symbol"?e:e+""}function N6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M0{get eventManager(){return new Wi(this)}constructor(e,n){Yr(this,"wtTable",void 0),Yr(this,"wtScroll",void 0),Yr(this,"wtViewport",void 0),Yr(this,"wtOverlays",void 0),Yr(this,"selectionManager",void 0),Yr(this,"wtEvent",void 0),Yr(this,"guid",`wt_${cL()}`),Yr(this,"drawInterrupted",!1),Yr(this,"drawn",!1),Yr(this,"activeOverlayName","master"),Yr(this,"domBindings",void 0),Yr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new A6(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Pl(r,e[n])}])}}createCellCoords(e,n){return new xl(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new hf(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||y3(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function BA(t,e,n){return(e=D6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D6(t){var e=k6(t,"string");return typeof e=="symbol"?e:e+""}function k6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L6 extends M0{constructor(e,n,r){super(e,n),BA(this,"cloneSource",void 0),BA(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new i$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function $6(t,e,n){return(e=F6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F6(t){var e=V6(t,"string");return typeof e=="symbol"?e:e+""}function V6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ff{constructor(e,n,r,i,o){$6(this,"wtSettings",null),Rs(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Hd(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Hd(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Jm(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){Ze(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Sn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(a$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${_6.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&ye(o,[ls()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Al||u==="vertical"&&this.type===Hl?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Jm(e.TABLE),new L6(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class W6 extends ff{constructor(e,n,r,i,o,s){super(e,n,ua,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new _0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else fw(n),this.repositionOverlay();let r=on(this.clone.wtTable.TABLE);const i=qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Sn(r)),i.style.bottom=`${o}px`}}const B6="calculatedColumns",vw={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Rs(vw,"MIXIN_NAME",B6,{writable:!1,enumerable:!1});class I0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,bo)}}ft(I0,T0);ft(I0,vw);function j6(t,e,n){return(e=U6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U6(t){var e=z6(t,"string");return typeof e=="symbol"?e:e+""}function z6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y6 extends ff{constructor(e,n,r,i){super(e,n,bo,r,i),j6(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new I0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Sn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(w0(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Sn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=on(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Sn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return v0(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=be(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(X(s,"innerBorderBottom"),o=!a):(ve(s,"innerBorderBottom"),o=a)}return o}}const G6="calculatedRows",P0={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Rs(P0,"MIXIN_NAME",G6,{writable:!1,enumerable:!1});class O0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,Hl)}}ft(O0,P0);ft(O0,ww);const q6="localHooks",Tn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)_R(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Rs(Tn,"MIXIN_NAME",q6,{writable:!1,enumerable:!1});let l$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};ft(l$,Tn);const u$="active-header",x0="header",A0="area",tp="focus",K6="fill",X6="row",Z6="column",J6="custom-selection",H0=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var jA={},UA;function Q6(){if(UA)return jA;UA=1;var t=mw();return t("flat"),jA}Q6();function e9(t,e){c$(t,e),e.add(t)}function zA(t,e,n){c$(t,e),e.set(t,n)}function c$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nt(t,e){return t.get(od(t,e))}function YA(t,e,n){return t.set(od(t,e),n),n}function od(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ei=new WeakMap,xn=new WeakMap,zf=new WeakSet;class t9{constructor(){e9(this,zf),zA(this,Ei,void 0),zA(this,xn,void 0)}setActiveOverlay(e){return YA(xn,this,e),this}setActiveSelection(e){return YA(Ei,this,e),this}scan(){const e=Nt(Ei,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Nt(Ei,this).getCorners(),{wtTable:s}=Nt(xn,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const w=Nt(xn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Nt(Ei,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});w!==null&&(w!==h&&(g=s.getColumnHeader(w,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Nt(Ei,this).getCorners(),{wtTable:s}=Nt(xn,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const w=Nt(xn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Nt(Ei,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});w!==null&&(w!==h&&(g=s.getRowHeader(w,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Nt(xn,this);od(zf,this,n9).call(this,(r,i)=>{const o=n.getCell(Nt(xn,this).createCellCoords(r,i)),s=Nt(xn,this).getSetting("onAfterDrawSelection",r,i,Nt(Ei,this).settings.layerLevel);typeof s=="string"&&X(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Nt(Ei,this).getCorners(),{wtTable:i}=Nt(xn,this);od(zf,this,GA).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Nt(xn,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Nt(Ei,this).getCorners(),{wtTable:i}=Nt(xn,this);od(zf,this,GA).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Nt(xn,this).createCellCoords(o,s));e(a)}})}}function n9(t){let[e,n,r,i]=Nt(Ei,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Nt(xn,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Nt(xn,this).createCellCoords(e,n));if(!ms(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function GA(t){const{wtTable:e}=Nt(xn,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class qA{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=H0(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),zi(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Eo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,r=n.getSetting("stylesHandler"),i=r.getCSSVariableValue("cell-mobile-handle-size"),o=r.getCSSVariableValue("cell-mobile-handle-border-radius"),s=r.getCSSVariableValue("cell-mobile-handle-background-color"),a=r.getCSSVariableValue("cell-mobile-handle-border-width"),l=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};De(h,(f,g)=>{this.selectionHandles.styles.bottomHitArea[g]=f,this.selectionHandles.styles.topHitArea[g]=f});const d=r.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};De(d,(f,g)=>{this.selectionHandles.styles.bottom[g]=f,this.selectionHandles.styles.top[g]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),w=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-w/4*3,10)}px`,c[l]=`${parseInt(i-w/4*3,10)}px`;const v=Math.min(parseInt(i+o,10),C-g-f*2),E=Math.min(parseInt(i+o-w/4,10),C-w-f*2);h[l]=`${v}px`,d[l]=`${E}px`;const P=Math.min(parseInt(r+s,10),S-g-f*2),x=Math.min(parseInt(r+s-w/4,10),S-w-f*2);h.top=`${P}px`,d.top=`${x}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),f=s.getFirstRenderedColumn(),g=s.getLastRenderedColumn();if(f<0&&g<0||h<0&&d<0){this.disappear();return}let w;if(u){if(r=Math.max(r,f),o=Math.min(o,g),n=Math.max(n,h),i=Math.min(i,d),o<r||i<n){this.disappear();return}w=s.getCell(this.wot.createCellCoords(n,r))}else if(w=s.getCell(this.wot.createCellCoords(n,r)),!ms(w)){this.disappear();return}const C=u?s.getCell(this.wot.createCellCoords(i,o)):w,S=kn(w),v=u?kn(C):S,E=kn(s.TABLE),P=S.top,x=S.left,_=this.wot.wtSettings.getSetting("rtlMode");let M=0,V=0;if(_){const Ve=qt(s.TABLE),yt=qt(w),ot=l.innerWidth-E.left-Ve;V=x+yt-v.left,M=l.innerWidth-x-yt-ot-1}else V=v.left+qt(C)-x,M=x-E.left-1;if(this.isEntireColumnSelected(n,i)){const Ve=n,yt=this.getDimensionsFromHeader("columns",r,o,Ve,E);let ot=null;yt&&([ot,M,V]=yt),ot&&(w=ot)}let z=P-E.top-1,O=v.top+on(C)-P;if(this.isEntireRowSelected(r,o)){const Ve=r,yt=this.getDimensionsFromHeader("rows",n,i,Ve,E);let ot=null;yt&&([ot,z,O]=yt),ot&&(w=ot)}const G=l.getComputedStyle(w);parseInt(G.borderTopWidth,10)>0&&(z+=1,O=O>0?O-1:0),parseInt(G[_?"borderRightWidth":"borderLeftWidth"],10)>0&&(M+=1,V=V>0?V-1:0);const Z=_?"right":"left",ae=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${z}px`,this.topStyle[Z]=`${M}px`,this.topStyle.width=`${V+ae}px`,this.topStyle.display="block",this.startStyle.top=`${z}px`,this.startStyle[Z]=`${M}px`,this.startStyle.height=`${O+ae}px`,this.startStyle.display="block",this.bottomStyle.top=`${z+O-parseInt(this.bottomStyle.height,10)+ae}px`,this.bottomStyle[Z]=`${M}px`,this.bottomStyle.width=`${V+ae}px`,this.bottomStyle.display="block",this.endStyle.top=`${z}px`,this.endStyle[Z]=`${M+V-parseInt(this.endStyle.width,10)+ae}px`,this.endStyle.height=`${O+ae}px`,this.endStyle.display="block";let te=this.settings.border.cornerVisible;te=typeof te=="function"?te(this.settings.layerLevel):te;const ne=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[Fe,ke]=[i,o];if(ne&&Array.isArray(ne)&&([,,Fe,ke]=ne),Eo()||!te||this.isPartRange(Fe,ke))this.cornerStyle.display="none";else{this.cornerStyle.top=`${z+O+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[Z]=`${M+V+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ve=Hd(s.TABLE);const yt=Ve===l;yt&&(Ve=a.documentElement);const ot=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,ut=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),wn=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=yt?C.getBoundingClientRect().left:C.offsetLeft;let p=!1,b=0;if(_?(b=m-parseInt(this.cornerDefaultStyle.width,10)/2,p=b<0):(b=m+qt(C)+parseInt(this.cornerDefaultStyle.width,10)/2,p=b>=PL(Ve)),p){const D=Math.floor(M+V+this.cornerCenterPointOffset-ut-ot);c?(this.cornerStyle[Z]=`${D}px`,this.cornerStyle[_?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[Z]=`${D-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(yt?C.getBoundingClientRect().top:C.offsetTop)+on(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=id(Ve)){const D=Math.floor(z+O+this.cornerCenterPointOffset-wn-ot);c?(this.cornerStyle.top=`${D}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${D-1}px`}this.cornerStyle.display="block"}Eo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,z,M,V,O)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,w=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return on(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return qt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(g=l(n,C-i),w=l(r,C-i),!g||!w)return!1;const S=kn(g),v=kn(w);return g&&w&&(h=S[f]-o[f]-1,d=v[f]+u(w)-S[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?X(this[e],"hidden"):(be(this[e],"hidden")&&ve(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?X(this[e],"hidden"):ve(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Eo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function r9(t,e){h$(t,e),e.add(t)}function nu(t,e,n){h$(t,e),e.set(t,n)}function h$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(N0(t,e))}function KA(t,e,n){return t.set(N0(t,e),n),n}function N0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var An=new WeakMap,fr=new WeakMap,hb=new WeakMap,Kh=new WeakMap,db=new WeakMap,_a=new WeakMap,XA=new WeakSet;class i9{constructor(e){r9(this,XA),nu(this,An,void 0),nu(this,fr,void 0),nu(this,hb,new t9),nu(this,Kh,new WeakMap),nu(this,db,new WeakSet),nu(this,_a,new Map),KA(fr,this,e)}setActiveOverlay(e){return KA(An,this,e),xe(hb,this).setActiveOverlay(xe(An,this)),xe(Kh,this).has(xe(An,this))||xe(Kh,this).set(xe(An,this),new Set),this}getFocusSelection(){return xe(fr,this)!==null?xe(fr,this).getFocus():null}getAreaSelection(){return xe(fr,this)!==null?xe(fr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(xe(_a,this).has(e)){const r=xe(_a,this).get(e);if(r.has(xe(An,this)))return r.get(xe(An,this));const i=new qA(xe(An,this),e.settings);return r.set(xe(An,this),i),i}const n=new qA(xe(An,this),e.settings);return xe(_a,this).set(e,new Map([[xe(An,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=xe(_a,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){xe(_a,this).get(e).forEach(n=>n.destroy()),xe(_a,this).delete(e)}render(e){if(xe(fr,this)===null)return;e&&N0(XA,this,o9).call(this);const n=Array.from(xe(fr,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;xe(db,this).has(s)||(xe(db,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&xe(hb,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const w=r.get(g);w.has(a)&&u===!0?w.set(a,w.get(a)+1):w.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();xe(An,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>xe(Kh,this).get(xe(An,this)).add(u)),X(s,l),s.nodeName==="TD"&&Array.isArray((a=xe(fr,this).options)===null||a===void 0?void 0:a.cellAttributes)&&ye(s,xe(fr,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{ye(o,[...i.get(o)])})}}function o9(){const t=xe(Kh,this).get(xe(An,this)),e=xe(An,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=xe(An,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=xe(fr,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=xe(fr,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=xe(fr,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...xe(fr,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)ve(o[a],n),xc(o[a],s)}),t.clear()}class s9 extends ff{constructor(e,n,r,i){super(e,n,Hl,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new O0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),C0(r,`${o}px`,"0px")):(o=this.getScrollPosition(),fw(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,ML(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=Sn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=qt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=H0(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!be(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=Sn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,S3(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(IL(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?ve(r,"emptyRows"):X(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)X(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=be(r,"innerBorderInlineStart");e?(X(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(ve(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const a9="stickyRowsTop",D0={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Rs(D0,"MIXIN_NAME",a9,{writable:!1,enumerable:!1});class k0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,Nl)}}ft(k0,D0);ft(k0,ww);function ZA(t,e,n){return(e=l9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l9(t){var e=u9(t,"string");return typeof e=="symbol"?e:e+""}function u9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c9 extends ff{constructor(e,n,r,i,o,s){super(e,n,Nl,r,i),ZA(this,"topOverlay",void 0),ZA(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new k0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();C0(e,`${i}px`,`${o}px`)}else fw(e);let n=on(this.clone.wtTable.TABLE);const r=qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class L0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,Al)}}ft(L0,D0);ft(L0,vw);function h9(t,e,n){return(e=d9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d9(t){var e=f9(t,"string");return typeof e=="symbol"?e:e+""}function f9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g9 extends ff{constructor(e,n,r,i){super(e,n,Al,r,i),h9(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new L0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),C0(e,"0px",`${i}px`)}else i=this.getScrollPosition(),fw(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(w0(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Sn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=on(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=H0(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!be(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=Sn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,b3(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return v0(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?ve(i,"emptyColumns"):X(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=be(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(X(i,"innerBorderTop"),a=!h):(ve(i,"innerBorderTop"),a=h)}}return a}}function Yf(t,e,n){m9(t,e),e.set(t,n)}function m9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fo(t,e,n){return(e=p9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p9(t){var e=w9(t,"string");return typeof e=="symbol"?e:e+""}function w9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ma(t,e,n){return t.set(d$(t,e),n),n}function Vo(t,e){return t.get(d$(t,e))}function d$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ru=new WeakMap,Gf=new WeakMap,iu=new WeakMap,qf=new WeakMap;class v9{constructor(e,n,r,i,o,s){Fo(this,"wot",null),Yf(this,ru,[]),Fo(this,"topOverlay",null),Fo(this,"bottomOverlay",null),Fo(this,"inlineStartOverlay",null),Fo(this,"topInlineStartCornerOverlay",null),Fo(this,"bottomInlineStartCornerOverlay",null),Fo(this,"browserLineHeight",void 0),Fo(this,"wtSettings",null),Yf(this,Gf,!1),Yf(this,iu,0),Yf(this,qf,null),Fo(this,"resizeObserver",new ResizeObserver(c=>{Xm(()=>{!Array.isArray(c)||!c.length||(Ma(iu,this,Vo(iu,this)+1),Vo(iu,this)===100&&(Ze("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Vo(qf,this)!==null&&clearTimeout(Vo(qf,this)),Ma(qf,this,setTimeout(()=>{Ma(iu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Sn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Jm(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Vo(ru,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new g9(...e),this.bottomOverlay=new Y6(...e),this.inlineStartOverlay=new s9(...e),this.topInlineStartCornerOverlay=new c9(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new W6(...e,this.bottomOverlay,this.inlineStartOverlay),Ma(ru,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Ma(Gf,this,Vo(ru,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Vo(ru,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Vo(ru,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!bL())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Xm(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{Ma(iu,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=cf(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Vo(Gf,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),Ma(Gf,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Jm(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),w=f()?1:0,C=g()?1:0;d.width=`${c+C}px`,d.height=`${u+w}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return H(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];H(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function JA(t,e,n){return(e=C9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C9(t){var e=y9(t,"string");return typeof e=="symbol"?e:e+""}function y9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b9{constructor(e){JA(this,"settings",{}),JA(this,"defaults",Object.freeze(this.getDefaults())),De(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Pl(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?De(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class $0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Hd(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Qm(e,"height",n),o=Qm(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=gc(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}ft($0,P0);ft($0,vw);class S9{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new e4:new s4],["fullyVisible",()=>new UX],["partiallyVisible",()=>new QL]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new ZX:new r4],["fullyVisible",()=>new WX],["partiallyVisible",()=>new JL]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=on(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return kn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=on(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=qt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Sn(this.domBindings.rootDocument),new g4({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Sn(this.domBindings.rootDocument)),new h4({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){De(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}class R9 extends M0{constructor(e,n){super(e,new b9(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new $0(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new S9(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new i9(this.wtSettings.getSetting("selections")),this.wtEvent=new i$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new v9(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];De(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),ve(this.wtTable.wtRootElement.parentNode,n),X(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!a$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class F0{constructor(e){e instanceof M0?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new F0(n);return()=>r},this._wot=new R9(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function QA(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function E9(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}function e1(t){let{isLeftClick:e,selection:n,cellRangeMapper:r}=t;if(!e||n.settings.selectionMode!=="multiple")return;const i=n.getSelectedRange(),o=i.clone().map(a=>r.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!n.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),n.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),n.refresh())}}const T9=new Map([["touchstart",QA],["touchend",e1],["mousedown",QA],["mouseover",E9],["mouseup",e1]]);function fb(t,e){T9.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:y0(t)||t.type==="touchstart",isRightClick:Ol(t),...e})}const f$=new WeakMap,V0=Symbol("rootInstance");function _9(t){f$.set(t,!0)}function M9(t){return t===V0}function Vu(t){return f$.has(t)}function I9(t,e){g$(t,e),e.add(t)}function Ms(t,e,n){g$(t,e),e.set(t,n)}function g$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Is(t,e,n){return(e=P9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P9(t){var e=O9(t,"string");return typeof e=="symbol"?e:e+""}function O9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zt(t,e){return t.get(rc(t,e))}function or(t,e,n){return t.set(rc(t,e),n),n}function rc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gb=new WeakMap,Kf=new WeakMap,Xf=new WeakMap,Wo=new WeakMap,Ci=new WeakMap,mb=new WeakMap,pb=new WeakMap,ou=new WeakMap,Xh=new WeakSet;class x9{constructor(e){I9(this,Xh),Is(this,"hot",void 0),Is(this,"eventManager",void 0),Is(this,"settings",void 0),Is(this,"THEAD",void 0),Is(this,"TBODY",void 0),Is(this,"_wt",void 0),Is(this,"activeWt",void 0),Ms(this,gb,0),Ms(this,Kf,0),Is(this,"postponedAdjustElementsSize",!1),Ms(this,Xf,!1),Ms(this,Wo,void 0),Ms(this,Ci,void 0),Ms(this,mb,0),Ms(this,pb,0),Ms(this,ou,null),this.hot=e,this.eventManager=new Wi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),rc(Xh,this,H9).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),X(e,"handsontable"),or(Ci,this,n.createElement("TABLE")),X(zt(Ci,this),"htCore"),this.hot.getSettings().tableClassName&&X(zt(Ci,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(ye(zt(Ci,this),[ls()]),ye(e,[NK(),wL(-1),cw(this.hot.countCols()),KK()])),this.THEAD=n.createElement("THEAD"),zt(Ci,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),zt(Ci,this).appendChild(this.TBODY),this.hot.table=zt(Ci,this),this.hot.container.insertBefore(zt(Ci,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{or(Xf,this,!0),this.isTextSelectionAllowed(a.target)||(Wx(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{or(Xf,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{zt(Xf,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&Wx(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&y0(a)&&r.finish(),or(Wo,this,!1);const l=NL(n.activeElement);Sm(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Ol(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&Ol(a)&&(r.finish(),or(Wo,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),or(Wo,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(zt(Wo,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=Sn(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=fc(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=fc(s);this.eventManager.addEventListener(zt(Ci,this),"selectstart",a=>{this.settings.fragmentSelection||Sm(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&X(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&ve(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:zt(Ci,this),isDataViewInstance:()=>Vu(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),or(Kf,this,o.length),this.hot.getSettings().ariaTags&&rc(Xh,this,m$).call(this)===this.hot.countCols()&&rc(Xh,this,A9).call(this,zt(Kf,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),or(gb,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let w=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(w=this.hot.runHooks("beforeValueRender",w,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,w,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,w,f),this.hot.runHooks("afterRenderer",a,l,u,g,w,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&gc(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,or(Wo,this,!0),or(ou,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!ul(o)&&(fb(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,or(Wo,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!ul(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!ul(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!ul(o)&&(zt(Wo,this)&&(!zt(ou,this)||zt(ou,this).x!==o.clientX||zt(ou,this).y!==o.clientY)&&fb(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,or(ou,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(ul(o)||this.hot.isDestroyed)&&(fb(o,{coords:u,selection:this.hot.selection,cellRangeMapper:Y3(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,w,C,S]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,1)):w,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,S>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(S,-1)):S]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new F0(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Sm(e))return!0;const n=Rl(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return zt(Wo,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!be(r,"relative")){ws(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;be(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",X(s,["relative",...o()])):(ws(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(ye(a,...ls()),ye(l,...ls())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(be(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):be(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ac(e,r(n,i)):(Pl(e," "),X(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){or(mb,this,e),or(pb,this,n)}getLastSize(){return{width:zt(mb,this),height:zt(pb,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return zt(gb,this)}getRowHeadersCount(){return zt(Kf,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function m$(){return parseInt(this.hot.rootElement.getAttribute(cw()[0]),10)}function A9(t){const e=rc(Xh,this,m$).call(this)+t;ye(this.hot.rootElement,...cw(e))}function H9(){const t=this.hot.rootElement;this.hasVerticalScroll()?X(t,"htHasScrollY"):ve(t,"htHasScrollY"),this.hasHorizontalScroll()?X(t,"htHasScrollX"):ve(t,"htHasScrollX")}var t1={},n1={},r1;function N9(){if(r1)return n1;r1=1;var t=pt(),e=ln(),n=Mc(),r=Sr(),i=cn(),o=Oo(),s=Rr(),a=pa(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return!n(h,function(f,g){if(!c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),n1}var i1;function D9(){return i1||(i1=1,N9()),t1}D9();const k9="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o1=k9.length;function L9(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%o1,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/o1,10);return n}function p$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function w$(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ne(t[0])&&(e=p0(t[0]))),e}function $9(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function F9(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function uh(t,e,n){return(e=V9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V9(t){var e=W9(t,"string");return typeof e=="symbol"?e:e+""}function W9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B9{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];uh(this,"hot",void 0),uh(this,"data",void 0),uh(this,"dataType","array"),uh(this,"colToProp",()=>{}),uh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return H(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):de(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(Ne(a)||at(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;de(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?Vy(l,d,f):l[d]=f}})}else De(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Vy(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Fr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:Vy(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?a3(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Fr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return de(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return w$(this.data)}destroy(){this.data=null,this.hot=null}}var s1={},a1={},l1;function j9(){if(l1)return a1;l1=1;var t=pt(),e=ln(),n=Mc(),r=Sr(),i=cn(),o=Oo(),s=Rr(),a=pa(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,g){if(c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),a1}var u1;function U9(){return u1||(u1=1,j9()),s1}U9();function c1(t,e,n){return(e=z9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z9(t){var e=Y9(t,"string");return typeof e=="symbol"?e:e+""}function Y9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;c1(this,"indexedValues",[]),c1(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,at(this.initValueOrFn)?de(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):de(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ft(Yl,Tn);function W0(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>at(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function B0(t,e){return Ml(t,(n,r)=>e.includes(r)===!1)}class Ca extends Yl{insert(e,n){this.indexedValues=W0(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=B0(this.indexedValues,e),super.remove(e)}}class Cw extends Ca{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Er(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function j0(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Nd(t,e){return Ml(t,n=>e.includes(n)===!1)}function U0(t,e){return je(t,n=>n-e.filter(r=>r<n).length)}function z0(t,e){const n=e[0],r=e.length;return je(t,i=>i>=n?i+r:i)}function G9(t,e,n){return(e=q9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q9(t){var e=K9(t,"string");return typeof e=="symbol"?e:e+""}function K9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yw extends Yl{constructor(){super(...arguments),G9(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Nd(this.orderOfIndexes,[e]),at(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=W0(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=z0(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=B0(this.indexedValues,e),this.orderOfIndexes=Nd(this.orderOfIndexes,e),this.orderOfIndexes=U0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class gf extends Ca{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Er(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const h1=new Map([["indexesSequence",{getListWithInsertedItems:j0,getListWithRemovedItems:Nd}],["physicallyIndexed",{getListWithInsertedItems:W0,getListWithRemovedItems:B0}]]),v$=t=>{if(h1.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return h1.get(t)};class C$ extends Yl{constructor(){super(e=>e)}insert(e,n){const r=z0(this.indexedValues,n);this.indexedValues=j0(r,e,n),super.insert(e,n)}remove(e){const n=Nd(this.indexedValues,e);this.indexedValues=U0(n,e),super.remove(e)}}const d1=new Map([["hiding",Cw],["index",Yl],["linkedPhysicalIndexToValue",yw],["physicalIndexToValue",Ca],["trimming",gf]]);function X9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!d1.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(d1.get(t))(e)}function Z9(t,e,n){return(e=J9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J9(t){var e=Q9(t,"string");return typeof e=="symbol"?e:e+""}function Q9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y0{constructor(){Z9(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)))}unregister(e){const n=this.collection.get(e);ue(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n))}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Pt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}ft(Y0,Tn);function wb(t,e,n){return(e=e8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e8(t){var e=t8(t,"string");return typeof e=="symbol"?e:e+""}function t8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f1 extends Y0{constructor(e,n){super(),wb(this,"mergedValuesCache",[]),wb(this,"aggregationFunction",void 0),wb(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=je(this.get(),o=>o.getValues()),r=[],i=ue(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return je(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ue(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function n8(t,e,n){r8(t,e),e.set(t,n)}function r8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i8(t,e,n){return t.set(y$(t,e),n),n}function o8(t,e){return t.get(y$(t,e))}function y$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vb=new WeakMap;class b${constructor(){n8(this,vb,[])}subscribe(e){return this.addLocalHook("change",e),this._write(o8(vb,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){i8(vb,this,e)}}ft(b$,Tn);function g1(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function ch(t,e,n){s8(t,e),e.set(t,n)}function s8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gr(t,e){return t.get(S$(t,e))}function Zf(t,e,n){return t.set(S$(t,e),n),n}function S$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jf=new WeakMap,hh=new WeakMap,Qf=new WeakMap,eg=new WeakMap,tg=new WeakMap;class a8{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ch(this,Jf,new Set),ch(this,hh,[]),ch(this,Qf,[]),ch(this,eg,!1),ch(this,tg,!1),Zf(tg,this,e??!1)}createObserver(){const e=new b$;return Gr(Jf,this).add(e),e.addLocalHook("unsubscribe",()=>{Gr(Jf,this).delete(e)}),e._writeInitialChanges(g1(Gr(hh,this),Gr(Qf,this))),e}emit(e){let n=Gr(Qf,this);(!Gr(eg,this)||Gr(hh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Gr(tg,this)):Zf(hh,this,new Array(e.length).fill(Gr(tg,this))),Gr(eg,this)||(Zf(eg,this,!0),n=Gr(hh,this)));const r=g1(n,e);Gr(Jf,this).forEach(i=>i._write(r)),Zf(Qf,this,e)}}function jn(t,e,n){return(e=l8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l8(t){var e=u8(t,"string");return typeof e=="symbol"?e:e+""}function u8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AR{constructor(){jn(this,"indexesSequence",new C$),jn(this,"trimmingMapsCollection",new f1(e=>e.some(n=>n===!0),!1)),jn(this,"hidingMapsCollection",new f1(e=>e.some(n=>n===!0),!1)),jn(this,"variousMapsCollection",new Y0),jn(this,"hidingChangesObservable",new a8({initialIndexValue:!1})),jn(this,"notTrimmedIndexesCache",[]),jn(this,"notHiddenIndexesCache",[]),jn(this,"isBatched",!1),jn(this,"indexesSequenceChanged",!1),jn(this,"indexesChangeSource",void 0),jn(this,"trimmedIndexesChanged",!1),jn(this,"hiddenIndexesChanged",!1),jn(this,"renderablePhysicalIndexesCache",[]),jn(this,"fromPhysicalToVisualIndexesCache",new Map),jn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,X9(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof gf?this.trimmingMapsCollection.register(e,n):n instanceof Cw?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ue(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ue(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ue(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ue(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=je(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Nd(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(j0(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=ue(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=je(new Array(n).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=r==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}ft(AR,Tn);function c8(t,e){return De(e,(n,r)=>{Pt(t[r])&&(t[r]=n)}),t}function R$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function E$(t){ue(t)&&b0(it`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function h8(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:d8,getValues:f8}=gi("phraseFormatters");function g8(t,e){d8(t,e)}function m8(){return f8()}g8("pluralize",h8);const T$="ContextMenu:items",_e=T$,G0=`${_e}.noItems`,q0=`${_e}.insertRowAbove`,K0=`${_e}.insertRowBelow`,X0=`${_e}.insertColumnOnTheLeft`,Z0=`${_e}.insertColumnOnTheRight`,J0=`${_e}.removeRow`,Q0=`${_e}.removeColumn`,eT=`${_e}.undo`,tT=`${_e}.redo`,np=`${_e}.readOnly`,nT=`${_e}.clearColumn`,rT=`${_e}.copy`,iT=`${_e}.copyWithHeaders`,oT=`${_e}.copyWithGroupHeaders`,sT=`${_e}.copyHeadersOnly`,aT=`${_e}.cut`,lT=`${_e}.freezeColumn`,uT=`${_e}.unfreezeColumn`,cT=`${_e}.mergeCells`,hT=`${_e}.unmergeCells`,dT=`${_e}.addComment`,fT=`${_e}.editComment`,gT=`${_e}.removeComment`,mT=`${_e}.readOnlyComment`,pT=`${_e}.align`,wT=`${_e}.align.left`,vT=`${_e}.align.center`,CT=`${_e}.align.right`,yT=`${_e}.align.justify`,bT=`${_e}.align.top`,ST=`${_e}.align.middle`,RT=`${_e}.align.bottom`,ET=`${_e}.borders`,TT=`${_e}.borders.top`,_T=`${_e}.borders.right`,MT=`${_e}.borders.bottom`,IT=`${_e}.borders.left`,PT=`${_e}.borders.remove`,OT=`${_e}.nestedHeaders.insertChildRow`,xT=`${_e}.nestedHeaders.detachFromParent`,AT=`${_e}.hideColumn`,HT=`${_e}.showColumn`,NT=`${_e}.hideRow`,DT=`${_e}.showRow`,tr="Filters:",$t=`${tr}conditions`,bw=`${$t}.none`,kT=`${$t}.isEmpty`,LT=`${$t}.isNotEmpty`,$T=`${$t}.isEqualTo`,FT=`${$t}.isNotEqualTo`,VT=`${$t}.beginsWith`,WT=`${$t}.endsWith`,BT=`${$t}.contains`,jT=`${$t}.doesNotContain`,p8=`${$t}.byValue`,UT=`${$t}.greaterThan`,zT=`${$t}.greaterThanOrEqualTo`,YT=`${$t}.lessThan`,GT=`${$t}.lessThanOrEqualTo`,qT=`${$t}.isBetween`,KT=`${$t}.isNotBetween`,XT=`${$t}.after`,ZT=`${$t}.before`,JT=`${$t}.today`,QT=`${$t}.tomorrow`,e_=`${$t}.yesterday`,t_=`${tr}labels.filterByCondition`,n_=`${tr}labels.filterByValue`,r_=`${tr}labels.conjunction`,Sw=`${tr}labels.disjunction`,rp=`${tr}values.blankCells`,i_=`${tr}buttons.selectAll`,o_=`${tr}buttons.clear`,s_=`${tr}buttons.ok`,a_=`${tr}buttons.cancel`,l_=`${tr}buttons.placeholder.search`,u_=`${tr}buttons.placeholder.value`,c_=`${tr}buttons.placeholder.secondValue`,h_="CheckboxRenderer:",d_=`${h_}checked`,f_=`${h_}unchecked`,w8=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:d_,CHECKBOX_RENDERER_NAMESPACE:h_,CHECKBOX_UNCHECKED:f_,CONTEXTMENU_ITEMS_ADD_COMMENT:dT,CONTEXTMENU_ITEMS_ALIGNMENT:pT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:RT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:vT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:yT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:wT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:ST,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:CT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:bT,CONTEXTMENU_ITEMS_BORDERS:ET,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:MT,CONTEXTMENU_ITEMS_BORDERS_LEFT:IT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:_T,CONTEXTMENU_ITEMS_BORDERS_TOP:TT,CONTEXTMENU_ITEMS_CLEAR_COLUMN:nT,CONTEXTMENU_ITEMS_COPY:rT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:sT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:oT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:iT,CONTEXTMENU_ITEMS_CUT:aT,CONTEXTMENU_ITEMS_EDIT_COMMENT:fT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:lT,CONTEXTMENU_ITEMS_HIDE_COLUMN:AT,CONTEXTMENU_ITEMS_HIDE_ROW:NT,CONTEXTMENU_ITEMS_INSERT_LEFT:X0,CONTEXTMENU_ITEMS_INSERT_RIGHT:Z0,CONTEXTMENU_ITEMS_MERGE_CELLS:cT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:xT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:OT,CONTEXTMENU_ITEMS_NO_ITEMS:G0,CONTEXTMENU_ITEMS_READ_ONLY:np,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:mT,CONTEXTMENU_ITEMS_REDO:tT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:PT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Q0,CONTEXTMENU_ITEMS_REMOVE_COMMENT:gT,CONTEXTMENU_ITEMS_REMOVE_ROW:J0,CONTEXTMENU_ITEMS_ROW_ABOVE:q0,CONTEXTMENU_ITEMS_ROW_BELOW:K0,CONTEXTMENU_ITEMS_SHOW_COLUMN:HT,CONTEXTMENU_ITEMS_SHOW_ROW:DT,CONTEXTMENU_ITEMS_UNDO:eT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:uT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:hT,CONTEXT_MENU_ITEMS_NAMESPACE:T$,FILTERS_BUTTONS_CANCEL:a_,FILTERS_BUTTONS_CLEAR:o_,FILTERS_BUTTONS_OK:s_,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:l_,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:c_,FILTERS_BUTTONS_PLACEHOLDER_VALUE:u_,FILTERS_BUTTONS_SELECT_ALL:i_,FILTERS_CONDITIONS_AFTER:XT,FILTERS_CONDITIONS_BEFORE:ZT,FILTERS_CONDITIONS_BEGINS_WITH:VT,FILTERS_CONDITIONS_BETWEEN:qT,FILTERS_CONDITIONS_BY_VALUE:p8,FILTERS_CONDITIONS_CONTAINS:BT,FILTERS_CONDITIONS_EMPTY:kT,FILTERS_CONDITIONS_ENDS_WITH:WT,FILTERS_CONDITIONS_EQUAL:$T,FILTERS_CONDITIONS_GREATER_THAN:UT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:zT,FILTERS_CONDITIONS_LESS_THAN:YT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:GT,FILTERS_CONDITIONS_NAMESPACE:$t,FILTERS_CONDITIONS_NONE:bw,FILTERS_CONDITIONS_NOT_BETWEEN:KT,FILTERS_CONDITIONS_NOT_CONTAIN:jT,FILTERS_CONDITIONS_NOT_EMPTY:LT,FILTERS_CONDITIONS_NOT_EQUAL:FT,FILTERS_CONDITIONS_TODAY:JT,FILTERS_CONDITIONS_TOMORROW:QT,FILTERS_CONDITIONS_YESTERDAY:e_,FILTERS_DIVS_FILTER_BY_CONDITION:t_,FILTERS_DIVS_FILTER_BY_VALUE:n_,FILTERS_LABELS_CONJUNCTION:r_,FILTERS_LABELS_DISJUNCTION:Sw,FILTERS_NAMESPACE:tr,FILTERS_VALUES_BLANK_CELLS:rp},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const _$={languageCode:"en-US",[G0]:"No available options",[q0]:"Insert row above",[K0]:"Insert row below",[X0]:"Insert column left",[Z0]:"Insert column right",[J0]:["Remove row","Remove rows"],[Q0]:["Remove column","Remove columns"],[eT]:"Undo",[tT]:"Redo",[np]:"Read only",[nT]:"Clear column",[pT]:"Alignment",[wT]:"Left",[vT]:"Center",[CT]:"Right",[yT]:"Justify",[bT]:"Top",[ST]:"Middle",[RT]:"Bottom",[lT]:"Freeze column",[uT]:"Unfreeze column",[ET]:"Borders",[TT]:"Top",[_T]:"Right",[MT]:"Bottom",[IT]:"Left",[PT]:"Remove border(s)",[dT]:"Add comment",[fT]:"Edit comment",[gT]:"Delete comment",[mT]:"Read-only comment",[cT]:"Merge cells",[hT]:"Unmerge cells",[rT]:"Copy",[iT]:["Copy with header","Copy with headers"],[oT]:["Copy with group header","Copy with group headers"],[sT]:["Copy header only","Copy headers only"],[aT]:"Cut",[OT]:"Insert child row",[xT]:"Detach from parent",[AT]:["Hide column","Hide columns"],[HT]:["Show column","Show columns"],[NT]:["Hide row","Hide rows"],[DT]:["Show row","Show rows"],[bw]:"None",[kT]:"Is empty",[LT]:"Is not empty",[$T]:"Is equal to",[FT]:"Is not equal to",[VT]:"Begins with",[WT]:"Ends with",[BT]:"Contains",[jT]:"Does not contain",[UT]:"Greater than",[zT]:"Greater than or equal to",[YT]:"Less than",[GT]:"Less than or equal to",[qT]:"Is between",[KT]:"Is not between",[XT]:"After",[ZT]:"Before",[JT]:"Today",[QT]:"Tomorrow",[e_]:"Yesterday",[rp]:"Blank cells",[t_]:"Filter by condition",[n_]:"Filter by value",[r_]:"And",[Sw]:"Or",[i_]:"Select all",[o_]:"Clear",[s_]:"OK",[a_]:"Cancel",[l_]:"Search",[u_]:"Value",[c_]:"Second value",[d_]:"Checked",[f_]:"Unchecked"},v8=w8,HR=_$.languageCode,{register:C8,getItem:M$,hasItem:y8,getValues:b8}=gi("languagesDictionaries");I$(_$);function I$(t,e){let n=t,r=e;return Ne(t)&&(r=t,n=r.languageCode),S8(n,r),C8(n,er(r)),er(r)}function S8(t,e){t!==HR&&c8(e,M$(HR))}function P$(t){return g_(t)?er(M$(t)):null}function g_(t){return y8(t)}function R8(){return b8()}function O$(t,e,n){const r=P$(t);if(r===null)return null;const i=r[e];if(Pt(i))return null;const o=E8(i,n);return Array.isArray(o)?o[0]:o}function E8(t,e){let n=t;return H(m8(),r=>{n=r(t,e)}),n}function T8(t){let e=R$(t);return g_(e)||(e=HR,E$(t)),e}function _8(t,e,n){return(e=M8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M8(t){var e=I8(t,"string");return typeof e=="symbol"?e:e+""}function I8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Es extends l${constructor(e,n){super(e,null),_8(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function Cb(t){let{activeHeaderClassName:e,...n}=t;return new Es({className:e,...n,selectionType:u$})}function P8(t){let{areaCornerVisible:e,...n}=t;return new Es({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:A0})}function O8(t){let{...e}=t;return new Es({className:"highlight",...e,selectionType:A0})}function x8(t){let{columnClassName:e,...n}=t;return new Es({className:e,...n,selectionType:Z6})}function A8(t){let{cellCornerVisible:e,...n}=t;return new Es({className:"current",headerAttributes:[g0()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:tp})}function H8(t){let{border:e,visualCellRange:n,...r}=t;return new Es({...e,...r,selectionType:J6},n)}function N8(t){let{...e}=t;return new Es({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:K6})}function m1(t){let{headerClassName:e,...n}=t;return new Es({className:e,...n,selectionType:x0})}function D8(t){let{rowClassName:e,...n}=t;return new Es({className:e,...n,selectionType:X6})}function k8(t,e){L8(t,e),e.add(t)}function L8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e,n){return(e=$8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $8(t){var e=F8(t,"string");return typeof e=="symbol"?e:e+""}function F8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zi=new WeakSet;class V8{constructor(e){k8(this,Zi),sr(this,"options",void 0),sr(this,"layerLevel",0),sr(this,"focus",void 0),sr(this,"fill",void 0),sr(this,"layeredAreas",new Map),sr(this,"areas",new Map),sr(this,"rowHeaders",new Map),sr(this,"columnHeaders",new Map),sr(this,"activeRowHeaders",new Map),sr(this,"activeColumnHeaders",new Map),sr(this,"activeCornerHeaders",new Map),sr(this,"rowHighlights",new Map),sr(this,"columnHighlights",new Map),sr(this,"customSelections",[]),this.options=e,this.focus=A8(e),this.fill=N8(e)}isEnabledFor(e,n){let r=e;e===tp&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Bo(Zi,this,jo).call(this,this.layeredAreas,P8)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Bo(Zi,this,jo).call(this,this.areas,O8)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Bo(Zi,this,jo).call(this,this.rowHeaders,m1)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Bo(Zi,this,jo).call(this,this.columnHeaders,m1)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Bo(Zi,this,jo).call(this,this.activeRowHeaders,Cb)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Bo(Zi,this,jo).call(this,this.activeColumnHeaders,Cb)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Bo(Zi,this,jo).call(this,this.activeCornerHeaders,Cb)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Bo(Zi,this,jo).call(this,this.rowHighlights,D8)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Bo(Zi,this,jo).call(this,this.columnHighlights,x8)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(H8({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),H(this.areas.values(),e=>void e.clear()),H(this.layeredAreas.values(),e=>void e.clear()),H(this.rowHeaders.values(),e=>void e.clear()),H(this.columnHeaders.values(),e=>void e.clear()),H(this.activeRowHeaders.values(),e=>void e.clear()),H(this.activeColumnHeaders.values(),e=>void e.clear()),H(this.activeCornerHeaders.values(),e=>void e.clear()),H(this.rowHighlights.values(),e=>void e.clear()),H(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function jo(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function p1(t,e,n){return(e=W8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W8(t){var e=B8(t,"string");return typeof e=="symbol"?e:e+""}function B8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m_{constructor(e){p1(this,"ranges",[]),p1(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((r,i)=>r.includes(e)&&n(r,i))}findAll(e){const n=[];return this.ranges.forEach((r,i)=>{r.isEqual(e)&&n.push({range:r,layer:i})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(r=>r.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,r)=>!e.includes(r)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new m_(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,r)=>e(n,r)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function j8(t,e){x$(t,e),e.add(t)}function yb(t,e,n){x$(t,e),e.set(t,n)}function x$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(t,e){return t.get(tn(t,e))}function ng(t,e,n){return t.set(tn(t,e),n),n}function tn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rg=new WeakMap,Ct=new WeakMap,ki=new WeakMap,gn=new WeakSet;class NR{constructor(e,n){j8(this,gn),yb(this,rg,void 0),yb(this,Ct,void 0),yb(this,ki,{x:0,y:0}),ng(rg,this,e),ng(Ct,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=qe(Ct,this).createCellCoords(e,n);let o=qe(rg,this).current().highlight;const s=qe(Ct,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=tn(gn,this,A$).call(this),{row:h,col:d}=tn(gn,this,v1).call(this,o),f=qe(Ct,this).fixedRowsBottom(),g=qe(Ct,this).minSpareRows(),w=qe(Ct,this).minSpareCols(),C=qe(Ct,this).autoWrapRow(),S=qe(Ct,this).autoWrapCol(),v=qe(Ct,this).createCellCoords(h+i.row,d+i.col);if(v.row>=c){const x=Fr(r&&g>0&&f===0),_=v.col+1,M=qe(Ct,this).createCellCoords(v.row-c,_>=u?_-u:_);this.runLocalHooks("beforeColumnWrap",x,tn(gn,this,su).call(this,M),_>=u),x.value?this.runLocalHooks("insertRowRequire",qe(Ct,this).countRenderableRows()):S&&v.assign(M)}else if(v.row<0){const x=Fr(S),_=v.col-1,M=qe(Ct,this).createCellCoords(c+v.row,_<0?u+_:_);this.runLocalHooks("beforeColumnWrap",x,tn(gn,this,su).call(this,M),_<0),S&&v.assign(M)}if(v.col>=u){const x=Fr(r&&w>0),_=v.row+1,M=qe(Ct,this).createCellCoords(_>=c?_-c:_,v.col-u);this.runLocalHooks("beforeRowWrap",x,tn(gn,this,su).call(this,M),_>=c),x.value?this.runLocalHooks("insertColRequire",qe(Ct,this).countRenderableColumns()):C&&v.assign(M)}else if(v.col<0){const x=Fr(C),_=v.row-1,M=qe(Ct,this).createCellCoords(_<0?c+_:_,u+v.col);this.runLocalHooks("beforeRowWrap",x,tn(gn,this,su).call(this,M),_<0),C&&v.assign(M)}const{rowDir:E,colDir:P}=tn(gn,this,w1).call(this,v);a=E,l=P,o=tn(gn,this,su).call(this,v)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=qe(Ct,this).createCellCoords(e,n),i=qe(rg,this).current(),o=qe(Ct,this).visualToRenderableCoords(i.highlight),s=tn(gn,this,bb).call(this,i.to.row,i.from.row),a=tn(gn,this,Sb).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=tn(gn,this,v1).call(this,i.highlight),f=qe(Ct,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),w=i.getTopEndCorner(),C=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const P=f.col-d;f.col=tn(gn,this,Sb).call(this,g.col,w.col)+P}else if(r.col>0&&a<=d&&f.col>d){const P=tn(gn,this,Sb).call(this,w.col,g.col),x=Math.max(f.col-P,1);f.col=P+x}if(r.row<0&&s>=h&&f.row<h){const P=f.row-h;f.row=tn(gn,this,bb).call(this,g.row,C.row)+P}else if(r.row>0&&s<=h&&f.row>h){const P=tn(gn,this,bb).call(this,C.row,g.row),x=Math.max(f.row-P,1);f.row=P+x}const{rowDir:S,colDir:v}=tn(gn,this,w1).call(this,f);u=S,c=v;const E=tn(gn,this,su).call(this,f);r.row===0&&r.col!==0?l.col=E.col:r.row!==0&&r.col===0?l.row=E.row:(l.row=E.row,l.col=E.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;ng(ki,this,{x:n,y:r})}resetOffsetSize(){ng(ki,this,{x:0,y:0})}}function w1(t){const{width:e,height:n}=tn(gn,this,A$).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function A$(){return{width:qe(ki,this).x+qe(Ct,this).countRenderableColumns(),height:qe(ki,this).y+qe(Ct,this).countRenderableRows()}}function bb(t,e){const n=qe(Ct,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:qe(ki,this).y+n}function Sb(t,e){const n=qe(Ct,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:qe(ki,this).x+n}function v1(t){const{row:e,col:n}=qe(Ct,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return qe(Ct,this).createCellCoords(qe(ki,this).y+e,qe(ki,this).x+n)}function su(t){const e=t.clone();return e.col=t.col-qe(ki,this).x,e.row=t.row-qe(ki,this).y,qe(Ct,this).renderableToVisualCoords(e)}ft(NR,Tn);const Rw=0,Ew=1,H$=2,p_=3,U8=[p_,H$],z8=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Rb=Symbol("root"),C1=Symbol("child");function pc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rb;if(e!==Rb&&e!==C1)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Rb;let i=Rw;if(n){const o=t[0];t.length===0?i=Ew:r&&o instanceof hf?i=p_:r&&Array.isArray(o)?i=pc(o,C1):t.length>=2&&t.length<=4&&!t.some((a,l)=>!z8[l].includes(typeof a))&&(i=H$)}return i}function Dd(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!U8.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===p_;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Pt(u)&&(u=a),Pt(c)&&(c=l),!r){const f=a,g=l,w=u,C=c;a=Math.min(f,w),l=Math.min(g,C),u=Math.max(f,w),c=Math.max(g,C)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function Y8(t){const e=pc(t.getSelected());if(e===Rw||e===Ew)return[];const n=Dd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;H(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;H(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Er(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function G8(t){const e=pc(t.getSelected());if(e===Rw||e===Ew)return[];const n=Dd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;H(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;H(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Er(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function au(t,e,n){q8(t,e),e.set(t,n)}function q8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ia(t,e,n){return(e=K8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K8(t){var e=X8(t,"string");return typeof e=="symbol"?e:e+""}function X8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function St(t,e){return t.get(N$(t,e))}function Ji(t,e,n){return t.set(N$(t,e),n),n}function N$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var In=new WeakMap,Pa=new WeakMap,ig=new WeakMap,dh=new WeakMap,og=new WeakMap,fh=new WeakMap;class D${constructor(e,n){var r=this;Ia(this,"settings",void 0),Ia(this,"tableProps",void 0),Ia(this,"inProgress",!1),Ia(this,"selectedRange",new m_((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Ia(this,"highlight",void 0),au(this,In,void 0),au(this,Pa,void 0),Ia(this,"selectedByRowHeader",new Set),Ia(this,"selectedByColumnHeader",new Set),au(this,ig,!1),au(this,dh,!1),au(this,og,"unknown"),au(this,fh,-1),this.settings=e,this.tableProps=n,this.highlight=new V8({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[g0()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),Ji(In,this,new NR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Ji(Pa,this,new NR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),St(In,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),St(In,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),St(In,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),St(In,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),St(In,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),St(In,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),St(In,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),St(In,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),St(Pa,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),St(Pa,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Ji(og,this,e)}markEndSource(){Ji(og,this,"unknown")}getSelectionSource(){return St(og,this)}setExpectedLayers(e){Ji(fh,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Ji(fh,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Pt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Ji(ig,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Pt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=St(fh,this)===-1||this.selectedRange.size()===St(fh,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(H(this.highlight.getAreas(),g=>void g.clear()),H(this.highlight.getLayeredAreas(),g=>void g.clear()),H(this.highlight.getRowHeaders(),g=>void g.clear()),H(this.highlight.getColumnHeaders(),g=>void g.clear()),H(this.highlight.getActiveRowHeaders(),g=>void g.clear()),H(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),H(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),H(this.highlight.getRowHighlights(),g=>void g.clear()),H(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(A0,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(x0,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),S=this.tableProps.createCellCoords(e.to.row,-1),v=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),E=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(v).commit(),d.add(C).commit(),f.add(v).commit()):(a.add(C).add(S).commit(),l.add(v).add(E).commit(),d.add(C).add(S).commit(),f.add(v).add(E).commit())}const g=!St(dh,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),w=!St(dh,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),w&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&w&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(tp,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(Ji(ig,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?St(In,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):St(In,this).resetOffsetSize(),this.setRangeStart(St(In,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?St(In,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):St(In,this).resetOffsetSize(),this.setRangeEnd(St(In,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?St(Pa,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):St(Pa,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=St(Pa,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(ze(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(ze(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(ze(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,ze(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,ze(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,ze(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const n=Fr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&St(ig,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;Ji(dh,this,f),d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(ze(d.row,u,o-1),ze(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),w=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.finish(),Ji(dh,this,!1)}selectCells(e){var n=this;const r=pc(e);if(r===Ew)return!1;if(r===Rw)throw new Error(it`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Dd(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),H(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(f=ze(r.row,u,s-1),g=ze(r.col,Math.min(i,o),Math.max(i,o))):(f=ze(r,u,s-1),g=i);const w=this.tableProps.createCellCoords(f,g),C=l===0?0:ze(w.row,u,-1),S=s-1,v=this.tableProps.createCellCoords(C,i),E=this.tableProps.createCellCoords(S,o);this.runLocalHooks("beforeSelectColumns",v,E,w),v.row=C,E.row=S,this.setRangeStartOnly(v,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",v,E,w),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(h=ze(r.row,Math.min(e,n),Math.max(e,n)),d=ze(r.col,a,o-1)):(h=e,d=ze(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:ze(f.col,a,-1),w=o-1,C=this.tableProps.createCellCoords(e,g),S=this.tableProps.createCellCoords(n,w);this.runLocalHooks("beforeSelectRows",C,S,f),C.col=g,S.col=w,this.setRangeStartOnly(C,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectRows",C,S,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(r.length),r.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=n-1;u.assign({row:ze(u.row,this.settings.navigableHeaders?-1/0:0,c),col:ze(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:ze(a.row,-1/0,c),col:ze(a.col,-1/0,h)}),l.assign({row:ze(l.row,-1/0,c),col:ze(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(tp,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}ft(D$,Tn);const y1=/^(\r\n|\n\r|\r|\n)/,Z8=/^[^\t\r\n]+/,b1=/^\t/;function J8(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(b1))t=t.replace(b1,""),n+=1,e[r][n]="";else if(t.match(y1))t=t.replace(y1,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(Z8);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function sd(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Oa(t,e,n){return(e=Q8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q8(t){var e=e5(t,"string");return typeof e=="symbol"?e:e+""}function e5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){Oa(this,"hot",void 0),Oa(this,"metaManager",void 0),Oa(this,"tableMeta",void 0),Oa(this,"dataSource",void 0),Oa(this,"duckSchema",void 0),Oa(this,"colToPropCache",void 0),Oa(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=p0(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Ne(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return w$(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&De(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ue(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ue(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?xd(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=er(this.getSchema()):(g=[],de(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},hw(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,n,r)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let f=0;for(let g=d;f<n&&l+f<s;g++){if(typeof c!="number"||c>=l+f)if(u>0)for(let w=0;w<u;w+=1)typeof o[w]>"u"&&(o[w]=[]),o[w].push(null);else o.push([null]);else for(let w=0;w<u;w++)o[w].splice(g,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(c,f,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ue(this.tableMeta.columns)||ue(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Mx(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return MK(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Mx(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&rn(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Fr(a);this.hot.runHooks("modifyData",e,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Fr(o);this.hot.runHooks("modifyData",e,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&rn(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,qu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===qu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return sd(this.getRange(e,n,qu.DESTINATION_RENDERER))}getCopyableText(e,n){return sd(this.getRange(e,n,qu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:t5,getItem:n5,hasItem:k$,getNames:ape,getValues:lpe}=gi("cellTypes");function r5(t){if(!k$(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return n5(t)}function Ti(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Or(t,n),r&&Kr(t,r),i&&Fu(t,i),t5(t,e)}function i5(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!rn(e,t)}function Tw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?r5(e.type):e.type;if(t._automaticallyAssignedMetaProps&&De(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Ne(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};De(r,(o,s)=>{if(i5(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),sn(t,i)}function o5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}s3(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Rm(t){return Number.isInteger(t)&&t>=0}function Em(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function sg(t){return t==null}const L$=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),jt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),jt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),m0(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function S1(t,e,n){return(e=s5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s5(t){var e=a5(t,"string");return typeof e=="symbol"?e:e+""}function a5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function l5(){return class{}}class u5{constructor(e){S1(this,"metaCtor",l5()),S1(this,"meta",void 0),this.meta=this.metaCtor.prototype,sn(this.meta,L$()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;sn(this.meta,e),Tw(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function c5(t,e,n){return(e=h5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h5(t){var e=d5(t,"string");return typeof e=="symbol"?e:e+""}function d5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f5{constructor(e){c5(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){sn(this.meta,e),Tw(this.meta,e,e)}}function ag(t,e,n){return(e=g5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g5(t){var e=m5(t,"string");return typeof e=="symbol"?e:e+""}function m5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ip{constructor(e){ag(this,"valueFactory",void 0),ag(this,"data",[]),ag(this,"index",[]),ag(this,"holes",new Set),this.valueFactory=e}obtain(e){Em(()=>Rm(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Em(()=>Rm(e)||sg(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=sg(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Em(()=>Rm(e)||sg(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(sg(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function R1(t,e,n){return(e=p5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p5(t){var e=w5(t,"string");return typeof e=="symbol"?e:e+""}function w5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const v5=["data","width"];class C5{constructor(e){R1(this,"globalMeta",void 0),R1(this,"metas",new ip(()=>this._createMeta())),this.globalMeta=e,this.metas=new ip(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);sn(r,n),Tw(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return o5(this.globalMeta.getMetaConstructor(),v5).prototype}}function E1(t,e,n){return(e=y5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y5(t){var e=b5(t,"string");return typeof e=="symbol"?e:e+""}function b5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S5{constructor(e){E1(this,"columnMeta",void 0),E1(this,"metas",new ip(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);sn(i,r),Tw(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)ue(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Em(()=>Rm(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new ip(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class $${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new u5(e),this.tableMeta=new f5(this.globalMeta),this.columnMeta=new C5(this.globalMeta),this.cellMeta=new S5(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ft($$,Tn);function T1(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Vi(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":at(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new qu(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let w,C=0,S=0;for(C=0,S=d.startRows;C<S;C++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)w=er(g),t.push(w);else if(i.dataType==="array")w=er(g[0]),t.push(w);else{w=[];for(let v=0,E=d.startCols;v<E;v++)w.push(null);t.push(w)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&ye(i.rootElement,[wL(-1),cw(i.countCols()+(i.view?i.countRowHeaders():0))])}function _1(t,e,n){return(e=R5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R5(t){var e=E5(t,"string");return typeof e=="symbol"?e:e+""}function E5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T5{constructor(e){var n=this;_1(this,"metaManager",void 0),_1(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),ie.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=rn(e,"type")?e.type:null;let c=at(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function _5(t,e,n){M5(t,e),e.set(t,n)}function M5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eb(t,e,n){return(e=I5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I5(t){var e=P5(t,"string");return typeof e=="symbol"?e:e+""}function P5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function O5(t,e){return t.get(x5(t,e))}function x5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var M1=new WeakMap;class A5{constructor(e){Eb(this,"metaManager",void 0),Eb(this,"usageTracker",new Set),Eb(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),_5(this,M1,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,O5(M1,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const F$="gridDefault",ya="editorManager.handlingEditor",H5={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},N5="hooksRefRegisterer",V$={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){H(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){De(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Rs(V$,"MIXIN_NAME",N5,{writable:!1,enumerable:!1});function yi(t,e,n){return(e=D5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D5(t){var e=k5(t,"string");return typeof e=="symbol"?e:e+""}function k5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const L5="base",Wt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Nc{static get EDITOR_TYPE(){return L5}constructor(e){yi(this,"hot",void 0),yi(this,"state",Wt.VIRGIN),yi(this,"_opened",!1),yi(this,"_fullEditMode",!1),yi(this,"_closeCallback",null),yi(this,"TD",null),yi(this,"row",null),yi(this,"col",null),yi(this,"prop",null),yi(this,"originalValue",null),yi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Wt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Wt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Wt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Ot(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Wt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Wt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Wt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Wt.FINISHED,this.discardEditor(s)}):(this.state=Wt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Wt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Wt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Wt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Wt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Wt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=kn(n),a=qt(n),l=kn(this.hot.rootElement),u=qt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:w}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,C=w.name,S=["master","inline_start"].includes(C)?d:0,v=["master","top","bottom"].includes(C)?f:0,E=s.top===l.top?0:1;let P=s.top-l.top-E-S,x=0;this.hot.isRtl()?x=o.innerWidth-s.left-a-g-1+v:x=s.left-l.left-1-v,["top","top_inline_start_corner"].includes(C)&&(P+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(x+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const _=this.hot.hasColHeaders(),M=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),V=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),O=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(_&&M<=0||M===O)&&(P+=1),V<=0&&(x+=1);const G=i.rowsRenderCalculator.startPosition,Z=i.columnsRenderCalculator.startPosition,ae=Math.abs(r.inlineStartOverlay.getScrollPosition()),te=r.topOverlay.getScrollPosition(),ne=Sn(this.hot.rootDocument);let Fe=n.offsetTop;if(["inline_start","master"].includes(C)&&(Fe+=G-te),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:j,wtTable:K}=r.bottomOverlay.clone;Fe+=j.getWorkspaceHeight()-K.getHeight()-ne}let ke=n.offsetLeft;this.hot.isRtl()?(ke>=0?ke=w.getWidth()-n.offsetLeft:ke=Math.abs(ke),ke+=Z-ae-a):["top","master","bottom"].includes(C)&&(ke+=Z-ae);const Ve=o.getComputedStyle(this.TD),yt=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",ot=parseInt(Ve[yt],10)>0?0:1,ut=parseInt(Ve.borderTopWidth,10)>0?0:1,wn=qt(n)+ot,m=on(n)+ut,p=AL(c)?ne:0,b=HL(h)?ne:0,D=this.hot.view.maximumVisibleElementWidth(ke)-p+ot,F=Math.max(this.hot.view.maximumVisibleElementHeight(Fe)-b+ut,this.hot.stylesHandler.getDefaultRowHeight());return{top:P,start:x,height:m,maxHeight:F,width:wn,maxWidth:D}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}ft(Nc,V$);const $5={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Wt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},F5={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},V5={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},W5={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},B5={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),zi(e))}};function j5(){return[H5,$5,F5,V5,W5,B5]}const U5={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},z5={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},Y5={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},G5={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},q5={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},K5={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},X5={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},Z5={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},J5={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Q5={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},e7={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},t7={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},n7={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},r7={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function i7(){return[U5,z5,Y5,G5,q5,K5,X5,Z5,J5,Q5,e7,t7,n7,r7]}const o7={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},s7={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},a7={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},l7={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},u7={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},c7={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},h7={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},d7={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},f7={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},g7={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},m7={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},p7={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},w7={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},v7={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},C7={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},y7={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function b7(){return[o7,s7,a7,l7,u7,c7,h7,d7,f7,g7,m7,p7,w7,v7,C7,y7]}const S7={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},R7={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},E7={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},T7={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},_7={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},M7=[...j5(),...i7(),...b7(),S7,R7,E7,T7,_7];function W$(t){const e={};return M7.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function I7(t){const e=t.getShortcutManager().addContext("editor"),n=W$(t),r={group:ya};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function P7(t){const e=t.getShortcutManager().addContext("grid"),n=W$(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ue(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:F$};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:ya,runOnlyIf:()=>ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function O7(t){[P7,I7].forEach(e=>e(t))}function x7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=I1(t),i=I1(t);return r.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),n.before(r),n.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function I1(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&ye(n,[dc("Focus catcher")]),n}function A7(t){const e=H7(t);let n;const{activate:r,deactivate:i}=x7(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:DR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:kR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,w)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,w.value=!0),s){var C;n=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:F$,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?DR(t):kR(t)),u(),!1;h.preventDefault()},position:"after"}])}function DR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function kR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function H7(t){return e=>{if(!e)return null;const n=DR(t),r=kR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function Dc(t){ms(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function _w(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,w=f<=h,C=g>=d;return{getComputedColumnTarget(S){return i==="mouse"||i==="keyboard"?S.col:u&&c?r.highlight.col:u?a:c?l:S.col},getComputedRowTarget(S){return i==="mouse"||i==="keyboard"?S.row:w&&C?r.highlight.row:w?f:C?g:S.row}}}function N7(t){return e=>{const n=_w(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;Dc(t.getCell(r?-1:0,n,!0))})}}function D7(){return()=>{}}function k7(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;Dc(t.getCell(n,r,!0))})}}function L7(t){return e=>{const n=_w(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Dc(t.getCell(i,o,!0))})}}function $7(t){return e=>{const n=_w(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Dc(t.getCell(i,o,!0))})}}function F7(t){return e=>{const n=_w(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;Dc(t.getCell(n,r?-1:0,!0))})}}function V7(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{Dc(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function W7(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=k7(t):e.isSelectedByCorner()?s=D7():e.isSelectedByRowHeader()?s=F7(t):e.isSelectedByColumnHeader()?s=N7(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=L7(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=V7(t):e.getSelectedRange().size()>1&&(s=$7(t)),(o=s)===null||o===void 0||o(i)}}}const P1=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),lg=t=>t.map(e=>{const n=e.toLowerCase();return P1.has(n)?P1.get(n):n}).sort().join("+"),B7=t=>t.split("+"),O1=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Tb=t=>{let{which:e,key:n}=t;if(O1.has(e))return O1.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},B$=Symbol("shortcut-context");function j$(t){return Ne(t)&&t.__kindOf===B$}const j7=t=>{const e=pw({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:w,position:C,forwardToContext:S}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Pt(c))throw new Error("You need to define the shortcut's group.");if(at(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(it`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const v={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};ue(w)&&(v.relativeToGroup=w,v.position=C),j$(S)&&(v.forwardToContext=S),l.forEach(E=>{const P=lg(E);if(e.hasItem(P)){const _=e.getItem(P);let M=_.findIndex(V=>V.group===w);M!==-1?C==="before"?M-=1:M+=1:M=_.length,_.splice(M,0,v)}else e.addItem(P,[v])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{De(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=lg(l);e.removeItem(u)};return{__kindOf:B$,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=lg(l),c=e.getItem(u);return ue(c)?c.slice():[]},hasShortcut:l=>{const u=lg(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(B7(h)):(d.length=0,d.push(...f))})}}};function U7(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const z7=["meta","alt","shift","control"],gh=U7(),mh=[];let ug=0;function Y7(t,e,n,r,i){const o=f=>z7.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=[];return f.altKey&&w.push("alt"),g&&(f.ctrlKey||f.metaKey)?w.push("control/meta"):(f.ctrlKey&&w.push("control"),f.metaKey&&w.push("meta")),f.shiftKey&&w.push("shift"),w},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||ul(f))return;const w=Tb(f);let C=[];o(w)||(C=s(f));const S=[w].concat(C);!i(f,S)&&(Vx()&&C.includes("meta")||!Vx()&&C.includes("control"))&&i(f,[w].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=Tb(f);o(g)&&gh.press(g)}},u=f=>{if(typeof f.key=="string"){const g=Tb(f);o(g)&&gh.release(g)}},c=()=>{gh.releaseAll()};return{mount:()=>{let f=t;for(ug+=1;f;)ug===1&&(f.document.documentElement.addEventListener("keydown",l),mh.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),mh.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=fc(f)},unmount:()=>{let f=t;for(ug-=1;f;){if(ug===0){for(let g=0;g<mh.length;g++){const{event:w,listener:C}=mh[g];f.document.documentElement.removeEventListener(w,C)}mh.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=fc(f)}},isPressed:f=>gh.isPressed(f),releasePressedKeys:()=>gh.releaseAll()}}const G7=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=pw({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const w=j7(g);return o.addItem(g,w),w},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(it`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,w){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const S=j$(C)?C:u(C);let v=!1;if(!S.hasShortcut(w))return v;const E=S.getShortcuts(w);for(let P=0;P<E.length;P++){const{callback:x,runOnlyIf:_,preventDefault:M,stopPropagation:V,captureCtrl:z,forwardToContext:O}=E[P];if(_(g)===!0){if(h=z,v=x(g,w)===!1,h=!1,M&&g.preventDefault(),V&&(zi(g),g.stopPropagation()),v)break;O&&d(g,w,O)}}return v},f=Y7(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function x1(t){const{classNames:e}=w3(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function q7(t,e){U$(t,e),e.add(t)}function xa(t,e,n){U$(t,e),e.set(t,n)}function U$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nn(t,e){return t.get(Ai(t,e))}function Jr(t,e,n){return t.set(Ai(t,e),n),n}function Ai(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const A1=23;var Aa=new WeakMap,op=new WeakMap,w_=new WeakMap,LR=new WeakMap,Us=new WeakMap,Zh=new WeakMap,kd=new WeakMap,go=new WeakSet;class K7{constructor(e,n){q7(this,go),xa(this,Aa,void 0),xa(this,op,void 0),xa(this,w_,void 0),xa(this,LR,void 0),xa(this,Us,!0),xa(this,Zh,{}),xa(this,kd,{}),Jr(op,this,e),Jr(LR,this,n)}isClassicTheme(){return Nn(Us,this)}getCSSVariableValue(e){var n;if(Nn(Us,this))return null;if(Nn(Zh,this)[`--ht-${e}`])return Nn(Zh,this)[`--ht-${e}`];const r=(n=Ai(go,this,J7).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Ai(go,this,z$).call(this,`--ht-${e}`);if(r!==null)return Nn(Zh,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=Nn(kd,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Nn(Us,this))return A1;const e=Ai(go,this,X7).call(this);return e||A1}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Jr(Aa,this,void 0),Jr(Us,this,!0),Ai(go,this,_b).call(this);return}if(e&&e!==Nn(Aa,this)){if(!/ht-theme-.*/.test(e)){Ze(`Invalid theme name: ${e}. Please provide a valid theme name.`),Jr(Aa,this,void 0),Jr(Us,this,!1),Ai(go,this,_b).call(this);return}Nn(Aa,this)&&Ai(go,this,Q7).call(this),Jr(Aa,this,e),Jr(Us,this,!1),Ai(go,this,_b).call(this)}}getThemeName(){return Nn(Aa,this)}}function X7(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function _b(){this.isClassicTheme()||Jr(w_,this,getComputedStyle(Nn(op,this)));const t=Ai(go,this,Z7).call(this,["box-sizing","border-bottom-width"]);Nn(kd,this).td={...Nn(kd,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function Z7(t){const e=Nn(LR,this),n=Nn(op,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function J7(t){const e=Math.ceil(parseFloat(Ai(go,this,z$).call(this,t)));return Number.isNaN(e)?null:e}function z$(t){const e=Nn(w_,this).getPropertyValue(t);return e===""?null:e}function Q7(){Jr(kd,this,{}),Jr(Zh,this,{}),Jr(Us,this,!0)}function eZ(t,e){Y$(t,e),e.add(t)}function H1(t,e,n){Y$(t,e),e.set(t,n)}function Y$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function N1(t,e){return t.get(wc(t,e))}function D1(t,e,n){return t.set(wc(t,e),n),n}function wc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $R=new WeakMap,FR=new WeakMap,ad=new WeakSet;class tZ{constructor(e){let{rowIndexMapper:n,columnIndexMapper:r}=e;eZ(this,ad),H1(this,$R,void 0),H1(this,FR,void 0),D1($R,this,n),D1(FR,this,r)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,i=wc(ad,this,k1).call(this,e.from,n,r);if(i===null)return null;const o=wc(ad,this,k1).call(this,e.to,-n,-r);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function k1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const r=wc(ad,this,L1).call(this,N1($R,this),t.row,e);if(r===null)return null;const i=wc(ad,this,L1).call(this,N1(FR,this),t.col,n);return i===null?null:t.clone().assign({row:r,col:i})}function L1(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}let Mb=null;const Ib=new Map;function G$(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Wi(o);let a,l,u,c,h,d,f=!0;M9(i)&&_9(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=Vu(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Vu(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),X(this.rootElement,"ht-wrapper"),X(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),X(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e?.layoutDirection)!==null&&n!==void 0?n:"inherit",w=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return w==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new K7(o.rootElement,o.rootDocument),e.language=T8(e.language);const C=Object.fromEntries(Object.entries(e).filter(m=>{let[p]=m;return!(ie.getSingleton().isRegistered(p)||ie.getSingleton().isDeprecated(p))})),S=new $$(o,C,[T5,A5]),v=S.getTableMeta(),E=S.getGlobalMeta(),P=pw();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),Vu(this)&&AK(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${cL()}`,Ib.set(this.guid,this),this.columnIndexMapper=new AR,this.rowIndexMapper=new AR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new B9(o);const x=gi(this.guid);x.register("cellRangeMapper",new tZ({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const _=m=>{const{row:p,col:b}=m;return o._createCellCoords(p>=0?o.rowIndexMapper.getRenderableFromVisualIndex(p):p,b>=0?o.columnIndexMapper.getRenderableFromVisualIndex(b):b)},M=m=>{const{row:p,col:b}=m;return o._createCellCoords(p>=0?o.rowIndexMapper.getVisualFromRenderableIndex(p):p,b>=0?o.columnIndexMapper.getVisualFromRenderableIndex(b):b)},V=(m,p)=>{const b=p>m?1:-1,D=Math.min(m,p),F=Math.max(m,p),j=o.rowIndexMapper.getNearestNotHiddenIndex(m,b);return j===null||b===1&&j>F||b===-1&&j<D?null:j>=0?o.rowIndexMapper.getRenderableFromVisualIndex(j):j},z=(m,p)=>{const b=p>m?1:-1,D=Math.min(m,p),F=Math.max(m,p),j=o.columnIndexMapper.getNearestNotHiddenIndex(m,b);return j===null||b===1&&j>F||b===-1&&j<D?null:j>=0?o.columnIndexMapper.getRenderableFromVisualIndex(j):j};let O=new D$(v,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,p)=>o._createCellCoords(m,p),createCellRange:(m,p,b)=>o._createCellRange(m,p,b),visualToRenderableCoords:_,renderableToVisualCoords:M,findFirstNonHiddenRenderableRow:V,findFirstNonHiddenRenderableColumn:z,isDisabledCellSelection:(m,p)=>m<0||p<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,p).disableVisualSelection});this.selection=O;const G=m=>{let{hiddenIndexesChanged:p}=m;this.forceFullRender=!0,p&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",G),this.rowIndexMapper.addLocalHook("cacheUpdated",G),this.selection.addLocalHook("afterSetRangeEnd",(m,p)=>{const b=Fr(!1),D=this.selection.getSelectedRange(),{from:F,to:j}=D.current(),K=D.size()-1;this.runHooks("afterSelection",F.row,F.col,j.row,j.col,b,K),this.runHooks("afterSelectionByProp",F.row,o.colToProp(F.col),j.row,o.colToProp(j.col),b,K),p&&(!b.isTouched()||b.isTouched()&&!b.value)&&d.scrollTo(m);const y=O.isSelectedByRowHeader(),R=O.isSelectedByColumnHeader();y&&R?X(this.rootElement,["ht__selection--rows","ht__selection--columns"]):y?(ve(this.rootElement,"ht__selection--columns"),X(this.rootElement,"ht__selection--rows")):R?(ve(this.rootElement,"ht__selection--rows"),X(this.rootElement,"ht__selection--columns")):ve(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(O.getSelectionSource())||c.closeEditor(null),O.getSelectionSource()!=="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const p=Fr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,p),(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const p=m.length-1,{from:b,to:D}=m[p];this.runHooks("afterSelectionEnd",b.row,b.col,D.row,D.col,p),this.runHooks("afterSelectionEndByProp",b.row,o.colToProp(b.col),D.row,o.colToProp(D.col),p),O.getSelectionSource()==="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const p=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=p)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),ve(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSetRangeStart",...p)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSetRangeStartOnly",...p)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSetRangeEnd",...p)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSelectColumns",...p)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterSelectColumns",...p)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSelectRows",...p)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterSelectRows",...p)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("modifyTransformStart",...p)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterModifyTransformStart",...p)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("modifyTransformFocus",...p)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterModifyTransformFocus",...p)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("modifyTransformEnd",...p)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterModifyTransformEnd",...p)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeRowWrap",...p)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeColumnWrap",...p)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,p){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3?arguments[3]:void 0,F=arguments.length>4?arguments[4]:void 0;const j=K=>{if(K.length===0)return[];const y=[...K];return y.sort((T,I)=>{let[A]=T,[L]=I;return A===L?0:A>L?1:-1}),Er(y,(T,I)=>{let[A,L]=I;const B=T[T.length-1],[N,$]=B,W=N+$;if(A<=W){const U=Math.max(L-(W-A),0);B[1]+=U}else T.push([A,L]);return T},[y[0]])};switch(m){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(v.maxRows===K)return;const y=m==="insert_row_below"?"below":"above";p=p??(y==="below"?K:0);const{delta:R,startPhysicalIndex:T}=a.createRow(p,b,{source:D,mode:y});O.shiftRows(o.toVisualRow(T),R);break;case"insert_col_start":case"insert_col_end":const I=m==="insert_col_end"?"end":"start";p=p??(I==="end"?o.countSourceCols():0);const{delta:A,startPhysicalIndex:L}=a.createCol(p,b,{source:D,mode:I});if(A){if(Array.isArray(v.colHeaders)){const $=[o.toVisualColumn(L),0];$.length+=A,Array.prototype.splice.apply(v.colHeaders,$)}O.shiftColumns(o.toVisualColumn(L),A)}break;case"remove_row":const B=$=>{let W=0;H($,U=>{let[q,se]=U;const le=jt(q)?o.countRows()-1:Math.max(q-W,0);if(Number.isInteger(q)&&(q=Math.max(q-W,0)),!a.removeRow(q,se,D))return;if(O.isSelected()){const{row:Se}=o.getSelectedRangeLast().highlight;Se>=q&&Se<=q+se-1&&c.closeEditor(!0)}const We=o.countRows(),Be=v.fixedRowsTop;Be>=le+1&&(v.fixedRowsTop-=Math.min(se,Be-le));const Ee=v.fixedRowsBottom;if(Ee&&le>=We-Ee&&(v.fixedRowsBottom-=Math.min(se,Ee)),We===0)O.deselect();else if(D==="ContextMenu.removeRow"){const Se=O.getSelectedRange(),nt=Se.pop();Se.clear().set(nt.from).current().setTo(nt.to),O.refresh()}else O.shiftRows(q,-se);W+=se})};Array.isArray(p)?B(j(p)):B([[p,b]]);break;case"remove_col":const N=$=>{let W=0;H($,U=>{let[q,se]=U;const le=jt(q)?o.countCols()-1:Math.max(q-W,0);let Re=o.toPhysicalColumn(le);if(Number.isInteger(q)&&(q=Math.max(q-W,0)),!a.removeCol(q,se,D))return;if(O.isSelected()){const{col:Se}=o.getSelectedRangeLast().highlight;Se>=q&&Se<=q+se-1&&c.closeEditor(!0)}if(o.countCols()===0)O.deselect();else if(D==="ContextMenu.removeColumn"){const Se=O.getSelectedRange(),nt=Se.pop();Se.clear().set(nt.from).current().setTo(nt.to),O.refresh()}else O.shiftColumns(q,-se);const Ee=v.fixedColumnsStart;Ee>=le+1&&(v.fixedColumnsStart-=Math.min(se,Ee-le)),Array.isArray(v.colHeaders)&&(typeof Re>"u"&&(Re=-1),v.colHeaders.splice(Re,se)),W+=se})};Array.isArray(p)?N(j(p)):N([[p,b]]);break;default:throw new Error(`There is no such action "${m}"`)}F||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=v.minRows,p=v.minSpareRows,b=v.minCols,D=v.minSpareCols;if(m){const F=o.countRows();F<m&&a.createRow(F,m-F,{source:"auto"})}if(p){const F=o.countEmptyRows(!0);if(F<p){const j=p-F,K=Math.min(j,v.maxRows-o.countSourceRows());a.createRow(o.countRows(),K,{source:"auto"})}}{let F;(b||D)&&(F=o.countEmptyCols(!0));let j=o.countCols();if(b&&!v.columns&&j<b){const K=b-j;F+=K,a.createCol(j,K,{source:"auto"})}if(D&&!v.columns&&o.dataType==="array"&&F<D){j=o.countCols();const K=D-F,y=Math.min(K,v.maxCols-j);a.createCol(j,y,{source:"auto"})}}},populateFromArray(m,p,b,D,F){let j,K,y,R;const T=[],I={},A=[],L=m.row,B=m.col;if(K=p.length,K===0)return!1;let N=0,$=0;switch(Ne(b)&&(N=b.col-B+1,$=b.row-L+1),F){case"shift_down":const W=ym(p),U=W.length,q=Math.max(U,N),se=o.getData().slice(L),le=ym(se).slice(B,B+q);for(y=0;y<q;y+=1)if(y<U){for(j=0,K=W[y].length;j<$-K;j+=1)W[y].push(W[y][j%K]);y<le.length?A.push(W[y].concat(le[y])):A.push(W[y].concat(new Array(se.length).fill(null)))}else A.push(W[y%U].concat(le[y]));o.populateFromArray(L,B,ym(A));break;case"shift_right":const Re=p.length,We=Math.max(Re,$),Be=o.getData().slice(L).map(bt=>bt.slice(B));for(j=0;j<We;j+=1)if(j<Re){for(y=0,R=p[j].length;y<N-R;y+=1)p[j].push(p[j][y%R]);if(j<Be.length)for(let bt=0;bt<Be[j].length;bt+=1)p[j].push(Be[j][bt]);else p[j].push(...new Array(Be[0].length).fill(null))}else p.push(p[j%K].slice(0,We).concat(Be[j]));o.populateFromArray(L,B,p);break;case"overwrite":default:I.row=m.row,I.col=m.col;let Ee=0,Se=0,nt=!0,nr;const No=function(_t){let wt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Qe=p[_t%p.length];return wt!==null?Qe[wt%Qe.length]:Qe},pi=p.length,hn=b?b.row-m.row+1:0;for(b?K=hn:K=Math.max(pi,hn),j=0;j<K&&!(b&&I.row>b.row&&hn>pi||!v.allowInsertRow&&I.row>o.countRows()-1||I.row>=v.maxRows);j++){const bt=j-Ee,_t=No(bt).length,wt=b?b.col-m.col+1:0;if(b?R=wt:R=Math.max(_t,wt),I.col=m.col,nr=o.getCellMeta(I.row,I.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&nr.skipRowOnPaste){Ee+=1,I.row+=1,K+=1;continue}for(Se=0,y=0;y<R&&!(b&&I.col>b.col&&wt>_t||!v.allowInsertColumn&&I.col>o.countCols()-1||I.col>=v.maxCols);y++){if(nr=o.getCellMeta(I.row,I.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&nr.skipColumnOnPaste){Se+=1,I.col+=1,R+=1;continue}if(nr.readOnly&&D!=="UndoRedo.undo"){I.col+=1;continue}const Qe=y-Se;let Br=No(bt,Qe),Wn=o.getDataAtCell(I.row,I.col);if(Br!==null&&typeof Br=="object")if(Array.isArray(Br)&&Wn===null&&(Wn=[]),Wn===null||typeof Wn!="object")nt=!1;else{const ba=xd(Array.isArray(Wn)?Wn:Wn[0]||Wn),Mf=xd(Array.isArray(Br)?Br:Br[0]||Br);m0(ba,Mf)||Array.isArray(ba)&&Array.isArray(Mf)?Br=er(Br):nt=!1}else Wn!==null&&typeof Wn=="object"&&(nt=!1);nt&&T.push([I.row,I.col,Br]),nt=!0,I.col+=1}I.row+=1}o.setDataAtCell(T,null,null,D||"populateFromArray");break}}};function Z(m){const p=R$(m);g_(p)?(o.runHooks("beforeLanguageChange",p),E.language=p,o.runHooks("afterLanguageChange",p)):E$(m)}function ae(m,p){const b=m==="className"?o.rootElement:o.table;if(f)X(b,p);else{let D=[],F=[];E[m]&&(D=Array.isArray(E[m])?E[m]:Px(E[m])),p&&(F=Array.isArray(p)?p:Px(p));const j=Ix(D,F),K=Ix(F,D);j.length&&ve(b,j),K.length&&X(b,K)}E[m]=p}this.init=function(){l.setData(v.data),o.runHooks("beforeInit"),(Eo()||RL())&&X(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new x9(this);const m=v.themeName||x1(o.rootContainer);o.useTheme(m),c=IR.getInstance(o,v,O),d=W7(o),h=new oX(o),Vu(this)&&A7(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&T3(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function te(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function ne(m){const p=m.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):m}function Fe(m,p,b){if(!m.length){b();return}const D=o.getActiveEditor(),F=new te;let j=!0;F.onQueueEmpty=()=>{D&&j&&D.cancelChanges(),b()};for(let K=m.length-1;K>=0;K--){const[y,R]=m[K],T=a.propToCol(R);let I;Number.isInteger(T)?I=o.getCellMeta(y,T):I={...Object.getPrototypeOf(v),...v},o.getCellValidator(I)&&(F.addValidatorToQueue(),o.validateCell(m[K][3],I,function(A,L){return function(B){if(typeof B!="boolean")throw new Error("Validation error: result is not boolean");B===!1&&L.allowInvalid===!1&&(j=!1,m.splice(A,1),L.valid=!0),F.removeValidatorFormQueue()}}(K,I),p))}F.checkIfQueueIsEmpty()}function ke(m,p){for(let D=m.length-1;D>=0;D--){let F=!1;if(m[D]===null){m.splice(D,1);continue}if(!((m[D][2]===null||m[D][2]===void 0)&&(m[D][3]===null||m[D][3]===void 0))){if(v.allowInsertRow)for(;m[D][0]>o.countRows()-1;){const{delta:j}=a.createRow(void 0,void 0,{source:"auto"});if(j===0){F=!0;break}}if(o.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;a.propToCol(m[D][1])>o.countCols()-1;){const{delta:j}=a.createCol(void 0,void 0,{source:"auto"});if(j===0){F=!0;break}}F||a.set(m[D][0],m[D][1],m[D][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,p),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,p||"edit");const D=o.getActiveEditor();D&&ue(D.refreshValue)&&D.refreshValue()}else o.render()}this._createCellCoords=function(m,p){return o.view._wt.createCellCoords(m,p)},this._createCellRange=function(m,p,b){return o.view._wt.createCellRange(m,p,b)},this.validateCell=function(m,p,b,D){let F=o.getCellValidator(p);function j(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||p.hidden===!0){b(K);return}const R=p.visualCol,T=p.visualRow,I=o.getCell(T,R,!0);if(I&&I.nodeName!=="TH"){const A=o.rowIndexMapper.getRenderableFromVisualIndex(T),L=o.columnIndexMapper.getRenderableFromVisualIndex(R);o.view._wt.getSetting("cellRenderer",A,L,I)}b(K)}PK(F)&&(F=function(K){return function(y,R){R(K.test(y))}}(F)),at(F)?(m=o.runHooks("beforeValidate",m,p.visualRow,p.prop,D),o._registerImmediate(()=>{F.call(p,m,K=>{o&&(K=o.runHooks("afterValidate",K,m,p.visualRow,p.prop,D),p.valid=K,j(K),o.runHooks("postAfterValidate",K,m,p.visualRow,p.prop,D))})})):o._registerImmediate(()=>{p.valid=!0,j(p.valid,!1)})};function Ve(m,p,b){return Array.isArray(m)?m:[[m,p,b]]}function yt(m,p){const b=o.runHooks("beforeChange",m,p||"edit"),D=m.filter(j=>j!==null);if(b===!1||D.length===0){var F;return(F=o.getActiveEditor())===null||F===void 0||F.cancelChanges(),[]}for(let j=D.length-1;j>=0;j--){const[K,y,,R]=D[j],T=a.propToCol(y);let I;Number.isInteger(T)?I=o.getCellMeta(K,T):I={...Object.getPrototypeOf(v),...v};const{type:A,checkedTemplate:L,uncheckedTemplate:B}=I;if(A==="numeric"&&typeof R=="string"&&CX(R)&&(D[j][3]=ne(R)),A==="checkbox"){const N=Ot(R),$=N===Ot(L),W=N===Ot(B);($||W)&&(D[j][3]=$?L:B)}}return D}this.setDataAtCell=function(m,p,b,D){const F=Ve(m,p,b),j=[];let K=D,y,R,T;for(y=0,R=F.length;y<R;y++){if(typeof F[y]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof F[y][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");F[y][1]>=this.countCols()?T=F[y][1]:T=a.colToProp(F[y][1]),j.push([F[y][0],T,l.getAtCell(this.toPhysicalRow(F[y][0]),F[y][1]),F[y][2]])}!K&&typeof m=="object"&&(K=p);const I=yt(j,K);o.runHooks("afterSetDataAtCell",I,K),Fe(I,K,()=>{ke(I,K)})},this.setDataAtRowProp=function(m,p,b,D){const F=Ve(m,p,b),j=[];let K=D,y,R;for(y=0,R=F.length;y<R;y++)j.push([F[y][0],F[y][1],l.getAtCell(this.toPhysicalRow(F[y][0]),F[y][1]),F[y][2]]);!K&&typeof m=="object"&&(K=p);const T=yt(j,D);o.runHooks("afterSetDataAtRowProp",T,K),Fe(T,K,()=>{ke(T,K)})},this.listen=function(){o&&!o.isListening()&&(Ib.forEach(m=>{o!==m&&m.unlisten()}),Mb=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Mb=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return Mb===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),p&&O.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,p,b,D,F,j,K){if(!(typeof b=="object"&&typeof b[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const y=typeof D=="number"?o._createCellCoords(D,F):null;return u.populateFromArray(o._createCellCoords(m,p),b,y,j,K)},this.spliceCol=function(m,p,b){for(var D=arguments.length,F=new Array(D>3?D-3:0),j=3;j<D;j++)F[j-3]=arguments[j];return a.spliceCol(m,p,b,...F)},this.spliceRow=function(m,p,b){for(var D=arguments.length,F=new Array(D>3?D-3:0),j=3;j<D;j++)F[j-3]=arguments[j];return a.spliceRow(m,p,b,...F)},this.getSelected=function(){if(O.isSelected())return je(O.getSelectedRange(),m=>{let{from:p,to:b}=m;return[p.row,p.col,b.row,b.col]})},this.getSelectedLast=function(){const m=this.getSelected();let p;return m&&m.length>0&&(p=m[m.length-1]),p},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let p;return m&&m.length>0&&(p=m[m.length-1]),p},this.emptySelectedCells=function(m){if(!O.isSelected()||this.countRows()===0||this.countCols()===0)return;const p=[];H(O.getSelectedRange(),b=>{if(b.isSingleHeader())return;const D=b.getTopStartCorner(),F=b.getBottomEndCorner();de(D.row,F.row,j=>{de(D.col,F.col,K=>{this.getCellMeta(j,K).readOnly||p.push([j,K,null])})})}),p.length>0&&this.setDataAtCell(p,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const p=m();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const b=m();return this.resumeExecution(p),b},this.batch=function(m){this.suspendRender(),this.suspendExecution();const p=m();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:p,height:b}=m.getLastSize(),{width:D,height:F}=o.rootElement.getBoundingClientRect(),j=D!==p||F!==b;o.runHooks("beforeRefreshDimensions",{width:p,height:b},{width:D,height:F},j)!==!1&&((j||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(D,F),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:p,height:b},{width:D,height:F},j))},this.updateData=function(m,p){T1(m,b=>{a=b},b=>{a=b,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),O.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:p,metaManager:S,firstRun:f})},this.loadData=function(m,p){T1(m,b=>{a=b},()=>{S.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),O.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:p,metaManager:S,firstRun:f})},this.getInitialColumnCount=function(){const m=v.columns;let p=0;if(Array.isArray(m))p=m.length;else if(at(m))if(o.dataType==="array"){const b=this.countSourceCols();for(let D=0;D<b;D+=1)m(D)&&(p+=1)}else(o.dataType==="object"||o.dataType==="function")&&(p=a.colToPropCache.length);else if(ue(v.dataSchema)){const b=a.getSchema();p=Array.isArray(b)?b.length:p0(b)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,p,b,D){return Pt(m)?a.getAll():a.getRange(o._createCellCoords(m,p),o._createCellCoords(b,D),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,p,b,D){return a.getCopyableText(o._createCellCoords(m,p),o._createCellCoords(b,D))},this.getCopyableData=function(m,p){return a.getCopyable(m,a.colToProp(p))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=(f?o.loadData:o.updateData).bind(this);let D=!1,F,j;if(ue(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ue(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ue(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&Z(m.language);for(F in m)if(!(F==="data"||F==="language"))if(F==="className")ae("className",m.className);else if(F==="tableClassName"&&o.table)ae("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ie.getSingleton().isRegistered(F)||ie.getSingleton().isDeprecated(F)){const I=m[F];at(I)?(ie.getSingleton().addAsFixed(F,I,o),v[F]=I):Array.isArray(I)&&(ie.getSingleton().add(F,I,o),v[F]=I)}else!p&&rn(m,F)&&(E[F]=m[F]);m.data===void 0&&v.data===void 0?b(null,"updateSettings"):m.data!==void 0?b(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const K=o.countCols(),y=v.columns;if(y&&at(y)&&(D=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&S.clearCache(),K>0)for(F=0,j=0;F<K;F++){if(y){const I=D?y(F):y[j];I&&S.updateColumnMeta(j,I)}j+=1}ue(m.cell)&&De(m.cell,I=>{o.setCellMetaObject(I.row,I.col,I)}),o.runHooks("afterCellMetaReset");let R=o.rootElement.style.height;R!==""&&(R=parseInt(o.rootElement.style.height,10));let T=m.height;if(at(T)&&(T=T()),p&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),T===null){const I=o.rootElement.getAttribute("data-initialstyle");I&&(I.indexOf("height")>-1||I.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",I):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else T!==void 0&&(o.rootElement.style.height=isNaN(T)?`${T}`:`${T}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let I=m.width;at(I)&&(I=I()),o.rootElement.style.width=isNaN(I)?`${I}`:`${I}px`}if(!p){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const I=o.getCurrentThemeName();rn(m,"themeName")&&I!==m.themeName&&o.useTheme(m.themeName)}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!p&&o.view&&(R===""||T===""||T===void 0)&&R!==T&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(v.getValue){if(at(v.getValue))return v.getValue.call(o);if(m)return o.getData()[m[0][0]][v.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,p,b,D,F){u.alter(m,p,b,D,F)},this.getCell=function(m,p){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,D=p,F=m;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;D=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;F=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return F===null||D===null||F===void 0||D===void 0?null:o.view.getCellAtCoords(o._createCellCoords(F,D),b)},this.getCoords=function(m){const p=this.view._wt.wtTable.getCoords(m);if(p===null)return null;const{row:b,col:D}=p;let F=b,j=D;return b>=0&&(F=this.rowIndexMapper.getVisualFromRenderableIndex(b)),D>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(D)),o._createCellCoords(F,j)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,p){return a.get(m,a.colToProp(p))},this.getDataAtRowProp=function(m,p){return a.get(m,p)},this.getDataAtCol=function(m){const p=[],b=a.getRange(o._createCellCoords(0,m),o._createCellCoords(v.data.length-1,m),a.DESTINATION_RENDERER);for(let D=0;D<b.length;D+=1)for(let F=0;F<b[D].length;F+=1)p.push(b[D][F]);return p},this.getDataAtProp=function(m){const p=[],b=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(v.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let D=0;D<b.length;D+=1)for(let F=0;F<b[D].length;F+=1)p.push(b[D][F]);return p},this.getSourceData=function(m,p,b,D){let F;return m===void 0?F=l.getData():F=l.getByRange(o._createCellCoords(m,p),o._createCellCoords(b,D)),F},this.getSourceDataArray=function(m,p,b,D){let F;return m===void 0?F=l.getData(!0):F=l.getByRange(o._createCellCoords(m,p),o._createCellCoords(b,D),!0),F},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,p,b,D){const F=Ve(m,p,b),j=this.hasHook("afterSetSourceDataAtCell"),K=[];j&&H(F,R=>{let[T,I,A]=R;K.push([T,I,l.getAtCell(T,I),A])}),H(F,R=>{let[T,I,A]=R;l.setAtCell(T,I,A)}),j&&this.runHooks("afterSetSourceDataAtCell",K,D),this.render();const y=o.getActiveEditor();y&&ue(y.refreshValue)&&y.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,p){return l.getAtCell(m,p)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,p,b,D){const F=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,p,b,D],[j,K]=F;let[,,y,R]=F,T=null,I=null;y===void 0&&(y=j),R===void 0&&(R=K);let A="mixed";return de(Math.max(Math.min(j,y),0),Math.max(j,y),L=>{let B=!0;return de(Math.max(Math.min(K,R),0),Math.max(K,R),N=>(I=this.getCellMeta(L,N).type,T?B=T===I:T=I,B)),A=B?I:"mixed",B}),A},this.removeCellMeta=function(m,p,b){const[D,F]=[this.toPhysicalRow(m),this.toPhysicalColumn(p)];let j=S.getCellMetaKeyValue(D,F,b);o.runHooks("beforeRemoveCellMeta",m,p,b,j)!==!1&&(S.removeCellMeta(D,F,b),o.runHooks("afterRemoveCellMeta",m,p,b,j)),j=null},this.spliceCellsMeta=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var b=arguments.length,D=new Array(b>2?b-2:0),F=2;F<b;F++)D[F-2]=arguments[F];if(D.length>0&&!Array.isArray(D[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");p>0&&S.removeRow(this.toPhysicalRow(m),p),D.length>0&&H(D.reverse(),j=>{S.createRow(this.toPhysicalRow(m)),H(j,(K,y)=>this.setCellMetaObject(m,y,K))}),o.render()},this.setCellMetaObject=function(m,p,b){typeof b=="object"&&De(b,(D,F)=>{this.setCellMeta(m,p,F,D)})},this.setCellMeta=function(m,p,b,D){if(o.runHooks("beforeSetCellMeta",m,p,b,D)===!1)return;let j=m,K=p;m<this.countRows()&&(j=this.toPhysicalRow(m)),p<this.countCols()&&(K=this.toPhysicalColumn(p)),S.setCellMeta(j,K,b,D),o.runHooks("afterSetCellMeta",m,p,b,D)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(m,p){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},D=this.toPhysicalRow(m),F=this.toPhysicalColumn(p);return D===null&&(D=m),F===null&&(F=p),S.getCellMeta(D,F,{visualRow:m,visualColumn:p,...b})},this.getColumnMeta=function(m){return S.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return S.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||v.columns)},this.getCellRenderer=function(m,p){const b=typeof m=="number"?o.getCellMeta(m,p).renderer:m.renderer;return typeof b=="string"?CA(b):Pt(b)?CA("text"):b},this.getCellEditor=function(m,p){const b=typeof m=="number"?o.getCellMeta(m,p).editor:m.editor;return typeof b=="string"?eA(b):Pt(b)?eA("text"):b},this.getCellValidator=function(m,p){const b=typeof m=="number"?o.getCellMeta(m,p).validator:m.validator;return typeof b=="string"?kX(b):b},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,p){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,m)},this.validateColumns=function(m,p){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,m)},this._validateCells=function(m,p,b){const D=new te;m&&(D.onQueueEmpty=m);let F=o.countRows()-1;for(;F>=0;){if(p!==void 0&&p.indexOf(F)===-1){F-=1;continue}let j=o.countCols()-1;for(;j>=0;){if(b!==void 0&&b.indexOf(j)===-1){j-=1;continue}D.addValidatorToQueue(),o.validateCell(o.getDataAtCell(F,j),o.getCellMeta(F,j),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(D.valid=!1),D.removeValidatorFormQueue()},"validateCells"),j-=1}F-=1}D.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let p=v.rowHeaders,b=m;return b!==void 0&&(b=o.runHooks("modifyRowHeader",b)),b===void 0?(p=[],de(o.countRows()-1,D=>{p.push(o.getRowHeader(D))})):Array.isArray(p)&&p[b]!==void 0?p=p[b]:at(p)?p=p(b):p&&typeof p!="string"&&typeof p!="number"&&(p=b+1),p},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let m=0,p=o.countCols();m<p;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const b=o.runHooks("modifyColHeader",m);if(b===void 0){const y=[],R=o.countCols();for(let T=0;T<R;T++)y.push(o.getColHeader(T));return y}let D=v.colHeaders;const F=function(y){const R=[],T=o.countCols();let I=0;for(;I<T;I++)at(v.columns)&&v.columns(I)&&R.push(I);return R[y]},j=o.toPhysicalColumn(b),K=F(j);return v.colHeaders===!1?D=null:v.columns&&at(v.columns)&&v.columns(K)&&v.columns(K).title?D=v.columns(K).title:v.columns&&v.columns[j]&&v.columns[j].title?D=v.columns[j].title:Array.isArray(v.colHeaders)&&v.colHeaders[j]!==void 0?D=v.colHeaders[j]:at(v.colHeaders)?D=v.colHeaders(j):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(D=L9(b)),D=o.runHooks("modifyColumnHeaderValue",D,m,p),D},this._getColWidthFromSettings=function(m){let p;if(m>=0&&(p=o.getCellMeta(0,m).width),(p===void 0||p===v.width)&&(p=v.colWidths),p!=null){switch(typeof p){case"object":p=p[m];break;case"function":p=p(m);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(m,p){let b=o._getColWidthFromSettings(m);return b=o.runHooks("modifyColWidth",b,m,p),b===void 0&&(b=mc),b},this._getRowHeightFromSettings=function(m){const p=o.stylesHandler.getDefaultRowHeight();let b=v.rowHeights;if(b!=null){switch(typeof b){case"object":b=b[m];break;case"function":b=b(m);break}typeof b=="string"&&(b=parseInt(b,10))}return b!=null&&b<p?p:b},this.getRowHeight=function(m,p){let b=o._getRowHeightFromSettings(m);return b=o.runHooks("modifyRowHeight",b,m,p),b},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=v.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,p)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return wA(o.countRows()-1,b=>{if(o.isEmptyRow(b))p+=1;else if(m===!0)return!1}),p},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return wA(o.countCols()-1,b=>{if(o.isEmptyCol(b))p+=1;else if(m===!0)return!1}),p},this.isEmptyRow=function(m){return v.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return v.isEmptyCol.call(o,m)},this.selectCell=function(m,p,b,D){let F=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Pt(m)||Pt(p)?!1:this.selectCells([[m,p,b,D]],F,j)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&d.suspend();const D=O.selectCells(m);return D&&b&&o.listen(),d.resume(),D},this.selectColumns=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,b=arguments.length>2?arguments[2]:void 0;return O.selectColumns(m,p,b)},this.selectRows=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,b=arguments.length>2?arguments[2]:void 0;return O.selectRows(m,p,b)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,b=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),O.selectAll(m,p,b)};const ot=(m,p)=>m.getNearestNotHiddenIndex(p,1,!0);this.scrollViewportTo=function(m,p){if(typeof m=="number"){var b;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(b=arguments[4])!==null&&b!==void 0?b:!0}}const{row:D,col:F,considerHiddenIndexes:j}=m??{};let K=D,y=F;if(at(p)&&this.addHookOnce("afterScroll",p),j===void 0||j){const A=Number.isInteger(D)&&D>=0,L=Number.isInteger(F)&&F>=0,B=A?ot(this.rowIndexMapper,D):void 0,N=L?ot(this.columnIndexMapper,F):void 0;if(B===null||N===null)return!1;K=A?o.rowIndexMapper.getRenderableFromVisualIndex(B):D,y=L?o.columnIndexMapper.getRenderableFromVisualIndex(N):F}const R=Number.isInteger(K),T=Number.isInteger(y);let I=!1;return R&&K>=0&&T&&y>=0?I=o.view.scrollViewport(o._createCellCoords(K,y),m.horizontalSnap,m.verticalSnap):R&&K>=0&&(T&&y<0||!T)?I=o.view.scrollViewportVertically(K,m.verticalSnap):T&&y>=0&&(R&&K<0||!R)&&(I=o.view.scrollViewportHorizontally(y,m.horizontalSnap)),at(p)&&(I?this.view.render():(this.removeHook("afterScroll",p),this._registerMicrotask(()=>p()))),I},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;at(m)&&this.addHookOnce("afterScroll",m);const{highlight:p}=this.getSelectedRangeLast(),b=this.scrollViewportTo(p.toObject());return b?this.view.render():at(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),b},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),x.clear(),S.clearCache(),Ib.delete(this.guid),s.destroy(),c&&c.destroy(),o.rootContainer&&ws(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),P.getItems().forEach(m=>{let[,p]=m;p.destroy()}),P.clear(),o.runHooks("afterDestroy")},!0),ie.getSingleton().destroy(o),De(o,(m,p,b)=>{at(m)?b[p]=ut(p):p!=="guid"&&(b[p]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,O=null,c=null,o=null};function ut(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return P.getItem(Vi(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:P.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,p,b){ie.getSingleton().add(m,p,o,b)},this.hasHook=function(m){return ie.getSingleton().has(m,o)||ie.getSingleton().has(m)},this.addHookOnce=function(m,p,b){ie.getSingleton().once(m,p,o,b)},this.removeHook=function(m,p){ie.getSingleton().remove(m,p,o)},this.runHooks=function(m,p,b,D,F,j,K){return ie.getSingleton().run(o,m,p,b,D,F,j,K)},this.getTranslatedPhrase=function(m,p){return O$(v.language,m,p)},this.toHTML=()=>mA(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",mA(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{const p=!!f;this.stylesHandler.useTheme(m);const b=this.stylesHandler.getThemeName();Vu(this)&&(ve(this.rootWrapperElement,/ht-theme-.*/g),ve(this.rootPortalElement,/ht-theme-.*/g),b&&(X(this.rootWrapperElement,b),X(this.rootPortalElement,b),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Ze(`The "${b}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),p||(o.render(),o.scrollViewportTo(0,0),x1(this.rootContainer)&&(ve(this.rootContainer,/ht-theme-.*/g),b&&X(this.rootContainer,b))),this.runHooks("afterSetTheme",b,p)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=m;typeof b=="function"&&(b=setTimeout(b,p)),this.timeouts.push(b)},this._clearTimeouts=function(){H(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){H(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const wn=G7({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&wn.releasePressedKeys()}),this.getShortcutManager=function(){return wn},this.getFocusManager=function(){return h},KL().forEach(m=>{const p=E0(m);P.addItem(m,new p(this))}),O7(o),wn.setActiveContextName("grid"),ie.getSingleton().run(o,"construct")}function $1(t,e,n){t.addEventListener(e,n,!1)}function F1(t,e,n){t.removeEventListener(e,n,!1)}function cg(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function q$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=cg(s).fontSize,o.style.fontFamily=cg(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=cg(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=cg(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),w=o.clientWidth+f+g+1;r.removeChild(o);const C=s.style;C.height=`${n.minHeight}px`,n.minWidth>w?C.width=`${n.minWidth}px`:w>n.maxWidth?C.width=`${n.maxWidth}px`:C.width=`${w}px`;const S=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>S?C.height=`${n.minHeight}px`:n.maxHeight<S?(C.height=`${n.maxHeight}px`,C.overflowY="visible"):C.height=`${S}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&($1(s,"input",a),$1(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){F1(s,"input",a),F1(s,"keydown",l)}}}function V1(t,e){const n=OL(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}dw(e,i)}function Ha(t,e,n){return(e=nZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nZ(t){var e=rZ(t,"string");return typeof e=="symbol"?e:e+""}function rZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const iZ="ht_editor_visible",hg="ht_editor_hidden",W1="textEditor",oZ="text";class Gl extends Nc{static get EDITOR_TYPE(){return oZ}constructor(e){super(e),Ha(this,"eventManager",new Wi(this)),Ha(this,"autoResize",q$(this.hot.rootDocument)),Ha(this,"TEXTAREA",void 0),Ha(this,"textareaStyle",void 0),Ha(this,"TEXTAREA_PARENT",void 0),Ha(this,"textareaParentStyle",void 0),Ha(this,"layerClass",void 0),this.eventManager=new Wi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),bm(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Wt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Wt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),dw(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),ye(this.TEXTAREA,[["data-hot-input",""],wa(-1)]),X(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),X(this.TEXTAREA_PARENT,"handsontableInputHolder"),be(this.TEXTAREA_PARENT,this.layerClass)&&ve(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,hg),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){g3()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ve(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,hg)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;de(e.length-1,r=>{const i=e[r];if(be(i,"handsontableEditor"))return n=!0,!1}),be(this.TEXTAREA_PARENT,hg)&&ve(this.TEXTAREA_PARENT,hg),n?(this.layerClass=iZ,X(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),X(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Wt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){SL()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Wt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Wt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>ue(this.hot.getSelected()),group:W1},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;V1(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;V1(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(W1)}}const sZ="base",aZ="htTextEllipsis";function mf(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&X(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(Dx())):a&&c.push(Dx()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(kx())):(u.push(s.invalidCellClassName),a&&c.push(kx()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(aZ),ve(e,u),X(e,l),xc(e,c),ye(e,h)}mf.RENDERER_TYPE=sZ;const lZ="text";function Ts(t,e,n,r,i,o,s){mf.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Ot(a),s.trimWhitespace&&(a=a.trim()),Pl(e,a)}Ts.RENDERER_TYPE=lZ;const uZ="text",K$={CELL_TYPE:uZ,editor:Gl,renderer:Ts};Ti(K$);Vr.editors={BaseEditor:Nc};function Vr(t,e){const n=new G$(t,e||{},V0);return n.init(),n}Vr.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new G$(t,e,V0)};Vr.DefaultSettings=L$();Vr.hooks=ie.getSingleton();Vr.CellCoords=xl;Vr.CellRange=hf;Vr.packageName="handsontable";Vr.buildDate="10/07/2025 10:59:01";Vr.version="16.0.1";Vr.languages={dictionaryKeys:v8,getLanguageDictionary:P$,getLanguagesDictionaries:R8,registerLanguageDictionary:I$,getTranslatedPhrase:O$};function cZ(t,e,n){return(e=fZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function hZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?B1(Object(n),!0).forEach(function(r){cZ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function dZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fZ(t){var e=dZ(t,"string");return typeof e=="symbol"?e:e+""}function ld(t){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ld(t)}var ic=Symbol("unassigned"),gZ="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function sp(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function X$(t){var e=Vr.hooks.getRegistered(),n={};Object.assign(n,Vr.DefaultSettings);for(var r in n)n[r]={default:ic};for(var i=0;i<e.length;i++)n[e[i]]={default:ic};return n.settings={default:ic},t==="HotTable"&&(n.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),n}function Z$(t){var e={},n=t.settings;if(n!==ic)for(var r in n)sp(n,r)&&n[r]!==ic&&(e[r]=n[r]);for(var i in t)sp(t,i)&&i!=="settings"&&t[i]!==ic&&(e[i]=t[i]);return e}function j1(t,e){var n=Z$(t),r=t.settings?t.settings:n,i=t.settings?n:null,o={};for(var s in r)sp(r,s)&&r[s]!==void 0&&(!(e&&s!=="data")||!U1(e[s],r[s]))&&(o[s]=r[s]);for(var a in i)sp(i,a)&&a!=="id"&&a!=="settings"&&i[a]!==void 0&&(!(e&&a!=="data")||!U1(e[a],i[a]))&&(o[a]=i[a]);return o}function U1(t,e){var n=function(i){var o=function(){var s=new WeakSet;return function(a,l){if(ld(l)==="object"&&l!==null){if(s.has(l))return;s.add(l)}return l}}();return JSON.stringify(i,o)};return typeof t=="function"&&typeof e=="function"?t.toString()===e.toString():ld(t)!==ld(e)?!1:n(t)===n(e)}var mZ="16.0.1",v_=Bi({name:"HotTable",props:X$("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var n=j1(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||n===void 0||(n.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete n.data),Object.keys(n).length?this.hotInstance.updateSettings(n):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(gZ),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=j1(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=CB(new Vr.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var n=this.hotInstance.getSourceData(),r=[],i=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==o&&n.length<o)for(var l=n.length;l<o;l++)r.push(l);if(s){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&((u=n[0])===null||u===void 0?void 0:u.length)!==a&&n[0].length<a)for(var c=n[0].length;c<a;c++)i.push(c)}this.hotInstance.batch(function(){r.length>0?e.hotInstance.rowIndexMapper.removeIndexes(r):e.hotInstance.rowIndexMapper.insertIndexes(o-1,n.length-o),s&&n.length!==0&&(i.length>0?e.hotInstance.columnIndexMapper.removeIndexes(i):e.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:mZ}),pZ=["id"];function wZ(t,e,n,r,i,o){return Fn(),To("div",{id:t.id},[$n(t.$slots,"default")],8,pZ)}v_.render=wZ;v_.__file="src/HotTable.vue";var vZ=Bi({name:"HotColumn",props:X$("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=Z$(this.$props),n=hZ({},e);e.renderer&&(n.renderer=e.renderer),e.editor&&(n.editor=e.editor),this.columnsCache.set(this,n)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});vZ.__file="src/HotColumn.vue";function z1(t,e,n){return(e=CZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CZ(t){var e=yZ(t,"string");return typeof e=="symbol"?e:e+""}function yZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Y1="handsontableEditor",bZ="handsontable";class C_ extends Gl{constructor(){super(...arguments),z1(this,"isFlippedVertically",!1),z1(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return bZ}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),dw(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&sn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getDropdownHeight(),o=e.getWorkspaceHeight()-r-n.height,s=i>o&&r>o+n.height;return s?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:s,spaceAbove:r,spaceBelow:o}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;r=Math.max(r+a,0)}const i=this.getDropdownWidth(),o=e.getWorkspaceWidth()-r+n.width,s=i>o&&r>o;return s?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:s,spaceInlineStart:r,spaceInlineEnd:o}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:Y1,relativeToGroup:ya,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||this.isFlippedVertically&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),zi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&this.isFlippedVertically?a=s.countRows()-1:s.getSelectedLast()&&(this.isFlippedVertically?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!this.isFlippedVertically)a=0;else if(s.getSelectedLast()){if(this.isFlippedVertically)a=s.getSelectedLast()[0]+1;else if(!this.isFlippedVertically){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Y1)}}function SZ(t,e){J$(t,e),e.add(t)}function G1(t,e,n){J$(t,e),e.set(t,n)}function J$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dg(t,e,n){return(e=RZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RZ(t){var e=EZ(t,"string");return typeof e=="symbol"?e:e+""}function EZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pb(t,e){return t.get(VR(t,e))}function VR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TZ="autocomplete";var Ob=new WeakMap,q1=new WeakMap,xb=new WeakSet;class y_ extends C_{constructor(){super(...arguments),SZ(this,xb),dg(this,"query",null),dg(this,"strippedChoices",[]),dg(this,"rawChoices",[]),G1(this,Ob,this.hot.guid.slice(0,9)),G1(this,q1,gw(()=>{this.focus()},100)),dg(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=Nx(Ot(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return TZ}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ue(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),X(this.htContainer,"autocompleteEditor"),X(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[GK(),BK(),pL("listbox"),ZK()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[ai("false"),JK(`${Pb(Ob,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r?.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",Pb(q1,this)),this.htEditor.updateSettings({colWidths:e?[qt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{Ts(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:w,locale:C}=this.cellProperties,S=this.query;let v=Ot(d),E,P;v&&!w&&(E=g===!0?v.indexOf(S):v.toLocaleLowerCase(C).indexOf(S.toLocaleLowerCase(C)),E!==-1&&(P=v.substr(E,S.length),v=v.replace(P,`<strong>${P}</strong>`))),n&&ye(l,[jK(),...r?[n3(i)]:[],...r?[r3(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=v},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{ye(h,[g0()]),ye(this.TEXTAREA,...QK(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(ye(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...ls()),ye(this.htEditor.rootElement,[mL(),e3("polite"),t3("text"),["id",`${Pb(Ob,this)}-listbox-${o}-${s}`]]),ye(this.TEXTAREA,...ai("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[ai("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=OL(this.TEXTAREA),r=R3(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(ym([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),dw(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:r,spaceBelow:i}=e;return this.limitDropdownIfNeeded(n?r:i),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let r=0,i=0,o=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),r+=i;while(r<e);o=r-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(r-i)}}updateDropdownDimensions(){const e=xL(),n=this.getTargetEditorWidth()+e,r=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:r}),VR(xb,this,K1).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),VR(xb,this,K1).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(i,o)=>o).reduce((i,o)=>{const s=this.hot.stylesHandler.getDefaultRowHeight()+(o===0?1:0);return i+s},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=je(e,o=>Ot(o));return je(r,o=>n?o:Nx(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===me.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===me.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(P3(e.keyCode)||e.keyCode===me.BACKSPACE||e.keyCode===me.DELETE||e.keyCode===me.INSERT){let n=10;if(e.keyCode===me.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function K1(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+Sn(this.hot.rootDocument)})}const _Z="checkbox";class Q$ extends Nc{static get EDITOR_TYPE(){return _Z}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');be(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const na=()=>window,ni=()=>window.document,WR=(t,e)=>window.setTimeout(t,e),ho=function(t,e,n,r){t.addEventListener(e,n,!!r)},Uo=function(t,e,n,r){t.removeEventListener(e,n,!!r)},MZ=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Pr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},Ab=function(t,e){Pr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},Hb=function(t,e){t.className=MZ((" "+t.className+" ").replace(" "+e+" "," "))},b_=function(t){return/Array/.test(Object.prototype.toString.call(t))},Nr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},IZ=function(t){let e=t.getDay();return e===0||e===6},PZ=function(t){return t%4===0&&t%100!==0||t%400===0},X1=function(t,e){return[31,PZ(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},fg=function(t){Nr(t)&&t.setHours(0,0,0,0)},gg=function(t,e){return t.getTime()===e.getTime()},ap=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Nr(e[r])?n&&(t[r]=new Date(e[r].getTime())):b_(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=ap({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},Z1=function(t,e,n){let r=ni().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=ap(r,n),t.dispatchEvent(r)},J1=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Qi={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},Q1=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},OZ=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},xZ=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},AZ=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():xZ(o,i))+"</td>"},HZ=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},NZ=function(t){return"<tbody>"+t.join("")+"</tbody>"},DZ=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+Q1(t,e)+'">'+Q1(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},kZ=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,w=!0,C=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",b_(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(w=!1),h&&(r===11||u.maxMonth<=r)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(w?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},LZ=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+DZ(t)+NZ(e)+"</table>"};function BR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||na().event;let o=i.target||i.srcElement;if(o)if(Pr(o,"is-disabled")||(Pr(o,"pika-button")&&!Pr(o,"is-empty")&&!Pr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&WR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Pr(o,"pika-prev")?e.prevMonth():Pr(o,"pika-next")&&e.nextMonth()),Pr(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||na().event;let o=i.target||i.srcElement;o&&(Pr(o,"pika-select-month")?e.gotoMonth(o.value):Pr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||na().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Nr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=ni().activeElement;do if(Pr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=WR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||na().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Pr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),ho(o,"change",e._onChange)));do if(Pr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=ni().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),ho(e.el,"mousedown",e._onMouseDown,!0),ho(e.el,"touchend",e._onMouseDown,!0),ho(e.el,"change",e._onChange),n.keyboardInput&&ho(ni(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?ni().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),ho(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Nr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",ho(n.trigger,"click",e._onInputClick),ho(n.trigger,"focus",e._onInputFocus),ho(n.trigger,"blur",e._onInputBlur)):this.show()}BR.prototype={config:function(t){this._o||(this._o=ap({},Qi,!0));let e=ap(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Nr(e.minDate)||(e.minDate=!1),Nr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),b_(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Qi.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Nr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Nr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",Z1(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Nr(t))return;let n=this._o.minDate,r=this._o.maxDate;Nr(n)&&t<n?t=n:Nr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),fg(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),Z1(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Nr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=J1(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=J1({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(fg(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Qi.minDate,this._o.minYear=Qi.minYear,this._o.minMonth=Qi.minMonth,this._o.startRange=Qi.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(fg(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Qi.maxDate,this._o.maxYear=Qi.maxYear,this._o.maxMonth=Qi.maxMonth,this._o.endRange=Qi.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+kZ(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&WR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=na().innerWidth||ni().documentElement.clientWidth,i=na().innerHeight||ni().documentElement.clientHeight,o=ni().body.scrollTop||ni().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+na().pageXOffset,a=l.bottom+na().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",Ab(this.el,u?"left-aligned":"right-aligned"),Ab(this.el,c?"bottom-aligned":"top-aligned"),Hb(this.el,u?"right-aligned":"left-aligned"),Hb(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=X1(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];fg(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=X1(h,u),g=o+s,w=g;for(;w>7;)w-=7;g+=7-w;let C=!1;for(let S=0,v=0;S<g;S++){let E=new Date(t,e,1+(S-s)),P=Nr(this._d)?gg(E,this._d):!1,x=gg(E,i),_=r.events.indexOf(E.toDateString())!==-1,M=S<s||S>=o+s,V=1+(S-s),z=e,O=t,G=r.startRange&&gg(r.startRange,E),Z=r.endRange&&gg(r.endRange,E),ae=r.startRange&&r.endRange&&r.startRange<E&&E<r.endRange,te=r.minDate&&E<r.minDate||r.maxDate&&E>r.maxDate||r.disableWeekends&&IZ(E)||r.disableDayFn&&r.disableDayFn(E);M&&(S<s?(V=f+V,z=u,O=h):(V=V-o,z=c,O=d));let ne={day:V,month:z,year:O,hasEvent:_,isSelected:P,isToday:x,isDisabled:te,isEmpty:M,isStartRange:G,isEndRange:Z,isInRange:ae,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&P&&(C=!0),l.push(OZ(ne)),++v===7&&(r.showWeekNumber&&l.unshift(AZ(this,S-s,e,t,r.firstWeekOfYearMinDays)),a.push(HZ(l,r.isRTL,r.pickWholeWeek,C)),l=[],v=0,C=!1)}return LZ(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Hb(this.el,"is-hidden"),this._o.bound&&(ho(ni(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Uo(ni(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Ab(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Uo(this.el,"mousedown",this._onMouseDown,!0),Uo(this.el,"touchend",this._onMouseDown,!0),Uo(this.el,"change",this._onChange),t.keyboardInput&&Uo(ni(),"keydown",this._onKeyChange),t.field&&(Uo(t.field,"change",this._onInputChange),t.bound&&(Uo(t.trigger,"click",this._onInputClick),Uo(t.trigger,"focus",this._onInputFocus),Uo(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function $Z(t,e){FZ(t,e),e.add(t)}function FZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eH(t,e,n){return(e=VZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VZ(t){var e=WZ(t,"string");return typeof e=="symbol"?e:e+""}function WZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eF="date",tH="dateEditor",BZ="DD/MM/YYYY";var mg=new WeakSet;class tF extends Gl{constructor(){super(...arguments),$Z(this,mg),eH(this,"parentDestroyed",!1),eH(this,"$datePicker",null)}static get EDITOR_TYPE(){return eF}init(){if(typeof J!="function")throw new Error("You need to include moment.js to your project.");if(typeof BR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),X(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{be(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:tH})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(tH),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=Nb(mg,this,Db).call(this),r=this.hot.view.isMouseDown(),i=e?FL(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new BR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(J),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,J(o,n,!0).isValid()&&this.$datePicker.setMoment(J(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,J(o,n,!0).isValid()&&this.$datePicker.setMoment(J(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&hw(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:Nb(mg,this,Db).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=J(a).format(Nb(mg,this,Db).call(this))),this.setValue(a),i&&i(),Eo()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Wt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+on(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-qt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function Db(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:BZ}const jZ="dropdown";class nF extends y_{static get EDITOR_TYPE(){return jZ}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const UZ="numeric";class rF extends Gl{static get EDITOR_TYPE(){return UZ}}function zZ(t,e,n){return(e=YZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YZ(t){var e=GZ(t,"string");return typeof e=="symbol"?e:e+""}function GZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qZ="password";class iF extends Gl{constructor(){super(...arguments),zZ(this,"autoResize",q$(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return qZ}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ws(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...wa(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const kb="ht_editor_visible",nH="selectEditor",KZ="select";class oF extends Nc{static get EDITOR_TYPE(){return KZ}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...zl()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),X(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",be(this.selectWrapper,kb)&&ve(this.selectWrapper,kb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ws(this.select),De(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Ac(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Wt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",X(this.selectWrapper,kb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:nH};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(nH)}}const XZ="time";class sF extends Gl{static get EDITOR_TYPE(){return XZ}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function ZZ(){Or(Nc),Or(y_),Or(Q$),Or(tF),Or(nF),Or(C_),Or(rF),Or(iF),Or(oF),Or(Gl),Or(sF)}const JZ="html";function S_(t,e,n,r,i,o,s){mf.apply(this,[t,e,n,r,i,o,s]),Ac(e,o??"",!1)}S_.RENDERER_TYPE=JZ;const QZ="autocomplete";function kc(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?S_:Ts,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...zl()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),X(e,"htAutocomplete"),!t.acArrowListener){const h=new Wi(t);t.acArrowListener=function(d){be(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}kc.RENDERER_TYPE=QZ;const eJ="dropdown";function R_(t,e,n,r,i,o,s){kc.apply(this,[t,e,n,r,i,o,s])}R_.RENDERER_TYPE=eJ;const rH=new WeakMap,iH=new WeakMap,tJ="htBadValue",vc="data-row",Cc="data-col",nJ="checkboxRenderer",aF="checkbox";ie.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===aF){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function E_(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;mf.apply(this,[t,e,n,r,i,o,s]),rJ(t);let u=iJ(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),ws(e),o===s.checkedTemplate||Ot(o).toLocaleLowerCase(s.locale)===Ot(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Ot(o).toLocaleLowerCase(s.locale)===Ot(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:jt(o)?X(u,"noValue"):(u.style.display="none",X(u,tJ),h=!0),ye(u,[[vc,n],[Cc,r]]),l&&ye(u,[dc(u.checked?t.getTranslatedPhrase(d_):t.getTranslatedPhrase(f_)),CL(u.checked),UK()]),!h&&c){let w="";if(c.value)w=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const S=t.getDataAtRowProp(n,c.property);w=S!==null?S:""}const C=oJ(a,w,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),rH.has(t)||(rH.set(t,!0),d());function d(){const C=t.getShortcutManager().getContext("grid"),S={group:nJ,relativeToGroup:ya,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const v=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&v?.highlight.isCell()&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}}],S)}function f(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=t.getSelectedRange(),S=[],v=new Map;let E=[],P=0;if(C){for(let x=0;x<C.length;x++){const{row:_,col:M}=C[x].getTopStartCorner(),{row:V,col:z}=C[x].getBottomEndCorner();for(let O=_;O<=V;O+=1)for(let G=M;G<=z;G+=1){const Z=t.getCellMeta(O,G);if(Z.hidden)continue;const ae={checkedTemplate:Z.checkedTemplate,uncheckedTemplate:Z.uncheckedTemplate};if(Z.type!=="checkbox"){w===!0&&!Z.readOnly&&(v.has(S.length)?v.set(S.length,[...v.get(S.length),[O,G,null]]):v.set(S.length,[[O,G,null]]));continue}if(Z.readOnly===!0)continue;typeof Z.checkedTemplate>"u"&&(Z.checkedTemplate=!0),typeof Z.uncheckedTemplate>"u"&&(Z.uncheckedTemplate=!1);const te=t.getDataAtCell(O,G);w===!1?[Z.checkedTemplate,Z.checkedTemplate.toString()].includes(te)?E.push([O,G,Z.uncheckedTemplate,ae]):[Z.uncheckedTemplate,Z.uncheckedTemplate.toString(),null,void 0].includes(te)&&E.push([O,G,Z.checkedTemplate,ae]):E.push([O,G,Z.uncheckedTemplate,ae]),P+=1}S.push(P),P=0}E.every(x=>{let[,,_]=x;return _===E[0][2]})?E=E.map(x=>{let[_,M,V]=x;return[_,M,V]}):E=E.map(x=>{let[_,M,,V]=x;return[_,M,V.checkedTemplate]}),E.length>0&&S.forEach((x,_)=>{let M=E.splice(0,x);v.size&&v.has(_)&&(M=[...M,...v.get(_)]),t.setDataAtCell(M)})}}function g(){const w=t.getSelectedRange();if(w){for(let C=0;C<w.length;C++){const S=w[C].getTopStartCorner(),v=w[C].getBottomEndCorner();for(let E=S.row;E<=v.row;E++)for(let P=S.col;P<=v.col;P++){if(t.getCellMeta(E,P).readOnly)continue;const _=t.getCell(E,P);if(ms(_)&&_.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}E_.RENDERER_TYPE=aF;function rJ(t){let e=iH.get(t);if(!e){const{rootElement:n}=t;e=new Wi(t),e.addEventListener(n,"click",r=>aJ(r,t)),e.addEventListener(n,"mouseup",r=>sJ(r,t)),e.addEventListener(n,"change",r=>lJ(r,t)),iH.set(t,e)}return e}function iJ(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function oJ(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function sJ(t,e){const{target:n}=t;T_(n)&&(!n.hasAttribute(vc)||!n.hasAttribute(Cc)||setTimeout(e.listen,10))}function aJ(t,e){const{target:n}=t;if(!T_(n)||!n.hasAttribute(vc)||!n.hasAttribute(Cc))return;const r=parseInt(n.getAttribute(vc),10),i=parseInt(n.getAttribute(Cc),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function lJ(t,e){const{target:n}=t;if(!T_(n)||!n.hasAttribute(vc)||!n.hasAttribute(Cc))return;const r=parseInt(n.getAttribute(vc),10),i=parseInt(n.getAttribute(Cc),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function T_(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const uJ="handsontable";function __(t,e,n,r,i,o,s){kc.apply(this,[t,e,n,r,i,o,s])}__.RENDERER_TYPE=uJ;var cJ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hJ(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Lb,oH;function dJ(){return oH||(oH=1,Lb={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),Lb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var $b,sH;function lF(){if(sH)return $b;sH=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let w="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*n(C,u,c,h,d,f);for(let _=0;_<t.length;_++){let M=t[_];if(w=l.replace(RegExp(`([0-9 ])(${M.key})$`),"$1"),w!==l)return n(w,u,c,h,d,f)*M.factor}if(w=l.replace("%",""),w!==l)return n(w,u,c,h,d,f)/100;let S=parseFloat(l);if(isNaN(S))return;let v=h(S);if(v&&v!=="."&&(w=l.replace(new RegExp(`${e(v)}$`),""),w!==l))return n(w,u,c,h,d,f);let E={};Object.keys(f).forEach(_=>{E[f[_]]=_});let P=Object.keys(E).sort().reverse(),x=P.length;for(let _=0;_<x;_++){let M=P[_],V=E[M];if(w=l.replace(M,""),w!==l){let z;switch(V){case"thousand":z=Math.pow(10,3);break;case"million":z=Math.pow(10,6);break;case"billion":z=Math.pow(10,9);break;case"trillion":z=Math.pow(10,12);break}return n(w,u,c,h,d,f)*z}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let w=r(l,u,c);return n(w,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=P_();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),w=c.currentAbbreviations(),C;if(typeof l=="string")o(l,h)?C=s(l):C=i(l,h,d,f,g,w);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return $b={unformat:a},$b}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Fb,aH;function M_(){if(aH)return Fb;aH=1;let t=lF();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,S)=>S.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,S)=>S.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,S)=>!S.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,S)=>S.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(C,S){let v=d(C),E=g(S);return v&&E}function d(C){return t.unformat(C)!==void 0}function f(C,S,v,E=!1){let P=Object.keys(C).map(x=>{if(!S[x])return console.error(`${v} Invalid key: ${x}`),!1;let _=C[x],M=S[x];if(typeof M=="string"&&(M={type:M}),M.type==="format"){if(!f(_,u,`[Validate ${x}]`,!0))return!1}else if(typeof _!==M.type)return console.error(`${v} ${x} type mismatched: "${M.type}" expected, "${typeof _}" provided`),!1;if(M.restrictions&&M.restrictions.length){let V=M.restrictions.length;for(let z=0;z<V;z++){let{restriction:O,message:G}=M.restrictions[z];if(!O(_,C))return console.error(`${v} ${x} invalid value: ${G}`),!1}}return M.restriction&&!M.restriction(_,C)?(console.error(`${v} ${x} invalid value: ${M.message}`),!1):M.validValues&&M.validValues.indexOf(_)===-1?(console.error(`${v} ${x} invalid value: must be among ${JSON.stringify(M.validValues)}, "${_}" provided`),!1):!(M.children&&!f(_,M.children,`[Validate ${x}]`))});return E||P.push(...Object.keys(S).map(x=>{let _=S[x];if(typeof _=="string"&&(_={type:_}),_.mandatory){let M=_.mandatory;if(typeof M=="function"&&(M=M(C)),M&&C[x]===void 0)return console.error(`${v} Missing mandatory key "${x}"`),!1}return!0})),P.reduce((x,_)=>x&&_,!0)}function g(C){return f(C,u,"[Validate format]")}function w(C){return f(C,c,"[Validate language]")}return Fb={validate:h,validateFormat:g,validateInput:d,validateLanguage:w},Fb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function fJ(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function gJ(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function mJ(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function pJ(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function wJ(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function vJ(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function CJ(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function yJ(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function bJ(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function SJ(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function RJ(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function EJ(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function TJ(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function _J(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function MJ(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function IJ(t,e={}){return typeof t!="string"?t:(t=fJ(t,e),t=gJ(t,e),mJ(t,e),vJ(t,e),CJ(t,e),TJ(t,e),SJ(t,e),RJ(t,e),yJ(t,e),EJ(t,e),bJ(t,e),pJ(t,e),wJ(t,e),_J(t,e),MJ(t,e),e)}var I_={parseFormat:IJ};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Vb,lH;function P_(){if(lH)return Vb;lH=1;const t=dJ(),e=M_(),n=I_;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,Vb=r,Vb}function PJ(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function OJ(t,e){t.forEach(n=>{let r;try{r=PJ(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var xJ=t=>({loadLanguagesInNode:e=>OJ(e,t)}),uF={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(_){var M,V,z,O=p.prototype={constructor:p,toString:null,valueOf:null},G=new p(1),Z=20,ae=4,te=-7,ne=21,Fe=-1e7,ke=1e7,Ve=!1,yt=1,ot=0,ut={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},wn="0123456789abcdefghijklmnopqrstuvwxyz",m=!0;function p(y,R){var T,I,A,L,B,N,$,W,U=this;if(!(U instanceof p))return new p(y,R);if(R==null){if(y&&y._isBigNumber===!0){U.s=y.s,!y.c||y.e>ke?U.c=U.e=null:y.e<Fe?U.c=[U.e=0]:(U.e=y.e,U.c=y.c.slice());return}if((N=typeof y=="number")&&y*0==0){if(U.s=1/y<0?(y=-y,-1):1,y===~~y){for(L=0,B=y;B>=10;B/=10,L++);L>ke?U.c=U.e=null:(U.e=L,U.c=[y]);return}W=String(y)}else{if(!r.test(W=String(y)))return z(U,W,N);U.s=W.charCodeAt(0)==45?(W=W.slice(1),-1):1}(L=W.indexOf("."))>-1&&(W=W.replace(".","")),(B=W.search(/e/i))>0?(L<0&&(L=B),L+=+W.slice(B+1),W=W.substring(0,B)):L<0&&(L=W.length)}else{if(v(R,2,wn.length,"Base"),R==10&&m)return U=new p(y),j(U,Z+U.e+1,ae);if(W=String(y),N=typeof y=="number"){if(y*0!=0)return z(U,W,N,R);if(U.s=1/y<0?(W=W.slice(1),-1):1,p.DEBUG&&W.replace(/^0\.0*|\./,"").length>15)throw Error(a+y)}else U.s=W.charCodeAt(0)===45?(W=W.slice(1),-1):1;for(T=wn.slice(0,R),L=B=0,$=W.length;B<$;B++)if(T.indexOf(I=W.charAt(B))<0){if(I=="."){if(B>L){L=$;continue}}else if(!A&&(W==W.toUpperCase()&&(W=W.toLowerCase())||W==W.toLowerCase()&&(W=W.toUpperCase()))){A=!0,B=-1,L=0;continue}return z(U,String(y),N,R)}N=!1,W=V(W,R,10,U.s),(L=W.indexOf("."))>-1?W=W.replace(".",""):L=W.length}for(B=0;W.charCodeAt(B)===48;B++);for($=W.length;W.charCodeAt(--$)===48;);if(W=W.slice(B,++$)){if($-=B,N&&p.DEBUG&&$>15&&(y>c||y!==o(y)))throw Error(a+U.s*y);if((L=L-B-1)>ke)U.c=U.e=null;else if(L<Fe)U.c=[U.e=0];else{if(U.e=L,U.c=[],B=(L+1)%u,L<0&&(B+=u),B<$){for(B&&U.c.push(+W.slice(0,B)),$-=u;B<$;)U.c.push(+W.slice(B,B+=u));B=u-(W=W.slice(B)).length}else B-=$;for(;B--;W+="0");U.c.push(+W)}}else U.c=[U.e=0]}p.clone=g,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(y){var R,T;if(y!=null)if(typeof y=="object"){if(y.hasOwnProperty(R="DECIMAL_PLACES")&&(T=y[R],v(T,0,f,R),Z=T),y.hasOwnProperty(R="ROUNDING_MODE")&&(T=y[R],v(T,0,8,R),ae=T),y.hasOwnProperty(R="EXPONENTIAL_AT")&&(T=y[R],T&&T.pop?(v(T[0],-f,0,R),v(T[1],0,f,R),te=T[0],ne=T[1]):(v(T,-f,f,R),te=-(ne=T<0?-T:T))),y.hasOwnProperty(R="RANGE"))if(T=y[R],T&&T.pop)v(T[0],-f,-1,R),v(T[1],1,f,R),Fe=T[0],ke=T[1];else if(v(T,-f,f,R),T)Fe=-(ke=T<0?-T:T);else throw Error(s+R+" cannot be zero: "+T);if(y.hasOwnProperty(R="CRYPTO"))if(T=y[R],T===!!T)if(T)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ve=T;else throw Ve=!T,Error(s+"crypto unavailable");else Ve=T;else throw Error(s+R+" not true or false: "+T);if(y.hasOwnProperty(R="MODULO_MODE")&&(T=y[R],v(T,0,9,R),yt=T),y.hasOwnProperty(R="POW_PRECISION")&&(T=y[R],v(T,0,f,R),ot=T),y.hasOwnProperty(R="FORMAT"))if(T=y[R],typeof T=="object")ut=T;else throw Error(s+R+" not an object: "+T);if(y.hasOwnProperty(R="ALPHABET"))if(T=y[R],typeof T=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(T))m=T.slice(0,10)=="0123456789",wn=T;else throw Error(s+R+" invalid: "+T)}else throw Error(s+"Object expected: "+y);return{DECIMAL_PLACES:Z,ROUNDING_MODE:ae,EXPONENTIAL_AT:[te,ne],RANGE:[Fe,ke],CRYPTO:Ve,MODULO_MODE:yt,POW_PRECISION:ot,FORMAT:ut,ALPHABET:wn}},p.isBigNumber=function(y){if(!y||y._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var R,T,I=y.c,A=y.e,L=y.s;e:if({}.toString.call(I)=="[object Array]"){if((L===1||L===-1)&&A>=-f&&A<=f&&A===o(A)){if(I[0]===0){if(A===0&&I.length===1)return!0;break e}if(R=(A+1)%u,R<1&&(R+=u),String(I[0]).length==R){for(R=0;R<I.length;R++)if(T=I[R],T<0||T>=l||T!==o(T))break e;if(T!==0)return!0}}}else if(I===null&&A===null&&(L===null||L===1||L===-1))return!0;throw Error(s+"Invalid BigNumber: "+y)},p.maximum=p.max=function(){return D(arguments,-1)},p.minimum=p.min=function(){return D(arguments,1)},p.random=function(){var y=9007199254740992,R=Math.random()*y&2097151?function(){return o(Math.random()*y)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(T){var I,A,L,B,N,$=0,W=[],U=new p(G);if(T==null?T=Z:v(T,0,f),B=i(T/u),Ve)if(crypto.getRandomValues){for(I=crypto.getRandomValues(new Uint32Array(B*=2));$<B;)N=I[$]*131072+(I[$+1]>>>11),N>=9e15?(A=crypto.getRandomValues(new Uint32Array(2)),I[$]=A[0],I[$+1]=A[1]):(W.push(N%1e14),$+=2);$=B/2}else if(crypto.randomBytes){for(I=crypto.randomBytes(B*=7);$<B;)N=(I[$]&31)*281474976710656+I[$+1]*1099511627776+I[$+2]*4294967296+I[$+3]*16777216+(I[$+4]<<16)+(I[$+5]<<8)+I[$+6],N>=9e15?crypto.randomBytes(7).copy(I,$):(W.push(N%1e14),$+=7);$=B/7}else throw Ve=!1,Error(s+"crypto unavailable");if(!Ve)for(;$<B;)N=R(),N<9e15&&(W[$++]=N%1e14);for(B=W[--$],T%=u,B&&T&&(N=h[u-T],W[$]=o(B/N)*N);W[$]===0;W.pop(),$--);if($<0)W=[L=0];else{for(L=-1;W[0]===0;W.splice(0,1),L-=u);for($=1,N=W[0];N>=10;N/=10,$++);$<u&&(L-=u-$)}return U.e=L,U.c=W,U}}(),p.sum=function(){for(var y=1,R=arguments,T=new p(R[0]);y<R.length;)T=T.plus(R[y++]);return T},V=function(){var y="0123456789";function R(T,I,A,L){for(var B,N=[0],$,W=0,U=T.length;W<U;){for($=N.length;$--;N[$]*=I);for(N[0]+=L.indexOf(T.charAt(W++)),B=0;B<N.length;B++)N[B]>A-1&&(N[B+1]==null&&(N[B+1]=0),N[B+1]+=N[B]/A|0,N[B]%=A)}return N.reverse()}return function(T,I,A,L,B){var N,$,W,U,q,se,le,Re,We=T.indexOf("."),Be=Z,Ee=ae;for(We>=0&&(U=ot,ot=0,T=T.replace(".",""),Re=new p(I),se=Re.pow(T.length-We),ot=U,Re.c=R(x(C(se.c),se.e,"0"),10,A,y),Re.e=Re.c.length),le=R(T,I,A,B?(N=wn,y):(N=y,wn)),W=U=le.length;le[--U]==0;le.pop());if(!le[0])return N.charAt(0);if(We<0?--W:(se.c=le,se.e=W,se.s=L,se=M(se,Re,Be,Ee,A),le=se.c,q=se.r,W=se.e),$=W+Be+1,We=le[$],U=A/2,q=q||$<0||le[$+1]!=null,q=Ee<4?(We!=null||q)&&(Ee==0||Ee==(se.s<0?3:2)):We>U||We==U&&(Ee==4||q||Ee==6&&le[$-1]&1||Ee==(se.s<0?8:7)),$<1||!le[0])T=q?x(N.charAt(1),-Be,N.charAt(0)):N.charAt(0);else{if(le.length=$,q)for(--A;++le[--$]>A;)le[$]=0,$||(++W,le=[1].concat(le));for(U=le.length;!le[--U];);for(We=0,T="";We<=U;T+=N.charAt(le[We++]));T=x(T,W,N.charAt(0))}return T}}(),M=function(){function y(I,A,L){var B,N,$,W,U=0,q=I.length,se=A%d,le=A/d|0;for(I=I.slice();q--;)$=I[q]%d,W=I[q]/d|0,B=le*$+W*se,N=se*$+B%d*d+U,U=(N/L|0)+(B/d|0)+le*W,I[q]=N%L;return U&&(I=[U].concat(I)),I}function R(I,A,L,B){var N,$;if(L!=B)$=L>B?1:-1;else for(N=$=0;N<L;N++)if(I[N]!=A[N]){$=I[N]>A[N]?1:-1;break}return $}function T(I,A,L,B){for(var N=0;L--;)I[L]-=N,N=I[L]<A[L]?1:0,I[L]=N*B+I[L]-A[L];for(;!I[0]&&I.length>1;I.splice(0,1));}return function(I,A,L,B,N){var $,W,U,q,se,le,Re,We,Be,Ee,Se,nt,nr,No,pi,hn,bt,_t=I.s==A.s?1:-1,wt=I.c,Qe=A.c;if(!wt||!wt[0]||!Qe||!Qe[0])return new p(!I.s||!A.s||(wt?Qe&&wt[0]==Qe[0]:!Qe)?NaN:wt&&wt[0]==0||!Qe?_t*0:_t/0);for(We=new p(_t),Be=We.c=[],W=I.e-A.e,_t=L+W+1,N||(N=l,W=w(I.e/u)-w(A.e/u),_t=_t/u|0),U=0;Qe[U]==(wt[U]||0);U++);if(Qe[U]>(wt[U]||0)&&W--,_t<0)Be.push(1),q=!0;else{for(No=wt.length,hn=Qe.length,U=0,_t+=2,se=o(N/(Qe[0]+1)),se>1&&(Qe=y(Qe,se,N),wt=y(wt,se,N),hn=Qe.length,No=wt.length),nr=hn,Ee=wt.slice(0,hn),Se=Ee.length;Se<hn;Ee[Se++]=0);bt=Qe.slice(),bt=[0].concat(bt),pi=Qe[0],Qe[1]>=N/2&&pi++;do{if(se=0,$=R(Qe,Ee,hn,Se),$<0){if(nt=Ee[0],hn!=Se&&(nt=nt*N+(Ee[1]||0)),se=o(nt/pi),se>1)for(se>=N&&(se=N-1),le=y(Qe,se,N),Re=le.length,Se=Ee.length;R(le,Ee,Re,Se)==1;)se--,T(le,hn<Re?bt:Qe,Re,N),Re=le.length,$=1;else se==0&&($=se=1),le=Qe.slice(),Re=le.length;if(Re<Se&&(le=[0].concat(le)),T(Ee,le,Se,N),Se=Ee.length,$==-1)for(;R(Qe,Ee,hn,Se)<1;)se++,T(Ee,hn<Se?bt:Qe,Se,N),Se=Ee.length}else $===0&&(se++,Ee=[0]);Be[U++]=se,Ee[0]?Ee[Se++]=wt[nr]||0:(Ee=[wt[nr]],Se=1)}while((nr++<No||Ee[0]!=null)&&_t--);q=Ee[0]!=null,Be[0]||Be.splice(0,1)}if(N==l){for(U=1,_t=Be[0];_t>=10;_t/=10,U++);j(We,L+(We.e=U+W*u-1)+1,B,q)}else We.e=W,We.r=+q;return We}}();function b(y,R,T,I){var A,L,B,N,$;if(T==null?T=ae:v(T,0,8),!y.c)return y.toString();if(A=y.c[0],B=y.e,R==null)$=C(y.c),$=I==1||I==2&&(B<=te||B>=ne)?P($,B):x($,B,"0");else if(y=j(new p(y),R,T),L=y.e,$=C(y.c),N=$.length,I==1||I==2&&(R<=L||L<=te)){for(;N<R;$+="0",N++);$=P($,L)}else if(R-=B,$=x($,L,"0"),L+1>N){if(--R>0)for($+=".";R--;$+="0");}else if(R+=L-N,R>0)for(L+1==N&&($+=".");R--;$+="0");return y.s<0&&A?"-"+$:$}function D(y,R){for(var T,I,A=1,L=new p(y[0]);A<y.length;A++)I=new p(y[A]),(!I.s||(T=S(L,I))===R||T===0&&L.s===R)&&(L=I);return L}function F(y,R,T){for(var I=1,A=R.length;!R[--A];R.pop());for(A=R[0];A>=10;A/=10,I++);return(T=I+T*u-1)>ke?y.c=y.e=null:T<Fe?y.c=[y.e=0]:(y.e=T,y.c=R),y}z=function(){var y=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,T=/^\.([^.]+)$/,I=/^-?(Infinity|NaN)$/,A=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(L,B,N,$){var W,U=N?B:B.replace(A,"");if(I.test(U))L.s=isNaN(U)?null:U<0?-1:1;else{if(!N&&(U=U.replace(y,function(q,se,le){return W=(le=le.toLowerCase())=="x"?16:le=="b"?2:8,!$||$==W?se:q}),$&&(W=$,U=U.replace(R,"$1").replace(T,"0.$1")),B!=U))return new p(U,W);if(p.DEBUG)throw Error(s+"Not a"+($?" base "+$:"")+" number: "+B);L.s=null}L.c=L.e=null}}();function j(y,R,T,I){var A,L,B,N,$,W,U,q=y.c,se=h;if(q){e:{for(A=1,N=q[0];N>=10;N/=10,A++);if(L=R-A,L<0)L+=u,B=R,$=q[W=0],U=o($/se[A-B-1]%10);else if(W=i((L+1)/u),W>=q.length)if(I){for(;q.length<=W;q.push(0));$=U=0,A=1,L%=u,B=L-u+1}else break e;else{for($=N=q[W],A=1;N>=10;N/=10,A++);L%=u,B=L-u+A,U=B<0?0:o($/se[A-B-1]%10)}if(I=I||R<0||q[W+1]!=null||(B<0?$:$%se[A-B-1]),I=T<4?(U||I)&&(T==0||T==(y.s<0?3:2)):U>5||U==5&&(T==4||I||T==6&&(L>0?B>0?$/se[A-B]:0:q[W-1])%10&1||T==(y.s<0?8:7)),R<1||!q[0])return q.length=0,I?(R-=y.e+1,q[0]=se[(u-R%u)%u],y.e=-R||0):q[0]=y.e=0,y;if(L==0?(q.length=W,N=1,W--):(q.length=W+1,N=se[u-L],q[W]=B>0?o($/se[A-B]%se[B])*N:0),I)for(;;)if(W==0){for(L=1,B=q[0];B>=10;B/=10,L++);for(B=q[0]+=N,N=1;B>=10;B/=10,N++);L!=N&&(y.e++,q[0]==l&&(q[0]=1));break}else{if(q[W]+=N,q[W]!=l)break;q[W--]=0,N=1}for(L=q.length;q[--L]===0;q.pop());}y.e>ke?y.c=y.e=null:y.e<Fe&&(y.c=[y.e=0])}return y}function K(y){var R,T=y.e;return T===null?y.toString():(R=C(y.c),R=T<=te||T>=ne?P(R,T):x(R,T,"0"),y.s<0?"-"+R:R)}return O.absoluteValue=O.abs=function(){var y=new p(this);return y.s<0&&(y.s=1),y},O.comparedTo=function(y,R){return S(this,new p(y,R))},O.decimalPlaces=O.dp=function(y,R){var T,I,A,L=this;if(y!=null)return v(y,0,f),R==null?R=ae:v(R,0,8),j(new p(L),y+L.e+1,R);if(!(T=L.c))return null;if(I=((A=T.length-1)-w(this.e/u))*u,A=T[A])for(;A%10==0;A/=10,I--);return I<0&&(I=0),I},O.dividedBy=O.div=function(y,R){return M(this,new p(y,R),Z,ae)},O.dividedToIntegerBy=O.idiv=function(y,R){return M(this,new p(y,R),0,1)},O.exponentiatedBy=O.pow=function(y,R){var T,I,A,L,B,N,$,W,U,q=this;if(y=new p(y),y.c&&!y.isInteger())throw Error(s+"Exponent not an integer: "+K(y));if(R!=null&&(R=new p(R)),N=y.e>14,!q.c||!q.c[0]||q.c[0]==1&&!q.e&&q.c.length==1||!y.c||!y.c[0])return U=new p(Math.pow(+K(q),N?y.s*(2-E(y)):+K(y))),R?U.mod(R):U;if($=y.s<0,R){if(R.c?!R.c[0]:!R.s)return new p(NaN);I=!$&&q.isInteger()&&R.isInteger(),I&&(q=q.mod(R))}else{if(y.e>9&&(q.e>0||q.e<-1||(q.e==0?q.c[0]>1||N&&q.c[1]>=24e7:q.c[0]<8e13||N&&q.c[0]<=9999975e7)))return L=q.s<0&&E(y)?-0:0,q.e>-1&&(L=1/L),new p($?1/L:L);ot&&(L=i(ot/u+2))}for(N?(T=new p(.5),$&&(y.s=1),W=E(y)):(A=Math.abs(+K(y)),W=A%2),U=new p(G);;){if(W){if(U=U.times(q),!U.c)break;L?U.c.length>L&&(U.c.length=L):I&&(U=U.mod(R))}if(A){if(A=o(A/2),A===0)break;W=A%2}else if(y=y.times(T),j(y,y.e+1,1),y.e>14)W=E(y);else{if(A=+K(y),A===0)break;W=A%2}q=q.times(q),L?q.c&&q.c.length>L&&(q.c.length=L):I&&(q=q.mod(R))}return I?U:($&&(U=G.div(U)),R?U.mod(R):L?j(U,ot,ae,B):U)},O.integerValue=function(y){var R=new p(this);return y==null?y=ae:v(y,0,8),j(R,R.e+1,y)},O.isEqualTo=O.eq=function(y,R){return S(this,new p(y,R))===0},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(y,R){return S(this,new p(y,R))>0},O.isGreaterThanOrEqualTo=O.gte=function(y,R){return(R=S(this,new p(y,R)))===1||R===0},O.isInteger=function(){return!!this.c&&w(this.e/u)>this.c.length-2},O.isLessThan=O.lt=function(y,R){return S(this,new p(y,R))<0},O.isLessThanOrEqualTo=O.lte=function(y,R){return(R=S(this,new p(y,R)))===-1||R===0},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&this.c[0]==0},O.minus=function(y,R){var T,I,A,L,B=this,N=B.s;if(y=new p(y,R),R=y.s,!N||!R)return new p(NaN);if(N!=R)return y.s=-R,B.plus(y);var $=B.e/u,W=y.e/u,U=B.c,q=y.c;if(!$||!W){if(!U||!q)return U?(y.s=-R,y):new p(q?B:NaN);if(!U[0]||!q[0])return q[0]?(y.s=-R,y):new p(U[0]?B:ae==3?-0:0)}if($=w($),W=w(W),U=U.slice(),N=$-W){for((L=N<0)?(N=-N,A=U):(W=$,A=q),A.reverse(),R=N;R--;A.push(0));A.reverse()}else for(I=(L=(N=U.length)<(R=q.length))?N:R,N=R=0;R<I;R++)if(U[R]!=q[R]){L=U[R]<q[R];break}if(L&&(A=U,U=q,q=A,y.s=-y.s),R=(I=q.length)-(T=U.length),R>0)for(;R--;U[T++]=0);for(R=l-1;I>N;){if(U[--I]<q[I]){for(T=I;T&&!U[--T];U[T]=R);--U[T],U[I]+=l}U[I]-=q[I]}for(;U[0]==0;U.splice(0,1),--W);return U[0]?F(y,U,W):(y.s=ae==3?-1:1,y.c=[y.e=0],y)},O.modulo=O.mod=function(y,R){var T,I,A=this;return y=new p(y,R),!A.c||!y.s||y.c&&!y.c[0]?new p(NaN):!y.c||A.c&&!A.c[0]?new p(A):(yt==9?(I=y.s,y.s=1,T=M(A,y,0,3),y.s=I,T.s*=I):T=M(A,y,0,yt),y=A.minus(T.times(y)),!y.c[0]&&yt==1&&(y.s=A.s),y)},O.multipliedBy=O.times=function(y,R){var T,I,A,L,B,N,$,W,U,q,se,le,Re,We,Be,Ee=this,Se=Ee.c,nt=(y=new p(y,R)).c;if(!Se||!nt||!Se[0]||!nt[0])return!Ee.s||!y.s||Se&&!Se[0]&&!nt||nt&&!nt[0]&&!Se?y.c=y.e=y.s=null:(y.s*=Ee.s,!Se||!nt?y.c=y.e=null:(y.c=[0],y.e=0)),y;for(I=w(Ee.e/u)+w(y.e/u),y.s*=Ee.s,$=Se.length,q=nt.length,$<q&&(Re=Se,Se=nt,nt=Re,A=$,$=q,q=A),A=$+q,Re=[];A--;Re.push(0));for(We=l,Be=d,A=q;--A>=0;){for(T=0,se=nt[A]%Be,le=nt[A]/Be|0,B=$,L=A+B;L>A;)W=Se[--B]%Be,U=Se[B]/Be|0,N=le*W+U*se,W=se*W+N%Be*Be+Re[L]+T,T=(W/We|0)+(N/Be|0)+le*U,Re[L--]=W%We;Re[L]=T}return T?++I:Re.splice(0,1),F(y,Re,I)},O.negated=function(){var y=new p(this);return y.s=-y.s||null,y},O.plus=function(y,R){var T,I=this,A=I.s;if(y=new p(y,R),R=y.s,!A||!R)return new p(NaN);if(A!=R)return y.s=-R,I.minus(y);var L=I.e/u,B=y.e/u,N=I.c,$=y.c;if(!L||!B){if(!N||!$)return new p(A/0);if(!N[0]||!$[0])return $[0]?y:new p(N[0]?I:A*0)}if(L=w(L),B=w(B),N=N.slice(),A=L-B){for(A>0?(B=L,T=$):(A=-A,T=N),T.reverse();A--;T.push(0));T.reverse()}for(A=N.length,R=$.length,A-R<0&&(T=$,$=N,N=T,R=A),A=0;R;)A=(N[--R]=N[R]+$[R]+A)/l|0,N[R]=l===N[R]?0:N[R]%l;return A&&(N=[A].concat(N),++B),F(y,N,B)},O.precision=O.sd=function(y,R){var T,I,A,L=this;if(y!=null&&y!==!!y)return v(y,1,f),R==null?R=ae:v(R,0,8),j(new p(L),y,R);if(!(T=L.c))return null;if(A=T.length-1,I=A*u+1,A=T[A]){for(;A%10==0;A/=10,I--);for(A=T[0];A>=10;A/=10,I++);}return y&&L.e+1>I&&(I=L.e+1),I},O.shiftedBy=function(y){return v(y,-c,c),this.times("1e"+y)},O.squareRoot=O.sqrt=function(){var y,R,T,I,A,L=this,B=L.c,N=L.s,$=L.e,W=Z+4,U=new p("0.5");if(N!==1||!B||!B[0])return new p(!N||N<0&&(!B||B[0])?NaN:B?L:1/0);if(N=Math.sqrt(+K(L)),N==0||N==1/0?(R=C(B),(R.length+$)%2==0&&(R+="0"),N=Math.sqrt(+R),$=w(($+1)/2)-($<0||$%2),N==1/0?R="5e"+$:(R=N.toExponential(),R=R.slice(0,R.indexOf("e")+1)+$),T=new p(R)):T=new p(N+""),T.c[0]){for($=T.e,N=$+W,N<3&&(N=0);;)if(A=T,T=U.times(A.plus(M(L,A,W,1))),C(A.c).slice(0,N)===(R=C(T.c)).slice(0,N))if(T.e<$&&--N,R=R.slice(N-3,N+1),R=="9999"||!I&&R=="4999"){if(!I&&(j(A,A.e+Z+2,0),A.times(A).eq(L))){T=A;break}W+=4,N+=4,I=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(j(T,T.e+Z+2,1),y=!T.times(T).eq(L));break}}return j(T,T.e+Z+1,ae,y)},O.toExponential=function(y,R){return y!=null&&(v(y,0,f),y++),b(this,y,R,1)},O.toFixed=function(y,R){return y!=null&&(v(y,0,f),y=y+this.e+1),b(this,y,R)},O.toFormat=function(y,R,T){var I,A=this;if(T==null)y!=null&&R&&typeof R=="object"?(T=R,R=null):y&&typeof y=="object"?(T=y,y=R=null):T=ut;else if(typeof T!="object")throw Error(s+"Argument not an object: "+T);if(I=A.toFixed(y,R),A.c){var L,B=I.split("."),N=+T.groupSize,$=+T.secondaryGroupSize,W=T.groupSeparator||"",U=B[0],q=B[1],se=A.s<0,le=se?U.slice(1):U,Re=le.length;if($&&(L=N,N=$,$=L,Re-=L),N>0&&Re>0){for(L=Re%N||N,U=le.substr(0,L);L<Re;L+=N)U+=W+le.substr(L,N);$>0&&(U+=W+le.slice(L)),se&&(U="-"+U)}I=q?U+(T.decimalSeparator||"")+(($=+T.fractionGroupSize)?q.replace(new RegExp("\\d{"+$+"}\\B","g"),"$&"+(T.fractionGroupSeparator||"")):q):U}return(T.prefix||"")+I+(T.suffix||"")},O.toFraction=function(y){var R,T,I,A,L,B,N,$,W,U,q,se,le=this,Re=le.c;if(y!=null&&(N=new p(y),!N.isInteger()&&(N.c||N.s!==1)||N.lt(G)))throw Error(s+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+K(N));if(!Re)return new p(le);for(R=new p(G),W=T=new p(G),I=$=new p(G),se=C(Re),L=R.e=se.length-le.e-1,R.c[0]=h[(B=L%u)<0?u+B:B],y=!y||N.comparedTo(R)>0?L>0?R:W:N,B=ke,ke=1/0,N=new p(se),$.c[0]=0;U=M(N,R,0,1),A=T.plus(U.times(I)),A.comparedTo(y)!=1;)T=I,I=A,W=$.plus(U.times(A=W)),$=A,R=N.minus(U.times(A=R)),N=A;return A=M(y.minus(T),I,0,1),$=$.plus(A.times(W)),T=T.plus(A.times(I)),$.s=W.s=le.s,L=L*2,q=M(W,I,L,ae).minus(le).abs().comparedTo(M($,T,L,ae).minus(le).abs())<1?[W,I]:[$,T],ke=B,q},O.toNumber=function(){return+K(this)},O.toPrecision=function(y,R){return y!=null&&v(y,1,f),b(this,y,R,2)},O.toString=function(y){var R,T=this,I=T.s,A=T.e;return A===null?I?(R="Infinity",I<0&&(R="-"+R)):R="NaN":(y==null?R=A<=te||A>=ne?P(C(T.c),A):x(C(T.c),A,"0"):y===10&&m?(T=j(new p(T),Z+A+1,ae),R=x(C(T.c),T.e,"0")):(v(y,2,wn.length,"Base"),R=V(x(C(T.c),A,"0"),10,y,I,!0)),I<0&&T.c[0]&&(R="-"+R)),R},O.valueOf=O.toJSON=function(){return K(this)},O._isBigNumber=!0,_!=null&&p.set(_),p}function w(_){var M=_|0;return _>0||_===M?M:M-1}function C(_){for(var M,V,z=1,O=_.length,G=_[0]+"";z<O;){for(M=_[z++]+"",V=u-M.length;V--;M="0"+M);G+=M}for(O=G.length;G.charCodeAt(--O)===48;);return G.slice(0,O+1||1)}function S(_,M){var V,z,O=_.c,G=M.c,Z=_.s,ae=M.s,te=_.e,ne=M.e;if(!Z||!ae)return null;if(V=O&&!O[0],z=G&&!G[0],V||z)return V?z?0:-ae:Z;if(Z!=ae)return Z;if(V=Z<0,z=te==ne,!O||!G)return z?0:!O^V?1:-1;if(!z)return te>ne^V?1:-1;for(ae=(te=O.length)<(ne=G.length)?te:ne,Z=0;Z<ae;Z++)if(O[Z]!=G[Z])return O[Z]>G[Z]^V?1:-1;return te==ne?0:te>ne^V?1:-1}function v(_,M,V,z){if(_<M||_>V||_!==o(_))throw Error(s+(z||"Argument")+(typeof _=="number"?_<M||_>V?" out of range: ":" not an integer: ":" not a primitive number: ")+String(_))}function E(_){var M=_.c.length-1;return w(_.e/u)==M&&_.c[M]%2!=0}function P(_,M){return(_.length>1?_.charAt(0)+"."+_.slice(1):_)+(M<0?"e":"e+")+M}function x(_,M,V){var z,O;if(M<0){for(O=V+".";++M;O+=V);_=O+_}else if(z=_.length,++M>z){for(O=V,M-=z;--M;O+=V);_+=O}else M<z&&(_=_.slice(0,M)+"."+_.slice(M));return _}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(cJ)})(uF);var cF=uF.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ii=P_(),AJ=M_(),HJ=I_,NJ=cF,Rn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},pf={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:hF,decimalSuffixes:lp}=Ii.currentBytes(),O_={general:{scale:1024,suffixes:lp},binary:{scale:1024,suffixes:hF},decimal:{scale:1e3,suffixes:lp}};function DJ(t,e={},n){if(typeof e=="string"&&(e=HJ.parseFormat(e)),!AJ.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=kJ(t,e,n);return s=tQ(s,i),s=nQ(s,o),s}function kJ(t,e,n){switch(e.output){case"currency":return e=Wu(e,Ii.currentCurrencyDefaultFormat()),UJ(t,e,Ii);case"percent":return e=Wu(e,Ii.currentPercentageDefaultFormat()),jJ(t,e,Ii,n);case"byte":return e=Wu(e,Ii.currentByteDefaultFormat()),VJ(t,e,Ii,n);case"time":return e=Wu(e,Ii.currentTimeDefaultFormat()),BJ(t);case"ordinal":return e=Wu(e,Ii.currentOrdinalDefaultFormat()),WJ(t,e,Ii);case"number":default:return wf({instance:t,providedFormat:e})}}function LJ(t){let e=O_.decimal;return Mw(t._value,e.suffixes,e.scale).suffix}function $J(t){let e=O_.binary;return Mw(t._value,e.suffixes,e.scale).suffix}function FJ(t){let e=O_.general;return Mw(t._value,e.suffixes,e.scale).suffix}function Mw(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function VJ(t,e,n,r){let i=e.base||"binary",o=Object.assign({},pf,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||lp,marker:"bd"},binary:{scale:1024,suffixes:s||hF,marker:"b"},decimal:{scale:1e3,suffixes:a||lp,marker:"d"}}[i],{value:c,suffix:h}=Mw(t._value,u.suffixes,u.scale);return`${wf({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function WJ(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},pf,e),o=wf({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function BJ(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function jJ(t,e,n,r){let i=e.prefixSymbol,o=wf({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},pf,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function UJ(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},pf,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=wf({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function zJ({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&Rn[e]?(a=r[e],t=t/Rn[e]):l>=Rn.trillion||n&&s(l/Rn.trillion)===1?(a=r.trillion,t=t/Rn.trillion):l<Rn.trillion&&l>=Rn.billion||n&&s(l/Rn.billion)===1?(a=r.billion,t=t/Rn.billion):l<Rn.billion&&l>=Rn.million||n&&s(l/Rn.million)===1?(a=r.million,t=t/Rn.million):(l<Rn.million&&l>=Rn.thousand||n&&s(l/Rn.thousand)===1)&&(a=r.thousand,t=t/Rn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function YJ({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function pg(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function GJ(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+pg(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(pg(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=pg(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${pg(e)}`),n}function qJ(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?GJ(t,e):new NJ(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function KJ(t,e,n,r,i,o){if(r===-1)return t;let s=qJ(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function XJ(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function ZJ(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function JJ(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),ZJ(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function QJ(t,e){return t+e}function eQ(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function tQ(t,e){return e+t}function nQ(t,e){return t+e}function wf({instance:t,providedFormat:e,state:n=Ii,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},pf,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,w=s.trimMantissa,C=s.thousandSeparated,S=s.spaceSeparated,v=s.negative,E=s.forceSign,P=s.exponential,x=s.roundingFunction,_="";if(d){let V=zJ({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:S,roundingFunction:x,totalLength:a});o=V.value,_+=V.abbreviation,a&&(f=V.mantissaPrecision)}if(P){let V=YJ({value:o,characteristicPrecision:l});o=V.value,_=V.abbreviation+_}let M=KJ(o.toString(),o,g,f,w,x);return M=XJ(M,o,u,l),M=JJ(M,o,C,n,r),(d||P)&&(M=QJ(M,_)),(E||o<0)&&(M=eQ(M,o,v)),M}function Wu(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var rQ=t=>({format:(...e)=>DJ(...e,t),getByteUnit:(...e)=>FJ(...e,t),getBinaryByteUnit:(...e)=>$J(...e,t),getDecimalByteUnit:(...e)=>LJ(...e,t),formatOrDefault:Wu});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const vs=cF;function iQ(t,e,n){let r=new vs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new vs(i),t._value=r.plus(i).toNumber(),t}function dF(t,e,n){let r=new vs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new vs(i),t._value=r.minus(i).toNumber(),t}function oQ(t,e,n){let r=new vs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new vs(i),t._value=r.times(i).toNumber(),t}function sQ(t,e,n){let r=new vs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new vs(i),t._value=r.dividedBy(i).toNumber(),t}function aQ(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function lQ(t,e,n){let r=n(t._value);return dF(r,e,n),Math.abs(r._value)}var uQ=t=>({add:(e,n)=>iQ(e,n,t),subtract:(e,n)=>dF(e,n,t),multiply:(e,n)=>oQ(e,n,t),divide:(e,n)=>sQ(e,n,t),set:(e,n)=>aQ(e,n,t),difference:(e,n)=>lQ(e,n,t),BigNumber:vs});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const cQ="2.5.0",Ho=P_(),hQ=M_(),dQ=xJ(Ut),fQ=lF();let Na=rQ(Ut),sl=uQ(Ut);const gQ=I_;class fF{constructor(e){this._value=e}clone(){return Ut(this._value)}format(e={}){return Na.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=gQ.parseFormat(e)),e=Na.formatOrDefault(e,Ho.currentCurrencyDefaultFormat()),e.output="currency",Na.format(this,e)}formatTime(e={}){return e.output="time",Na.format(this,e)}binaryByteUnits(){return Na.getBinaryByteUnit(this)}decimalByteUnits(){return Na.getDecimalByteUnit(this)}byteUnits(){return Na.getByteUnit(this)}difference(e){return sl.difference(this,e)}add(e){return sl.add(this,e)}subtract(e){return sl.subtract(this,e)}multiply(e){return sl.multiply(this,e)}divide(e){return sl.divide(this,e)}set(e){return sl.set(this,gF(e))}value(){return this._value}valueOf(){return this._value}}function gF(t){let e=t;return Ut.isNumbro(t)?e=t._value:typeof t=="string"?e=Ut.unformat(t):isNaN(t)&&(e=NaN),e}function Ut(t){return new fF(gF(t))}Ut.version=cQ;Ut.isNumbro=function(t){return t instanceof fF};Ut.language=Ho.currentLanguage;Ut.registerLanguage=Ho.registerLanguage;Ut.setLanguage=Ho.setLanguage;Ut.languages=Ho.languages;Ut.languageData=Ho.languageData;Ut.zeroFormat=Ho.setZeroFormat;Ut.defaultFormat=Ho.currentDefaults;Ut.setDefaults=Ho.setDefaults;Ut.defaultCurrencyFormat=Ho.currentCurrencyDefaultFormat;Ut.validate=hQ.validate;Ut.loadLanguagesInNode=dQ.loadLanguagesInNode;Ut.unformat=fQ.unformat;Ut.BigNumber=sl.BigNumber;var mQ=Ut,Da=hJ(mQ);const pQ="numeric";function mF(t,e){if(Zn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!Da.languages()[r]){const o=r.replace("-",""),s=Da.allLanguages?Da.allLanguages[r]:Da[o];s&&Da.registerLanguage(s)}Da.setLanguage(r),t=Da(t).format(i||"0")}return t}function x_(t,e,n,r,i,o,s){let a=o;if(Zn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=mF(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}Ts(t,e,n,r,i,a,s)}x_.RENDERER_TYPE=pQ;const wQ="password";function A_(t,e,n,r,i,o,s){Ts.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";de(a-1,()=>{u+=l}),Ac(e,u)}A_.RENDERER_TYPE=wQ;const vQ="select";function H_(t,e,n,r,i,o,s){Ts.apply(this,[t,e,n,r,i,o,s])}H_.RENDERER_TYPE=vQ;const CQ="time";function N_(t,e,n,r,i,o,s){Ts.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}N_.RENDERER_TYPE=CQ;function yQ(){Kr(kc),Kr(mf),Kr(E_),Kr(R_),Kr(__),Kr(S_),Kr(x_),Kr(A_),Kr(H_),Kr(Ts),Kr(N_)}const bQ="autocomplete";function Iw(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,uH(n,e)):uH(n,e)(this.source):e(!0)}Iw.VALIDATOR_TYPE=bQ;function uH(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function SQ(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const RQ="date";function D_(t,e){const n=jL(eF,this.instance);let r=t,i=!0;r==null&&(r="");let o=J(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=J(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=EQ(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}D_.VALIDATOR_TYPE=RQ;function EQ(t,e){const n=J(SQ(t)),r=J(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const TQ="dropdown";function k_(t,e){Iw.apply(this,[t,e])}k_.VALIDATOR_TYPE=TQ;const _Q="numeric";function L_(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Zn(t))}L_.VALIDATOR_TYPE=_Q;const MQ=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],IQ="time";function $_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=J(i,MQ,!0).isValid()?J(i):J(i,n);let a=s.isValid(),l=J(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}$_.VALIDATOR_TYPE=IQ;function PQ(){Fu(Iw),Fu(k_),Fu(D_),Fu(L_),Fu($_)}const OQ="autocomplete",xQ={CELL_TYPE:OQ,editor:y_,renderer:kc,validator:Iw},AQ="checkbox",HQ={CELL_TYPE:AQ,editor:Q$,renderer:E_},NQ="date";function pF(t,e,n,r,i,o,s){kc.apply(this,[t,e,n,r,i,o,s])}pF.RENDERER_TYPE=NQ;const DQ="date",kQ={CELL_TYPE:DQ,editor:tF,renderer:pF,validator:D_},LQ="dropdown",$Q={CELL_TYPE:LQ,editor:nF,renderer:R_,validator:k_,filter:!1,strict:!0},FQ="handsontable",VQ={CELL_TYPE:FQ,editor:C_,renderer:__},WQ="numeric",BQ={CELL_TYPE:WQ,editor:rF,renderer:x_,validator:L_,dataType:"number"},jQ="password",UQ={CELL_TYPE:jQ,editor:iF,renderer:A_,copyable:!1},zQ="select",YQ={CELL_TYPE:zQ,editor:oF,renderer:H_},GQ="time",qQ={CELL_TYPE:GQ,editor:sF,renderer:N_,validator:$_};function KQ(){Ti(xQ),Ti(HQ),Ti(kQ),Ti($Q),Ti(VQ),Ti(BQ),Ti(UQ),Ti(YQ),Ti(K$),Ti(qQ)}function XQ(t,e){wF(t,e),e.add(t)}function ZQ(t,e,n){wF(t,e),e.set(t,n)}function wF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lu(t,e,n){return(e=JQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JQ(t){var e=QQ(t,"string");return typeof e=="symbol"?e:e+""}function QQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uu(t,e){return t.get(vF(t,e))}function vF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cH=new Map([["plugin",PX],["cell-type",k$],["editor",BL],["renderer",XL],["validator",ZL]]),CF=Symbol("mainSetting"),eee="base",wg=[];let ka=null;var La=new WeakMap,hH=new WeakSet;class Je{static get PLUGIN_KEY(){return eee}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){XQ(this,hH),lu(this,"eventManager",new Wi(this)),lu(this,"pluginName",null),lu(this,"pluginsInitializedCallbacks",[]),lu(this,"isPluginsReady",!1),lu(this,"enabled",!1),lu(this,"initialized",!1),ZQ(this,La,{}),Rs(this,"hot",e,{writable:!1}),ka=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!cH.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);cH.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");wg.push(o)}}if(ka||(ka=KL()),ka.indexOf(this.pluginName)>=0&&ka.splice(ka.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ka.length===0){if(wg.length>0){const i=[`${wg.join(`
`)}
`,"You have to import and register them manually."].join("");throw wg.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||Ne(n))&&r[CF]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(Ne(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){uu(La,this)[e]=uu(La,this)[e]||[];const i=uu(La,this)[e];this.hot.addHook(e,n,r),i.push(n),uu(La,this)[e]=i}removeHooks(e){H(uu(La,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=uu(La,this);De(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){H(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=vF(hH,this,tee).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),De(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function tee(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function $a(t,e,n){return(e=nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nee(t){var e=ree(t,"string");return typeof e=="symbol"?e:e+""}function ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let yF=class{constructor(e){$a(this,"hot",null),$a(this,"container",null),$a(this,"injected",!1),$a(this,"rows",[]),$a(this,"columns",[]),$a(this,"samples",null),$a(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&X(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),H(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),H(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{H(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{H(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{H(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),H(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{H(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),X(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return X(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function vg(t,e,n){return(e=iee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iee(t){var e=oee(t,"string");return typeof e=="symbol"?e:e+""}function oee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pw{static get SAMPLE_COUNT(){return 3}constructor(e){vg(this,"samples",null),vg(this,"dataFactory",null),vg(this,"customSampleCount",null),vg(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Pw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return de(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return de(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Ne(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Ot(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function see(t,e){bF(t,e),e.add(t)}function Wb(t,e,n){bF(t,e),e.set(t,n)}function bF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ph(t,e,n){return(e=aee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aee(t){var e=lee(t,"string");return typeof e=="symbol"?e:e+""}function lee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ra(t,e){return t.get(mr(t,e))}function up(t,e,n){return t.set(mr(t,e),n),n}function mr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutoColumnSizeSeed");const Bb="autoColumnSize",uee=10,cee="autoColumnSize";var F_=new WeakMap,Bu=new WeakMap,yc=new WeakMap,Ar=new WeakSet;class ud extends Je{static get PLUGIN_KEY(){return Bb}static get PLUGIN_PRIORITY(){return uee}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),see(this,Ar),ph(this,"ghostTable",new yF(this.hot)),ph(this,"samplesGenerator",new Pw((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),ph(this,"inProgress",!1),ph(this,"measuredColumns",0),ph(this,"columnWidthsMap",new Ca),Wb(this,F_,!1),Wb(this,Bu,[]),Wb(this,yc,[]),this.hot.columnIndexMapper.registerMap(cee,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>mr(Ar,this,dH).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Bb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mr(Ar,e,fee).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mr(Ar,e,gee).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mr(Ar,e,pee).call(e,...i)}),this.addHook("beforeRender",()=>mr(Ar,this,dee).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>mr(Ar,this,mee).call(this)),super.enablePlugin()}updatePlugin(){up(yc,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>mr(Ar,this,dH).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;de(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&mr(Ar,this,SF).call(this,s,o)}),this.ghostTable.columns.length&&(mr(Ar,this,RF).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Zm(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+ud.CALCULATION_STEP,i)},e,n),r=r+ud.CALCULATION_STEP+1,r<i?o=Xm(s):(Zm(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Bb];let n=ud.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Ne(e)&&(n=e.syncLimit,hL(n)?n=YL(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,mc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=ra(Bu,this).length;return(s-1<o||ra(Bu,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?ra(Bu,this).push(i):ra(Bu,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function hee(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||mr(Ar,this,SF).call(this,n,e))}),this.ghostTable.columns.length&&(mr(Ar,this,RF).call(this),this.ghostTable.clean())}function SF(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function RF(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function dee(){this.calculateVisibleColumnsWidth(),this.inProgress||(mr(Ar,this,hee).call(this,ra(yc,this)),up(yc,this,[]))}function fee(t,e){e||this.recalculateAllColumnsWidth()}function gee(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);ra(yc,this).push(...e)}function dH(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function mee(){up(Bu,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),up(F_,this,!0)}function pee(t){if(!ra(F_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);ra(yc,this).push(...e)}const gl={horizontal:"horizontal",vertical:"vertical"};function wee(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function vee(t){const e={};return t===!0?(e.directions=Object.keys(gl),e.autoInsertRow=!0):Ne(t)?(ue(t.autoInsertRow)?t.direction===gl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ue(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(gl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Cee(t,e){yee(t,e),e.add(t)}function yee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cu(t,e,n){return(e=bee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bee(t){var e=See(t,"string");return typeof e=="symbol"?e:e+""}function See(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutofillRange");ie.getSingleton().register("beforeAutofill");ie.getSingleton().register("afterAutofill");const fH="autofill",Ree=20,Eee=["fillHandle"],Tee="insert_row_below",_ee=200;var hu=new WeakSet;class Mee extends Je{constructor(){super(...arguments),Cee(this,hu),cu(this,"addingStarted",!1),cu(this,"mouseDownOnCellCorner",!1),cu(this,"mouseDragOutside",!1),cu(this,"handleDraggedCells",0),cu(this,"directions",[]),cu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return fH}static get PLUGIN_PRIORITY(){return Ree}static get SETTING_KEYS(){return[fH,...Eee]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>wh(hu,this,Pee).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>wh(hu,this,Iee).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>wh(hu,this,Oee).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return H(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),H(a,c=>{const h=[];H(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=wee(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),w=this.hot._createCellRange(h,h,d),C=this.hot.runHooks("beforeAutofill",f,g,w,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let S=C;const v=C;if(["up","left"].indexOf(c)>-1&&!(v.length===1&&v[0].length===0))if(S=[],c==="up"){const E=d.row-h.row+1,P=E%v.length;for(let x=0;x<E;x++)S.push(v[(x+(v.length-P))%v.length])}else{const E=d.col-h.col+1,P=E%v[0].length;for(let x=0;x<v.length;x++){S.push([]);for(let _=0;_<E;_++)S[x].push(v[x][(_+(v[x].length-P))%v[x].length])}}this.hot.populateFromArray(h.row,h.col,S,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",S,g,w,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(gl.vertical)&&this.directions.includes(gl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(gl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(gl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Tee,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},_ee)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!jt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!jt(s)||!jt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...je(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=kn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+on(this.hot.table),i=kn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+qt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>wh(hu,this,xee).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>wh(hu,this,Aee).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=vee(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Iee(){this.selectAdjacent()&&this.fillIn()}function Pee(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Oee(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function xee(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Aee(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Hee(t,e){EF(t,e),e.add(t)}function gH(t,e,n){EF(t,e),e.set(t,n)}function EF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function du(t,e,n){return(e=Nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nee(t){var e=Dee(t,"string");return typeof e=="symbol"?e:e+""}function Dee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TF(t,e,n){return t.set(vo(t,e),n),n}function cp(t,e){return t.get(vo(t,e))}function vo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jb="autoRowSize",kee=40,Lee="autoRowSize";var Ld=new WeakMap,V_=new WeakMap,Zo=new WeakSet;class cd extends Je{static get PLUGIN_KEY(){return jb}static get PLUGIN_PRIORITY(){return kee}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Hee(this,Zo),du(this,"headerHeight",null),du(this,"ghostTable",new yF(this.hot)),du(this,"samplesGenerator",new Pw((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),du(this,"inProgress",!1),du(this,"measuredRows",0),du(this,"rowHeightsMap",new Ca),gH(this,Ld,[]),gH(this,V_,!1),this.hot.rowIndexMapper.registerMap(Lee,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>vo(Zo,this,mH).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[jb];return e===!0||Ne(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vo(Zo,e,Vee).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vo(Zo,e,Wee).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vo(Zo,e,jee).call(e,...i)}),this.addHook("beforeRender",()=>vo(Zo,this,Fee).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>vo(Zo,this,Bee).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>vo(Zo,this,mH).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}de(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Zm(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+cd.CALCULATION_STEP,i)},e,n),r=r+cd.CALCULATION_STEP+1,r<i?o=Xm(s):(Zm(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[jb];let n=cd.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Ne(e)&&(n=e.syncLimit,hL(n)?n=YL(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{de(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function $ee(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function Fee(){this.calculateVisibleRowsHeight(),this.inProgress||(vo(Zo,this,$ee).call(this,cp(Ld,this)),TF(Ld,this,[]))}function mH(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Vee(t,e){e||this.recalculateAllRowsHeight()}function Wee(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);cp(Ld,this).push(...e)}function Bee(){this.recalculateAllRowsHeight(),TF(V_,this,!0)}function jee(t){if(!cp(V_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);cp(Ld,this).push(...e)}const{getListWithInsertedItems:Uee,getListWithRemovedItems:zee}=v$("physicallyIndexed");class Yee extends Yl{constructor(){super(e=>e)}insert(e,n){const r=z0(this.indexedValues,n);this.indexedValues=Uee(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=zee(this.indexedValues,e);this.indexedValues=U0(n,e),super.remove(e)}}const{getListWithInsertedItems:Gee,getListWithRemovedItems:qee}=v$("physicallyIndexed");class Kee extends Yl{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Gee(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=qee(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function Xee(t,e){Zee(t,e),e.add(t)}function Zee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jee(t,e,n){return(e=Qee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qee(t){var e=ete(t,"string");return typeof e=="symbol"?e:e+""}function ete(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tte(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pH="bindRowsWithHeaders",nte=210,rte="loose",wH=new Map([["loose",Yee],["strict",Kee]]);var vH=new WeakSet;class ite extends Je{constructor(){super(...arguments),Xee(this,vH),Jee(this,"headerIndexes",null)}static get PLUGIN_KEY(){return pH}static get PLUGIN_PRIORITY(){return nte}isEnabled(){return!!this.hot.getSettings()[pH]}enablePlugin(){var e;if(this.enabled)return;const n=(e=wH.get(this.getSetting()))!==null&&e!==void 0?e:wH.get(rte);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>tte(vH,this,ote).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function ote(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function ste(t,e){_F(t,e),e.add(t)}function ate(t,e,n){_F(t,e),e.set(t,n)}function _F(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CH(t,e,n){return(e=lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lte(t){var e=ute(t,"string");return typeof e=="symbol"?e:e+""}function ute(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yH(t,e){return t.get(Ku(t,e))}function Ub(t,e,n){return t.set(Ku(t,e),n),n}function Ku(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Tm="collapsibleColumns",cte=290,hte=["nestedHeaders"],oc="collapsibleIndicator",bH=Tm,SH=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var fu=new WeakMap,vh=new WeakSet;class dte extends Je{constructor(){super(...arguments),ste(this,vh),CH(this,"nestedHeadersPlugin",null),CH(this,"headerStateManager",null),ate(this,fu,null)}static get PLUGIN_KEY(){return Tm}static get PLUGIN_PRIORITY(){return cte}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Tm,...hte]}isEnabled(){return!!this.hot.getSettings()[Tm]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Ze("You need to configure the Nested Headers plugin in order to use collapsible headers."),Ub(fu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Ku(vh,this,mte).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ku(vh,e,pte).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ku(vh,e,fte).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Ku(vh,this,gte).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ub(fu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:bH,relativeToGroup:ya,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bH)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};de(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;de(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${oc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${oc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${oc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!SH.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Ml(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;H(r,f=>{var g;let{row:w,col:C}=f;const{collapsible:S,isCollapsed:v}=(g=this.headerStateManager.getHeaderSettings(w,C))!==null&&g!==void 0?g:{};if(!S||v&&n==="collapse"||!v&&n==="expand")return i=!1,!1});const o=[],s=[];i&&H(r,f=>{let{row:g,col:w}=f;const{colspanCompensation:C,affectedColumns:S,rollbackModification:v}=this.headerStateManager.triggerNodeModification(n,g,w);C>0&&(s.push(...S),o.push(v))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=IK([...a,...s]):n==="expand"&&(l=Ml(a,f=>!s.includes(f)));const u=SH.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){H(o,f=>{f()});return}this.hot.batchExecution(()=>{H(s,f=>{yH(fu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const C=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,S=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;C!==null&&S!==null&&this.hot.selectCell(C,S)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return yH(fu,this).getHiddenIndexes()}destroy(){Ub(fu,this,null),super.destroy()}}function fte(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${oc}`);if(xc(e,[ai("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),X(u,oc),e.querySelector("div:first-child").appendChild(u)),ve(u,["collapsed","expanded"]),s?(X(u,"collapsed"),Pl(u,"+"),l&&ye(e,...ai(!1))):(X(u,"expanded"),Pl(u,"-"),l&&ye(e,...ai(!0))),l&&ye(u,...zl());else{var c;(c=u)===null||c===void 0||c.remove()}}function gte(t,e){be(t.target,oc)&&(be(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):be(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),zi(t))}function mte(){this.updatePlugin()}function pte(t,e){e||this.updatePlugin()}function Fa(t,e,n){return(e=wte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wte(t){var e=vte(t,"string");return typeof e=="symbol"?e:e+""}function vte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Cte=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],yte=!1,bte=!0,Ste=!0;class Rte{constructor(e,n){Fa(this,"hot",void 0),Fa(this,"sortingStates",new yw),Fa(this,"sortEmptyCells",yte),Fa(this,"indicator",bte),Fa(this,"headerAction",Ste),Fa(this,"compareFunctionFactory",void 0),Fa(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Ne(e)&&De(e,(n,r)=>{Cte.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Ne(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ue(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function MF(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?_o:jt(i)?jt(o)?_o:s&&t==="asc"?kt:Lt:jt(o)?s&&t==="asc"?Lt:kt:isNaN(i)&&!isNaN(o)?t==="asc"?Lt:kt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?kt:Lt:i>o?t==="asc"?Lt:kt:_o}}const IF="default";function Ete(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return _o;if(a){if(jt(r))return t==="asc"?kt:Lt;if(jt(i))return t==="asc"?Lt:kt}return isNaN(o)?Lt:isNaN(s)?kt:o<s?t==="asc"?kt:Lt:o>s?t==="asc"?Lt:kt:_o}}const Tte="numeric";function _te(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=jt(s),u=jt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Lt;if(l===!1&&u)return kt}return d===!1&&f?t==="asc"?kt:Lt:d&&f===!1?t==="asc"?Lt:kt:d===!1&&f===!1?MF(t,e,n)(s,a):c===i&&h===r?t==="asc"?kt:Lt:c===r&&h===i?t==="asc"?Lt:kt:_o}}const Mte="checkbox";function Ite(t,e,n){return NF(t,e.dateFormat,n)}const Pte="date";function Ote(t,e,n){return NF(t,e.timeFormat,n)}const xte="time",{register:vf,getItem:RH,hasItem:Ate}=gi("sorting.compareFunctionFactory"),{register:PF,getItem:Hte}=gi("sorting.mainSortComparator");function OF(t){return Ate(t)?RH(t):RH(IF)}vf(Mte,_te);vf(Pte,Ite);vf(IF,MF);vf(Tte,Ete);vf(xte,Ote);const _o=0,kt=-1,Lt=1;function Nte(t,e){const n=Hte(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const hp="asc",dp="desc",xF="colHeader";function Dte(t){if(Ne(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[hp,dp].includes(n)}function kte(t){if(t.some(n=>Dte(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function EH(t){if(t!==dp)return t===hp?dp:hp}function AF(t){return t.querySelector(`.${xF}`)}function HF(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function W_(t,e,n){return t===-1&&e>=0&&Ol(n)===!1}function NF(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return _o;if(jt(r))return jt(i)?_o:o&&t==="asc"?kt:Lt;if(jt(i))return o&&t==="asc"?Lt:kt;const s=J(r,e),a=J(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?kt:Lt:a.isBefore(s)?t==="asc"?Lt:kt:_o:kt:Lt}}function Lte(t,e){Ze(it`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const $te="ascending",Fte="descending",DF="indicatorDisabled",kF="columnSorting",LF="sortAction",$F=new Map([[hp,$te],[dp,Fte]]);function Vte(t,e,n,r){const i=[kF];if(r&&i.push(LF),n===!1)return i.push(DF),i;const o=t.getSortOrderOfColumn(e);return ue(o)&&i.push($F.get(o)),i}function Wte(){return Array.from($F.values()).concat(LF,DF,kF)}function Bte(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:OF(u.type))(l,u,d)(c,h)}(0)}}function jte(t,e){Ute(t,e),e.add(t)}function Ute(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cg(t,e,n){return(e=zte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zte(t){var e=Yte(t,"string");return typeof e=="symbol"?e:e+""}function Yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ju(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fp="columnSorting",Gte=50,gp="append",qte="replace",TH=fp;PF(fp,Bte);ie.getSingleton().register("beforeColumnSort");ie.getSingleton().register("afterColumnSort");const Ch=new WeakMap;var al=new WeakSet;class FF extends Je{constructor(){super(...arguments),jte(this,al),Cg(this,"columnStatesManager",null),Cg(this,"columnMetaCache",null),Cg(this,"pluginKey",fp),Cg(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return fp}static get PLUGIN_PRIORITY(){return Gte}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Ch.has(this.hot)&&Ch.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),Lte(Ch.get(this.hot),this.pluginKey);return}this.enabled||(Ch.set(this.hot,this.pluginKey),this.columnStatesManager=new Rte(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Ca(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>ju(al,this,Kte).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ju(al,e,Zte).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>ju(al,this,jR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ju(al,e,Xte).call(e,...r)}),this.hot.view&&ju(al,this,jR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=AF(r);HF(n,r)===!1||i===null||this.updateHeaderClasses(i)};Ch.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:ya,position:"before",group:TH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TH)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new C$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ue(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return kte(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=je(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ue(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=je(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ue(n)){const i=EH(n);return ue(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:EH()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gp;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Pt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===gp)return[...o.slice(0,r),...o.slice(r+1),s];if(n===qte)return[...o.slice(0,r),s,...o.slice(r+1)]}return ue(s)?o.concat(s):o}getPluginColumnConfig(e){if(Ne(e)){const n=e[this.pluginKey];if(Ne(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):at(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>je(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=je(n,u=>u[0]);Nte(n,this.pluginKey,je(e,u=>u.sortOrder),je(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=je(n,u=>u[0]),a=new Map(je(o,(u,c)=>[u,s[c]])),l=je(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ne(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Ne(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(ve(e,Wte()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];X(e,Vte(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ue(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&be(e.target,xF)}onAfterOnCellMouseDown(e,n){if(W_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function jR(){const t=this.getAllSavedSortSettings();if(Ne(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Kte(t,e){const n=AF(e);if(HF(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);ye(e,...XK(s?`${s}ending`:"none"))}}function Xte(t){t===!0&&this.hot.view&&ju(al,this,jR).call(this)}function Zte(t,e,n,r){W_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Va(t,e,n){return(e=Jte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jte(t){var e=Qte(t,"string");return typeof e=="symbol"?e:e+""}function Qte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ene{constructor(e,n){Va(this,"plugin",void 0),Va(this,"hot",void 0),Va(this,"endpoints",[]),Va(this,"settings",void 0),Va(this,"settingsType","array"),Va(this,"currentEndpoint",null),Va(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),H(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();H(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;H(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?H(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):H(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){H(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];H(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),H(i,o=>{let s=[];H(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,H(e.ranges,r=>{H(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],H(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],H(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],H(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&H(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),H(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ze("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function zb(t){return t==null||isNaN(t)}function tne(t,e){nne(t,e),e.add(t)}function nne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rne(t,e,n){return(e=ine(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ine(t){var e=one(t,"string");return typeof e=="symbol"?e:e+""}function one(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Yb="columnSummary",sne=220;var yh=new WeakSet;class ane extends Je{constructor(){super(...arguments),tne(this,yh),rne(this,"endpoints",null)}static get PLUGIN_KEY(){return Yb}static get PLUGIN_PRIORITY(){return sne}isEnabled(){return!!this.hot.getSettings()[Yb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Yb],this.endpoints=new ene(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yg(yh,e,lne).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yg(yh,e,cne).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yg(yh,e,une).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yg(yh,e,hne).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return De(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=zb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return De(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=zb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=zb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return De(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(it`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function lne(){this.endpoints.initEndpoints()}function une(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function cne(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function hne(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function dne(t,e){VF(t,e),e.add(t)}function Gb(t,e,n){VF(t,e),e.set(t,n)}function VF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uu(t,e){return t.get(B_(t,e))}function UR(t,e,n){return t.set(B_(t,e),n),n}function B_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mp=new WeakMap,bg=new WeakMap,Sg=new WeakMap,_H=new WeakSet;class WF{constructor(){dne(this,_H),Gb(this,mp,!0),Gb(this,bg,null),Gb(this,Sg,new ResizeObserver(e=>B_(_H,this,fne).call(this,e)))}setObservedElement(e){UR(bg,this,e)}unobserve(){Uu(Sg,this).unobserve(Uu(bg,this))}observe(){UR(mp,this,!0),Uu(Sg,this).observe(Uu(bg,this))}destroy(){Uu(Sg,this).disconnect()}}function fne(t){if(Uu(mp,this)||!Array.isArray(t)||!t.length){UR(mp,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}ft(WF,Tn);function Ps(t,e,n){gne(t,e),e.set(t,n)}function gne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ct(t,e){return t.get(BF(t,e))}function eo(t,e,n){return t.set(BF(t,e),n),n}function BF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gu=new WeakMap,qb=new WeakMap,Kb=new WeakMap,zo=new WeakMap,Os=new WeakMap,xs=new WeakMap,Rg=new WeakMap,mu=new WeakMap;class ml{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,r){var i=this;Ps(this,gu,void 0),Ps(this,qb,void 0),Ps(this,Kb,!1),Ps(this,zo,null),Ps(this,Os,void 0),Ps(this,xs,void 0),Ps(this,Rg,!0),Ps(this,mu,new WF),eo(gu,this,e),eo(qb,this,r),eo(Kb,this,n),eo(Os,this,this.createEditor()),eo(xs,this,ct(Os,this).style),ct(mu,this).setObservedElement(this.getInputElement()),ct(mu,this).addLocalHook("resize",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){ct(xs,this).left=`${e}px`,ct(xs,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:qt(this.getInputElement()),height:on(this.getInputElement())}}observeSize(){ct(mu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){ct(xs,this).display="block",eo(Rg,this,!1)}hide(){ct(mu,this).unobserve(),ct(Rg,this)||(ct(xs,this).display="none"),eo(Rg,this,!0)}isVisible(){return ct(xs,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return ct(gu,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=ct(gu,this).createElement("div"),n=ct(gu,this).createElement("textarea");return e.style.display="none",eo(zo,this,ct(gu,this).createElement("div")),ct(zo,this).setAttribute("dir",ct(Kb,this)?"rtl":"ltr"),X(ct(zo,this),ml.CLASS_EDITOR_CONTAINER),ct(qb,this).appendChild(ct(zo,this)),X(e,ml.CLASS_EDITOR),X(n,ml.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),ct(zo,this).appendChild(e),e}getInputElement(){return ct(Os,this).querySelector(`.${ml.CLASS_INPUT}`)}getEditorElement(){return ct(Os,this)}destroy(){const e=ct(zo,this)?ct(zo,this).parentNode:null;ct(Os,this).parentNode.removeChild(ct(Os,this)),eo(Os,this,null),eo(xs,this,null),ct(mu,this).destroy(),e&&e.removeChild(ct(zo,this))}}ft(ml,Tn);function Xb(t,e,n){return(e=mne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mne(t){var e=pne(t,"string");return typeof e=="symbol"?e:e+""}function pne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wne=250,vne=250;class jF{constructor(e){Xb(this,"wasLastActionShow",!0),Xb(this,"showDebounced",null),Xb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},vne)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wne;this.showDebounced=gw(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}ft(jF,Tn);function Cne(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function yne(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Wa(t,e){const n={};return H(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function zs(t,e,n,r,i){H(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&bne(s,a,e,n,r,i)})})}function bne(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=Cne(s.className,r):a=yne(s.className,r)),o(t,e,"className",a)}function UF(t){return`<span class="selected">✓</span>${t}`}function _m(t,e){let n=!1;return Array.isArray(t)&&H(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function Ow(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const He="---------";function Sne(){return{name:He}}const Qr="alignment";function Rne(){return{key:Qr,name(){return this.getTranslatedPhrase(pT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Qr}:left`,name(){return this.getTranslatedPhrase(wT)},callback(){const t=this.getSelectedRange(),e=Wa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),zs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Qr}:center`,name(){return this.getTranslatedPhrase(vT)},callback(){const t=this.getSelectedRange(),e=Wa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),zs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Qr}:right`,name(){return this.getTranslatedPhrase(CT)},callback(){const t=this.getSelectedRange(),e=Wa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),zs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Qr}:justify`,name(){return this.getTranslatedPhrase(yT)},callback(){const t=this.getSelectedRange(),e=Wa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),zs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:He},{key:`${Qr}:top`,name(){return this.getTranslatedPhrase(bT)},callback(){const t=this.getSelectedRange(),e=Wa(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),zs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Qr}:middle`,name(){return this.getTranslatedPhrase(ST)},callback(){const t=this.getSelectedRange(),e=Wa(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),zs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Qr}:bottom`,name(){return this.getTranslatedPhrase(RT)},callback(){const t=this.getSelectedRange(),e=Wa(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),zs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const xw="clear_column";function Ene(){return{key:xw,name(){return this.getTranslatedPhrase(nT)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Cf="col_left";function Tne(){return{key:Cf,name(){return this.getTranslatedPhrase(X0)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const yf="col_right";function _ne(){return{key:yf,name(){return this.getTranslatedPhrase(Z0)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const bf="make_read_only";function Mne(){return{key:bf,checkable:!0,ariaChecked(){return _m(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(np)},name(){let t=this.getTranslatedPhrase(np);return _m(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=UF(t)),t},callback(){const t=this.getSelectedRange(),e=_m(t,(n,r)=>this.getCellMeta(n,r).readOnly);H(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Aw="redo";function Ine(){return{key:Aw,name(){return this.getTranslatedPhrase(tT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Sf="remove_col";function Pne(){return{key:Sf,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(Q0,e)},callback(){this.alter("remove_col",Y8(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Hw="remove_row";function One(){return{key:Hw,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(J0,e)},callback(){this.alter("remove_row",G8(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Nw="row_above";function xne(){return{key:Nw,name(){return this.getTranslatedPhrase(q0)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const Dw="row_below";function Ane(){return{key:Dw,name(){return this.getTranslatedPhrase(K0)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const $d="no_items";function Hne(){return{key:$d,name(){return this.getTranslatedPhrase(G0)},disabled:!0,isCommand:!1}}const kw="undo";function Nne(){return{key:kw,name(){return this.getTranslatedPhrase(eT)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Dne=[Nw,Dw,Cf,yf,xw,Hw,Sf,kw,Aw,bf,Qr,He,$d],kne={[He]:Sne,[$d]:Hne,[Nw]:xne,[Dw]:Ane,[Cf]:Tne,[yf]:_ne,[xw]:Ene,[Hw]:One,[Sf]:Pne,[kw]:Nne,[Aw]:Ine,[bf]:Mne,[Qr]:Rne};function zF(){const t={};return De(kne,(e,n)=>{t[n]=e()}),t}function Lne(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(fT):this.getTranslatedPhrase(dT)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function $ne(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(gT)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Fne(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(mT);return _m(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Mm))?UF(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Mm);t.updateCommentMeta(n,r,{[Mm]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Vne(t,e){YF(t,e),e.add(t)}function pu(t,e,n){YF(t,e),e.set(t,n)}function YF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wne(t,e,n){return(e=Bne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bne(t){var e=jne(t,"string");return typeof e=="symbol"?e:e+""}function jne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ia(t,e,n){return t.set(xr(t,e),n),n}function Ae(t,e){return t.get(xr(t,e))}function xr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pp="comments",Une=60,ns="comment",Jh="value",GF="style",Mm="readOnly",bh=pp,zR=`plugin:${pp}`;var dt=new WeakMap,mo=new WeakMap,Lw=new WeakMap,Im=new WeakMap,YR=new WeakMap,wp=new WeakMap,qr=new WeakSet;class zne extends Je{constructor(){super(...arguments),Vne(this,qr),Wne(this,"range",{}),pu(this,dt,null),pu(this,mo,null),pu(this,Lw,!1),pu(this,Im,!1),pu(this,YR,null),pu(this,wp,"")}static get PLUGIN_KEY(){return pp}static get PLUGIN_PRIORITY(){return Une}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[pp]}enablePlugin(){var e=this;this.enabled||(Ae(dt,this)||(ia(dt,this,new ml(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),Ae(dt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xr(qr,e,Qne).call(e,...r)}),this.hot.addHook("afterSetTheme",(n,r)=>{r||this.hide()})),Ae(mo,this)||ia(mo,this,new jF(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>xr(qr,this,Xne).call(this,n,a)),this.addHook("afterScroll",()=>xr(qr,this,ere).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>xr(qr,this,MH).call(this,n)),this.addHook("beforeCompositionStart",n=>xr(qr,this,MH).call(this,n)),Ae(mo,this).addLocalHook("hide",()=>this.hide()),Ae(mo,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Ae(mo,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(zR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();ia(Im,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(zR),this.hot._registerTimeout(()=>{ia(Im,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:bh}),r.addShortcut({keys:[["Escape"]],callback:()=>{Ae(dt,this).setValue(Ae(wp,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ae(dt,this).isVisible()&&Ae(dt,this).isFocused(),group:bh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ae(dt,this).isVisible()&&Ae(dt,this).isFocused(),group:bh}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{Ae(dt,this).setValue(Ae(dt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:bh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>xr(qr,this,qne).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>xr(qr,this,Yne).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>xr(qr,this,Kne).call(this)),this.eventManager.addEventListener(n,"focus",()=>xr(qr,this,Jne).call(this)),this.eventManager.addEventListener(n,"blur",()=>xr(qr,this,Zne).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>xr(qr,this,Gne).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Il(e.target,"TD","TBODY");return!!(n&&be(n,"htCommentCell")&&Il(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Ae(dt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Jh]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,ns),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Jh)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Jh)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Ae(mo,this).cancelHiding(),Ae(dt,this).setValue((e=i[ns]?i[ns][Jh]:null)!==null&&e!==void 0?e:""),Ae(dt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Ae(dt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Ae(dt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;Ae(dt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),w=this.getCommentMeta(i,o,GF);w?Ae(dt,this).setSize(w.width,w.height):Ae(dt,this).resetSize();const C=c?0:f.getColumnWidth(a),S=l&&!u?on(g):0,{left:v,top:E,width:P,height:x}=g.getBoundingClientRect(),{width:_,height:M}=Ae(dt,this).getSize(),{innerWidth:V,innerHeight:z}=this.hot.rootWindow,O=this.hot.rootDocument.documentElement,G=Sn(this.hot.rootDocument),Z=AL(this.hot.rootWindow)?G:0,ae=HL(this.hot.rootWindow)?G:0;let te=v+h.scrollX+C,ne=E+h.scrollY+S;this.hot.isRtl()&&(te-=_+C),this.hot.isLtr()&&v+P+_>V-Z?te=v+h.scrollX-_-1:this.hot.isRtl()&&te<-(O.scrollWidth-O.clientWidth)&&(te=v+h.scrollX+C+1),E+M>z-ae&&(ne-=M-x+1),Ae(dt,this).setPosition(te,ne),Ae(dt,this).setReadOnlyState(this.getCommentMeta(i,o,Mm)),Ae(dt,this).observeSize()}focusEditor(){Ae(dt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[ns];let o;i?(o=er(i),hw(o,r)):o=r,this.hot.setCellMeta(e,n,ns,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[ns])return i[ns][r]}addToContextMenu(e){e.items.push({name:He},Lne(this),$ne(this),Fne(this))}getEditorInputElement(){return Ae(dt,this).getInputElement()}destroy(){var e,n;(e=Ae(dt,this))===null||e===void 0||e.destroy(),(n=Ae(mo,this))===null||n===void 0||n.destroy(),super.destroy()}}function Yne(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Ae(Lw,this)&&!this.targetIsCommentTextArea(t)){const e=Il(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Gne(t){t.stopPropagation()}function qne(t){const{rootDocument:e}=this.hot;if(!(Ae(Lw,this)||Ae(dt,this).isFocused()||be(t.target,"wtBorder")||Ae(YR,this)===t.target||!Ae(dt,this)))if(ia(YR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Ae(mo,this).show(n)}else Rl(t.target,e)&&!this.targetIsCommentTextArea(t)&&Ae(mo,this).hide()}function Kne(){ia(Lw,this,!1)}function Xne(t,e){e[ns]&&e[ns][Jh]&&X(t,e.commentedCellClassName)}function Zne(){ia(wp,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Jne(){ia(wp,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(zR)}function Qne(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[GF]:{width:t,height:e}})}function MH(t){Ae(dt,this).isFocused()&&zi(t)}function ere(){Ae(Im,this)||this.hide()}function Zb(t,e,n){return(e=tre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tre(t){var e=nre(t,"string");return typeof e=="symbol"?e:e+""}function nre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qF{constructor(e){Zb(this,"hot",void 0),Zb(this,"commands",{}),Zb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=rre(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||rn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),H(u,c=>c.apply(this.hot,r))}}function rre(t,e){let n;return H(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Jb(t,e,n){return(e=ire(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ire(t){var e=ore(t,"string");return typeof e=="symbol"?e:e+""}function ore(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Jb(this,"hot",void 0),Jb(this,"predefinedItems",zF()),Jb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,De(e,(r,i)=>{let o="";r.name===He?(n[He]=r,o=He):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return sre(e,this.defaultOrderPattern,this.predefinedItems)}}function sre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ne(i)?De(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Ne(o)?sn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):H(i,(o,s)=>{let a=n[o];!a&&Dne.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Ne(o)&&sn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function As(t,e,n){return(e=are(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function are(t){var e=lre(t,"string");return typeof e=="symbol"?e:e+""}function lre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ure{constructor(e,n){As(this,"top",void 0),As(this,"topRelative",void 0),As(this,"left",void 0),As(this,"leftRelative",void 0),As(this,"scrollTop",void 0),As(this,"scrollLeft",void 0),As(this,"cellHeight",void 0),As(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Sh(t,e,n){cre(t,e),e.set(t,n)}function cre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Me(t,e){return t.get(XF(t,e))}function Eg(t,e,n){return t.set(XF(t,e),n),n}function XF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Un=new WeakMap,ar=new WeakMap,lr=new WeakMap,Qb=new WeakMap,wu=new WeakMap;class hre{constructor(e){Sh(this,Un,void 0),Sh(this,ar,void 0),Sh(this,lr,void 0),Sh(this,Qb,!1),Sh(this,wu,{above:0,below:0,left:0,right:0}),Eg(Qb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Me(wu,this)[e]=n,this}setElement(e){return Eg(Un,this,e),this}setParentElement(e){return Eg(ar,this,e),this}updatePosition(e){Eg(lr,this,new ure(e,Me(Un,this).ownerDocument.defaultView)),Me(Qb,this)?(Me(lr,this).fitsBelow(Me(Un,this))?this.setPositionBelowCursor():Me(lr,this).fitsAbove(Me(Un,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Me(Un,this).dir==="rtl"?Me(lr,this).fitsOnLeft(Me(Un,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Me(lr,this).fitsOnRight(Me(Un,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Me(wu,this).above+Me(lr,this).top-Me(Un,this).offsetHeight;if(Me(ar,this)){const r=Me(ar,this).ownerDocument.defaultView.getComputedStyle(Me(ar,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Me(lr,this).top+Me(lr,this).cellHeight-Me(Un,this).scrollHeight+i+o}Me(Un,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Me(wu,this).below+Me(lr,this).top+1;if(Me(ar,this)){const r=Me(ar,this).ownerDocument.defaultView.getComputedStyle(Me(ar,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Me(lr,this).top-i-o-1}Me(Un,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Me(lr,this).left;if(Me(ar,this)){const n=Me(ar,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Me(ar,this).querySelector(".htCore")).borderRightWidth,10);e+=Me(lr,this).cellWidth+r}else e+=Me(wu,this).right;Me(Un,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Me(wu,this).left+Me(lr,this).left-Me(Un,this).offsetWidth;if(Me(ar,this)){const n=Me(ar,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Me(ar,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Me(Un,this).style.left=`${e}px`}}function ZF(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=ze(e,-1,w()-1);function a(S,v){const E=w()-1;return S<0&&(S=E),S>E&&(S=0),o.has(S)?-1:(o.add(S),r(S,!1)===!1&&(S=a(v===1?++S:--S,v)),S)}function l(S){S>-1&&S<w()&&r(S,!0)!==!1&&(s=S)}function u(S){S>-1&&S<w()&&(s=S)}function c(){return s}function h(){w()>0&&(o.clear(),s=a(0,1))}function d(){w()>0&&(o.clear(),s=a(w()-1,-1))}function f(){w()>0&&(o.clear(),s=a(++s,1))}function g(){w()>0&&(o.clear(),s=a(--s,-1))}function w(){return Math.max(n(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:g,getSize:w,clear:C}}function dre(t){return je(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function GR(t){return rn(t,"submenu")}function qR(t){return new RegExp(He,"i").test(t.name)}function Pm(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function IH(t){return rn(t,"disableSelection")}function fre(t){return be(t,"htSeparator")}function gre(t){return be(t,"htSubmenu")}function mre(t){return be(t,"htDisabled")}function pre(t){return be(t,"htSelectionDisabled")}function wre(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function JF(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function vre(t,e){let n=t.slice(0);return n.reverse(),n=JF(n,e),n.reverse(),n}function Cre(t){const e=[];return H(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function yre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:He,n=t.slice(0);return n=JF(n,e),n=vre(n,e),n=Cre(n),n}function bre(t){return t.checkable===!0}function Sre(t){return ZF({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||fre(r)||mre(r)||pre(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Rre(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const QF="menu",PH=QF;function Ere(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Rre(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:QF})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${PH}:${u}`:PH}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Tre(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(ws(n),X(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Pm(a,t)&&!IH(a)&&!qR(a);ye(n,[...bre(a)?[WK(),dc(c),CL(h)]:[VK(),dc(u)],...d?[wa(-1)]:[],...Pm(a,t)?[qK()]:[],...GR(a)?[ai(!1)]:[]])}n.className="",n.appendChild(l),qR(a)?X(n,"htSeparator"):typeof a.renderer=="function"?(X(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ac(l,u),Pm(a,t)?X(n,"htDisabled"):IH(a)?X(n,"htSelectionDisabled"):GR(a)&&X(n,"htSubmenu")}}function eS(t,e,n){_re(t,e),e.set(t,n)}function _re(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function to(t,e,n){return(e=Mre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mre(t){var e=Ire(t,"string");return typeof e=="symbol"?e:e+""}function Ire(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tS(t,e,n){return t.set(eV(t,e),n),n}function Hs(t,e){return t.get(eV(t,e))}function eV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OH=215;var vu=new WeakMap,Tg=new WeakMap,_g=new WeakMap;class Lc{get tableBorderWidth(){return Hs(_g,this)===void 0&&this.hotMenu&&tS(_g,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Hs(_g,this)}constructor(e,n){var r=this;to(this,"hot",void 0),to(this,"options",void 0),to(this,"eventManager",new Wi(this)),to(this,"container",void 0),to(this,"positioner",void 0),to(this,"hotMenu",null),to(this,"hotSubMenus",{}),to(this,"parentMenu",void 0),to(this,"menuItems",null),to(this,"origOutsideClickDeselects",null),eS(this,vu,void 0),eS(this,Tg,void 0),eS(this,_g,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:OH,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new hre(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(ve(this.options.container,/ht-theme-.*/g),X(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=fc(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Hs(vu,this)}getKeyboardShortcutsCtrl(){return Hs(Tg,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=gw(a=>this.openSubMenu(a),300),n=this.options.minWidth||OH;let r=!1,i=Ml(this.menuItems,a=>(a.key===$d&&(r=!0),wre(a,this.hot)));if(i.length<1&&!r)i.push(zF()[$d]);else if(i.length===0)return;i=yre(i,He);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ue(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Tre(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?Hs(vu,this).setCurrentPage(l.row):Hs(vu,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),TR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!TR()||!Ol(a))&&o&&this.hasSelectedItem()&&(Eo()||RL()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),tS(vu,this,Sre(this.hotMenu)),tS(Tg,this,Ere(this)),Hs(Tg,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Hs(vu,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);ye(r,[ai(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!gre(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Lc(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&ye(n,[ai(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&ye(i,[ai(!1)])}}closeAllSubMenus(){H(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?dre(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||qR(e)||Pm(e,this.hot)||GR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=Er(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?on(this.hotMenu.getCell(u,0)):0;return a+(l.name===He?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(at(r)&&(r=r.call(this.hot),r===null||Pt(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),X(i,`htMenu handsontable ${this.options.className}`),r&&X(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&ye(this.hotMenu.rootElement,[FK(),wa(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Rl(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Rl(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&be(e.target,"htCore")&&Rl(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ft(Lc,Tn);function Pre(t,e){Ore(t,e),e.add(t)}function Ore(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nS(t,e,n){return(e=xre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xre(t){var e=Are(t,"string");return typeof e=="symbol"?e:e+""}function Are(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qh="contextMenu",Hre=70,xH=Qh;ie.getSingleton().register("afterContextMenuDefaultOptions");ie.getSingleton().register("beforeContextMenuShow");ie.getSingleton().register("afterContextMenuShow");ie.getSingleton().register("afterContextMenuHide");ie.getSingleton().register("afterContextMenuExecute");var Rh=new WeakSet;class $w extends Je{constructor(){super(...arguments),Pre(this,Rh),nS(this,"commandExecutor",new qF(this.hot)),nS(this,"itemsFactory",null),nS(this,"menu",null)}static get PLUGIN_KEY(){return Qh}static get PLUGIN_PRIORITY(){return Hre}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Nw,Dw,He,Cf,yf,He,Hw,Sf,He,kw,Aw,He,bf,He,Qr]}isEnabled(){return!!this.hot.getSettings()[Qh]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Qh];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Lc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Mg(Rh,this,Dre).call(this)),this.menu.addLocalHook("afterOpen",()=>Mg(Rh,this,kre).call(this)),this.menu.addLocalHook("afterClose",()=>Mg(Rh,this,Lre).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Mg(Rh,this,Nre).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=Ow(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:xH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xH)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;De(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new KF(this.hot,$w.DEFAULT_ITEMS);const e=this.hot.getSettings()[Qh],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),H(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Nre(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),be(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(be(o,"current")&&be(o,"wtBorder"))))return;const s=Ow(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Dre(){this.hot.runHooks("beforeContextMenuShow",this)}function kre(){this.hot.runHooks("afterContextMenuShow",this)}function Lre(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}$w.SEPARATOR={name:He};function $re(t){return{key:"copy",name(){return this.getTranslatedPhrase(rT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Fre(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(sT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Vre(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(oT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Wre(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(iT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Bre(t){return{key:"cut",name(){return this.getTranslatedPhrase(aT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class jre{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Ure{constructor(){this.clipboardData=new jre}preventDefault(){}composedPath(){return[]}}function zre(t,e){tV(t,e),e.add(t)}function Cu(t,e,n){tV(t,e),e.set(t,n)}function tV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gn(t,e){return t.get(Xu(t,e))}function yu(t,e,n){return t.set(Xu(t,e),n),n}function Xu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ns=new WeakMap,rS=new WeakMap,Eh=new WeakMap,KR=new WeakMap,XR=new WeakMap,Th=new WeakMap,_h=new WeakSet;class Yre{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;zre(this,_h),Cu(this,Ns,void 0),Cu(this,rS,void 0),Cu(this,Eh,void 0),Cu(this,KR,void 0),Cu(this,XR,void 0),Cu(this,Th,void 0),yu(rS,this,n),yu(Eh,this,r),yu(KR,this,i),yu(XR,this,o),yu(Th,this,s)}setSelectedRange(e){yu(Ns,this,e)}getCellsRange(){if(Gn(rS,this).call(this)===0||Gn(Eh,this).call(this)===0)return null;const{row:e,col:n}=Gn(Ns,this).getTopStartCorner(),{row:r,col:i}=Gn(Ns,this).getBottomEndCorner(),o=Xu(_h,this,Gre).call(this,e,r),s=Xu(_h,this,iS).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Gn(Eh,this).call(this)===0||Gn(Th,this).call(this)===0)return null;const{col:e}=Gn(Ns,this).getTopStartCorner(),{col:n}=Gn(Ns,this).getBottomEndCorner(),r=Xu(_h,this,iS).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Gn(Eh,this).call(this)===0||Gn(Th,this).call(this)===0)return null;const{col:e}=Gn(Ns,this).getTopStartCorner(),{col:n}=Gn(Ns,this).getBottomEndCorner(),r=Xu(_h,this,iS).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Gn(Th,this).call(this),startCol:e,endRow:-1,endCol:r}}}function iS(t,e){return Math.min(e,Math.max(t+Gn(XR,this).call(this)-1,t))}function Gre(t,e){return Math.min(e,Math.max(t+Gn(KR,this).call(this)-1,t))}function nV(t){const e=[],n=[];return H(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);de(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);de(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function qre(t,e){rV(t,e),e.add(t)}function Ds(t,e,n){rV(t,e),e.set(t,n)}function rV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mh(t,e,n){return(e=Kre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kre(t){var e=Xre(t,"string");return typeof e=="symbol"?e:e+""}function Xre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gr(t,e){return t.get(pr(t,e))}function _i(t,e,n){return t.set(pr(t,e),n),n}function pr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterCopyLimit");ie.getSingleton().register("modifyCopyableRange");ie.getSingleton().register("beforeCut");ie.getSingleton().register("afterCut");ie.getSingleton().register("beforePaste");ie.getSingleton().register("afterPaste");ie.getSingleton().register("beforeCopy");ie.getSingleton().register("afterCopy");const oS="copyPaste",Zre=80,Jre=["fragmentSelection"],AH=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var ZR=new WeakMap,JR=new WeakMap,QR=new WeakMap,bu=new WeakMap,Ig=new WeakMap,Pg=new WeakMap,Su=new WeakMap,vp=new WeakMap,Hr=new WeakSet;class Qre extends Je{constructor(){super(...arguments),qre(this,Hr),Mh(this,"columnsLimit",1/0),Mh(this,"rowsLimit",1/0),Mh(this,"pasteMode","overwrite"),Mh(this,"uiContainer",this.hot.rootDocument.body),Ds(this,ZR,!1),Ds(this,JR,!1),Ds(this,QR,!1),Ds(this,bu,"cells-only"),Ds(this,Ig,!1),Ds(this,Pg,!1),Ds(this,Su,new Yre({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ds(this,vp,!1),Mh(this,"copyableRanges",[])}static get PLUGIN_KEY(){return oS}static get SETTING_KEYS(){return[oS,...Jre]}static get PLUGIN_PRIORITY(){return Zre}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[oS]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),_i(ZR,this,this.getSetting("copyColumnHeaders")),_i(JR,this,this.getSetting("copyColumnGroupHeaders")),_i(QR,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>pr(Hr,this,nie).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pr(Hr,r,rie).call(r,...o)}),this.addHook("afterSelectionEnd",()=>pr(Hr,this,iie).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),Ad()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pr(Hr,r,oie).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pr(Hr,r,sie).call(r,...o)}),this.addHook("afterSelection",()=>pr(Hr,this,aie).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";_i(bu,this,e),_i(Ig,this,!0),pr(Hr,this,HH).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){_i(Pg,this,!0),pr(Hr,this,HH).call(this,"cut")}getRangedCopyableData(e){return sd(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=nV(e);return H(r,o=>{const s=[];H(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new Ure;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}gr(Su,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);gr(bu,this)==="column-headers-only"?n.set("headers",gr(Su,this).getMostBottomColumnHeadersRange()):(gr(bu,this)==="with-column-headers"?n.set("headers",gr(Su,this).getMostBottomColumnHeadersRange()):gr(bu,this)==="with-column-group-headers"&&n.set("headers",gr(Su,this).getAllColumnHeadersRange()),n.set("cells",gr(Su,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:w}=this.hot.getCellMeta(c,a);if(c=w+1,g===!0)continue;d=w,h=a;const C=[],S=o.length%r;for(;C.length<i||h<=u;){const{skipColumnOnPaste:v,visualCol:E}=this.hot.getCellMeta(s,h);if(h=E+1,v===!0)continue;f=E;const P=C.length%i;C.push(e[S][P])}o.push(C)}return _i(vp,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!gr(Ig,this)||this.isEditorOpened()||ms(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!bm(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),_i(Ig,this,!1);const o=this.getRangedData(this.copyableRanges),s=pr(Hr,this,eie).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=sd(o);if(e&&e.clipboardData){const u=pA(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[AH,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}_i(bu,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!gr(Pg,this)||this.isEditorOpened()||ms(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!bm(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),_i(Pg,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=sd(o);if(e&&e.clipboardData){const l=pA(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[AH,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||ms(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!bm(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=d0(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=vX(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=J8(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function HH(t){if(Ad()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&_3(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function eie(t){const{rows:e}=nV(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function tie(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&kL(r)}}}function iV(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&LL(r)}}}function nie(t){t.items.push({name:"---------"},$re(this)),gr(ZR,this)&&t.items.push(Wre(this)),gr(JR,this)&&t.items.push(Vre(this)),gr(QR,this)&&t.items.push(Fre(this)),t.items.push(Bre(this))}function rie(t,e,n,r,i){gr(vp,this)&&(i.value=!0),_i(vp,this,!1)}function iie(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function oie(){pr(Hr,this,iV).call(this)}function sie(){pr(Hr,this,tie).call(this)}function aie(){pr(Hr,this,iV).call(this)}function oV(t,e){return`border_row${t}col${e}`}function ed(){return{width:1,color:"#000"}}function us(){return{hide:!0}}function lie(){return{width:1,color:"#000",cornerVisible:!1}}function sS(t){if(ue(t.start)||ue(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ue(t.end)||ue(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Ih(t){return ue(t.start)&&(t.left=t.start),ue(t.end)&&(t.right=t.end),t}function aS(t,e){return{id:oV(t,e),border:lie(),row:t,col:e,top:us(),bottom:us(),start:us(),end:us()}}function uie(t,e){return rn(e,"border")&&e.border&&(t.border=e.border),rn(e,"top")&&ue(e.top)&&(e.top?(Ne(e.top)||(e.top=ed()),t.top=e.top):(e.top=us(),t.top=e.top)),rn(e,"bottom")&&ue(e.bottom)&&(e.bottom?(Ne(e.bottom)||(e.bottom=ed()),t.bottom=e.bottom):(e.bottom=us(),t.bottom=e.bottom)),rn(e,"start")&&ue(e.start)&&(e.start?(Ne(e.start)||(e.start=ed()),t.start=e.start):(e.start=us(),t.start=e.start)),rn(e,"end")&&ue(e.end)&&(e.end?(Ne(e.end)||(e.end=ed()),t.end=e.end):(e.end=us(),t.end=e.end)),t}function Cs(t,e){let n=!1;return H(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!rn(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Fw(t){return`<span class="selected">✓</span>${t}`}function cie(t){return t.some(e=>ue(e.left)||ue(e.right))}function hie(t){return t.some(e=>ue(e.start)||ue(e.end))}const die=new Map([["left","start"],["right","end"]]);function fie(t){var e;return(e=die.get(t))!==null&&e!==void 0?e:t}function gie(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(MT);return Cs(this,"bottom")&&(e=Fw(e)),e},callback(e,n){const r=Cs(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function mie(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(IT);return Cs(this,e)&&(n=Fw(n)),n},callback(n,r){const i=Cs(this,e);t.prepareBorder(r,e,i)}}}function pie(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(PT)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Cs(this)}}}function wie(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(_T);return Cs(this,e)&&(n=Fw(n)),n},callback(n,r){const i=Cs(this,e);t.prepareBorder(r,e,i)}}}function vie(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(TT);return Cs(this,"top")&&(e=Fw(e)),e},callback(e,n){const r=Cs(this,"top");t.prepareBorder(n,"top",r)}}}function Cie(t,e){yie(t,e),e.add(t)}function yie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bie(t,e,n){return(e=Sie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sie(t){var e=Rie(t,"string");return typeof e=="symbol"?e:e+""}function Rie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Om="customBorders",Eie=90;var lS=new WeakSet;class Tie extends Je{constructor(){super(...arguments),Cie(this,lS),bie(this,"savedBorders",[])}static get PLUGIN_KEY(){return Om}static get PLUGIN_PRIORITY(){return Eie}isEnabled(){return!!this.hot.getSettings()[Om]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>NH(lS,this,_ie).call(this,e)),this.addHook("init",()=>NH(lS,this,Mie).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=sS(n));const o=pc(e),s=Dd(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});H(e,a=>{s(a).forAll((l,u)=>{H(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,fie(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=pc(e),r=Dd(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return H(e,o=>{r(o).forAll((s,a)=>{H(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Ih(l))})})}),i}clearBorders(e){e?this.setBorders(e):(H(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=aS(e,n);r&&(a=uie(a,r),H(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Ih(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);de(e.from.row,r,o=>{de(e.from.col,i,s=>{const a=aS(o,s);let l=0;o===e.from.row&&rn(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&rn(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&rn(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&rn(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Ih(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=oV(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=aS(e,n):o=sS(o),i?(o[r]=us(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Ih(o)))):(o[r]=ed(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Ih(o)))}prepareBorder(e,n,r){H(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":de(o.col,s.col,a=>{de(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":de(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":de(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":de(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":de(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){H(e,n=>{const r=sS(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Er([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=je(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){H(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){H(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=je(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):H(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return H(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return H(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):H(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);H(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Om];if(Array.isArray(e)){const n=er(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=cie(e),r=hie(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function _ie(t){this.hot.getSettings()[Om]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(ET)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[vie(this),wie(this),gie(this),mie(this),pie(this)]}})}function Mie(){this.changeBorderSettings()}function Iie(t,e){Pie(t,e),e.add(t)}function Pie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uS(t,e,n){return(e=Oie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oie(t){var e=xie(t,"string");return typeof e=="symbol"?e:e+""}function xie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kH="dragToScroll",Aie=100;var cS=new WeakSet;class Hie extends Je{constructor(){super(...arguments),Iie(this,cS),uS(this,"boundaries",null),uS(this,"callback",null),uS(this,"listening",!1)}static get PLUGIN_KEY(){return kH}static get PLUGIN_PRIORITY(){return Aie}isEnabled(){return!!this.hot.getSettings()[kH]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>DH(cS,this,LH).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>DH(cS,this,LH).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=fc(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function LH(t){if(Ol(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Nie(t,e){sV(t,e),e.add(t)}function Die(t,e,n){sV(t,e),e.set(t,n)}function sV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hS(t,e,n){return(e=kie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kie(t){var e=Lie(t,"string");return typeof e=="symbol"?e:e+""}function Lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $ie(t,e){return t.get(ei(t,e))}function aV(t,e,n){return t.set(ei(t,e),n),n}function ei(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterDropdownMenuDefaultOptions");ie.getSingleton().register("beforeDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuHide");ie.getSingleton().register("afterDropdownMenuExecute");const xm="dropdownMenu",Fie=230,Fd="changeType",dS=xm;var Vw=new WeakMap,Pi=new WeakSet;class Ww extends Je{static get PLUGIN_KEY(){return xm}static get PLUGIN_PRIORITY(){return Fie}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Cf,yf,He,Sf,He,xw,He,bf,He,Qr]}constructor(e){super(e),Nie(this,Pi),hS(this,"commandExecutor",new qF(this.hot)),hS(this,"itemsFactory",null),hS(this,"menu",null),Die(this,Vw,!1),this.hot.addHook("afterGetColHeader",(n,r)=>ei(Pi,this,Wie).call(this,n,r))}isEnabled(){return this.hot.getSettings()[xm]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new KF(this.hot,Ww.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ei(Pi,e,Gie).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ei(Pi,e,Yie).call(e,...o)});const n=this.hot.getSettings()[xm],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Lc(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>ei(Pi,this,Bie).call(this)),this.menu.addLocalHook("afterOpen",()=>ei(Pi,this,jie).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>ei(Pi,this,Uie).call(this,o)),this.menu.addLocalHook("afterClose",()=>ei(Pi,this,zie).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),H(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=Ow(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${Fd}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:dS},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:dS}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dS)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ei(Pi,this,Vie).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),De(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function lV(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Vie(t){if(be(t.target,Fd)){const e=Ow(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),aV(Vw,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function Wie(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Fd}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Fd,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(ye(s,[zl(),dc(" ")]),ye(e,[pL("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Bie(){this.hot.runHooks("beforeDropdownMenuShow",this)}function jie(){this.hot.runHooks("afterDropdownMenuShow",this),ei(Pi,this,lV).call(this,this.menu)}function Uie(t){ei(Pi,this,lV).call(this,t)}function zie(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Yie(t){return $ie(Vw,this)?null:t}function Gie(t){be(t.target,Fd)&&aV(Vw,this,!0)}Ww.SEPARATOR={name:He};function $H(t,e,n){return(e=qie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qie(t){var e=Kie(t,"string");return typeof e=="symbol"?e:e+""}function Kie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xie{constructor(e){$H(this,"hot",void 0),$H(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return de(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(de(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();de(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();de(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function FH(t,e,n){return(e=Zie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zie(t){var e=Jie(t,"string");return typeof e=="symbol"?e:e+""}function Jie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){FH(this,"dataProvider",void 0),FH(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Io(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=sn(Io(j_.DEFAULT_OPTIONS),n),n=sn(n,e),n.filename=dL(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function Qie(t,e){eoe(t,e),e.add(t)}function eoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uV="\r",toe='"',noe=`
`,roe="=",ioe="+",ooe="-",soe="@",aoe="	";var fS=new WeakSet;class loe extends j_{constructor(){super(...arguments),Qie(this,fS)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=je(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),H(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Ot(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=VH(fS,this,coe).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=VH(fS,this,uoe).call(this,i)),(n||i.indexOf(uV)>=0||i.indexOf(toe)>=0||i.indexOf(noe)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function uoe(t){return t.startsWith(roe)||t.startsWith(ioe)||t.startsWith(ooe)||t.startsWith(soe)||t.startsWith(aoe)||t.startsWith(uV)?`'${t}`:t}function coe(t,e){return e.test(t)?`'${t}`:t}const hoe="csv",eE={[hoe]:loe};function doe(t,e,n){return typeof eE[t]=="function"?new eE[t](e,n):null}const foe="exportFile",goe=240;class moe extends Je{static get PLUGIN_KEY(){return foe}static get PLUGIN_PRIORITY(){return goe}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!eE[e])throw new Error(`Export format type "${e}" is not supported.`);return doe(e,new Xie(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Ru(t,e,n){return(e=poe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function poe(t){var e=woe(t,"string");return typeof e=="symbol"?e:e+""}function woe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rf{constructor(e,n){let{id:r,stateless:i=!0}=n;Ru(this,"hot",void 0),Ru(this,"id",void 0),Ru(this,"elements",[]),Ru(this,"hidden",!1),Ru(this,"stateId",""),Ru(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new yw)}getElements(){return this.elements}reset(){H(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),H(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ft(Rf,Tn);const Vd={};function da(t,e){if(!Vd[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Vd[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function pl(t){if(!Vd[t])throw Error(`Filter condition "${t}" does not exist.`);return Vd[t].descriptor}function Qt(t,e,n){n.key=t,Vd[t]={condition:e,descriptor:n}}const bn="none";function voe(){return!0}Qt(bn,voe,{name:bw,inputsCount:0,showOperators:!1});const hd="empty";function Coe(t){return jt(t.value)}Qt(hd,Coe,{name:kT,inputsCount:0,showOperators:!0});const Am="not_empty";function yoe(t,e){return!da(hd,e)(t)}Qt(Am,yoe,{name:LT,inputsCount:0,showOperators:!0});const dd="eq";function boe(t,e){let[n]=e;return Ot(t.value).toLocaleLowerCase(t.meta.locale)===Ot(n)}Qt(dd,boe,{name:$T,inputsCount:1,showOperators:!0});const Hm="neq";function Soe(t,e){return!da(dd,e)(t)}Qt(Hm,Soe,{name:FT,inputsCount:1,showOperators:!0});const cV="gt";function Roe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Qt(cV,Roe,{name:UT,inputsCount:1,showOperators:!0});const hV="gte";function Eoe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Qt(hV,Eoe,{name:zT,inputsCount:1,showOperators:!0});const dV="lt";function Toe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Qt(dV,Toe,{name:YT,inputsCount:1,showOperators:!0});const fV="lte";function _oe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Qt(fV,_oe,{name:GT,inputsCount:1,showOperators:!0});const U_="date_after";function Moe(t,e){let[n]=e;const r=J(t.value,t.meta.dateFormat),i=J(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Qt(U_,Moe,{name:XT,inputsCount:1,showOperators:!0});const z_="date_before";function Ioe(t,e){let[n]=e;const r=J(t.value,t.meta.dateFormat),i=J(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Qt(z_,Ioe,{name:ZT,inputsCount:1,showOperators:!0});const Cp="between";function Poe(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=da(z_,[o]),a=da(U_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Qt(Cp,Poe,{name:qT,inputsCount:2,showOperators:!0});const gV="not_between";function Ooe(t,e){return!da(Cp,e)(t)}Qt(gV,Ooe,{name:KT,inputsCount:2,showOperators:!0});const mV="begins_with";function xoe(t,e){let[n]=e;return Ot(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Ot(n))}Qt(mV,xoe,{name:VT,inputsCount:1,showOperators:!0});const pV="ends_with";function Aoe(t,e){let[n]=e;return Ot(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Ot(n))}Qt(pV,Aoe,{name:WT,inputsCount:1,showOperators:!0});const Y_="contains";function Hoe(t,e){let[n]=e;return Ot(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Ot(n))>=0}Qt(Y_,Hoe,{name:BT,inputsCount:1,showOperators:!0});const wV="not_contains";function Noe(t,e){return!da(Y_,e)(t)}Qt(wV,Noe,{name:jT,inputsCount:1,showOperators:!0});const vV="date_tomorrow";function Doe(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(-1,"days").startOf("day"),"d"):!1}Qt(vV,Doe,{name:QT,inputsCount:0});const CV="date_today";function koe(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().startOf("day"),"d"):!1}Qt(CV,koe,{name:JT,inputsCount:0});const yV="date_yesterday";function Loe(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(1,"days").startOf("day"),"d"):!1}Qt(yV,Loe,{name:e_,inputsCount:0});u3();function $oe(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Ef(t){const e=new Set(t);return function(n){return e.has(n)}}function G_(t){return t??""}function tE(t){return Array.from(new Set(t)).map(e=>G_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function WH(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Ef(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:$oe(a,n)};r&&r(u),i.push(u)}),i}const wl="by_value";function Foe(t,e){let[n]=e;return n(t.value)}Qt(wl,Foe,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Ef(e)]},showOperators:!1});const Wd={};function Voe(t){if(!Wd[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Wd[t].func;return function(n,r){return e(n,r)}}function Woe(t){return Wd[t].name}function q_(t,e,n){Wd[t]={name:e,func:n}}const ca="conjunction",Boe=r_;function joe(t,e){return t.every(n=>n.func(e))}q_(ca,Boe,joe);const yp="disjunction",Uoe=Sw;function zoe(t,e){return t.some(n=>n.func(e))}q_(yp,Uoe,zoe);const K_="disjunctionWithExtraCondition",Yoe=Sw;function Goe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}q_(K_,Yoe,Goe);const qoe="numeric",bV="text",Koe="date",BH={[qoe]:[bn,He,hd,Am,He,dd,Hm,He,cV,hV,dV,fV,Cp,gV],[bV]:[bn,He,hd,Am,He,dd,Hm,He,mV,pV,He,Y_,wV],[Koe]:[bn,He,hd,Am,He,dd,Hm,He,z_,U_,Cp,He,vV,CV,yV]};function Xoe(t){const e=[];let n=t;return BH[n]||(n=bV),H(BH[n],r=>{let i;r===He?i={name:He}:i=Io(pl(r)),e.push(i)}),e}function Ph(t,e,n){return(e=Zoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zoe(t){var e=Joe(t,"string");return typeof e=="symbol"?e:e+""}function Joe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gS="built",mS="building",jH=["click","input","keydown","keypress","keyup","focus","blur","change"];let Li=class SV{static get DEFAULTS(){return Io({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Ph(this,"hot",void 0),Ph(this,"eventManager",new Wi(this)),Ph(this,"options",void 0),Ph(this,"_element",void 0),Ph(this,"buildState",void 0),this.hot=e,this.options=sn(SV.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===mS?this._element:this.buildState===gS?(this.update(),this._element):(this.buildState=mS,this.build(),this.buildState=gS,this._element)}isBuilt(){return this.buildState===gS}translateIfPossible(e){return typeof e=="string"&&e.startsWith(tr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=mS),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&X(this._element,this.options.className),this.options.children.length)H(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),De(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),H(jH,r=>e(n,r))}else H(jH,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ft(Li,Tn);function Qoe(t,e){RV(t,e),e.add(t)}function ese(t,e,n){RV(t,e),e.set(t,n)}function RV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Og(t,e){return t.get(X_(t,e))}function tse(t,e,n){return t.set(X_(t,e),n),n}function X_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Eu=new WeakMap,UH=new WeakSet;class ha extends Li{static get DEFAULTS(){return Io({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,sn(ha.DEFAULTS,n)),Qoe(this,UH),ese(this,Eu,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>X_(UH,this,nse).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");tse(Eu,this,this._element.firstChild),X(this._element,"htUIInput"),X(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Og(Eu,this).type=this.options.type,Og(Eu,this).placeholder=this.translateIfPossible(this.options.placeholder),Og(Eu,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Og(Eu,this).focus()}}function nse(t){this.options.value=t.target.value}function rse(t,e){EV(t,e),e.add(t)}function Oh(t,e,n){EV(t,e),e.set(t,n)}function EV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tu(t,e,n){return t.set(fd(t,e),n),n}function xt(t,e){return t.get(fd(t,e))}function fd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fn=new WeakMap,xg=new WeakMap,Ag=new WeakMap,pS=new WeakMap,Hg=new WeakMap,Ng=new WeakSet;class Bd extends Li{static get DEFAULTS(){return Io({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,sn(Bd.DEFAULTS,n)),rse(this,Ng),Oh(this,fn,null),Oh(this,xg,[]),Oh(this,Ag,void 0),Oh(this,pS,void 0),Oh(this,Hg,void 0),this.registerHooks()}getMenu(){return xt(fn,this)}registerHooks(){this.addLocalHook("click",()=>fd(Ng,this,sse).call(this))}setItems(e){Tu(xg,this,this.translateNames(e)),xt(fn,this)&&xt(fn,this).setMenuItems(xt(xg,this))}translateNames(e){return H(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Tu(fn,this,new Lc(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),xt(fn,this).setMenuItems(xt(xg,this));const e=new Li(this.hot,{className:"htUISelectCaption"}),n=new Li(this.hot,{className:"htUISelectDropdown"});Tu(Ag,this,e),Tu(pS,this,e.element),Tu(Hg,this,n),this.hot.getSettings().ariaTags&&(ye(n.element,[zl()]),ye(this._element,[mL()])),H([e,n],r=>this._element.appendChild(r.element)),xt(fn,this).addLocalHook("select",r=>fd(Ng,this,ise).call(this,r)),xt(fn,this).addLocalHook("afterClose",()=>fd(Ng,this,ose).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=xt(fn,this).hot.getTranslatedPhrase(bw),xt(pS,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();xt(fn,this)&&(xt(fn,this).open(),xt(fn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),xt(fn,this).getNavigator().toFirstItem(),xt(fn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){xt(fn,this)&&xt(fn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){xt(fn,this)&&(xt(fn,this).destroy(),Tu(fn,this,null)),xt(Ag,this)&&xt(Ag,this).destroy(),xt(Hg,this)&&xt(Hg,this).destroy(),super.destroy()}}function ise(t){t.name!==He&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function ose(){this.runLocalHooks("afterClose")}function sse(){this.openOptions()}function ase(t,e){lse(t,e),e.add(t)}function lse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zH(t,e,n){return(e=use(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function use(t){var e=cse(t,"string");return typeof e=="symbol"?e:e+""}function cse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wS=new WeakSet;class nE extends Rf{constructor(e,n){super(e,{id:n.id,stateless:!1}),ase(this,wS),zH(this,"name",""),zH(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Bd(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ha(this.hot,{placeholder:u_})),this.elements.push(new ha(this.hot,{placeholder:c_})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>YH(wS,this,hse).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),H(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>YH(wS,this,dse).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Io(e.command);n.name.startsWith($t)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),H(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||pl(bn),n=[];return H(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=pl(e?e.name:bn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||H(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Bd)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ha)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{X(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&X(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||H(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[pl(bn)];if(e!==null){const{visualIndex:r}=e;n=Xoe(this.hot.getDataType(0,r,this.hot.countRows(),r))}H(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function hse(t){H(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function dse(t){cf(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),zi(t))}function GH(t,e,n){fse(t,e),e.set(t,n)}function fse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xh(t,e){return t.get(TV(t,e))}function qH(t,e,n){return t.set(TV(t,e),n),n}function TV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _u=new WeakMap,vS=new WeakMap;class bp extends Li{static get DEFAULTS(){return Io({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,sn(bp.DEFAULTS,n)),GH(this,_u,void 0),GH(this,vS,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),qH(vS,this,e),qH(_u,this,this._element.firstChild),xh(_u,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(xh(vS,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?xh(_u,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(xh(_u,this).checked=e)}focus(){this.isBuilt()&&xh(_u,this).focus()}}function gse(t,e){mse(t,e),e.add(t)}function mse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pse(t,e,n){return(e=wse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wse(t){var e=vse(t,"string");return typeof e=="symbol"?e:e+""}function vse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cse(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const KH=0;var XH=new WeakSet;class yse extends Rf{constructor(e,n){super(e,{id:n.id,stateless:!1}),gse(this,XH),pse(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuOperators"),H(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[ca,yp];H(e,n=>{const r=new bp(this.hot,{name:"operator",label:{htmlFor:n,textContent:Woe(n)},value:n,checked:n===e[KH],id:n});r.addLocalHook("change",i=>Cse(XH,this,bse).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(it`Radio button with index ${e} doesn't exist.`);H(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof bp&&n.isChecked());return e?e.getValue():ca}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&H(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ca,n=arguments.length>1?arguments[1]:void 0,r=e;r===K_&&(r=yp),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(KH)}}function bse(t){this.setState(t.target.value)}function Sse(t,e,n){Rse(t,e),e.set(t,n)}function Rse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CS(t,e){return t.get(_V(t,e))}function Ese(t,e,n){return t.set(_V(t,e),n),n}function _V(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ah=new WeakMap;class jd extends Li{static get DEFAULTS(){return Io({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,sn(jd.DEFAULTS,n)),Sse(this,Ah,void 0)}build(){super.build(),Ese(Ah,this,this._element.firstChild)}update(){this.isBuilt()&&(CS(Ah,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&CS(Ah,this).focus()}activate(){CS(Ah,this).click()}}function Tse(t,e){MV(t,e),e.add(t)}function Mu(t,e,n){MV(t,e),e.set(t,n)}function MV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ie(t,e){return t.get(Zu(t,e))}function bi(t,e,n){return t.set(Zu(t,e),n),n}function Zu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ZH="multipleSelect.itemBox";var Oi=new WeakMap,Yt=new WeakMap,yS=new WeakMap,Yo=new WeakMap,ks=new WeakMap,Ls=new WeakMap,Hh=new WeakSet;class Ud extends Li{static get DEFAULTS(){return Io({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,sn(Ud.DEFAULTS,n)),Tse(this,Hh),Mu(this,Oi,[]),Mu(this,Yt,void 0),Mu(this,yS,void 0),Mu(this,Yo,void 0),Mu(this,ks,void 0),Mu(this,Ls,void 0),bi(Yo,this,new ha(this.hot,{placeholder:l_,className:"htUIMultipleSelectSearch"})),bi(ks,this,new jd(this.hot,{textContent:i_,className:"htUISelectAll"})),bi(Ls,this,new jd(this.hot,{textContent:o_,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ie(Yt,this)}registerHooks(){Ie(Yo,this).addLocalHook("keydown",e=>Zu(Hh,this,Mse).call(this,e)),Ie(Yo,this).addLocalHook("input",e=>Zu(Hh,this,_se).call(this,e)),Ie(ks,this).addLocalHook("click",e=>Zu(Hh,this,Ise).call(this,e)),Ie(Ls,this).addLocalHook("click",e=>Zu(Hh,this,Pse).call(this,e))}setItems(e){var n;bi(Oi,this,e),(n=Ie(Yt,this))===null||n===void 0||n.loadData(Ie(Oi,this))}setLocale(e){bi(yS,this,e)}getLocale(){return Ie(yS,this)}getItems(){return[...Ie(Oi,this)]}getValue(){return xse(Ie(Oi,this))}getSearchInputElement(){return Ie(Yo,this)}getSelectAllElement(){return Ie(ks,this)}getClearAllElement(){return Ie(Ls,this)}isSelectedAllValues(){return Ie(Oi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Li(this.hot,{className:"htUISelectionControls",children:[Ie(ks,this),Ie(Ls,this)]});this._element.appendChild(Ie(Yo,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Ie(Yt,this))===null||s===void 0||s.destroy(),X(o,"htUIMultipleSelectHot"),bi(Yt,this,new this.hot.constructor(o,{data:Ie(Oi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ie(Yt,this).listen()},modifyColWidth:u=>{const c=Ie(Yt,this).container.scrollWidth-Sn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ie(Yt,this).init();const l=Ie(Yt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:ZH}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Ie(Yt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:ZH})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Ie(Yt,this).listen()}reset(){Ie(Yo,this).reset(),Ie(ks,this).reset(),Ie(Ls,this).reset()}update(){this.isBuilt()&&(Ie(Yt,this).loadData(Ose(Ie(Oi,this),this.options.value)),super.update())}destroy(){var e;(e=Ie(Yt,this))===null||e===void 0||e.destroy(),Ie(Yo,this).destroy(),Ie(Ls,this).destroy(),Ie(ks,this).destroy(),bi(Yo,this,null),bi(Ls,this,null),bi(ks,this,null),bi(Yt,this,null),bi(Oi,this,null),super.destroy()}}function _se(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Ie(Oi,this)]:n=Ie(Oi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ie(Yt,this).loadData(n)}function Mse(t){this.runLocalHooks("keydown",t,this),$L(cf,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),zi(t),Ie(Yt,this).listen(),Ie(Yt,this).selectCell(0,0))}function Ise(t){const e=[];t.preventDefault(),Ie(Yt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(p$(n,r)[0])}),Ie(Yt,this).setSourceDataAtCell(e)}function Pse(t){const e=[];t.preventDefault(),Ie(Yt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(p$(n,r)[0])}),Ie(Yt,this).setSourceDataAtCell(e)}function Ose(t,e){const n=Ef(e);return t.map(r=>(r.checked=n(r.value),r))}function xse(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Ase(t,e){Hse(t,e),e.add(t)}function Hse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nse(t,e,n){return(e=Dse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dse(t){var e=kse(t,"string");return typeof e=="symbol"?e:e+""}function kse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nh=new WeakSet;class Lse extends Rf{constructor(e,n){super(e,{id:n.id,stateless:!1}),Ase(this,Nh),Nse(this,"name",""),this.name=n.name,this.elements.push(new Ud(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Dg(Nh,this,$se).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Dg(Nh,this,Fse).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===wl){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?bn:wl},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Ml(i,h=>h.name===wl),u={},c=this.hot.getTranslatedPhrase(rp);if(l){const h=s(r,a),d=je(h,v=>v.value),f=new Map(h.map(v=>[v.value,this.hot.getCellMeta(v.meta.visualRow,v.meta.visualCol)])),g=tE(d);o&&(l.args[0]=o);const w=[],C=WH(g,l.args[0],c,v=>{v.checked&&w.push(v.value),Dg(Nh,this,JH).call(this,v,f)}),S=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,S).locale,u.args=[w],u.command=pl(wl),u.itemsSnapshot=C}else u.args=[],u.command=pl(bn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Ud)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{X(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||H(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(rp),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=tE(r),s=WH(o,o,e,l=>{Dg(Nh,this,JH).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:je(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:G_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function $se(t){cf(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),zi(t))}function JH(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Fse(t,e){switch(e.type){case"numeric":return mF(t,e);default:return t}}var IV;function Vse(t,e){Wse(t,e),e.add(t)}function Wse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bse(t,e,n){return(e=jse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jse(t){var e=Use(t,"string");return typeof e=="symbol"?e:e+""}function Use(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zse(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var QH=new WeakSet;class zd extends Rf{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Vse(this,QH),Bse(this,"name",""),this.name=n.name,this.elements.push(new ha(this.hot,{type:"button",value:s_,className:"htUIButton htUIButtonOK",identifier:zd.BUTTON_OK})),this.elements.push(new ha(this.hot,{type:"button",value:a_,className:"htUIButton htUIButtonCancel",identifier:zd.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){H(this.elements,e=>{e.addLocalHook("click",(n,r)=>zse(QH,this,Yse).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuActionBar"),H(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}IV=zd;function Yse(t,e){e.options.identifier===IV.BUTTON_OK?this.accept():this.cancel()}function bS(t,e,n){return(e=Gse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gse(t){var e=qse(t,"string");return typeof e=="symbol"?e:e+""}function qse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eN="ConditionCollection.filteringStates";class Z_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;bS(this,"hot",void 0),bS(this,"isMapRegistrable",void 0),bS(this,"filteringStates",new yw),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(eN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i?.conditions)!==null&&r!==void 0?r:[],s=i?.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ca;return e.length?Voe(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ca,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(it`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Pt(Wd[r]))throw new Error(it`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:da(a,s)}]},i):u.push({name:a,args:s,func:da(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(eN),this.filteringStates=null,this.clearLocalHooks()}}ft(Z_,Tn);function tN(t,e,n){return(e=Kse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kse(t){var e=Xse(t,"string");return typeof e=="symbol"?e:e+""}function Xse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];tN(this,"conditionCollection",void 0),tN(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return H(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return H(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return H(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function Zse(t,e){Jse(t,e),e.add(t)}function Jse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ba(t,e,n){return(e=Qse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qse(t){var e=eae(t,"string");return typeof e=="symbol"?e:e+""}function eae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kg=new WeakSet;class OV{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Zse(this,kg),Ba(this,"hot",void 0),Ba(this,"conditionCollection",void 0),Ba(this,"columnDataFactory",void 0),Ba(this,"changes",[]),Ba(this,"grouping",!1),Ba(this,"latestEditedColumnPosition",-1),Ba(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>SS(kg,this,tae).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>SS(kg,this,nae).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>SS(kg,this,rae).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,H(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=M3(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new Z_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const w=r.columnDataFactory(h);let C;f.isEmpty()?C=w:C=new PV(f,v=>r.columnDataFactory(v)).filter(),C=je(C,v=>v.meta.visualRow);const S=Ef(C);return f.destroy(),Ml(w,v=>S(v.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),De(this,(e,n)=>{this[n]=null})}}function tae(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function nae(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function rae(){H(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ft(OV,Tn);function iae(t){return ZF({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Ud)return r;if(i.element&&!gc(i.element))return!1;i.focus()}})}const Dh="filters";function oae(t,e){let n=-1,r;const i=iae(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Dh),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof Li&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Dh),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Dh)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const w=r.getNavigator();w.getCurrentPage()>-1&&(n=w.getCurrentPage()),w.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const w=e[i.getCurrentPage()];w instanceof Bd&&(w.openOptions(),g.preventDefault()),w instanceof jd&&(w.activate(),g.preventDefault()),w instanceof Li||g.preventDefault()}}],Dh)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Dh)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function sae(t,e){xV(t,e),e.add(t)}function RS(t,e,n){xV(t,e),e.set(t,n)}function xV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kh(t,e,n){return(e=aae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aae(t){var e=lae(t,"string");return typeof e=="symbol"?e:e+""}function lae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nm(t,e,n){return t.set(hr(t,e),n),n}function ti(t,e){return t.get(hr(t,e))}function hr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rE="filters",uae=250,nN=rE;var Jo=new WeakMap,iE=new WeakMap,hl=new WeakMap,Tr=new WeakSet;class cae extends Je{static get PLUGIN_KEY(){return rE}static get PLUGIN_PRIORITY(){return uae}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,sae(this,Tr),kh(this,"dropdownMenuPlugin",null),kh(this,"conditionCollection",null),kh(this,"conditionUpdateObserver",null),kh(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),kh(this,"filtersRowsMap",null),RS(this,Jo,void 0),RS(this,iE,new WeakSet),RS(this,hl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hr(Tr,n,wae).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[rE]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new gf),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>hr(Tr,this,rN).call(this,"accept")),a.addLocalHook("cancel",()=>hr(Tr,this,rN).call(this,"cancel")),a.addLocalHook("change",l=>hr(Tr,this,pae).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(t_)}:`,s=()=>`${this.hot.getTranslatedPhrase(n_)}:`;if(!this.components.get("filter_by_condition")){const a=new nE(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>hr(Tr,this,iN).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new yse(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new nE(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>hr(Tr,this,iN).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new Lse(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new zd(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Z_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new OV(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>hr(Tr,this,vae).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return hr(Tr,e,mae).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>hr(Tr,this,gae).call(this)),this.addHook("afterDropdownMenuShow",()=>hr(Tr,this,dae).call(this)),this.addHook("afterDropdownMenuHide",()=>hr(Tr,this,fae).call(this)),this.addHook("afterChange",a=>hr(Tr,this,hae).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!ti(Jo,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=ti(Jo,this).getMenu(),c=u.getNavigator(),h=ti(Jo,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Nm(Jo,this,oae(this.dropdownMenuPlugin.menu,a));const l=u=>{ti(Jo,this).listen(),u.preventDefault(),cf(u.keyCode,"TAB")&&(u.shiftKey?ti(Jo,this).toPreviousItem():ti(Jo,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:nN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(nN)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ca;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,ti(hl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=je(n.filter(),u=>u.meta.visualRow);const l=Ef(i);de(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),H(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),Nm(hl,this,this.exportConditions())}else s!==!1&&!r?(Nm(hl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(ti(hl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return H(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),w=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:G_(w)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=tE(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===yp&&n.command.key!==bn&&r.command.key!==bn&&i.command.key!==bn?o=K_:i.command.key!==bn&&(n.command.key===bn||r.command.key===bn)&&(o=ca),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new PV(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return H(i,s=>{H(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function hae(t){t&&H(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function dae(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function fae(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function gae(){const t=this.dropdownMenuPlugin.menu;ti(iE,this).has(t)||ti(Jo,this).setMenu(t),ti(iE,this).add(t)}function mae(t){t.items.push({name:He}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function rN(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==bn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==bn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==bn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function pae(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===nE&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function iN(){this.setListeningDropdownMenu()}function wae(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?X(e,"htFiltersActive"):ve(e,"htFiltersActive")}function vae(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&Nm(hl,this,ti(hl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===wl),s=n.filter(a=>a.name!==wl);if(o.length>=2||s.length>=3)Ze(it`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const AV="internal-use-in-handsontable",oE={licenseKey:AV,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function HV(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Dn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function NV(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Cae(t){var e;const n=t[Dn],r=NV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=HV(t);return{...oE,...r,...i}}function yae(t){var e;const n=t[Dn],r=NV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=HV(t);return{...r,...i}}function bae(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Bw(){const t="engine_relationship",e=gi(Dn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function J_(){const t="shared_engine_usage",e=gi(Dn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Sae(t){const e=t.getSettings(),n=e[Dn],r=n?.engine;if(n===!0||Pt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Rae((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Pt(r.hyperformula)){const o=Bw(),s=J_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:AV}),(r.getConfig().leapYear1900!==oE.leapYear1900||m0(r.getConfig().nullDate,oE.nullDate)===!1)&&Ze(it`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Rae(t,e,n){const r=e[Dn],i=Cae(e),o=Bw(),s=J_();Eae(t,r.functions),Tae(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),_ae(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function oN(t){var e;const n=Bw(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function sN(t,e){if(t){const n=Bw(),r=n.get(t),i=J_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Eae(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){Ze(s.message)}})}function Tae(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){Ze(r.message)}}}function _ae(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){Ze(a.message)}}),t.resumeEvaluation())}function Mae(t,e){return(Pt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const DV="DD/MM/YYYY";function Iae(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Pae(t){return Iae(t)?t.substr(1):t}function Oae(t){return typeof t=="string"&&t.startsWith("=")}function Q_(t,e){return typeof t=="string"&&e==="date"}function kV(t,e){return J(t,e,!0).isValid()}function LV(t,e){return J(t,e,!0).format(DV)}function xae(t,e){return J(t,DV,!0).format(e)}function $V(t,e){const r=new Date(Date.UTC(0,0,t+-1));return J(r).format(e)}function Aae(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Hae(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Nae(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function eM(t,e,n){const r=Hae(t,Aae(t,e,n));return Nae(r)}function ja(t,e,n){Dae(t,e),e.set(t,n)}function Dae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rt(t,e){return t.get(FV(t,e))}function $s(t,e,n){return t.set(FV(t,e),n),n}function FV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lh=new WeakMap,Fs=new WeakMap,_r=new WeakMap,Lg=new WeakMap,ES=new WeakMap,TS=new WeakMap,$g=new WeakMap;class aN{constructor(e,n,r){ja(this,Lh,void 0),ja(this,Fs,void 0),ja(this,_r,void 0),ja(this,Lg,[]),ja(this,ES,[]),ja(this,TS,void 0),ja(this,$g,[]),$s(Lh,this,e),$s(Fs,this,n),$s(_r,this,r)}setRemovedHfIndexes(e){return $s($g,this,e.map(n=>{const r=Rt(Fs,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Rt($g,this)}getRemovedHfIndexes(){return Rt($g,this)}getHfIndexFromVisualIndex(e){const n=Rt(Fs,this).getIndexesSequence(),r=Rt(Fs,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Vi(Rt(Lh,this))}s`;Rt(_r,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Rt(_r,this).getEngine()[r](Rt(_r,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&($s(ES,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),$s(TS,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Rt(_r,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=eM(Rt(ES,this),Rt(TS,this),Rt(Fs,this).getNumberOfIndexes());Rt(_r,this).getSheetId()===null?Rt(_r,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Vi(Rt(Lh,this))}Order`;return n=>{if(Rt(_r,this).isPerformingUndoRedo())return;const r=Rt(Fs,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=Rt(Lg,this).map(l=>r.indexOf(l)),o=Rt(_r,this).getEngine().getSheetDimensions(Rt(_r,this).getSheetId());let s;Rt(Lh,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Rt(_r,this).getEngine()[e](Rt(_r,this).getSheetId(),i)}$s(Lg,this,r)}}init(){$s(Lg,this,Rt(Fs,this).getIndexesSequence())}}function Ua(t,e,n){kae(t,e),e.set(t,n)}function kae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Go(t,e){return t.get(VV(t,e))}function za(t,e,n){return t.set(VV(t,e),n),n}function VV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fg=new WeakMap,Vg=new WeakMap,_S=new WeakMap,MS=new WeakMap,IS=new WeakMap,PS=new WeakMap,OS=new WeakMap;class Lae{constructor(e,n,r){Ua(this,Fg,void 0),Ua(this,Vg,void 0),Ua(this,_S,void 0),Ua(this,MS,!1),Ua(this,IS,!1),Ua(this,PS,null),Ua(this,OS,null),za(Fg,this,new aN("row",e,this)),za(Vg,this,new aN("column",n,this)),za(_S,this,r)}getForAxis(e){return e==="row"?Go(Fg,this):Go(Vg,this)}setPerformUndo(e){za(MS,this,e)}setPerformRedo(e){za(IS,this,e)}isPerformingUndoRedo(){return Go(MS,this)||Go(IS,this)}getSheetId(){return Go(OS,this)}getEngine(){return Go(PS,this)}getPostponeAction(){return Go(_S,this)}setupSyncEndpoint(e,n){za(PS,this,e),za(OS,this,n),Go(Fg,this).init(),Go(Vg,this).init()}}function $ae(t,e){WV(t,e),e.add(t)}function Ya(t,e,n){return(e=Fae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fae(t){var e=Vae(t,"string");return typeof e=="symbol"?e:e+""}function Vae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xS(t,e,n){WV(t,e),e.set(t,n)}function WV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fa(t,e,n){return t.set(Ge(t,e),n),n}function El(t,e){return t.get(Ge(t,e))}function Ge(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Dn="formulas",Wae=["maxRows","maxColumns","language"],Bae=260;ie.getSingleton().register("afterNamedExpressionAdded");ie.getSingleton().register("afterNamedExpressionRemoved");ie.getSingleton().register("afterSheetAdded");ie.getSingleton().register("afterSheetRemoved");ie.getSingleton().register("afterSheetRenamed");ie.getSingleton().register("afterFormulasValuesUpdate");const $c=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var ys=new WeakMap,jw=new WeakMap,$h=new WeakMap,Xe=new WeakSet;class jae extends Je{constructor(){var e;super(...arguments),e=this,$ae(this,Xe),xS(this,ys,!1),xS(this,jw,!1),xS(this,$h,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,ole).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,sle).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,ale).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,lle).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,ule).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ge(Xe,e,cle).call(e,...r)}]]),Ya(this,"staticRegister",gi("formulas")),Ya(this,"engine",null),Ya(this,"sheetId",null),Ya(this,"sheetName",null),Ya(this,"indexSyncer",null),Ya(this,"rowAxisSyncer",null),Ya(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Dn}static get PLUGIN_PRIORITY(){return Bae}static get SETTING_KEYS(){return[Dn,...Wae]}isEnabled(){return!!this.hot.getSettings()[Dn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Sae(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Ze("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&Ge(Xe,this,gd).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,lN).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,uN).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,lN).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,uN).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,Gae).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,qae).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,Uae).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,Kae).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,cN).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,cN).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,Xae).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,Zae).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,ele).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,tle).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,Jae).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,Qae).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,nle).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,rle).call(n,...i)}),this.indexSyncer=new Lae(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,Yae).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,ile).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ge(Xe,n,zae).call(n,...i)}),El($h,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){El($h,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),sN(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=yae(this.hot.getSettings());bae(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Dn];if(ue(r)&&ue(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Dn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());Ge(Xe,this,gd).call(this,o)}}super.updatePlugin(e)}destroy(){El($h,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),fa($h,this,null),sN(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ue(n)&&!$9(n))return Ze("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Ze("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return Ze(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){b0(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Ge(Xe,this,gd).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Vi(Dn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),oN(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o?.address)!==null&&s!==void 0?s:{};return ue(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ue(l)===!1||ue(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=oN(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Ze(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return Q_(r,o.type)&&(kV(r,o.dateFormat)?r=LV(r,o.dateFormat):Oae(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function gd(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function Uae(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Zn(s)&&(s=$V(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function zae(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:w}=h.start,{row:C,col:S}=h.end,v=C-g+1,E=S-w+1;for(let P=0;P<f.length;P+=1)for(let x=0;x<f[P].length;x+=1){const _=f[P][x],M=g+P%v,V=w+x%E,z=this.hot.getCellMeta(M,V);Q_(_,z.type)&&(_.startsWith("'")?f[P][x]=_.slice(1):this.isFormulaCellType(M,V,this.sheetId)===!1&&(f[P][x]=xae(_,z.dateFormat)))}return f}function lN(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Vi(Dn))||fa(jw,this,Pt(this.hot.getSettings().data))}function Yae(){if(El(jw,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;Q_(i,s.type)&&(kV(i,a)?t[r][o]=LV(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),fa(ys,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),fa(ys,this,!1)}function uN(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Vi(Dn)))return;const r=Mae(this.engine,this.hot.getSettings()[Dn].sheetName);if(Ge(Xe,this,gd).call(this,r),n!=="updateSettings")if(El(jw,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){fa(ys,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),fa(ys,this,!1)}}}function Gae(t,e,n,r){if(r!=="get"||El(ys,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){n.value=Pae(n.value);return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let s=this.engine.getCellValue(o);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&Zn(s)&&(s=$V(s,a.dateFormat)),n.value=typeof s=="object"&&s!==null?s.value:s}function qae(t,e,n,r){if(r!=="get"||El(ys,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function cN(t,e){if($c(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Kae(t,e){if($c(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Zn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Ze(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Xae(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Zae(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Jae(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Qae(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function ele(t,e,n){if($c(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function tle(t,e,n){if($c(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function nle(t,e,n,r){if($c(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function rle(t,e,n,r){if($c(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function ile(t,e,n){var r;fa(ys,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());fa(ys,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function ole(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function sle(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function ale(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function lle(t){this.hot.runHooks("afterSheetAdded",t)}function ule(t,e){Ge(Xe,this,gd).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function cle(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function hle(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(AT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function dle(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(HT,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=je(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return H(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function fle(t,e){BV(t,e),e.add(t)}function gle(t,e,n){BV(t,e),e.set(t,n)}function BV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ga(t,e){return t.get(Gs(t,e))}function hN(t,e,n){return t.set(Gs(t,e),n),n}function Gs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideColumns");ie.getSingleton().register("afterHideColumns");ie.getSingleton().register("beforeUnhideColumns");ie.getSingleton().register("afterUnhideColumns");const dN="hiddenColumns",mle=310;var no=new WeakMap,qa=new WeakSet;class ple extends Je{constructor(){super(...arguments),fle(this,qa),gle(this,no,null)}static get PLUGIN_KEY(){return dN}static get PLUGIN_PRIORITY(){return mle}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[dN]}enablePlugin(){var e=this;this.enabled||(hN(no,this,new Cw),Ga(no,this).addLocalHook("init",()=>Gs(qa,this,Sle).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ga(no,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Gs(qa,e,ble).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Gs(qa,this,vle).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Gs(qa,this,wle).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Gs(qa,e,yle).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Gs(qa,this,Cle).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Ga(no,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));H(l,u=>{o[u]=!1}),i=Er(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Ga(no,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{Ga(no,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return je(Ga(no,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Ga(no,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){H(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){hN(no,this,null),super.destroy()}}function wle(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function vle(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Cle(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return H(t,r=>{let i=!0,o=0;de(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function yle(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),X(e,n)}function ble(t){t.items.push({name:He},hle(this),dle(this))}function Sle(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Rle(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(NT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Ele(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(DT,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=je(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return H(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Tle(t,e){jV(t,e),e.add(t)}function _le(t,e,n){jV(t,e),e.set(t,n)}function jV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ka(t,e){return t.get(qs(t,e))}function fN(t,e,n){return t.set(qs(t,e),n),n}function qs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideRows");ie.getSingleton().register("afterHideRows");ie.getSingleton().register("beforeUnhideRows");ie.getSingleton().register("afterUnhideRows");const gN="hiddenRows",Mle=320;var ro=new WeakMap,Xa=new WeakSet;class Ile extends Je{constructor(){super(...arguments),Tle(this,Xa),_le(this,ro,null)}static get PLUGIN_KEY(){return gN}static get PLUGIN_PRIORITY(){return Mle}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[gN]}enablePlugin(){var e=this;this.enabled||(fN(ro,this,new Cw),Ka(ro,this).addLocalHook("init",()=>qs(Xa,this,Nle).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ka(ro,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qs(Xa,e,Hle).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>qs(Xa,this,Ole).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>qs(Xa,this,Ple).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qs(Xa,e,Ale).call(e,...r)}),this.addHook("modifyCopyableRange",n=>qs(Xa,this,xle).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Ka(ro,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));H(l,u=>{o[u]=!1}),i=Er(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Ka(ro,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{Ka(ro,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return je(Ka(ro,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ka(ro,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){H(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){fN(ro,this,null),super.destroy()}}function Ple(t,e){return this.isHidden(e)?0:t}function Ole(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function xle(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return H(t,r=>{let i=!0,o=0;de(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Ale(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),X(e,n)}function Hle(t){t.items.push({name:He},Rle(this),Ele(this))}function Nle(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Dle(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(lT)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function kle(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(uT)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Lle(t,e){UV(t,e),e.add(t)}function $le(t,e,n){UV(t,e),e.set(t,n)}function UV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sE(t,e){return t.get(Sp(t,e))}function AS(t,e,n){return t.set(Sp(t,e),n),n}function Sp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnFreeze");ie.getSingleton().register("afterColumnFreeze");ie.getSingleton().register("beforeColumnUnfreeze");ie.getSingleton().register("afterColumnUnfreeze");const mN="manualColumnFreeze",Fle=110;var ll=new WeakMap,HS=new WeakSet;class Vle extends Je{constructor(){super(...arguments),Lle(this,HS),$le(this,ll,!1)}static get PLUGIN_KEY(){return mN}static get PLUGIN_PRIORITY(){return Fle}isEnabled(){return!!this.hot.getSettings()[mN]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Sp(HS,this,Wle).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Sp(HS,this,Ble).call(this,e,n)),super.enablePlugin())}disablePlugin(){AS(ll,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;sE(ll,this)||AS(ll,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;sE(ll,this)||AS(ll,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Wle(t){t.items.push({name:"---------"},Dle(this),kle(this))}function Ble(t,e){if(sE(ll,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Wg(t,e,n){return(e=jle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jle(t){var e=Ule(t,"string");return typeof e=="symbol"?e:e+""}function Ule(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const NS=0,pN=1,wN=2,Iu="px";let zV=class{constructor(e){Wg(this,"hot",void 0),Wg(this,"_element",null),Wg(this,"state",NS),Wg(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=wN}build(){this.state===NS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=pN)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=NS}isAppended(){return this.state===wN}isBuilt(){return this.state>=pN}setPosition(e,n){Zn(e)&&(this._element.style.top=e+Iu),Zn(n)&&(this._element.style[this.inlineProperty]=n+Iu)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Zn(e)&&(this._element.style.width=e+Iu),Zn(n)&&(this._element.style.height=n+Iu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Zn(e)&&(this._element.style.marginTop=e+Iu),Zn(n)&&(this._element.style[`margin${Vi(this.inlineProperty)}`]=n+Iu)}getOffset(){const e=this._element.style,n=`margin${Vi(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const zle="ht__manualColumnMove--backlight";let Yle=class extends zV{build(){super.build(),X(this._element,zle)}};const Gle="ht__manualColumnMove--guideline";let qle=class extends zV{build(){super.build(),X(this._element,Gle)}};function Kle(t,e){YV(t,e),e.add(t)}function Si(t,e,n){YV(t,e),e.set(t,n)}function YV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wr(t,e,n){return t.set(Ks(t,e),n),n}function he(t,e){return t.get(Ks(t,e))}function Ks(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnMove");ie.getSingleton().register("afterColumnMove");const DS="manualColumnMove",Xle=120,vN="ht__manualColumnMove",Rp="show-ui",aE="on-moving--columns",lE="after-selection--columns";var Kn=new WeakMap,Zs=new WeakMap,cs=new WeakMap,Dm=new WeakMap,oa=new WeakMap,qn=new WeakMap,Bg=new WeakMap,Xr=new WeakMap,zu=new WeakMap,Ep=new WeakMap,md=new WeakMap,Za=new WeakSet;class Zle extends Je{constructor(){super(...arguments),Kle(this,Za),Si(this,Kn,new Yle(this.hot)),Si(this,Zs,new qle(this.hot)),Si(this,cs,[]),Si(this,Dm,0),Si(this,oa,!1),Si(this,qn,{}),Si(this,Bg,void 0),Si(this,Xr,void 0),Si(this,zu,void 0),Si(this,Ep,void 0),Si(this,md,void 0)}static get PLUGIN_KEY(){return DS}static get PLUGIN_PRIORITY(){return Xle}isEnabled(){return!!this.hot.getSettings()[DS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ks(Za,e,Jle).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ks(Za,e,eue).call(e,...r)}),this.addHook("afterScrollVertically",()=>Ks(Za,this,nue).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ks(Za,e,rue).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,vN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ve(this.hot.rootElement,vN),this.unregisterEvents(),he(Kn,this).destroy(),he(Zs,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(Bg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(wr(Bg,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return wr(Bg,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Er(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[DS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return de(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(Xr,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(Xr,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(Kn,this).getOffset().start,u=he(Kn,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,w=qt(this.hot.rootElement),C=g.innerWidth-he(zu,this)-w;h=g.innerWidth-he(qn,this).eventPageX-C-(r.scrollX===void 0?i:0)}else h=he(qn,this).eventPageX-(he(zu,this)-(r.scrollX===void 0?i:0));if(he(Ep,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(Xr,this))&&(o+=i),o+=c,he(Xr,this)<0)he(md,this)>0?he(qn,this).col=0:he(qn,this).col=e>0?e-1:e;else if(he(qn,this).TD.offsetWidth/2+o<=h){const g=he(Xr,this)>=he(Dm,this)?he(Dm,this)-1:he(Xr,this);he(qn,this).col=g+1,o+=he(qn,this).TD.offsetWidth}else he(qn,this).col=he(Xr,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(Xr,this)<he(md,this)&&(f-=he(zu,this)<=r.scrollX?he(zu,this):0),he(Kn,this).setPosition(null,d),he(Zs,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ks(Za,this,Qle).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ks(Za,this,tue).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(Kn,this).build(),he(Zs,this).build()}destroy(){he(Kn,this).destroy(),he(Zs,this).destroy(),super.destroy()}}function Jle(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=be(t.target,"sortAction");if(!s||!o||he(oa,this)||t.button!==0||a){wr(oa,this,!1),he(cs,this).length=0,ve(this.hot.rootElement,[aE,Rp]);return}const l=he(Zs,this).isBuilt()&&!he(Zs,this).isAppended(),u=he(Kn,this).isBuilt()&&!he(Kn,this).isAppended();l&&u&&(he(Zs,this).appendTo(i.hider),he(Kn,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,wr(oa,this,!0);const g=n.firstChild?A3(t,n.firstChild).x:t.offsetX;he(qn,this).eventPageX=t.pageX,wr(Xr,this,e.col),he(qn,this).TD=n,he(qn,this).col=e.col,wr(cs,this,this.prepareColumnsToMoving(d,f)),wr(Ep,this,!!this.hot.getSettings().rowHeaders),wr(Dm,this,this.hot.countCols()),wr(md,this,this.hot.getSettings().fixedColumnsStart),wr(zu,this,kn(this.hot.rootElement).left);const w=he(Ep,this)?-1:0,C=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,S=e.col<he(md,this),v=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),E=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),P=this.getColumnsWidth(d,e.col-1)+E,x=this.getColumnsWidth(w,d-1)+(S?v:0)+P;he(Kn,this).setPosition(C,x),he(Kn,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-C),he(Kn,this).setOffset(null,-P),X(this.hot.rootElement,aE)}else ve(this.hot.rootElement,lE),wr(oa,this,!1),he(cs,this).length=0}function Qle(t){he(oa,this)&&(he(qn,this).eventPageX=t.pageX,this.refreshPositions())}function eue(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(oa,this)||(he(cs,this).indexOf(e.col)>-1?ve(this.hot.rootElement,Rp):X(this.hot.rootElement,Rp),r.row=!0,r.column=!0,r.cell=!0,wr(Xr,this,e.col),he(qn,this).TD=n)}function tue(){const t=he(qn,this).col,e=he(cs,this).length;if(wr(Xr,this,void 0),wr(oa,this,!1),ve(this.hot.rootElement,[aE,Rp,lE]),this.hot.selection.isSelectedByColumnHeader()&&X(this.hot.rootElement,lE),e<1||t===void 0)return;const n=he(cs,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(cs,this),t);if(he(cs,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function nue(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(Kn,this).setPosition(r),he(Kn,this).setSize(null,t.hider.offsetHeight-r)}function rue(){this.moveBySettingsOrLoad()}function iue(t,e){GV(t,e),e.add(t)}function Pn(t,e,n){GV(t,e),e.set(t,n)}function GV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(t,e,n){return t.set(xi(t,e),n),n}function oe(t,e){return t.get(xi(t,e))}function xi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Tp="manualColumnResize",oue=130,CN="manualColumnWidths";var rs=new WeakMap,jg=new WeakMap,Dr=new WeakMap,_p=new WeakMap,So=new WeakMap,sue=new WeakMap,sc=new WeakMap,Ug=new WeakMap,cr=new WeakMap,Qo=new WeakMap,Dl=new WeakMap,Mp=new WeakMap,pd=new WeakMap,wd=new WeakMap,Lr=new WeakMap,vd=new WeakMap,io=new WeakSet;class aue extends Je{static get PLUGIN_KEY(){return Tp}static get PLUGIN_PRIORITY(){return oue}constructor(e){super(e),iue(this,io),Pn(this,rs,null),Pn(this,jg,null),Pn(this,Dr,[]),Pn(this,_p,null),Pn(this,So,null),Pn(this,sue,null),Pn(this,sc,null),Pn(this,Ug,null),Pn(this,cr,this.hot.rootDocument.createElement("DIV")),Pn(this,Qo,this.hot.rootDocument.createElement("DIV")),Pn(this,Dl,null),Pn(this,Mp,!1),Pn(this,pd,0),Pn(this,wd,null),Pn(this,Lr,void 0),Pn(this,vd,void 0),X(oe(cr,this),"manualColumnResizer"),X(oe(Qo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Tp]}enablePlugin(){var e=this;this.enabled||(Bt(Lr,this,new Ca),oe(Lr,this).addLocalHook("init",()=>xi(io,this,lue).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,oe(Lr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xi(io,e,gue).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xi(io,e,mue).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xi(io,e,pue).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Bt(vd,this,oe(Lr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",CN,oe(Lr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",CN,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return oe(Lr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);oe(Lr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Bt(rs,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(oe(rs,this)),i=r.col;if(i<0)return;const o=on(oe(rs,this)),s=oe(rs,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(oe(rs,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(oe(rs,this),r.row,r.col)),Bt(jg,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Bt(Dr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();H(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;de(d,f,g=>{oe(Dr,this).includes(g)||oe(Dr,this).push(g)})})}oe(Dr,this).includes(oe(jg,this))||Bt(Dr,this,[oe(jg,this)]),Bt(Ug,this,l.start-6),Bt(sc,this,parseInt(s.width,10)),oe(cr,this).style.top=`${l.top}px`,oe(cr,this).style[this.inlineDir]=`${oe(Ug,this)+oe(sc,this)}px`,oe(cr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(oe(cr,this))}refreshHandlePosition(){oe(cr,this).style[this.inlineDir]=`${oe(Ug,this)+oe(_p,this)}px`}setupGuidePosition(){const e=parseInt(on(oe(cr,this)),10),n=parseInt(oe(cr,this).style.top,10)+e,r=this.hot.view.getTableHeight();X(oe(cr,this),"active"),X(oe(Qo,this),"active"),oe(Qo,this).style.top=`${n}px`,this.refreshGuidePosition(),oe(Qo,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(oe(Qo,this))}refreshGuidePosition(){oe(Qo,this).style[this.inlineDir]=oe(cr,this).style[this.inlineDir]}hideHandleAndGuide(){ve(oe(cr,this),"active"),ve(oe(Qo,this),"active")}checkIfColumnHeader(e){const n=Il(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",oe(So,this),r,!0);o!==void 0&&Bt(So,this,o),this.setManualSize(r,oe(So,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(So,this),r,!0),i&&e()};oe(pd,this)>=2&&(oe(Dr,this).length>1?(H(oe(Dr,this),i=>{n(i)}),e()):H(oe(Dr,this),i=>{n(i,!0)})),Bt(pd,this,0),Bt(wd,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>xi(io,this,uue).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>xi(io,this,cue).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>xi(io,this,hue).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>xi(io,this,due).call(this)),this.eventManager.addEventListener(oe(cr,this),"contextmenu",()=>xi(io,this,fue).call(this))}destroy(){super.destroy()}}function lue(){const t=this.hot.getSettings()[Tp],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{oe(Lr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{oe(Lr,this).setValueAtIndex(r,n)})},!0),Bt(vd,this,t)):t===!0&&Array.isArray(oe(vd,this))&&this.hot.batchExecution(()=>{oe(vd,this).forEach((n,r)=>{oe(Lr,this).setValueAtIndex(r,n)})},!0)}function uue(t){if(!DL(t.target)&&oe(Mp,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(oe(Dl,this)||this.setupHandlePosition(e))}}function cue(t){t.target.parentNode===this.hot.rootElement&&be(t.target,"manualColumnResizer")&&(this.setupHandlePosition(oe(rs,this)),this.setupGuidePosition(),Bt(Dl,this,!0),oe(wd,this)===null&&(Bt(wd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(oe(wd,this))),Bt(pd,this,oe(pd,this)+1),this.startX=t.pageX,Bt(So,this,oe(sc,this)))}function hue(t){if(oe(Dl,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Bt(_p,this,oe(sc,this)+e),H(oe(Dr,this),n=>{Bt(So,this,this.setManualSize(n,oe(_p,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function due(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",oe(So,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(So,this),n,!1)};oe(Dl,this)&&(this.hideHandleAndGuide(),Bt(Dl,this,!1),oe(So,this)!==oe(sc,this)&&(oe(Dr,this).length>1?(H(oe(Dr,this),r=>{e(r)}),t()):H(oe(Dr,this),r=>{e(r,!0)})),this.setupHandlePosition(oe(rs,this)))}function fue(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(oe(cr,this)),this.hot.rootElement.removeChild(oe(Qo,this)),Bt(Dl,this,!1),Bt(Mp,this,!0),this.hot._registerImmediate(()=>{Bt(Mp,this,!1)})}function gue(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=oe(Lr,this).getValueAtIndex(r);this.hot.getSettings()[Tp]&&i&&(n=i)}return n}function mue(t,e){const n=oe(Lr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function pue(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function kS(t,e,n){return(e=wue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wue(t){var e=vue(t,"string");return typeof e=="symbol"?e:e+""}function vue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const LS=0,yN=1,bN=2,Pu="px";let qV=class{constructor(e){kS(this,"hot",void 0),kS(this,"_element",null),kS(this,"state",LS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=bN}build(){this.state===LS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=yN)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=LS}isAppended(){return this.state===bN}isBuilt(){return this.state>=yN}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Pu),n!==void 0&&(this._element.style.left=n+Pu)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Pu),n&&(this._element.style.height=n+Pu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Pu),n&&(this._element.style.marginLeft=n+Pu)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Cue="ht__manualRowMove--backlight";class yue extends qV{build(){super.build(),X(this._element,Cue)}}const bue="ht__manualRowMove--guideline";class Sue extends qV{build(){super.build(),X(this._element,bue)}}function Rue(t,e){KV(t,e),e.add(t)}function Ou(t,e,n){KV(t,e),e.set(t,n)}function KV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vl(t,e,n){return t.set(Xs(t,e),n),n}function Te(t,e){return t.get(Xs(t,e))}function Xs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeRowMove");ie.getSingleton().register("afterRowMove");const $S="manualRowMove",Eue=140,SN="ht__manualRowMove",Ip="show-ui",uE="on-moving--rows",cE="after-selection--rows";var Xn=new WeakMap,Js=new WeakMap,hs=new WeakMap,sa=new WeakMap,Cr=new WeakMap,zg=new WeakMap,Ja=new WeakSet;class Tue extends Je{constructor(){super(...arguments),Rue(this,Ja),Ou(this,Xn,new yue(this.hot)),Ou(this,Js,new Sue(this.hot)),Ou(this,hs,[]),Ou(this,sa,void 0),Ou(this,Cr,{}),Ou(this,zg,void 0)}static get PLUGIN_KEY(){return $S}static get PLUGIN_PRIORITY(){return Eue}isEnabled(){return!!this.hot.getSettings()[$S]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xs(Ja,e,_ue).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xs(Ja,e,Iue).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Xs(Ja,this,Oue).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xs(Ja,e,xue).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,SN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ve(this.hot.rootElement,SN),this.unregisterEvents(),Te(Xn,this).destroy(),Te(Js,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Te(zg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(vl(zg,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return vl(zg,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Er(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[$S];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return de(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Te(Cr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Te(Cr,this).TD,a=this.hot.rootElement,l=kn(a),u=Hd(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Te(Cr,this).eventPageY-d+c,g=o.hider.offsetHeight,w=o.TBODY.offsetTop,C=Te(Xn,this).getOffset().top,S=Te(Xn,this).getSize().height,v=s.offsetHeight/2,E=s.offsetHeight;let P=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const x=f>=P+v;this.isFixedRowTop(e.row)&&(P+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Te(Cr,this).row=n>0?n-1:n:x?(Te(Cr,this).row=e.row+1,P+=e.row===0?E-1:E):Te(Cr,this).row=e.row;let _=f,M=P;f+S+C>=g?_=g-S-C:f+C<w&&(_=w+Math.abs(C)),P>=g-1&&(M=g-1),Te(Xn,this).setPosition(_),Te(Js,this).setPosition(M)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Xs(Ja,this,Mue).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Xs(Ja,this,Pue).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Te(Xn,this).build(),Te(Js,this).build()}destroy(){Te(Xn,this).destroy(),Te(Js,this).destroy(),super.destroy()}}function _ue(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Te(sa,this)||t.button!==0){vl(sa,this,!1),Te(hs,this).length=0,ve(this.hot.rootElement,[uE,Ip]);return}const l=Te(Js,this).isBuilt()&&!Te(Js,this).isAppended(),u=Te(Xn,this).isBuilt()&&!Te(Xn,this).isAppended();l&&u&&(Te(Js,this).appendTo(i.hider),Te(Xn,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,vl(sa,this,!0),Te(Cr,this).eventPageY=t.pageY,Te(Cr,this).coords=e,Te(Cr,this).TD=n,vl(hs,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),w=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Te(Xn,this).setPosition(null,g),Te(Xn,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),Te(Xn,this).setOffset(-w,null),X(this.hot.rootElement,uE),this.refreshPositions()}else ve(this.hot.rootElement,cE),vl(sa,this,!1),Te(hs,this).length=0}function Mue(t){Te(sa,this)&&(Te(Cr,this).eventPageY=t.pageY,this.refreshPositions())}function Iue(t,e,n,r){!this.hot.getSelectedRangeLast()||!Te(sa,this)||(Te(hs,this).indexOf(e.row)>-1?ve(this.hot.rootElement,Ip):X(this.hot.rootElement,Ip),r.row=!0,r.column=!0,r.cell=!0,Te(Cr,this).coords=e,Te(Cr,this).TD=n)}function Pue(){const t=Te(Cr,this).row,e=Te(hs,this).length;if(vl(sa,this,!1),ve(this.hot.rootElement,[uE,Ip,cE]),this.hot.selection.isSelectedByRowHeader()&&X(this.hot.rootElement,cE),e<1||t===void 0)return;const n=Te(hs,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Te(hs,this),t);if(Te(hs,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Oue(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Te(Xn,this).setPosition(null,r),Te(Xn,this).setSize(t.hider.offsetWidth-r)}function xue(){this.moveBySettingsOrLoad()}function Aue(t,e){XV(t,e),e.add(t)}function On(t,e,n){XV(t,e),e.set(t,n)}function XV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dt(t,e,n){return t.set(is(t,e),n),n}function re(t,e){return t.get(is(t,e))}function is(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Pp="manualRowResize",Hue=30,RN="manualRowHeights";var po=new WeakMap,Yg=new WeakMap,kr=new WeakMap,Cd=new WeakMap,Qs=new WeakMap,tM=new WeakMap,ac=new WeakMap,Gg=new WeakMap,Yn=new WeakMap,fo=new WeakMap,kl=new WeakMap,Op=new WeakMap,yd=new WeakMap,bd=new WeakMap,Hi=new WeakMap,Sd=new WeakMap,Vs=new WeakSet;class Nue extends Je{static get PLUGIN_KEY(){return Pp}static get PLUGIN_PRIORITY(){return Hue}constructor(e){super(e),Aue(this,Vs),On(this,po,null),On(this,Yg,null),On(this,kr,[]),On(this,Cd,null),On(this,Qs,null),On(this,tM,null),On(this,ac,null),On(this,Gg,null),On(this,Yn,this.hot.rootDocument.createElement("DIV")),On(this,fo,this.hot.rootDocument.createElement("DIV")),On(this,kl,!1),On(this,Op,!1),On(this,yd,0),On(this,bd,null),On(this,Hi,void 0),On(this,Sd,void 0),X(re(Yn,this),"manualRowResizer"),X(re(fo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Pp]}enablePlugin(){this.enabled||(Dt(Hi,this,new Ca),re(Hi,this).addLocalHook("init",()=>is(Vs,this,Wue).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,re(Hi,this)),this.addHook("modifyRowHeight",(e,n)=>is(Vs,this,Vue).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Dt(Sd,this,re(Hi,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",RN,re(Hi,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",RN,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return re(Hi,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return re(Cd,this)}setupHandlePosition(e){Dt(po,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(re(po,this)),o=i.row;if(o<0)return;const s=qt(re(po,this)),a=re(po,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(re(po,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(re(po,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(re(po,this),i.row,i.col)),Dt(Yg,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Dt(kr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();H(d,f=>{const g=f.getTopStartCorner().row,w=f.getBottomStartCorner().row;de(g,w,C=>{re(kr,this).includes(C)||re(kr,this).push(C)})})}re(kr,this).includes(re(Yg,this))||Dt(kr,this,[re(Yg,this)]),Dt(Gg,this,c.top-6),Dt(ac,this,parseInt(a.height,10)),re(Yn,this).style.top=`${re(Gg,this)+re(ac,this)}px`,re(Yn,this).style[this.inlineDir]=`${c.start}px`,re(Yn,this).style.width=`${s}px`,this.hot.rootElement.appendChild(re(Yn,this))}refreshHandlePosition(){re(Yn,this).style.top=`${re(Gg,this)+re(Cd,this)}px`}setupGuidePosition(){const e=parseInt(qt(re(Yn,this)),10),n=parseInt(re(Yn,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();X(re(Yn,this),"active"),X(re(fo,this),"active"),re(fo,this).style.top=re(Yn,this).style.top,re(fo,this).style[this.inlineDir]=`${n}px`,re(fo,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(re(fo,this))}refreshGuidePosition(){re(fo,this).style.top=re(Yn,this).style.top}hideHandleAndGuide(){ve(re(Yn,this),"active"),ve(re(fo,this),"active")}checkIfRowHeader(e){const n=Il(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&re(Qs,this)<n?n:re(Qs,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Dt(Qs,this,o),this.setManualSize(r,re(Qs,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};re(yd,this)>=2&&(re(kr,this).length>1?(H(re(kr,this),i=>{n(i)}),e()):H(re(kr,this),i=>{n(i,!0)})),Dt(yd,this,0),Dt(bd,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>is(Vs,this,Due).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>is(Vs,this,kue).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>is(Vs,this,Lue).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>is(Vs,this,$ue).call(this)),this.eventManager.addEventListener(re(Yn,this),"contextmenu",()=>is(Vs,this,Fue).call(this))}destroy(){super.destroy()}}function Due(t){if(!DL(t.target)&&re(Op,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(re(kl,this)||this.setupHandlePosition(e))}}function kue(t){be(t.target,"manualRowResizer")&&(this.setupHandlePosition(re(po,this)),this.setupGuidePosition(),Dt(kl,this,!0),re(bd,this)===null&&(Dt(bd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(re(bd,this))),Dt(yd,this,re(yd,this)+1),Dt(tM,this,t.pageY),Dt(Qs,this,re(ac,this)))}function Lue(t){re(kl,this)&&(Dt(Cd,this,re(ac,this)+(t.pageY-re(tM,this))),H(re(kr,this),e=>{Dt(Qs,this,this.setManualSize(e,re(Cd,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function $ue(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};re(kl,this)&&(this.hideHandleAndGuide(),Dt(kl,this,!1),re(Qs,this)!==re(ac,this)&&(re(kr,this).length>1?(H(re(kr,this),r=>{e(r)}),t()):H(re(kr,this),r=>{e(r,!0)})),this.setupHandlePosition(re(po,this)))}function Fue(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(re(Yn,this)),this.hot.rootElement.removeChild(re(fo,this)),Dt(kl,this,!1),Dt(Op,this,!0),this.hot._registerImmediate(()=>{Dt(Op,this,!1)})}function Vue(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=re(Hi,this).getValueAtIndex(r);this.hot.getSettings()[Pp]&&i&&(n=i)}return n}function Wue(){const t=this.hot.getSettings()[Pp],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{re(Hi,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{re(Hi,this).setValueAtIndex(r,n)}),Dt(Sd,this,t)):t===!0&&Array.isArray(re(Sd,this))&&re(Sd,this).forEach((n,r)=>{re(Hi,this).setValueAtIndex(r,n)})},!0)}var EN={},TN;function Bue(){if(TN)return EN;TN=1;var t=mw();return t("flatMap"),EN}Bue();var _N={},MN={},FS,IN;function jue(){if(IN)return FS;IN=1;var t=ln(),e=cn(),n=Oo(),r=$E();return FS=function(i,o){(!o||typeof i!="string")&&e(i);var s=r(i);return n(e(s!==void 0?t(s,i):i))},FS}var PN;function Uue(){if(PN)return MN;PN=1;var t=pt(),e=ln(),n=Sr(),r=cn(),i=Oo(),o=jue(),s=WE(),a=Rr(),l=ga(),u=BE(),c=pa(),h=!l&&!u("flatMap",function(){}),d=!l&&!h&&c("flatMap",TypeError),f=l||h||d,g=s(function(){for(var w=this.iterator,C=this.mapper,S,v;;){if(v=this.inner)try{if(S=r(e(v.next,v.iterator)),!S.done)return S.value;this.inner=null}catch(E){a(w,"throw",E)}if(S=r(e(this.next,w)),this.done=!!S.done)return;try{this.inner=o(C(S.value,this.counter++),!1)}catch(E){a(w,"throw",E)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(C){r(this);try{n(C)}catch(S){a(this,"throw",S)}return d?e(d,this,C):new g(i(this),{mapper:C,inner:null})}}),MN}var ON;function zue(){return ON||(ON=1,Uue()),_N}zue();function Yue(t,e,n){Gue(t,e),e.set(t,n)}function Gue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qa(t,e,n){return(e=que(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function que(t){var e=Kue(t,"string");return typeof e=="symbol"?e:e+""}function Kue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xN(t,e){return t.get(ZV(t,e))}function qg(t,e,n){return t.set(ZV(t,e),n),n}function ZV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var el=new WeakMap;class wo{constructor(e,n,r,i,o,s){Qa(this,"row",void 0),Qa(this,"col",void 0),Qa(this,"rowspan",void 0),Qa(this,"colspan",void 0),Qa(this,"removed",!1),Qa(this,"cellCoordsFactory",void 0),Qa(this,"cellRangeFactory",void 0),Yue(this,el,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return it`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),qg(el,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,qg(el,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return qg(el,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return xN(el,this)||qg(el,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),xN(el,this)}}function Xue(t,e){Zue(t,e),e.add(t)}function Zue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kg(t,e,n){return(e=Jue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jue(t){var e=Que(t,"string");return typeof e=="symbol"?e:e+""}function Que(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ws=new WeakSet;class xp{constructor(e){Xue(this,Ws),Kg(this,"plugin",void 0),Kg(this,"mergedCells",[]),Kg(this,"mergedCellsMatrix",new Map),Kg(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){Ze(xp.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new wo(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),tl(Ws,this,AN).call(this,a),a):(u&&Ze(xp.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),tl(Ws,this,ece).call(this,r),r):!1}clear(){H(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;de(n,n+i,s=>{de(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=ze(u,i,i+s-1),d=ze(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=tl(Ws,this,Xg).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=tl(Ws,this,Xg).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=tl(Ws,this,Xg).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=tl(Ws,this,Xg).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{tl(Ws,this,AN).call(this,s)})}}function Xg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function AN(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function ece(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function VS(t,e,n){return(e=tce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tce(t){var e=nce(t,"string");return typeof e=="symbol"?e:e+""}function nce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rce{constructor(e){VS(this,"plugin",void 0),VS(this,"mergedCellsCollection",void 0),VS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,w=this.getFarthestCollection(e,n,r,i);if(w){if(r==="down"){const C=w.row+w.rowspan-a-g;o[2]+C>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?C:0}else if(r==="right"){const C=w.col+w.colspan-l-g;o[3]+C>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?C:0}else if(r==="up"){const C=u-g-w.row+1;o[0]+C<0?o[0]+=g:o[0]-=g?C:0}else if(r==="left"){const C=c-g-w.col+1;o[1]+C<0?o[1]+=g:o[1]-=g?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),sn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,w=d-g;let C=null,S=null,v=null;switch(r){case"up":C="includesVertically",v=c-w+1;break;case"left":C="includesHorizontally",v=c-w+1;break;case"down":C="includesVertically",v=h+w-1;break;case"right":C="includesHorizontally",v=h+w-1;break}return H(i,E=>{E[C](v)&&E.isFarther(S,r)&&(S=E)}),S}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return H(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:w}=g;return w===h.getWidth()}):!f.every(g=>{let{rowspan:w}=g;return w===h.getHeight()})}}function WS(t,e,n){return(e=ice(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ice(t){var e=oce(t,"string");return typeof e=="symbol"?e:e+""}function oce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sce{constructor(e){WS(this,"plugin",void 0),WS(this,"hot",void 0),WS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function ace(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(hT)}return this.getTranslatedPhrase(cT)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?wo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Rd(t,e,n){return(e=lce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lce(t){var e=uce(t,"string");return typeof e=="symbol"?e:e+""}function uce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HN{constructor(e){Rd(this,"data",void 0),Rd(this,"next",null),Rd(this,"prev",null),this.data=e}}class Zg{constructor(){Rd(this,"first",null),Rd(this,"last",null)}push(e){const n=new HN(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new HN(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function cce(t,e){JV(t,e),e.add(t)}function nl(t,e,n){JV(t,e),e.set(t,n)}function JV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(t,e){return t.get(Ap(t,e))}function Mr(t,e,n){return t.set(Ap(t,e),n),n}function Ap(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oo=new WeakMap,so=new WeakMap,ao=new WeakMap,lo=new WeakMap,hE=new WeakMap,Jg=new WeakMap,Qg=new WeakMap,BS=new WeakSet;class hce{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;cce(this,BS),nl(this,oo,new Zg),nl(this,so,new Zg),nl(this,ao,null),nl(this,lo,null),nl(this,hE,null),nl(this,Jg,null),nl(this,Qg,null),Mr(hE,this,n),Mr(Jg,this,r),Mr(Qg,this,i)}getCurrentVerticalNode(){return rt(lo,this).data}getFirstVerticalNode(){return rt(so,this).first.data}getNextVerticalNode(){return rt(lo,this).next.data}getPrevVerticalNode(){return rt(lo,this).prev.data}getCurrentHorizontalNode(){return rt(ao,this).data}getFirstHorizontalNode(){return rt(oo,this).first.data}getNextHorizontalNode(){return rt(ao,this).next.data}getPrevHorizontalNode(){return rt(ao,this).prev.data}setPrevNodeAsActive(){Mr(lo,this,rt(lo,this).prev),Mr(ao,this,rt(ao,this).prev)}setNextNodeAsActive(){Mr(lo,this,rt(lo,this).next),Mr(ao,this,rt(ao,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Mr(oo,this,new Zg);for(let s=n.row;s<=r.row;s++)if(!rt(Jg,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(rt(Qg,this).isHidden(a))continue;const l=Ap(BS,this,NN).call(this,e,rt(oo,this),i,s,a);l&&Mr(ao,this,l)}rt(oo,this).first&&(rt(oo,this).first.prev=rt(oo,this).last,rt(oo,this).last.next=rt(oo,this).first);const o=new WeakSet;Mr(so,this,new Zg);for(let s=n.col;s<=r.col;s++)if(!rt(Qg,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(rt(Jg,this).isHidden(a))continue;const l=Ap(BS,this,NN).call(this,e,rt(so,this),o,a,s);l&&Mr(lo,this,l)}rt(so,this).first&&(rt(so,this).first.prev=rt(so,this).last,rt(so,this).last.next=rt(so,this).first)}setActiveNode(e,n){return rt(oo,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Mr(ao,this,r),!1}),rt(so,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Mr(lo,this,r),!1}),this}}function NN(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=rt(hE,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function QV(t,e,n){const{rowIndexMapper:r,stylesHandler:i}=t,o=i.getDefaultRowHeight();let s=0;for(let l=e;l<e+n;l++)if(!r.isHidden(l)){var a;s+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:o,l===0&&!i.isClassicTheme()&&(s+=1)}return s}function dce(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!Ne(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),Ad()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[w,C]=t.translateMergedCellToRenderable(h,g,d,f),S=t.getSetting("virtualized");if(Ad()&&d===0&&!e.getSettings().rowHeaders){const O=QV(e,h,g);i.set(l,O/g)}const v=n.getRenderableFromVisualIndex(l),E=r.getRenderableFromVisualIndex(u),P=w-v+1,x=C-E+1;let _=n.getNearestNotHiddenIndex(h,1),M=r.getNearestNotHiddenIndex(d,1);if(S){const O=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(O)||(_=Math.max(_,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(O)||(M=Math.max(M,e.getFirstRenderedVisibleColumn()))}const V=Math.min(g,P),z=Math.min(f,x);_===l&&M===u?(a.setAttribute("rowspan",V),a.setAttribute("colspan",z)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function fce(t,e){eW(t,e),e.add(t)}function em(t,e,n){eW(t,e),e.set(t,n)}function eW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jS(t,e,n){return(e=gce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gce(t){var e=mce(t,"string");return typeof e=="symbol"?e:e+""}function mce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yd(t,e,n){return t.set(st(t,e),n),n}function mt(t,e){return t.get(st(t,e))}function st(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeMergeCells");ie.getSingleton().register("afterMergeCells");ie.getSingleton().register("beforeUnmergeCells");ie.getSingleton().register("afterUnmergeCells");const dE="mergeCells",pce=150,DN=dE;var ii=new WeakMap,oi=new WeakMap,Ro=new WeakMap,kN=new WeakMap,ht=new WeakSet;class wce extends Je{constructor(){super(...arguments),fce(this,ht),jS(this,"mergedCellsCollection",null),jS(this,"autofillCalculations",null),jS(this,"selectionCalculations",null),em(this,ii,null),em(this,oi,{row:0,col:0}),em(this,Ro,new hce({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),em(this,kN,dce(this))}static get PLUGIN_KEY(){return dE}static get PLUGIN_PRIORITY(){return pce}static get DEFAULT_SETTINGS(){return{[CF]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[dE]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new xp(this),this.autofillCalculations=new rce(this),this.selectionCalculations=new sce(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,vce).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,yce).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,bce).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Sce).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Rce).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,$N).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,$N).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Tce).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,_ce).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Mce).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,LN).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,LN).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Cce).call(e,...r)}),this.addHook("afterRenderer",function(){return mt(kN,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Ece).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Ice).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Pce).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Oce).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,xce).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Ace).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Hce).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Nce).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Dce).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,kce).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Lce).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,$ce).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Fce).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Vce).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(ht,e,Wce).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!bL())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>o?.name==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Qm(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Qm(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?wo.containsNegativeValues(e)?(Ze(wo.NEGATIVE_VALUES_WARNING(e)),!1):wo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ze(wo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):wo.isSingleCell(e)?(Ze(wo.IS_SINGLE_CELL(e)),!1):wo.containsZeroSpan(e)?(Ze(wo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),de(0,s.rowspan-1,c=>{de(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),H(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),de(0,i.rowspan-1,o=>{de(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:DN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(DN)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ne(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ne(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ne(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ne(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function vce(){this.generateFromSettings(),this.hot.render()}function Cce(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function yce(t){mt(oi,this).row=t.row,mt(oi,this).col=t.col}function bce(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;mt(ii,this)&&(i.getRenderableFromVisualIndex(mt(ii,this).row)!==null&&(n.row=mt(ii,this).row),r.getRenderableFromVisualIndex(mt(ii,this).col)!==null&&(n.col=mt(ii,this).col),Yd(ii,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Sce(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Rce(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Yd(ii,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Yd(ii,this,e.clone()),n&&e.assign(n)}function LN(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),w=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[ze(g,u,h),ze(w,c,d),ze(this.hot.getLastRenderedVisibleRow(),u,h),ze(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Ece(t){t.items.push({name:"---------"},ace(this))}function $N(){Yd(ii,this,null)}function Tce(){if(mt(ii,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=mt(ii,this).clone().normalize();mt(Ro,this).setActiveNode(r.row,r.col),mt(oi,this).row>0||mt(oi,this).col>0?mt(Ro,this).setPrevNodeAsActive():(n==="E-W"&&mt(oi,this).col<0||e==="S-N"&&mt(oi,this).row<0)&&mt(Ro,this).setNextNodeAsActive()}function _ce(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(mt(oi,this).col<0){const{rowEnd:a,colEnd:l}=mt(Ro,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(mt(oi,this).col>0){const{rowStart:a,colStart:l}=mt(Ro,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(mt(oi,this).row<0){const{rowEnd:a,colEnd:l}=mt(Ro,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(mt(oi,this).row>0){const{rowStart:a,colStart:l}=mt(Ro,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}mt(Ro,this).setActiveNode(t,e),Yd(oi,this,{row:0,col:0})}function Mce(){this.hot.getSelectedRangeLast().isHeader()||mt(Ro,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Ice(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Pce(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Oce(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function xce(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function Ace(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Hce(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Nce(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Dce(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function kce(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Lce(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);H(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function $ce(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Fce(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Vce(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function Wce(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,QV(this.hot,e,g))}),t}function Bce(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:OF(u.type))(l,u,d)(c,h);if(g===_o){const w=a+1;if(typeof e[w]<"u")return s(w)}return g}(0)}}const tW="sort";function jce(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${tW}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Uce(t){const e=t.className.split(" "),n=new RegExp(`^${tW}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function zce(t,e,n){return(e=Yce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yce(t){var e=Gce(t,"string");return typeof e=="symbol"?e:e+""}function Gce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Hp="multiColumnSorting",qce=170,FN=Hp;PF(Hp,Bce);class Kce extends FF{constructor(){super(...arguments),zce(this,"pluginKey",Hp)}static get PLUGIN_KEY(){return Hp}static get PLUGIN_PRIORITY(){return qce}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,gp)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:ya,position:"before",group:FN})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FN)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),ve(e,Uce(e)),this.enabled!==!1&&X(e,jce(...r))}onAfterOnCellMouseDown(e,n){W_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,gp))):this.sort(this.getColumnNextConfig(n.col)))}}function VN(t,e,n){return(e=Xce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xce(t){var e=Zce(t,"string");return typeof e=="symbol"?e:e+""}function Zce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Jce="multipleSelectionHandles",Qce=160;class ehe extends Je{constructor(){super(...arguments),VN(this,"dragged",[]),VN(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Jce}static get PLUGIN_PRIORITY(){return Qce}isEnabled(){return Eo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(be(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(be(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(be(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(be(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function fE(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function nW(){return{label:"",isPlaceholder:!0}}function the(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;H(t,i=>{const o=[];let s=0;n.push(o),H(i,a=>{const l=fE();if(Ne(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Ot(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Ot(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(nW());return!u})});const r=Math.max(...je(n,i=>i.length));return H(n,i=>{if(i.length<r){const o=je(new Array(r-i.length),()=>fE());i.splice(i.length,0,...o)}}),n}function US(t,e,n){nhe(t,e),e.set(t,n)}function nhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ri(t,e){return t.get(rW(t,e))}function Fh(t,e,n){return t.set(rW(t,e),n),n}function rW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const WN=["label","collapsible"];var qo=new WeakMap,rl=new WeakMap,zS=new WeakMap;class rhe{constructor(){US(this,qo,[]),US(this,rl,0),US(this,zS,1/0)}setColumnsLimit(e){Fh(zS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Fh(qo,this,the(e,Ri(zS,this))),Fh(rl,this,Ri(qo,this).length)}getData(){return Ri(qo,this)}mergeWith(e){H(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&sn(s,o,WN)})}map(e){H(Ri(qo,this),n=>{H(n,r=>{const i=e({...r});Ne(i)&&sn(r,i,WN)})})}getHeaderSettings(e,n){var r;if(e>=Ri(rl,this)||e<0)return null;const i=Ri(qo,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Ri(rl,this)||e<0)return i;const o=Ri(qo,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Ri(rl,this)}getColumnsCount(){return Ri(rl,this)>0?Ri(qo,this)[0].length:0}clear(){Fh(qo,this,[]),Fh(rl,this,0)}}function YS(t,e,n){return(e=ihe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ihe(t){var e=ohe(t,"string");return typeof e=="symbol"?e:e+""}function ohe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const iW="DF-pre-order";function oW(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=oW.call(this.childs[r],t,e)}return n}const she="DF-post-order";function sW(t,e){for(let n=0;n<this.childs.length;n++)if(sW.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const aW="BF";function ahe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const lhe=aW,BN=new Map([[iW,oW],[she,sW],[aW,ahe]]);class Np{constructor(e){YS(this,"data",{}),YS(this,"parent",null),YS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Np({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lhe;if(!BN.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);BN.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function GS(t,e,n){uhe(t,e),e.set(t,n)}function uhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zn(t,e){return t.get(lW(t,e))}function che(t,e,n){return t.set(lW(t,e),n),n}function lW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xu=new WeakMap,il=new WeakMap,Au=new WeakMap;class hhe{constructor(e){GS(this,xu,new Map),GS(this,il,new Map),GS(this,Au,null),che(Au,this,e)}getRoots(){return Array.from(zn(xu,this).values())}getRootByColumn(e){let n;return zn(il,this).has(e)&&(n=zn(xu,this).get(zn(il,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-zn(il,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;zn(il,this).clear(),H(zn(xu,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)zn(il,this).set(i,e);e+=r})}buildTree(){this.clear();const e=zn(Au,this).getColumnsCount();let n=0;for(;n<e;){const r=zn(Au,this).getHeaderSettings(0,n),i=new Np;zn(xu,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=zn(Au,this).getHeadersSettings(r,n,i);r+=1,H(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new Np(a),e.addChild(l)),r<zn(Au,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){zn(xu,this).clear(),zn(il,this).clear()}}function uW(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Dp(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function kp(t){return Dp(t,"origColspan")===t.data.origColspan}function nM(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(kp(t))return nM(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)H(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,uW(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):kp(a)&&(l.isCollapsed=Dp(a,"isCollapsed"))}),{rollbackModification:()=>rM(t),affectedColumns:Array.from(o),colspanCompensation:s}}function rM(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(kp(t))return rM(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)H(o,l=>{uW(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=Dp(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):kp(l)&&(u.isCollapsed=Dp(l,"isCollapsed"))}),{rollbackModification:()=>nM(t),affectedColumns:Array.from(s),colspanCompensation:a}}function dhe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(it`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function fhe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(it`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const jN=new Map([["collapse",rM],["expand",nM],["hide-column",dhe],["show-column",fhe]]);function ghe(t,e,n){if(!jN.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return jN.get(t)(e,n)}function tm(t){const e=[];return H(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=phe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(nW());else{const f=mhe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function mhe(t){const{crossHiddenColumns:e,...n}=fE(t);return n}function phe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function qS(t,e,n){whe(t,e),e.set(t,n)}function whe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vh(t,e,n){return t.set(cW(t,e),n),n}function At(t,e){return t.get(cW(t,e))}function cW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uo=new WeakMap,ur=new WeakMap,ol=new WeakMap;class vhe{constructor(){qS(this,uo,new rhe),qS(this,ur,new hhe(At(uo,this))),qS(this,ol,[[]])}setState(e){At(uo,this).setData(e);let n=!1;try{At(ur,this).buildTree()}catch{At(ur,this).clear(),At(uo,this).clear(),n=!0}return Vh(ol,this,tm(At(ur,this).getRoots())),n}setColumnsLimit(e){At(uo,this).setColumnsLimit(e)}mergeStateWith(e){const n=je(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});At(uo,this).mergeWith(n),At(ur,this).buildTree(),Vh(ol,this,tm(At(ur,this).getRoots()))}mapState(e){At(uo,this).map(e),At(ur,this).buildTree(),Vh(ol,this,tm(At(ur,this).getRoots()))}mapNodes(e){return Er(At(ur,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=At(ur,this).getNode(n,r);let o;return i&&(o=ghe(e,i,r),Vh(ol,this,tm(At(ur,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=At(ol,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=At(ur,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=At(ur,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},iW)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return At(uo,this).getLayersCount()}getColumnsCount(){return At(uo,this).getColumnsCount()}clear(){Vh(ol,this,[]),At(uo,this).clear(),At(ur,this).clear()}}function Wh(t,e,n){return(e=Che(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Che(t){var e=yhe(t,"string");return typeof e=="symbol"?e:e+""}function yhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bhe{constructor(e,n){Wh(this,"hot",void 0),Wh(this,"nestedHeaderSettingsGetter",void 0),Wh(this,"layersCount",0),Wh(this,"container",void 0),Wh(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),Ac(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function She(t,e){hW(t,e),e.add(t)}function UN(t,e,n){return(e=Rhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rhe(t){var e=Ehe(t,"string");return typeof e=="symbol"?e:e+""}function Ehe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bh(t,e,n){hW(t,e),e.set(t,n)}function hW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ds(t,e,n){return t.set(Ht(t,e),n),n}function $e(t,e){return t.get(Ht(t,e))}function Ht(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zN="nestedHeaders",The=280;var lt=new WeakMap,Bs=new WeakMap,Ed=new WeakMap,Uw=new WeakMap,Lp=new WeakMap,Ft=new WeakSet;class _he extends Je{constructor(){super(...arguments),She(this,Ft),Bh(this,lt,new vhe),Bh(this,Bs,null),Bh(this,Ed,null),Bh(this,Uw,!1),Bh(this,Lp,null),UN(this,"ghostTable",new bhe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),UN(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return zN}static get PLUGIN_PRIORITY(){return The}isEnabled(){return!!this.hot.getSettings()[zN]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Ze(it`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Ht(Ft,this,Bhe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,jhe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Ohe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,xhe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Ahe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Hhe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Nhe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Dhe).call(e,...i)}),this.addHook("afterSelection",()=>Ht(Ft,this,nm).call(this)),this.addHook("afterSelectionFocusSet",()=>Ht(Ft,this,nm).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Mhe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Ht(Ft,this,Lhe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Fhe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Vhe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Ihe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Phe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,khe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,$he).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Whe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Ht(Ft,this,nm).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Ht(Ft,this,nm).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();$e(lt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=$e(lt,this).setState(e)),this.detectedOverlappedHeaders&&Ze(it`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";$e(lt,this).triggerColumnModification(i,r)}),!$e(Bs,this)&&this.enabled&&ds(Bs,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";$e(lt,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),$e(lt,this).clear(),$e(Bs,this).unsubscribe(),ds(Bs,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return $e(lt,this)}getLayersCount(){return $e(lt,this).getLayersCount()}getHeaderSettings(e,n){return $e(lt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),ve(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),ve(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),ve(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),ve(o,"hiddenHeader"),ve(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=$e(lt,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)X(o,"hiddenHeader");else if(c>1){var g,w,C;const{wtOverlays:S}=l._wt,v=(g=S.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),E=(w=S.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o);((C=S.topOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o))&&u<r&&X(o,"hiddenHeaderText");const x=v||E?Math.min(c,r-i):c;x>1&&o.setAttribute("colspan",x)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const S=o.querySelector("div.relative");S&&f&&f.length>0&&(ve(S,this.hot.getColumnMeta(u).headerClassName),X(S,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=$e(lt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){ds(lt,this,null),$e(Bs,this)!==null&&($e(Bs,this).unsubscribe(),ds(Bs,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return $e(lt,this).getHeaderTreeNodeData(e.row,e.col)}}function nm(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=$e(lt,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Mhe(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=$e(Lp,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(ds(Lp,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=$e(lt,this).findLeftMostColumnIndex(a,l),g=$e(lt,this).findRightMostColumnIndex(a,l),w=g-f+1;if(f<c&&g>h)return f;if(s){let C=null;return f>=c&&g>h?w>d?(e.value="start",C=f):(e.value="end",C=g):f<c&&g<=h&&(w>d?(e.value="end",C=g):(e.value="start",C=f)),C}return f<=c?f:g}function Ihe(t,e,n){const r=$e(lt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=$e(lt,this).getHeaderSettings(e,t);if(o===x0){if(!a)return r.columnIndex}else if(o===u$&&(l>s-i||!a))return null;return t}function Phe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,w=d-a;if(w===0)continue;((i=$e(lt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][w]="")}}}function Ohe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function xhe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;ds(Ed,this,e.clone()),ds(Uw,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(y0(t)||Ol(t)&&l||x3(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Ahe(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=ze(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function Hhe(){ds(Uw,this,!1)}function Nhe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!$e(Uw,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=$e(lt,this).getHeaderTreeNodeData($e(Ed,this).row,$e(Ed,this).col);if(e.setHighlight($e(Ed,this)),o>e.getWidth()||i<n||i+o-1>r){const s=$e(lt,this).findTopMostEntireHeaderLevel(ze(n,i,i+o-1),ze(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Dhe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=$e(lt,this).findLeftMostColumnIndex(n.row,n.col),o=$e(lt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function khe(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});ds(Lp,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function Lhe(t){if($e(lt,this).getLayersCount()>0){t.length=0;for(let e=0;e<$e(lt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function $he(t){const e=$e(lt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=$e(lt,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Zn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?$e(lt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function Fhe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Vhe(t,e,n){var r;const{label:i}=(r=$e(lt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Whe(t,e){if(t<0)return this.hot.getCell(t,$e(lt,this).findLeftMostColumnIndex(t,e),!0)}function Bhe(){this.updatePlugin()}function jhe(t,e){e||this.updatePlugin()}function jh(t,e,n){return(e=Uhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uhe(t){var e=zhe(t,"string");return typeof e=="symbol"?e:e+""}function zhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yhe{constructor(e,n){jh(this,"hot",void 0),jh(this,"data",null),jh(this,"plugin",void 0),jh(this,"parentReference",new WeakMap),jh(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},de(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&H(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&H(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return De(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(H(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(de(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),de(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];H(r,o=>{i.push(this.getDataObject(o))}),H(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function YN(t,e,n){return(e=Ghe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ghe(t){var e=qhe(t,"string");return typeof e=="symbol"?e:e+""}function qhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iM{constructor(e,n){YN(this,"hot",void 0),YN(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Co extends iM{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(H(l,c=>{c&&s.removeChild(c)}),X(n,Co.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",de(0,i-1,()=>{const d=c.createElement("SPAN");X(d,Co.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&ye(c,[zl()]),X(n,Co.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(X(c,`${Co.CSS_CLASSES.button} ${Co.CSS_CLASSES.expandButton}`),u&&ye(n,[ai(!1)])):(X(c,`${Co.CSS_CLASSES.button} ${Co.CSS_CLASSES.collapseButton}`),u&&ye(n,[ai(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let r=11;this.hot.stylesHandler.isClassicTheme()||(r=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}class Khe extends iM{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),H(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{de(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&H(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];H(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return H(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);H(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return H(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);H(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&H(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];H(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];H(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];H(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{H(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{H(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&H(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);be(e.target,Co.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),zi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Xhe(t,e,n){Zhe(t,e),e.set(t,n)}function Zhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jhe(t,e,n){return(e=Qhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qhe(t){var e=ede(t,"string");return typeof e=="symbol"?e:e+""}function ede(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tde(t,e){return t.get(nde(t,e))}function nde(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var GN=new WeakMap;class rde extends iM{constructor(){super(...arguments),Jhe(this,"dataManager",this.plugin.dataManager),Xhe(this,GN,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(OT)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(xT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return de(0,e.items.length-1,r=>{if(r===0)return H(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return de(0,e.items.length-1,n=>{const r=tde(GN,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function rm(t,e,n){return(e=ide(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ide(t){var e=ode(t,"string");return typeof e=="symbol"?e:e+""}function ode(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sde{constructor(e){rm(this,"plugin",void 0),rm(this,"hot",void 0),rm(this,"dataManager",void 0),rm(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const w=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(w,a),w}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Pt(i)&&(Ze(it`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function ade(t,e){dW(t,e),e.add(t)}function qN(t,e,n){dW(t,e),e.set(t,n)}function dW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KS(t,e,n){return(e=lde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lde(t){var e=ude(t,"string");return typeof e=="symbol"?e:e+""}function ude(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function km(t,e){return t.get(mn(t,e))}function $p(t,e,n){return t.set(mn(t,e),n),n}function mn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fp="nestedRows",cde=300,KN=Fp,hde="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var zw=new WeakMap,Hu=new WeakMap,yn=new WeakSet;class dde extends Je{constructor(){super(...arguments),ade(this,yn),KS(this,"dataManager",null),KS(this,"headersUI",null),KS(this,"collapsedRowsMap",null),qN(this,zw,!1),qN(this,Hu,!1)}static get PLUGIN_KEY(){return Fp}static get PLUGIN_PRIORITY(){return cde}isEnabled(){return!!this.hot.getSettings()[Fp]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new gf),this.dataManager=new Yhe(this,this.hot),this.collapsingUI=new Khe(this,this.hot),this.headersUI=new Co(this,this.hot),this.contextMenuUI=new rde(this,this.hot),this.rowMoveController=new sde(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,_de).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,Mde).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,mde).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,pde).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,wde).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,gde).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,yde).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,Cde).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,bde).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,Sde).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,Rde).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,Ede).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,vde).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,Tde).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(yn,e,fde).call(e,...r)}),this.addHook("beforeLoadData",n=>mn(yn,this,XN).call(this,n)),this.addHook("beforeUpdateData",n=>mn(yn,this,XN).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:KN,relativeToGroup:ya,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(KN)}disableCoreAPIModifiers(){$p(Hu,this,!0)}enableCoreAPIModifiers(){$p(Hu,this,!1)}onModifyRowData(e){if(!km(Hu,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!km(Hu,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return km(Hu,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function fde(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function gde(t,e,n){this.collapsingUI.toggleState(t,e,n)}function mde(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),$p(zw,this,!0),this.dataManager.getData().slice()}function pde(t){return this.contextMenuUI.appendOptions(t)}function wde(t,e){this.headersUI.appendLevelIndicators(t,e)}function vde(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Cde(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{$p(zw,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function yde(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function bde(){this.collapsingUI.collapsedRowsStash.stash()}function Sde(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Rde(){this.collapsingUI.collapsedRowsStash.stash()}function Ede(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Tde(){this.dataManager.rewriteCache()}function _de(){this.headersUI.updateRowHeaderWidth()}function Mde(t,e){km(zw,this)&&(e.skipRender=!0)}function XN(t){if(!F9(t)){b0(hde),this.hot.getSettings()[Fp]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function XS(t,e,n){return(e=Ide(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ide(t){var e=Pde(t,"string");return typeof e=="symbol"?e:e+""}function Pde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ode{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;XS(this,"rootWindow",void 0),XS(this,"prefix",void 0),XS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){H(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function xde(t,e,n){return(e=Ade(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ade(t){var e=Hde(t,"string");return typeof e=="symbol"?e:e+""}function Hde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ie.getSingleton().register("persistentStateSave");ie.getSingleton().register("persistentStateLoad");ie.getSingleton().register("persistentStateReset");const ZN="persistentState",Nde=0;class Dde extends Je{constructor(){super(...arguments),xde(this,"storage",void 0)}static get PLUGIN_KEY(){return ZN}static get PLUGIN_PRIORITY(){return Nde}isEnabled(){return!!this.hot.getSettings()[ZN]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Ode(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function kde(t,e){Lde(t,e),e.add(t)}function Lde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZS(t,e,n){return(e=$de(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $de(t){var e=Fde(t,"string");return typeof e=="symbol"?e:e+""}function Fde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const JS="search",Vde=190,Wde="htSearchResult",Bde=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},jde=function(t,e,n){return Pt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Pt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var QS=new WeakSet;class Ude extends Je{constructor(){super(...arguments),kde(this,QS),ZS(this,"callback",Bde),ZS(this,"queryMethod",jde),ZS(this,"searchResultClass",Wde)}static get PLUGIN_KEY(){return JS}static get PLUGIN_PRIORITY(){return Vde}isEnabled(){return this.hot.getSettings()[JS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[JS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return JN(QS,e,QN).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return JN(QS,e,QN).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return de(0,i-1,l=>{de(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const w={row:l,col:u,data:c};s.push(w)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ne(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function QN(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function im(t,e,n){return(e=zde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zde(t){var e=Yde(t,"string");return typeof e=="symbol"?e:e+""}function Yde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fW{constructor(e){im(this,"viewportWidth",void 0),im(this,"overwriteColumnWidthFn",void 0),im(this,"baseWidths",new Map),im(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Gde extends fW{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=mc?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=mc){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,w=g;o.includes(f)||(w=Math.round(g*l)),this.stretchedWidths.set(f,w),u=f,d<i.length-1&&(c+=w)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function eD(t,e,n){qde(t,e),e.set(t,n)}function qde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eR(t,e){return t.get(gW(t,e))}function om(t,e,n){return t.set(gW(t,e),n),n}function gW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sm=new WeakMap,Uh=new WeakMap;class Kde extends fW{constructor(){super(...arguments),eD(this,sm,0),eD(this,Uh,-1)}prepare(e){super.prepare(e),om(sm,this,0),om(Uh,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),om(Uh,this,e),om(sm,this,n)}calculate(){if(eR(Uh,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+eR(sm,this),0);this.stretchedWidths.set(eR(Uh,this),n)}}function Xde(t,e){mW(t,e),e.add(t)}function am(t,e,n){mW(t,e),e.set(t,n)}function mW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e){return t.get(Ju(t,e))}function tR(t,e,n){return t.set(Ju(t,e),n),n}function Ju(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zde="stretchColumns";var Hn=new WeakMap,Nu=new WeakMap,nR=new WeakMap,lm=new WeakMap,zh=new WeakSet;class Jde{constructor(e){Xde(this,zh),am(this,Hn,void 0),am(this,Nu,void 0),am(this,nR,new Map([["all",new Gde(Ju(zh,this,tD).bind(this))],["last",new Kde(Ju(zh,this,tD).bind(this))]])),am(this,lm,"none"),tR(Hn,this,e),tR(Nu,this,Vt(Hn,this).columnIndexMapper.createAndRegisterIndexMap(Zde,"physicalIndexToValue"))}useStrategy(e){tR(lm,this,Vt(nR,this).has(e)?e:"none")}refreshStretching(){if(Vt(lm,this)==="none"){Vt(Nu,this).clear();return}Vt(Hn,this).batchExecution(()=>{Vt(Nu,this).clear();const e=Vt(nR,this).get(Vt(lm,this));let r=Vt(Hn,this).view.getViewportWidth();Ju(zh,this,Qde).call(this)&&(r-=Sn(Vt(Hn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Vt(Hn,this).countCols();i++)Vt(Hn,this).columnIndexMapper.isHidden(Vt(Hn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Ju(zh,this,efe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;Vt(Nu,this).setValueAtIndex(Vt(Hn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return Vt(Nu,this).getValueAtIndex(Vt(Hn,this).toPhysicalColumn(e))}}function Qde(){const{view:t,stylesHandler:e}=Vt(Hn,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),r=Vt(Hn,this).countRows(),i=e.getDefaultRowHeight();let o=0,s=!1;for(let l=0;l<r;l++){var a;if(o+=((a=Vt(Hn,this).getRowHeight(l))!==null&&a!==void 0?a:i)+(l===0?1:0),o>n){s=!0;break}}return s}function efe(t){var e;return(e=Vt(Hn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:mc}function tD(t,e){return Vt(Hn,this).runHooks("beforeStretchingColumnWidth",t,e)}function tfe(t,e){pW(t,e),e.add(t)}function rR(t,e,n){pW(t,e),e.set(t,n)}function pW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iR(t,e,n){return t.set(Vp(t,e),n),n}function es(t,e){return t.get(Vp(t,e))}function Vp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nfe="stretchColumns",rfe=155;var Yu=new WeakMap,um=new WeakMap,Yh=new WeakMap,oR=new WeakSet;class ife extends Je{constructor(){super(...arguments),tfe(this,oR),rR(this,Yu,new Jde(this.hot)),rR(this,um,null),rR(this,Yh,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;es(um,this)!==null&&es(um,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),iR(um,this,i.width)})})}))}static get PLUGIN_KEY(){return nfe}static get PLUGIN_PRIORITY(){return rfe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(es(Yu,this).useStrategy(this.hot.getSettings().stretchH),es(Yh,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vp(oR,e,sfe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vp(oR,e,ofe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){es(Yu,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),es(Yh,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return es(Yu,this).getStretchedWidth(e)}destroy(){es(Yh,this).disconnect(),iR(Yh,this,null),iR(Yu,this,null),super.destroy()}}function ofe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function sfe(t){t&&es(Yu,this).refreshStretching()}function afe(t,e){lfe(t,e),e.add(t)}function lfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cm(t,e,n){return(e=ufe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ufe(t){var e=cfe(t,"string");return typeof e=="symbol"?e:e+""}function cfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hfe="touchScroll",dfe=200;var hm=new WeakSet;class ffe extends Je{constructor(){super(...arguments),afe(this,hm),cm(this,"scrollbars",[]),cm(this,"clones",[]),cm(this,"lockedCollection",!1),cm(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return hfe}static get PLUGIN_PRIORITY(){return dfe}static get SETTING_KEYS(){return!0}isEnabled(){return yL()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>sR(hm,this,gfe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>sR(hm,this,mfe).call(this)),this.addHook("afterMomentumScroll",()=>sR(hm,this,pfe).call(this))}}function gfe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function mfe(){this.freezeOverlays=!0,H(this.clones,t=>{X(t,"hide-tween")})}function pfe(){this.freezeOverlays=!1,H(this.clones,t=>{ve(t,"hide-tween"),X(t,"show-tween")}),this.hot._registerTimeout(()=>{H(this.clones,t=>{ve(t,"show-tween")})},400),H(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function wfe(t,e){vfe(t,e),e.add(t)}function vfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cfe(t,e,n){return(e=yfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yfe(t){var e=bfe(t,"string");return typeof e=="symbol"?e:e+""}function bfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sfe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lm="trimRows",Rfe=330;var nD=new WeakSet;class Efe extends Je{constructor(){super(...arguments),wfe(this,nD),Cfe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Lm}static get PLUGIN_PRIORITY(){return Rfe}isEnabled(){return!!this.hot.getSettings()[Lm]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new gf),this.trimmedRowsMap.addLocalHook("init",()=>Sfe(nD,this,Tfe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Lm];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),H(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(H(e,l=>{o[l]=!1}),i=Er(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function Tfe(){const t=this.hot.getSettings()[Lm];Array.isArray(t)&&this.hot.batchExecution(()=>{H(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function _fe(t,e,n){return(e=Mfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mfe(t){var e=Ife(t,"string");return typeof e=="symbol"?e:e+""}function Ife(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mi{constructor(e){_fe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function dm(t,e,n){return(e=Pfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pfe(t){var e=Ofe(t,"string");return typeof e=="symbol"?e:e+""}function Ofe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oM extends mi{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),dm(this,"stateBefore",void 0),dm(this,"range",void 0),dm(this,"type",void 0),dm(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new oM({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){H(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){zs(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function rD(t,e,n){return(e=xfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xfe(t){var e=Afe(t,"string");return typeof e=="symbol"?e:e+""}function Afe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sM extends mi{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),rD(this,"columns",void 0),rD(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new sM({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),eM(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function iD(t,e,n){return(e=Hfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hfe(t){var e=Nfe(t,"string");return typeof e=="symbol"?e:e+""}function Nfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aM extends mi{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),iD(this,"previousSortState",void 0),iD(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new aM({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function oD(t,e,n){return(e=Dfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dfe(t){var e=kfe(t,"string");return typeof e=="symbol"?e:e+""}function kfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lM extends mi{constructor(e){let{index:n,amount:r}=e;super("insert_col"),oD(this,"index",void 0),oD(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new lM({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function sD(t,e,n){return(e=Lfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lfe(t){var e=$fe(t,"string");return typeof e=="symbol"?e:e+""}function $fe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uM extends mi{constructor(e){let{index:n,amount:r}=e;super("insert_row"),sD(this,"index",void 0),sD(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new uM({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function fm(t,e,n){return(e=Ffe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ffe(t){var e=Vfe(t,"string");return typeof e=="symbol"?e:e+""}function Vfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cM extends mi{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),fm(this,"changes",void 0),fm(this,"selected",void 0),fm(this,"countCols",void 0),fm(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new cM({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=er(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=er(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function aD(t,e,n){return(e=Wfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wfe(t){var e=Bfe(t,"string");return typeof e=="symbol"?e:e+""}function Bfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hM extends mi{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),aD(this,"conditionsStack",void 0),aD(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new hM({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function jfe(t,e,n){return(e=Ufe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ufe(t){var e=zfe(t,"string");return typeof e=="symbol"?e:e+""}function zfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dM extends mi{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),jfe(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new dM({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function wW(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return de(r,i,l=>{de(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Ko(t,e,n){return(e=Yfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yfe(t){var e=Gfe(t,"string");return typeof e=="symbol"?e:e+""}function Gfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fM extends mi{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Ko(this,"index",void 0),Ko(this,"indexes",void 0),Ko(this,"data",void 0),Ko(this,"amount",void 0),Ko(this,"headers",void 0),Ko(this,"columnPositions",void 0),Ko(this,"rowPositions",void 0),Ko(this,"fixedColumnsStart",void 0),Ko(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return de(l.length-1,g=>{const w=[],C=l[g];de(u,c,S=>{w.push(C[e.toPhysicalColumn(S)])}),h.push(w)}),de(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&de(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new fM({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:wW(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(je(this.data[c],o));const l=je(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),H(e.getSourceDataArray(),(c,h)=>{H(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&H(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Du(t,e,n){return(e=qfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qfe(t){var e=Kfe(t,"string");return typeof e=="symbol"?e:e+""}function Kfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gM extends mi{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),Du(this,"index",void 0),Du(this,"data",void 0),Du(this,"fixedRowsBottom",void 0),Du(this,"fixedRowsTop",void 0),Du(this,"rowIndexesSequence",void 0),Du(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=er(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new gM({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:wW(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function lD(t,e,n){return(e=Xfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xfe(t){var e=Zfe(t,"string");return typeof e=="symbol"?e:e+""}function Zfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mM extends mi{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),lD(this,"rows",void 0),lD(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new mM({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),eM(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Jfe(t,e,n){return(e=Qfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qfe(t){var e=ege(t,"string");return typeof e=="symbol"?e:e+""}function ege(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pM extends mi{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),Jfe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new pM({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function tge(t,e){[oM,sM,aM,lM,uM,cM,hM,dM,fM,gM,mM,pM].forEach(n=>n.startRegisteringEvents(t,e))}function nge(t,e){rge(t,e),e.add(t)}function rge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aR(t,e,n){return(e=ige(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ige(t){var e=oge(t,"string");return typeof e=="symbol"?e:e+""}function oge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uD="undoRedo",sge="undoRedo",age=1e3;ie.getSingleton().register("beforeUndo");ie.getSingleton().register("afterUndo");ie.getSingleton().register("beforeRedo");ie.getSingleton().register("afterRedo");const cD=new Set;var gm=new WeakSet;class lge extends Je{static get PLUGIN_KEY(){return sge}static get PLUGIN_PRIORITY(){return age}static get SETTING_KEYS(){return!0}constructor(e){super(e),nge(this,gm),aR(this,"doneActions",[]),aR(this,"undoneActions",[]),aR(this,"ignoreNewActions",!1),tge(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return lR(gm,e,uge).call(e,...r)}),this.registerShortcuts(),lR(gm,this,cge).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),lR(gm,this,hge).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:uD};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uD)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=er(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=er(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function uge(t,e){e==="loadData"&&this.clear()}function cge(){const t=e=>{cD.has(e)||(Ze(it`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),cD.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function hge(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function dge(){Ye(ud),Ye(Mee),Ye(cd),Ye(ite),Ye(dte),Ye(FF),Ye(ane),Ye(zne),Ye($w),Ye(Qre),Ye(Tie),Ye(Hie),Ye(Ww),Ye(moe),Ye(cae),Ye(jae),Ye(ple),Ye(Ile),Ye(Vle),Ye(Zle),Ye(aue),Ye(Tue),Ye(Nue),Ye(wce),Ye(Kce),Ye(ehe),Ye(_he),Ye(dde),Ye(Dde),Ye(Ude),Ye(ife),Ye(ffe),Ye(Efe),Ye(lge)}function fge(){ZZ(),yQ(),PQ(),KQ(),dge()}const uR={isDone:{name:"是否已完成",show:!1},id:{name:"谱面ID",show:!0},mode:{name:"模式",show:!1},status:{name:"状态",show:!1},bpm:{name:"BPM",show:!0},total_length:{name:"音频总时长(秒)",show:!1},hit_length:{name:"游玩长度(秒)",show:!1},url:{name:"谱面链接",show:!1},version:{name:"难度名称",show:!1},difficulty_rating:{name:"难度星级",show:!0},cs:{name:"CS",show:!1},ar:{name:"AR",show:!1},accuracy:{name:"OD",show:!1},drain:{name:"HP",show:!1},max_combo:{name:"最大连击数",show:!1},count_circles:{name:"圆圈数",show:!1},count_sliders:{name:"滑条数",show:!1},count_spinners:{name:"转盘数",show:!1},passcount:{name:"过关次数",show:!1},playcount:{name:"游玩次数",show:!1},"beatmapset.covers.list@2x":{name:"封面图",show:!1},"beatmapset.id":{name:"谱面集ID",show:!1},"beatmapset.title":{name:"歌曲标题",show:!1},"beatmapset.title_unicode":{name:"歌曲标题(原语言)",show:!0},"beatmapset.artist":{name:"歌曲艺术家",show:!1},"beatmapset.artist_unicode":{name:"艺术家(原语言)",show:!0},"beatmapset.bpm":{name:"谱面集BPM",show:!1},"beatmapset.preview_url":{name:"试听链接",show:!1},"beatmapset.creator":{name:"谱面集作者",show:!0},"beatmapset.user_id":{name:"谱面集作者ID",show:!1},"beatmapset.source":{name:"谱面集来源",show:!1},"beatmapset.video":{name:"是否含视频",show:!1},"beatmapset.storyboard":{name:"是否含故事板",show:!1},"beatmapset.favourite_count":{name:"收藏数",show:!1},"beatmapset.rating":{name:"谱面评分",show:!1},"beatmapset.tags":{name:"标签",show:!1},"beatmapset.submitted_date":{name:"提交日期",show:!1},"beatmapset.last_updated":{name:"最后更新日期",show:!1},"beatmapset.ranked_date":{name:"Ranked 日期",show:!1}};function gge(t,e){return e.split(".").reduce((n,r)=>{if(n&&typeof n=="object")return n[r]},t)}function mge(){function t(r){const i=[];for(const o of Object.keys(uR)){const s=gge(r,o);typeof s<"u"?i.push(s):i.push(o==="isDone"?1:"")}return i}function e(){return Object.values(uR).map(r=>r.name)}function n(){return Object.values(uR).map(r=>r.show)}return{mapObject:t,getFieldNames:e,getFieldShows:n}}const pge={class:"grid-container"},wge={class:"content"},vge={key:0,class:"corner-icon"},Cge={__name:"BeatmapInfoTable",props:["modelValue","hot","initialColHeaders"],emits:["selected"],setup(t,{emit:e}){const n=t,r=e,i=Kt(!1),o=Kt([]),s=Kt([]);aa(()=>n.modelValue,c=>{if(i.value=c,c){o.value=n.initialColHeaders,s.value=new Array(n.initialColHeaders.length).fill(1);const h=n.hot.getPlugin("hiddenColumns");if(h)for(let d=0;d<o.value.length;d++){const f=n.hot.toVisualColumn(d);h.isHidden(f)&&(s.value[d]=0)}}});function a(c){s.value[c]=s.value[c]?0:1}function l(){r("selected",s.value),i.value=!1}function u(){r("selected",[]),i.value=!1}return(c,h)=>{const d=_D,f=EU,g=RB,w=jU;return Fn(),uc(w,{modelValue:i.value,"onUpdate:modelValue":h[0]||(h[0]=C=>i.value=C),title:"请选择",width:"60%",onClose:u},{footer:vr(()=>[Ni(g,{onClick:u},{default:vr(()=>h[1]||(h[1]=[Bm("取消")])),_:1,__:[1]}),Ni(g,{type:"primary",onClick:l},{default:vr(()=>h[2]||(h[2]=[Bm("确认")])),_:1,__:[2]})]),default:vr(()=>[bl("div",pge,[(Fn(!0),To(SB,null,bB(o.value.slice(1),(C,S)=>(Fn(),uc(f,{key:S+1,class:$r([{selected:s.value[S+1]==1},"grid-item"]),onClick:v=>a(S+1)},{default:vr(()=>[bl("div",wge,jm(C),1),s.value[S+1]==1?(Fn(),To("div",vge,[Ni(d,null,{default:vr(()=>[Ni(pe(EB))]),_:1})])):cc("",!0)]),_:2},1032,["class","onClick"]))),128))])]),_:1},8,["modelValue"])}}},yge=yB(Cge,[["__scopeId","data-v-bd6c8d37"]]);function vW(t,e){return function(){return t.apply(e,arguments)}}const{toString:bge}=Object.prototype,{getPrototypeOf:wM}=Object,{iterator:Yw,toStringTag:CW}=Symbol,Gw=(t=>e=>{const n=bge.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Yi=t=>(t=t.toLowerCase(),e=>Gw(e)===t),qw=t=>e=>typeof e===t,{isArray:Fc}=Array,Gd=qw("undefined");function Sge(t){return t!==null&&!Gd(t)&&t.constructor!==null&&!Gd(t.constructor)&&yr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const yW=Yi("ArrayBuffer");function Rge(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&yW(t.buffer),e}const Ege=qw("string"),yr=qw("function"),bW=qw("number"),Kw=t=>t!==null&&typeof t=="object",Tge=t=>t===!0||t===!1,$m=t=>{if(Gw(t)!=="object")return!1;const e=wM(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(CW in t)&&!(Yw in t)},_ge=Yi("Date"),Mge=Yi("File"),Ige=Yi("Blob"),Pge=Yi("FileList"),Oge=t=>Kw(t)&&yr(t.pipe),xge=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||yr(t.append)&&((e=Gw(t))==="formdata"||e==="object"&&yr(t.toString)&&t.toString()==="[object FormData]"))},Age=Yi("URLSearchParams"),[Hge,Nge,Dge,kge]=["ReadableStream","Request","Response","Headers"].map(Yi),Lge=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Tf(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),Fc(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{const o=n?Object.getOwnPropertyNames(t):Object.keys(t),s=o.length;let a;for(r=0;r<s;r++)a=o[r],e.call(null,t[a],a,t)}}function SW(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,i;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const Cl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,RW=t=>!Gd(t)&&t!==Cl;function gE(){const{caseless:t}=RW(this)&&this||{},e={},n=(r,i)=>{const o=t&&SW(e,i)||i;$m(e[o])&&$m(r)?e[o]=gE(e[o],r):$m(r)?e[o]=gE({},r):Fc(r)?e[o]=r.slice():e[o]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Tf(arguments[r],n);return e}const $ge=(t,e,n,{allOwnKeys:r}={})=>(Tf(e,(i,o)=>{n&&yr(i)?t[o]=vW(i,n):t[o]=i},{allOwnKeys:r}),t),Fge=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Vge=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},Wge=(t,e,n,r)=>{let i,o,s;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),o=i.length;o-- >0;)s=i[o],(!r||r(s,t,e))&&!a[s]&&(e[s]=t[s],a[s]=!0);t=n!==!1&&wM(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},Bge=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},jge=t=>{if(!t)return null;if(Fc(t))return t;let e=t.length;if(!bW(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},Uge=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&wM(Uint8Array)),zge=(t,e)=>{const r=(t&&t[Yw]).call(t);let i;for(;(i=r.next())&&!i.done;){const o=i.value;e.call(t,o[0],o[1])}},Yge=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},Gge=Yi("HTMLFormElement"),qge=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),hD=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),Kge=Yi("RegExp"),EW=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Tf(n,(i,o)=>{let s;(s=e(i,o,t))!==!1&&(r[o]=s||i)}),Object.defineProperties(t,r)},Xge=t=>{EW(t,(e,n)=>{if(yr(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(yr(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Zge=(t,e)=>{const n={},r=i=>{i.forEach(o=>{n[o]=!0})};return Fc(t)?r(t):r(String(t).split(e)),n},Jge=()=>{},Qge=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function eme(t){return!!(t&&yr(t.append)&&t[CW]==="FormData"&&t[Yw])}const tme=t=>{const e=new Array(10),n=(r,i)=>{if(Kw(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[i]=r;const o=Fc(r)?[]:{};return Tf(r,(s,a)=>{const l=n(s,i+1);!Gd(l)&&(o[a]=l)}),e[i]=void 0,o}}return r};return n(t,0)},nme=Yi("AsyncFunction"),rme=t=>t&&(Kw(t)||yr(t))&&yr(t.then)&&yr(t.catch),TW=((t,e)=>t?setImmediate:e?((n,r)=>(Cl.addEventListener("message",({source:i,data:o})=>{i===Cl&&o===n&&r.length&&r.shift()()},!1),i=>{r.push(i),Cl.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",yr(Cl.postMessage)),ime=typeof queueMicrotask<"u"?queueMicrotask.bind(Cl):typeof process<"u"&&process.nextTick||TW,ome=t=>t!=null&&yr(t[Yw]),Y={isArray:Fc,isArrayBuffer:yW,isBuffer:Sge,isFormData:xge,isArrayBufferView:Rge,isString:Ege,isNumber:bW,isBoolean:Tge,isObject:Kw,isPlainObject:$m,isReadableStream:Hge,isRequest:Nge,isResponse:Dge,isHeaders:kge,isUndefined:Gd,isDate:_ge,isFile:Mge,isBlob:Ige,isRegExp:Kge,isFunction:yr,isStream:Oge,isURLSearchParams:Age,isTypedArray:Uge,isFileList:Pge,forEach:Tf,merge:gE,extend:$ge,trim:Lge,stripBOM:Fge,inherits:Vge,toFlatObject:Wge,kindOf:Gw,kindOfTest:Yi,endsWith:Bge,toArray:jge,forEachEntry:zge,matchAll:Yge,isHTMLForm:Gge,hasOwnProperty:hD,hasOwnProp:hD,reduceDescriptors:EW,freezeMethods:Xge,toObjectSet:Zge,toCamelCase:qge,noop:Jge,toFiniteNumber:Qge,findKey:SW,global:Cl,isContextDefined:RW,isSpecCompliantForm:eme,toJSONObject:tme,isAsyncFn:nme,isThenable:rme,setImmediate:TW,asap:ime,isIterable:ome};function Pe(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}Y.inherits(Pe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Y.toJSONObject(this.config),code:this.code,status:this.status}}});const _W=Pe.prototype,MW={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{MW[t]={value:t}});Object.defineProperties(Pe,MW);Object.defineProperty(_W,"isAxiosError",{value:!0});Pe.from=(t,e,n,r,i,o)=>{const s=Object.create(_W);return Y.toFlatObject(t,s,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),Pe.call(s,t.message,e,n,r,i),s.cause=t,s.name=t.name,o&&Object.assign(s,o),s};const sme=null;function mE(t){return Y.isPlainObject(t)||Y.isArray(t)}function IW(t){return Y.endsWith(t,"[]")?t.slice(0,-2):t}function dD(t,e,n){return t?t.concat(e).map(function(i,o){return i=IW(i),!n&&o?"["+i+"]":i}).join(n?".":""):e}function ame(t){return Y.isArray(t)&&!t.some(mE)}const lme=Y.toFlatObject(Y,{},null,function(e){return/^is[A-Z]/.test(e)});function Xw(t,e,n){if(!Y.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=Y.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,C){return!Y.isUndefined(C[w])});const r=n.metaTokens,i=n.visitor||c,o=n.dots,s=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&Y.isSpecCompliantForm(e);if(!Y.isFunction(i))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(Y.isDate(g))return g.toISOString();if(Y.isBoolean(g))return g.toString();if(!l&&Y.isBlob(g))throw new Pe("Blob is not supported. Use a Buffer instead.");return Y.isArrayBuffer(g)||Y.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function c(g,w,C){let S=g;if(g&&!C&&typeof g=="object"){if(Y.endsWith(w,"{}"))w=r?w:w.slice(0,-2),g=JSON.stringify(g);else if(Y.isArray(g)&&ame(g)||(Y.isFileList(g)||Y.endsWith(w,"[]"))&&(S=Y.toArray(g)))return w=IW(w),S.forEach(function(E,P){!(Y.isUndefined(E)||E===null)&&e.append(s===!0?dD([w],P,o):s===null?w:w+"[]",u(E))}),!1}return mE(g)?!0:(e.append(dD(C,w,o),u(g)),!1)}const h=[],d=Object.assign(lme,{defaultVisitor:c,convertValue:u,isVisitable:mE});function f(g,w){if(!Y.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+w.join("."));h.push(g),Y.forEach(g,function(S,v){(!(Y.isUndefined(S)||S===null)&&i.call(e,S,Y.isString(v)?v.trim():v,w,d))===!0&&f(S,w?w.concat(v):[v])}),h.pop()}}if(!Y.isObject(t))throw new TypeError("data must be an object");return f(t),e}function fD(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function vM(t,e){this._pairs=[],t&&Xw(t,this,e)}const PW=vM.prototype;PW.append=function(e,n){this._pairs.push([e,n])};PW.toString=function(e){const n=e?function(r){return e.call(this,r,fD)}:fD;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function ume(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function OW(t,e,n){if(!e)return t;const r=n&&n.encode||ume;Y.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let o;if(i?o=i(e,n):o=Y.isURLSearchParams(e)?e.toString():new vM(e,n).toString(r),o){const s=t.indexOf("#");s!==-1&&(t=t.slice(0,s)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class gD{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Y.forEach(this.handlers,function(r){r!==null&&e(r)})}}const xW={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},cme=typeof URLSearchParams<"u"?URLSearchParams:vM,hme=typeof FormData<"u"?FormData:null,dme=typeof Blob<"u"?Blob:null,fme={isBrowser:!0,classes:{URLSearchParams:cme,FormData:hme,Blob:dme},protocols:["http","https","file","blob","url","data"]},CM=typeof window<"u"&&typeof document<"u",pE=typeof navigator=="object"&&navigator||void 0,gme=CM&&(!pE||["ReactNative","NativeScript","NS"].indexOf(pE.product)<0),mme=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",pme=CM&&window.location.href||"http://localhost",wme=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:CM,hasStandardBrowserEnv:gme,hasStandardBrowserWebWorkerEnv:mme,navigator:pE,origin:pme},Symbol.toStringTag,{value:"Module"})),Ln={...wme,...fme};function vme(t,e){return Xw(t,new Ln.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,o){return Ln.isNode&&Y.isBuffer(n)?(this.append(r,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function Cme(t){return Y.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function yme(t){const e={},n=Object.keys(t);let r;const i=n.length;let o;for(r=0;r<i;r++)o=n[r],e[o]=t[o];return e}function AW(t){function e(n,r,i,o){let s=n[o++];if(s==="__proto__")return!0;const a=Number.isFinite(+s),l=o>=n.length;return s=!s&&Y.isArray(i)?i.length:s,l?(Y.hasOwnProp(i,s)?i[s]=[i[s],r]:i[s]=r,!a):((!i[s]||!Y.isObject(i[s]))&&(i[s]=[]),e(n,r,i[s],o)&&Y.isArray(i[s])&&(i[s]=yme(i[s])),!a)}if(Y.isFormData(t)&&Y.isFunction(t.entries)){const n={};return Y.forEachEntry(t,(r,i)=>{e(Cme(r),i,n,0)}),n}return null}function bme(t,e,n){if(Y.isString(t))try{return(e||JSON.parse)(t),Y.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const _f={transitional:xW,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,o=Y.isObject(e);if(o&&Y.isHTMLForm(e)&&(e=new FormData(e)),Y.isFormData(e))return i?JSON.stringify(AW(e)):e;if(Y.isArrayBuffer(e)||Y.isBuffer(e)||Y.isStream(e)||Y.isFile(e)||Y.isBlob(e)||Y.isReadableStream(e))return e;if(Y.isArrayBufferView(e))return e.buffer;if(Y.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return vme(e,this.formSerializer).toString();if((a=Y.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Xw(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return o||i?(n.setContentType("application/json",!1),bme(e)):e}],transformResponse:[function(e){const n=this.transitional||_f.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(Y.isResponse(e)||Y.isReadableStream(e))return e;if(e&&Y.isString(e)&&(r&&!this.responseType||i)){const s=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(s)throw a.name==="SyntaxError"?Pe.from(a,Pe.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ln.classes.FormData,Blob:Ln.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Y.forEach(["delete","get","head","post","put","patch"],t=>{_f.headers[t]={}});const Sme=Y.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Rme=t=>{const e={};let n,r,i;return t&&t.split(`
`).forEach(function(s){i=s.indexOf(":"),n=s.substring(0,i).trim().toLowerCase(),r=s.substring(i+1).trim(),!(!n||e[n]&&Sme[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},mD=Symbol("internals");function Gh(t){return t&&String(t).trim().toLowerCase()}function Fm(t){return t===!1||t==null?t:Y.isArray(t)?t.map(Fm):String(t)}function Eme(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const Tme=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function cR(t,e,n,r,i){if(Y.isFunction(r))return r.call(this,e,n);if(i&&(e=n),!!Y.isString(e)){if(Y.isString(r))return e.indexOf(r)!==-1;if(Y.isRegExp(r))return r.test(e)}}function _me(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function Mme(t,e){const n=Y.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(i,o,s){return this[r].call(this,e,i,o,s)},configurable:!0})})}let br=class{constructor(e){e&&this.set(e)}set(e,n,r){const i=this;function o(a,l,u){const c=Gh(l);if(!c)throw new Error("header name must be a non-empty string");const h=Y.findKey(i,c);(!h||i[h]===void 0||u===!0||u===void 0&&i[h]!==!1)&&(i[h||l]=Fm(a))}const s=(a,l)=>Y.forEach(a,(u,c)=>o(u,c,l));if(Y.isPlainObject(e)||e instanceof this.constructor)s(e,n);else if(Y.isString(e)&&(e=e.trim())&&!Tme(e))s(Rme(e),n);else if(Y.isObject(e)&&Y.isIterable(e)){let a={},l,u;for(const c of e){if(!Y.isArray(c))throw TypeError("Object iterator must return a key-value pair");a[u=c[0]]=(l=a[u])?Y.isArray(l)?[...l,c[1]]:[l,c[1]]:c[1]}s(a,n)}else e!=null&&o(n,e,r);return this}get(e,n){if(e=Gh(e),e){const r=Y.findKey(this,e);if(r){const i=this[r];if(!n)return i;if(n===!0)return Eme(i);if(Y.isFunction(n))return n.call(this,i,r);if(Y.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Gh(e),e){const r=Y.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||cR(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let i=!1;function o(s){if(s=Gh(s),s){const a=Y.findKey(r,s);a&&(!n||cR(r,r[a],a,n))&&(delete r[a],i=!0)}}return Y.isArray(e)?e.forEach(o):o(e),i}clear(e){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const o=n[r];(!e||cR(this,this[o],o,e,!0))&&(delete this[o],i=!0)}return i}normalize(e){const n=this,r={};return Y.forEach(this,(i,o)=>{const s=Y.findKey(r,o);if(s){n[s]=Fm(i),delete n[o];return}const a=e?_me(o):String(o).trim();a!==o&&delete n[o],n[a]=Fm(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return Y.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=e&&Y.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[mD]=this[mD]={accessors:{}}).accessors,i=this.prototype;function o(s){const a=Gh(s);r[a]||(Mme(i,s),r[a]=!0)}return Y.isArray(e)?e.forEach(o):o(e),this}};br.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Y.reduceDescriptors(br.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});Y.freezeMethods(br);function hR(t,e){const n=this||_f,r=e||n,i=br.from(r.headers);let o=r.data;return Y.forEach(t,function(a){o=a.call(n,o,i.normalize(),e?e.status:void 0)}),i.normalize(),o}function HW(t){return!!(t&&t.__CANCEL__)}function Vc(t,e,n){Pe.call(this,t??"canceled",Pe.ERR_CANCELED,e,n),this.name="CanceledError"}Y.inherits(Vc,Pe,{__CANCEL__:!0});function NW(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new Pe("Request failed with status code "+n.status,[Pe.ERR_BAD_REQUEST,Pe.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Ime(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Pme(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i=0,o=0,s;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=r[o];s||(s=u),n[i]=l,r[i]=u;let h=o,d=0;for(;h!==i;)d+=n[h++],h=h%t;if(i=(i+1)%t,i===o&&(o=(o+1)%t),u-s<e)return;const f=c&&u-c;return f?Math.round(d*1e3/f):void 0}}function Ome(t,e){let n=0,r=1e3/e,i,o;const s=(u,c=Date.now())=>{n=c,i=null,o&&(clearTimeout(o),o=null),t.apply(null,u)};return[(...u)=>{const c=Date.now(),h=c-n;h>=r?s(u,c):(i=u,o||(o=setTimeout(()=>{o=null,s(i)},r-h)))},()=>i&&s(i)]}const Wp=(t,e,n=3)=>{let r=0;const i=Pme(50,250);return Ome(o=>{const s=o.loaded,a=o.lengthComputable?o.total:void 0,l=s-r,u=i(l),c=s<=a;r=s;const h={loaded:s,total:a,progress:a?s/a:void 0,bytes:l,rate:u||void 0,estimated:u&&a&&c?(a-s)/u:void 0,event:o,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(h)},n)},pD=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},wD=t=>(...e)=>Y.asap(()=>t(...e)),xme=Ln.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Ln.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Ln.origin),Ln.navigator&&/(msie|trident)/i.test(Ln.navigator.userAgent)):()=>!0,Ame=Ln.hasStandardBrowserEnv?{write(t,e,n,r,i,o){const s=[t+"="+encodeURIComponent(e)];Y.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),Y.isString(r)&&s.push("path="+r),Y.isString(i)&&s.push("domain="+i),o===!0&&s.push("secure"),document.cookie=s.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Hme(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Nme(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function DW(t,e,n){let r=!Hme(e);return t&&(r||n==!1)?Nme(t,e):e}const vD=t=>t instanceof br?{...t}:t;function Ll(t,e){e=e||{};const n={};function r(u,c,h,d){return Y.isPlainObject(u)&&Y.isPlainObject(c)?Y.merge.call({caseless:d},u,c):Y.isPlainObject(c)?Y.merge({},c):Y.isArray(c)?c.slice():c}function i(u,c,h,d){if(Y.isUndefined(c)){if(!Y.isUndefined(u))return r(void 0,u,h,d)}else return r(u,c,h,d)}function o(u,c){if(!Y.isUndefined(c))return r(void 0,c)}function s(u,c){if(Y.isUndefined(c)){if(!Y.isUndefined(u))return r(void 0,u)}else return r(void 0,c)}function a(u,c,h){if(h in e)return r(u,c);if(h in t)return r(void 0,u)}const l={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(u,c,h)=>i(vD(u),vD(c),h,!0)};return Y.forEach(Object.keys(Object.assign({},t,e)),function(c){const h=l[c]||i,d=h(t[c],e[c],c);Y.isUndefined(d)&&h!==a||(n[c]=d)}),n}const kW=t=>{const e=Ll({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:o,headers:s,auth:a}=e;e.headers=s=br.from(s),e.url=OW(DW(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&s.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(Y.isFormData(n)){if(Ln.hasStandardBrowserEnv||Ln.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if((l=s.getContentType())!==!1){const[u,...c]=l?l.split(";").map(h=>h.trim()).filter(Boolean):[];s.setContentType([u||"multipart/form-data",...c].join("; "))}}if(Ln.hasStandardBrowserEnv&&(r&&Y.isFunction(r)&&(r=r(e)),r||r!==!1&&xme(e.url))){const u=i&&o&&Ame.read(o);u&&s.set(i,u)}return e},Dme=typeof XMLHttpRequest<"u",kme=Dme&&function(t){return new Promise(function(n,r){const i=kW(t);let o=i.data;const s=br.from(i.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:u}=i,c,h,d,f,g;function w(){f&&f(),g&&g(),i.cancelToken&&i.cancelToken.unsubscribe(c),i.signal&&i.signal.removeEventListener("abort",c)}let C=new XMLHttpRequest;C.open(i.method.toUpperCase(),i.url,!0),C.timeout=i.timeout;function S(){if(!C)return;const E=br.from("getAllResponseHeaders"in C&&C.getAllResponseHeaders()),x={data:!a||a==="text"||a==="json"?C.responseText:C.response,status:C.status,statusText:C.statusText,headers:E,config:t,request:C};NW(function(M){n(M),w()},function(M){r(M),w()},x),C=null}"onloadend"in C?C.onloadend=S:C.onreadystatechange=function(){!C||C.readyState!==4||C.status===0&&!(C.responseURL&&C.responseURL.indexOf("file:")===0)||setTimeout(S)},C.onabort=function(){C&&(r(new Pe("Request aborted",Pe.ECONNABORTED,t,C)),C=null)},C.onerror=function(){r(new Pe("Network Error",Pe.ERR_NETWORK,t,C)),C=null},C.ontimeout=function(){let P=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const x=i.transitional||xW;i.timeoutErrorMessage&&(P=i.timeoutErrorMessage),r(new Pe(P,x.clarifyTimeoutError?Pe.ETIMEDOUT:Pe.ECONNABORTED,t,C)),C=null},o===void 0&&s.setContentType(null),"setRequestHeader"in C&&Y.forEach(s.toJSON(),function(P,x){C.setRequestHeader(x,P)}),Y.isUndefined(i.withCredentials)||(C.withCredentials=!!i.withCredentials),a&&a!=="json"&&(C.responseType=i.responseType),u&&([d,g]=Wp(u,!0),C.addEventListener("progress",d)),l&&C.upload&&([h,f]=Wp(l),C.upload.addEventListener("progress",h),C.upload.addEventListener("loadend",f)),(i.cancelToken||i.signal)&&(c=E=>{C&&(r(!E||E.type?new Vc(null,t,C):E),C.abort(),C=null)},i.cancelToken&&i.cancelToken.subscribe(c),i.signal&&(i.signal.aborted?c():i.signal.addEventListener("abort",c)));const v=Ime(i.url);if(v&&Ln.protocols.indexOf(v)===-1){r(new Pe("Unsupported protocol "+v+":",Pe.ERR_BAD_REQUEST,t));return}C.send(o||null)})},Lme=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,i;const o=function(u){if(!i){i=!0,a();const c=u instanceof Error?u:this.reason;r.abort(c instanceof Pe?c:new Vc(c instanceof Error?c.message:c))}};let s=e&&setTimeout(()=>{s=null,o(new Pe(`timeout ${e} of ms exceeded`,Pe.ETIMEDOUT))},e);const a=()=>{t&&(s&&clearTimeout(s),s=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),t=null)};t.forEach(u=>u.addEventListener("abort",o));const{signal:l}=r;return l.unsubscribe=()=>Y.asap(a),l}},$me=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let r=0,i;for(;r<n;)i=r+e,yield t.slice(r,i),r=i},Fme=async function*(t,e){for await(const n of Vme(t))yield*$me(n,e)},Vme=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},CD=(t,e,n,r)=>{const i=Fme(t,e);let o=0,s,a=l=>{s||(s=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:u,value:c}=await i.next();if(u){a(),l.close();return}let h=c.byteLength;if(n){let d=o+=h;n(d)}l.enqueue(new Uint8Array(c))}catch(u){throw a(u),u}},cancel(l){return a(l),i.return()}},{highWaterMark:2})},Zw=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",LW=Zw&&typeof ReadableStream=="function",Wme=Zw&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),$W=(t,...e)=>{try{return!!t(...e)}catch{return!1}},Bme=LW&&$W(()=>{let t=!1;const e=new Request(Ln.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),yD=64*1024,wE=LW&&$W(()=>Y.isReadableStream(new Response("").body)),Bp={stream:wE&&(t=>t.body)};Zw&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Bp[e]&&(Bp[e]=Y.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new Pe(`Response type '${e}' is not supported`,Pe.ERR_NOT_SUPPORT,r)})})})(new Response);const jme=async t=>{if(t==null)return 0;if(Y.isBlob(t))return t.size;if(Y.isSpecCompliantForm(t))return(await new Request(Ln.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(Y.isArrayBufferView(t)||Y.isArrayBuffer(t))return t.byteLength;if(Y.isURLSearchParams(t)&&(t=t+""),Y.isString(t))return(await Wme(t)).byteLength},Ume=async(t,e)=>{const n=Y.toFiniteNumber(t.getContentLength());return n??jme(e)},zme=Zw&&(async t=>{let{url:e,method:n,data:r,signal:i,cancelToken:o,timeout:s,onDownloadProgress:a,onUploadProgress:l,responseType:u,headers:c,withCredentials:h="same-origin",fetchOptions:d}=kW(t);u=u?(u+"").toLowerCase():"text";let f=Lme([i,o&&o.toAbortSignal()],s),g;const w=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let C;try{if(l&&Bme&&n!=="get"&&n!=="head"&&(C=await Ume(c,r))!==0){let x=new Request(e,{method:"POST",body:r,duplex:"half"}),_;if(Y.isFormData(r)&&(_=x.headers.get("content-type"))&&c.setContentType(_),x.body){const[M,V]=pD(C,Wp(wD(l)));r=CD(x.body,yD,M,V)}}Y.isString(h)||(h=h?"include":"omit");const S="credentials"in Request.prototype;g=new Request(e,{...d,signal:f,method:n.toUpperCase(),headers:c.normalize().toJSON(),body:r,duplex:"half",credentials:S?h:void 0});let v=await fetch(g,d);const E=wE&&(u==="stream"||u==="response");if(wE&&(a||E&&w)){const x={};["status","statusText","headers"].forEach(z=>{x[z]=v[z]});const _=Y.toFiniteNumber(v.headers.get("content-length")),[M,V]=a&&pD(_,Wp(wD(a),!0))||[];v=new Response(CD(v.body,yD,M,()=>{V&&V(),w&&w()}),x)}u=u||"text";let P=await Bp[Y.findKey(Bp,u)||"text"](v,t);return!E&&w&&w(),await new Promise((x,_)=>{NW(x,_,{data:P,headers:br.from(v.headers),status:v.status,statusText:v.statusText,config:t,request:g})})}catch(S){throw w&&w(),S&&S.name==="TypeError"&&/Load failed|fetch/i.test(S.message)?Object.assign(new Pe("Network Error",Pe.ERR_NETWORK,t,g),{cause:S.cause||S}):Pe.from(S,S&&S.code,t,g)}}),vE={http:sme,xhr:kme,fetch:zme};Y.forEach(vE,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const bD=t=>`- ${t}`,Yme=t=>Y.isFunction(t)||t===null||t===!1,FW={getAdapter:t=>{t=Y.isArray(t)?t:[t];const{length:e}=t;let n,r;const i={};for(let o=0;o<e;o++){n=t[o];let s;if(r=n,!Yme(n)&&(r=vE[(s=String(n)).toLowerCase()],r===void 0))throw new Pe(`Unknown adapter '${s}'`);if(r)break;i[s||"#"+o]=r}if(!r){const o=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let s=e?o.length>1?`since :
`+o.map(bD).join(`
`):" "+bD(o[0]):"as no adapter specified";throw new Pe("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return r},adapters:vE};function dR(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Vc(null,t)}function SD(t){return dR(t),t.headers=br.from(t.headers),t.data=hR.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),FW.getAdapter(t.adapter||_f.adapter)(t).then(function(r){return dR(t),r.data=hR.call(t,t.transformResponse,r),r.headers=br.from(r.headers),r},function(r){return HW(r)||(dR(t),r&&r.response&&(r.response.data=hR.call(t,t.transformResponse,r.response),r.response.headers=br.from(r.response.headers))),Promise.reject(r)})}const VW="1.10.0",Jw={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Jw[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const RD={};Jw.transitional=function(e,n,r){function i(o,s){return"[Axios v"+VW+"] Transitional option '"+o+"'"+s+(r?". "+r:"")}return(o,s,a)=>{if(e===!1)throw new Pe(i(s," has been removed"+(n?" in "+n:"")),Pe.ERR_DEPRECATED);return n&&!RD[s]&&(RD[s]=!0,console.warn(i(s," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(o,s,a):!0}};Jw.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function Gme(t,e,n){if(typeof t!="object")throw new Pe("options must be an object",Pe.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const o=r[i],s=e[o];if(s){const a=t[o],l=a===void 0||s(a,o,t);if(l!==!0)throw new Pe("option "+o+" must be "+l,Pe.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Pe("Unknown option "+o,Pe.ERR_BAD_OPTION)}}const Vm={assertOptions:Gme,validators:Jw},co=Vm.validators;let Tl=class{constructor(e){this.defaults=e||{},this.interceptors={request:new gD,response:new gD}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Ll(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:o}=n;r!==void 0&&Vm.assertOptions(r,{silentJSONParsing:co.transitional(co.boolean),forcedJSONParsing:co.transitional(co.boolean),clarifyTimeoutError:co.transitional(co.boolean)},!1),i!=null&&(Y.isFunction(i)?n.paramsSerializer={serialize:i}:Vm.assertOptions(i,{encode:co.function,serialize:co.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Vm.assertOptions(n,{baseUrl:co.spelling("baseURL"),withXsrfToken:co.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let s=o&&Y.merge(o.common,o[n.method]);o&&Y.forEach(["delete","get","head","post","put","patch","common"],g=>{delete o[g]}),n.headers=br.concat(s,o);const a=[];let l=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(n)===!1||(l=l&&w.synchronous,a.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let c,h=0,d;if(!l){const g=[SD.bind(this),void 0];for(g.unshift.apply(g,a),g.push.apply(g,u),d=g.length,c=Promise.resolve(n);h<d;)c=c.then(g[h++],g[h++]);return c}d=a.length;let f=n;for(h=0;h<d;){const g=a[h++],w=a[h++];try{f=g(f)}catch(C){w.call(this,C);break}}try{c=SD.call(this,f)}catch(g){return Promise.reject(g)}for(h=0,d=u.length;h<d;)c=c.then(u[h++],u[h++]);return c}getUri(e){e=Ll(this.defaults,e);const n=DW(e.baseURL,e.url,e.allowAbsoluteUrls);return OW(n,e.params,e.paramsSerializer)}};Y.forEach(["delete","get","head","options"],function(e){Tl.prototype[e]=function(n,r){return this.request(Ll(r||{},{method:e,url:n,data:(r||{}).data}))}});Y.forEach(["post","put","patch"],function(e){function n(r){return function(o,s,a){return this.request(Ll(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:s}))}}Tl.prototype[e]=n(),Tl.prototype[e+"Form"]=n(!0)});let qme=class WW{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const r=this;this.promise.then(i=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](i);r._listeners=null}),this.promise.then=i=>{let o;const s=new Promise(a=>{r.subscribe(a),o=a}).then(i);return s.cancel=function(){r.unsubscribe(o)},s},e(function(o,s,a){r.reason||(r.reason=new Vc(o,s,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new WW(function(i){e=i}),cancel:e}}};function Kme(t){return function(n){return t.apply(null,n)}}function Xme(t){return Y.isObject(t)&&t.isAxiosError===!0}const CE={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(CE).forEach(([t,e])=>{CE[e]=t});function BW(t){const e=new Tl(t),n=vW(Tl.prototype.request,e);return Y.extend(n,Tl.prototype,e,{allOwnKeys:!0}),Y.extend(n,e,null,{allOwnKeys:!0}),n.create=function(i){return BW(Ll(t,i))},n}const Xt=BW(_f);Xt.Axios=Tl;Xt.CanceledError=Vc;Xt.CancelToken=qme;Xt.isCancel=HW;Xt.VERSION=VW;Xt.toFormData=Xw;Xt.AxiosError=Pe;Xt.Cancel=Xt.CanceledError;Xt.all=function(e){return Promise.all(e)};Xt.spread=Kme;Xt.isAxiosError=Xme;Xt.mergeConfig=Ll;Xt.AxiosHeaders=br;Xt.formToJSON=t=>AW(Y.isHTMLForm(t)?new FormData(t):t);Xt.getAdapter=FW.getAdapter;Xt.HttpStatusCode=CE;Xt.default=Xt;const{Axios:vpe,AxiosError:Cpe,CanceledError:ype,isCancel:bpe,CancelToken:Spe,VERSION:Rpe,all:Epe,Cancel:Tpe,isAxiosError:_pe,spread:Mpe,toFormData:Ipe,AxiosHeaders:Ppe,HttpStatusCode:Ope,formToJSON:xpe,getAdapter:Ape,mergeConfig:Hpe}=Xt,Zme={class:"container"},Npe={__name:"TableView",setup(t){fge();const{mapObject:e,getFieldNames:n,getFieldShows:r}=mge(),i=Kt([[],[],[],[],[]]),o=Kt(null);let s=null;const a=Kt({}),l=Kt(!1);let u;const c=v=>{l.value=!1,u&&(u(v),u=null)},h=async()=>(l.value=!0,new Promise(v=>{u=v})),d={colHeaders:n(),data:i.value,rowHeaders:!0,stretchH:"all",width:"100%",minCols:n().length,manualColumnResize:!0,manualColumnMove:!0,manualRowMove:!0,manualRowResize:!0,autoWrapRow:!0,themeName:"ht-theme-horizon",licenseKey:"non-commercial-and-evaluation",hiddenColumns:{copyPasteEnabled:!1},contextMenu:{async callback(v,E,P){const x=f(),_=g();switch(v){case"row:delete":{let M=0;_.forEach(V=>{this.alter("remove_row",V-M),M++});break}case"row:above":{this.alter("insert_row_above",_[0]);break}case"row:below":{this.alter("insert_row_below",_[0]);break}case"col:delete":{let M=0;x.forEach(V=>{this.toPhysicalColumn(V)>=n().length?(this.alter("remove_col",V-M),console.log(`删除列: ${V}`),M++):(this.getPlugin("hiddenColumns").hideColumn(V),console.log(`隐藏列: ${V}`))});break}case"col:left":{const M=this.getPlugin("manualColumnMove");this.alter("insert_col_end",this.countCols()),M.moveColumn(this.countCols()-1,x[0]);break}case"col:right":{const M=this.getPlugin("manualColumnMove");this.alter("insert_col_end",this.countCols()),M.moveColumn(this.countCols()-1,x[0]+1);break}case"data:row":{const M=[],V=[];for(let z=0;z<_.length;z++){const O=_[z],G=i.value[O][1];/^\d+$/.test(String(G).trim())&&(M.push(G),V.push(O))}if(M.length===0)return;for(;M.length>0;){const z=M.splice(0,50),O=V.splice(0,50);await S(z,O)}break}case"data:add":{const M=await h();if(!M||M.length===0)return;const V=this.getPlugin("hiddenColumns");for(let z=1;z<M.length;z++){const O=this.toVisualColumn(z);M[z]&&V.isHidden(O)&&V.showColumn(O),!M[z]&&!V.isHidden(O)&&V.hideColumn(O)}break}}console.log(v),this.render()},items:{row:{name:"行操作",submenu:{items:[{key:"row:delete",name:"删除选中行",disabled(){return C()}},{key:"row:above",name:"在上方插入行",disabled(){return g().length!==1}},{key:"row:below",name:"在下方插入行",disabled(){return g().length!==1}}]}},col:{name:"列操作",submenu:{items:[{key:"col:delete",name:"删除选中列",disabled(){return w()}},{key:"col:left",name:"在左侧插入列",disabled(){return f().length!==1}},{key:"col:right",name:"在右侧插入列",disabled(){return f().length!==1}}]}},data:{name:"数据操作",submenu:{items:[{key:"data:row",name:"获取选中行数据"},{key:"data:add",name:"添加谱面信息..."},{key:"data:download",name:"保存表格为xlsx文件"}]}},split:{name:"---------"},alignment:{name:"单元格对齐"}}},afterGetRowHeader(v,E){const P=a.value[v];E.classList.remove("row-header-success","row-header-failed","row-header-pending"),P==="success"?E.classList.add("row-header-success"):P==="failed"?E.classList.add("row-header-failed"):E.classList.add("row-header-pending")},afterGetColHeader(v,E){E.removeEventListener("dblclick",E._dblclickHandler);const P=()=>{const x=s.getColHeader(v),_=document.createElement("input");_.type="text",_.value=x,_.style.position="absolute";const M=E.getBoundingClientRect();_.style.left=M.left+"px",_.style.top=M.top+"px",_.style.width=M.width+"px",_.style.height=M.height+"px",_.style.zIndex=9999,document.body.appendChild(_),s.deselectCell(),_.focus(),_.addEventListener("blur",()=>{const V=_.value.trim()||x,z=s.getSettings().colHeaders,O=s.toPhysicalColumn(v);z[O]=V,s.updateSettings({colHeaders:z}),document.body.removeChild(_)}),_.addEventListener("keydown",V=>{V.key==="Enter"&&_.blur()})};E._dblclickHandler=P,E.addEventListener("dblclick",P)}};function f(){const v=s.getSelectedRange(),E=new Set,P=s.getPlugin("hiddenColumns");return v?(v.forEach(x=>{const _=Math.min(x.from.col,x.to.col),M=Math.max(x.from.col,x.to.col);for(let V=_;V<=M;V++)V!==-1&&!P.isHidden(V)&&E.add(V)}),Array.from(E).sort((x,_)=>x-_)):[]}function g(){const v=s.getSelectedRange(),E=new Set;return v?(v.forEach(P=>{const x=Math.min(P.from.row,P.to.row),_=Math.max(P.from.row,P.to.row);for(let M=x;M<=_;M++)M!==-1&&E.add(M)}),Array.from(E).sort((P,x)=>P-x)):[]}function w(){const v=s.countCols(),E=s.getPlugin("hiddenColumns");let P=0;for(let _=0;_<v;_++)E.isHidden(_)||P++;return f().length===P}function C(){return s.countRows()===g().length}async function S(v,E){const P=v.map((O,G)=>G).sort((O,G)=>v[O]-v[G]);v.splice(0,v.length,...P.map(O=>v[O])),E.splice(0,E.length,...P.map(O=>E[O]));const _=(await Xt.get(`https://osu.xywork.top/?ids=${v.join(",")}`)).data.beatmaps.map(O=>e(O)),M=[];let V=0,z=0;for(;V<E.length&&z<_.length;)if(i.value[E[V]][1]==_[z][1]){for(let O=0;O<_[z].length;O++)i.value[E[V]][O]=_[z][O];a.value[E[V]]="success",V++,z++}else M.push(E[V]+1),a.value[E[V]]="failed",V++;s.render()}return bc(()=>{if(o.value){s=o.value.hotInstance;const v=s.getPlugin("hiddenColumns"),E=r().reduce((P,x,_)=>x?P:[...P,_],[]);v.hideColumns(E),s.render()}}),(v,E)=>(Fn(),To("div",Zme,[Ni(pe(v_),{class:"handsontable",ref_key:"hotTable",ref:o,settings:d,width:"100%",height:"500"},null,512),Ni(yge,{modelValue:l.value,"onUpdate:modelValue":E[0]||(E[0]=P=>l.value=P),initialColHeaders:pe(n)(),hot:pe(s),onSelected:c},null,8,["modelValue","initialColHeaders","hot"])]))}};export{Npe as default};
