import{g as bm,i as hl,c as ei,u as pe,a as RV,r as en,b as Zu,d as EN,e as EV,f as TV,o as cc,h as bp,j as U_,_ as Hd,k as ki,l as Nn,w as Qs,n as NS,m as _V,p as TN,q as Nd,s as hd,t as Ju,v as Dn,T as MV,x as DR,y as Sp,z as wo,A as Qu,B as dl,C as Ar,D as Sm,E as Rm,F as kR,N as Mw,G as Ii,H as IV,I as PV,J as OV,K as DS,L as xV,M as gr,O as AV,P as HV,Q as _N,R as NV,S as z_,U as DV,V as kV,W as LV,X as $V,Y as FV,Z as VV,$ as Y_,a0 as WV,a1 as BV,a2 as jV,a3 as UV,a4 as zV,a5 as YV,a6 as GV,a7 as qV,a8 as KV,a9 as XV,aa as ZV,ab as JV,ac as QV}from"./index-Cv5MohuD.js";var eW=typeof global=="object"&&global&&global.Object===Object&&global,tW=typeof self=="object"&&self&&self.Object===Object&&self,LR=eW||tW||Function("return this")(),ec=LR.Symbol,MN=Object.prototype,nW=MN.hasOwnProperty,rW=MN.toString,Oc=ec?ec.toStringTag:void 0;function iW(t){var e=nW.call(t,Oc),n=t[Oc];try{t[Oc]=void 0;var r=!0}catch{}var i=rW.call(t);return r&&(e?t[Oc]=n:delete t[Oc]),i}var oW=Object.prototype,sW=oW.toString;function aW(t){return sW.call(t)}var lW="[object Null]",uW="[object Undefined]",G_=ec?ec.toStringTag:void 0;function IN(t){return t==null?t===void 0?uW:lW:G_&&G_ in Object(t)?iW(t):aW(t)}function cW(t){return t!=null&&typeof t=="object"}var hW="[object Symbol]";function $R(t){return typeof t=="symbol"||cW(t)&&IN(t)==hW}function dW(t,e){for(var n=-1,r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var FR=Array.isArray,q_=ec?ec.prototype:void 0,K_=q_?q_.toString:void 0;function PN(t){if(typeof t=="string")return t;if(FR(t))return dW(t,PN)+"";if($R(t))return K_?K_.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function ON(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var fW="[object AsyncFunction]",gW="[object Function]",mW="[object GeneratorFunction]",pW="[object Proxy]";function wW(t){if(!ON(t))return!1;var e=IN(t);return e==gW||e==mW||e==fW||e==pW}var Iw=LR["__core-js_shared__"],X_=function(){var t=/[^.]+$/.exec(Iw&&Iw.keys&&Iw.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function vW(t){return!!X_&&X_ in t}var CW=Function.prototype,yW=CW.toString;function bW(t){if(t!=null){try{return yW.call(t)}catch{}try{return t+""}catch{}}return""}var SW=/[\\^$.*+?()[\]{}|]/g,RW=/^\[object .+?Constructor\]$/,EW=Function.prototype,TW=Object.prototype,_W=EW.toString,MW=TW.hasOwnProperty,IW=RegExp("^"+_W.call(MW).replace(SW,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function PW(t){if(!ON(t)||vW(t))return!1;var e=wW(t)?IW:RW;return e.test(bW(t))}function OW(t,e){return t?.[e]}function xN(t,e){var n=OW(t,e);return PW(n)?n:void 0}function xW(t,e){return t===e||t!==t&&e!==e}var AW=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,HW=/^\w*$/;function NW(t,e){if(FR(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||$R(t)?!0:HW.test(t)||!AW.test(t)||e!=null&&t in Object(e)}var dd=xN(Object,"create");function DW(){this.__data__=dd?dd(null):{},this.size=0}function kW(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var LW="__lodash_hash_undefined__",$W=Object.prototype,FW=$W.hasOwnProperty;function VW(t){var e=this.__data__;if(dd){var n=e[t];return n===LW?void 0:n}return FW.call(e,t)?e[t]:void 0}var WW=Object.prototype,BW=WW.hasOwnProperty;function jW(t){var e=this.__data__;return dd?e[t]!==void 0:BW.call(e,t)}var UW="__lodash_hash_undefined__";function zW(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=dd&&e===void 0?UW:e,this}function pl(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}pl.prototype.clear=DW;pl.prototype.delete=kW;pl.prototype.get=VW;pl.prototype.has=jW;pl.prototype.set=zW;function YW(){this.__data__=[],this.size=0}function Rp(t,e){for(var n=t.length;n--;)if(xW(t[n][0],e))return n;return-1}var GW=Array.prototype,qW=GW.splice;function KW(t){var e=this.__data__,n=Rp(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():qW.call(e,n,1),--this.size,!0}function XW(t){var e=this.__data__,n=Rp(e,t);return n<0?void 0:e[n][1]}function ZW(t){return Rp(this.__data__,t)>-1}function JW(t,e){var n=this.__data__,r=Rp(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function hc(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}hc.prototype.clear=YW;hc.prototype.delete=KW;hc.prototype.get=XW;hc.prototype.has=ZW;hc.prototype.set=JW;var QW=xN(LR,"Map");function eB(){this.size=0,this.__data__={hash:new pl,map:new(QW||hc),string:new pl}}function tB(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Ep(t,e){var n=t.__data__;return tB(e)?n[typeof e=="string"?"string":"hash"]:n.map}function nB(t){var e=Ep(this,t).delete(t);return this.size-=e?1:0,e}function rB(t){return Ep(this,t).get(t)}function iB(t){return Ep(this,t).has(t)}function oB(t,e){var n=Ep(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function Ml(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Ml.prototype.clear=eB;Ml.prototype.delete=nB;Ml.prototype.get=rB;Ml.prototype.has=iB;Ml.prototype.set=oB;var sB="Expected a function";function VR(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(sB);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(VR.Cache||Ml),n}VR.Cache=Ml;var aB=500;function lB(t){var e=VR(t,function(r){return n.size===aB&&n.clear(),r}),n=e.cache;return e}var uB=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,cB=/\\(\\)?/g,hB=lB(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(uB,function(n,r,i,o){e.push(i?o.replace(cB,"$1"):r||n)}),e});function dB(t){return t==null?"":PN(t)}function fB(t,e){return FR(t)?t:NW(t,e)?[t]:hB(dB(t))}function gB(t){if(typeof t=="string"||$R(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function mB(t,e){e=fB(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[gB(e[n++])];return n&&n==r?t:void 0}function pB(t,e,n){var r=t==null?void 0:mB(t,e);return r===void 0?n:r}function wB(t){return t==null}class vB extends Error{constructor(e){super(e),this.name="ElementPlusError"}}function CB(t,e){throw new vB(`[${t}] ${e}`)}const Z_={current:0},J_=en(0),yB=2e3,Q_=Symbol("elZIndexContextKey"),bB=Symbol("zIndexContextKey"),SB=t=>{const e=bm()?hl(Q_,Z_):Z_,n=bm()?hl(bB,void 0):void 0,r=ei(()=>{const s=pe(n);return RV(s)?s:yB}),i=ei(()=>r.value+J_.value),o=()=>(e.current++,J_.value=e.current,i.value);return!Zu&&hl(Q_),{initialZIndex:r,currentZIndex:i,nextZIndex:o}};var RB={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const EB=t=>(e,n)=>TB(e,n,pe(t)),TB=(t,e,n)=>pB(n,t,t).replace(/\{(\w+)\}/g,(r,i)=>{var o;return`${(o=e?.[i])!=null?o:`{${i}}`}`}),_B=t=>{const e=ei(()=>pe(t).name),n=EN(t)?t:en(t);return{lang:e,locale:n,t:EB(t)}},MB=Symbol("localeContextKey"),IB=t=>{const e=hl(MB,en());return _B(ei(()=>e.value||RB))},AN="update:modelValue";let hf;const PB=t=>{var e;if(!Zu)return 0;if(hf!==void 0)return hf;const n=document.createElement("div");n.className=`${t}-scrollbar__wrap`,n.style.visibility="hidden",n.style.width="100px",n.style.position="absolute",n.style.top="-9999px",document.body.appendChild(n);const r=n.offsetWidth;n.style.overflow="scroll";const i=document.createElement("div");i.style.width="100%",n.appendChild(i);const o=i.offsetWidth;return(e=n.parentNode)==null||e.removeChild(n),hf=r-o,hf},eM={prefix:Math.floor(Math.random()*1e4),current:0},OB=Symbol("elIdInjection"),xB=()=>bm()?hl(OB,eM):eM,tM=t=>{const e=xB(),n=EV();return TV(()=>pe(t)||`${n.value}-id-${e.prefix}-${e.current++}`)},AB=t=>{if(t.tabIndex>0||t.tabIndex===0&&t.getAttribute("tabIndex")!==null)return!0;if(t.tabIndex<0||t.hasAttribute("disabled")||t.getAttribute("aria-disabled")==="true")return!1;switch(t.nodeName){case"A":return!!t.href&&t.rel!=="ignore";case"INPUT":return!(t.type==="hidden"||t.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},Pw="focus-trap.focus-after-trapped",Ow="focus-trap.focus-after-released",HB="focus-trap.focusout-prevented",nM={cancelable:!0,bubbles:!1},NB={cancelable:!0,bubbles:!1},rM="focusAfterTrapped",iM="focusAfterReleased",HN=Symbol("elFocusTrap"),WR=en(),Tp=en(0),BR=en(0);let df=0;const NN=t=>{const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0||r===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e},oM=(t,e)=>{for(const n of t)if(!DB(n,e))return n},DB=(t,e)=>{if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1},kB=t=>{const e=NN(t),n=oM(e,t),r=oM(e.reverse(),t);return[n,r]},LB=t=>t instanceof HTMLInputElement&&"select"in t,Ds=(t,e)=>{if(t&&t.focus){const n=document.activeElement;let r=!1;U_(t)&&!AB(t)&&!t.getAttribute("tabindex")&&(t.setAttribute("tabindex","-1"),r=!0),t.focus({preventScroll:!0}),BR.value=window.performance.now(),t!==n&&LB(t)&&e&&t.select(),U_(t)&&r&&t.removeAttribute("tabindex")}};function sM(t,e){const n=[...t],r=t.indexOf(e);return r!==-1&&n.splice(r,1),n}const $B=()=>{let t=[];return{push:r=>{const i=t[0];i&&r!==i&&i.pause(),t=sM(t,r),t.unshift(r)},remove:r=>{var i,o;t=sM(t,r),(o=(i=t[0])==null?void 0:i.resume)==null||o.call(i)}}},FB=(t,e=!1)=>{const n=document.activeElement;for(const r of t)if(Ds(r,e),document.activeElement!==n)return},aM=$B(),VB=()=>Tp.value>BR.value,ff=()=>{WR.value="pointer",Tp.value=window.performance.now()},lM=()=>{WR.value="keyboard",Tp.value=window.performance.now()},WB=()=>(cc(()=>{df===0&&(document.addEventListener("mousedown",ff),document.addEventListener("touchstart",ff),document.addEventListener("keydown",lM)),df++}),bp(()=>{df--,df<=0&&(document.removeEventListener("mousedown",ff),document.removeEventListener("touchstart",ff),document.removeEventListener("keydown",lM))}),{focusReason:WR,lastUserFocusTimestamp:Tp,lastAutomatedFocusTimestamp:BR}),gf=t=>new CustomEvent(HB,{...NB,detail:t}),DN={tab:"Tab",esc:"Escape"};let Tu=[];const uM=t=>{t.code===DN.esc&&Tu.forEach(e=>e(t))},BB=t=>{cc(()=>{Tu.length===0&&document.addEventListener("keydown",uM),Zu&&Tu.push(t)}),bp(()=>{Tu=Tu.filter(e=>e!==t),Tu.length===0&&Zu&&document.removeEventListener("keydown",uM)})},jB=ki({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[rM,iM,"focusin","focusout","focusout-prevented","release-requested"],setup(t,{emit:e}){const n=en();let r,i;const{focusReason:o}=WB();BB(g=>{t.trapped&&!s.paused&&e("release-requested",g)});const s={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},a=g=>{if(!t.loop&&!t.trapped||s.paused)return;const{code:w,altKey:C,ctrlKey:S,metaKey:v,currentTarget:T,shiftKey:M}=g,{loop:x}=t,I=w===DN.tab&&!C&&!S&&!v,P=document.activeElement;if(I&&P){const U=T,[K,N]=kB(U);if(K&&N){if(!M&&P===N){const X=gf({focusReason:o.value});e("focusout-prevented",X),X.defaultPrevented||(g.preventDefault(),x&&Ds(K,!0))}else if(M&&[K,U].includes(P)){const X=gf({focusReason:o.value});e("focusout-prevented",X),X.defaultPrevented||(g.preventDefault(),x&&Ds(N,!0))}}else if(P===U){const X=gf({focusReason:o.value});e("focusout-prevented",X),X.defaultPrevented||g.preventDefault()}}};TN(HN,{focusTrapRef:n,onKeydown:a}),Qs(()=>t.focusTrapEl,g=>{g&&(n.value=g)},{immediate:!0}),Qs([n],([g],[w])=>{g&&(g.addEventListener("keydown",a),g.addEventListener("focusin",c),g.addEventListener("focusout",h)),w&&(w.removeEventListener("keydown",a),w.removeEventListener("focusin",c),w.removeEventListener("focusout",h))});const l=g=>{e(rM,g)},u=g=>e(iM,g),c=g=>{const w=pe(n);if(!w)return;const C=g.target,S=g.relatedTarget,v=C&&w.contains(C);t.trapped||S&&w.contains(S)||(r=S),v&&e("focusin",g),!s.paused&&t.trapped&&(v?i=C:Ds(i,!0))},h=g=>{const w=pe(n);if(!(s.paused||!w))if(t.trapped){const C=g.relatedTarget;!wB(C)&&!w.contains(C)&&setTimeout(()=>{if(!s.paused&&t.trapped){const S=gf({focusReason:o.value});e("focusout-prevented",S),S.defaultPrevented||Ds(i,!0)}},0)}else{const C=g.target;C&&w.contains(C)||e("focusout",g)}};async function d(){await NS();const g=pe(n);if(g){aM.push(s);const w=g.contains(document.activeElement)?r:document.activeElement;if(r=w,!g.contains(w)){const S=new Event(Pw,nM);g.addEventListener(Pw,l),g.dispatchEvent(S),S.defaultPrevented||NS(()=>{let v=t.focusStartEl;_V(v)||(Ds(v),document.activeElement!==v&&(v="first")),v==="first"&&FB(NN(g),!0),(document.activeElement===w||v==="container")&&Ds(g)})}}}function f(){const g=pe(n);if(g){g.removeEventListener(Pw,l);const w=new CustomEvent(Ow,{...nM,detail:{focusReason:o.value}});g.addEventListener(Ow,u),g.dispatchEvent(w),!w.defaultPrevented&&(o.value=="keyboard"||!VB()||g.contains(document.activeElement))&&Ds(r??document.body),g.removeEventListener(Ow,u),aM.remove(s)}}return cc(()=>{t.trapped&&d(),Qs(()=>t.trapped,g=>{g?d():f()})}),bp(()=>{t.trapped&&f(),n.value&&(n.value.removeEventListener("keydown",a),n.value.removeEventListener("focusin",c),n.value.removeEventListener("focusout",h),n.value=void 0)}),{onKeydown:a}}});function UB(t,e,n,r,i,o){return Nn(t.$slots,"default",{handleKeydown:t.onKeydown})}var zB=Hd(jB,[["render",UB],["__file","focus-trap.vue"]]);const kN=Nd({to:{type:hd([String,Object]),required:!0},disabled:Boolean}),YB=ki({__name:"teleport",props:kN,setup(t){return(e,n)=>e.disabled?Nn(e.$slots,"default",{key:0}):(Dn(),Ju(MV,{key:1,to:e.to},[Nn(e.$slots,"default")],8,["to"]))}});var GB=Hd(YB,[["__file","teleport.vue"]]);const qB=DR(GB);var cM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};const KB=Nd({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:hd([String,Object,Array]),default:""},headerClass:String,bodyClass:String,footerClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),XB=ki({name:"ElCard"}),ZB=ki({...XB,props:KB,setup(t){const e=Sp("card");return(n,r)=>(Dn(),wo("div",{class:Ar([pe(e).b(),pe(e).is(`${n.shadow}-shadow`)])},[n.$slots.header||n.header?(Dn(),wo("div",{key:0,class:Ar([pe(e).e("header"),n.headerClass])},[Nn(n.$slots,"header",{},()=>[Sm(Rm(n.header),1)])],2)):Qu("v-if",!0),dl("div",{class:Ar([pe(e).e("body"),n.bodyClass]),style:kR(n.bodyStyle)},[Nn(n.$slots,"default")],6),n.$slots.footer||n.footer?(Dn(),wo("div",{key:1,class:Ar([pe(e).e("footer"),n.footerClass])},[Nn(n.$slots,"footer",{},()=>[Sm(Rm(n.footer),1)])],2)):Qu("v-if",!0)],2))}});var JB=Hd(ZB,[["__file","card.vue"]]);const QB=DR(JB);var Jg=(t=>(t[t.TEXT=1]="TEXT",t[t.CLASS=2]="CLASS",t[t.STYLE=4]="STYLE",t[t.PROPS=8]="PROPS",t[t.FULL_PROPS=16]="FULL_PROPS",t[t.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",t[t.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",t[t.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",t[t.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",t[t.NEED_PATCH=512]="NEED_PATCH",t[t.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",t[t.HOISTED=-1]="HOISTED",t[t.BAIL=-2]="BAIL",t))(Jg||{});const LN=t=>{if(!t)return{onClick:Mw,onMousedown:Mw,onMouseup:Mw};let e=!1,n=!1;return{onClick:s=>{e&&n&&t(s),e=n=!1},onMousedown:s=>{e=s.target===s.currentTarget},onMouseup:s=>{n=s.target===s.currentTarget}}},ej=Nd({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:hd([String,Array,Object])},zIndex:{type:hd([String,Number])}}),tj={click:t=>t instanceof MouseEvent},nj="overlay";var rj=ki({name:"ElOverlay",props:ej,emits:tj,setup(t,{slots:e,emit:n}){const r=Sp(nj),i=l=>{n("click",l)},{onClick:o,onMousedown:s,onMouseup:a}=LN(t.customMaskEvent?void 0:i);return()=>t.mask?Ii("div",{class:[r.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:o,onMousedown:s,onMouseup:a},[Nn(e,"default")],Jg.STYLE|Jg.CLASS|Jg.PROPS,["onClick","onMouseup","onMousedown"]):IV("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[Nn(e,"default")])}});const ij=rj,$N=Symbol("dialogInjectionKey"),FN=Nd({center:Boolean,alignCenter:Boolean,closeIcon:{type:PV},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,headerClass:String,bodyClass:String,footerClass:String,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),oj={close:()=>!0},sj=(t,e,n,r)=>{const i={offsetX:0,offsetY:0},o=(h,d)=>{if(t.value){const{offsetX:f,offsetY:g}=i,w=t.value.getBoundingClientRect(),C=w.left,S=w.top,v=w.width,T=w.height,M=document.documentElement.clientWidth,x=document.documentElement.clientHeight,I=-C+f,P=-S+g,U=M-C-v+f,K=x-S-(T<x?T:0)+g;r?.value||(h=Math.min(Math.max(h,I),U),d=Math.min(Math.max(d,P),K)),i.offsetX=h,i.offsetY=d,t.value.style.transform=`translate(${DS(h)}, ${DS(d)})`}},s=h=>{const d=h.clientX,f=h.clientY,{offsetX:g,offsetY:w}=i,C=v=>{const T=g+v.clientX-d,M=w+v.clientY-f;o(T,M)},S=()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",S)};document.addEventListener("mousemove",C),document.addEventListener("mouseup",S)},a=()=>{e.value&&t.value&&(e.value.addEventListener("mousedown",s),window.addEventListener("resize",c))},l=()=>{e.value&&t.value&&(e.value.removeEventListener("mousedown",s),window.removeEventListener("resize",c))},u=()=>{i.offsetX=0,i.offsetY=0,t.value&&(t.value.style.transform="")},c=()=>{const{offsetX:h,offsetY:d}=i;o(h,d)};return cc(()=>{OV(()=>{n.value?a():l()})}),bp(()=>{l()}),{resetPosition:u,updatePosition:c}},aj=(...t)=>e=>{t.forEach(n=>{xV(n)?n(e):n.value=e})},lj=ki({name:"ElDialogContent"}),uj=ki({...lj,props:FN,emits:oj,setup(t,{expose:e}){const n=t,{t:r}=IB(),{Close:i}=HV,{dialogRef:o,headerRef:s,bodyId:a,ns:l,style:u}=hl($N),{focusTrapRef:c}=hl(HN),h=ei(()=>[l.b(),l.is("fullscreen",n.fullscreen),l.is("draggable",n.draggable),l.is("align-center",n.alignCenter),{[l.m("center")]:n.center}]),d=aj(c,o),f=ei(()=>n.draggable),g=ei(()=>n.overflow),{resetPosition:w,updatePosition:C}=sj(o,s,f,g);return e({resetPosition:w,updatePosition:C}),(S,v)=>(Dn(),wo("div",{ref:pe(d),class:Ar(pe(h)),style:kR(pe(u)),tabindex:"-1"},[dl("header",{ref_key:"headerRef",ref:s,class:Ar([pe(l).e("header"),S.headerClass,{"show-close":S.showClose}])},[Nn(S.$slots,"header",{},()=>[dl("span",{role:"heading","aria-level":S.ariaLevel,class:Ar(pe(l).e("title"))},Rm(S.title),11,["aria-level"])]),S.showClose?(Dn(),wo("button",{key:0,"aria-label":pe(r)("el.dialog.close"),class:Ar(pe(l).e("headerbtn")),type:"button",onClick:T=>S.$emit("close")},[Ii(pe(_N),{class:Ar(pe(l).e("close"))},{default:gr(()=>[(Dn(),Ju(AV(S.closeIcon||pe(i))))]),_:1},8,["class"])],10,["aria-label","onClick"])):Qu("v-if",!0)],2),dl("div",{id:pe(a),class:Ar([pe(l).e("body"),S.bodyClass])},[Nn(S.$slots,"default")],10,["id"]),S.$slots.footer?(Dn(),wo("footer",{key:0,class:Ar([pe(l).e("footer"),S.footerClass])},[Nn(S.$slots,"footer")],2)):Qu("v-if",!0)],6))}});var cj=Hd(uj,[["__file","dialog-content.vue"]]);const hj=Nd({...FN,appendToBody:Boolean,appendTo:{type:kN.to.type,default:"body"},beforeClose:{type:hd(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,headerClass:String,bodyClass:String,footerClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),dj={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[AN]:t=>NV(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},fj=(t,e={})=>{EN(t)||CB("[useLockscreen]","You need to pass a ref param to this function");const n=e.ns||Sp("popup"),r=ei(()=>n.bm("parent","hidden"));if(!Zu||z_(document.body,r.value))return;let i=0,o=!1,s="0";const a=()=>{setTimeout(()=>{typeof document>"u"||o&&document&&(document.body.style.width=s,$V(document.body,r.value))},200)};Qs(t,l=>{if(!l){a();return}o=!z_(document.body,r.value),o&&(s=document.body.style.width,DV(document.body,r.value)),i=PB(n.namespace.value);const u=document.documentElement.clientHeight<document.body.scrollHeight,c=kV(document.body,"overflowY");i>0&&(u||c==="scroll")&&o&&(document.body.style.width=`calc(100% - ${i}px)`)}),LV(()=>a())},gj=(t,e)=>{var n;const i=bm().emit,{nextZIndex:o}=SB();let s="";const a=tM(),l=tM(),u=en(!1),c=en(!1),h=en(!1),d=en((n=t.zIndex)!=null?n:o());let f,g;const w=FV("namespace",VV),C=ei(()=>{const te={},Le=`--${w.value}-dialog`;return t.fullscreen||(t.top&&(te[`${Le}-margin-top`]=t.top),t.width&&(te[`${Le}-width`]=DS(t.width))),te}),S=ei(()=>t.alignCenter?{display:"flex"}:{});function v(){i("opened")}function T(){i("closed"),i(AN,!1),t.destroyOnClose&&(h.value=!1)}function M(){i("close")}function x(){g?.(),f?.(),t.openDelay&&t.openDelay>0?{stop:f}=Y_(()=>K(),t.openDelay):K()}function I(){f?.(),g?.(),t.closeDelay&&t.closeDelay>0?{stop:g}=Y_(()=>N(),t.closeDelay):N()}function P(){function te(Le){Le||(c.value=!0,u.value=!1)}t.beforeClose?t.beforeClose(te):I()}function U(){t.closeOnClickModal&&P()}function K(){Zu&&(u.value=!0)}function N(){u.value=!1}function Y(){i("openAutoFocus")}function X(){i("closeAutoFocus")}function se(te){var Le;((Le=te.detail)==null?void 0:Le.focusReason)==="pointer"&&te.preventDefault()}t.lockScroll&&fj(u);function ee(){t.closeOnPressEscape&&P()}return Qs(()=>t.zIndex,()=>{var te;d.value=(te=t.zIndex)!=null?te:o()}),Qs(()=>t.modelValue,te=>{var Le;te?(c.value=!1,x(),h.value=!0,d.value=(Le=t.zIndex)!=null?Le:o(),NS(()=>{i("open"),e.value&&(e.value.parentElement.scrollTop=0,e.value.parentElement.scrollLeft=0,e.value.scrollTop=0)})):u.value&&I()}),Qs(()=>t.fullscreen,te=>{e.value&&(te?(s=e.value.style.transform,e.value.style.transform=""):e.value.style.transform=s)}),cc(()=>{t.modelValue&&(u.value=!0,h.value=!0,x())}),{afterEnter:v,afterLeave:T,beforeLeave:M,handleClose:P,onModalClick:U,close:I,doClose:N,onOpenAutoFocus:Y,onCloseAutoFocus:X,onCloseRequested:ee,onFocusoutPrevented:se,titleId:a,bodyId:l,closed:c,style:C,overlayDialogStyle:S,rendered:h,visible:u,zIndex:d}},mj=ki({name:"ElDialog",inheritAttrs:!1}),pj=ki({...mj,props:hj,emits:dj,setup(t,{expose:e}){const n=t,r=WV();BV({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},ei(()=>!!r.title));const i=Sp("dialog"),o=en(),s=en(),a=en(),{visible:l,titleId:u,bodyId:c,style:h,overlayDialogStyle:d,rendered:f,zIndex:g,afterEnter:w,afterLeave:C,beforeLeave:S,handleClose:v,onModalClick:T,onOpenAutoFocus:M,onCloseAutoFocus:x,onCloseRequested:I,onFocusoutPrevented:P}=gj(n,o);TN($N,{dialogRef:o,headerRef:s,bodyId:c,ns:i,rendered:f,style:h});const U=LN(T),K=ei(()=>n.draggable&&!n.fullscreen);return e({visible:l,dialogContentRef:a,resetPosition:()=>{var Y;(Y=a.value)==null||Y.resetPosition()},handleClose:v}),(Y,X)=>(Dn(),Ju(pe(qB),{to:Y.appendTo,disabled:Y.appendTo!=="body"?!1:!Y.appendToBody},{default:gr(()=>[Ii(jV,{name:"dialog-fade",onAfterEnter:pe(w),onAfterLeave:pe(C),onBeforeLeave:pe(S),persisted:""},{default:gr(()=>[UV(Ii(pe(ij),{"custom-mask-event":"",mask:Y.modal,"overlay-class":Y.modalClass,"z-index":pe(g)},{default:gr(()=>[dl("div",{role:"dialog","aria-modal":"true","aria-label":Y.title||void 0,"aria-labelledby":Y.title?void 0:pe(u),"aria-describedby":pe(c),class:Ar(`${pe(i).namespace.value}-overlay-dialog`),style:kR(pe(d)),onClick:pe(U).onClick,onMousedown:pe(U).onMousedown,onMouseup:pe(U).onMouseup},[Ii(pe(zB),{loop:"",trapped:pe(l),"focus-start-el":"container",onFocusAfterTrapped:pe(M),onFocusAfterReleased:pe(x),onFocusoutPrevented:pe(P),onReleaseRequested:pe(I)},{default:gr(()=>[pe(f)?(Dn(),Ju(cj,zV({key:0,ref_key:"dialogContentRef",ref:a},Y.$attrs,{center:Y.center,"align-center":Y.alignCenter,"close-icon":Y.closeIcon,draggable:pe(K),overflow:Y.overflow,fullscreen:Y.fullscreen,"header-class":Y.headerClass,"body-class":Y.bodyClass,"footer-class":Y.footerClass,"show-close":Y.showClose,title:Y.title,"aria-level":Y.headerAriaLevel,onClose:pe(v)}),YV({header:gr(()=>[Y.$slots.title?Nn(Y.$slots,"title",{key:1}):Nn(Y.$slots,"header",{key:0,close:pe(v),titleId:pe(u),titleClass:pe(i).e("title")})]),default:gr(()=>[Nn(Y.$slots,"default")]),_:2},[Y.$slots.footer?{name:"footer",fn:gr(()=>[Nn(Y.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","header-class","body-class","footer-class","show-close","title","aria-level","onClose"])):Qu("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[GV,pe(l)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var wj=Hd(pj,[["__file","dialog.vue"]]);const vj=DR(wj);var hM={},xc,dM;function Gt(){if(dM)return xc;dM=1;var t=function(e){return e&&e.Math===Math&&e};return xc=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof cM=="object"&&cM)||t(typeof xc=="object"&&xc)||function(){return this}()||Function("return this")(),xc}var xw={},Aw,fM;function rn(){return fM||(fM=1,Aw=function(t){try{return!!t()}catch{return!0}}),Aw}var Hw,gM;function ri(){if(gM)return Hw;gM=1;var t=rn();return Hw=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Hw}var Nw,mM;function _p(){if(mM)return Nw;mM=1;var t=rn();return Nw=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Nw}var Dw,pM;function on(){if(pM)return Dw;pM=1;var t=_p(),e=Function.prototype.call;return Dw=t?e.bind(e):function(){return e.apply(e,arguments)},Dw}var kw={},wM;function Cj(){if(wM)return kw;wM=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return kw.f=n?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,kw}var Lw,vM;function Mp(){return vM||(vM=1,Lw=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),Lw}var $w,CM;function qt(){if(CM)return $w;CM=1;var t=_p(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return $w=t?r:function(i){return function(){return n.apply(i,arguments)}},$w}var Fw,yM;function Il(){if(yM)return Fw;yM=1;var t=qt(),e=t({}.toString),n=t("".slice);return Fw=function(r){return n(e(r),8,-1)},Fw}var Vw,bM;function yj(){if(bM)return Vw;bM=1;var t=qt(),e=rn(),n=Il(),r=Object,i=t("".split);return Vw=e(function(){return!r("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?i(o,""):r(o)}:r,Vw}var Ww,SM;function jR(){return SM||(SM=1,Ww=function(t){return t==null}),Ww}var Bw,RM;function Dd(){if(RM)return Bw;RM=1;var t=jR(),e=TypeError;return Bw=function(n){if(t(n))throw new e("Can't call method on "+n);return n},Bw}var jw,EM;function kd(){if(EM)return jw;EM=1;var t=yj(),e=Dd();return jw=function(n){return t(e(n))},jw}var Uw,TM;function sn(){if(TM)return Uw;TM=1;var t=typeof document=="object"&&document.all;return Uw=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},Uw}var zw,_M;function ii(){if(_M)return zw;_M=1;var t=sn();return zw=function(e){return typeof e=="object"?e!==null:t(e)},zw}var Yw,MM;function dc(){if(MM)return Yw;MM=1;var t=Gt(),e=sn(),n=function(r){return e(r)?r:void 0};return Yw=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},Yw}var Gw,IM;function Ld(){if(IM)return Gw;IM=1;var t=qt();return Gw=t({}.isPrototypeOf),Gw}var qw,PM;function Ip(){if(PM)return qw;PM=1;var t=Gt(),e=t.navigator,n=e&&e.userAgent;return qw=n?String(n):"",qw}var Kw,OM;function bj(){if(OM)return Kw;OM=1;var t=Gt(),e=Ip(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),Kw=a,Kw}var Xw,xM;function UR(){if(xM)return Xw;xM=1;var t=bj(),e=rn(),n=Gt(),r=n.String;return Xw=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Xw}var Zw,AM;function VN(){if(AM)return Zw;AM=1;var t=UR();return Zw=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Zw}var Jw,HM;function zR(){if(HM)return Jw;HM=1;var t=dc(),e=sn(),n=Ld(),r=VN(),i=Object;return Jw=r?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&n(s.prototype,i(o))},Jw}var Qw,NM;function Pp(){if(NM)return Qw;NM=1;var t=String;return Qw=function(e){try{return t(e)}catch{return"Object"}},Qw}var ev,DM;function pr(){if(DM)return ev;DM=1;var t=sn(),e=Pp(),n=TypeError;return ev=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},ev}var tv,kM;function $d(){if(kM)return tv;kM=1;var t=pr(),e=jR();return tv=function(n,r){var i=n[r];return e(i)?void 0:t(i)},tv}var nv,LM;function Sj(){if(LM)return nv;LM=1;var t=on(),e=sn(),n=ii(),r=TypeError;return nv=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!n(a=t(s,i))||e(s=i.valueOf)&&!n(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!n(a=t(s,i)))return a;throw new r("Can't convert object to primitive value")},nv}var rv={exports:{}},iv,$M;function sa(){return $M||($M=1,iv=!1),iv}var ov,FM;function YR(){if(FM)return ov;FM=1;var t=Gt(),e=Object.defineProperty;return ov=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},ov}var VM;function GR(){if(VM)return rv.exports;VM=1;var t=sa(),e=Gt(),n=YR(),r="__core-js_shared__",i=rv.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.44.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"}),rv.exports}var sv,WM;function WN(){if(WM)return sv;WM=1;var t=GR();return sv=function(e,n){return t[e]||(t[e]=n||{})},sv}var av,BM;function fc(){if(BM)return av;BM=1;var t=Dd(),e=Object;return av=function(n){return e(t(n))},av}var lv,jM;function oi(){if(jM)return lv;jM=1;var t=qt(),e=fc(),n=t({}.hasOwnProperty);return lv=Object.hasOwn||function(i,o){return n(e(i),o)},lv}var uv,UM;function BN(){if(UM)return uv;UM=1;var t=qt(),e=0,n=Math.random(),r=t(1.1.toString);return uv=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},uv}var cv,zM;function Li(){if(zM)return cv;zM=1;var t=Gt(),e=WN(),n=oi(),r=BN(),i=UR(),o=VN(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||r;return cv=function(u){return n(a,u)||(a[u]=i&&n(s,u)?s[u]:l("Symbol."+u)),a[u]},cv}var hv,YM;function Rj(){if(YM)return hv;YM=1;var t=on(),e=ii(),n=zR(),r=$d(),i=Sj(),o=Li(),s=TypeError,a=o("toPrimitive");return hv=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},hv}var dv,GM;function jN(){if(GM)return dv;GM=1;var t=Rj(),e=zR();return dv=function(n){var r=t(n,"string");return e(r)?r:r+""},dv}var fv,qM;function qR(){if(qM)return fv;qM=1;var t=Gt(),e=ii(),n=t.document,r=e(n)&&e(n.createElement);return fv=function(i){return r?n.createElement(i):{}},fv}var gv,KM;function UN(){if(KM)return gv;KM=1;var t=ri(),e=rn(),n=qR();return gv=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),gv}var XM;function zN(){if(XM)return xw;XM=1;var t=ri(),e=on(),n=Cj(),r=Mp(),i=kd(),o=jN(),s=oi(),a=UN(),l=Object.getOwnPropertyDescriptor;return xw.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return r(!e(n.f,c,h),c[h])},xw}var mv={},pv,ZM;function YN(){if(ZM)return pv;ZM=1;var t=ri(),e=rn();return pv=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),pv}var wv,JM;function an(){if(JM)return wv;JM=1;var t=ii(),e=String,n=TypeError;return wv=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},wv}var QM;function aa(){if(QM)return mv;QM=1;var t=ri(),e=UN(),n=YN(),r=an(),i=jN(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return mv.f=t?n?function(d,f,g){if(r(d),f=i(f),r(g),typeof d=="function"&&f==="prototype"&&"value"in g&&c in g&&!g[c]){var w=a(d,f);w&&w[c]&&(d[f]=g.value,g={configurable:u in g?g[u]:w[u],enumerable:l in g?g[l]:w[l],writable:!1})}return s(d,f,g)}:s:function(d,f,g){if(r(d),f=i(f),r(g),e)try{return s(d,f,g)}catch{}if("get"in g||"set"in g)throw new o("Accessors not supported");return"value"in g&&(d[f]=g.value),d},mv}var vv,eI;function gc(){if(eI)return vv;eI=1;var t=ri(),e=aa(),n=Mp();return vv=t?function(r,i,o){return e.f(r,i,n(1,o))}:function(r,i,o){return r[i]=o,r},vv}var Cv={exports:{}},yv,tI;function Ej(){if(tI)return yv;tI=1;var t=ri(),e=oi(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&r(n,"name").configurable);return yv={EXISTS:i,PROPER:o,CONFIGURABLE:s},yv}var bv,nI;function Tj(){if(nI)return bv;nI=1;var t=qt(),e=sn(),n=GR(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),bv=n.inspectSource,bv}var Sv,rI;function _j(){if(rI)return Sv;rI=1;var t=Gt(),e=sn(),n=t.WeakMap;return Sv=e(n)&&/native code/.test(String(n)),Sv}var Rv,iI;function KR(){if(iI)return Rv;iI=1;var t=WN(),e=BN(),n=t("keys");return Rv=function(r){return n[r]||(n[r]=e(r))},Rv}var Ev,oI;function XR(){return oI||(oI=1,Ev={}),Ev}var Tv,sI;function GN(){if(sI)return Tv;sI=1;var t=_j(),e=Gt(),n=ii(),r=gc(),i=oi(),o=GR(),s=KR(),a=XR(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,g=function(v){return f(v)?d(v):h(v,{})},w=function(v){return function(T){var M;if(!n(T)||(M=d(T)).type!==v)throw new u("Incompatible receiver, "+v+" required");return M}};if(t||o.state){var C=o.state||(o.state=new c);C.get=C.get,C.has=C.has,C.set=C.set,h=function(v,T){if(C.has(v))throw new u(l);return T.facade=v,C.set(v,T),T},d=function(v){return C.get(v)||{}},f=function(v){return C.has(v)}}else{var S=s("state");a[S]=!0,h=function(v,T){if(i(v,S))throw new u(l);return T.facade=v,r(v,S,T),T},d=function(v){return i(v,S)?v[S]:{}},f=function(v){return i(v,S)}}return Tv={set:h,get:d,has:f,enforce:g,getterFor:w},Tv}var aI;function qN(){if(aI)return Cv.exports;aI=1;var t=qt(),e=rn(),n=sn(),r=oi(),i=ri(),o=Ej().CONFIGURABLE,s=Tj(),a=GN(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),g=t([].join),w=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),C=String(String).split("String"),S=Cv.exports=function(v,T,M){d(c(T),0,7)==="Symbol("&&(T="["+f(c(T),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),M&&M.getter&&(T="get "+T),M&&M.setter&&(T="set "+T),(!r(v,"name")||o&&v.name!==T)&&(i?h(v,"name",{value:T,configurable:!0}):v.name=T),w&&M&&r(M,"arity")&&v.length!==M.arity&&h(v,"length",{value:M.arity});try{M&&r(M,"constructor")&&M.constructor?i&&h(v,"prototype",{writable:!1}):v.prototype&&(v.prototype=void 0)}catch{}var x=l(v);return r(x,"source")||(x.source=g(C,typeof T=="string"?T:"")),v};return Function.prototype.toString=S(function(){return n(this)&&u(this).source||s(this)},"toString"),Cv.exports}var _v,lI;function ZR(){if(lI)return _v;lI=1;var t=sn(),e=aa(),n=qN(),r=YR();return _v=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&n(s,u,a),a.global)l?i[o]=s:r(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},_v}var Mv={},Iv,uI;function Mj(){if(uI)return Iv;uI=1;var t=Math.ceil,e=Math.floor;return Iv=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},Iv}var Pv,cI;function Fd(){if(cI)return Pv;cI=1;var t=Mj();return Pv=function(e){var n=+e;return n!==n||n===0?0:t(n)},Pv}var Ov,hI;function Ij(){if(hI)return Ov;hI=1;var t=Fd(),e=Math.max,n=Math.min;return Ov=function(r,i){var o=t(r);return o<0?e(o+i,0):n(o,i)},Ov}var xv,dI;function Pj(){if(dI)return xv;dI=1;var t=Fd(),e=Math.min;return xv=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},xv}var Av,fI;function mc(){if(fI)return Av;fI=1;var t=Pj();return Av=function(e){return t(e.length)},Av}var Hv,gI;function Oj(){if(gI)return Hv;gI=1;var t=kd(),e=Ij(),n=mc(),r=function(i){return function(o,s,a){var l=t(o),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return Hv={includes:r(!0),indexOf:r(!1)},Hv}var Nv,mI;function KN(){if(mI)return Nv;mI=1;var t=qt(),e=oi(),n=kd(),r=Oj().indexOf,i=XR(),o=t([].push);return Nv=function(s,a){var l=n(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||o(c,h));return c},Nv}var Dv,pI;function JR(){return pI||(pI=1,Dv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),Dv}var wI;function xj(){if(wI)return Mv;wI=1;var t=KN(),e=JR(),n=e.concat("length","prototype");return Mv.f=Object.getOwnPropertyNames||function(i){return t(i,n)},Mv}var kv={},vI;function Aj(){return vI||(vI=1,kv.f=Object.getOwnPropertySymbols),kv}var Lv,CI;function Hj(){if(CI)return Lv;CI=1;var t=dc(),e=qt(),n=xj(),r=Aj(),i=an(),o=e([].concat);return Lv=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?o(l,u(a)):l},Lv}var $v,yI;function XN(){if(yI)return $v;yI=1;var t=oi(),e=Hj(),n=zN(),r=aa();return $v=function(i,o,s){for(var a=e(o),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},$v}var Fv,bI;function Nj(){if(bI)return Fv;bI=1;var t=rn(),e=sn(),n=/#|\.prototype\./,r=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},o=r.data={},s=r.NATIVE="N",a=r.POLYFILL="P";return Fv=r,Fv}var Vv,SI;function gt(){if(SI)return Vv;SI=1;var t=Gt(),e=zN().f,n=gc(),r=ZR(),i=YR(),o=XN(),s=Nj();return Vv=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,g,w,C,S;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(g in l){if(C=l[g],a.dontCallGetSet?(S=e(f,g),w=S&&S.value):w=f[g],d=s(c?g:u+(h?".":"#")+g,a.forced),!d&&w!==void 0){if(typeof C==typeof w)continue;o(C,w)}(a.sham||w&&w.sham)&&n(C,"sham",!0),r(f,g,C,a)}},Vv}var Wv,RI;function Vd(){if(RI)return Wv;RI=1;var t=_p(),e=Function.prototype,n=e.apply,r=e.call;return Wv=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),Wv}var Bv,EI;function ZN(){if(EI)return Bv;EI=1;var t=qt(),e=pr();return Bv=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},Bv}var jv,TI;function Dj(){if(TI)return jv;TI=1;var t=ii();return jv=function(e){return t(e)||e===null},jv}var Uv,_I;function kj(){if(_I)return Uv;_I=1;var t=Dj(),e=String,n=TypeError;return Uv=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},Uv}var zv,MI;function JN(){if(MI)return zv;MI=1;var t=ZN(),e=ii(),n=Dd(),r=kj();return zv=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),zv}var Yv,II;function Lj(){if(II)return Yv;II=1;var t=aa().f;return Yv=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},Yv}var Gv,PI;function $j(){if(PI)return Gv;PI=1;var t=sn(),e=ii(),n=JN();return Gv=function(r,i,o){var s,a;return n&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&n(r,a),r},Gv}var qv,OI;function Fj(){if(OI)return qv;OI=1;var t=Li(),e=t("toStringTag"),n={};return n[e]="z",qv=String(n)==="[object z]",qv}var Kv,xI;function QN(){if(xI)return Kv;xI=1;var t=Fj(),e=sn(),n=Il(),r=Li(),i=r("toStringTag"),o=Object,s=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return Kv=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},Kv}var Xv,AI;function Op(){if(AI)return Xv;AI=1;var t=QN(),e=String;return Xv=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},Xv}var Zv,HI;function Vj(){if(HI)return Zv;HI=1;var t=Op();return Zv=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},Zv}var Jv,NI;function Wj(){if(NI)return Jv;NI=1;var t=ii(),e=gc();return Jv=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},Jv}var Qv,DI;function Bj(){if(DI)return Qv;DI=1;var t=qt(),e=Error,n=t("".replace),r=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(r);return Qv=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=n(s,i,"");return s},Qv}var eC,kI;function jj(){if(kI)return eC;kI=1;var t=rn(),e=Mp();return eC=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),eC}var tC,LI;function Uj(){if(LI)return tC;LI=1;var t=gc(),e=Bj(),n=jj(),r=Error.captureStackTrace;return tC=function(i,o,s,a){n&&(r?r(i,o):t(i,"stack",e(s,a)))},tC}var nC,$I;function zj(){if($I)return nC;$I=1;var t=dc(),e=oi(),n=gc(),r=Ld(),i=JN(),o=XN(),s=Lj(),a=$j(),l=Vj(),u=Wj(),c=Uj(),h=ri(),d=sa();return nC=function(f,g,w,C){var S="stackTraceLimit",v=C?2:1,T=f.split("."),M=T[T.length-1],x=t.apply(null,T);if(x){var I=x.prototype;if(!d&&e(I,"cause")&&delete I.cause,!w)return x;var P=t("Error"),U=g(function(K,N){var Y=l(C?N:K,void 0),X=C?new x(K):new x;return Y!==void 0&&n(X,"message",Y),c(X,U,X.stack,2),this&&r(I,this)&&a(X,this,U),arguments.length>v&&u(X,arguments[v]),X});if(U.prototype=I,M!=="Error"?i?i(U,P):o(U,P,{name:!0}):h&&S in x&&(s(U,x,S),s(U,x,"prepareStackTrace")),o(U,x),!d)try{I.name!==M&&n(I,"name",M),I.constructor=U}catch{}return U}},nC}var FI;function Yj(){if(FI)return hM;FI=1;var t=gt(),e=Gt(),n=Vd(),r=zj(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=r(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),hM}Yj();var VI={},rC,WI;function eD(){if(WI)return rC;WI=1;var t=Il();return rC=Array.isArray||function(n){return t(n)==="Array"},rC}var iC,BI;function tD(){if(BI)return iC;BI=1;var t=ri(),e=eD(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return iC=i?function(o,s){if(e(o)&&!r(o,"length").writable)throw new n("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},iC}var oC,jI;function nD(){if(jI)return oC;jI=1;var t=TypeError,e=9007199254740991;return oC=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},oC}var UI;function Gj(){if(UI)return VI;UI=1;var t=gt(),e=fc(),n=mc(),r=tD(),i=nD(),o=rn(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var g=0;g<f;g++)h[d]=arguments[g],d++;return r(h,d),d}}),VI}Gj();var zI={},sC,YI;function qj(){if(YI)return sC;YI=1;var t=Il(),e=qt();return sC=function(n){if(t(n)==="Function")return e(n)},sC}var aC,GI;function rD(){if(GI)return aC;GI=1;var t=qj(),e=pr(),n=_p(),r=t(t.bind);return aC=function(i,o){return e(i),o===void 0?i:n?r(i,o):function(){return i.apply(o,arguments)}},aC}var lC,qI;function iD(){return qI||(qI=1,lC={}),lC}var uC,KI;function Kj(){if(KI)return uC;KI=1;var t=Li(),e=iD(),n=t("iterator"),r=Array.prototype;return uC=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},uC}var cC,XI;function QR(){if(XI)return cC;XI=1;var t=QN(),e=$d(),n=jR(),r=iD(),i=Li(),o=i("iterator");return cC=function(s){if(!n(s))return e(s,o)||e(s,"@@iterator")||r[t(s)]},cC}var hC,ZI;function Xj(){if(ZI)return hC;ZI=1;var t=on(),e=pr(),n=an(),r=Pp(),i=QR(),o=TypeError;return hC=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return n(t(l,s));throw new o(r(s)+" is not iterable")},hC}var dC,JI;function wr(){if(JI)return dC;JI=1;var t=on(),e=an(),n=$d();return dC=function(r,i,o){var s,a;e(r);try{if(s=n(r,"return"),!s){if(i==="throw")throw o;return o}s=t(s,r)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},dC}var fC,QI;function pc(){if(QI)return fC;QI=1;var t=rD(),e=on(),n=an(),r=Pp(),i=Kj(),o=mc(),s=Ld(),a=Xj(),l=QR(),u=wr(),c=TypeError,h=function(f,g){this.stopped=f,this.result=g},d=h.prototype;return fC=function(f,g,w){var C=w&&w.that,S=!!(w&&w.AS_ENTRIES),v=!!(w&&w.IS_RECORD),T=!!(w&&w.IS_ITERATOR),M=!!(w&&w.INTERRUPTED),x=t(g,C),I,P,U,K,N,Y,X,se=function(te){return I&&u(I,"normal"),new h(!0,te)},ee=function(te){return S?(n(te),M?x(te[0],te[1],se):x(te[0],te[1])):M?x(te,se):x(te)};if(v)I=f.iterator;else if(T)I=f;else{if(P=l(f),!P)throw new c(r(f)+" is not iterable");if(i(P)){for(U=0,K=o(f);K>U;U++)if(N=ee(f[U]),N&&s(d,N))return N;return new h(!1)}I=a(f,P)}for(Y=v?f.next:I.next;!(X=e(Y,I)).done;){try{N=ee(X.value)}catch(te){u(I,"throw",te)}if(typeof N=="object"&&N&&s(d,N))return N}return new h(!1)},fC}var gC,eP;function oD(){if(eP)return gC;eP=1;var t=ri(),e=aa(),n=Mp();return gC=function(r,i,o){t?e.f(r,i,n(0,o)):r[i]=o},gC}var tP;function Zj(){if(tP)return zI;tP=1;var t=gt(),e=pc(),n=oD();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){n(o,s,a)},{AS_ENTRIES:!0}),o}}),zI}Zj();var nP={},mC,rP;function bo(){if(rP)return mC;rP=1;var t=qt(),e=Set.prototype;return mC={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},mC}var pC,iP;function Pl(){if(iP)return pC;iP=1;var t=bo().has;return pC=function(e){return t(e),e},pC}var wC,oP;function Ol(){if(oP)return wC;oP=1;var t=on();return wC=function(e,n,r){for(var i=r?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=n(s.value),a!==void 0)return a},wC}var vC,sP;function Wd(){if(sP)return vC;sP=1;var t=qt(),e=Ol(),n=bo(),r=n.Set,i=n.proto,o=t(i.forEach),s=t(i.keys),a=s(new r).next;return vC=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},vC}var CC,aP;function eE(){if(aP)return CC;aP=1;var t=bo(),e=Wd(),n=t.Set,r=t.add;return CC=function(i){var o=new n;return e(i,function(s){r(o,s)}),o},CC}var yC,lP;function Bd(){if(lP)return yC;lP=1;var t=ZN(),e=bo();return yC=t(e.proto,"size","get")||function(n){return n.size},yC}var bC,uP;function So(){return uP||(uP=1,bC=function(t){return{iterator:t,next:t.next,done:!1}}),bC}var SC,cP;function xl(){if(cP)return SC;cP=1;var t=pr(),e=an(),n=on(),r=Fd(),i=So(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},SC=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=r(h);if(d<0)throw new s(o);return new u(c,d)},SC}var RC,hP;function Jj(){if(hP)return RC;hP=1;var t=Pl(),e=bo(),n=eE(),r=Bd(),i=xl(),o=Wd(),s=Ol(),a=e.has,l=e.remove;return RC=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?o(h,function(g){d.includes(g)&&l(f,g)}):s(d.getIterator(),function(g){a(f,g)&&l(f,g)}),f},RC}var EC,dP;function Al(){if(dP)return EC;dP=1;var t=dc(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return EC=function(r,i){var o=t("Set");try{new o()[r](e(0));try{return new o()[r](e(-1)),!1}catch{if(!i)return!0;try{return new o()[r](n(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[r](n(1/0)))}}}catch{return!1}},EC}var fP;function Qj(){if(fP)return nP;fP=1;var t=gt(),e=Jj(),n=rn(),r=Al(),i=!r("difference",function(s){return s.size===0}),o=i||n(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),nP}Qj();var gP={},TC,mP;function eU(){if(mP)return TC;mP=1;var t=Pl(),e=bo(),n=Bd(),r=xl(),i=Wd(),o=Ol(),s=e.Set,a=e.add,l=e.has;return TC=function(c){var h=t(this),d=r(c),f=new s;return n(h)>d.size?o(d.getIterator(),function(g){l(h,g)&&a(f,g)}):i(h,function(g){d.includes(g)&&a(f,g)}),f},TC}var pP;function tU(){if(pP)return gP;pP=1;var t=gt(),e=rn(),n=eU(),r=Al(),i=!r("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),gP}tU();var wP={},_C,vP;function nU(){if(vP)return _C;vP=1;var t=Pl(),e=bo().has,n=Bd(),r=xl(),i=Wd(),o=Ol(),s=wr();return _C=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},_C}var CP;function rU(){if(CP)return wP;CP=1;var t=gt(),e=nU(),n=Al(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),wP}rU();var yP={},MC,bP;function iU(){if(bP)return MC;bP=1;var t=Pl(),e=Bd(),n=Wd(),r=xl();return MC=function(o){var s=t(this),a=r(o);return e(s)>a.size?!1:n(s,function(l){if(!a.includes(l))return!1},!0)!==!1},MC}var SP;function oU(){if(SP)return yP;SP=1;var t=gt(),e=iU(),n=Al(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),yP}oU();var RP={},IC,EP;function sU(){if(EP)return IC;EP=1;var t=Pl(),e=bo().has,n=Bd(),r=xl(),i=Ol(),o=wr();return IC=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},IC}var TP;function aU(){if(TP)return RP;TP=1;var t=gt(),e=sU(),n=Al(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),RP}aU();var _P={},PC,MP;function lU(){if(MP)return PC;MP=1;var t=Pl(),e=bo(),n=eE(),r=xl(),i=Ol(),o=e.add,s=e.has,a=e.remove;return PC=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){s(c,f)?a(d,f):o(d,f)}),d},PC}var OC,IP;function sD(){return IP||(IP=1,OC=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[t](n);return r.size===1&&r.values().next().value===4}catch{return!1}}),OC}var PP;function uU(){if(PP)return _P;PP=1;var t=gt(),e=lU(),n=sD(),r=Al(),i=!r("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),_P}uU();var OP={},xC,xP;function cU(){if(xP)return xC;xP=1;var t=Pl(),e=bo().add,n=eE(),r=xl(),i=Ol();return xC=function(s){var a=t(this),l=r(s).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},xC}var AP;function hU(){if(AP)return OP;AP=1;var t=gt(),e=cU(),n=sD(),r=Al(),i=!r("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),OP}hU();var HP={},NP={},AC,DP;function dU(){if(DP)return AC;DP=1;var t=Ld(),e=TypeError;return AC=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},AC}var HC,kP;function fU(){if(kP)return HC;kP=1;var t=rn();return HC=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),HC}var NC,LP;function aD(){if(LP)return NC;LP=1;var t=oi(),e=sn(),n=fc(),r=KR(),i=fU(),o=r("IE_PROTO"),s=Object,a=s.prototype;return NC=i?s.getPrototypeOf:function(l){var u=n(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},NC}var DC,$P;function gU(){if($P)return DC;$P=1;var t=qN(),e=aa();return DC=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},DC}var kC={},LC,FP;function mU(){if(FP)return LC;FP=1;var t=KN(),e=JR();return LC=Object.keys||function(r){return t(r,e)},LC}var VP;function pU(){if(VP)return kC;VP=1;var t=ri(),e=YN(),n=aa(),r=an(),i=kd(),o=mU();return kC.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=o(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},kC}var $C,WP;function lD(){if(WP)return $C;WP=1;var t=dc();return $C=t("document","documentElement"),$C}var FC,BP;function tE(){if(BP)return FC;BP=1;var t=an(),e=pU(),n=JR(),r=XR(),i=lD(),o=qR(),s=KR(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},f=function(v){return l+c+a+v+l+"/"+c+a},g=function(v){v.write(f("")),v.close();var T=v.parentWindow.Object;return v=null,T},w=function(){var v=o("iframe"),T="java"+c+":",M;return v.style.display="none",i.appendChild(v),v.src=String(T),M=v.contentWindow.document,M.open(),M.write(f("document.F=Object")),M.close(),M.F},C,S=function(){try{C=new ActiveXObject("htmlfile")}catch{}S=typeof document<"u"?document.domain&&C?g(C):w():g(C);for(var v=n.length;v--;)delete S[u][n[v]];return S()};return r[h]=!0,FC=Object.create||function(T,M){var x;return T!==null?(d[u]=t(T),x=new d,d[u]=null,x[h]=T):x=S(),M===void 0?x:e.f(x,M)},FC}var VC,jP;function uD(){if(jP)return VC;jP=1;var t=rn(),e=sn(),n=ii(),r=tE(),i=aD(),o=ZR(),s=Li(),a=sa(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var g={};return c[l].call(g)!==g});return f?c={}:a&&(c=r(c)),e(c[l])||o(c,l,function(){return this}),VC={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},VC}var UP;function wU(){if(UP)return NP;UP=1;var t=gt(),e=Gt(),n=dU(),r=an(),i=sn(),o=aD(),s=gU(),a=oD(),l=rn(),u=oi(),c=Li(),h=uD().IteratorPrototype,d=ri(),f=sa(),g="constructor",w="Iterator",C=c("toStringTag"),S=TypeError,v=e[w],T=f||!i(v)||v.prototype!==h||!l(function(){v({})}),M=function(){if(n(this,h),o(this)===h)throw new S("Abstract class Iterator not directly constructable")},x=function(I,P){d?s(h,I,{configurable:!0,get:function(){return P},set:function(U){if(r(this),this===h)throw new S("You can't redefine this property");u(this,I)?this[I]=U:a(this,I,U)}}):h[I]=P};return u(h,C)||x(C,w),(T||!u(h,g)||h[g]===Object)&&x(g,M),M.prototype=h,t({global:!0,constructor:!0,forced:T},{Iterator:M}),NP}var zP;function vU(){return zP||(zP=1,wU()),HP}vU();var YP={},GP={},WC,qP;function CU(){if(qP)return WC;qP=1;var t=ZR();return WC=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},WC}var BC,KP;function yU(){return KP||(KP=1,BC=function(t,e){return{value:t,done:e}}),BC}var jC,XP;function bU(){if(XP)return jC;XP=1;var t=wr();return jC=function(e,n,r){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{r=t(e[i].iterator,n,r)}catch(o){n="throw",r=o}if(n==="throw")throw r;return r},jC}var UC,ZP;function nE(){if(ZP)return UC;ZP=1;var t=on(),e=tE(),n=gc(),r=CU(),i=Li(),o=GN(),s=$d(),a=uD().IteratorPrototype,l=yU(),u=wr(),c=bU(),h=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",g="normal",w="throw",C=o.set,S=function(M){var x=o.getterFor(M?f:d);return r(e(a),{next:function(){var P=x(this);if(M)return P.nextHandler();if(P.done)return l(void 0,!0);try{var U=P.nextHandler();return P.returnHandlerResult?U:l(U,P.done)}catch(K){throw P.done=!0,K}},return:function(){var I=x(this),P=I.iterator;if(I.done=!0,M){var U=s(P,"return");return U?t(U,P):l(void 0,!0)}if(I.inner)try{u(I.inner.iterator,g)}catch(K){return u(P,w,K)}if(I.openIters)try{c(I.openIters,g)}catch(K){return u(P,w,K)}return P&&u(P,g),l(void 0,!0)}})},v=S(!0),T=S(!1);return n(T,h,"Iterator Helper"),UC=function(M,x,I){var P=function(K,N){N?(N.iterator=K.iterator,N.next=K.next):N=K,N.type=x?f:d,N.returnHandlerResult=!!I,N.nextHandler=M,N.counter=0,N.done=!1,C(this,N)};return P.prototype=x?v:T,P},UC}var zC,JP;function cD(){if(JP)return zC;JP=1;var t=an(),e=wr();return zC=function(n,r,i,o){try{return o?r(t(i)[0],i[1]):r(i)}catch(s){e(n,"throw",s)}},zC}var YC,QP;function rE(){return QP||(QP=1,YC=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),YC}var GC,eO;function la(){if(eO)return GC;eO=1;var t=Gt();return GC=function(e,n){var r=t.Iterator,i=r&&r.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof n||(s=!1)}if(!s)return o},GC}var tO;function SU(){if(tO)return GP;tO=1;var t=gt(),e=on(),n=pr(),r=an(),i=So(),o=nE(),s=cD(),a=sa(),l=wr(),u=rE(),c=la(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),f=a||h||d,g=o(function(){for(var w=this.iterator,C=this.predicate,S=this.next,v,T,M;;){if(v=r(e(S,w)),T=this.done=!!v.done,T)return;if(M=v.value,s(w,C,[M,this.counter++],!0))return M}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(C){r(this);try{n(C)}catch(S){l(this,"throw",S)}return d?e(d,this,C):new g(i(this),{predicate:C})}}),GP}var nO;function RU(){return nO||(nO=1,SU()),YP}RU();var rO={},iO={},oO;function EU(){if(oO)return iO;oO=1;var t=gt(),e=on(),n=pc(),r=pr(),i=an(),o=So(),s=wr(),a=la(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),iO}var sO;function TU(){return sO||(sO=1,EU()),rO}TU();var aO={},lO={},uO;function _U(){if(uO)return lO;uO=1;var t=gt(),e=on(),n=pr(),r=an(),i=So(),o=nE(),s=cD(),a=wr(),l=rE(),u=la(),c=sa(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),f=c||h||d,g=o(function(){var w=this.iterator,C=r(e(this.next,w)),S=this.done=!!C.done;if(!S)return s(w,this.mapper,[C.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(C){r(this);try{n(C)}catch(S){a(this,"throw",S)}return d?e(d,this,C):new g(i(this),{mapper:C})}}),lO}var cO;function MU(){return cO||(cO=1,_U()),aO}MU();var hO={},dO={},qC,fO;function iE(){if(fO)return qC;fO=1;var t=qt();return qC=t([].slice),qC}var KC,gO;function hD(){if(gO)return KC;gO=1;var t=TypeError;return KC=function(e,n){if(e<n)throw new t("Not enough arguments");return e},KC}var XC,mO;function IU(){if(mO)return XC;mO=1;var t=Ip();return XC=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),XC}var ZC,pO;function dD(){if(pO)return ZC;pO=1;var t=Gt(),e=Ip(),n=Il(),r=function(i){return e.slice(0,i.length)===i};return ZC=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),ZC}var JC,wO;function PU(){if(wO)return JC;wO=1;var t=dD();return JC=t==="NODE",JC}var QC,vO;function fD(){if(vO)return QC;vO=1;var t=Gt(),e=Vd(),n=rD(),r=sn(),i=oi(),o=rn(),s=lD(),a=iE(),l=qR(),u=hD(),c=IU(),h=PU(),d=t.setImmediate,f=t.clearImmediate,g=t.process,w=t.Dispatch,C=t.Function,S=t.MessageChannel,v=t.String,T=0,M={},x="onreadystatechange",I,P,U,K;o(function(){I=t.location});var N=function(ee){if(i(M,ee)){var te=M[ee];delete M[ee],te()}},Y=function(ee){return function(){N(ee)}},X=function(ee){N(ee.data)},se=function(ee){t.postMessage(v(ee),I.protocol+"//"+I.host)};return(!d||!f)&&(d=function(te){u(arguments.length,1);var Le=r(te)?te:C(te),Ne=a(arguments,1);return M[++T]=function(){e(Le,void 0,Ne)},P(T),T},f=function(te){delete M[te]},h?P=function(ee){g.nextTick(Y(ee))}:w&&w.now?P=function(ee){w.now(Y(ee))}:S&&!c?(U=new S,K=U.port2,U.port1.onmessage=X,P=n(K.postMessage,K)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&I&&I.protocol!=="file:"&&!o(se)?(P=se,t.addEventListener("message",X,!1)):x in l("script")?P=function(ee){s.appendChild(l("script"))[x]=function(){s.removeChild(this),N(ee)}}:P=function(ee){setTimeout(Y(ee),0)}),QC={set:d,clear:f},QC}var CO;function OU(){if(CO)return dO;CO=1;var t=gt(),e=Gt(),n=fD().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),dO}var yO={},ey,bO;function xU(){if(bO)return ey;bO=1;var t=Gt(),e=Vd(),n=sn(),r=dD(),i=Ip(),o=iE(),s=hD(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return ey=function(u,c){var h=c?2:1;return l?function(d,f){var g=s(arguments.length,1)>h,w=n(d)?d:a(d),C=g?o(arguments,h):[],S=g?function(){e(w,this,C)}:w;return c?u(S,f):u(S)}:u},ey}var SO;function AU(){if(SO)return yO;SO=1;var t=gt(),e=Gt(),n=fD().set,r=xU(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),yO}var RO;function HU(){return RO||(RO=1,OU(),AU()),hO}HU();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:gD,setPrototypeOf:EO,isFrozen:NU,getPrototypeOf:DU,getOwnPropertyDescriptor:kU}=Object;let{freeze:qn,seal:ni,create:mD}=Object,{apply:kS,construct:LS}=typeof Reflect<"u"&&Reflect;qn||(qn=function(e){return e});ni||(ni=function(e){return e});kS||(kS=function(e,n,r){return e.apply(n,r)});LS||(LS=function(e,n){return new e(...n)});const mf=Kn(Array.prototype.forEach),LU=Kn(Array.prototype.lastIndexOf),TO=Kn(Array.prototype.pop),Ac=Kn(Array.prototype.push),$U=Kn(Array.prototype.splice),Qg=Kn(String.prototype.toLowerCase),ty=Kn(String.prototype.toString),_O=Kn(String.prototype.match),Hc=Kn(String.prototype.replace),FU=Kn(String.prototype.indexOf),VU=Kn(String.prototype.trim),bi=Kn(Object.prototype.hasOwnProperty),$n=Kn(RegExp.prototype.test),Nc=WU(TypeError);function Kn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return kS(t,e,r)}}function WU(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return LS(t,n)}}function De(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qg;EO&&EO(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(NU(e)||(e[r]=o),i=o)}t[i]=!0}return t}function BU(t){for(let e=0;e<t.length;e++)bi(t,e)||(t[e]=null);return t}function Bo(t){const e=mD(null);for(const[n,r]of gD(t))bi(t,n)&&(Array.isArray(r)?e[n]=BU(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Bo(r):e[n]=r);return e}function Dc(t,e){for(;t!==null;){const r=kU(t,e);if(r){if(r.get)return Kn(r.get);if(typeof r.value=="function")return Kn(r.value)}t=DU(t)}function n(){return null}return n}const MO=qn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ny=qn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ry=qn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),jU=qn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),iy=qn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),UU=qn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),IO=qn(["#text"]),PO=qn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),oy=qn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),OO=qn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),pf=qn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),zU=ni(/\{\{[\w\W]*|[\w\W]*\}\}/gm),YU=ni(/<%[\w\W]*|[\w\W]*%>/gm),GU=ni(/\$\{[\w\W]*/gm),qU=ni(/^data-[\-\w.\u00B7-\uFFFF]+$/),KU=ni(/^aria-[\-\w]+$/),pD=ni(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),XU=ni(/^(?:\w+script|data):/i),ZU=ni(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),wD=ni(/^html$/i),JU=ni(/^[a-z][.\w]*(-[.\w]+)+$/i);var xO=Object.freeze({__proto__:null,ARIA_ATTR:KU,ATTR_WHITESPACE:ZU,CUSTOM_ELEMENT:JU,DATA_ATTR:qU,DOCTYPE_NAME:wD,ERB_EXPR:YU,IS_ALLOWED_URI:pD,IS_SCRIPT_OR_DATA:XU,MUSTACHE_EXPR:zU,TMPLIT_EXPR:GU});const kc={element:1,text:3,progressingInstruction:7,comment:8,document:9},QU=function(){return typeof window>"u"?null:window},ez=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},AO=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function vD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:QU();const e=me=>vD(me);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==kc.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,w=Dc(g,"cloneNode"),C=Dc(g,"remove"),S=Dc(g,"nextSibling"),v=Dc(g,"childNodes"),T=Dc(g,"parentNode");if(typeof s=="function"){const me=n.createElement("template");me.content&&me.content.ownerDocument&&(n=me.content.ownerDocument)}let M,x="";const{implementation:I,createNodeIterator:P,createDocumentFragment:U,getElementsByTagName:K}=n,{importNode:N}=r;let Y=AO();e.isSupported=typeof gD=="function"&&typeof T=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:X,ERB_EXPR:se,TMPLIT_EXPR:ee,DATA_ATTR:te,ARIA_ATTR:Le,IS_SCRIPT_OR_DATA:Ne,ATTR_WHITESPACE:$e,CUSTOM_ELEMENT:vt}=xO;let{IS_ALLOWED_URI:rt}=xO,at=null;const gn=De({},[...MO,...ny,...ry,...iy,...IO]);let m=null;const p=De({},[...PO,...oy,...OO,...pf]);let b=Object.seal(mD(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),D=null,F=null,B=!0,G=!0,y=!1,R=!0,E=!1,_=!0,O=!1,L=!1,W=!1,H=!1,$=!1,V=!1,j=!0,z=!1;const oe="user-content-";let ae=!0,Se=!1,Fe={},Ve=null;const Re=De({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let be=null;const et=De({},["audio","video","img","source","image","track"]);let Jn=null;const _o=De({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ci="http://www.w3.org/1998/Math/MathML",ln="http://www.w3.org/2000/svg",Ct="http://www.w3.org/1999/xhtml";let Et=Ct,mt=!1,Ze=null;const kr=De({},[ci,ln,Ct],ty);let Ln=De({},["mi","mo","mn","ms","mtext"]),fa=De({},["annotation-xml"]);const cf=De({},["title","style","font","a","script"]);let Ic=null;const vV=["application/xhtml+xml","text/html"],CV="text/html";let mn=null,Ll=null;const yV=n.createElement("form"),A_=function(k){return k instanceof RegExp||k instanceof Function},Ew=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ll&&Ll===k)){if((!k||typeof k!="object")&&(k={}),k=Bo(k),Ic=vV.indexOf(k.PARSER_MEDIA_TYPE)===-1?CV:k.PARSER_MEDIA_TYPE,mn=Ic==="application/xhtml+xml"?ty:Qg,at=bi(k,"ALLOWED_TAGS")?De({},k.ALLOWED_TAGS,mn):gn,m=bi(k,"ALLOWED_ATTR")?De({},k.ALLOWED_ATTR,mn):p,Ze=bi(k,"ALLOWED_NAMESPACES")?De({},k.ALLOWED_NAMESPACES,ty):kr,Jn=bi(k,"ADD_URI_SAFE_ATTR")?De(Bo(_o),k.ADD_URI_SAFE_ATTR,mn):_o,be=bi(k,"ADD_DATA_URI_TAGS")?De(Bo(et),k.ADD_DATA_URI_TAGS,mn):et,Ve=bi(k,"FORBID_CONTENTS")?De({},k.FORBID_CONTENTS,mn):Re,D=bi(k,"FORBID_TAGS")?De({},k.FORBID_TAGS,mn):Bo({}),F=bi(k,"FORBID_ATTR")?De({},k.FORBID_ATTR,mn):Bo({}),Fe=bi(k,"USE_PROFILES")?k.USE_PROFILES:!1,B=k.ALLOW_ARIA_ATTR!==!1,G=k.ALLOW_DATA_ATTR!==!1,y=k.ALLOW_UNKNOWN_PROTOCOLS||!1,R=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,E=k.SAFE_FOR_TEMPLATES||!1,_=k.SAFE_FOR_XML!==!1,O=k.WHOLE_DOCUMENT||!1,H=k.RETURN_DOM||!1,$=k.RETURN_DOM_FRAGMENT||!1,V=k.RETURN_TRUSTED_TYPE||!1,W=k.FORCE_BODY||!1,j=k.SANITIZE_DOM!==!1,z=k.SANITIZE_NAMED_PROPS||!1,ae=k.KEEP_CONTENT!==!1,Se=k.IN_PLACE||!1,rt=k.ALLOWED_URI_REGEXP||pD,Et=k.NAMESPACE||Ct,Ln=k.MATHML_TEXT_INTEGRATION_POINTS||Ln,fa=k.HTML_INTEGRATION_POINTS||fa,b=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&A_(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(b.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&A_(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(b.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(b.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),E&&(G=!1),$&&(H=!0),Fe&&(at=De({},IO),m=[],Fe.html===!0&&(De(at,MO),De(m,PO)),Fe.svg===!0&&(De(at,ny),De(m,oy),De(m,pf)),Fe.svgFilters===!0&&(De(at,ry),De(m,oy),De(m,pf)),Fe.mathMl===!0&&(De(at,iy),De(m,OO),De(m,pf))),k.ADD_TAGS&&(at===gn&&(at=Bo(at)),De(at,k.ADD_TAGS,mn)),k.ADD_ATTR&&(m===p&&(m=Bo(m)),De(m,k.ADD_ATTR,mn)),k.ADD_URI_SAFE_ATTR&&De(Jn,k.ADD_URI_SAFE_ATTR,mn),k.FORBID_CONTENTS&&(Ve===Re&&(Ve=Bo(Ve)),De(Ve,k.FORBID_CONTENTS,mn)),ae&&(at["#text"]=!0),O&&De(at,["html","head","body"]),at.table&&(De(at,["tbody"]),delete D.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw Nc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Nc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');M=k.TRUSTED_TYPES_POLICY,x=M.createHTML("")}else M===void 0&&(M=ez(f,i)),M!==null&&typeof x=="string"&&(x=M.createHTML(""));qn&&qn(k),Ll=k}},H_=De({},[...ny,...ry,...jU]),N_=De({},[...iy,...UU]),bV=function(k){let Q=T(k);(!Q||!Q.tagName)&&(Q={namespaceURI:Et,tagName:"template"});const fe=Qg(k.tagName),Tt=Qg(Q.tagName);return Ze[k.namespaceURI]?k.namespaceURI===ln?Q.namespaceURI===Ct?fe==="svg":Q.namespaceURI===ci?fe==="svg"&&(Tt==="annotation-xml"||Ln[Tt]):!!H_[fe]:k.namespaceURI===ci?Q.namespaceURI===Ct?fe==="math":Q.namespaceURI===ln?fe==="math"&&fa[Tt]:!!N_[fe]:k.namespaceURI===Ct?Q.namespaceURI===ln&&!fa[Tt]||Q.namespaceURI===ci&&!Ln[Tt]?!1:!N_[fe]&&(cf[fe]||!H_[fe]):!!(Ic==="application/xhtml+xml"&&Ze[k.namespaceURI]):!1},Vi=function(k){Ac(e.removed,{element:k});try{T(k).removeChild(k)}catch{C(k)}},$l=function(k,Q){try{Ac(e.removed,{attribute:Q.getAttributeNode(k),from:Q})}catch{Ac(e.removed,{attribute:null,from:Q})}if(Q.removeAttribute(k),k==="is")if(H||$)try{Vi(Q)}catch{}else try{Q.setAttribute(k,"")}catch{}},D_=function(k){let Q=null,fe=null;if(W)k="<remove></remove>"+k;else{const un=_O(k,/^[\r\n\t ]+/);fe=un&&un[0]}Ic==="application/xhtml+xml"&&Et===Ct&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const Tt=M?M.createHTML(k):k;if(Et===Ct)try{Q=new d().parseFromString(Tt,Ic)}catch{}if(!Q||!Q.documentElement){Q=I.createDocument(Et,"template",null);try{Q.documentElement.innerHTML=mt?x:Tt}catch{}}const Rn=Q.body||Q.documentElement;return k&&fe&&Rn.insertBefore(n.createTextNode(fe),Rn.childNodes[0]||null),Et===Ct?K.call(Q,O?"html":"body")[0]:O?Q.documentElement:Rn},k_=function(k){return P.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Tw=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},L_=function(k){return typeof a=="function"&&k instanceof a};function Mo(me,k,Q){mf(me,fe=>{fe.call(e,k,Q,Ll)})}const $_=function(k){let Q=null;if(Mo(Y.beforeSanitizeElements,k,null),Tw(k))return Vi(k),!0;const fe=mn(k.nodeName);if(Mo(Y.uponSanitizeElement,k,{tagName:fe,allowedTags:at}),_&&k.hasChildNodes()&&!L_(k.firstElementChild)&&$n(/<[/\w!]/g,k.innerHTML)&&$n(/<[/\w!]/g,k.textContent)||k.nodeType===kc.progressingInstruction||_&&k.nodeType===kc.comment&&$n(/<[/\w]/g,k.data))return Vi(k),!0;if(!at[fe]||D[fe]){if(!D[fe]&&V_(fe)&&(b.tagNameCheck instanceof RegExp&&$n(b.tagNameCheck,fe)||b.tagNameCheck instanceof Function&&b.tagNameCheck(fe)))return!1;if(ae&&!Ve[fe]){const Tt=T(k)||k.parentNode,Rn=v(k)||k.childNodes;if(Rn&&Tt){const un=Rn.length;for(let Qn=un-1;Qn>=0;--Qn){const Io=w(Rn[Qn],!0);Io.__removalCount=(k.__removalCount||0)+1,Tt.insertBefore(Io,S(k))}}}return Vi(k),!0}return k instanceof l&&!bV(k)||(fe==="noscript"||fe==="noembed"||fe==="noframes")&&$n(/<\/no(script|embed|frames)/i,k.innerHTML)?(Vi(k),!0):(E&&k.nodeType===kc.text&&(Q=k.textContent,mf([X,se,ee],Tt=>{Q=Hc(Q,Tt," ")}),k.textContent!==Q&&(Ac(e.removed,{element:k.cloneNode()}),k.textContent=Q)),Mo(Y.afterSanitizeElements,k,null),!1)},F_=function(k,Q,fe){if(j&&(Q==="id"||Q==="name")&&(fe in n||fe in yV))return!1;if(!(G&&!F[Q]&&$n(te,Q))){if(!(B&&$n(Le,Q))){if(!m[Q]||F[Q]){if(!(V_(k)&&(b.tagNameCheck instanceof RegExp&&$n(b.tagNameCheck,k)||b.tagNameCheck instanceof Function&&b.tagNameCheck(k))&&(b.attributeNameCheck instanceof RegExp&&$n(b.attributeNameCheck,Q)||b.attributeNameCheck instanceof Function&&b.attributeNameCheck(Q))||Q==="is"&&b.allowCustomizedBuiltInElements&&(b.tagNameCheck instanceof RegExp&&$n(b.tagNameCheck,fe)||b.tagNameCheck instanceof Function&&b.tagNameCheck(fe))))return!1}else if(!Jn[Q]){if(!$n(rt,Hc(fe,$e,""))){if(!((Q==="src"||Q==="xlink:href"||Q==="href")&&k!=="script"&&FU(fe,"data:")===0&&be[k])){if(!(y&&!$n(Ne,Hc(fe,$e,"")))){if(fe)return!1}}}}}}return!0},V_=function(k){return k!=="annotation-xml"&&_O(k,vt)},W_=function(k){Mo(Y.beforeSanitizeAttributes,k,null);const{attributes:Q}=k;if(!Q||Tw(k))return;const fe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:m,forceKeepAttr:void 0};let Tt=Q.length;for(;Tt--;){const Rn=Q[Tt],{name:un,namespaceURI:Qn,value:Io}=Rn,Pc=mn(un),_w=Io;let En=un==="value"?_w:VU(_w);if(fe.attrName=Pc,fe.attrValue=En,fe.keepAttr=!0,fe.forceKeepAttr=void 0,Mo(Y.uponSanitizeAttribute,k,fe),En=fe.attrValue,z&&(Pc==="id"||Pc==="name")&&($l(un,k),En=oe+En),_&&$n(/((--!?|])>)|<\/(style|title)/i,En)){$l(un,k);continue}if(fe.forceKeepAttr)continue;if(!fe.keepAttr){$l(un,k);continue}if(!R&&$n(/\/>/i,En)){$l(un,k);continue}E&&mf([X,se,ee],j_=>{En=Hc(En,j_," ")});const B_=mn(k.nodeName);if(!F_(B_,Pc,En)){$l(un,k);continue}if(M&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Qn)switch(f.getAttributeType(B_,Pc)){case"TrustedHTML":{En=M.createHTML(En);break}case"TrustedScriptURL":{En=M.createScriptURL(En);break}}if(En!==_w)try{Qn?k.setAttributeNS(Qn,un,En):k.setAttribute(un,En),Tw(k)?Vi(k):TO(e.removed)}catch{$l(un,k)}}Mo(Y.afterSanitizeAttributes,k,null)},SV=function me(k){let Q=null;const fe=k_(k);for(Mo(Y.beforeSanitizeShadowDOM,k,null);Q=fe.nextNode();)Mo(Y.uponSanitizeShadowNode,Q,null),$_(Q),W_(Q),Q.content instanceof o&&me(Q.content);Mo(Y.afterSanitizeShadowDOM,k,null)};return e.sanitize=function(me){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Q=null,fe=null,Tt=null,Rn=null;if(mt=!me,mt&&(me="<!-->"),typeof me!="string"&&!L_(me))if(typeof me.toString=="function"){if(me=me.toString(),typeof me!="string")throw Nc("dirty is not a string, aborting")}else throw Nc("toString is not a function");if(!e.isSupported)return me;if(L||Ew(k),e.removed=[],typeof me=="string"&&(Se=!1),Se){if(me.nodeName){const Io=mn(me.nodeName);if(!at[Io]||D[Io])throw Nc("root node is forbidden and cannot be sanitized in-place")}}else if(me instanceof a)Q=D_("<!---->"),fe=Q.ownerDocument.importNode(me,!0),fe.nodeType===kc.element&&fe.nodeName==="BODY"||fe.nodeName==="HTML"?Q=fe:Q.appendChild(fe);else{if(!H&&!E&&!O&&me.indexOf("<")===-1)return M&&V?M.createHTML(me):me;if(Q=D_(me),!Q)return H?null:V?x:""}Q&&W&&Vi(Q.firstChild);const un=k_(Se?me:Q);for(;Tt=un.nextNode();)$_(Tt),W_(Tt),Tt.content instanceof o&&SV(Tt.content);if(Se)return me;if(H){if($)for(Rn=U.call(Q.ownerDocument);Q.firstChild;)Rn.appendChild(Q.firstChild);else Rn=Q;return(m.shadowroot||m.shadowrootmode)&&(Rn=N.call(r,Rn,!0)),Rn}let Qn=O?Q.outerHTML:Q.innerHTML;return O&&at["!doctype"]&&Q.ownerDocument&&Q.ownerDocument.doctype&&Q.ownerDocument.doctype.name&&$n(wD,Q.ownerDocument.doctype.name)&&(Qn="<!DOCTYPE "+Q.ownerDocument.doctype.name+`>
`+Qn),E&&mf([X,se,ee],Io=>{Qn=Hc(Qn,Io," ")}),M&&V?M.createHTML(Qn):Qn},e.setConfig=function(){let me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ew(me),L=!0},e.clearConfig=function(){Ll=null,L=!1},e.isValidAttribute=function(me,k,Q){Ll||Ew({});const fe=mn(me),Tt=mn(k);return F_(fe,Tt,Q)},e.addHook=function(me,k){typeof k=="function"&&Ac(Y[me],k)},e.removeHook=function(me,k){if(k!==void 0){const Q=LU(Y[me],k);return Q===-1?void 0:$U(Y[me],Q,1)[0]}return TO(Y[me])},e.removeHooks=function(me){Y[me]=[]},e.removeAllHooks=function(){Y=AO()},e}var tz=vD();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var CD;function Z(){return CD.apply(null,arguments)}function nz(t){CD=t}function Ai(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function fl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function oE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Je(t,e))return!1;return!0}function lr(t){return t===void 0}function ls(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function jd(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function yD(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Ys(t,e){for(var n in e)Je(e,n)&&(t[n]=e[n]);return Je(e,"toString")&&(t.toString=e.toString),Je(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Ro(t,e,n,r){return jD(t,e,n,r,!0).utc()}function rz(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ie(t){return t._pf==null&&(t._pf=rz()),t._pf}var $S;Array.prototype.some?$S=Array.prototype.some:$S=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function sE(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Ie(t),n=$S.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function xp(t){var e=Ro(NaN);return t!=null?Ys(Ie(e),t):Ie(e).userInvalidated=!0,e}var HO=Z.momentProperties=[],sy=!1;function aE(t,e){var n,r,i,o=HO.length;if(lr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),lr(e._i)||(t._i=e._i),lr(e._f)||(t._f=e._f),lr(e._l)||(t._l=e._l),lr(e._strict)||(t._strict=e._strict),lr(e._tzm)||(t._tzm=e._tzm),lr(e._isUTC)||(t._isUTC=e._isUTC),lr(e._offset)||(t._offset=e._offset),lr(e._pf)||(t._pf=Ie(e)),lr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=HO[n],i=e[r],lr(i)||(t[r]=i);return t}function Ud(t){aE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),sy===!1&&(sy=!0,Z.updateOffset(this),sy=!1)}function Hi(t){return t instanceof Ud||t!=null&&t._isAMomentObject!=null}function bD(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function si(t,e){var n=!0;return Ys(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Je(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}bD(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var NO={};function SD(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),NO[t]||(bD(e),NO[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function Eo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function iz(t){var e,n;for(n in t)Je(t,n)&&(e=t[n],Eo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function FS(t,e){var n=Ys({},t),r;for(r in e)Je(e,r)&&(fl(t[r])&&fl(e[r])?(n[r]={},Ys(n[r],t[r]),Ys(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)Je(t,r)&&!Je(e,r)&&fl(t[r])&&(n[r]=Ys({},n[r]));return n}function lE(t){t!=null&&this.set(t)}var VS;Object.keys?VS=Object.keys:VS=function(t){var e,n=[];for(e in t)Je(t,e)&&n.push(e);return n};var oz={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function sz(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Eo(r)?r.call(e,n):r}function Co(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var uE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,wf=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ay={},Bu={};function ve(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Bu[t]=i),e&&(Bu[e[0]]=function(){return Co(i.apply(this,arguments),e[1],e[2])}),n&&(Bu[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function az(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function lz(t){var e=t.match(uE),n,r;for(n=0,r=e.length;n<r;n++)Bu[e[n]]?e[n]=Bu[e[n]]:e[n]=az(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Eo(e[s])?e[s].call(i,t):e[s];return o}}function em(t,e){return t.isValid()?(e=RD(e,t.localeData()),ay[e]=ay[e]||lz(e),ay[e](t)):t.localeData().invalidDate()}function RD(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(wf.lastIndex=0;n>=0&&wf.test(t);)t=t.replace(wf,r),wf.lastIndex=0,n-=1;return t}var uz={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function cz(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(uE).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var hz="Invalid date";function dz(){return this._invalidDate}var fz="%d",gz=/\d{1,2}/;function mz(t){return this._ordinal.replace("%d",t)}var pz={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function wz(t,e,n,r){var i=this._relativeTime[n];return Eo(i)?i(t,e,n,r):i.replace(/%d/i,t)}function vz(t,e){var n=this._relativeTime[t>0?"future":"past"];return Eo(n)?n(e):n.replace(/%s/i,e)}var DO={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ai(t){return typeof t=="string"?DO[t]||DO[t.toLowerCase()]:void 0}function cE(t){var e={},n,r;for(r in t)Je(t,r)&&(n=ai(r),n&&(e[n]=t[r]));return e}var Cz={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function yz(t){var e=[],n;for(n in t)Je(t,n)&&e.push({unit:n,priority:Cz[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var ED=/\d/,Dr=/\d\d/,TD=/\d{3}/,hE=/\d{4}/,Ap=/[+-]?\d{6}/,Rt=/\d\d?/,_D=/\d\d\d\d?/,MD=/\d\d\d\d\d\d?/,Hp=/\d{1,3}/,dE=/\d{1,4}/,Np=/[+-]?\d{1,6}/,wc=/\d+/,Dp=/[+-]?\d+/,bz=/Z|[+-]\d\d:?\d\d/gi,kp=/Z|[+-]\d\d(?::?\d\d)?/gi,Sz=/[+-]?\d+(\.\d{1,3})?/,zd=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,vc=/^[1-9]\d?/,fE=/^([1-9]\d|\d)/,Em;Em={};function ue(t,e,n){Em[t]=Eo(e)?e:function(r,i){return r&&n?n:e}}function Rz(t,e){return Je(Em,t)?Em[t](e._strict,e._locale):new RegExp(Ez(t))}function Ez(t){return os(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function os(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Zr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Be(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Zr(e)),n}var WS={};function dt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),ls(e)&&(r=function(o,s){s[e]=Be(o)}),i=t.length,n=0;n<i;n++)WS[t[n]]=r}function Yd(t,e){dt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function Tz(t,e,n){e!=null&&Je(WS,t)&&WS[t](e,n._a,n,t)}function Lp(t){return t%4===0&&t%100!==0||t%400===0}var kn=0,Jo=1,ho=2,fn=3,Pi=4,Qo=5,il=6,_z=7,Mz=8;ve("Y",0,0,function(){var t=this.year();return t<=9999?Co(t,4):"+"+t});ve(0,["YY",2],0,function(){return this.year()%100});ve(0,["YYYY",4],0,"year");ve(0,["YYYYY",5],0,"year");ve(0,["YYYYYY",6,!0],0,"year");ue("Y",Dp);ue("YY",Rt,Dr);ue("YYYY",dE,hE);ue("YYYYY",Np,Ap);ue("YYYYYY",Np,Ap);dt(["YYYYY","YYYYYY"],kn);dt("YYYY",function(t,e){e[kn]=t.length===2?Z.parseTwoDigitYear(t):Be(t)});dt("YY",function(t,e){e[kn]=Z.parseTwoDigitYear(t)});dt("Y",function(t,e){e[kn]=parseInt(t,10)});function Wh(t){return Lp(t)?366:365}Z.parseTwoDigitYear=function(t){return Be(t)+(Be(t)>68?1900:2e3)};var ID=Cc("FullYear",!0);function Iz(){return Lp(this.year())}function Cc(t,e){return function(n){return n!=null?(PD(this,t,n),Z.updateOffset(this,e),this):fd(this,t)}}function fd(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function PD(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Lp(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function Pz(t){return t=ai(t),Eo(this[t])?this[t]():this}function Oz(t,e){if(typeof t=="object"){t=cE(t);var n=yz(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=ai(t),Eo(this[t]))return this[t](e);return this}function xz(t,e){return(t%e+e)%e}var zt;Array.prototype.indexOf?zt=Array.prototype.indexOf:zt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function gE(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=xz(e,12);return t+=(e-n)/12,n===1?Lp(t)?29:28:31-n%7%2}ve("M",["MM",2],"Mo",function(){return this.month()+1});ve("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});ve("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Rt,vc);ue("MM",Rt,Dr);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});dt(["M","MM"],function(t,e){e[Jo]=Be(t)-1});dt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Jo]=i:Ie(n).invalidMonth=t});var Az="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),OD="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),xD=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Hz=zd,Nz=zd;function Dz(t,e){return t?Ai(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||xD).test(e)?"format":"standalone"][t.month()]:Ai(this._months)?this._months:this._months.standalone}function kz(t,e){return t?Ai(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[xD.test(e)?"format":"standalone"][t.month()]:Ai(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Lz(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Ro([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=zt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:(i=zt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=zt.call(this._longMonthsParse,s),i!==-1?i:(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null))}function $z(t,e,n){var r,i,o;if(this._monthsParseExact)return Lz.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Ro([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function AD(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Be(e);else if(e=t.localeData().monthsParse(e),!ls(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,gE(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function HD(t){return t!=null?(AD(this,t),Z.updateOffset(this,!0),this):fd(this,"Month")}function Fz(){return gE(this.year(),this.month())}function Vz(t){return this._monthsParseExact?(Je(this,"_monthsRegex")||ND.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Je(this,"_monthsShortRegex")||(this._monthsShortRegex=Hz),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Wz(t){return this._monthsParseExact?(Je(this,"_monthsRegex")||ND.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Je(this,"_monthsRegex")||(this._monthsRegex=Nz),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function ND(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=Ro([2e3,i]),s=os(this.monthsShort(o,"")),a=os(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Bz(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function gd(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Tm(t,e,n){var r=7+e-n,i=(7+gd(t,0,r).getUTCDay()-e)%7;return-i+r-1}function DD(t,e,n,r,i){var o=(7+n-r)%7,s=Tm(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Wh(l)+a):a>Wh(t)?(l=t+1,u=a-Wh(t)):(l=t,u=a),{year:l,dayOfYear:u}}function md(t,e,n){var r=Tm(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+ss(s,e,n)):i>ss(t.year(),e,n)?(o=i-ss(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function ss(t,e,n){var r=Tm(t,e,n),i=Tm(t+1,e,n);return(Wh(t)-r+i)/7}ve("w",["ww",2],"wo","week");ve("W",["WW",2],"Wo","isoWeek");ue("w",Rt,vc);ue("ww",Rt,Dr);ue("W",Rt,vc);ue("WW",Rt,Dr);Yd(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Be(t)});function jz(t){return md(t,this._week.dow,this._week.doy).week}var Uz={dow:0,doy:6};function zz(){return this._week.dow}function Yz(){return this._week.doy}function Gz(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function qz(t){var e=md(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}ve("d",0,"do","day");ve("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});ve("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});ve("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});ve("e",0,0,"weekday");ve("E",0,0,"isoWeekday");ue("d",Rt);ue("e",Rt);ue("E",Rt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});Yd(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ie(n).invalidWeekday=t});Yd(["d","e","E"],function(t,e,n,r){e[r]=Be(t)});function Kz(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Xz(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function mE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Zz="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),kD="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Jz="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Qz=zd,eY=zd,tY=zd;function nY(t,e){var n=Ai(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?mE(n,this._week.dow):t?n[t.day()]:n}function rY(t){return t===!0?mE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function iY(t){return t===!0?mE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function oY(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Ro([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1||(i=zt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=zt.call(this._minWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function sY(t,e,n){var r,i,o;if(this._weekdaysParseExact)return oY.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Ro([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function aY(t){if(!this.isValid())return t!=null?this:NaN;var e=fd(this,"Day");return t!=null?(t=Kz(t,this.localeData()),this.add(t-e,"d")):e}function lY(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function uY(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Xz(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function cY(t){return this._weekdaysParseExact?(Je(this,"_weekdaysRegex")||pE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Je(this,"_weekdaysRegex")||(this._weekdaysRegex=Qz),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function hY(t){return this._weekdaysParseExact?(Je(this,"_weekdaysRegex")||pE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Je(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=eY),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function dY(t){return this._weekdaysParseExact?(Je(this,"_weekdaysRegex")||pE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Je(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=tY),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function pE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Ro([2e3,1]).day(o),a=os(this.weekdaysMin(s,"")),l=os(this.weekdaysShort(s,"")),u=os(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function wE(){return this.hours()%12||12}function fY(){return this.hours()||24}ve("H",["HH",2],0,"hour");ve("h",["hh",2],0,wE);ve("k",["kk",2],0,fY);ve("hmm",0,0,function(){return""+wE.apply(this)+Co(this.minutes(),2)});ve("hmmss",0,0,function(){return""+wE.apply(this)+Co(this.minutes(),2)+Co(this.seconds(),2)});ve("Hmm",0,0,function(){return""+this.hours()+Co(this.minutes(),2)});ve("Hmmss",0,0,function(){return""+this.hours()+Co(this.minutes(),2)+Co(this.seconds(),2)});function LD(t,e){ve(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}LD("a",!0);LD("A",!1);function $D(t,e){return e._meridiemParse}ue("a",$D);ue("A",$D);ue("H",Rt,fE);ue("h",Rt,vc);ue("k",Rt,vc);ue("HH",Rt,Dr);ue("hh",Rt,Dr);ue("kk",Rt,Dr);ue("hmm",_D);ue("hmmss",MD);ue("Hmm",_D);ue("Hmmss",MD);dt(["H","HH"],fn);dt(["k","kk"],function(t,e,n){var r=Be(t);e[fn]=r===24?0:r});dt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});dt(["h","hh"],function(t,e,n){e[fn]=Be(t),Ie(n).bigHour=!0});dt("hmm",function(t,e,n){var r=t.length-2;e[fn]=Be(t.substr(0,r)),e[Pi]=Be(t.substr(r)),Ie(n).bigHour=!0});dt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[fn]=Be(t.substr(0,r)),e[Pi]=Be(t.substr(r,2)),e[Qo]=Be(t.substr(i)),Ie(n).bigHour=!0});dt("Hmm",function(t,e,n){var r=t.length-2;e[fn]=Be(t.substr(0,r)),e[Pi]=Be(t.substr(r))});dt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[fn]=Be(t.substr(0,r)),e[Pi]=Be(t.substr(r,2)),e[Qo]=Be(t.substr(i))});function gY(t){return(t+"").toLowerCase().charAt(0)==="p"}var mY=/[ap]\.?m?\.?/i,pY=Cc("Hours",!0);function wY(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var FD={calendar:oz,longDateFormat:uz,invalidDate:hz,ordinal:fz,dayOfMonthOrdinalParse:gz,relativeTime:pz,months:Az,monthsShort:OD,week:Uz,weekdays:Zz,weekdaysMin:Jz,weekdaysShort:kD,meridiemParse:mY},_t={},Lc={},pd;function vY(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function kO(t){return t&&t.toLowerCase().replace("_","-")}function CY(t){for(var e=0,n,r,i,o;e<t.length;){for(o=kO(t[e]).split("-"),n=o.length,r=kO(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=$p(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&vY(o,r)>=n-1)break;n--}e++}return pd}function yY(t){return!!(t&&t.match("^[^/\\\\]*$"))}function $p(t){var e=null,n;if(_t[t]===void 0&&typeof module<"u"&&module&&module.exports&&yY(t))try{e=pd._abbr,n=require,n("./locale/"+t),ea(e)}catch{_t[t]=null}return _t[t]}function ea(t,e){var n;return t&&(lr(e)?n=fs(t):n=vE(t,e),n?pd=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),pd._abbr}function vE(t,e){if(e!==null){var n,r=FD;if(e.abbr=t,_t[t]!=null)SD("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=_t[t]._config;else if(e.parentLocale!=null)if(_t[e.parentLocale]!=null)r=_t[e.parentLocale]._config;else if(n=$p(e.parentLocale),n!=null)r=n._config;else return Lc[e.parentLocale]||(Lc[e.parentLocale]=[]),Lc[e.parentLocale].push({name:t,config:e}),null;return _t[t]=new lE(FS(r,e)),Lc[t]&&Lc[t].forEach(function(i){vE(i.name,i.config)}),ea(t),_t[t]}else return delete _t[t],null}function bY(t,e){if(e!=null){var n,r,i=FD;_t[t]!=null&&_t[t].parentLocale!=null?_t[t].set(FS(_t[t]._config,e)):(r=$p(t),r!=null&&(i=r._config),e=FS(i,e),r==null&&(e.abbr=t),n=new lE(e),n.parentLocale=_t[t],_t[t]=n),ea(t)}else _t[t]!=null&&(_t[t].parentLocale!=null?(_t[t]=_t[t].parentLocale,t===ea()&&ea(t)):_t[t]!=null&&delete _t[t]);return _t[t]}function fs(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return pd;if(!Ai(t)){if(e=$p(t),e)return e;t=[t]}return CY(t)}function SY(){return VS(_t)}function CE(t){var e,n=t._a;return n&&Ie(t).overflow===-2&&(e=n[Jo]<0||n[Jo]>11?Jo:n[ho]<1||n[ho]>gE(n[kn],n[Jo])?ho:n[fn]<0||n[fn]>24||n[fn]===24&&(n[Pi]!==0||n[Qo]!==0||n[il]!==0)?fn:n[Pi]<0||n[Pi]>59?Pi:n[Qo]<0||n[Qo]>59?Qo:n[il]<0||n[il]>999?il:-1,Ie(t)._overflowDayOfYear&&(e<kn||e>ho)&&(e=ho),Ie(t)._overflowWeeks&&e===-1&&(e=_z),Ie(t)._overflowWeekday&&e===-1&&(e=Mz),Ie(t).overflow=e),t}var RY=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,EY=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,TY=/Z|[+-]\d\d(?::?\d\d)?/,vf=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],ly=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],_Y=/^\/?Date\((-?\d+)/i,MY=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,IY={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function VD(t){var e,n,r=t._i,i=RY.exec(r)||EY.exec(r),o,s,a,l,u=vf.length,c=ly.length;if(i){for(Ie(t).iso=!0,e=0,n=u;e<n;e++)if(vf[e][1].exec(i[1])){s=vf[e][0],o=vf[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(ly[e][1].exec(i[3])){a=(i[2]||" ")+ly[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(TY.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),bE(t)}else t._isValid=!1}function PY(t,e,n,r,i,o){var s=[OY(t),OD.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function OY(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function xY(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function AY(t,e,n){if(t){var r=kD.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ie(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function HY(t,e,n){if(t)return IY[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function WD(t){var e=MY.exec(xY(t._i)),n;if(e){if(n=PY(e[4],e[3],e[2],e[5],e[6],e[7]),!AY(e[1],n,t))return;t._a=n,t._tzm=HY(e[8],e[9],e[10]),t._d=gd.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ie(t).rfc2822=!0}else t._isValid=!1}function NY(t){var e=_Y.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(VD(t),t._isValid===!1)delete t._isValid;else return;if(WD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=si("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function _u(t,e,n){return t??e??n}function DY(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function yE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=DY(t),t._w&&t._a[ho]==null&&t._a[Jo]==null&&kY(t),t._dayOfYear!=null&&(s=_u(t._a[kn],i[kn]),(t._dayOfYear>Wh(s)||t._dayOfYear===0)&&(Ie(t)._overflowDayOfYear=!0),n=gd(s,0,t._dayOfYear),t._a[Jo]=n.getUTCMonth(),t._a[ho]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[fn]===24&&t._a[Pi]===0&&t._a[Qo]===0&&t._a[il]===0&&(t._nextDay=!0,t._a[fn]=0),t._d=(t._useUTC?gd:Bz).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[fn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ie(t).weekdayMismatch=!0)}}function kY(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=_u(e.GG,t._a[kn],md(St(),1,4).year),r=_u(e.W,1),i=_u(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=md(St(),o,s),n=_u(e.gg,t._a[kn],u.year),r=_u(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>ss(n,o,s)?Ie(t)._overflowWeeks=!0:l!=null?Ie(t)._overflowWeekday=!0:(a=DD(n,r,i,o,s),t._a[kn]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function bE(t){if(t._f===Z.ISO_8601){VD(t);return}if(t._f===Z.RFC_2822){WD(t);return}t._a=[],Ie(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=RD(t._f,t._locale).match(uE)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(Rz(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ie(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Bu[o]?(r?Ie(t).empty=!1:Ie(t).unusedTokens.push(o),Tz(o,r,t)):t._strict&&!r&&Ie(t).unusedTokens.push(o);Ie(t).charsLeftOver=a-l,e.length>0&&Ie(t).unusedInput.push(e),t._a[fn]<=12&&Ie(t).bigHour===!0&&t._a[fn]>0&&(Ie(t).bigHour=void 0),Ie(t).parsedDateParts=t._a.slice(0),Ie(t).meridiem=t._meridiem,t._a[fn]=LY(t._locale,t._a[fn],t._meridiem),u=Ie(t).era,u!==null&&(t._a[kn]=t._locale.erasConvertYear(u,t._a[kn])),yE(t),CE(t)}function LY(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function $Y(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ie(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=aE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],bE(e),sE(e)&&(s=!0),o+=Ie(e).charsLeftOver,o+=Ie(e).unusedTokens.length*10,Ie(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Ys(t,n||e)}function FY(t){if(!t._d){var e=cE(t._i),n=e.day===void 0?e.date:e.day;t._a=yD([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),yE(t)}}function VY(t){var e=new Ud(CE(BD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function BD(t){var e=t._i,n=t._f;return t._locale=t._locale||fs(t._l),e===null||n===void 0&&e===""?xp({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Hi(e)?new Ud(CE(e)):(jd(e)?t._d=e:Ai(n)?$Y(t):n?bE(t):WY(t),sE(t)||(t._d=null),t))}function WY(t){var e=t._i;lr(e)?t._d=new Date(Z.now()):jd(e)?t._d=new Date(e.valueOf()):typeof e=="string"?NY(t):Ai(e)?(t._a=yD(e.slice(0),function(n){return parseInt(n,10)}),yE(t)):fl(e)?FY(t):ls(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function jD(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(fl(t)&&oE(t)||Ai(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,VY(o)}function St(t,e,n,r){return jD(t,e,n,r,!1)}var BY=si("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=St.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:xp()}),jY=si("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=St.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:xp()});function UD(t,e){var n,r;if(e.length===1&&Ai(e[0])&&(e=e[0]),!e.length)return St();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function UY(){var t=[].slice.call(arguments,0);return UD("isBefore",t)}function zY(){var t=[].slice.call(arguments,0);return UD("isAfter",t)}var YY=function(){return Date.now?Date.now():+new Date},$c=["year","quarter","month","week","day","hour","minute","second","millisecond"];function GY(t){var e,n=!1,r,i=$c.length;for(e in t)if(Je(t,e)&&!(zt.call($c,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[$c[r]]){if(n)return!1;parseFloat(t[$c[r]])!==Be(t[$c[r]])&&(n=!0)}return!0}function qY(){return this._isValid}function KY(){return $i(NaN)}function Fp(t){var e=cE(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=GY(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=fs(),this._bubble()}function tm(t){return t instanceof Fp}function BS(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function XY(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Be(t[s])!==Be(e[s])&&o++;return o+i}function zD(t,e){ve(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Co(~~(n/60),2)+e+Co(~~n%60,2)})}zD("Z",":");zD("ZZ","");ue("Z",kp);ue("ZZ",kp);dt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=SE(kp,t)});var ZY=/([\+\-]|\d\d)/gi;function SE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(ZY)||["-",0,0],o=+(i[1]*60)+Be(i[2]),o===0?0:i[0]==="+"?o:-o)}function RE(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Hi(t)||jd(t)?t.valueOf():St(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Z.updateOffset(n,!1),n):St(t).local()}function jS(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function JY(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=SE(kp,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=jS(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?qD(this,$i(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:jS(this)}function QY(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function eG(t){return this.utcOffset(0,t)}function tG(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(jS(this),"m")),this}function nG(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=SE(bz,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function rG(t){return this.isValid()?(t=t?St(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function iG(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function oG(){if(!lr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return aE(t,this),t=BD(t),t._a?(e=t._isUTC?Ro(t._a):St(t._a),this._isDSTShifted=this.isValid()&&XY(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function sG(){return this.isValid()?!this._isUTC:!1}function aG(){return this.isValid()?this._isUTC:!1}function YD(){return this.isValid()?this._isUTC&&this._offset===0:!1}var lG=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,uG=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function $i(t,e){var n=t,r=null,i,o,s;return tm(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:ls(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=lG.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Be(r[ho])*i,h:Be(r[fn])*i,m:Be(r[Pi])*i,s:Be(r[Qo])*i,ms:Be(BS(r[il]*1e3))*i}):(r=uG.exec(t))?(i=r[1]==="-"?-1:1,n={y:ga(r[2],i),M:ga(r[3],i),w:ga(r[4],i),d:ga(r[5],i),h:ga(r[6],i),m:ga(r[7],i),s:ga(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=cG(St(n.from),St(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Fp(n),tm(t)&&Je(t,"_locale")&&(o._locale=t._locale),tm(t)&&Je(t,"_isValid")&&(o._isValid=t._isValid),o}$i.fn=Fp.prototype;$i.invalid=KY;function ga(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function LO(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function cG(t,e){var n;return t.isValid()&&e.isValid()?(e=RE(e,t),t.isBefore(e)?n=LO(t,e):(n=LO(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function GD(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(SD(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=$i(n,r),qD(this,i,t),this}}function qD(t,e,n,r){var i=e._milliseconds,o=BS(e._days),s=BS(e._months);t.isValid()&&(r=r??!0,s&&AD(t,fd(t,"Month")+s*n),o&&PD(t,"Date",fd(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Z.updateOffset(t,o||s))}var hG=GD(1,"add"),dG=GD(-1,"subtract");function KD(t){return typeof t=="string"||t instanceof String}function fG(t){return Hi(t)||jd(t)||KD(t)||ls(t)||mG(t)||gG(t)||t===null||t===void 0}function gG(t){var e=fl(t)&&!oE(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||Je(t,o);return e&&n}function mG(t){var e=Ai(t),n=!1;return e&&(n=t.filter(function(r){return!ls(r)&&KD(t)}).length===0),e&&n}function pG(t){var e=fl(t)&&!oE(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||Je(t,o);return e&&n}function wG(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function vG(t,e){arguments.length===1&&(arguments[0]?fG(arguments[0])?(t=arguments[0],e=void 0):pG(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||St(),r=RE(n,this).startOf("day"),i=Z.calendarFormat(this,r)||"sameElse",o=e&&(Eo(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,St(n)))}function CG(){return new Ud(this)}function yG(t,e){var n=Hi(t)?t:St(t);return this.isValid()&&n.isValid()?(e=ai(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function bG(t,e){var n=Hi(t)?t:St(t);return this.isValid()&&n.isValid()?(e=ai(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function SG(t,e,n,r){var i=Hi(t)?t:St(t),o=Hi(e)?e:St(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function RG(t,e){var n=Hi(t)?t:St(t),r;return this.isValid()&&n.isValid()?(e=ai(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function EG(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function TG(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function _G(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=RE(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=ai(e),e){case"year":o=nm(this,r)/12;break;case"month":o=nm(this,r);break;case"quarter":o=nm(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Zr(o)}function nm(t,e){if(t.date()<e.date())return-nm(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function MG(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function IG(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?em(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Eo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",em(n,"Z")):em(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function PG(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function OG(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=em(this,t);return this.localeData().postformat(e)}function xG(t,e){return this.isValid()&&(Hi(t)&&t.isValid()||St(t).isValid())?$i({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function AG(t){return this.from(St(),t)}function HG(t,e){return this.isValid()&&(Hi(t)&&t.isValid()||St(t).isValid())?$i({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function NG(t){return this.to(St(),t)}function XD(t){var e;return t===void 0?this._locale._abbr:(e=fs(t),e!=null&&(this._locale=e),this)}var ZD=si("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function JD(){return this._locale}var _m=1e3,ju=60*_m,Mm=60*ju,QD=(365*400+97)*24*Mm;function Uu(t,e){return(t%e+e)%e}function ek(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-QD:new Date(t,e,n).valueOf()}function tk(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-QD:Date.UTC(t,e,n)}function DG(t){var e,n;if(t=ai(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?tk:ek,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Uu(e+(this._isUTC?0:this.utcOffset()*ju),Mm);break;case"minute":e=this._d.valueOf(),e-=Uu(e,ju);break;case"second":e=this._d.valueOf(),e-=Uu(e,_m);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function kG(t){var e,n;if(t=ai(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?tk:ek,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Mm-Uu(e+(this._isUTC?0:this.utcOffset()*ju),Mm)-1;break;case"minute":e=this._d.valueOf(),e+=ju-Uu(e,ju)-1;break;case"second":e=this._d.valueOf(),e+=_m-Uu(e,_m)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function LG(){return this._d.valueOf()-(this._offset||0)*6e4}function $G(){return Math.floor(this.valueOf()/1e3)}function FG(){return new Date(this.valueOf())}function VG(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function WG(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function BG(){return this.isValid()?this.toISOString():null}function jG(){return sE(this)}function UG(){return Ys({},Ie(this))}function zG(){return Ie(this).overflow}function YG(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ve("N",0,0,"eraAbbr");ve("NN",0,0,"eraAbbr");ve("NNN",0,0,"eraAbbr");ve("NNNN",0,0,"eraName");ve("NNNNN",0,0,"eraNarrow");ve("y",["y",1],"yo","eraYear");ve("y",["yy",2],0,"eraYear");ve("y",["yyy",3],0,"eraYear");ve("y",["yyyy",4],0,"eraYear");ue("N",EE);ue("NN",EE);ue("NNN",EE);ue("NNNN",r2);ue("NNNNN",i2);dt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ie(n).era=i:Ie(n).invalidEra=t});ue("y",wc);ue("yy",wc);ue("yyy",wc);ue("yyyy",wc);ue("yo",o2);dt(["y","yy","yyy","yyyy"],kn);dt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[kn]=n._locale.eraYearOrdinalParse(t,i):e[kn]=parseInt(t,10)});function GG(t,e){var n,r,i,o=this._eras||fs("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Z(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Z(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function qG(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function KG(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function XG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function ZG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function JG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function QG(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Z(i[t].since).year())*n+i[t].offset;return this.year()}function e2(t){return Je(this,"_erasNameRegex")||TE.call(this),t?this._erasNameRegex:this._erasRegex}function t2(t){return Je(this,"_erasAbbrRegex")||TE.call(this),t?this._erasAbbrRegex:this._erasRegex}function n2(t){return Je(this,"_erasNarrowRegex")||TE.call(this),t?this._erasNarrowRegex:this._erasRegex}function EE(t,e){return e.erasAbbrRegex(t)}function r2(t,e){return e.erasNameRegex(t)}function i2(t,e){return e.erasNarrowRegex(t)}function o2(t,e){return e._eraYearOrdinalRegex||wc}function TE(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=os(u[i].name),a=os(u[i].abbr),l=os(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}ve(0,["gg",2],0,function(){return this.weekYear()%100});ve(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Vp(t,e){ve(0,[t,t.length],0,e)}Vp("gggg","weekYear");Vp("ggggg","weekYear");Vp("GGGG","isoWeekYear");Vp("GGGGG","isoWeekYear");ue("G",Dp);ue("g",Dp);ue("GG",Rt,Dr);ue("gg",Rt,Dr);ue("GGGG",dE,hE);ue("gggg",dE,hE);ue("GGGGG",Np,Ap);ue("ggggg",Np,Ap);Yd(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Be(t)});Yd(["gg","GG"],function(t,e,n,r){e[r]=Z.parseTwoDigitYear(t)});function s2(t){return nk.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function a2(t){return nk.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function l2(){return ss(this.year(),1,4)}function u2(){return ss(this.isoWeekYear(),1,4)}function c2(){var t=this.localeData()._week;return ss(this.year(),t.dow,t.doy)}function h2(){var t=this.localeData()._week;return ss(this.weekYear(),t.dow,t.doy)}function nk(t,e,n,r,i){var o;return t==null?md(this,r,i).year:(o=ss(t,r,i),e>o&&(e=o),d2.call(this,t,e,n,r,i))}function d2(t,e,n,r,i){var o=DD(t,e,n,r,i),s=gd(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}ve("Q",0,"Qo","quarter");ue("Q",ED);dt("Q",function(t,e){e[Jo]=(Be(t)-1)*3});function f2(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}ve("D",["DD",2],"Do","date");ue("D",Rt,vc);ue("DD",Rt,Dr);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});dt(["D","DD"],ho);dt("Do",function(t,e){e[ho]=Be(t.match(Rt)[0])});var rk=Cc("Date",!0);ve("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Hp);ue("DDDD",TD);dt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Be(t)});function g2(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}ve("m",["mm",2],0,"minute");ue("m",Rt,fE);ue("mm",Rt,Dr);dt(["m","mm"],Pi);var m2=Cc("Minutes",!1);ve("s",["ss",2],0,"second");ue("s",Rt,fE);ue("ss",Rt,Dr);dt(["s","ss"],Qo);var p2=Cc("Seconds",!1);ve("S",0,0,function(){return~~(this.millisecond()/100)});ve(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ve(0,["SSS",3],0,"millisecond");ve(0,["SSSS",4],0,function(){return this.millisecond()*10});ve(0,["SSSSS",5],0,function(){return this.millisecond()*100});ve(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ve(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ve(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ve(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Hp,ED);ue("SS",Hp,Dr);ue("SSS",Hp,TD);var Gs,ik;for(Gs="SSSS";Gs.length<=9;Gs+="S")ue(Gs,wc);function w2(t,e){e[il]=Be(("0."+t)*1e3)}for(Gs="S";Gs.length<=9;Gs+="S")dt(Gs,w2);ik=Cc("Milliseconds",!1);ve("z",0,0,"zoneAbbr");ve("zz",0,0,"zoneName");function v2(){return this._isUTC?"UTC":""}function C2(){return this._isUTC?"Coordinated Universal Time":""}var J=Ud.prototype;J.add=hG;J.calendar=vG;J.clone=CG;J.diff=_G;J.endOf=kG;J.format=OG;J.from=xG;J.fromNow=AG;J.to=HG;J.toNow=NG;J.get=Pz;J.invalidAt=zG;J.isAfter=yG;J.isBefore=bG;J.isBetween=SG;J.isSame=RG;J.isSameOrAfter=EG;J.isSameOrBefore=TG;J.isValid=jG;J.lang=ZD;J.locale=XD;J.localeData=JD;J.max=jY;J.min=BY;J.parsingFlags=UG;J.set=Oz;J.startOf=DG;J.subtract=dG;J.toArray=VG;J.toObject=WG;J.toDate=FG;J.toISOString=IG;J.inspect=PG;typeof Symbol<"u"&&Symbol.for!=null&&(J[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});J.toJSON=BG;J.toString=MG;J.unix=$G;J.valueOf=LG;J.creationData=YG;J.eraName=XG;J.eraNarrow=ZG;J.eraAbbr=JG;J.eraYear=QG;J.year=ID;J.isLeapYear=Iz;J.weekYear=s2;J.isoWeekYear=a2;J.quarter=J.quarters=f2;J.month=HD;J.daysInMonth=Fz;J.week=J.weeks=Gz;J.isoWeek=J.isoWeeks=qz;J.weeksInYear=c2;J.weeksInWeekYear=h2;J.isoWeeksInYear=l2;J.isoWeeksInISOWeekYear=u2;J.date=rk;J.day=J.days=aY;J.weekday=lY;J.isoWeekday=uY;J.dayOfYear=g2;J.hour=J.hours=pY;J.minute=J.minutes=m2;J.second=J.seconds=p2;J.millisecond=J.milliseconds=ik;J.utcOffset=JY;J.utc=eG;J.local=tG;J.parseZone=nG;J.hasAlignedHourOffset=rG;J.isDST=iG;J.isLocal=sG;J.isUtcOffset=aG;J.isUtc=YD;J.isUTC=YD;J.zoneAbbr=v2;J.zoneName=C2;J.dates=si("dates accessor is deprecated. Use date instead.",rk);J.months=si("months accessor is deprecated. Use month instead",HD);J.years=si("years accessor is deprecated. Use year instead",ID);J.zone=si("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",QY);J.isDSTShifted=si("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",oG);function y2(t){return St(t*1e3)}function b2(){return St.apply(null,arguments).parseZone()}function ok(t){return t}var Qe=lE.prototype;Qe.calendar=sz;Qe.longDateFormat=cz;Qe.invalidDate=dz;Qe.ordinal=mz;Qe.preparse=ok;Qe.postformat=ok;Qe.relativeTime=wz;Qe.pastFuture=vz;Qe.set=iz;Qe.eras=GG;Qe.erasParse=qG;Qe.erasConvertYear=KG;Qe.erasAbbrRegex=t2;Qe.erasNameRegex=e2;Qe.erasNarrowRegex=n2;Qe.months=Dz;Qe.monthsShort=kz;Qe.monthsParse=$z;Qe.monthsRegex=Wz;Qe.monthsShortRegex=Vz;Qe.week=jz;Qe.firstDayOfYear=Yz;Qe.firstDayOfWeek=zz;Qe.weekdays=nY;Qe.weekdaysMin=iY;Qe.weekdaysShort=rY;Qe.weekdaysParse=sY;Qe.weekdaysRegex=cY;Qe.weekdaysShortRegex=hY;Qe.weekdaysMinRegex=dY;Qe.isPM=gY;Qe.meridiem=wY;function Im(t,e,n,r){var i=fs(),o=Ro().set(r,e);return i[n](o,t)}function sk(t,e,n){if(ls(t)&&(e=t,t=void 0),t=t||"",e!=null)return Im(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Im(t,r,n,"month");return i}function _E(t,e,n,r){typeof t=="boolean"?(ls(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,ls(e)&&(n=e,e=void 0),e=e||"");var i=fs(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Im(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Im(e,(s+o)%7,r,"day");return a}function S2(t,e){return sk(t,e,"months")}function R2(t,e){return sk(t,e,"monthsShort")}function E2(t,e,n){return _E(t,e,n,"weekdays")}function T2(t,e,n){return _E(t,e,n,"weekdaysShort")}function _2(t,e,n){return _E(t,e,n,"weekdaysMin")}ea("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Be(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=si("moment.lang is deprecated. Use moment.locale instead.",ea);Z.langData=si("moment.langData is deprecated. Use moment.localeData instead.",fs);var Po=Math.abs;function M2(){var t=this._data;return this._milliseconds=Po(this._milliseconds),this._days=Po(this._days),this._months=Po(this._months),t.milliseconds=Po(t.milliseconds),t.seconds=Po(t.seconds),t.minutes=Po(t.minutes),t.hours=Po(t.hours),t.months=Po(t.months),t.years=Po(t.years),this}function ak(t,e,n,r){var i=$i(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function I2(t,e){return ak(this,t,e,1)}function P2(t,e){return ak(this,t,e,-1)}function $O(t){return t<0?Math.floor(t):Math.ceil(t)}function O2(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=$O(US(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Zr(t/1e3),r.seconds=i%60,o=Zr(i/60),r.minutes=o%60,s=Zr(o/60),r.hours=s%24,e+=Zr(s/24),l=Zr(lk(e)),n+=l,e-=$O(US(l)),a=Zr(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function lk(t){return t*4800/146097}function US(t){return t*146097/4800}function x2(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=ai(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+lk(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(US(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function gs(t){return function(){return this.as(t)}}var uk=gs("ms"),A2=gs("s"),H2=gs("m"),N2=gs("h"),D2=gs("d"),k2=gs("w"),L2=gs("M"),$2=gs("Q"),F2=gs("y"),V2=uk;function W2(){return $i(this)}function B2(t){return t=ai(t),this.isValid()?this[t+"s"]():NaN}function Hl(t){return function(){return this.isValid()?this._data[t]:NaN}}var j2=Hl("milliseconds"),U2=Hl("seconds"),z2=Hl("minutes"),Y2=Hl("hours"),G2=Hl("days"),q2=Hl("months"),K2=Hl("years");function X2(){return Zr(this.days()/7)}var Go=Math.round,ku={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Z2(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function J2(t,e,n,r){var i=$i(t).abs(),o=Go(i.as("s")),s=Go(i.as("m")),a=Go(i.as("h")),l=Go(i.as("d")),u=Go(i.as("M")),c=Go(i.as("w")),h=Go(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,Z2.apply(null,d)}function Q2(t){return t===void 0?Go:typeof t=="function"?(Go=t,!0):!1}function eq(t,e){return ku[t]===void 0?!1:e===void 0?ku[t]:(ku[t]=e,t==="s"&&(ku.ss=e-1),!0)}function tq(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=ku,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},ku,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=J2(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var uy=Math.abs;function Fl(t){return(t>0)-(t<0)||+t}function Wp(){if(!this.isValid())return this.localeData().invalidDate();var t=uy(this._milliseconds)/1e3,e=uy(this._days),n=uy(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Zr(t/60),i=Zr(r/60),t%=60,r%=60,o=Zr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Fl(this._months)!==Fl(a)?"-":"",c=Fl(this._days)!==Fl(a)?"-":"",h=Fl(this._milliseconds)!==Fl(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ge=Fp.prototype;Ge.isValid=qY;Ge.abs=M2;Ge.add=I2;Ge.subtract=P2;Ge.as=x2;Ge.asMilliseconds=uk;Ge.asSeconds=A2;Ge.asMinutes=H2;Ge.asHours=N2;Ge.asDays=D2;Ge.asWeeks=k2;Ge.asMonths=L2;Ge.asQuarters=$2;Ge.asYears=F2;Ge.valueOf=V2;Ge._bubble=O2;Ge.clone=W2;Ge.get=B2;Ge.milliseconds=j2;Ge.seconds=U2;Ge.minutes=z2;Ge.hours=Y2;Ge.days=G2;Ge.weeks=X2;Ge.months=q2;Ge.years=K2;Ge.humanize=tq;Ge.toISOString=Wp;Ge.toString=Wp;Ge.toJSON=Wp;Ge.locale=XD;Ge.localeData=JD;Ge.toIsoString=si("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Wp);Ge.lang=ZD;ve("X",0,0,"unix");ve("x",0,0,"valueOf");ue("x",Dp);ue("X",Sz);dt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});dt("x",function(t,e,n){n._d=new Date(Be(t))});//! moment.js
Z.version="2.30.1";nz(St);Z.fn=J;Z.min=UY;Z.max=zY;Z.now=YY;Z.utc=Ro;Z.unix=y2;Z.months=S2;Z.isDate=jd;Z.locale=ea;Z.invalid=xp;Z.duration=$i;Z.isMoment=Hi;Z.weekdays=E2;Z.parseZone=b2;Z.localeData=fs;Z.isDuration=tm;Z.monthsShort=R2;Z.weekdaysMin=_2;Z.defineLocale=vE;Z.updateLocale=bY;Z.locales=SY;Z.weekdaysShort=T2;Z.normalizeUnits=ai;Z.relativeTimeRounding=Q2;Z.relativeTimeThreshold=eq;Z.calendarFormat=wG;Z.prototype=J;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function nq(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function FO(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function rm(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function vr(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function wl(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function We(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function A(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function rq(t){const e=[];return A(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function VO(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return A(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function WO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function nt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return vr(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function It(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function Mt(t){return typeof t>"u"}function Wt(t){return t===null||t===""||Mt(t)}function iq(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Nh="length",Bh=t=>parseInt(t,16),BO=t=>parseInt(t,10),Pm=(t,e,n)=>t.substr(e,n),jh=t=>t.codePointAt(0)-65,zS=t=>`${t}`.replace(/\-/g,""),oq=t=>Bh(Pm(zS(t),Bh("12"),jh("F")))/(Bh(Pm(zS(t),jh("B"),~~![][Nh]))||9),sq=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let jO=!1;const UO={invalid:()=>nt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return nt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>nt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},zO={invalid:()=>nt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return nt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>nt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function aq(t,e){const n=!Wt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.0.1";let o,s="invalid",a="invalid";t=zS(t||"");const l=lq(t);if(n||r||l)if(l){const u=Z("10/07/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=oq(t);o=Z((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(sq()&&(s="valid",a="valid"),!jO&&s!=="valid"&&(UO[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](UO[s]({keyValidityDate:o,hotVersion:i})),jO=!0),a!=="valid"&&e&&zO[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=zO[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function lq(t){let e=[][Nh],n=e;if(t[Nh]!==jh("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=jh(i.shift());o;o=jh(i.shift()||"A"))--o<""[Nh]?n=n|(BO(`${BO(Bh(r)+(Bh(Pm(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Pm(t,o,o?i[Nh]===1?9:8:6);return n===e}function Ni(t){return t[0].toUpperCase()+t.substr(1)}function ck(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function hk(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function dk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function YO(t){return ME(`${t}`,{ALLOWED_TAGS:[]})}function ME(t,e){return tz.sanitize(t,e)}const ua=t=>["tabindex",t],uq=()=>["role","treegrid"],es=()=>["role","presentation"],cq=()=>["role","gridcell"],hq=()=>["role","gridcell button"],dq=()=>["role","rowheader"],fk=()=>["role","rowgroup"],fq=()=>["role","columnheader"],gk=()=>["role","row"],gq=()=>["role","menu"],mq=()=>["role","menuitem"],pq=()=>["role","menuitemcheckbox"],wq=()=>["role","combobox"],mk=()=>["role","listbox"],vq=()=>["role","option"],Cq=()=>["role","checkbox"],yq=()=>["scope","col"],bq=()=>["scope","row"],Sq=()=>["type","text"],tc=t=>["aria-label",t],Nl=()=>["aria-hidden","true"],Rq=()=>["aria-disabled","true"],Eq=()=>["aria-multiselectable","true"],pk=t=>["aria-haspopup",t],wk=t=>["aria-rowcount",t],Bp=t=>["aria-colcount",t],vk=t=>["aria-rowindex",t],IE=t=>["aria-colindex",t],ti=t=>["aria-expanded",t],Tq=t=>["aria-sort",t],GO=()=>["aria-readonly","true"],qO=()=>["aria-invalid","true"],Ck=t=>["aria-checked",t],PE=()=>["aria-selected","true"],_q=()=>["aria-autocomplete","list"],Mq=t=>["aria-controls",t],Iq=t=>["aria-activedescendant",t],Pq=t=>["aria-live",t],Oq=t=>["aria-relevant",t],xq=t=>["aria-setsize",t],Aq=t=>["aria-posinset",t];var KO={},cy,XO;function Hq(){if(XO)return cy;XO=1;var t=qt(),e=eD(),n=sn(),r=Il(),i=Op(),o=t([].push);return cy=function(s){if(n(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(f,g){if(d)return d=!1,g;if(e(this))return g;for(var w=0;w<h;w++)if(l[w]===f)return g}}},cy}var ZO;function Nq(){if(ZO)return KO;ZO=1;var t=gt(),e=dc(),n=Vd(),r=on(),i=qt(),o=rn(),s=sn(),a=zR(),l=iE(),u=Hq(),c=UR(),h=String,d=e("JSON","stringify"),f=i(/./.exec),g=i("".charAt),w=i("".charCodeAt),C=i("".replace),S=i(1.1.toString),v=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,M=/^[\uDC00-\uDFFF]$/,x=!c||o(function(){var K=e("Symbol")("stringify detection");return d([K])!=="[null]"||d({a:K})!=="{}"||d(Object(K))!=="{}"}),I=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),P=function(K,N){var Y=l(arguments),X=u(N);if(!(!s(X)&&(K===void 0||a(K))))return Y[1]=function(se,ee){if(s(X)&&(ee=r(X,this,h(se),ee)),!a(ee))return ee},n(d,null,Y)},U=function(K,N,Y){var X=g(Y,N-1),se=g(Y,N+1);return f(T,K)&&!f(M,se)||f(M,K)&&!f(T,X)?"\\u"+S(w(K,0),16):K};return d&&t({target:"JSON",stat:!0,arity:3,forced:x||I},{stringify:function(N,Y,X){var se=l(arguments),ee=n(x?P:d,null,se);return I&&typeof ee=="string"?C(ee,v,U):ee}}),KO}Nq();function wd(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},He(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=wd(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[wd(n[0])]:e[r]=[]:e[r]=null)})),e}function Dq(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function nn(t,e,n){const r=Array.isArray(n);return He(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function jp(t,e){He(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),jp(t[r],e[r])):t[r]=e[r]})}function Xn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function yo(t){const e={};return He(t,(n,r)=>{e[r]=n}),e}function ht(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return A(n,i=>{t.MIXINS.push(i.MIXIN_NAME),He(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let w=g;return(Array.isArray(w)||Ae(w))&&(w=Xn(w)),w};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function OE(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ae(t){return Object.prototype.toString.call(t)==="[object Object]"}function ms(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function He(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function kq(t,e){const n=e.split(".");let r=t;return He(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function hy(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(Qt(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function xE(t){if(!Ae(t))return 0;const e=function(n){let r=0;return Ae(n)?He(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Hr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Qt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Om(t){return window.requestAnimationFrame(t)}function xm(t){window.cancelAnimationFrame(t)}function yk(){return"ontouchstart"in window}function Lq(){return typeof window<"u"}let Vl;function $q(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Vl||(typeof Intl=="object"?Vl=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Vl=(n,r)=>`${n}`.localeCompare(r):Vl=(n,r)=>n===r?0:n>r?-1:1,Vl)}const zr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},ca={chrome:zr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:zr(t=>/CriOS/.test(t)),edge:zr(t=>/Edge/.test(t)),edgeWebKit:zr(t=>/EdgiOS/.test(t)),firefox:zr(t=>/Firefox/.test(t)),firefoxWebKit:zr(t=>/FxiOS/.test(t)),mobile:zr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:zr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Gd={mac:zr(t=>/^Mac/.test(t)),win:zr(t=>/^Win/.test(t)),linux:zr(t=>/^Linux/.test(t)),ios:zr(t=>/iPhone|iPad|iPod/i.test(t))};function Fq(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};He(ca,n=>{let{test:r}=n;return void r(t,e)})}function Vq(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};He(Gd,e=>{let{test:n}=e;return void n(t)})}Lq()&&(Fq(),Vq());function bk(){return ca.chrome.value}function Wq(){return ca.chromeWebKit.value}function dy(){return ca.firefox.value}function Bq(){return ca.firefoxWebKit.value}function vd(){return ca.safari.value}function jq(){return ca.edge.value}function po(){return ca.mobile.value}function Sk(){return Gd.ios.value}function Rk(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Gd.mac.value}function YS(){return Gd.win.value}function JO(){return Gd.mac.value}function Uq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function im(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function zq(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function nc(t){return zq(t)&&t.parent}function vl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Cf(t,e,n){const r=[];let i=t;for(;i&&(i=vl(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function Yq(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function gl(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Gq(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function ma(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function Ek(t){return!t||!t.length?[]:t.filter(e=>!!e)}function Tk(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function ye(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=Ek(e),e.length>0&&t.classList.add(...e)}function we(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=Tk(e,!0);n=Ek(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Ce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function yc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=Tk(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function _k(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)_k(e[n])}}function us(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const qq=/(<(.*)>|&(.*);)/;function bc(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;qq.test(e)?t.innerHTML=n?ME(e):e:Cl(t,e)}function Cl(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(us(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function rc(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return rc(r.host.impl);if(r.host)return rc(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function Kq(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Hn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function Mk(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function AE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function HE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Mk(e):t.scrollTop}function Ik(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?AE(e):t.scrollLeft}function Am(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Xq(t){return t.scrollHeight-t.clientHeight}function Zq(t){return t.scrollWidth-t.clientWidth}function Cd(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Hm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Yt(t){return t.offsetWidth}function tn(t){return t.offsetHeight}function Uh(t){return t.clientHeight||t.innerHeight}function Pk(t){return t.clientWidth||t.innerWidth}function Ok(t){return t.selectionStart?t.selectionStart:0}function Jq(t){return t.selectionEnd?t.selectionEnd:0}function QO(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Up(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let fy;function xk(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return YS()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function Qq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");vd()&&!po()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i+xk(t)}function Cn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return fy===void 0&&(fy=Qq(t)),fy}function Ak(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function Hk(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function NE(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function zp(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function om(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Nk(t){return om(t)&&t.hasAttribute("data-hot-input")===!1}function Dk(t){return!t.parentNode}function eK(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function kk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Ce(t,"contenteditable",!0),n&&Ce(t,...Nl()),e&&q(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function Lk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&we(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function tK(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;kk(t,n),e(),Lk(t,n)}function as(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}function ot(t){return typeof t=="function"}function Yp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function $k(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function nK(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function GS(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:dy()?182:174,AUDIO_MUTE:dy()?181:173,AUDIO_UP:dy()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},rK=[ge.ALT,ge.ARROW_DOWN,ge.ARROW_LEFT,ge.ARROW_RIGHT,ge.ARROW_UP,ge.AUDIO_DOWN,ge.AUDIO_MUTE,ge.AUDIO_UP,ge.BACKSPACE,ge.CAPS_LOCK,ge.DELETE,ge.END,ge.ENTER,ge.ESCAPE,ge.F1,ge.F2,ge.F3,ge.F4,ge.F5,ge.F6,ge.F7,ge.F8,ge.F9,ge.F10,ge.F11,ge.F12,ge.F13,ge.F14,ge.F15,ge.F16,ge.F17,ge.F18,ge.F19,ge.HOME,ge.INSERT,ge.MEDIA_NEXT,ge.MEDIA_PLAY_PAUSE,ge.MEDIA_PREV,ge.MEDIA_STOP,ge.NULL,ge.NUM_LOCK,ge.PAGE_DOWN,ge.PAGE_UP,ge.PAUSE,ge.SCROLL_LOCK,ge.SHIFT,ge.TAB];function iK(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Fk(t){return rK.includes(t)}function oK(t){return[ge.CONTROL,ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX].includes(t)}function qd(t,e){const n=e.split("|");let r=!1;return A(n,i=>{if(t===ge[i])return r=!0,!1}),r}function Fi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function tl(t){return t.isImmediatePropagationEnabled===!1}function yl(t){return t.button===2}function DE(t){return t.button===0}function sK(t){return t instanceof TouchEvent}function aK(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!as(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}function Ke(){le(console)&&console.warn(...arguments)}function kE(){le(console)&&console.error(...arguments)}const nl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],gy=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),my=new Map([[]]);var ex={},py,tx;function lK(){if(tx)return py;tx=1;var t=mc();return py=function(e,n,r){for(var i=0,o=arguments.length>2?r:t(n),s=new e(o);o>i;)s[i]=n[i++];return s},py}var wy,nx;function uK(){if(nx)return wy;nx=1;var t=Gt();return wy=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},wy}var vy,rx;function Gp(){if(rx)return vy;rx=1;var t=Li(),e=tE(),n=aa().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),vy=function(o){i[r][o]=!0},vy}var ix;function cK(){if(ix)return ex;ix=1;var t=gt(),e=qt(),n=pr(),r=kd(),i=lK(),o=uK(),s=Gp(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),s("toSorted"),ex}cK();var ox={},sx={},ax;function hK(){if(ax)return sx;ax=1;var t=gt(),e=on(),n=pc(),r=pr(),i=an(),o=So(),s=wr(),a=la(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,g){if(c(f,d++))return g(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),sx}var lx;function dK(){return lx||(lx=1,hK()),ox}dK();function fK(t,e){Vk(t,e),e.add(t)}function Cy(t,e,n){Vk(t,e),e.set(t,n)}function Vk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ux(t,e,n){return t.set(Nm(t,e),n),n}function bn(t,e){return t.get(Nm(t,e))}function Nm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gK=100;var Sr=new WeakMap,Mu=new WeakMap,yy=new WeakMap,by=new WeakSet;class cx{constructor(){fK(this,by),Cy(this,Sr,new Map),Cy(this,Mu,new Map),Cy(this,yy,new Set),nl.forEach(e=>Nm(by,this,hx).call(this,e))}getHooks(e){var n;return(n=bn(Sr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};bn(Sr,this).has(e)||(Nm(by,this,hx).call(this,e),nl.push(e));const i=bn(Sr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=bn(yy,this).has(e);!u&&o!==0&&(u=!0,bn(yy,this).add(e)),u&&i.length>1&&bn(Sr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return bn(Sr,this).has(e)&&bn(Sr,this).get(e).length>0}remove(e,n){if(!bn(Sr,this).has(e))return!1;const r=bn(Sr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=bn(Mu,this).get(e);return i.skip=!0,o+=1,o>gK&&(bn(Sr,this).set(e,r.filter(s=>!s.skip)),o=0),bn(Mu,this).set(e,o),!0}return!1}destroy(){bn(Sr,this).clear(),bn(Mu,this).clear(),ux(Sr,this,null),ux(Mu,this,null)}}function hx(t){bn(Sr,this).set(t,[]),bn(Mu,this).set(t,0)}function mK(t,e,n){return(e=pK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pK(t){var e=wK(t,"string");return typeof e=="symbol"?e:e+""}function wK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const vK=nt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class re{constructor(){mK(this,"globalBucket",new cx)}static getSingleton(){return yK()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new cx),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?A(n,o=>this.add(e,o,r)):(gy.has(e)&&Ke(dk(vK,{hookName:e,removedInVersion:gy.get(e)})),my.has(e)&&Ke(my.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?A(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?A(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=GS(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=GS(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||nl.push(e)}deregister(e){this.isRegistered(e)&&nl.splice(nl.indexOf(e),1)}isDeprecated(e){return my.has(e)||gy.has(e)}isRegistered(e){return nl.indexOf(e)>=0}getRegistered(){return nl}}const CK=new re;function yK(){return CK}const ol=new Map;function li(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";ol.has(t)||ol.set(t,new Map);const e=ol.get(t);function n(l,u){e.set(l,u)}function r(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){ol.delete(t),e.clear()}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s,clear:a}}function bK(t,e){var n;return ol==null||(n=ol.get(t.guid))===null||n===void 0?void 0:n.get(e)}const qS=new WeakMap,{register:SK,getItem:Wk,hasItem:Bk,getNames:Jde,getValues:Qde}=li("editors");function RK(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},re.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function jk(t,e){let n;if(typeof t=="function")qS.get(t)||Er(null,t),n=qS.get(t);else if(typeof t=="string")n=Wk(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function dx(t){if(typeof t=="function")return t;if(!Bk(t))throw Error(`No registered editor found under "${t}" name`);return Wk(t).getConstructor()}function Er(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new RK(e);typeof t=="string"&&SK(t,n),qS.set(e,n)}function EK(t,e,n){return(e=TK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TK(t){var e=_K(t,"string");return typeof e=="symbol"?e:e+""}function _K(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Di{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;EK(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,MK(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function MK(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Fi(this)},t}function IK(t,e){PK(t,e),e.add(t)}function PK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pa(t,e,n){return(e=OK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OK(t){var e=xK(t,"string");return typeof e=="symbol"?e:e+""}function xK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yf=new WeakSet;class KS{constructor(e,n,r){IK(this,yf),pa(this,"hot",void 0),pa(this,"tableMeta",void 0),pa(this,"selection",void 0),pa(this,"eventManager",void 0),pa(this,"destroyed",!1),pa(this,"activeEditor",void 0),pa(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Di(e),this.hot.addHook("afterDocumentKeyDown",i=>Sy(yf,this,fx).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>Sy(yf,this,fx).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>Sy(yf,this,AK).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=jk(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function fx(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||tl(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Fk(n)&&!oK(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function AK(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const gx=new WeakMap;KS.getInstance=function(t,e,n){let r=gx.get(t);return r||(r=new KS(t,e,n),gx.set(t,r)),r};function HK(t,e){Uk(t,e),e.add(t)}function Fc(t,e,n){Uk(t,e),e.set(t,n)}function Uk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pt(t,e){return t.get(Zo(t,e))}function Vc(t,e,n){return t.set(Zo(t,e),n),n}function Zo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zu=Object.freeze({CELL:"cell",MIXED:"mixed"});var Jt=new WeakMap,bf=new WeakMap,Sf=new WeakMap,Rf=new WeakMap,Ef=new WeakMap,$s=new WeakSet;class NK{constructor(e){var n=this;HK(this,$s),Fc(this,Jt,void 0),Fc(this,bf,void 0),Fc(this,Sf,1),Fc(this,Rf,null),Fc(this,Ef,new Map);const r=e.getSettings();Vc(Jt,this,e),Vc(bf,this,r.imeFastEdit?zu.MIXED:zu.CELL),pt(Jt,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Zo($s,n,kK).call(n,...o)}),pt(Jt,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Zo($s,n,mx).call(n,...o)}),pt(Jt,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Zo($s,n,mx).call(n,...o)}),pt(Jt,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Zo($s,n,DK).call(n,...o)})}getFocusMode(){return pt(bf,this)}setFocusMode(e){Object.values(zu).includes(e)?Vc(bf,this,e):Ke(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return pt(Sf,this)}setRefocusDelay(e){Vc(Sf,this,e)}setRefocusElementGetter(e){Vc(Rf,this,e)}getRefocusElement(){var e;return typeof pt(Rf,this)=="function"?pt(Rf,this).call(this):(e=pt(Jt,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=pt(Jt,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=pt(Jt,this).runHooks("modifyFocusedElement",s.row,s.col,r);as(a)||(a=r),a&&!((o=pt(Jt,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Zo($s,this,LE).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pt(Sf,this);if(pt(Jt,this).getSettings().imeFastEdit&&!((e=pt(Jt,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=pt(Jt,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),pt(Ef,this).has(n)||pt(Ef,this).set(n,Yp(()=>{if(!pt(Jt,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),pt(Ef,this).get(n)()}}}function LE(t){var e;const n=(e=pt(Jt,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!pt(Jt,this).selection.isCellVisible(n)){t(null);return}const r=pt(Jt,this).getCell(n.row,n.col,!0);r===null?pt(Jt,this).addHookOnce("afterScroll",()=>{t(pt(Jt,this).getCell(n.row,n.col,!0))}):t(r)}function mx(){Zo($s,this,LE).call(this,t=>{const{activeElement:e}=pt(Jt,this).rootDocument;e&&Nk(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function DK(){Zo($s,this,LE).call(this,t=>{this.getFocusMode()===zu.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function kK(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?zu.MIXED:zu.CELL)}var px={},Ry,wx;function LK(){if(wx)return Ry;wx=1;var t=ii(),e=Il(),n=Li(),r=n("match");return Ry=function(i){var o;return t(i)&&((o=i[r])!==void 0?!!o:e(i)==="RegExp")},Ry}var Ey,vx;function $K(){if(vx)return Ey;vx=1;var t=Gt(),e=rn(),n=t.RegExp,r=!e(function(){var i=!0;try{n(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(o,d,{get:function(){return s+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(o);return h!==a||s!==a});return Ey={correct:r},Ey}var Ty,Cx;function FK(){if(Cx)return Ty;Cx=1;var t=an();return Ty=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},Ty}var _y,yx;function VK(){if(yx)return _y;yx=1;var t=on(),e=oi(),n=Ld(),r=$K(),i=FK(),o=RegExp.prototype;return _y=r.correct?function(s){return s.flags}:function(s){return!r.correct&&n(o,s)&&!e(s,"flags")?t(i,s):s.flags},_y}var My,bx;function WK(){if(bx)return My;bx=1;var t=qt(),e=fc(),n=Math.floor,r=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return My=function(l,u,c,h,d,f){var g=c+l.length,w=h.length,C=a;return d!==void 0&&(d=e(d),C=s),i(f,C,function(S,v){var T;switch(r(v,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,g);case"<":T=d[o(v,1,-1)];break;default:var M=+v;if(M===0)return S;if(M>w){var x=n(M/10);return x===0?S:x<=w?h[x-1]===void 0?r(v,1):h[x-1]+r(v,1):S}T=h[M-1]}return T===void 0?"":T})},My}var Sx;function BK(){if(Sx)return px;Sx=1;var t=gt(),e=on(),n=qt(),r=Dd(),i=sn(),o=ii(),s=LK(),a=Op(),l=$d(),u=VK(),c=WK(),h=Li(),d=sa(),f=h("replace"),g=TypeError,w=n("".indexOf),C=n("".replace),S=n("".slice),v=Math.max;return t({target:"String",proto:!0},{replaceAll:function(M,x){var I=r(this),P,U,K,N,Y,X,se,ee,te,Le,Ne=0,$e="";if(o(M)){if(P=s(M),P&&(U=a(r(u(M))),!~w(U,"g")))throw new g("`.replaceAll` does not allow non-global regexes");if(K=l(M,f),K)return e(K,M,I,x);if(d&&P)return C(a(I),M,x)}for(N=a(I),Y=a(M),X=i(x),X||(x=a(x)),se=Y.length,ee=v(1,se),te=w(N,Y);te!==-1;)Le=X?a(x(Y,te,N)):c(Y,N,te,[],void 0,x),$e+=S(N,Ne,te)+Le,Ne=te+se,te=te+ee>N.length?-1:w(N,Y,te+ee);return Ne<N.length&&($e+=S(N,Ne)),$e}}),px}BK();var Rx={},Ex={},Tx;function jK(){if(Tx)return Ex;Tx=1;var t=gt(),e=pc(),n=pr(),r=an(),i=So(),o=wr(),s=la(),a=Vd(),l=rn(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){r(this);try{n(f)}catch(v){o(this,"throw",v)}var g=arguments.length<2,w=g?void 0:arguments[1];if(h)return a(h,this,g?[f]:[f,w]);var C=i(this),S=0;if(e(C,function(v){g?(g=!1,w=v):w=f(w,v,S),S++},{IS_RECORD:!0}),g)throw new u("Reduce of empty iterator with no initial value");return w}}),Ex}var _x;function UK(){return _x||(_x=1,jK()),Rx}UK();const zk={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},zK=new RegExp(Object.keys(zk).map(t=>`(${t})`).join("|"),"gi");function YK(t){return(t&&t.nodeName||"")==="TABLE"}function Mx(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let C=0;C<s;C+=1){const S=!f&&n&&C===0;let v="";if(f)v=`<th>${t.getColHeader(C-c)}</th>`;else if(S)v=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][C],{hidden:M,rowspan:x,colspan:I}=t.getCellMeta(d-h,C-c);if(!M){const P=[];if(x&&P.push(`rowspan="${x}"`),I&&P.push(`colspan="${I}"`),Wt(T))v=`<td ${P.join(" ")}></td>`;else{const U=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${P.join(" ")}>${U}</td>`}}}g.push(v)}const w=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,w):u.splice(-1,0,w)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Ix(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Wt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function GK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,M=>{const x=M.match(/<td\b[^>]*?>/g)[0],I=/<p.*?>/g,P=M.substring(x.length,M.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(I,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${x}${P}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!YK(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,M)=>T+M.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(M=>{const x=M.querySelector("td")!==null;return x&&h.push(M),!x});f=T.length,d=f>0,f>1?n.nestedHeaders=Array.from(T).reduce((M,x)=>{const I=Array.from(x.cells).reduce((P,U,K)=>{if(a&&K===0)return P;const{colSpan:N,innerHTML:Y}=U,X=N>1?{label:Y,colspan:N}:Y;return P.push(X),P},[]);return M.push(I),M},[]):d&&(n.colHeaders=Array.from(T[0].children).reduce((M,x,I)=>(a&&I===0||M.push(x.innerHTML),M),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const w=[...h,...Array.from(o.tBodies).reduce((T,M)=>(T.push(...Array.from(M.rows)),T),[]),...c];g=w.length;const C=new Array(g);for(let T=0;T<g;T++)C[T]=new Array(u);const S=[],v=[];for(let T=0;T<g;T++){const M=w[T],x=Array.from(M.cells),I=x.length;for(let P=0;P<I;P++){const U=x[P],{nodeName:K,innerHTML:N,rowSpan:Y,colSpan:X}=U,se=C[T].findIndex(ee=>ee===void 0);if(K==="TD"){if(Y>1||X>1){for(let Ne=T;Ne<T+Y;Ne++)if(Ne<g)for(let $e=se;$e<se+X;$e++)C[Ne][$e]=null;const te=U.getAttribute("style");te&&te.includes("mso-ignore:colspan")||S.push({col:se,row:T,rowspan:Y,colspan:X})}let ee="";s&&/excel/gi.test(s.content)?ee=N.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ee=N.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[T][se]=ee.replace(zK,te=>zk[te])}else v.push(N)}}return S.length&&(n.mergeCells=S),v.length&&(n.rowHeaders=v),C.length&&(n.data=C),n}function Gn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function qK(t){return Gn(t,[","])}function he(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function Px(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function Yk(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function je(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const XS="asc",KK="desc",Ox=new Map([[XS,[-1,1]],[KK,[1,-1]]]),XK=t=>`The priority '${t}' is already declared in a map.`,ZK=t=>`The priority '${t}' is not a number.`;function JK(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=ot(t)?t:XK,e=ot(e)?e:ZK;function r(o,s){if(!Gn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:XS;const[s,a]=Ox.get(o)||Ox.get(XS);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const QK=t=>`The id '${t}' is already declared in a map.`;function qp(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=ot(t)?t:QK;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const e3=t=>`'${t}' value is already declared in a unique set.`;function t3(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=ot(t)?t:e3;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const $E=t=>`There is already registered "${t}" plugin.`,n3=t=>`There is already registered plugin on priority "${t}".`,r3=t=>`The priority "${t}" is not a number.`,Gk=JK({errorPriorityExists:n3,errorPriorityNaN:r3}),qk=t3({errorItemExists:$E}),ZS=qp({errorIdExists:$E});function Kk(){return[...Gk.getItems(),...qk.getItems()]}function FE(t){const e=Ni(t);return ZS.getItem(e)}function i3(t){return!!FE(t)}function Ue(t,e,n){[t,e,n]=s3(t,e,n),FE(t)===void 0&&o3(t,e,n)}function o3(t,e,n){const r=Ni(t);if(ZS.hasItem(r))throw new Error($E(r));n===void 0?qk.addItem(r):Gk.addItem(n,r),ZS.addItem(r,e)}function s3(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:a3,getItem:l3,hasItem:Xk,getNames:efe,getValues:tfe}=li("renderers");function xx(t){if(typeof t=="function")return t;if(!Xk(t))throw Error(`No registered renderer found under "${t}" name`);return l3(t)}function jr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),a3(t,e)}const{register:u3,getItem:c3,hasItem:Zk,getNames:nfe,getValues:rfe}=li("validators");function h3(t){if(typeof t=="function")return t;if(!Zk(t))throw Error(`No registered validator found under "${t}" name`);return c3(t)}function Iu(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),u3(t,e)}var Ax={},Hx;function d3(){if(Hx)return Ax;Hx=1;var t=gt(),e=fc(),n=mc(),r=Fd(),i=Gp();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=n(a),u=r(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),Ax}d3();var Nx={},Dx;function f3(){if(Dx)return Nx;Dx=1;var t=gt(),e=qt(),n=Dd(),r=Fd(),i=Op(),o=rn(),s=e("".charAt),a=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:s(c,f)}}),Nx}f3();function Wc(t,e,n){return(e=g3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g3(t){var e=m3(t,"string");return typeof e=="symbol"?e:e+""}function m3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p3{constructor(){Wc(this,"count",0),Wc(this,"startColumn",null),Wc(this,"endColumn",null),Wc(this,"startPosition",null),Wc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Bc(t,e,n){return(e=w3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w3(t){var e=v3(t,"string");return typeof e=="symbol"?e:e+""}function v3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C3{constructor(){Bc(this,"count",0),Bc(this,"startRow",null),Bc(this,"endRow",null),Bc(this,"startPosition",null),Bc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function jc(t,e,n){return(e=y3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y3(t){var e=b3(t,"string");return typeof e=="symbol"?e:e+""}function b3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jk{constructor(){jc(this,"count",0),jc(this,"startColumn",null),jc(this,"endColumn",null),jc(this,"startPosition",null),jc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Uc(t,e,n){return(e=S3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S3(t){var e=R3(t,"string");return typeof e=="symbol"?e:e+""}function R3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qk{constructor(){Uc(this,"count",0),Uc(this,"startRow",null),Uc(this,"endRow",null),Uc(this,"startPosition",null),Uc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function zc(t,e,n){return(e=E3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E3(t){var e=T3(t,"string");return typeof e=="symbol"?e:e+""}function T3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _3{constructor(){zc(this,"count",0),zc(this,"startColumn",0),zc(this,"endColumn",0),zc(this,"startPosition",0),zc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Yc(t,e,n){return(e=M3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M3(t){var e=I3(t,"string");return typeof e=="symbol"?e:e+""}function I3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P3{constructor(){Yc(this,"count",0),Yc(this,"startRow",0),Yc(this,"endRow",0),Yc(this,"startPosition",0),Yc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function kx(t,e,n){return(e=O3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O3(t){var e=x3(t,"string");return typeof e=="symbol"?e:e+""}function x3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A3 extends Jk{constructor(){super(...arguments),kx(this,"columnStartOffset",0),kx(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Lx(t,e,n){return(e=H3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H3(t){var e=N3(t,"string");return typeof e=="symbol"?e:e+""}function N3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D3 extends Qk{constructor(){super(...arguments),Lx(this,"rowStartOffset",0),Lx(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function $x(t,e,n){return(e=k3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k3(t){var e=L3(t,"string");return typeof e=="symbol"?e:e+""}function L3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eL{constructor(e){$x(this,"calculationTypes",[]),$x(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function hi(t,e,n){return(e=$3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $3(t){var e=F3(t,"string");return typeof e=="symbol"?e:e+""}function F3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ic=50;class V3 extends eL{constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),hi(this,"viewportWidth",0),hi(this,"scrollOffset",0),hi(this,"zeroBasedScrollOffset",0),hi(this,"totalColumns",0),hi(this,"columnWidthFn",null),hi(this,"columnWidth",0),hi(this,"overrideFn",null),hi(this,"inlineStartOffset",0),hi(this,"totalCalculatedWidth",0),hi(this,"startPositions",[]),hi(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?ic:n}}function Lr(t,e,n){return(e=W3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W3(t){var e=B3(t,"string");return typeof e=="symbol"?e:e+""}function B3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j3 extends eL{constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),Lr(this,"viewportHeight",0),Lr(this,"scrollOffset",0),Lr(this,"zeroBasedScrollOffset",0),Lr(this,"totalRows",0),Lr(this,"rowHeightFn",null),Lr(this,"rowHeight",0),Lr(this,"overrideFn",null),Lr(this,"horizontalScrollbarHeight",0),Lr(this,"innerViewportHeight",0),Lr(this,"totalCalculatedHeight",0),Lr(this,"startPositions",[]),Lr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function U3(t,e,n){z3(t,e),e.set(t,n)}function z3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fx(t,e,n){return(e=Y3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y3(t){var e=G3(t,"string");return typeof e=="symbol"?e:e+""}function G3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wl(t,e){return t.get(tL(t,e))}function Vx(t,e,n){return t.set(tL(t,e),n),n}function tL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Oo=new WeakMap;class bl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Fx(this,"row",null),Fx(this,"col",null),U3(this,Oo,!1),Vx(Oo,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Wl(Oo,this)}isSouthEastOf(e){return this.row>=e.row&&(Wl(Oo,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Wl(Oo,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Wl(Oo,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Wl(Oo,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof bl&&Vx(Oo,this,e.isRtl()),this}clone(){return new bl(this.row,this.col,Wl(Oo,this))}toObject(){return{row:this.row,col:this.col}}}function q3(t,e,n){K3(t,e),e.set(t,n)}function K3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iy(t,e,n){return(e=X3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X3(t){var e=Z3(t,"string");return typeof e=="symbol"?e:e+""}function Z3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $r(t,e){return t.get(nL(t,e))}function J3(t,e,n){return t.set(nL(t,e),n),n}function nL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var er=new WeakMap;class Kd{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Iy(this,"highlight",null),Iy(this,"from",null),Iy(this,"to",null),q3(this,er,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),J3(er,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return $r(er,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return $r(er,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return $r(er,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return $r(er,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return $r(er,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return $r(er,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return $r(er,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return $r(er,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof bl))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push($r(er,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push($r(er,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new Kd(this.highlight,this.from,this.to,$r(er,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new bl(e,n,$r(er,this))}}function Wi(t,e,n){Q3(t,e),e.set(t,n)}function Q3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function de(t,e){return t.get(rL(t,e))}function vs(t,e,n){return t.set(rL(t,e),n),n}function rL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fr=new WeakMap,Py=new WeakMap,pn=new WeakMap,Bl=new WeakMap,Tf=new WeakMap,di=new WeakMap,Oy=new WeakMap,Gc=new WeakMap,wa=new WeakMap,Bi=new WeakMap;let iL=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Wi(this,Fr,void 0),Wi(this,Py,void 0),Wi(this,pn,void 0),Wi(this,Bl,void 0),Wi(this,Tf,void 0),Wi(this,di,void 0),Wi(this,Oy,void 0),Wi(this,Gc,void 0),Wi(this,wa,[null,null]),Wi(this,Bi,[null,null]),vs(Fr,this,r),vs(Py,this,n),vs(pn,this,o),vs(Bl,this,s),vs(Tf,this,a),vs(di,this,i),vs(Oy,this,e),this.registerEvents()}registerEvents(){de(di,this).addEventListener(de(pn,this).holder,"contextmenu",r=>this.onContextMenu(r)),de(di,this).addEventListener(de(pn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),de(di,this).addEventListener(de(pn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{de(di,this).addEventListener(de(pn,this).holder,"touchstart",r=>this.onTouchStart(r)),de(di,this).addEventListener(de(pn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),de(di,this).addEventListener(de(pn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||de(Fr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,de(Fr,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{de(di,this).addEventListener(de(pn,this).holder,"mouseup",r=>this.onMouseUp(r)),de(di,this).addEventListener(de(pn,this).holder,"mousedown",r=>this.onMouseDown(r))};po()?e():(yk()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(de(Gc,this)&&r){const[i,o]=[r.row,de(Gc,this).from.row],[s,a]=[r.col,de(Gc,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=de(pn,this).TABLE,i=Cf(e,["TD","TH"],r);return i?(n.coords=de(pn,this).getCoords(i),n.TD=i):ye(e,"wtBorder")&&ye(e,"current")?(n.coords=de(Bl,this).getFocusSelection().cellRange.highlight,n.TD=de(pn,this).getCell(n.coords)):ye(e,"wtBorder")&&ye(e,"area")&&de(Bl,this).getAreaSelection().cellRange&&(n.coords=de(Bl,this).getAreaSelection().cellRange.to,n.TD=de(pn,this).getCell(n.coords)),n}onMouseDown(e){const n=de(Py,this).rootDocument.activeElement,r=$k(Uq,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);ye(i,"corner")?de(Fr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&de(Fr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(de(Bi,this)[0]=o.TD,clearTimeout(de(wa,this)[0]),de(wa,this)[0]=setTimeout(()=>{de(Bi,this)[0]=null},1e3))}onContextMenu(e){if(de(Fr,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!de(Fr,this).has("onCellMouseOver"))return;const n=de(pn,this).TABLE,r=Cf(e.target,["TD","TH"],n),i=de(Tf,this)||this;r&&r!==i.lastMouseOver&&gl(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,de(pn,this).getCoords(r),r))}onMouseOut(e){if(!de(Fr,this).has("onCellMouseOut"))return;const n=de(pn,this).TABLE,r=Cf(e.target,["TD","TH"],n),i=Cf(e.relatedTarget,["TD","TH"],n),o=de(Tf,this)||this;r&&r!==i&&gl(r,n)&&(this.callListener("onCellMouseOut",e,de(pn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&de(Fr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===de(Bi,this)[0]&&n.TD===de(Bi,this)[1]?(ye(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),de(Bi,this)[0]=null,de(Bi,this)[1]=null):n.TD===de(Bi,this)[0]&&(de(Bi,this)[1]=n.TD,clearTimeout(de(wa,this)[1]),de(wa,this)[1]=setTimeout(()=>{de(Bi,this)[1]=null},500)))}onTouchStart(e){vs(Gc,this,de(Bl,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&de(Fr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];Sk()&&(Wq()||Bq())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=de(Fr,this).getSettingPure(e);o&&o(n,r,i,de(Oy,this).call(this))}destroy(){clearTimeout(de(wa,this)[0]),clearTimeout(de(wa,this)[1]),de(di,this).destroy()}};function xy(t,e,n){return(e=eX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eX(t){var e=tX(t,"string");return typeof e=="symbol"?e:e+""}function tX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nX{constructor(e,n,r){xy(this,"offset",void 0),xy(this,"total",void 0),xy(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Ay(t,e,n){return(e=rX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rX(t){var e=iX(t,"string");return typeof e=="symbol"?e:e+""}function iX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oX{constructor(e,n,r){Ay(this,"offset",void 0),Ay(this,"total",void 0),Ay(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function _f(t,e,n){return(e=sX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sX(t){var e=aX(t,"string");return typeof e=="symbol"?e:e+""}function aX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lX{constructor(){_f(this,"currentSize",0),_f(this,"nextSize",0),_f(this,"currentOffset",0),_f(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const uX=0,Wx=1,JS=2;function Hy(t,e,n){return(e=cX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cX(t){var e=hX(t,"string");return typeof e=="symbol"?e:e+""}function hX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dX{constructor(){Hy(this,"size",new lX),Hy(this,"workingSpace",uX),Hy(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Wx,e.workingSpace=JS,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=JS,e.workingSpace=Wx,this.sharedSize=e.getViewSize()}}var Bx={},Ny,jx;function fX(){if(jx)return Ny;jx=1;var t=Pp(),e=TypeError;return Ny=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},Ny}var Ux;function gX(){if(Ux)return Bx;Ux=1;var t=gt(),e=fc(),n=mc(),r=tD(),i=fX(),o=nD(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){o(d+f);for(var g=d;g--;){var w=g+f;g in h?h[w]=h[g]:i(h,w)}for(var C=0;C<f;C++)h[C]=arguments[C]}return r(h,d+f)}}),Bx}gX();function mX(t,e,n){return(e=pX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pX(t){var e=wX(t,"string");return typeof e=="symbol"?e:e+""}function wX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zx{constructor(e,n){mX(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function vX(t,e,n){return(e=CX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CX(t){var e=yX(t,"string");return typeof e=="symbol"?e:e+""}function yX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bX{constructor(e){vX(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new zx(o,n),l=new zx(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(JS)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function jl(t,e,n){return(e=SX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SX(t){var e=RX(t,"string");return typeof e=="symbol"?e:e+""}function RX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oL{constructor(e,n){jl(this,"rootNode",void 0),jl(this,"nodesPool",void 0),jl(this,"sizeSet",new dX),jl(this,"collectedNodes",[]),jl(this,"viewDiffer",new bX(this.sizeSet)),jl(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class sL extends oL{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Yx(t,e,n){return(e=EX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EX(t){var e=TX(t,"string");return typeof e=="symbol"?e:e+""}function TX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _X{constructor(e){Yx(this,"nodeType",void 0),Yx(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function qc(t,e,n){return(e=MX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MX(t){var e=IX(t,"string");return typeof e=="symbol"?e:e+""}function IX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xd{constructor(e,n){qc(this,"nodesPool",null),qc(this,"nodeType",void 0),qc(this,"rootNode",void 0),qc(this,"table",null),qc(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new _X(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function Gx(t,e,n){return(e=PX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PX(t){var e=OX(t,"string");return typeof e=="symbol"?e:e+""}function OX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xX extends Xd{constructor(){super("TH"),Gx(this,"orderViews",new WeakMap),Gx(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new sL(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),yc(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(d,[dq(),bq(),IE(h+1),ua(-1)]),n[h](a,d,h)}u.end()}}}class AX extends Xd{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&us(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ce(this.rootNode,[fk()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ce(s,[gk(),vk(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),yc(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(u,[IE(a+1+this.table.rowHeadersCount),ua(-1),fq(),...a>=0?[yq()]:[hq(),tc("Select whole grid")]]),r[n](l,u,n)}}}}let qx=!1;class HX extends Xd{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!qx&&e>1e3&&(qx=!0,Ke(nt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&q(r,"rowHeader")}}function NX(t,e,n){return(e=DX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DX(t){var e=kX(t,"string");return typeof e=="symbol"?e:e+""}function kX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ul={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let Kx=!1;class LX extends Xd{constructor(e){super("TR",e),NX(this,"orderView",void 0),this.orderView=new oL(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!Kx&&e>1e3&&(Kx=!0,Ke(nt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ce(this.rootNode,[fk()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Ce(o,[gk(),vk(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?ye(o,Ul.rowEven)||(we(o,Ul.rowOdd),q(o,Ul.rowEven)):ye(o,Ul.rowOdd)||(we(o,Ul.rowEven),q(o,Ul.rowOdd))}this.orderView.end()}}function Xx(t,e,n){return(e=$X(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $X(t){var e=FX(t,"string");return typeof e=="symbol"?e:e+""}function FX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VX extends Xd{constructor(){super("TD"),Xx(this,"orderViews",new WeakMap),Xx(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new sL(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(ye(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),yc(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;Ce(g,[...g.hasAttribute("role")?[]:[cq()],ua(-1),IE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function Xt(t,e,n){return(e=WX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WX(t){var e=BX(t,"string");return typeof e=="symbol"?e:e+""}function BX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jX{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Xt(this,"rootNode",void 0),Xt(this,"rootDocument",void 0),Xt(this,"rowHeaders",null),Xt(this,"columnHeaders",null),Xt(this,"colGroup",null),Xt(this,"rows",null),Xt(this,"cells",null),Xt(this,"rowFilter",null),Xt(this,"columnFilter",null),Xt(this,"rowUtils",null),Xt(this,"columnUtils",null),Xt(this,"rowsToRender",0),Xt(this,"columnsToRender",0),Xt(this,"rowHeaderFunctions",[]),Xt(this,"rowHeadersCount",0),Xt(this,"columnHeaderFunctions",[]),Xt(this,"columnHeadersCount",0),Xt(this,"cellRenderer",void 0),Xt(this,"activeOverlayName",void 0),Xt(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class UX{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new jX(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new xX,columnHeaders:new AX(n),colGroup:new HX(r),rows:new LX(i),cells:new VX}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Dy(t,e,n){return(e=zX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zX(t){var e=YX(t,"string");return typeof e=="symbol"?e:e+""}function YX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GX{constructor(e,n){Dy(this,"dataAccessObject",void 0),Dy(this,"wtSettings",void 0),Dy(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function Zx(t,e,n){return(e=qX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qX(t){var e=KX(t,"string");return typeof e=="symbol"?e:e+""}function KX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XX{constructor(e,n){Zx(this,"dataAccessObject",void 0),Zx(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function ji(t,e,n){return(e=ZX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZX(t){var e=JX(t,"string");return typeof e=="symbol"?e:e+""}function JX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sc{constructor(e,n,r,i,o){ji(this,"wtSettings",null),ji(this,"domBindings",void 0),ji(this,"TBODY",null),ji(this,"THEAD",null),ji(this,"COLGROUP",null),ji(this,"hasTableHeight",!0),ji(this,"hasTableWidth",!0),ji(this,"isTableVisible",!1),ji(this,"tableOffset",0),ji(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,_k(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new XX(this.dataAccessObject,this.wtSettings),this.columnUtils=new GX(this.dataAccessObject,this.wtSettings),this.tableRenderer=new UX({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ce(r,[es()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(r,[es()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",this.isMaster&&Ce(r,[ua(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ce(r.parentNode,[es()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(r,[es()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Hn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Hn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new oX(f,o,c),this.columnFilter=new nX(g,s,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),w=C.skipRender!==!0}w&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(fo)||this.is(ta))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(fo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(fo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Uh(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(fo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=vl(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=Gq(r),s=n.cellIndex;ma(El,n,this.wtRootElement)||ma(Sl,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):ma(ta,n,this.wtRootElement)||ma(fo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),ma(El,n,this.wtRootElement)||ma(Rl,n,this.wtRootElement)||ma(ta,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),r=e*n.getDefaultRowHeight(),i=Uh(this.TBODY)-1,o=n.areCellsBorderBox(),s=o?tn:Uh,a=o?0:1,l=o?1:0;let u,c,h,d,f;if(!(r===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const g=h===0?l:0;f?c=s(f):c=s(d)-a,(!u&&n.getDefaultRowHeight()<c-g||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Yt(this.TABLE)}getHeight(){return tn(this.TABLE)}getTotalWidth(){const e=Yt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=tn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return rc(this.TABLE)}_modifyRowHeaderWidth(e){let n=ot(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const QX="stickyRowsBottom",VE={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ms(VE,"MIXIN_NAME",QX,{writable:!1,enumerable:!1});const e4="stickyColumnsStart",Kp={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ms(Kp,"MIXIN_NAME",e4,{writable:!1,enumerable:!1});class WE extends Sc{constructor(e,n,r,i){super(e,n,r,i,ta)}}ht(WE,VE);ht(WE,Kp);const Sl="top",fo="bottom",Rl="inline_start",El="top_inline_start_corner",ta="bottom_inline_start_corner",aL=[Sl,fo,Rl,El,ta],t4=new Map([[Sl,`ht_clone_${Sl}`],[fo,`ht_clone_${fo}`],[Rl,`ht_clone_${Rl} ht_clone_left`],[El,`ht_clone_${El} ht_clone_top_left_corner`],[ta,`ht_clone_${ta} ht_clone_bottom_left_corner`]]);function n4(t,e){r4(t,e),e.add(t)}function r4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i4(t,e,n){return(e=o4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o4(t){var e=s4(t,"string");return typeof e=="symbol"?e:e+""}function s4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Kc=new WeakSet;class a4{constructor(e){n4(this,Kc),i4(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Mf(Kc,this,Qx).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Mf(Kc,this,Qx).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Mf(Kc,this,Jx).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Mf(Kc,this,Jx).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function Jx(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Hn(r.wtRootElement).left;const u=Math.abs(Ik(s,s));if(l>u){const c=Pk(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function Qx(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Hn(n.wtRootElement),a=HE(o,o);if(s.top>a){const l=Uh(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Vr(t,e,n){return(e=l4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l4(t){var e=u4(t,"string");return typeof e=="symbol"?e:e+""}function u4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BE{get eventManager(){return new Di(this)}constructor(e,n){Vr(this,"wtTable",void 0),Vr(this,"wtScroll",void 0),Vr(this,"wtViewport",void 0),Vr(this,"wtOverlays",void 0),Vr(this,"selectionManager",void 0),Vr(this,"wtEvent",void 0),Vr(this,"guid",`wt_${ck()}`),Vr(this,"drawInterrupted",!1),Vr(this,"drawn",!1),Vr(this,"activeOverlayName","master"),Vr(this,"domBindings",void 0),Vr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new a4(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Cl(r,e[n])}])}}createCellCoords(e,n){return new bl(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new Kd(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||Kq(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function e1(t,e,n){return(e=c4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c4(t){var e=h4(t,"string");return typeof e=="symbol"?e:e+""}function h4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class d4 extends BE{constructor(e,n,r){super(e,n),e1(this,"cloneSource",void 0),e1(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new iL(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function f4(t,e,n){return(e=g4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g4(t){var e=m4(t,"string");return typeof e=="symbol"?e:e+""}function m4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zd{constructor(e,n,r,i,o){f4(this,"wtSettings",null),ms(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Cd(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Cd(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Am(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){Ke(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Cn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(aL.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${t4.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Ce(o,[es()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Sl||u==="vertical"&&this.type===Rl?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Am(e.TABLE),new d4(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class p4 extends Zd{constructor(e,n,r,i,o,s){super(e,n,ta,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new WE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else zp(n),this.repositionOverlay();let r=tn(this.clone.wtTable.TABLE);const i=Yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Cn(r)),i.style.bottom=`${o}px`}}const w4="calculatedColumns",Xp={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ms(Xp,"MIXIN_NAME",w4,{writable:!1,enumerable:!1});class jE extends Sc{constructor(e,n,r,i){super(e,n,r,i,fo)}}ht(jE,VE);ht(jE,Xp);function v4(t,e,n){return(e=C4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C4(t){var e=y4(t,"string");return typeof e=="symbol"?e:e+""}function y4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b4 extends Zd{constructor(e,n,r,i){super(e,n,fo,r,i),v4(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new jE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Cn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(AE(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Cn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=tn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Cn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return HE(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ye(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(we(s,"innerBorderBottom"),o=a)}return o}}const S4="calculatedRows",UE={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ms(UE,"MIXIN_NAME",S4,{writable:!1,enumerable:!1});class zE extends Sc{constructor(e,n,r,i){super(e,n,r,i,Rl)}}ht(zE,UE);ht(zE,Kp);const R4="localHooks",Sn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)GS(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};ms(Sn,"MIXIN_NAME",R4,{writable:!1,enumerable:!1});let lL=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};ht(lL,Sn);const uL="active-header",YE="header",GE="area",Dm="focus",E4="fill",T4="row",_4="column",M4="custom-selection",qE=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var t1={},n1;function I4(){if(n1)return t1;n1=1;var t=Gp();return t("flat"),t1}I4();function P4(t,e){cL(t,e),e.add(t)}function r1(t,e,n){cL(t,e),e.set(t,n)}function cL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(t,e){return t.get(zh(t,e))}function i1(t,e,n){return t.set(zh(t,e),n),n}function zh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vi=new WeakMap,In=new WeakMap,If=new WeakSet;class O4{constructor(){P4(this,If),r1(this,vi,void 0),r1(this,In,void 0)}setActiveOverlay(e){return i1(In,this,e),this}setActiveSelection(e){return i1(vi,this,e),this}scan(){const e=At(vi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=At(vi,this).getCorners(),{wtTable:s}=At(In,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const w=At(In,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:At(vi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});w!==null&&(w!==h&&(g=s.getColumnHeader(w,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=At(vi,this).getCorners(),{wtTable:s}=At(In,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const w=At(In,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:At(vi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});w!==null&&(w!==h&&(g=s.getRowHeader(w,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=At(In,this);zh(If,this,x4).call(this,(r,i)=>{const o=n.getCell(At(In,this).createCellCoords(r,i)),s=At(In,this).getSetting("onAfterDrawSelection",r,i,At(vi,this).settings.layerLevel);typeof s=="string"&&q(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=At(vi,this).getCorners(),{wtTable:i}=At(In,this);zh(If,this,o1).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(At(In,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=At(vi,this).getCorners(),{wtTable:i}=At(In,this);zh(If,this,o1).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(At(In,this).createCellCoords(o,s));e(a)}})}}function x4(t){let[e,n,r,i]=At(vi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=At(In,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(At(In,this).createCellCoords(e,n));if(!as(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function o1(t){const{wtTable:e}=At(In,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class s1{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=qE(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Fi(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),po()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,r=n.getSetting("stylesHandler"),i=r.getCSSVariableValue("cell-mobile-handle-size"),o=r.getCSSVariableValue("cell-mobile-handle-border-radius"),s=r.getCSSVariableValue("cell-mobile-handle-background-color"),a=r.getCSSVariableValue("cell-mobile-handle-border-width"),l=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};He(h,(f,g)=>{this.selectionHandles.styles.bottomHitArea[g]=f,this.selectionHandles.styles.topHitArea[g]=f});const d=r.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};He(d,(f,g)=>{this.selectionHandles.styles.bottom[g]=f,this.selectionHandles.styles.top[g]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),w=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-w/4*3,10)}px`,c[l]=`${parseInt(i-w/4*3,10)}px`;const v=Math.min(parseInt(i+o,10),C-g-f*2),T=Math.min(parseInt(i+o-w/4,10),C-w-f*2);h[l]=`${v}px`,d[l]=`${T}px`;const M=Math.min(parseInt(r+s,10),S-g-f*2),x=Math.min(parseInt(r+s-w/4,10),S-w-f*2);h.top=`${M}px`,d.top=`${x}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),f=s.getFirstRenderedColumn(),g=s.getLastRenderedColumn();if(f<0&&g<0||h<0&&d<0){this.disappear();return}let w;if(u){if(r=Math.max(r,f),o=Math.min(o,g),n=Math.max(n,h),i=Math.min(i,d),o<r||i<n){this.disappear();return}w=s.getCell(this.wot.createCellCoords(n,r))}else if(w=s.getCell(this.wot.createCellCoords(n,r)),!as(w)){this.disappear();return}const C=u?s.getCell(this.wot.createCellCoords(i,o)):w,S=Hn(w),v=u?Hn(C):S,T=Hn(s.TABLE),M=S.top,x=S.left,I=this.wot.wtSettings.getSetting("rtlMode");let P=0,U=0;if(I){const $e=Yt(s.TABLE),vt=Yt(w),rt=l.innerWidth-T.left-$e;U=x+vt-v.left,P=l.innerWidth-x-vt-rt-1}else U=v.left+Yt(C)-x,P=x-T.left-1;if(this.isEntireColumnSelected(n,i)){const $e=n,vt=this.getDimensionsFromHeader("columns",r,o,$e,T);let rt=null;vt&&([rt,P,U]=vt),rt&&(w=rt)}let K=M-T.top-1,N=v.top+tn(C)-M;if(this.isEntireRowSelected(r,o)){const $e=r,vt=this.getDimensionsFromHeader("rows",n,i,$e,T);let rt=null;vt&&([rt,K,N]=vt),rt&&(w=rt)}const Y=l.getComputedStyle(w);parseInt(Y.borderTopWidth,10)>0&&(K+=1,N=N>0?N-1:0),parseInt(Y[I?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,U=U>0?U-1:0);const X=I?"right":"left",se=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${K}px`,this.topStyle[X]=`${P}px`,this.topStyle.width=`${U+se}px`,this.topStyle.display="block",this.startStyle.top=`${K}px`,this.startStyle[X]=`${P}px`,this.startStyle.height=`${N+se}px`,this.startStyle.display="block",this.bottomStyle.top=`${K+N-parseInt(this.bottomStyle.height,10)+se}px`,this.bottomStyle[X]=`${P}px`,this.bottomStyle.width=`${U+se}px`,this.bottomStyle.display="block",this.endStyle.top=`${K}px`,this.endStyle[X]=`${P+U-parseInt(this.endStyle.width,10)+se}px`,this.endStyle.height=`${N+se}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[Le,Ne]=[i,o];if(te&&Array.isArray(te)&&([,,Le,Ne]=te),po()||!ee||this.isPartRange(Le,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top=`${K+N+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[X]=`${P+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let $e=Cd(s.TABLE);const vt=$e===l;vt&&($e=a.documentElement);const rt=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,at=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),gn=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=vt?C.getBoundingClientRect().left:C.offsetLeft;let p=!1,b=0;if(I?(b=m-parseInt(this.cornerDefaultStyle.width,10)/2,p=b<0):(b=m+Yt(C)+parseInt(this.cornerDefaultStyle.width,10)/2,p=b>=Pk($e)),p){const D=Math.floor(P+U+this.cornerCenterPointOffset-at-rt);c?(this.cornerStyle[X]=`${D}px`,this.cornerStyle[I?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[X]=`${D-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(vt?C.getBoundingClientRect().top:C.offsetTop)+tn(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=Uh($e)){const D=Math.floor(K+N+this.cornerCenterPointOffset-gn-rt);c?(this.cornerStyle.top=`${D}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${D-1}px`}this.cornerStyle.display="block"}po()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,K,P,U,N)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,w=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return tn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Yt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(g=l(n,C-i),w=l(r,C-i),!g||!w)return!1;const S=Hn(g),v=Hn(w);return g&&w&&(h=S[f]-o[f]-1,d=v[f]+u(w)-S[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?q(this[e],"hidden"):(ye(this[e],"hidden")&&we(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):we(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",po()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function A4(t,e){hL(t,e),e.add(t)}function zl(t,e,n){hL(t,e),e.set(t,n)}function hL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pe(t,e){return t.get(KE(t,e))}function a1(t,e,n){return t.set(KE(t,e),n),n}function KE(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pn=new WeakMap,ur=new WeakMap,ky=new WeakMap,Dh=new WeakMap,Ly=new WeakMap,va=new WeakMap,l1=new WeakSet;class H4{constructor(e){A4(this,l1),zl(this,Pn,void 0),zl(this,ur,void 0),zl(this,ky,new O4),zl(this,Dh,new WeakMap),zl(this,Ly,new WeakSet),zl(this,va,new Map),a1(ur,this,e)}setActiveOverlay(e){return a1(Pn,this,e),Pe(ky,this).setActiveOverlay(Pe(Pn,this)),Pe(Dh,this).has(Pe(Pn,this))||Pe(Dh,this).set(Pe(Pn,this),new Set),this}getFocusSelection(){return Pe(ur,this)!==null?Pe(ur,this).getFocus():null}getAreaSelection(){return Pe(ur,this)!==null?Pe(ur,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Pe(va,this).has(e)){const r=Pe(va,this).get(e);if(r.has(Pe(Pn,this)))return r.get(Pe(Pn,this));const i=new s1(Pe(Pn,this),e.settings);return r.set(Pe(Pn,this),i),i}const n=new s1(Pe(Pn,this),e.settings);return Pe(va,this).set(e,new Map([[Pe(Pn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Pe(va,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Pe(va,this).get(e).forEach(n=>n.destroy()),Pe(va,this).delete(e)}render(e){if(Pe(ur,this)===null)return;e&&KE(l1,this,N4).call(this);const n=Array.from(Pe(ur,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Pe(Ly,this).has(s)||(Pe(Ly,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&Pe(ky,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const w=r.get(g);w.has(a)&&u===!0?w.set(a,w.get(a)+1):w.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();Pe(Pn,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Pe(Dh,this).get(Pe(Pn,this)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=Pe(ur,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ce(s,Pe(ur,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Ce(o,[...i.get(o)])})}}function N4(){const t=Pe(Dh,this).get(Pe(Pn,this)),e=Pe(Pn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Pe(Pn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Pe(ur,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Pe(ur,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Pe(ur,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Pe(ur,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)we(o[a],n),yc(o[a],s)}),t.clear()}class D4 extends Zd{constructor(e,n,r,i){super(e,n,Rl,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new zE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),NE(r,`${o}px`,"0px")):(o=this.getScrollPosition(),zp(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,Mk(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=Cn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Yt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=qE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ye(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=Cn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,Zq(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(Ik(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?we(r,"emptyRows"):q(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)q(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ye(r,"innerBorderInlineStart");e?(q(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(we(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const k4="stickyRowsTop",XE={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ms(XE,"MIXIN_NAME",k4,{writable:!1,enumerable:!1});class ZE extends Sc{constructor(e,n,r,i){super(e,n,r,i,El)}}ht(ZE,XE);ht(ZE,Kp);function u1(t,e,n){return(e=L4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L4(t){var e=$4(t,"string");return typeof e=="symbol"?e:e+""}function $4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F4 extends Zd{constructor(e,n,r,i,o,s){super(e,n,El,r,i),u1(this,"topOverlay",void 0),u1(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new ZE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();NE(e,`${i}px`,`${o}px`)}else zp(e);let n=tn(this.clone.wtTable.TABLE);const r=Yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class JE extends Sc{constructor(e,n,r,i){super(e,n,r,i,Sl)}}ht(JE,XE);ht(JE,Xp);function V4(t,e,n){return(e=W4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W4(t){var e=B4(t,"string");return typeof e=="symbol"?e:e+""}function B4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j4 extends Zd{constructor(e,n,r,i){super(e,n,Sl,r,i),V4(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new JE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),NE(e,"0px",`${i}px`)}else i=this.getScrollPosition(),zp(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(AE(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Cn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=tn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=qE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ye(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=Cn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,Xq(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return HE(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?we(i,"emptyColumns"):q(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ye(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(q(i,"innerBorderTop"),a=!h):(we(i,"innerBorderTop"),a=h)}}return a}}function Pf(t,e,n){U4(t,e),e.set(t,n)}function U4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xo(t,e,n){return(e=z4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z4(t){var e=Y4(t,"string");return typeof e=="symbol"?e:e+""}function Y4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ca(t,e,n){return t.set(dL(t,e),n),n}function Ao(t,e){return t.get(dL(t,e))}function dL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yl=new WeakMap,Of=new WeakMap,Gl=new WeakMap,xf=new WeakMap;class G4{constructor(e,n,r,i,o,s){xo(this,"wot",null),Pf(this,Yl,[]),xo(this,"topOverlay",null),xo(this,"bottomOverlay",null),xo(this,"inlineStartOverlay",null),xo(this,"topInlineStartCornerOverlay",null),xo(this,"bottomInlineStartCornerOverlay",null),xo(this,"browserLineHeight",void 0),xo(this,"wtSettings",null),Pf(this,Of,!1),Pf(this,Gl,0),Pf(this,xf,null),xo(this,"resizeObserver",new ResizeObserver(c=>{Om(()=>{!Array.isArray(c)||!c.length||(Ca(Gl,this,Ao(Gl,this)+1),Ao(Gl,this)===100&&(Ke("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Ao(xf,this)!==null&&clearTimeout(Ao(xf,this)),Ca(xf,this,setTimeout(()=>{Ca(Gl,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Cn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Am(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Ao(Yl,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new j4(...e),this.bottomOverlay=new b4(...e),this.inlineStartOverlay=new D4(...e),this.topInlineStartCornerOverlay=new F4(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new p4(...e,this.bottomOverlay,this.inlineStartOverlay),Ca(Yl,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Ca(Of,this,Ao(Yl,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Ao(Yl,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Ao(Yl,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!bk())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Om(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{Ca(Gl,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=qd(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Ao(Of,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),Ca(Of,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Am(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),w=f()?1:0,C=g()?1:0;d.width=`${c+C}px`,d.height=`${u+w}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return A(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];A(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function c1(t,e,n){return(e=q4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q4(t){var e=K4(t,"string");return typeof e=="symbol"?e:e+""}function K4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X4{constructor(e){c1(this,"settings",{}),c1(this,"defaults",Object.freeze(this.getDefaults())),He(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Cl(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?He(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class QE extends Sc{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Cd(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Hm(e,"height",n),o=Hm(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=rc(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}ht(QE,UE);ht(QE,Xp);class Z4{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new P3:new D3],["fullyVisible",()=>new C3],["partiallyVisible",()=>new Qk]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new _3:new A3],["fullyVisible",()=>new p3],["partiallyVisible",()=>new Jk]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=tn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Hn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=tn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=Yt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Cn(this.domBindings.rootDocument),new j3({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Cn(this.domBindings.rootDocument)),new V3({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){He(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}class J4 extends BE{constructor(e,n){super(e,new X4(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new QE(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new Z4(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new H4(this.wtSettings.getSetting("selections")),this.wtEvent=new iL(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new G4(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];He(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),we(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!aL.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class e0{constructor(e){e instanceof BE?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new e0(n);return()=>r},this._wot=new J4(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function h1(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Q4(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}function d1(t){let{isLeftClick:e,selection:n,cellRangeMapper:r}=t;if(!e||n.settings.selectionMode!=="multiple")return;const i=n.getSelectedRange(),o=i.clone().map(a=>r.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!n.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),n.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),n.refresh())}}const e6=new Map([["touchstart",h1],["touchend",d1],["mousedown",h1],["mouseover",Q4],["mouseup",d1]]);function $y(t,e){e6.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:DE(t)||t.type==="touchstart",isRightClick:yl(t),...e})}const fL=new WeakMap,t0=Symbol("rootInstance");function t6(t){fL.set(t,!0)}function n6(t){return t===t0}function Pu(t){return fL.has(t)}function r6(t,e){gL(t,e),e.add(t)}function Cs(t,e,n){gL(t,e),e.set(t,n)}function gL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ys(t,e,n){return(e=i6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i6(t){var e=o6(t,"string");return typeof e=="symbol"?e:e+""}function o6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jt(t,e){return t.get(Yu(t,e))}function tr(t,e,n){return t.set(Yu(t,e),n),n}function Yu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fy=new WeakMap,Af=new WeakMap,Hf=new WeakMap,Ho=new WeakMap,fi=new WeakMap,Vy=new WeakMap,Wy=new WeakMap,ql=new WeakMap,kh=new WeakSet;class s6{constructor(e){r6(this,kh),ys(this,"hot",void 0),ys(this,"eventManager",void 0),ys(this,"settings",void 0),ys(this,"THEAD",void 0),ys(this,"TBODY",void 0),ys(this,"_wt",void 0),ys(this,"activeWt",void 0),Cs(this,Fy,0),Cs(this,Af,0),ys(this,"postponedAdjustElementsSize",!1),Cs(this,Hf,!1),Cs(this,Ho,void 0),Cs(this,fi,void 0),Cs(this,Vy,0),Cs(this,Wy,0),Cs(this,ql,null),this.hot=e,this.eventManager=new Di(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Yu(kh,this,l6).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),q(e,"handsontable"),tr(fi,this,n.createElement("TABLE")),q(jt(fi,this),"htCore"),this.hot.getSettings().tableClassName&&q(jt(fi,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ce(jt(fi,this),[es()]),Ce(e,[uq(),wk(-1),Bp(this.hot.countCols()),Eq()])),this.THEAD=n.createElement("THEAD"),jt(fi,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),jt(fi,this).appendChild(this.TBODY),this.hot.table=jt(fi,this),this.hot.container.insertBefore(jt(fi,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{tr(Hf,this,!0),this.isTextSelectionAllowed(a.target)||(QO(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{tr(Hf,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{jt(Hf,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&QO(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&DE(a)&&r.finish(),tr(Ho,this,!1);const l=Nk(n.activeElement);om(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!yl(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&yl(a)&&(r.finish(),tr(Ho,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),tr(Ho,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(jt(Ho,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=Cn(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=nc(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=nc(s);this.eventManager.addEventListener(jt(fi,this),"selectstart",a=>{this.settings.fragmentSelection||om(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&q(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&we(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:jt(fi,this),isDataViewInstance:()=>Pu(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),tr(Af,this,o.length),this.hot.getSettings().ariaTags&&Yu(kh,this,mL).call(this)===this.hot.countCols()&&Yu(kh,this,a6).call(this,jt(Af,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),tr(Fy,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let w=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(w=this.hot.runHooks("beforeValueRender",w,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,w,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,w,f),this.hot.runHooks("afterRenderer",a,l,u,g,w,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&rc(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,tr(Ho,this,!0),tr(ql,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!tl(o)&&($y(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,tr(Ho,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!tl(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!tl(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!tl(o)&&(jt(Ho,this)&&(!jt(ql,this)||jt(ql,this).x!==o.clientX||jt(ql,this).y!==o.clientY)&&$y(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,tr(ql,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(tl(o)||this.hot.isDestroyed)&&($y(o,{coords:u,selection:this.hot.selection,cellRangeMapper:bK(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,w,C,S]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,1)):w,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,S>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(S,-1)):S]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new e0(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(om(e))return!0;const n=gl(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return jt(Ho,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!ye(r,"relative")){us(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;ye(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",q(s,["relative",...o()])):(us(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Ce(a,...es()),Ce(l,...es())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ye(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):ye(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?bc(e,r(n,i)):(Cl(e," "),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){tr(Vy,this,e),tr(Wy,this,n)}getLastSize(){return{width:jt(Vy,this),height:jt(Wy,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return jt(Fy,this)}getRowHeadersCount(){return jt(Af,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function mL(){return parseInt(this.hot.rootElement.getAttribute(Bp()[0]),10)}function a6(t){const e=Yu(kh,this,mL).call(this)+t;Ce(this.hot.rootElement,...Bp(e))}function l6(){const t=this.hot.rootElement;this.hasVerticalScroll()?q(t,"htHasScrollY"):we(t,"htHasScrollY"),this.hasHorizontalScroll()?q(t,"htHasScrollX"):we(t,"htHasScrollX")}var f1={},g1={},m1;function u6(){if(m1)return g1;m1=1;var t=gt(),e=on(),n=pc(),r=pr(),i=an(),o=So(),s=wr(),a=la(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return!n(h,function(f,g){if(!c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),g1}var p1;function c6(){return p1||(p1=1,u6()),f1}c6();const h6="ABCDEFGHIJKLMNOPQRSTUVWXYZ",w1=h6.length;function d6(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%w1,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/w1,10);return n}function pL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function wL(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ae(t[0])&&(e=xE(t[0]))),e}function f6(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function g6(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function Xc(t,e,n){return(e=m6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m6(t){var e=p6(t,"string");return typeof e=="symbol"?e:e+""}function p6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w6{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Xc(this,"hot",void 0),Xc(this,"data",void 0),Xc(this,"dataType","array"),Xc(this,"colToProp",()=>{}),Xc(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return A(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):he(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(Ae(a)||ot(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;he(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?hy(l,d,f):l[d]=f}})}else He(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?hy(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Hr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:hy(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?kq(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Hr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return he(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return wL(this.data)}destroy(){this.data=null,this.hot=null}}var v1={},C1={},y1;function v6(){if(y1)return C1;y1=1;var t=gt(),e=on(),n=pc(),r=pr(),i=an(),o=So(),s=wr(),a=la(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,g){if(c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),C1}var b1;function C6(){return b1||(b1=1,v6()),v1}C6();function S1(t,e,n){return(e=y6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y6(t){var e=b6(t,"string");return typeof e=="symbol"?e:e+""}function b6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;S1(this,"indexedValues",[]),S1(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ot(this.initValueOrFn)?he(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):he(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ht(Dl,Sn);function n0(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>ot(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function r0(t,e){return wl(t,(n,r)=>e.includes(r)===!1)}class ha extends Dl{insert(e,n){this.indexedValues=n0(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=r0(this.indexedValues,e),super.remove(e)}}class Zp extends ha{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return vr(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function i0(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function yd(t,e){return wl(t,n=>e.includes(n)===!1)}function o0(t,e){return We(t,n=>n-e.filter(r=>r<n).length)}function s0(t,e){const n=e[0],r=e.length;return We(t,i=>i>=n?i+r:i)}function S6(t,e,n){return(e=R6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R6(t){var e=E6(t,"string");return typeof e=="symbol"?e:e+""}function E6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jp extends Dl{constructor(){super(...arguments),S6(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=yd(this.orderOfIndexes,[e]),ot(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=n0(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=s0(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=r0(this.indexedValues,e),this.orderOfIndexes=yd(this.orderOfIndexes,e),this.orderOfIndexes=o0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Jd extends ha{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return vr(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const R1=new Map([["indexesSequence",{getListWithInsertedItems:i0,getListWithRemovedItems:yd}],["physicallyIndexed",{getListWithInsertedItems:n0,getListWithRemovedItems:r0}]]),vL=t=>{if(R1.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return R1.get(t)};class CL extends Dl{constructor(){super(e=>e)}insert(e,n){const r=s0(this.indexedValues,n);this.indexedValues=i0(r,e,n),super.insert(e,n)}remove(e){const n=yd(this.indexedValues,e);this.indexedValues=o0(n,e),super.remove(e)}}const E1=new Map([["hiding",Zp],["index",Dl],["linkedPhysicalIndexToValue",Jp],["physicalIndexToValue",ha],["trimming",Jd]]);function T6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!E1.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(E1.get(t))(e)}function _6(t,e,n){return(e=M6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M6(t){var e=I6(t,"string");return typeof e=="symbol"?e:e+""}function I6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a0{constructor(){_6(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)))}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n))}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Mt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}ht(a0,Sn);function By(t,e,n){return(e=P6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P6(t){var e=O6(t,"string");return typeof e=="symbol"?e:e+""}function O6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T1 extends a0{constructor(e,n){super(),By(this,"mergedValuesCache",[]),By(this,"aggregationFunction",void 0),By(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=We(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return We(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function x6(t,e,n){A6(t,e),e.set(t,n)}function A6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function H6(t,e,n){return t.set(yL(t,e),n),n}function N6(t,e){return t.get(yL(t,e))}function yL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jy=new WeakMap;class bL{constructor(){x6(this,jy,[])}subscribe(e){return this.addLocalHook("change",e),this._write(N6(jy,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){H6(jy,this,e)}}ht(bL,Sn);function _1(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Zc(t,e,n){D6(t,e),e.set(t,n)}function D6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wr(t,e){return t.get(SL(t,e))}function Nf(t,e,n){return t.set(SL(t,e),n),n}function SL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Df=new WeakMap,Jc=new WeakMap,kf=new WeakMap,Lf=new WeakMap,$f=new WeakMap;class k6{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zc(this,Df,new Set),Zc(this,Jc,[]),Zc(this,kf,[]),Zc(this,Lf,!1),Zc(this,$f,!1),Nf($f,this,e??!1)}createObserver(){const e=new bL;return Wr(Df,this).add(e),e.addLocalHook("unsubscribe",()=>{Wr(Df,this).delete(e)}),e._writeInitialChanges(_1(Wr(Jc,this),Wr(kf,this))),e}emit(e){let n=Wr(kf,this);(!Wr(Lf,this)||Wr(Jc,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Wr($f,this)):Nf(Jc,this,new Array(e.length).fill(Wr($f,this))),Wr(Lf,this)||(Nf(Lf,this,!0),n=Wr(Jc,this)));const r=_1(n,e);Wr(Df,this).forEach(i=>i._write(r)),Nf(kf,this,e)}}function Fn(t,e,n){return(e=L6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L6(t){var e=$6(t,"string");return typeof e=="symbol"?e:e+""}function $6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QS{constructor(){Fn(this,"indexesSequence",new CL),Fn(this,"trimmingMapsCollection",new T1(e=>e.some(n=>n===!0),!1)),Fn(this,"hidingMapsCollection",new T1(e=>e.some(n=>n===!0),!1)),Fn(this,"variousMapsCollection",new a0),Fn(this,"hidingChangesObservable",new k6({initialIndexValue:!1})),Fn(this,"notTrimmedIndexesCache",[]),Fn(this,"notHiddenIndexesCache",[]),Fn(this,"isBatched",!1),Fn(this,"indexesSequenceChanged",!1),Fn(this,"indexesChangeSource",void 0),Fn(this,"trimmedIndexesChanged",!1),Fn(this,"hiddenIndexesChanged",!1),Fn(this,"renderablePhysicalIndexesCache",[]),Fn(this,"fromPhysicalToVisualIndexesCache",new Map),Fn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,T6(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Jd?this.trimmingMapsCollection.register(e,n):n instanceof Zp?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=We(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=yd(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(i0(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=le(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=We(new Array(n).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=r==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}ht(QS,Sn);function F6(t,e){return He(e,(n,r)=>{Mt(t[r])&&(t[r]=n)}),t}function RL(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function EL(t){le(t)&&kE(nt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function V6(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:W6,getValues:B6}=li("phraseFormatters");function j6(t,e){W6(t,e)}function U6(){return B6()}j6("pluralize",V6);const TL="ContextMenu:items",Te=TL,l0=`${Te}.noItems`,u0=`${Te}.insertRowAbove`,c0=`${Te}.insertRowBelow`,h0=`${Te}.insertColumnOnTheLeft`,d0=`${Te}.insertColumnOnTheRight`,f0=`${Te}.removeRow`,g0=`${Te}.removeColumn`,m0=`${Te}.undo`,p0=`${Te}.redo`,km=`${Te}.readOnly`,w0=`${Te}.clearColumn`,v0=`${Te}.copy`,C0=`${Te}.copyWithHeaders`,y0=`${Te}.copyWithGroupHeaders`,b0=`${Te}.copyHeadersOnly`,S0=`${Te}.cut`,R0=`${Te}.freezeColumn`,E0=`${Te}.unfreezeColumn`,T0=`${Te}.mergeCells`,_0=`${Te}.unmergeCells`,M0=`${Te}.addComment`,I0=`${Te}.editComment`,P0=`${Te}.removeComment`,O0=`${Te}.readOnlyComment`,x0=`${Te}.align`,A0=`${Te}.align.left`,H0=`${Te}.align.center`,N0=`${Te}.align.right`,D0=`${Te}.align.justify`,k0=`${Te}.align.top`,L0=`${Te}.align.middle`,$0=`${Te}.align.bottom`,F0=`${Te}.borders`,V0=`${Te}.borders.top`,W0=`${Te}.borders.right`,B0=`${Te}.borders.bottom`,j0=`${Te}.borders.left`,U0=`${Te}.borders.remove`,z0=`${Te}.nestedHeaders.insertChildRow`,Y0=`${Te}.nestedHeaders.detachFromParent`,G0=`${Te}.hideColumn`,q0=`${Te}.showColumn`,K0=`${Te}.hideRow`,X0=`${Te}.showRow`,Zn="Filters:",kt=`${Zn}conditions`,Qp=`${kt}.none`,Z0=`${kt}.isEmpty`,J0=`${kt}.isNotEmpty`,Q0=`${kt}.isEqualTo`,eT=`${kt}.isNotEqualTo`,tT=`${kt}.beginsWith`,nT=`${kt}.endsWith`,rT=`${kt}.contains`,iT=`${kt}.doesNotContain`,z6=`${kt}.byValue`,oT=`${kt}.greaterThan`,sT=`${kt}.greaterThanOrEqualTo`,aT=`${kt}.lessThan`,lT=`${kt}.lessThanOrEqualTo`,uT=`${kt}.isBetween`,cT=`${kt}.isNotBetween`,hT=`${kt}.after`,dT=`${kt}.before`,fT=`${kt}.today`,gT=`${kt}.tomorrow`,mT=`${kt}.yesterday`,pT=`${Zn}labels.filterByCondition`,wT=`${Zn}labels.filterByValue`,vT=`${Zn}labels.conjunction`,ew=`${Zn}labels.disjunction`,Lm=`${Zn}values.blankCells`,CT=`${Zn}buttons.selectAll`,yT=`${Zn}buttons.clear`,bT=`${Zn}buttons.ok`,ST=`${Zn}buttons.cancel`,RT=`${Zn}buttons.placeholder.search`,ET=`${Zn}buttons.placeholder.value`,TT=`${Zn}buttons.placeholder.secondValue`,_T="CheckboxRenderer:",MT=`${_T}checked`,IT=`${_T}unchecked`,Y6=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:MT,CHECKBOX_RENDERER_NAMESPACE:_T,CHECKBOX_UNCHECKED:IT,CONTEXTMENU_ITEMS_ADD_COMMENT:M0,CONTEXTMENU_ITEMS_ALIGNMENT:x0,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:$0,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:H0,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:D0,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:A0,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:L0,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:N0,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:k0,CONTEXTMENU_ITEMS_BORDERS:F0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:B0,CONTEXTMENU_ITEMS_BORDERS_LEFT:j0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:W0,CONTEXTMENU_ITEMS_BORDERS_TOP:V0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:w0,CONTEXTMENU_ITEMS_COPY:v0,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:b0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:y0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:C0,CONTEXTMENU_ITEMS_CUT:S0,CONTEXTMENU_ITEMS_EDIT_COMMENT:I0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:R0,CONTEXTMENU_ITEMS_HIDE_COLUMN:G0,CONTEXTMENU_ITEMS_HIDE_ROW:K0,CONTEXTMENU_ITEMS_INSERT_LEFT:h0,CONTEXTMENU_ITEMS_INSERT_RIGHT:d0,CONTEXTMENU_ITEMS_MERGE_CELLS:T0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Y0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:z0,CONTEXTMENU_ITEMS_NO_ITEMS:l0,CONTEXTMENU_ITEMS_READ_ONLY:km,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:O0,CONTEXTMENU_ITEMS_REDO:p0,CONTEXTMENU_ITEMS_REMOVE_BORDERS:U0,CONTEXTMENU_ITEMS_REMOVE_COLUMN:g0,CONTEXTMENU_ITEMS_REMOVE_COMMENT:P0,CONTEXTMENU_ITEMS_REMOVE_ROW:f0,CONTEXTMENU_ITEMS_ROW_ABOVE:u0,CONTEXTMENU_ITEMS_ROW_BELOW:c0,CONTEXTMENU_ITEMS_SHOW_COLUMN:q0,CONTEXTMENU_ITEMS_SHOW_ROW:X0,CONTEXTMENU_ITEMS_UNDO:m0,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:E0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:_0,CONTEXT_MENU_ITEMS_NAMESPACE:TL,FILTERS_BUTTONS_CANCEL:ST,FILTERS_BUTTONS_CLEAR:yT,FILTERS_BUTTONS_OK:bT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:RT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:TT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:ET,FILTERS_BUTTONS_SELECT_ALL:CT,FILTERS_CONDITIONS_AFTER:hT,FILTERS_CONDITIONS_BEFORE:dT,FILTERS_CONDITIONS_BEGINS_WITH:tT,FILTERS_CONDITIONS_BETWEEN:uT,FILTERS_CONDITIONS_BY_VALUE:z6,FILTERS_CONDITIONS_CONTAINS:rT,FILTERS_CONDITIONS_EMPTY:Z0,FILTERS_CONDITIONS_ENDS_WITH:nT,FILTERS_CONDITIONS_EQUAL:Q0,FILTERS_CONDITIONS_GREATER_THAN:oT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:sT,FILTERS_CONDITIONS_LESS_THAN:aT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:lT,FILTERS_CONDITIONS_NAMESPACE:kt,FILTERS_CONDITIONS_NONE:Qp,FILTERS_CONDITIONS_NOT_BETWEEN:cT,FILTERS_CONDITIONS_NOT_CONTAIN:iT,FILTERS_CONDITIONS_NOT_EMPTY:J0,FILTERS_CONDITIONS_NOT_EQUAL:eT,FILTERS_CONDITIONS_TODAY:fT,FILTERS_CONDITIONS_TOMORROW:gT,FILTERS_CONDITIONS_YESTERDAY:mT,FILTERS_DIVS_FILTER_BY_CONDITION:pT,FILTERS_DIVS_FILTER_BY_VALUE:wT,FILTERS_LABELS_CONJUNCTION:vT,FILTERS_LABELS_DISJUNCTION:ew,FILTERS_NAMESPACE:Zn,FILTERS_VALUES_BLANK_CELLS:Lm},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const _L={languageCode:"en-US",[l0]:"No available options",[u0]:"Insert row above",[c0]:"Insert row below",[h0]:"Insert column left",[d0]:"Insert column right",[f0]:["Remove row","Remove rows"],[g0]:["Remove column","Remove columns"],[m0]:"Undo",[p0]:"Redo",[km]:"Read only",[w0]:"Clear column",[x0]:"Alignment",[A0]:"Left",[H0]:"Center",[N0]:"Right",[D0]:"Justify",[k0]:"Top",[L0]:"Middle",[$0]:"Bottom",[R0]:"Freeze column",[E0]:"Unfreeze column",[F0]:"Borders",[V0]:"Top",[W0]:"Right",[B0]:"Bottom",[j0]:"Left",[U0]:"Remove border(s)",[M0]:"Add comment",[I0]:"Edit comment",[P0]:"Delete comment",[O0]:"Read-only comment",[T0]:"Merge cells",[_0]:"Unmerge cells",[v0]:"Copy",[C0]:["Copy with header","Copy with headers"],[y0]:["Copy with group header","Copy with group headers"],[b0]:["Copy header only","Copy headers only"],[S0]:"Cut",[z0]:"Insert child row",[Y0]:"Detach from parent",[G0]:["Hide column","Hide columns"],[q0]:["Show column","Show columns"],[K0]:["Hide row","Hide rows"],[X0]:["Show row","Show rows"],[Qp]:"None",[Z0]:"Is empty",[J0]:"Is not empty",[Q0]:"Is equal to",[eT]:"Is not equal to",[tT]:"Begins with",[nT]:"Ends with",[rT]:"Contains",[iT]:"Does not contain",[oT]:"Greater than",[sT]:"Greater than or equal to",[aT]:"Less than",[lT]:"Less than or equal to",[uT]:"Is between",[cT]:"Is not between",[hT]:"After",[dT]:"Before",[fT]:"Today",[gT]:"Tomorrow",[mT]:"Yesterday",[Lm]:"Blank cells",[pT]:"Filter by condition",[wT]:"Filter by value",[vT]:"And",[ew]:"Or",[CT]:"Select all",[yT]:"Clear",[bT]:"OK",[ST]:"Cancel",[RT]:"Search",[ET]:"Value",[TT]:"Second value",[MT]:"Checked",[IT]:"Unchecked"},G6=Y6,eR=_L.languageCode,{register:q6,getItem:ML,hasItem:K6,getValues:X6}=li("languagesDictionaries");IL(_L);function IL(t,e){let n=t,r=e;return Ae(t)&&(r=t,n=r.languageCode),Z6(n,r),q6(n,Xn(r)),Xn(r)}function Z6(t,e){t!==eR&&F6(e,ML(eR))}function PL(t){return PT(t)?Xn(ML(t)):null}function PT(t){return K6(t)}function J6(){return X6()}function OL(t,e,n){const r=PL(t);if(r===null)return null;const i=r[e];if(Mt(i))return null;const o=Q6(i,n);return Array.isArray(o)?o[0]:o}function Q6(t,e){let n=t;return A(U6(),r=>{n=r(t,e)}),n}function e9(t){let e=RL(t);return PT(e)||(e=eR,EL(t)),e}function t9(t,e,n){return(e=n9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n9(t){var e=r9(t,"string");return typeof e=="symbol"?e:e+""}function r9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ps extends lL{constructor(e,n){super(e,null),t9(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function Uy(t){let{activeHeaderClassName:e,...n}=t;return new ps({className:e,...n,selectionType:uL})}function i9(t){let{areaCornerVisible:e,...n}=t;return new ps({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:GE})}function o9(t){let{...e}=t;return new ps({className:"highlight",...e,selectionType:GE})}function s9(t){let{columnClassName:e,...n}=t;return new ps({className:e,...n,selectionType:_4})}function a9(t){let{cellCornerVisible:e,...n}=t;return new ps({className:"current",headerAttributes:[PE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Dm})}function l9(t){let{border:e,visualCellRange:n,...r}=t;return new ps({...e,...r,selectionType:M4},n)}function u9(t){let{...e}=t;return new ps({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:E4})}function M1(t){let{headerClassName:e,...n}=t;return new ps({className:e,...n,selectionType:YE})}function c9(t){let{rowClassName:e,...n}=t;return new ps({className:e,...n,selectionType:T4})}function h9(t,e){d9(t,e),e.add(t)}function d9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nr(t,e,n){return(e=f9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f9(t){var e=g9(t,"string");return typeof e=="symbol"?e:e+""}function g9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function No(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ui=new WeakSet;class m9{constructor(e){h9(this,Ui),nr(this,"options",void 0),nr(this,"layerLevel",0),nr(this,"focus",void 0),nr(this,"fill",void 0),nr(this,"layeredAreas",new Map),nr(this,"areas",new Map),nr(this,"rowHeaders",new Map),nr(this,"columnHeaders",new Map),nr(this,"activeRowHeaders",new Map),nr(this,"activeColumnHeaders",new Map),nr(this,"activeCornerHeaders",new Map),nr(this,"rowHighlights",new Map),nr(this,"columnHighlights",new Map),nr(this,"customSelections",[]),this.options=e,this.focus=a9(e),this.fill=u9(e)}isEnabledFor(e,n){let r=e;e===Dm&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return No(Ui,this,Do).call(this,this.layeredAreas,i9)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return No(Ui,this,Do).call(this,this.areas,o9)}getAreas(){return[...this.areas.values()]}createRowHeader(){return No(Ui,this,Do).call(this,this.rowHeaders,M1)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return No(Ui,this,Do).call(this,this.columnHeaders,M1)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return No(Ui,this,Do).call(this,this.activeRowHeaders,Uy)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return No(Ui,this,Do).call(this,this.activeColumnHeaders,Uy)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return No(Ui,this,Do).call(this,this.activeCornerHeaders,Uy)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return No(Ui,this,Do).call(this,this.rowHighlights,c9)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return No(Ui,this,Do).call(this,this.columnHighlights,s9)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(l9({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),A(this.areas.values(),e=>void e.clear()),A(this.layeredAreas.values(),e=>void e.clear()),A(this.rowHeaders.values(),e=>void e.clear()),A(this.columnHeaders.values(),e=>void e.clear()),A(this.activeRowHeaders.values(),e=>void e.clear()),A(this.activeColumnHeaders.values(),e=>void e.clear()),A(this.activeCornerHeaders.values(),e=>void e.clear()),A(this.rowHighlights.values(),e=>void e.clear()),A(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Do(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function I1(t,e,n){return(e=p9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p9(t){var e=w9(t,"string");return typeof e=="symbol"?e:e+""}function w9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OT{constructor(e){I1(this,"ranges",[]),I1(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((r,i)=>r.includes(e)&&n(r,i))}findAll(e){const n=[];return this.ranges.forEach((r,i)=>{r.isEqual(e)&&n.push({range:r,layer:i})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(r=>r.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,r)=>!e.includes(r)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new OT(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,r)=>e(n,r)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function v9(t,e){xL(t,e),e.add(t)}function zy(t,e,n){xL(t,e),e.set(t,n)}function xL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ye(t,e){return t.get(Zt(t,e))}function Ff(t,e,n){return t.set(Zt(t,e),n),n}function Zt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vf=new WeakMap,wt=new WeakMap,Oi=new WeakMap,hn=new WeakSet;class tR{constructor(e,n){v9(this,hn),zy(this,Vf,void 0),zy(this,wt,void 0),zy(this,Oi,{x:0,y:0}),Ff(Vf,this,e),Ff(wt,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Ye(wt,this).createCellCoords(e,n);let o=Ye(Vf,this).current().highlight;const s=Ye(wt,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Zt(hn,this,AL).call(this),{row:h,col:d}=Zt(hn,this,O1).call(this,o),f=Ye(wt,this).fixedRowsBottom(),g=Ye(wt,this).minSpareRows(),w=Ye(wt,this).minSpareCols(),C=Ye(wt,this).autoWrapRow(),S=Ye(wt,this).autoWrapCol(),v=Ye(wt,this).createCellCoords(h+i.row,d+i.col);if(v.row>=c){const x=Hr(r&&g>0&&f===0),I=v.col+1,P=Ye(wt,this).createCellCoords(v.row-c,I>=u?I-u:I);this.runLocalHooks("beforeColumnWrap",x,Zt(hn,this,Kl).call(this,P),I>=u),x.value?this.runLocalHooks("insertRowRequire",Ye(wt,this).countRenderableRows()):S&&v.assign(P)}else if(v.row<0){const x=Hr(S),I=v.col-1,P=Ye(wt,this).createCellCoords(c+v.row,I<0?u+I:I);this.runLocalHooks("beforeColumnWrap",x,Zt(hn,this,Kl).call(this,P),I<0),S&&v.assign(P)}if(v.col>=u){const x=Hr(r&&w>0),I=v.row+1,P=Ye(wt,this).createCellCoords(I>=c?I-c:I,v.col-u);this.runLocalHooks("beforeRowWrap",x,Zt(hn,this,Kl).call(this,P),I>=c),x.value?this.runLocalHooks("insertColRequire",Ye(wt,this).countRenderableColumns()):C&&v.assign(P)}else if(v.col<0){const x=Hr(C),I=v.row-1,P=Ye(wt,this).createCellCoords(I<0?c+I:I,u+v.col);this.runLocalHooks("beforeRowWrap",x,Zt(hn,this,Kl).call(this,P),I<0),C&&v.assign(P)}const{rowDir:T,colDir:M}=Zt(hn,this,P1).call(this,v);a=T,l=M,o=Zt(hn,this,Kl).call(this,v)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Ye(wt,this).createCellCoords(e,n),i=Ye(Vf,this).current(),o=Ye(wt,this).visualToRenderableCoords(i.highlight),s=Zt(hn,this,Yy).call(this,i.to.row,i.from.row),a=Zt(hn,this,Gy).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=Zt(hn,this,O1).call(this,i.highlight),f=Ye(wt,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),w=i.getTopEndCorner(),C=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const M=f.col-d;f.col=Zt(hn,this,Gy).call(this,g.col,w.col)+M}else if(r.col>0&&a<=d&&f.col>d){const M=Zt(hn,this,Gy).call(this,w.col,g.col),x=Math.max(f.col-M,1);f.col=M+x}if(r.row<0&&s>=h&&f.row<h){const M=f.row-h;f.row=Zt(hn,this,Yy).call(this,g.row,C.row)+M}else if(r.row>0&&s<=h&&f.row>h){const M=Zt(hn,this,Yy).call(this,C.row,g.row),x=Math.max(f.row-M,1);f.row=M+x}const{rowDir:S,colDir:v}=Zt(hn,this,P1).call(this,f);u=S,c=v;const T=Zt(hn,this,Kl).call(this,f);r.row===0&&r.col!==0?l.col=T.col:r.row!==0&&r.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;Ff(Oi,this,{x:n,y:r})}resetOffsetSize(){Ff(Oi,this,{x:0,y:0})}}function P1(t){const{width:e,height:n}=Zt(hn,this,AL).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function AL(){return{width:Ye(Oi,this).x+Ye(wt,this).countRenderableColumns(),height:Ye(Oi,this).y+Ye(wt,this).countRenderableRows()}}function Yy(t,e){const n=Ye(wt,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Ye(Oi,this).y+n}function Gy(t,e){const n=Ye(wt,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Ye(Oi,this).x+n}function O1(t){const{row:e,col:n}=Ye(wt,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Ye(wt,this).createCellCoords(Ye(Oi,this).y+e,Ye(Oi,this).x+n)}function Kl(t){const e=t.clone();return e.col=t.col-Ye(Oi,this).x,e.row=t.row-Ye(Oi,this).y,Ye(wt,this).renderableToVisualCoords(e)}ht(tR,Sn);const tw=0,nw=1,HL=2,xT=3,C9=[xT,HL],y9=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],qy=Symbol("root"),x1=Symbol("child");function oc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qy;if(e!==qy&&e!==x1)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===qy;let i=tw;if(n){const o=t[0];t.length===0?i=nw:r&&o instanceof Kd?i=xT:r&&Array.isArray(o)?i=oc(o,x1):t.length>=2&&t.length<=4&&!t.some((a,l)=>!y9[l].includes(typeof a))&&(i=HL)}return i}function bd(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!C9.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===xT;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Mt(u)&&(u=a),Mt(c)&&(c=l),!r){const f=a,g=l,w=u,C=c;a=Math.min(f,w),l=Math.min(g,C),u=Math.max(f,w),c=Math.max(g,C)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function b9(t){const e=oc(t.getSelected());if(e===tw||e===nw)return[];const n=bd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;A(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;A(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return vr(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function S9(t){const e=oc(t.getSelected());if(e===tw||e===nw)return[];const n=bd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;A(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;A(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return vr(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Xl(t,e,n){R9(t,e),e.set(t,n)}function R9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ya(t,e,n){return(e=E9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E9(t){var e=T9(t,"string");return typeof e=="symbol"?e:e+""}function T9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yt(t,e){return t.get(NL(t,e))}function zi(t,e,n){return t.set(NL(t,e),n),n}function NL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tn=new WeakMap,ba=new WeakMap,Wf=new WeakMap,Qc=new WeakMap,Bf=new WeakMap,eh=new WeakMap;class DL{constructor(e,n){var r=this;ya(this,"settings",void 0),ya(this,"tableProps",void 0),ya(this,"inProgress",!1),ya(this,"selectedRange",new OT((i,o,s)=>this.tableProps.createCellRange(i,o,s))),ya(this,"highlight",void 0),Xl(this,Tn,void 0),Xl(this,ba,void 0),ya(this,"selectedByRowHeader",new Set),ya(this,"selectedByColumnHeader",new Set),Xl(this,Wf,!1),Xl(this,Qc,!1),Xl(this,Bf,"unknown"),Xl(this,eh,-1),this.settings=e,this.tableProps=n,this.highlight=new m9({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[PE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),zi(Tn,this,new tR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),zi(ba,this,new tR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),yt(Tn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),yt(Tn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),yt(Tn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),yt(Tn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),yt(Tn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),yt(Tn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),yt(Tn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),yt(Tn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),yt(ba,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),yt(ba,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){zi(Bf,this,e)}markEndSource(){zi(Bf,this,"unknown")}getSelectionSource(){return yt(Bf,this)}setExpectedLayers(e){zi(eh,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,zi(eh,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();zi(Wf,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Mt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=yt(eh,this)===-1||this.selectedRange.size()===yt(eh,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(A(this.highlight.getAreas(),g=>void g.clear()),A(this.highlight.getLayeredAreas(),g=>void g.clear()),A(this.highlight.getRowHeaders(),g=>void g.clear()),A(this.highlight.getColumnHeaders(),g=>void g.clear()),A(this.highlight.getActiveRowHeaders(),g=>void g.clear()),A(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),A(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),A(this.highlight.getRowHighlights(),g=>void g.clear()),A(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(GE,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(YE,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),S=this.tableProps.createCellCoords(e.to.row,-1),v=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(v).commit(),d.add(C).commit(),f.add(v).commit()):(a.add(C).add(S).commit(),l.add(v).add(T).commit(),d.add(C).add(S).commit(),f.add(v).add(T).commit())}const g=!yt(Qc,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),w=!yt(Qc,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),w&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&w&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Dm,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(zi(Wf,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?yt(Tn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):yt(Tn,this).resetOffsetSize(),this.setRangeStart(yt(Tn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?yt(Tn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):yt(Tn,this).resetOffsetSize(),this.setRangeEnd(yt(Tn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?yt(ba,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):yt(ba,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=yt(ba,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(je(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(je(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(je(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,je(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,je(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,je(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const n=Hr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&yt(Wf,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;zi(Qc,this,f),d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(je(d.row,u,o-1),je(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),w=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.finish(),zi(Qc,this,!1)}selectCells(e){var n=this;const r=oc(e);if(r===nw)return!1;if(r===tw)throw new Error(nt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=bd(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),A(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(f=je(r.row,u,s-1),g=je(r.col,Math.min(i,o),Math.max(i,o))):(f=je(r,u,s-1),g=i);const w=this.tableProps.createCellCoords(f,g),C=l===0?0:je(w.row,u,-1),S=s-1,v=this.tableProps.createCellCoords(C,i),T=this.tableProps.createCellCoords(S,o);this.runLocalHooks("beforeSelectColumns",v,T,w),v.row=C,T.row=S,this.setRangeStartOnly(v,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",v,T,w),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(h=je(r.row,Math.min(e,n),Math.max(e,n)),d=je(r.col,a,o-1)):(h=e,d=je(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:je(f.col,a,-1),w=o-1,C=this.tableProps.createCellCoords(e,g),S=this.tableProps.createCellCoords(n,w);this.runLocalHooks("beforeSelectRows",C,S,f),C.col=g,S.col=w,this.setRangeStartOnly(C,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectRows",C,S,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(r.length),r.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=n-1;u.assign({row:je(u.row,this.settings.navigableHeaders?-1/0:0,c),col:je(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:je(a.row,-1/0,c),col:je(a.col,-1/0,h)}),l.assign({row:je(l.row,-1/0,c),col:je(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(Dm,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}ht(DL,Sn);const A1=/^(\r\n|\n\r|\r|\n)/,_9=/^[^\t\r\n]+/,H1=/^\t/;function M9(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(H1))t=t.replace(H1,""),n+=1,e[r][n]="";else if(t.match(A1))t=t.replace(A1,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(_9);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Yh(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Sa(t,e,n){return(e=I9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I9(t){var e=P9(t,"string");return typeof e=="symbol"?e:e+""}function P9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){Sa(this,"hot",void 0),Sa(this,"metaManager",void 0),Sa(this,"tableMeta",void 0),Sa(this,"dataSource",void 0),Sa(this,"duckSchema",void 0),Sa(this,"colToPropCache",void 0),Sa(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=xE(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Ae(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return wL(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&He(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?wd(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Xn(this.getSchema()):(g=[],he(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},jp(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,n,r)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let f=0;for(let g=d;f<n&&l+f<s;g++){if(typeof c!="number"||c>=l+f)if(u>0)for(let w=0;w<u;w+=1)typeof o[w]>"u"&&(o[w]=[]),o[w].push(null);else o.push([null]);else for(let w=0;w<u;w++)o[w].splice(g,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(c,f,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];FO(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return nq(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];FO(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Qt(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Hr(a);this.hot.runHooks("modifyData",e,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Hr(o);this.hot.runHooks("modifyData",e,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Qt(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Lu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Lu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return Yh(this.getRange(e,n,Lu.DESTINATION_RENDERER))}getCopyableText(e,n){return Yh(this.getRange(e,n,Lu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:O9,getItem:x9,hasItem:kL,getNames:sfe,getValues:afe}=li("cellTypes");function A9(t){if(!kL(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return x9(t)}function Ci(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Er(t,n),r&&jr(t,r),i&&Iu(t,i),O9(t,e)}function H9(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Qt(e,t)}function rw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?A9(e.type):e.type;if(t._automaticallyAssignedMetaProps&&He(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Ae(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};He(r,(o,s)=>{if(H9(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),nn(t,i)}function N9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Dq(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function sm(t){return Number.isInteger(t)&&t>=0}function am(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function jf(t){return t==null}const LL=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Wt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Wt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),OE(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function N1(t,e,n){return(e=D9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D9(t){var e=k9(t,"string");return typeof e=="symbol"?e:e+""}function k9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function L9(){return class{}}class $9{constructor(e){N1(this,"metaCtor",L9()),N1(this,"meta",void 0),this.meta=this.metaCtor.prototype,nn(this.meta,LL()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;nn(this.meta,e),rw(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function F9(t,e,n){return(e=V9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V9(t){var e=W9(t,"string");return typeof e=="symbol"?e:e+""}function W9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B9{constructor(e){F9(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){nn(this.meta,e),rw(this.meta,e,e)}}function Uf(t,e,n){return(e=j9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j9(t){var e=U9(t,"string");return typeof e=="symbol"?e:e+""}function U9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $m{constructor(e){Uf(this,"valueFactory",void 0),Uf(this,"data",[]),Uf(this,"index",[]),Uf(this,"holes",new Set),this.valueFactory=e}obtain(e){am(()=>sm(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;am(()=>sm(e)||jf(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=jf(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;am(()=>sm(e)||jf(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(jf(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function D1(t,e,n){return(e=z9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z9(t){var e=Y9(t,"string");return typeof e=="symbol"?e:e+""}function Y9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const G9=["data","width"];class q9{constructor(e){D1(this,"globalMeta",void 0),D1(this,"metas",new $m(()=>this._createMeta())),this.globalMeta=e,this.metas=new $m(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);nn(r,n),rw(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return N9(this.globalMeta.getMetaConstructor(),G9).prototype}}function k1(t,e,n){return(e=K9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K9(t){var e=X9(t,"string");return typeof e=="symbol"?e:e+""}function X9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z9{constructor(e){k1(this,"columnMeta",void 0),k1(this,"metas",new $m(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);nn(i,r),rw(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){am(()=>sm(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new $m(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class $L{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new $9(e),this.tableMeta=new B9(this.globalMeta),this.columnMeta=new q9(this.globalMeta),this.cellMeta=new Z9(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ht($L,Sn);function L1(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Ni(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":ot(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Lu(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let w,C=0,S=0;for(C=0,S=d.startRows;C<S;C++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)w=Xn(g),t.push(w);else if(i.dataType==="array")w=Xn(g[0]),t.push(w);else{w=[];for(let v=0,T=d.startCols;v<T;v++)w.push(null);t.push(w)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ce(i.rootElement,[wk(-1),Bp(i.countCols()+(i.view?i.countRowHeaders():0))])}function $1(t,e,n){return(e=J9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J9(t){var e=Q9(t,"string");return typeof e=="symbol"?e:e+""}function Q9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e8{constructor(e){var n=this;$1(this,"metaManager",void 0),$1(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),re.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Qt(e,"type")?e.type:null;let c=ot(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function t8(t,e,n){n8(t,e),e.set(t,n)}function n8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ky(t,e,n){return(e=r8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r8(t){var e=i8(t,"string");return typeof e=="symbol"?e:e+""}function i8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function o8(t,e){return t.get(s8(t,e))}function s8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var F1=new WeakMap;class a8{constructor(e){Ky(this,"metaManager",void 0),Ky(this,"usageTracker",new Set),Ky(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),t8(this,F1,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,o8(F1,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const FL="gridDefault",da="editorManager.handlingEditor",l8={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},u8="hooksRefRegisterer",VL={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){A(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){He(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ms(VL,"MIXIN_NAME",u8,{writable:!1,enumerable:!1});function gi(t,e,n){return(e=c8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c8(t){var e=h8(t,"string");return typeof e=="symbol"?e:e+""}function h8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const d8="base",Ft=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Rc{static get EDITOR_TYPE(){return d8}constructor(e){gi(this,"hot",void 0),gi(this,"state",Ft.VIRGIN),gi(this,"_opened",!1),gi(this,"_fullEditMode",!1),gi(this,"_closeCallback",null),gi(this,"TD",null),gi(this,"row",null),gi(this,"col",null),gi(this,"prop",null),gi(this,"originalValue",null),gi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Ft.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Ft.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Ft.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:It(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Ft.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Ft.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Ft.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Ft.FINISHED,this.discardEditor(s)}):(this.state=Ft.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Ft.FINISHED,this.discardEditor()}discardEditor(e){this.state===Ft.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Ft.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Ft.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Ft.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Hn(n),a=Yt(n),l=Hn(this.hot.rootElement),u=Yt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:w}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,C=w.name,S=["master","inline_start"].includes(C)?d:0,v=["master","top","bottom"].includes(C)?f:0,T=s.top===l.top?0:1;let M=s.top-l.top-T-S,x=0;this.hot.isRtl()?x=o.innerWidth-s.left-a-g-1+v:x=s.left-l.left-1-v,["top","top_inline_start_corner"].includes(C)&&(M+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(x+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const I=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),U=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),N=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(I&&P<=0||P===N)&&(M+=1),U<=0&&(x+=1);const Y=i.rowsRenderCalculator.startPosition,X=i.columnsRenderCalculator.startPosition,se=Math.abs(r.inlineStartOverlay.getScrollPosition()),ee=r.topOverlay.getScrollPosition(),te=Cn(this.hot.rootDocument);let Le=n.offsetTop;if(["inline_start","master"].includes(C)&&(Le+=Y-ee),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:B,wtTable:G}=r.bottomOverlay.clone;Le+=B.getWorkspaceHeight()-G.getHeight()-te}let Ne=n.offsetLeft;this.hot.isRtl()?(Ne>=0?Ne=w.getWidth()-n.offsetLeft:Ne=Math.abs(Ne),Ne+=X-se-a):["top","master","bottom"].includes(C)&&(Ne+=X-se);const $e=o.getComputedStyle(this.TD),vt=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",rt=parseInt($e[vt],10)>0?0:1,at=parseInt($e.borderTopWidth,10)>0?0:1,gn=Yt(n)+rt,m=tn(n)+at,p=Ak(c)?te:0,b=Hk(h)?te:0,D=this.hot.view.maximumVisibleElementWidth(Ne)-p+rt,F=Math.max(this.hot.view.maximumVisibleElementHeight(Le)-b+at,this.hot.stylesHandler.getDefaultRowHeight());return{top:M,start:x,height:m,maxHeight:F,width:gn,maxWidth:D}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}ht(Rc,VL);const f8={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Ft.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},g8={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},m8={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},p8={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},w8={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Fi(e))}};function v8(){return[l8,f8,g8,m8,p8,w8]}const C8={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},y8={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},b8={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},S8={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},R8={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},E8={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},T8={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},_8={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},M8={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},I8={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},P8={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},O8={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},x8={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},A8={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function H8(){return[C8,y8,b8,S8,R8,E8,T8,_8,M8,I8,P8,O8,x8,A8]}const N8={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},D8={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},k8={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},L8={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},$8={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},F8={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},V8={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},W8={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},B8={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},j8={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},U8={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},z8={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},Y8={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},G8={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},q8={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},K8={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function X8(){return[N8,D8,k8,L8,$8,F8,V8,W8,B8,j8,U8,z8,Y8,G8,q8,K8]}const Z8={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},J8={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Q8={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},e7={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},t7={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},n7=[...v8(),...H8(),...X8(),Z8,J8,Q8,e7,t7];function WL(t){const e={};return n7.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function r7(t){const e=t.getShortcutManager().addContext("editor"),n=WL(t),r={group:da};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function i7(t){const e=t.getShortcutManager().addContext("grid"),n=WL(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:FL};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:da,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function o7(t){[i7,r7].forEach(e=>e(t))}function s7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=V1(t),i=V1(t);return r.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),n.before(r),n.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function V1(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ce(n,[tc("Focus catcher")]),n}function a7(t){const e=l7(t);let n;const{activate:r,deactivate:i}=s7(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:nR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:rR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,w)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,w.value=!0),s){var C;n=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:FL,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?nR(t):rR(t)),u(),!1;h.preventDefault()},position:"after"}])}function nR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function rR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function l7(t){return e=>{if(!e)return null;const n=nR(t),r=rR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function Ec(t){as(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function iw(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,w=f<=h,C=g>=d;return{getComputedColumnTarget(S){return i==="mouse"||i==="keyboard"?S.col:u&&c?r.highlight.col:u?a:c?l:S.col},getComputedRowTarget(S){return i==="mouse"||i==="keyboard"?S.row:w&&C?r.highlight.row:w?f:C?g:S.row}}}function u7(t){return e=>{const n=iw(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;Ec(t.getCell(r?-1:0,n,!0))})}}function c7(){return()=>{}}function h7(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;Ec(t.getCell(n,r,!0))})}}function d7(t){return e=>{const n=iw(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Ec(t.getCell(i,o,!0))})}}function f7(t){return e=>{const n=iw(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Ec(t.getCell(i,o,!0))})}}function g7(t){return e=>{const n=iw(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;Ec(t.getCell(n,r?-1:0,!0))})}}function m7(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{Ec(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function p7(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=h7(t):e.isSelectedByCorner()?s=c7():e.isSelectedByRowHeader()?s=g7(t):e.isSelectedByColumnHeader()?s=u7(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=d7(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=m7(t):e.getSelectedRange().size()>1&&(s=f7(t)),(o=s)===null||o===void 0||o(i)}}}const W1=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),zf=t=>t.map(e=>{const n=e.toLowerCase();return W1.has(n)?W1.get(n):n}).sort().join("+"),w7=t=>t.split("+"),B1=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Xy=t=>{let{which:e,key:n}=t;if(B1.has(e))return B1.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},BL=Symbol("shortcut-context");function jL(t){return Ae(t)&&t.__kindOf===BL}const v7=t=>{const e=qp({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:w,position:C,forwardToContext:S}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Mt(c))throw new Error("You need to define the shortcut's group.");if(ot(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(nt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const v={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};le(w)&&(v.relativeToGroup=w,v.position=C),jL(S)&&(v.forwardToContext=S),l.forEach(T=>{const M=zf(T);if(e.hasItem(M)){const I=e.getItem(M);let P=I.findIndex(U=>U.group===w);P!==-1?C==="before"?P-=1:P+=1:P=I.length,I.splice(P,0,v)}else e.addItem(M,[v])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{He(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=zf(l);e.removeItem(u)};return{__kindOf:BL,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=zf(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=zf(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(w7(h)):(d.length=0,d.push(...f))})}}};function C7(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const y7=["meta","alt","shift","control"],th=C7(),nh=[];let Yf=0;function b7(t,e,n,r,i){const o=f=>y7.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=[];return f.altKey&&w.push("alt"),g&&(f.ctrlKey||f.metaKey)?w.push("control/meta"):(f.ctrlKey&&w.push("control"),f.metaKey&&w.push("meta")),f.shiftKey&&w.push("shift"),w},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||tl(f))return;const w=Xy(f);let C=[];o(w)||(C=s(f));const S=[w].concat(C);!i(f,S)&&(JO()&&C.includes("meta")||!JO()&&C.includes("control"))&&i(f,[w].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=Xy(f);o(g)&&th.press(g)}},u=f=>{if(typeof f.key=="string"){const g=Xy(f);o(g)&&th.release(g)}},c=()=>{th.releaseAll()};return{mount:()=>{let f=t;for(Yf+=1;f;)Yf===1&&(f.document.documentElement.addEventListener("keydown",l),nh.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),nh.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=nc(f)},unmount:()=>{let f=t;for(Yf-=1;f;){if(Yf===0){for(let g=0;g<nh.length;g++){const{event:w,listener:C}=nh[g];f.document.documentElement.removeEventListener(w,C)}nh.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=nc(f)}},isPressed:f=>th.isPressed(f),releasePressedKeys:()=>th.releaseAll()}}const S7=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=qp({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const w=v7(g);return o.addItem(g,w),w},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(nt`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,w){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const S=jL(C)?C:u(C);let v=!1;if(!S.hasShortcut(w))return v;const T=S.getShortcuts(w);for(let M=0;M<T.length;M++){const{callback:x,runOnlyIf:I,preventDefault:P,stopPropagation:U,captureCtrl:K,forwardToContext:N}=T[M];if(I(g)===!0){if(h=K,v=x(g,w)===!1,h=!1,P&&g.preventDefault(),U&&(Fi(g),g.stopPropagation()),v)break;N&&d(g,w,N)}}return v},f=b7(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function j1(t){const{classNames:e}=Yq(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function R7(t,e){UL(t,e),e.add(t)}function Ra(t,e,n){UL(t,e),e.set(t,n)}function UL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xn(t,e){return t.get(_i(t,e))}function Yr(t,e,n){return t.set(_i(t,e),n),n}function _i(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const U1=23;var Ea=new WeakMap,Fm=new WeakMap,AT=new WeakMap,iR=new WeakMap,ks=new WeakMap,Lh=new WeakMap,Sd=new WeakMap,oo=new WeakSet;class E7{constructor(e,n){R7(this,oo),Ra(this,Ea,void 0),Ra(this,Fm,void 0),Ra(this,AT,void 0),Ra(this,iR,void 0),Ra(this,ks,!0),Ra(this,Lh,{}),Ra(this,Sd,{}),Yr(Fm,this,e),Yr(iR,this,n)}isClassicTheme(){return xn(ks,this)}getCSSVariableValue(e){var n;if(xn(ks,this))return null;if(xn(Lh,this)[`--ht-${e}`])return xn(Lh,this)[`--ht-${e}`];const r=(n=_i(oo,this,M7).call(this,`--ht-${e}`))!==null&&n!==void 0?n:_i(oo,this,zL).call(this,`--ht-${e}`);if(r!==null)return xn(Lh,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=xn(Sd,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(xn(ks,this))return U1;const e=_i(oo,this,T7).call(this);return e||U1}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Yr(Ea,this,void 0),Yr(ks,this,!0),_i(oo,this,Zy).call(this);return}if(e&&e!==xn(Ea,this)){if(!/ht-theme-.*/.test(e)){Ke(`Invalid theme name: ${e}. Please provide a valid theme name.`),Yr(Ea,this,void 0),Yr(ks,this,!1),_i(oo,this,Zy).call(this);return}xn(Ea,this)&&_i(oo,this,I7).call(this),Yr(Ea,this,e),Yr(ks,this,!1),_i(oo,this,Zy).call(this)}}getThemeName(){return xn(Ea,this)}}function T7(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Zy(){this.isClassicTheme()||Yr(AT,this,getComputedStyle(xn(Fm,this)));const t=_i(oo,this,_7).call(this,["box-sizing","border-bottom-width"]);xn(Sd,this).td={...xn(Sd,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function _7(t){const e=xn(iR,this),n=xn(Fm,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function M7(t){const e=Math.ceil(parseFloat(_i(oo,this,zL).call(this,t)));return Number.isNaN(e)?null:e}function zL(t){const e=xn(AT,this).getPropertyValue(t);return e===""?null:e}function I7(){Yr(Sd,this,{}),Yr(Lh,this,{}),Yr(ks,this,!0)}function P7(t,e){YL(t,e),e.add(t)}function z1(t,e,n){YL(t,e),e.set(t,n)}function YL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Y1(t,e){return t.get(sc(t,e))}function G1(t,e,n){return t.set(sc(t,e),n),n}function sc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oR=new WeakMap,sR=new WeakMap,Gh=new WeakSet;class O7{constructor(e){let{rowIndexMapper:n,columnIndexMapper:r}=e;P7(this,Gh),z1(this,oR,void 0),z1(this,sR,void 0),G1(oR,this,n),G1(sR,this,r)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,i=sc(Gh,this,q1).call(this,e.from,n,r);if(i===null)return null;const o=sc(Gh,this,q1).call(this,e.to,-n,-r);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function q1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const r=sc(Gh,this,K1).call(this,Y1(oR,this),t.row,e);if(r===null)return null;const i=sc(Gh,this,K1).call(this,Y1(sR,this),t.col,n);return i===null?null:t.clone().assign({row:r,col:i})}function K1(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}let Jy=null;const Qy=new Map;function GL(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Di(o);let a,l,u,c,h,d,f=!0;n6(i)&&t6(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=Pu(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Pu(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),q(this.rootElement,"ht-wrapper"),q(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),q(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e?.layoutDirection)!==null&&n!==void 0?n:"inherit",w=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return w==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new E7(o.rootElement,o.rootDocument),e.language=e9(e.language);const C=Object.fromEntries(Object.entries(e).filter(m=>{let[p]=m;return!(re.getSingleton().isRegistered(p)||re.getSingleton().isDeprecated(p))})),S=new $L(o,C,[e8,a8]),v=S.getTableMeta(),T=S.getGlobalMeta(),M=qp();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),Pu(this)&&aq(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${ck()}`,Qy.set(this.guid,this),this.columnIndexMapper=new QS,this.rowIndexMapper=new QS,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new w6(o);const x=li(this.guid);x.register("cellRangeMapper",new O7({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const I=m=>{const{row:p,col:b}=m;return o._createCellCoords(p>=0?o.rowIndexMapper.getRenderableFromVisualIndex(p):p,b>=0?o.columnIndexMapper.getRenderableFromVisualIndex(b):b)},P=m=>{const{row:p,col:b}=m;return o._createCellCoords(p>=0?o.rowIndexMapper.getVisualFromRenderableIndex(p):p,b>=0?o.columnIndexMapper.getVisualFromRenderableIndex(b):b)},U=(m,p)=>{const b=p>m?1:-1,D=Math.min(m,p),F=Math.max(m,p),B=o.rowIndexMapper.getNearestNotHiddenIndex(m,b);return B===null||b===1&&B>F||b===-1&&B<D?null:B>=0?o.rowIndexMapper.getRenderableFromVisualIndex(B):B},K=(m,p)=>{const b=p>m?1:-1,D=Math.min(m,p),F=Math.max(m,p),B=o.columnIndexMapper.getNearestNotHiddenIndex(m,b);return B===null||b===1&&B>F||b===-1&&B<D?null:B>=0?o.columnIndexMapper.getRenderableFromVisualIndex(B):B};let N=new DL(v,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,p)=>o._createCellCoords(m,p),createCellRange:(m,p,b)=>o._createCellRange(m,p,b),visualToRenderableCoords:I,renderableToVisualCoords:P,findFirstNonHiddenRenderableRow:U,findFirstNonHiddenRenderableColumn:K,isDisabledCellSelection:(m,p)=>m<0||p<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,p).disableVisualSelection});this.selection=N;const Y=m=>{let{hiddenIndexesChanged:p}=m;this.forceFullRender=!0,p&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Y),this.rowIndexMapper.addLocalHook("cacheUpdated",Y),this.selection.addLocalHook("afterSetRangeEnd",(m,p)=>{const b=Hr(!1),D=this.selection.getSelectedRange(),{from:F,to:B}=D.current(),G=D.size()-1;this.runHooks("afterSelection",F.row,F.col,B.row,B.col,b,G),this.runHooks("afterSelectionByProp",F.row,o.colToProp(F.col),B.row,o.colToProp(B.col),b,G),p&&(!b.isTouched()||b.isTouched()&&!b.value)&&d.scrollTo(m);const y=N.isSelectedByRowHeader(),R=N.isSelectedByColumnHeader();y&&R?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):y?(we(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):R?(we(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(N.getSelectionSource())||c.closeEditor(null),N.getSelectionSource()!=="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const p=Hr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,p),(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const p=m.length-1,{from:b,to:D}=m[p];this.runHooks("afterSelectionEnd",b.row,b.col,D.row,D.col,p),this.runHooks("afterSelectionEndByProp",b.row,o.colToProp(b.col),D.row,o.colToProp(D.col),p),N.getSelectionSource()==="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const p=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=p)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSetRangeStart",...p)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSetRangeStartOnly",...p)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSetRangeEnd",...p)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSelectColumns",...p)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterSelectColumns",...p)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeSelectRows",...p)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterSelectRows",...p)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("modifyTransformStart",...p)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterModifyTransformStart",...p)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("modifyTransformFocus",...p)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterModifyTransformFocus",...p)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("modifyTransformEnd",...p)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("afterModifyTransformEnd",...p)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeRowWrap",...p)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,p=new Array(m),b=0;b<m;b++)p[b]=arguments[b];return r.runHooks("beforeColumnWrap",...p)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,p){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3?arguments[3]:void 0,F=arguments.length>4?arguments[4]:void 0;const B=G=>{if(G.length===0)return[];const y=[...G];return y.sort((E,_)=>{let[O]=E,[L]=_;return O===L?0:O>L?1:-1}),vr(y,(E,_)=>{let[O,L]=_;const W=E[E.length-1],[H,$]=W,V=H+$;if(O<=V){const j=Math.max(L-(V-O),0);W[1]+=j}else E.push([O,L]);return E},[y[0]])};switch(m){case"insert_row_below":case"insert_row_above":const G=o.countSourceRows();if(v.maxRows===G)return;const y=m==="insert_row_below"?"below":"above";p=p??(y==="below"?G:0);const{delta:R,startPhysicalIndex:E}=a.createRow(p,b,{source:D,mode:y});N.shiftRows(o.toVisualRow(E),R);break;case"insert_col_start":case"insert_col_end":const _=m==="insert_col_end"?"end":"start";p=p??(_==="end"?o.countSourceCols():0);const{delta:O,startPhysicalIndex:L}=a.createCol(p,b,{source:D,mode:_});if(O){if(Array.isArray(v.colHeaders)){const $=[o.toVisualColumn(L),0];$.length+=O,Array.prototype.splice.apply(v.colHeaders,$)}N.shiftColumns(o.toVisualColumn(L),O)}break;case"remove_row":const W=$=>{let V=0;A($,j=>{let[z,oe]=j;const ae=Wt(z)?o.countRows()-1:Math.max(z-V,0);if(Number.isInteger(z)&&(z=Math.max(z-V,0)),!a.removeRow(z,oe,D))return;if(N.isSelected()){const{row:be}=o.getSelectedRangeLast().highlight;be>=z&&be<=z+oe-1&&c.closeEditor(!0)}const Fe=o.countRows(),Ve=v.fixedRowsTop;Ve>=ae+1&&(v.fixedRowsTop-=Math.min(oe,Ve-ae));const Re=v.fixedRowsBottom;if(Re&&ae>=Fe-Re&&(v.fixedRowsBottom-=Math.min(oe,Re)),Fe===0)N.deselect();else if(D==="ContextMenu.removeRow"){const be=N.getSelectedRange(),et=be.pop();be.clear().set(et.from).current().setTo(et.to),N.refresh()}else N.shiftRows(z,-oe);V+=oe})};Array.isArray(p)?W(B(p)):W([[p,b]]);break;case"remove_col":const H=$=>{let V=0;A($,j=>{let[z,oe]=j;const ae=Wt(z)?o.countCols()-1:Math.max(z-V,0);let Se=o.toPhysicalColumn(ae);if(Number.isInteger(z)&&(z=Math.max(z-V,0)),!a.removeCol(z,oe,D))return;if(N.isSelected()){const{col:be}=o.getSelectedRangeLast().highlight;be>=z&&be<=z+oe-1&&c.closeEditor(!0)}if(o.countCols()===0)N.deselect();else if(D==="ContextMenu.removeColumn"){const be=N.getSelectedRange(),et=be.pop();be.clear().set(et.from).current().setTo(et.to),N.refresh()}else N.shiftColumns(z,-oe);const Re=v.fixedColumnsStart;Re>=ae+1&&(v.fixedColumnsStart-=Math.min(oe,Re-ae)),Array.isArray(v.colHeaders)&&(typeof Se>"u"&&(Se=-1),v.colHeaders.splice(Se,oe)),V+=oe})};Array.isArray(p)?H(B(p)):H([[p,b]]);break;default:throw new Error(`There is no such action "${m}"`)}F||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=v.minRows,p=v.minSpareRows,b=v.minCols,D=v.minSpareCols;if(m){const F=o.countRows();F<m&&a.createRow(F,m-F,{source:"auto"})}if(p){const F=o.countEmptyRows(!0);if(F<p){const B=p-F,G=Math.min(B,v.maxRows-o.countSourceRows());a.createRow(o.countRows(),G,{source:"auto"})}}{let F;(b||D)&&(F=o.countEmptyCols(!0));let B=o.countCols();if(b&&!v.columns&&B<b){const G=b-B;F+=G,a.createCol(B,G,{source:"auto"})}if(D&&!v.columns&&o.dataType==="array"&&F<D){B=o.countCols();const G=D-F,y=Math.min(G,v.maxCols-B);a.createCol(B,y,{source:"auto"})}}},populateFromArray(m,p,b,D,F){let B,G,y,R;const E=[],_={},O=[],L=m.row,W=m.col;if(G=p.length,G===0)return!1;let H=0,$=0;switch(Ae(b)&&(H=b.col-W+1,$=b.row-L+1),F){case"shift_down":const V=rm(p),j=V.length,z=Math.max(j,H),oe=o.getData().slice(L),ae=rm(oe).slice(W,W+z);for(y=0;y<z;y+=1)if(y<j){for(B=0,G=V[y].length;B<$-G;B+=1)V[y].push(V[y][B%G]);y<ae.length?O.push(V[y].concat(ae[y])):O.push(V[y].concat(new Array(oe.length).fill(null)))}else O.push(V[y%j].concat(ae[y]));o.populateFromArray(L,W,rm(O));break;case"shift_right":const Se=p.length,Fe=Math.max(Se,$),Ve=o.getData().slice(L).map(Ct=>Ct.slice(W));for(B=0;B<Fe;B+=1)if(B<Se){for(y=0,R=p[B].length;y<H-R;y+=1)p[B].push(p[B][y%R]);if(B<Ve.length)for(let Ct=0;Ct<Ve[B].length;Ct+=1)p[B].push(Ve[B][Ct]);else p[B].push(...new Array(Ve[0].length).fill(null))}else p.push(p[B%G].slice(0,Fe).concat(Ve[B]));o.populateFromArray(L,W,p);break;case"overwrite":default:_.row=m.row,_.col=m.col;let Re=0,be=0,et=!0,Jn;const _o=function(Et){let mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ze=p[Et%p.length];return mt!==null?Ze[mt%Ze.length]:Ze},ci=p.length,ln=b?b.row-m.row+1:0;for(b?G=ln:G=Math.max(ci,ln),B=0;B<G&&!(b&&_.row>b.row&&ln>ci||!v.allowInsertRow&&_.row>o.countRows()-1||_.row>=v.maxRows);B++){const Ct=B-Re,Et=_o(Ct).length,mt=b?b.col-m.col+1:0;if(b?R=mt:R=Math.max(Et,mt),_.col=m.col,Jn=o.getCellMeta(_.row,_.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&Jn.skipRowOnPaste){Re+=1,_.row+=1,G+=1;continue}for(be=0,y=0;y<R&&!(b&&_.col>b.col&&mt>Et||!v.allowInsertColumn&&_.col>o.countCols()-1||_.col>=v.maxCols);y++){if(Jn=o.getCellMeta(_.row,_.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&Jn.skipColumnOnPaste){be+=1,_.col+=1,R+=1;continue}if(Jn.readOnly&&D!=="UndoRedo.undo"){_.col+=1;continue}const Ze=y-be;let kr=_o(Ct,Ze),Ln=o.getDataAtCell(_.row,_.col);if(kr!==null&&typeof kr=="object")if(Array.isArray(kr)&&Ln===null&&(Ln=[]),Ln===null||typeof Ln!="object")et=!1;else{const fa=wd(Array.isArray(Ln)?Ln:Ln[0]||Ln),cf=wd(Array.isArray(kr)?kr:kr[0]||kr);OE(fa,cf)||Array.isArray(fa)&&Array.isArray(cf)?kr=Xn(kr):et=!1}else Ln!==null&&typeof Ln=="object"&&(et=!1);et&&E.push([_.row,_.col,kr]),et=!0,_.col+=1}_.row+=1}o.setDataAtCell(E,null,null,D||"populateFromArray");break}}};function X(m){const p=RL(m);PT(p)?(o.runHooks("beforeLanguageChange",p),T.language=p,o.runHooks("afterLanguageChange",p)):EL(m)}function se(m,p){const b=m==="className"?o.rootElement:o.table;if(f)q(b,p);else{let D=[],F=[];T[m]&&(D=Array.isArray(T[m])?T[m]:WO(T[m])),p&&(F=Array.isArray(p)?p:WO(p));const B=VO(D,F),G=VO(F,D);B.length&&we(b,B),G.length&&q(b,G)}T[m]=p}this.init=function(){l.setData(v.data),o.runHooks("beforeInit"),(po()||Rk())&&q(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new s6(this);const m=v.themeName||j1(o.rootContainer);o.useTheme(m),c=KS.getInstance(o,v,N),d=p7(o),h=new NK(o),Pu(this)&&a7(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&eK(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function ee(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function te(m){const p=m.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):m}function Le(m,p,b){if(!m.length){b();return}const D=o.getActiveEditor(),F=new ee;let B=!0;F.onQueueEmpty=()=>{D&&B&&D.cancelChanges(),b()};for(let G=m.length-1;G>=0;G--){const[y,R]=m[G],E=a.propToCol(R);let _;Number.isInteger(E)?_=o.getCellMeta(y,E):_={...Object.getPrototypeOf(v),...v},o.getCellValidator(_)&&(F.addValidatorToQueue(),o.validateCell(m[G][3],_,function(O,L){return function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&L.allowInvalid===!1&&(B=!1,m.splice(O,1),L.valid=!0),F.removeValidatorFormQueue()}}(G,_),p))}F.checkIfQueueIsEmpty()}function Ne(m,p){for(let D=m.length-1;D>=0;D--){let F=!1;if(m[D]===null){m.splice(D,1);continue}if(!((m[D][2]===null||m[D][2]===void 0)&&(m[D][3]===null||m[D][3]===void 0))){if(v.allowInsertRow)for(;m[D][0]>o.countRows()-1;){const{delta:B}=a.createRow(void 0,void 0,{source:"auto"});if(B===0){F=!0;break}}if(o.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;a.propToCol(m[D][1])>o.countCols()-1;){const{delta:B}=a.createCol(void 0,void 0,{source:"auto"});if(B===0){F=!0;break}}F||a.set(m[D][0],m[D][1],m[D][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,p),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,p||"edit");const D=o.getActiveEditor();D&&le(D.refreshValue)&&D.refreshValue()}else o.render()}this._createCellCoords=function(m,p){return o.view._wt.createCellCoords(m,p)},this._createCellRange=function(m,p,b){return o.view._wt.createCellRange(m,p,b)},this.validateCell=function(m,p,b,D){let F=o.getCellValidator(p);function B(G){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||p.hidden===!0){b(G);return}const R=p.visualCol,E=p.visualRow,_=o.getCell(E,R,!0);if(_&&_.nodeName!=="TH"){const O=o.rowIndexMapper.getRenderableFromVisualIndex(E),L=o.columnIndexMapper.getRenderableFromVisualIndex(R);o.view._wt.getSetting("cellRenderer",O,L,_)}b(G)}iq(F)&&(F=function(G){return function(y,R){R(G.test(y))}}(F)),ot(F)?(m=o.runHooks("beforeValidate",m,p.visualRow,p.prop,D),o._registerImmediate(()=>{F.call(p,m,G=>{o&&(G=o.runHooks("afterValidate",G,m,p.visualRow,p.prop,D),p.valid=G,B(G),o.runHooks("postAfterValidate",G,m,p.visualRow,p.prop,D))})})):o._registerImmediate(()=>{p.valid=!0,B(p.valid,!1)})};function $e(m,p,b){return Array.isArray(m)?m:[[m,p,b]]}function vt(m,p){const b=o.runHooks("beforeChange",m,p||"edit"),D=m.filter(B=>B!==null);if(b===!1||D.length===0){var F;return(F=o.getActiveEditor())===null||F===void 0||F.cancelChanges(),[]}for(let B=D.length-1;B>=0;B--){const[G,y,,R]=D[B],E=a.propToCol(y);let _;Number.isInteger(E)?_=o.getCellMeta(G,E):_={...Object.getPrototypeOf(v),...v};const{type:O,checkedTemplate:L,uncheckedTemplate:W}=_;if(O==="numeric"&&typeof R=="string"&&qK(R)&&(D[B][3]=te(R)),O==="checkbox"){const H=It(R),$=H===It(L),V=H===It(W);($||V)&&(D[B][3]=$?L:W)}}return D}this.setDataAtCell=function(m,p,b,D){const F=$e(m,p,b),B=[];let G=D,y,R,E;for(y=0,R=F.length;y<R;y++){if(typeof F[y]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof F[y][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");F[y][1]>=this.countCols()?E=F[y][1]:E=a.colToProp(F[y][1]),B.push([F[y][0],E,l.getAtCell(this.toPhysicalRow(F[y][0]),F[y][1]),F[y][2]])}!G&&typeof m=="object"&&(G=p);const _=vt(B,G);o.runHooks("afterSetDataAtCell",_,G),Le(_,G,()=>{Ne(_,G)})},this.setDataAtRowProp=function(m,p,b,D){const F=$e(m,p,b),B=[];let G=D,y,R;for(y=0,R=F.length;y<R;y++)B.push([F[y][0],F[y][1],l.getAtCell(this.toPhysicalRow(F[y][0]),F[y][1]),F[y][2]]);!G&&typeof m=="object"&&(G=p);const E=vt(B,D);o.runHooks("afterSetDataAtRowProp",E,G),Le(E,G,()=>{Ne(E,G)})},this.listen=function(){o&&!o.isListening()&&(Qy.forEach(m=>{o!==m&&m.unlisten()}),Jy=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Jy=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return Jy===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),p&&N.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,p,b,D,F,B,G){if(!(typeof b=="object"&&typeof b[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const y=typeof D=="number"?o._createCellCoords(D,F):null;return u.populateFromArray(o._createCellCoords(m,p),b,y,B,G)},this.spliceCol=function(m,p,b){for(var D=arguments.length,F=new Array(D>3?D-3:0),B=3;B<D;B++)F[B-3]=arguments[B];return a.spliceCol(m,p,b,...F)},this.spliceRow=function(m,p,b){for(var D=arguments.length,F=new Array(D>3?D-3:0),B=3;B<D;B++)F[B-3]=arguments[B];return a.spliceRow(m,p,b,...F)},this.getSelected=function(){if(N.isSelected())return We(N.getSelectedRange(),m=>{let{from:p,to:b}=m;return[p.row,p.col,b.row,b.col]})},this.getSelectedLast=function(){const m=this.getSelected();let p;return m&&m.length>0&&(p=m[m.length-1]),p},this.getSelectedRange=function(){if(N.isSelected())return Array.from(N.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let p;return m&&m.length>0&&(p=m[m.length-1]),p},this.emptySelectedCells=function(m){if(!N.isSelected()||this.countRows()===0||this.countCols()===0)return;const p=[];A(N.getSelectedRange(),b=>{if(b.isSingleHeader())return;const D=b.getTopStartCorner(),F=b.getBottomEndCorner();he(D.row,F.row,B=>{he(D.col,F.col,G=>{this.getCellMeta(B,G).readOnly||p.push([B,G,null])})})}),p.length>0&&this.setDataAtCell(p,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const p=m();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const b=m();return this.resumeExecution(p),b},this.batch=function(m){this.suspendRender(),this.suspendExecution();const p=m();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:p,height:b}=m.getLastSize(),{width:D,height:F}=o.rootElement.getBoundingClientRect(),B=D!==p||F!==b;o.runHooks("beforeRefreshDimensions",{width:p,height:b},{width:D,height:F},B)!==!1&&((B||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(D,F),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:p,height:b},{width:D,height:F},B))},this.updateData=function(m,p){L1(m,b=>{a=b},b=>{a=b,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),N.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:p,metaManager:S,firstRun:f})},this.loadData=function(m,p){L1(m,b=>{a=b},()=>{S.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),N.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:p,metaManager:S,firstRun:f})},this.getInitialColumnCount=function(){const m=v.columns;let p=0;if(Array.isArray(m))p=m.length;else if(ot(m))if(o.dataType==="array"){const b=this.countSourceCols();for(let D=0;D<b;D+=1)m(D)&&(p+=1)}else(o.dataType==="object"||o.dataType==="function")&&(p=a.colToPropCache.length);else if(le(v.dataSchema)){const b=a.getSchema();p=Array.isArray(b)?b.length:xE(b)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,p,b,D){return Mt(m)?a.getAll():a.getRange(o._createCellCoords(m,p),o._createCellCoords(b,D),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,p,b,D){return a.getCopyableText(o._createCellCoords(m,p),o._createCellCoords(b,D))},this.getCopyableData=function(m,p){return a.getCopyable(m,a.colToProp(p))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=(f?o.loadData:o.updateData).bind(this);let D=!1,F,B;if(le(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&X(m.language);for(F in m)if(!(F==="data"||F==="language"))if(F==="className")se("className",m.className);else if(F==="tableClassName"&&o.table)se("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(re.getSingleton().isRegistered(F)||re.getSingleton().isDeprecated(F)){const _=m[F];ot(_)?(re.getSingleton().addAsFixed(F,_,o),v[F]=_):Array.isArray(_)&&(re.getSingleton().add(F,_,o),v[F]=_)}else!p&&Qt(m,F)&&(T[F]=m[F]);m.data===void 0&&v.data===void 0?b(null,"updateSettings"):m.data!==void 0?b(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const G=o.countCols(),y=v.columns;if(y&&ot(y)&&(D=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&S.clearCache(),G>0)for(F=0,B=0;F<G;F++){if(y){const _=D?y(F):y[B];_&&S.updateColumnMeta(B,_)}B+=1}le(m.cell)&&He(m.cell,_=>{o.setCellMetaObject(_.row,_.col,_)}),o.runHooks("afterCellMetaReset");let R=o.rootElement.style.height;R!==""&&(R=parseInt(o.rootElement.style.height,10));let E=m.height;if(ot(E)&&(E=E()),p&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),E===null){const _=o.rootElement.getAttribute("data-initialstyle");_&&(_.indexOf("height")>-1||_.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",_):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else E!==void 0&&(o.rootElement.style.height=isNaN(E)?`${E}`:`${E}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let _=m.width;ot(_)&&(_=_()),o.rootElement.style.width=isNaN(_)?`${_}`:`${_}px`}if(!p){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const _=o.getCurrentThemeName();Qt(m,"themeName")&&_!==m.themeName&&o.useTheme(m.themeName)}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!p&&o.view&&(R===""||E===""||E===void 0)&&R!==E&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(v.getValue){if(ot(v.getValue))return v.getValue.call(o);if(m)return o.getData()[m[0][0]][v.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,p,b,D,F){u.alter(m,p,b,D,F)},this.getCell=function(m,p){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,D=p,F=m;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;D=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;F=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return F===null||D===null||F===void 0||D===void 0?null:o.view.getCellAtCoords(o._createCellCoords(F,D),b)},this.getCoords=function(m){const p=this.view._wt.wtTable.getCoords(m);if(p===null)return null;const{row:b,col:D}=p;let F=b,B=D;return b>=0&&(F=this.rowIndexMapper.getVisualFromRenderableIndex(b)),D>=0&&(B=this.columnIndexMapper.getVisualFromRenderableIndex(D)),o._createCellCoords(F,B)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,p){return a.get(m,a.colToProp(p))},this.getDataAtRowProp=function(m,p){return a.get(m,p)},this.getDataAtCol=function(m){const p=[],b=a.getRange(o._createCellCoords(0,m),o._createCellCoords(v.data.length-1,m),a.DESTINATION_RENDERER);for(let D=0;D<b.length;D+=1)for(let F=0;F<b[D].length;F+=1)p.push(b[D][F]);return p},this.getDataAtProp=function(m){const p=[],b=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(v.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let D=0;D<b.length;D+=1)for(let F=0;F<b[D].length;F+=1)p.push(b[D][F]);return p},this.getSourceData=function(m,p,b,D){let F;return m===void 0?F=l.getData():F=l.getByRange(o._createCellCoords(m,p),o._createCellCoords(b,D)),F},this.getSourceDataArray=function(m,p,b,D){let F;return m===void 0?F=l.getData(!0):F=l.getByRange(o._createCellCoords(m,p),o._createCellCoords(b,D),!0),F},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,p,b,D){const F=$e(m,p,b),B=this.hasHook("afterSetSourceDataAtCell"),G=[];B&&A(F,R=>{let[E,_,O]=R;G.push([E,_,l.getAtCell(E,_),O])}),A(F,R=>{let[E,_,O]=R;l.setAtCell(E,_,O)}),B&&this.runHooks("afterSetSourceDataAtCell",G,D),this.render();const y=o.getActiveEditor();y&&le(y.refreshValue)&&y.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,p){return l.getAtCell(m,p)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,p,b,D){const F=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,p,b,D],[B,G]=F;let[,,y,R]=F,E=null,_=null;y===void 0&&(y=B),R===void 0&&(R=G);let O="mixed";return he(Math.max(Math.min(B,y),0),Math.max(B,y),L=>{let W=!0;return he(Math.max(Math.min(G,R),0),Math.max(G,R),H=>(_=this.getCellMeta(L,H).type,E?W=E===_:E=_,W)),O=W?_:"mixed",W}),O},this.removeCellMeta=function(m,p,b){const[D,F]=[this.toPhysicalRow(m),this.toPhysicalColumn(p)];let B=S.getCellMetaKeyValue(D,F,b);o.runHooks("beforeRemoveCellMeta",m,p,b,B)!==!1&&(S.removeCellMeta(D,F,b),o.runHooks("afterRemoveCellMeta",m,p,b,B)),B=null},this.spliceCellsMeta=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var b=arguments.length,D=new Array(b>2?b-2:0),F=2;F<b;F++)D[F-2]=arguments[F];if(D.length>0&&!Array.isArray(D[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");p>0&&S.removeRow(this.toPhysicalRow(m),p),D.length>0&&A(D.reverse(),B=>{S.createRow(this.toPhysicalRow(m)),A(B,(G,y)=>this.setCellMetaObject(m,y,G))}),o.render()},this.setCellMetaObject=function(m,p,b){typeof b=="object"&&He(b,(D,F)=>{this.setCellMeta(m,p,F,D)})},this.setCellMeta=function(m,p,b,D){if(o.runHooks("beforeSetCellMeta",m,p,b,D)===!1)return;let B=m,G=p;m<this.countRows()&&(B=this.toPhysicalRow(m)),p<this.countCols()&&(G=this.toPhysicalColumn(p)),S.setCellMeta(B,G,b,D),o.runHooks("afterSetCellMeta",m,p,b,D)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(m,p){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},D=this.toPhysicalRow(m),F=this.toPhysicalColumn(p);return D===null&&(D=m),F===null&&(F=p),S.getCellMeta(D,F,{visualRow:m,visualColumn:p,...b})},this.getColumnMeta=function(m){return S.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return S.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||v.columns)},this.getCellRenderer=function(m,p){const b=typeof m=="number"?o.getCellMeta(m,p).renderer:m.renderer;return typeof b=="string"?xx(b):Mt(b)?xx("text"):b},this.getCellEditor=function(m,p){const b=typeof m=="number"?o.getCellMeta(m,p).editor:m.editor;return typeof b=="string"?dx(b):Mt(b)?dx("text"):b},this.getCellValidator=function(m,p){const b=typeof m=="number"?o.getCellMeta(m,p).validator:m.validator;return typeof b=="string"?h3(b):b},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,p){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,m)},this.validateColumns=function(m,p){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,m)},this._validateCells=function(m,p,b){const D=new ee;m&&(D.onQueueEmpty=m);let F=o.countRows()-1;for(;F>=0;){if(p!==void 0&&p.indexOf(F)===-1){F-=1;continue}let B=o.countCols()-1;for(;B>=0;){if(b!==void 0&&b.indexOf(B)===-1){B-=1;continue}D.addValidatorToQueue(),o.validateCell(o.getDataAtCell(F,B),o.getCellMeta(F,B),G=>{if(typeof G!="boolean")throw new Error("Validation error: result is not boolean");G===!1&&(D.valid=!1),D.removeValidatorFormQueue()},"validateCells"),B-=1}F-=1}D.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let p=v.rowHeaders,b=m;return b!==void 0&&(b=o.runHooks("modifyRowHeader",b)),b===void 0?(p=[],he(o.countRows()-1,D=>{p.push(o.getRowHeader(D))})):Array.isArray(p)&&p[b]!==void 0?p=p[b]:ot(p)?p=p(b):p&&typeof p!="string"&&typeof p!="number"&&(p=b+1),p},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let m=0,p=o.countCols();m<p;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const b=o.runHooks("modifyColHeader",m);if(b===void 0){const y=[],R=o.countCols();for(let E=0;E<R;E++)y.push(o.getColHeader(E));return y}let D=v.colHeaders;const F=function(y){const R=[],E=o.countCols();let _=0;for(;_<E;_++)ot(v.columns)&&v.columns(_)&&R.push(_);return R[y]},B=o.toPhysicalColumn(b),G=F(B);return v.colHeaders===!1?D=null:v.columns&&ot(v.columns)&&v.columns(G)&&v.columns(G).title?D=v.columns(G).title:v.columns&&v.columns[B]&&v.columns[B].title?D=v.columns[B].title:Array.isArray(v.colHeaders)&&v.colHeaders[B]!==void 0?D=v.colHeaders[B]:ot(v.colHeaders)?D=v.colHeaders(B):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(D=d6(b)),D=o.runHooks("modifyColumnHeaderValue",D,m,p),D},this._getColWidthFromSettings=function(m){let p;if(m>=0&&(p=o.getCellMeta(0,m).width),(p===void 0||p===v.width)&&(p=v.colWidths),p!=null){switch(typeof p){case"object":p=p[m];break;case"function":p=p(m);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(m,p){let b=o._getColWidthFromSettings(m);return b=o.runHooks("modifyColWidth",b,m,p),b===void 0&&(b=ic),b},this._getRowHeightFromSettings=function(m){const p=o.stylesHandler.getDefaultRowHeight();let b=v.rowHeights;if(b!=null){switch(typeof b){case"object":b=b[m];break;case"function":b=b(m);break}typeof b=="string"&&(b=parseInt(b,10))}return b!=null&&b<p?p:b},this.getRowHeight=function(m,p){let b=o._getRowHeightFromSettings(m);return b=o.runHooks("modifyRowHeight",b,m,p),b},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=v.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,p)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return Px(o.countRows()-1,b=>{if(o.isEmptyRow(b))p+=1;else if(m===!0)return!1}),p},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return Px(o.countCols()-1,b=>{if(o.isEmptyCol(b))p+=1;else if(m===!0)return!1}),p},this.isEmptyRow=function(m){return v.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return v.isEmptyCol.call(o,m)},this.selectCell=function(m,p,b,D){let F=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Mt(m)||Mt(p)?!1:this.selectCells([[m,p,b,D]],F,B)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&d.suspend();const D=N.selectCells(m);return D&&b&&o.listen(),d.resume(),D},this.selectColumns=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,b=arguments.length>2?arguments[2]:void 0;return N.selectColumns(m,p,b)},this.selectRows=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,b=arguments.length>2?arguments[2]:void 0;return N.selectRows(m,p,b)},this.deselectCell=function(){N.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,b=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),N.selectAll(m,p,b)};const rt=(m,p)=>m.getNearestNotHiddenIndex(p,1,!0);this.scrollViewportTo=function(m,p){if(typeof m=="number"){var b;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(b=arguments[4])!==null&&b!==void 0?b:!0}}const{row:D,col:F,considerHiddenIndexes:B}=m??{};let G=D,y=F;if(ot(p)&&this.addHookOnce("afterScroll",p),B===void 0||B){const O=Number.isInteger(D)&&D>=0,L=Number.isInteger(F)&&F>=0,W=O?rt(this.rowIndexMapper,D):void 0,H=L?rt(this.columnIndexMapper,F):void 0;if(W===null||H===null)return!1;G=O?o.rowIndexMapper.getRenderableFromVisualIndex(W):D,y=L?o.columnIndexMapper.getRenderableFromVisualIndex(H):F}const R=Number.isInteger(G),E=Number.isInteger(y);let _=!1;return R&&G>=0&&E&&y>=0?_=o.view.scrollViewport(o._createCellCoords(G,y),m.horizontalSnap,m.verticalSnap):R&&G>=0&&(E&&y<0||!E)?_=o.view.scrollViewportVertically(G,m.verticalSnap):E&&y>=0&&(R&&G<0||!R)&&(_=o.view.scrollViewportHorizontally(y,m.horizontalSnap)),ot(p)&&(_?this.view.render():(this.removeHook("afterScroll",p),this._registerMicrotask(()=>p()))),_},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;ot(m)&&this.addHookOnce("afterScroll",m);const{highlight:p}=this.getSelectedRangeLast(),b=this.scrollViewportTo(p.toObject());return b?this.view.render():ot(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),b},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),x.clear(),S.clearCache(),Qy.delete(this.guid),s.destroy(),c&&c.destroy(),o.rootContainer&&us(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),M.getItems().forEach(m=>{let[,p]=m;p.destroy()}),M.clear(),o.runHooks("afterDestroy")},!0),re.getSingleton().destroy(o),He(o,(m,p,b)=>{ot(m)?b[p]=at(p):p!=="guid"&&(b[p]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,N=null,c=null,o=null};function at(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return M.getItem(Ni(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:M.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,p,b){re.getSingleton().add(m,p,o,b)},this.hasHook=function(m){return re.getSingleton().has(m,o)||re.getSingleton().has(m)},this.addHookOnce=function(m,p,b){re.getSingleton().once(m,p,o,b)},this.removeHook=function(m,p){re.getSingleton().remove(m,p,o)},this.runHooks=function(m,p,b,D,F,B,G){return re.getSingleton().run(o,m,p,b,D,F,B,G)},this.getTranslatedPhrase=function(m,p){return OL(v.language,m,p)},this.toHTML=()=>Mx(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",Mx(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{const p=!!f;this.stylesHandler.useTheme(m);const b=this.stylesHandler.getThemeName();Pu(this)&&(we(this.rootWrapperElement,/ht-theme-.*/g),we(this.rootPortalElement,/ht-theme-.*/g),b&&(q(this.rootWrapperElement,b),q(this.rootPortalElement,b),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Ke(`The "${b}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),p||(o.render(),o.scrollViewportTo(0,0),j1(this.rootContainer)&&(we(this.rootContainer,/ht-theme-.*/g),b&&q(this.rootContainer,b))),this.runHooks("afterSetTheme",b,p)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=m;typeof b=="function"&&(b=setTimeout(b,p)),this.timeouts.push(b)},this._clearTimeouts=function(){A(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){A(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const gn=S7({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&gn.releasePressedKeys()}),this.getShortcutManager=function(){return gn},this.getFocusManager=function(){return h},Kk().forEach(m=>{const p=FE(m);M.addItem(m,new p(this))}),o7(o),gn.setActiveContextName("grid"),re.getSingleton().run(o,"construct")}function X1(t,e,n){t.addEventListener(e,n,!1)}function Z1(t,e,n){t.removeEventListener(e,n,!1)}function Gf(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function qL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Gf(s).fontSize,o.style.fontFamily=Gf(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=Gf(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=Gf(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),w=o.clientWidth+f+g+1;r.removeChild(o);const C=s.style;C.height=`${n.minHeight}px`,n.minWidth>w?C.width=`${n.minWidth}px`:w>n.maxWidth?C.width=`${n.maxWidth}px`:C.width=`${w}px`;const S=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>S?C.height=`${n.minHeight}px`:n.maxHeight<S?(C.height=`${n.maxHeight}px`,C.overflowY="visible"):C.height=`${S}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(X1(s,"input",a),X1(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){Z1(s,"input",a),Z1(s,"keydown",l)}}}function J1(t,e){const n=Ok(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Up(e,i)}function Ta(t,e,n){return(e=x7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x7(t){var e=A7(t,"string");return typeof e=="symbol"?e:e+""}function A7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const H7="ht_editor_visible",qf="ht_editor_hidden",Q1="textEditor",N7="text";class kl extends Rc{static get EDITOR_TYPE(){return N7}constructor(e){super(e),Ta(this,"eventManager",new Di(this)),Ta(this,"autoResize",qL(this.hot.rootDocument)),Ta(this,"TEXTAREA",void 0),Ta(this,"textareaStyle",void 0),Ta(this,"TEXTAREA_PARENT",void 0),Ta(this,"textareaParentStyle",void 0),Ta(this,"layerClass",void 0),this.eventManager=new Di(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),im(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Ft.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Ft.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Up(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ce(this.TEXTAREA,[["data-hot-input",""],ua(-1)]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),ye(this.TEXTAREA_PARENT,this.layerClass)&&we(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,qf),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){jq()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",we(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,qf)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;he(e.length-1,r=>{const i=e[r];if(ye(i,"handsontableEditor"))return n=!0,!1}),ye(this.TEXTAREA_PARENT,qf)&&we(this.TEXTAREA_PARENT,qf),n?(this.layerClass=H7,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Ft.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){Sk()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Ft.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Ft.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:Q1},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;J1(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;J1(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Q1)}}const D7="base",k7="htTextEllipsis";function Qd(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(GO())):a&&c.push(GO()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(qO())):(u.push(s.invalidCellClassName),a&&c.push(qO()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(k7),we(e,u),q(e,l),yc(e,c),Ce(e,h)}Qd.RENDERER_TYPE=D7;const L7="text";function ws(t,e,n,r,i,o,s){Qd.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=It(a),s.trimWhitespace&&(a=a.trim()),Cl(e,a)}ws.RENDERER_TYPE=L7;const $7="text",KL={CELL_TYPE:$7,editor:kl,renderer:ws};Ci(KL);Nr.editors={BaseEditor:Rc};function Nr(t,e){const n=new GL(t,e||{},t0);return n.init(),n}Nr.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new GL(t,e,t0)};Nr.DefaultSettings=LL();Nr.hooks=re.getSingleton();Nr.CellCoords=bl;Nr.CellRange=Kd;Nr.packageName="handsontable";Nr.buildDate="10/07/2025 10:59:01";Nr.version="16.0.1";Nr.languages={dictionaryKeys:G6,getLanguageDictionary:PL,getLanguagesDictionaries:J6,registerLanguageDictionary:IL,getTranslatedPhrase:OL};function F7(t,e,n){return(e=B7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function V7(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?eA(Object(n),!0).forEach(function(r){F7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):eA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function W7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B7(t){var e=W7(t,"string");return typeof e=="symbol"?e:e+""}function qh(t){"@babel/helpers - typeof";return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qh(t)}var Gu=Symbol("unassigned"),j7="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function Vm(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function XL(t){var e=Nr.hooks.getRegistered(),n={};Object.assign(n,Nr.DefaultSettings);for(var r in n)n[r]={default:Gu};for(var i=0;i<e.length;i++)n[e[i]]={default:Gu};return n.settings={default:Gu},t==="HotTable"&&(n.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),n}function ZL(t){var e={},n=t.settings;if(n!==Gu)for(var r in n)Vm(n,r)&&n[r]!==Gu&&(e[r]=n[r]);for(var i in t)Vm(t,i)&&i!=="settings"&&t[i]!==Gu&&(e[i]=t[i]);return e}function tA(t,e){var n=ZL(t),r=t.settings?t.settings:n,i=t.settings?n:null,o={};for(var s in r)Vm(r,s)&&r[s]!==void 0&&(!(e&&s!=="data")||!nA(e[s],r[s]))&&(o[s]=r[s]);for(var a in i)Vm(i,a)&&a!=="id"&&a!=="settings"&&i[a]!==void 0&&(!(e&&a!=="data")||!nA(e[a],i[a]))&&(o[a]=i[a]);return o}function nA(t,e){var n=function(i){var o=function(){var s=new WeakSet;return function(a,l){if(qh(l)==="object"&&l!==null){if(s.has(l))return;s.add(l)}return l}}();return JSON.stringify(i,o)};return typeof t=="function"&&typeof e=="function"?t.toString()===e.toString():qh(t)!==qh(e)?!1:n(t)===n(e)}var U7="16.0.1",HT=ki({name:"HotTable",props:XL("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var n=tA(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||n===void 0||(n.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete n.data),Object.keys(n).length?this.hotInstance.updateSettings(n):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(j7),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=tA(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=qV(new Nr.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var n=this.hotInstance.getSourceData(),r=[],i=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==o&&n.length<o)for(var l=n.length;l<o;l++)r.push(l);if(s){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&((u=n[0])===null||u===void 0?void 0:u.length)!==a&&n[0].length<a)for(var c=n[0].length;c<a;c++)i.push(c)}this.hotInstance.batch(function(){r.length>0?e.hotInstance.rowIndexMapper.removeIndexes(r):e.hotInstance.rowIndexMapper.insertIndexes(o-1,n.length-o),s&&n.length!==0&&(i.length>0?e.hotInstance.columnIndexMapper.removeIndexes(i):e.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:U7}),z7=["id"];function Y7(t,e,n,r,i,o){return Dn(),wo("div",{id:t.id},[Nn(t.$slots,"default")],8,z7)}HT.render=Y7;HT.__file="src/HotTable.vue";var G7=ki({name:"HotColumn",props:XL("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=ZL(this.$props),n=V7({},e);e.renderer&&(n.renderer=e.renderer),e.editor&&(n.editor=e.editor),this.columnsCache.set(this,n)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});G7.__file="src/HotColumn.vue";function rA(t,e,n){return(e=q7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q7(t){var e=K7(t,"string");return typeof e=="symbol"?e:e+""}function K7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const iA="handsontableEditor",X7="handsontable";class NT extends kl{constructor(){super(...arguments),rA(this,"isFlippedVertically",!1),rA(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return X7}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Up(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&nn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getDropdownHeight(),o=e.getWorkspaceHeight()-r-n.height,s=i>o&&r>o+n.height;return s?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:s,spaceAbove:r,spaceBelow:o}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;r=Math.max(r+a,0)}const i=this.getDropdownWidth(),o=e.getWorkspaceWidth()-r+n.width,s=i>o&&r>o;return s?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:s,spaceInlineStart:r,spaceInlineEnd:o}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:iA,relativeToGroup:da,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||this.isFlippedVertically&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Fi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&this.isFlippedVertically?a=s.countRows()-1:s.getSelectedLast()&&(this.isFlippedVertically?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!this.isFlippedVertically)a=0;else if(s.getSelectedLast()){if(this.isFlippedVertically)a=s.getSelectedLast()[0]+1;else if(!this.isFlippedVertically){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(iA)}}function Z7(t,e){JL(t,e),e.add(t)}function oA(t,e,n){JL(t,e),e.set(t,n)}function JL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kf(t,e,n){return(e=J7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J7(t){var e=Q7(t,"string");return typeof e=="symbol"?e:e+""}function Q7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eb(t,e){return t.get(aR(t,e))}function aR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const e5="autocomplete";var tb=new WeakMap,sA=new WeakMap,nb=new WeakSet;class DT extends NT{constructor(){super(...arguments),Z7(this,nb),Kf(this,"query",null),Kf(this,"strippedChoices",[]),Kf(this,"rawChoices",[]),oA(this,tb,this.hot.guid.slice(0,9)),oA(this,sA,Yp(()=>{this.focus()},100)),Kf(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=YO(It(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return e5}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[Sq(),wq(),pk("listbox"),_q()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[ti("false"),Mq(`${eb(tb,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r?.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",eb(sA,this)),this.htEditor.updateSettings({colWidths:e?[Yt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{ws(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:w,locale:C}=this.cellProperties,S=this.query;let v=It(d),T,M;v&&!w&&(T=g===!0?v.indexOf(S):v.toLocaleLowerCase(C).indexOf(S.toLocaleLowerCase(C)),T!==-1&&(M=v.substr(T,S.length),v=v.replace(M,`<strong>${M}</strong>`))),n&&Ce(l,[vq(),...r?[xq(i)]:[],...r?[Aq(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=v},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{Ce(h,[PE()]),Ce(this.TEXTAREA,...Iq(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(Ce(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...es()),Ce(this.htEditor.rootElement,[mk(),Pq("polite"),Oq("text"),["id",`${eb(tb,this)}-listbox-${o}-${s}`]]),Ce(this.TEXTAREA,...ti("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[ti("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=Ok(this.TEXTAREA),r=Jq(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(rm([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Up(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:r,spaceBelow:i}=e;return this.limitDropdownIfNeeded(n?r:i),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let r=0,i=0,o=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),r+=i;while(r<e);o=r-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(r-i)}}updateDropdownDimensions(){const e=xk(),n=this.getTargetEditorWidth()+e,r=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:r}),aR(nb,this,aA).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),aR(nb,this,aA).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(i,o)=>o).reduce((i,o)=>{const s=this.hot.stylesHandler.getDefaultRowHeight()+(o===0?1:0);return i+s},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=We(e,o=>It(o));return We(r,o=>n?o:YO(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===ge.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===ge.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(iK(e.keyCode)||e.keyCode===ge.BACKSPACE||e.keyCode===ge.DELETE||e.keyCode===ge.INSERT){let n=10;if(e.keyCode===ge.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function aA(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+Cn(this.hot.rootDocument)})}const t5="checkbox";class QL extends Rc{static get EDITOR_TYPE(){return t5}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');ye(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const qs=()=>window,Xr=()=>window.document,lR=(t,e)=>window.setTimeout(t,e),ro=function(t,e,n,r){t.addEventListener(e,n,!!r)},ko=function(t,e,n,r){t.removeEventListener(e,n,!!r)},n5=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Rr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},rb=function(t,e){Rr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},ib=function(t,e){t.className=n5((" "+t.className+" ").replace(" "+e+" "," "))},kT=function(t){return/Array/.test(Object.prototype.toString.call(t))},Ir=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},r5=function(t){let e=t.getDay();return e===0||e===6},i5=function(t){return t%4===0&&t%100!==0||t%400===0},lA=function(t,e){return[31,i5(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Xf=function(t){Ir(t)&&t.setHours(0,0,0,0)},Zf=function(t,e){return t.getTime()===e.getTime()},Wm=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Ir(e[r])?n&&(t[r]=new Date(e[r].getTime())):kT(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Wm({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},uA=function(t,e,n){let r=Xr().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Wm(r,n),t.dispatchEvent(r)},cA=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Yi={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},hA=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},o5=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},s5=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},a5=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():s5(o,i))+"</td>"},l5=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},u5=function(t){return"<tbody>"+t.join("")+"</tbody>"},c5=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+hA(t,e)+'">'+hA(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},h5=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,w=!0,C=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",kT(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(w=!1),h&&(r===11||u.maxMonth<=r)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(w?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},d5=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+c5(t)+u5(e)+"</table>"};function uR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||qs().event;let o=i.target||i.srcElement;if(o)if(Rr(o,"is-disabled")||(Rr(o,"pika-button")&&!Rr(o,"is-empty")&&!Rr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&lR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Rr(o,"pika-prev")?e.prevMonth():Rr(o,"pika-next")&&e.nextMonth()),Rr(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||qs().event;let o=i.target||i.srcElement;o&&(Rr(o,"pika-select-month")?e.gotoMonth(o.value):Rr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||qs().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Ir(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Xr().activeElement;do if(Rr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=lR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||qs().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Rr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),ro(o,"change",e._onChange)));do if(Rr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Xr().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),ro(e.el,"mousedown",e._onMouseDown,!0),ro(e.el,"touchend",e._onMouseDown,!0),ro(e.el,"change",e._onChange),n.keyboardInput&&ro(Xr(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Xr().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),ro(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Ir(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",ro(n.trigger,"click",e._onInputClick),ro(n.trigger,"focus",e._onInputFocus),ro(n.trigger,"blur",e._onInputBlur)):this.show()}uR.prototype={config:function(t){this._o||(this._o=Wm({},Yi,!0));let e=Wm(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Ir(e.minDate)||(e.minDate=!1),Ir(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),kT(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Yi.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Ir(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Ir(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",uA(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Ir(t))return;let n=this._o.minDate,r=this._o.maxDate;Ir(n)&&t<n?t=n:Ir(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Xf(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),uA(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Ir(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=cA(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=cA({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Xf(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Yi.minDate,this._o.minYear=Yi.minYear,this._o.minMonth=Yi.minMonth,this._o.startRange=Yi.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Xf(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Yi.maxDate,this._o.maxYear=Yi.maxYear,this._o.maxMonth=Yi.maxMonth,this._o.endRange=Yi.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+h5(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&lR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=qs().innerWidth||Xr().documentElement.clientWidth,i=qs().innerHeight||Xr().documentElement.clientHeight,o=Xr().body.scrollTop||Xr().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+qs().pageXOffset,a=l.bottom+qs().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",rb(this.el,u?"left-aligned":"right-aligned"),rb(this.el,c?"bottom-aligned":"top-aligned"),ib(this.el,u?"right-aligned":"left-aligned"),ib(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=lA(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Xf(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=lA(h,u),g=o+s,w=g;for(;w>7;)w-=7;g+=7-w;let C=!1;for(let S=0,v=0;S<g;S++){let T=new Date(t,e,1+(S-s)),M=Ir(this._d)?Zf(T,this._d):!1,x=Zf(T,i),I=r.events.indexOf(T.toDateString())!==-1,P=S<s||S>=o+s,U=1+(S-s),K=e,N=t,Y=r.startRange&&Zf(r.startRange,T),X=r.endRange&&Zf(r.endRange,T),se=r.startRange&&r.endRange&&r.startRange<T&&T<r.endRange,ee=r.minDate&&T<r.minDate||r.maxDate&&T>r.maxDate||r.disableWeekends&&r5(T)||r.disableDayFn&&r.disableDayFn(T);P&&(S<s?(U=f+U,K=u,N=h):(U=U-o,K=c,N=d));let te={day:U,month:K,year:N,hasEvent:I,isSelected:M,isToday:x,isDisabled:ee,isEmpty:P,isStartRange:Y,isEndRange:X,isInRange:se,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&M&&(C=!0),l.push(o5(te)),++v===7&&(r.showWeekNumber&&l.unshift(a5(this,S-s,e,t,r.firstWeekOfYearMinDays)),a.push(l5(l,r.isRTL,r.pickWholeWeek,C)),l=[],v=0,C=!1)}return d5(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),ib(this.el,"is-hidden"),this._o.bound&&(ro(Xr(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&ko(Xr(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),rb(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),ko(this.el,"mousedown",this._onMouseDown,!0),ko(this.el,"touchend",this._onMouseDown,!0),ko(this.el,"change",this._onChange),t.keyboardInput&&ko(Xr(),"keydown",this._onKeyChange),t.field&&(ko(t.field,"change",this._onInputChange),t.bound&&(ko(t.trigger,"click",this._onInputClick),ko(t.trigger,"focus",this._onInputFocus),ko(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function f5(t,e){g5(t,e),e.add(t)}function g5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dA(t,e,n){return(e=m5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m5(t){var e=p5(t,"string");return typeof e=="symbol"?e:e+""}function p5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ob(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const e$="date",fA="dateEditor",w5="DD/MM/YYYY";var Jf=new WeakSet;class t$ extends kl{constructor(){super(...arguments),f5(this,Jf),dA(this,"parentDestroyed",!1),dA(this,"$datePicker",null)}static get EDITOR_TYPE(){return e$}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof uR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{ye(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:fA})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(fA),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=ob(Jf,this,sb).call(this),r=this.hot.view.isMouseDown(),i=e?Fk(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new uR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Z),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&jp(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:ob(Jf,this,sb).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Z(a).format(ob(Jf,this,sb).call(this))),this.setValue(a),i&&i(),po()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Ft.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+tn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Yt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function sb(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:w5}const v5="dropdown";class n$ extends DT{static get EDITOR_TYPE(){return v5}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const C5="numeric";class r$ extends kl{static get EDITOR_TYPE(){return C5}}function y5(t,e,n){return(e=b5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b5(t){var e=S5(t,"string");return typeof e=="symbol"?e:e+""}function S5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const R5="password";class i$ extends kl{constructor(){super(...arguments),y5(this,"autoResize",qL(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return R5}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,us(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...ua(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const ab="ht_editor_visible",gA="selectEditor",E5="select";class o$ extends Rc{static get EDITOR_TYPE(){return E5}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Nl()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),q(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ye(this.selectWrapper,ab)&&we(this.selectWrapper,ab),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),us(this.select),He(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,bc(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Ft.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.selectWrapper,ab)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:gA};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(gA)}}const T5="time";class s$ extends kl{static get EDITOR_TYPE(){return T5}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function _5(){Er(Rc),Er(DT),Er(QL),Er(t$),Er(n$),Er(NT),Er(r$),Er(i$),Er(o$),Er(kl),Er(s$)}const M5="html";function LT(t,e,n,r,i,o,s){Qd.apply(this,[t,e,n,r,i,o,s]),bc(e,o??"",!1)}LT.RENDERER_TYPE=M5;const I5="autocomplete";function Tc(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?LT:ws,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Nl()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new Di(t);t.acArrowListener=function(d){ye(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Tc.RENDERER_TYPE=I5;const P5="dropdown";function $T(t,e,n,r,i,o,s){Tc.apply(this,[t,e,n,r,i,o,s])}$T.RENDERER_TYPE=P5;const mA=new WeakMap,pA=new WeakMap,O5="htBadValue",ac="data-row",lc="data-col",x5="checkboxRenderer",a$="checkbox";re.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===a$){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function FT(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Qd.apply(this,[t,e,n,r,i,o,s]),A5(t);let u=H5(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),us(e),o===s.checkedTemplate||It(o).toLocaleLowerCase(s.locale)===It(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||It(o).toLocaleLowerCase(s.locale)===It(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Wt(o)?q(u,"noValue"):(u.style.display="none",q(u,O5),h=!0),Ce(u,[[ac,n],[lc,r]]),l&&Ce(u,[tc(u.checked?t.getTranslatedPhrase(MT):t.getTranslatedPhrase(IT)),Ck(u.checked),Cq()]),!h&&c){let w="";if(c.value)w=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const S=t.getDataAtRowProp(n,c.property);w=S!==null?S:""}const C=N5(a,w,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),mA.has(t)||(mA.set(t,!0),d());function d(){const C=t.getShortcutManager().getContext("grid"),S={group:x5,relativeToGroup:da,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const v=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&v?.highlight.isCell()&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}}],S)}function f(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=t.getSelectedRange(),S=[],v=new Map;let T=[],M=0;if(C){for(let x=0;x<C.length;x++){const{row:I,col:P}=C[x].getTopStartCorner(),{row:U,col:K}=C[x].getBottomEndCorner();for(let N=I;N<=U;N+=1)for(let Y=P;Y<=K;Y+=1){const X=t.getCellMeta(N,Y);if(X.hidden)continue;const se={checkedTemplate:X.checkedTemplate,uncheckedTemplate:X.uncheckedTemplate};if(X.type!=="checkbox"){w===!0&&!X.readOnly&&(v.has(S.length)?v.set(S.length,[...v.get(S.length),[N,Y,null]]):v.set(S.length,[[N,Y,null]]));continue}if(X.readOnly===!0)continue;typeof X.checkedTemplate>"u"&&(X.checkedTemplate=!0),typeof X.uncheckedTemplate>"u"&&(X.uncheckedTemplate=!1);const ee=t.getDataAtCell(N,Y);w===!1?[X.checkedTemplate,X.checkedTemplate.toString()].includes(ee)?T.push([N,Y,X.uncheckedTemplate,se]):[X.uncheckedTemplate,X.uncheckedTemplate.toString(),null,void 0].includes(ee)&&T.push([N,Y,X.checkedTemplate,se]):T.push([N,Y,X.uncheckedTemplate,se]),M+=1}S.push(M),M=0}T.every(x=>{let[,,I]=x;return I===T[0][2]})?T=T.map(x=>{let[I,P,U]=x;return[I,P,U]}):T=T.map(x=>{let[I,P,,U]=x;return[I,P,U.checkedTemplate]}),T.length>0&&S.forEach((x,I)=>{let P=T.splice(0,x);v.size&&v.has(I)&&(P=[...P,...v.get(I)]),t.setDataAtCell(P)})}}function g(){const w=t.getSelectedRange();if(w){for(let C=0;C<w.length;C++){const S=w[C].getTopStartCorner(),v=w[C].getBottomEndCorner();for(let T=S.row;T<=v.row;T++)for(let M=S.col;M<=v.col;M++){if(t.getCellMeta(T,M).readOnly)continue;const I=t.getCell(T,M);if(as(I)&&I.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}FT.RENDERER_TYPE=a$;function A5(t){let e=pA.get(t);if(!e){const{rootElement:n}=t;e=new Di(t),e.addEventListener(n,"click",r=>k5(r,t)),e.addEventListener(n,"mouseup",r=>D5(r,t)),e.addEventListener(n,"change",r=>L5(r,t)),pA.set(t,e)}return e}function H5(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function N5(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function D5(t,e){const{target:n}=t;VT(n)&&(!n.hasAttribute(ac)||!n.hasAttribute(lc)||setTimeout(e.listen,10))}function k5(t,e){const{target:n}=t;if(!VT(n)||!n.hasAttribute(ac)||!n.hasAttribute(lc))return;const r=parseInt(n.getAttribute(ac),10),i=parseInt(n.getAttribute(lc),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function L5(t,e){const{target:n}=t;if(!VT(n)||!n.hasAttribute(ac)||!n.hasAttribute(lc))return;const r=parseInt(n.getAttribute(ac),10),i=parseInt(n.getAttribute(lc),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function VT(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const $5="handsontable";function WT(t,e,n,r,i,o,s){Tc.apply(this,[t,e,n,r,i,o,s])}WT.RENDERER_TYPE=$5;var F5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function V5(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var lb,wA;function W5(){return wA||(wA=1,lb={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),lb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ub,vA;function l$(){if(vA)return ub;vA=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let w="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*n(C,u,c,h,d,f);for(let I=0;I<t.length;I++){let P=t[I];if(w=l.replace(RegExp(`([0-9 ])(${P.key})$`),"$1"),w!==l)return n(w,u,c,h,d,f)*P.factor}if(w=l.replace("%",""),w!==l)return n(w,u,c,h,d,f)/100;let S=parseFloat(l);if(isNaN(S))return;let v=h(S);if(v&&v!=="."&&(w=l.replace(new RegExp(`${e(v)}$`),""),w!==l))return n(w,u,c,h,d,f);let T={};Object.keys(f).forEach(I=>{T[f[I]]=I});let M=Object.keys(T).sort().reverse(),x=M.length;for(let I=0;I<x;I++){let P=M[I],U=T[P];if(w=l.replace(P,""),w!==l){let K;switch(U){case"thousand":K=Math.pow(10,3);break;case"million":K=Math.pow(10,6);break;case"billion":K=Math.pow(10,9);break;case"trillion":K=Math.pow(10,12);break}return n(w,u,c,h,d,f)*K}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let w=r(l,u,c);return n(w,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=UT();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),w=c.currentAbbreviations(),C;if(typeof l=="string")o(l,h)?C=s(l):C=i(l,h,d,f,g,w);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return ub={unformat:a},ub}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var cb,CA;function BT(){if(CA)return cb;CA=1;let t=l$();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,S)=>S.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,S)=>S.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,S)=>!S.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,S)=>S.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(C,S){let v=d(C),T=g(S);return v&&T}function d(C){return t.unformat(C)!==void 0}function f(C,S,v,T=!1){let M=Object.keys(C).map(x=>{if(!S[x])return console.error(`${v} Invalid key: ${x}`),!1;let I=C[x],P=S[x];if(typeof P=="string"&&(P={type:P}),P.type==="format"){if(!f(I,u,`[Validate ${x}]`,!0))return!1}else if(typeof I!==P.type)return console.error(`${v} ${x} type mismatched: "${P.type}" expected, "${typeof I}" provided`),!1;if(P.restrictions&&P.restrictions.length){let U=P.restrictions.length;for(let K=0;K<U;K++){let{restriction:N,message:Y}=P.restrictions[K];if(!N(I,C))return console.error(`${v} ${x} invalid value: ${Y}`),!1}}return P.restriction&&!P.restriction(I,C)?(console.error(`${v} ${x} invalid value: ${P.message}`),!1):P.validValues&&P.validValues.indexOf(I)===-1?(console.error(`${v} ${x} invalid value: must be among ${JSON.stringify(P.validValues)}, "${I}" provided`),!1):!(P.children&&!f(I,P.children,`[Validate ${x}]`))});return T||M.push(...Object.keys(S).map(x=>{let I=S[x];if(typeof I=="string"&&(I={type:I}),I.mandatory){let P=I.mandatory;if(typeof P=="function"&&(P=P(C)),P&&C[x]===void 0)return console.error(`${v} Missing mandatory key "${x}"`),!1}return!0})),M.reduce((x,I)=>x&&I,!0)}function g(C){return f(C,u,"[Validate format]")}function w(C){return f(C,c,"[Validate language]")}return cb={validate:h,validateFormat:g,validateInput:d,validateLanguage:w},cb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function B5(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function j5(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function U5(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function z5(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function Y5(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function G5(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function q5(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function K5(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function X5(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function Z5(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function J5(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function Q5(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function eZ(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function tZ(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function nZ(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function rZ(t,e={}){return typeof t!="string"?t:(t=B5(t,e),t=j5(t,e),U5(t,e),G5(t,e),q5(t,e),eZ(t,e),Z5(t,e),J5(t,e),K5(t,e),Q5(t,e),X5(t,e),z5(t,e),Y5(t,e),tZ(t,e),nZ(t,e),e)}var jT={parseFormat:rZ};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var hb,yA;function UT(){if(yA)return hb;yA=1;const t=W5(),e=BT(),n=jT;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,hb=r,hb}function iZ(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function oZ(t,e){t.forEach(n=>{let r;try{r=iZ(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var sZ=t=>({loadLanguagesInNode:e=>oZ(e,t)}),u$={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(I){var P,U,K,N=p.prototype={constructor:p,toString:null,valueOf:null},Y=new p(1),X=20,se=4,ee=-7,te=21,Le=-1e7,Ne=1e7,$e=!1,vt=1,rt=0,at={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},gn="0123456789abcdefghijklmnopqrstuvwxyz",m=!0;function p(y,R){var E,_,O,L,W,H,$,V,j=this;if(!(j instanceof p))return new p(y,R);if(R==null){if(y&&y._isBigNumber===!0){j.s=y.s,!y.c||y.e>Ne?j.c=j.e=null:y.e<Le?j.c=[j.e=0]:(j.e=y.e,j.c=y.c.slice());return}if((H=typeof y=="number")&&y*0==0){if(j.s=1/y<0?(y=-y,-1):1,y===~~y){for(L=0,W=y;W>=10;W/=10,L++);L>Ne?j.c=j.e=null:(j.e=L,j.c=[y]);return}V=String(y)}else{if(!r.test(V=String(y)))return K(j,V,H);j.s=V.charCodeAt(0)==45?(V=V.slice(1),-1):1}(L=V.indexOf("."))>-1&&(V=V.replace(".","")),(W=V.search(/e/i))>0?(L<0&&(L=W),L+=+V.slice(W+1),V=V.substring(0,W)):L<0&&(L=V.length)}else{if(v(R,2,gn.length,"Base"),R==10&&m)return j=new p(y),B(j,X+j.e+1,se);if(V=String(y),H=typeof y=="number"){if(y*0!=0)return K(j,V,H,R);if(j.s=1/y<0?(V=V.slice(1),-1):1,p.DEBUG&&V.replace(/^0\.0*|\./,"").length>15)throw Error(a+y)}else j.s=V.charCodeAt(0)===45?(V=V.slice(1),-1):1;for(E=gn.slice(0,R),L=W=0,$=V.length;W<$;W++)if(E.indexOf(_=V.charAt(W))<0){if(_=="."){if(W>L){L=$;continue}}else if(!O&&(V==V.toUpperCase()&&(V=V.toLowerCase())||V==V.toLowerCase()&&(V=V.toUpperCase()))){O=!0,W=-1,L=0;continue}return K(j,String(y),H,R)}H=!1,V=U(V,R,10,j.s),(L=V.indexOf("."))>-1?V=V.replace(".",""):L=V.length}for(W=0;V.charCodeAt(W)===48;W++);for($=V.length;V.charCodeAt(--$)===48;);if(V=V.slice(W,++$)){if($-=W,H&&p.DEBUG&&$>15&&(y>c||y!==o(y)))throw Error(a+j.s*y);if((L=L-W-1)>Ne)j.c=j.e=null;else if(L<Le)j.c=[j.e=0];else{if(j.e=L,j.c=[],W=(L+1)%u,L<0&&(W+=u),W<$){for(W&&j.c.push(+V.slice(0,W)),$-=u;W<$;)j.c.push(+V.slice(W,W+=u));W=u-(V=V.slice(W)).length}else W-=$;for(;W--;V+="0");j.c.push(+V)}}else j.c=[j.e=0]}p.clone=g,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(y){var R,E;if(y!=null)if(typeof y=="object"){if(y.hasOwnProperty(R="DECIMAL_PLACES")&&(E=y[R],v(E,0,f,R),X=E),y.hasOwnProperty(R="ROUNDING_MODE")&&(E=y[R],v(E,0,8,R),se=E),y.hasOwnProperty(R="EXPONENTIAL_AT")&&(E=y[R],E&&E.pop?(v(E[0],-f,0,R),v(E[1],0,f,R),ee=E[0],te=E[1]):(v(E,-f,f,R),ee=-(te=E<0?-E:E))),y.hasOwnProperty(R="RANGE"))if(E=y[R],E&&E.pop)v(E[0],-f,-1,R),v(E[1],1,f,R),Le=E[0],Ne=E[1];else if(v(E,-f,f,R),E)Le=-(Ne=E<0?-E:E);else throw Error(s+R+" cannot be zero: "+E);if(y.hasOwnProperty(R="CRYPTO"))if(E=y[R],E===!!E)if(E)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))$e=E;else throw $e=!E,Error(s+"crypto unavailable");else $e=E;else throw Error(s+R+" not true or false: "+E);if(y.hasOwnProperty(R="MODULO_MODE")&&(E=y[R],v(E,0,9,R),vt=E),y.hasOwnProperty(R="POW_PRECISION")&&(E=y[R],v(E,0,f,R),rt=E),y.hasOwnProperty(R="FORMAT"))if(E=y[R],typeof E=="object")at=E;else throw Error(s+R+" not an object: "+E);if(y.hasOwnProperty(R="ALPHABET"))if(E=y[R],typeof E=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(E))m=E.slice(0,10)=="0123456789",gn=E;else throw Error(s+R+" invalid: "+E)}else throw Error(s+"Object expected: "+y);return{DECIMAL_PLACES:X,ROUNDING_MODE:se,EXPONENTIAL_AT:[ee,te],RANGE:[Le,Ne],CRYPTO:$e,MODULO_MODE:vt,POW_PRECISION:rt,FORMAT:at,ALPHABET:gn}},p.isBigNumber=function(y){if(!y||y._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var R,E,_=y.c,O=y.e,L=y.s;e:if({}.toString.call(_)=="[object Array]"){if((L===1||L===-1)&&O>=-f&&O<=f&&O===o(O)){if(_[0]===0){if(O===0&&_.length===1)return!0;break e}if(R=(O+1)%u,R<1&&(R+=u),String(_[0]).length==R){for(R=0;R<_.length;R++)if(E=_[R],E<0||E>=l||E!==o(E))break e;if(E!==0)return!0}}}else if(_===null&&O===null&&(L===null||L===1||L===-1))return!0;throw Error(s+"Invalid BigNumber: "+y)},p.maximum=p.max=function(){return D(arguments,-1)},p.minimum=p.min=function(){return D(arguments,1)},p.random=function(){var y=9007199254740992,R=Math.random()*y&2097151?function(){return o(Math.random()*y)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(E){var _,O,L,W,H,$=0,V=[],j=new p(Y);if(E==null?E=X:v(E,0,f),W=i(E/u),$e)if(crypto.getRandomValues){for(_=crypto.getRandomValues(new Uint32Array(W*=2));$<W;)H=_[$]*131072+(_[$+1]>>>11),H>=9e15?(O=crypto.getRandomValues(new Uint32Array(2)),_[$]=O[0],_[$+1]=O[1]):(V.push(H%1e14),$+=2);$=W/2}else if(crypto.randomBytes){for(_=crypto.randomBytes(W*=7);$<W;)H=(_[$]&31)*281474976710656+_[$+1]*1099511627776+_[$+2]*4294967296+_[$+3]*16777216+(_[$+4]<<16)+(_[$+5]<<8)+_[$+6],H>=9e15?crypto.randomBytes(7).copy(_,$):(V.push(H%1e14),$+=7);$=W/7}else throw $e=!1,Error(s+"crypto unavailable");if(!$e)for(;$<W;)H=R(),H<9e15&&(V[$++]=H%1e14);for(W=V[--$],E%=u,W&&E&&(H=h[u-E],V[$]=o(W/H)*H);V[$]===0;V.pop(),$--);if($<0)V=[L=0];else{for(L=-1;V[0]===0;V.splice(0,1),L-=u);for($=1,H=V[0];H>=10;H/=10,$++);$<u&&(L-=u-$)}return j.e=L,j.c=V,j}}(),p.sum=function(){for(var y=1,R=arguments,E=new p(R[0]);y<R.length;)E=E.plus(R[y++]);return E},U=function(){var y="0123456789";function R(E,_,O,L){for(var W,H=[0],$,V=0,j=E.length;V<j;){for($=H.length;$--;H[$]*=_);for(H[0]+=L.indexOf(E.charAt(V++)),W=0;W<H.length;W++)H[W]>O-1&&(H[W+1]==null&&(H[W+1]=0),H[W+1]+=H[W]/O|0,H[W]%=O)}return H.reverse()}return function(E,_,O,L,W){var H,$,V,j,z,oe,ae,Se,Fe=E.indexOf("."),Ve=X,Re=se;for(Fe>=0&&(j=rt,rt=0,E=E.replace(".",""),Se=new p(_),oe=Se.pow(E.length-Fe),rt=j,Se.c=R(x(C(oe.c),oe.e,"0"),10,O,y),Se.e=Se.c.length),ae=R(E,_,O,W?(H=gn,y):(H=y,gn)),V=j=ae.length;ae[--j]==0;ae.pop());if(!ae[0])return H.charAt(0);if(Fe<0?--V:(oe.c=ae,oe.e=V,oe.s=L,oe=P(oe,Se,Ve,Re,O),ae=oe.c,z=oe.r,V=oe.e),$=V+Ve+1,Fe=ae[$],j=O/2,z=z||$<0||ae[$+1]!=null,z=Re<4?(Fe!=null||z)&&(Re==0||Re==(oe.s<0?3:2)):Fe>j||Fe==j&&(Re==4||z||Re==6&&ae[$-1]&1||Re==(oe.s<0?8:7)),$<1||!ae[0])E=z?x(H.charAt(1),-Ve,H.charAt(0)):H.charAt(0);else{if(ae.length=$,z)for(--O;++ae[--$]>O;)ae[$]=0,$||(++V,ae=[1].concat(ae));for(j=ae.length;!ae[--j];);for(Fe=0,E="";Fe<=j;E+=H.charAt(ae[Fe++]));E=x(E,V,H.charAt(0))}return E}}(),P=function(){function y(_,O,L){var W,H,$,V,j=0,z=_.length,oe=O%d,ae=O/d|0;for(_=_.slice();z--;)$=_[z]%d,V=_[z]/d|0,W=ae*$+V*oe,H=oe*$+W%d*d+j,j=(H/L|0)+(W/d|0)+ae*V,_[z]=H%L;return j&&(_=[j].concat(_)),_}function R(_,O,L,W){var H,$;if(L!=W)$=L>W?1:-1;else for(H=$=0;H<L;H++)if(_[H]!=O[H]){$=_[H]>O[H]?1:-1;break}return $}function E(_,O,L,W){for(var H=0;L--;)_[L]-=H,H=_[L]<O[L]?1:0,_[L]=H*W+_[L]-O[L];for(;!_[0]&&_.length>1;_.splice(0,1));}return function(_,O,L,W,H){var $,V,j,z,oe,ae,Se,Fe,Ve,Re,be,et,Jn,_o,ci,ln,Ct,Et=_.s==O.s?1:-1,mt=_.c,Ze=O.c;if(!mt||!mt[0]||!Ze||!Ze[0])return new p(!_.s||!O.s||(mt?Ze&&mt[0]==Ze[0]:!Ze)?NaN:mt&&mt[0]==0||!Ze?Et*0:Et/0);for(Fe=new p(Et),Ve=Fe.c=[],V=_.e-O.e,Et=L+V+1,H||(H=l,V=w(_.e/u)-w(O.e/u),Et=Et/u|0),j=0;Ze[j]==(mt[j]||0);j++);if(Ze[j]>(mt[j]||0)&&V--,Et<0)Ve.push(1),z=!0;else{for(_o=mt.length,ln=Ze.length,j=0,Et+=2,oe=o(H/(Ze[0]+1)),oe>1&&(Ze=y(Ze,oe,H),mt=y(mt,oe,H),ln=Ze.length,_o=mt.length),Jn=ln,Re=mt.slice(0,ln),be=Re.length;be<ln;Re[be++]=0);Ct=Ze.slice(),Ct=[0].concat(Ct),ci=Ze[0],Ze[1]>=H/2&&ci++;do{if(oe=0,$=R(Ze,Re,ln,be),$<0){if(et=Re[0],ln!=be&&(et=et*H+(Re[1]||0)),oe=o(et/ci),oe>1)for(oe>=H&&(oe=H-1),ae=y(Ze,oe,H),Se=ae.length,be=Re.length;R(ae,Re,Se,be)==1;)oe--,E(ae,ln<Se?Ct:Ze,Se,H),Se=ae.length,$=1;else oe==0&&($=oe=1),ae=Ze.slice(),Se=ae.length;if(Se<be&&(ae=[0].concat(ae)),E(Re,ae,be,H),be=Re.length,$==-1)for(;R(Ze,Re,ln,be)<1;)oe++,E(Re,ln<be?Ct:Ze,be,H),be=Re.length}else $===0&&(oe++,Re=[0]);Ve[j++]=oe,Re[0]?Re[be++]=mt[Jn]||0:(Re=[mt[Jn]],be=1)}while((Jn++<_o||Re[0]!=null)&&Et--);z=Re[0]!=null,Ve[0]||Ve.splice(0,1)}if(H==l){for(j=1,Et=Ve[0];Et>=10;Et/=10,j++);B(Fe,L+(Fe.e=j+V*u-1)+1,W,z)}else Fe.e=V,Fe.r=+z;return Fe}}();function b(y,R,E,_){var O,L,W,H,$;if(E==null?E=se:v(E,0,8),!y.c)return y.toString();if(O=y.c[0],W=y.e,R==null)$=C(y.c),$=_==1||_==2&&(W<=ee||W>=te)?M($,W):x($,W,"0");else if(y=B(new p(y),R,E),L=y.e,$=C(y.c),H=$.length,_==1||_==2&&(R<=L||L<=ee)){for(;H<R;$+="0",H++);$=M($,L)}else if(R-=W,$=x($,L,"0"),L+1>H){if(--R>0)for($+=".";R--;$+="0");}else if(R+=L-H,R>0)for(L+1==H&&($+=".");R--;$+="0");return y.s<0&&O?"-"+$:$}function D(y,R){for(var E,_,O=1,L=new p(y[0]);O<y.length;O++)_=new p(y[O]),(!_.s||(E=S(L,_))===R||E===0&&L.s===R)&&(L=_);return L}function F(y,R,E){for(var _=1,O=R.length;!R[--O];R.pop());for(O=R[0];O>=10;O/=10,_++);return(E=_+E*u-1)>Ne?y.c=y.e=null:E<Le?y.c=[y.e=0]:(y.e=E,y.c=R),y}K=function(){var y=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,E=/^\.([^.]+)$/,_=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(L,W,H,$){var V,j=H?W:W.replace(O,"");if(_.test(j))L.s=isNaN(j)?null:j<0?-1:1;else{if(!H&&(j=j.replace(y,function(z,oe,ae){return V=(ae=ae.toLowerCase())=="x"?16:ae=="b"?2:8,!$||$==V?oe:z}),$&&(V=$,j=j.replace(R,"$1").replace(E,"0.$1")),W!=j))return new p(j,V);if(p.DEBUG)throw Error(s+"Not a"+($?" base "+$:"")+" number: "+W);L.s=null}L.c=L.e=null}}();function B(y,R,E,_){var O,L,W,H,$,V,j,z=y.c,oe=h;if(z){e:{for(O=1,H=z[0];H>=10;H/=10,O++);if(L=R-O,L<0)L+=u,W=R,$=z[V=0],j=o($/oe[O-W-1]%10);else if(V=i((L+1)/u),V>=z.length)if(_){for(;z.length<=V;z.push(0));$=j=0,O=1,L%=u,W=L-u+1}else break e;else{for($=H=z[V],O=1;H>=10;H/=10,O++);L%=u,W=L-u+O,j=W<0?0:o($/oe[O-W-1]%10)}if(_=_||R<0||z[V+1]!=null||(W<0?$:$%oe[O-W-1]),_=E<4?(j||_)&&(E==0||E==(y.s<0?3:2)):j>5||j==5&&(E==4||_||E==6&&(L>0?W>0?$/oe[O-W]:0:z[V-1])%10&1||E==(y.s<0?8:7)),R<1||!z[0])return z.length=0,_?(R-=y.e+1,z[0]=oe[(u-R%u)%u],y.e=-R||0):z[0]=y.e=0,y;if(L==0?(z.length=V,H=1,V--):(z.length=V+1,H=oe[u-L],z[V]=W>0?o($/oe[O-W]%oe[W])*H:0),_)for(;;)if(V==0){for(L=1,W=z[0];W>=10;W/=10,L++);for(W=z[0]+=H,H=1;W>=10;W/=10,H++);L!=H&&(y.e++,z[0]==l&&(z[0]=1));break}else{if(z[V]+=H,z[V]!=l)break;z[V--]=0,H=1}for(L=z.length;z[--L]===0;z.pop());}y.e>Ne?y.c=y.e=null:y.e<Le&&(y.c=[y.e=0])}return y}function G(y){var R,E=y.e;return E===null?y.toString():(R=C(y.c),R=E<=ee||E>=te?M(R,E):x(R,E,"0"),y.s<0?"-"+R:R)}return N.absoluteValue=N.abs=function(){var y=new p(this);return y.s<0&&(y.s=1),y},N.comparedTo=function(y,R){return S(this,new p(y,R))},N.decimalPlaces=N.dp=function(y,R){var E,_,O,L=this;if(y!=null)return v(y,0,f),R==null?R=se:v(R,0,8),B(new p(L),y+L.e+1,R);if(!(E=L.c))return null;if(_=((O=E.length-1)-w(this.e/u))*u,O=E[O])for(;O%10==0;O/=10,_--);return _<0&&(_=0),_},N.dividedBy=N.div=function(y,R){return P(this,new p(y,R),X,se)},N.dividedToIntegerBy=N.idiv=function(y,R){return P(this,new p(y,R),0,1)},N.exponentiatedBy=N.pow=function(y,R){var E,_,O,L,W,H,$,V,j,z=this;if(y=new p(y),y.c&&!y.isInteger())throw Error(s+"Exponent not an integer: "+G(y));if(R!=null&&(R=new p(R)),H=y.e>14,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!y.c||!y.c[0])return j=new p(Math.pow(+G(z),H?y.s*(2-T(y)):+G(y))),R?j.mod(R):j;if($=y.s<0,R){if(R.c?!R.c[0]:!R.s)return new p(NaN);_=!$&&z.isInteger()&&R.isInteger(),_&&(z=z.mod(R))}else{if(y.e>9&&(z.e>0||z.e<-1||(z.e==0?z.c[0]>1||H&&z.c[1]>=24e7:z.c[0]<8e13||H&&z.c[0]<=9999975e7)))return L=z.s<0&&T(y)?-0:0,z.e>-1&&(L=1/L),new p($?1/L:L);rt&&(L=i(rt/u+2))}for(H?(E=new p(.5),$&&(y.s=1),V=T(y)):(O=Math.abs(+G(y)),V=O%2),j=new p(Y);;){if(V){if(j=j.times(z),!j.c)break;L?j.c.length>L&&(j.c.length=L):_&&(j=j.mod(R))}if(O){if(O=o(O/2),O===0)break;V=O%2}else if(y=y.times(E),B(y,y.e+1,1),y.e>14)V=T(y);else{if(O=+G(y),O===0)break;V=O%2}z=z.times(z),L?z.c&&z.c.length>L&&(z.c.length=L):_&&(z=z.mod(R))}return _?j:($&&(j=Y.div(j)),R?j.mod(R):L?B(j,rt,se,W):j)},N.integerValue=function(y){var R=new p(this);return y==null?y=se:v(y,0,8),B(R,R.e+1,y)},N.isEqualTo=N.eq=function(y,R){return S(this,new p(y,R))===0},N.isFinite=function(){return!!this.c},N.isGreaterThan=N.gt=function(y,R){return S(this,new p(y,R))>0},N.isGreaterThanOrEqualTo=N.gte=function(y,R){return(R=S(this,new p(y,R)))===1||R===0},N.isInteger=function(){return!!this.c&&w(this.e/u)>this.c.length-2},N.isLessThan=N.lt=function(y,R){return S(this,new p(y,R))<0},N.isLessThanOrEqualTo=N.lte=function(y,R){return(R=S(this,new p(y,R)))===-1||R===0},N.isNaN=function(){return!this.s},N.isNegative=function(){return this.s<0},N.isPositive=function(){return this.s>0},N.isZero=function(){return!!this.c&&this.c[0]==0},N.minus=function(y,R){var E,_,O,L,W=this,H=W.s;if(y=new p(y,R),R=y.s,!H||!R)return new p(NaN);if(H!=R)return y.s=-R,W.plus(y);var $=W.e/u,V=y.e/u,j=W.c,z=y.c;if(!$||!V){if(!j||!z)return j?(y.s=-R,y):new p(z?W:NaN);if(!j[0]||!z[0])return z[0]?(y.s=-R,y):new p(j[0]?W:se==3?-0:0)}if($=w($),V=w(V),j=j.slice(),H=$-V){for((L=H<0)?(H=-H,O=j):(V=$,O=z),O.reverse(),R=H;R--;O.push(0));O.reverse()}else for(_=(L=(H=j.length)<(R=z.length))?H:R,H=R=0;R<_;R++)if(j[R]!=z[R]){L=j[R]<z[R];break}if(L&&(O=j,j=z,z=O,y.s=-y.s),R=(_=z.length)-(E=j.length),R>0)for(;R--;j[E++]=0);for(R=l-1;_>H;){if(j[--_]<z[_]){for(E=_;E&&!j[--E];j[E]=R);--j[E],j[_]+=l}j[_]-=z[_]}for(;j[0]==0;j.splice(0,1),--V);return j[0]?F(y,j,V):(y.s=se==3?-1:1,y.c=[y.e=0],y)},N.modulo=N.mod=function(y,R){var E,_,O=this;return y=new p(y,R),!O.c||!y.s||y.c&&!y.c[0]?new p(NaN):!y.c||O.c&&!O.c[0]?new p(O):(vt==9?(_=y.s,y.s=1,E=P(O,y,0,3),y.s=_,E.s*=_):E=P(O,y,0,vt),y=O.minus(E.times(y)),!y.c[0]&&vt==1&&(y.s=O.s),y)},N.multipliedBy=N.times=function(y,R){var E,_,O,L,W,H,$,V,j,z,oe,ae,Se,Fe,Ve,Re=this,be=Re.c,et=(y=new p(y,R)).c;if(!be||!et||!be[0]||!et[0])return!Re.s||!y.s||be&&!be[0]&&!et||et&&!et[0]&&!be?y.c=y.e=y.s=null:(y.s*=Re.s,!be||!et?y.c=y.e=null:(y.c=[0],y.e=0)),y;for(_=w(Re.e/u)+w(y.e/u),y.s*=Re.s,$=be.length,z=et.length,$<z&&(Se=be,be=et,et=Se,O=$,$=z,z=O),O=$+z,Se=[];O--;Se.push(0));for(Fe=l,Ve=d,O=z;--O>=0;){for(E=0,oe=et[O]%Ve,ae=et[O]/Ve|0,W=$,L=O+W;L>O;)V=be[--W]%Ve,j=be[W]/Ve|0,H=ae*V+j*oe,V=oe*V+H%Ve*Ve+Se[L]+E,E=(V/Fe|0)+(H/Ve|0)+ae*j,Se[L--]=V%Fe;Se[L]=E}return E?++_:Se.splice(0,1),F(y,Se,_)},N.negated=function(){var y=new p(this);return y.s=-y.s||null,y},N.plus=function(y,R){var E,_=this,O=_.s;if(y=new p(y,R),R=y.s,!O||!R)return new p(NaN);if(O!=R)return y.s=-R,_.minus(y);var L=_.e/u,W=y.e/u,H=_.c,$=y.c;if(!L||!W){if(!H||!$)return new p(O/0);if(!H[0]||!$[0])return $[0]?y:new p(H[0]?_:O*0)}if(L=w(L),W=w(W),H=H.slice(),O=L-W){for(O>0?(W=L,E=$):(O=-O,E=H),E.reverse();O--;E.push(0));E.reverse()}for(O=H.length,R=$.length,O-R<0&&(E=$,$=H,H=E,R=O),O=0;R;)O=(H[--R]=H[R]+$[R]+O)/l|0,H[R]=l===H[R]?0:H[R]%l;return O&&(H=[O].concat(H),++W),F(y,H,W)},N.precision=N.sd=function(y,R){var E,_,O,L=this;if(y!=null&&y!==!!y)return v(y,1,f),R==null?R=se:v(R,0,8),B(new p(L),y,R);if(!(E=L.c))return null;if(O=E.length-1,_=O*u+1,O=E[O]){for(;O%10==0;O/=10,_--);for(O=E[0];O>=10;O/=10,_++);}return y&&L.e+1>_&&(_=L.e+1),_},N.shiftedBy=function(y){return v(y,-c,c),this.times("1e"+y)},N.squareRoot=N.sqrt=function(){var y,R,E,_,O,L=this,W=L.c,H=L.s,$=L.e,V=X+4,j=new p("0.5");if(H!==1||!W||!W[0])return new p(!H||H<0&&(!W||W[0])?NaN:W?L:1/0);if(H=Math.sqrt(+G(L)),H==0||H==1/0?(R=C(W),(R.length+$)%2==0&&(R+="0"),H=Math.sqrt(+R),$=w(($+1)/2)-($<0||$%2),H==1/0?R="5e"+$:(R=H.toExponential(),R=R.slice(0,R.indexOf("e")+1)+$),E=new p(R)):E=new p(H+""),E.c[0]){for($=E.e,H=$+V,H<3&&(H=0);;)if(O=E,E=j.times(O.plus(P(L,O,V,1))),C(O.c).slice(0,H)===(R=C(E.c)).slice(0,H))if(E.e<$&&--H,R=R.slice(H-3,H+1),R=="9999"||!_&&R=="4999"){if(!_&&(B(O,O.e+X+2,0),O.times(O).eq(L))){E=O;break}V+=4,H+=4,_=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(B(E,E.e+X+2,1),y=!E.times(E).eq(L));break}}return B(E,E.e+X+1,se,y)},N.toExponential=function(y,R){return y!=null&&(v(y,0,f),y++),b(this,y,R,1)},N.toFixed=function(y,R){return y!=null&&(v(y,0,f),y=y+this.e+1),b(this,y,R)},N.toFormat=function(y,R,E){var _,O=this;if(E==null)y!=null&&R&&typeof R=="object"?(E=R,R=null):y&&typeof y=="object"?(E=y,y=R=null):E=at;else if(typeof E!="object")throw Error(s+"Argument not an object: "+E);if(_=O.toFixed(y,R),O.c){var L,W=_.split("."),H=+E.groupSize,$=+E.secondaryGroupSize,V=E.groupSeparator||"",j=W[0],z=W[1],oe=O.s<0,ae=oe?j.slice(1):j,Se=ae.length;if($&&(L=H,H=$,$=L,Se-=L),H>0&&Se>0){for(L=Se%H||H,j=ae.substr(0,L);L<Se;L+=H)j+=V+ae.substr(L,H);$>0&&(j+=V+ae.slice(L)),oe&&(j="-"+j)}_=z?j+(E.decimalSeparator||"")+(($=+E.fractionGroupSize)?z.replace(new RegExp("\\d{"+$+"}\\B","g"),"$&"+(E.fractionGroupSeparator||"")):z):j}return(E.prefix||"")+_+(E.suffix||"")},N.toFraction=function(y){var R,E,_,O,L,W,H,$,V,j,z,oe,ae=this,Se=ae.c;if(y!=null&&(H=new p(y),!H.isInteger()&&(H.c||H.s!==1)||H.lt(Y)))throw Error(s+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+G(H));if(!Se)return new p(ae);for(R=new p(Y),V=E=new p(Y),_=$=new p(Y),oe=C(Se),L=R.e=oe.length-ae.e-1,R.c[0]=h[(W=L%u)<0?u+W:W],y=!y||H.comparedTo(R)>0?L>0?R:V:H,W=Ne,Ne=1/0,H=new p(oe),$.c[0]=0;j=P(H,R,0,1),O=E.plus(j.times(_)),O.comparedTo(y)!=1;)E=_,_=O,V=$.plus(j.times(O=V)),$=O,R=H.minus(j.times(O=R)),H=O;return O=P(y.minus(E),_,0,1),$=$.plus(O.times(V)),E=E.plus(O.times(_)),$.s=V.s=ae.s,L=L*2,z=P(V,_,L,se).minus(ae).abs().comparedTo(P($,E,L,se).minus(ae).abs())<1?[V,_]:[$,E],Ne=W,z},N.toNumber=function(){return+G(this)},N.toPrecision=function(y,R){return y!=null&&v(y,1,f),b(this,y,R,2)},N.toString=function(y){var R,E=this,_=E.s,O=E.e;return O===null?_?(R="Infinity",_<0&&(R="-"+R)):R="NaN":(y==null?R=O<=ee||O>=te?M(C(E.c),O):x(C(E.c),O,"0"):y===10&&m?(E=B(new p(E),X+O+1,se),R=x(C(E.c),E.e,"0")):(v(y,2,gn.length,"Base"),R=U(x(C(E.c),O,"0"),10,y,_,!0)),_<0&&E.c[0]&&(R="-"+R)),R},N.valueOf=N.toJSON=function(){return G(this)},N._isBigNumber=!0,I!=null&&p.set(I),p}function w(I){var P=I|0;return I>0||I===P?P:P-1}function C(I){for(var P,U,K=1,N=I.length,Y=I[0]+"";K<N;){for(P=I[K++]+"",U=u-P.length;U--;P="0"+P);Y+=P}for(N=Y.length;Y.charCodeAt(--N)===48;);return Y.slice(0,N+1||1)}function S(I,P){var U,K,N=I.c,Y=P.c,X=I.s,se=P.s,ee=I.e,te=P.e;if(!X||!se)return null;if(U=N&&!N[0],K=Y&&!Y[0],U||K)return U?K?0:-se:X;if(X!=se)return X;if(U=X<0,K=ee==te,!N||!Y)return K?0:!N^U?1:-1;if(!K)return ee>te^U?1:-1;for(se=(ee=N.length)<(te=Y.length)?ee:te,X=0;X<se;X++)if(N[X]!=Y[X])return N[X]>Y[X]^U?1:-1;return ee==te?0:ee>te^U?1:-1}function v(I,P,U,K){if(I<P||I>U||I!==o(I))throw Error(s+(K||"Argument")+(typeof I=="number"?I<P||I>U?" out of range: ":" not an integer: ":" not a primitive number: ")+String(I))}function T(I){var P=I.c.length-1;return w(I.e/u)==P&&I.c[P]%2!=0}function M(I,P){return(I.length>1?I.charAt(0)+"."+I.slice(1):I)+(P<0?"e":"e+")+P}function x(I,P,U){var K,N;if(P<0){for(N=U+".";++P;N+=U);I=N+I}else if(K=I.length,++P>K){for(N=U,P-=K;--P;N+=U);I+=N}else P<K&&(I=I.slice(0,P)+"."+I.slice(P));return I}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(F5)})(u$);var c$=u$.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Si=UT(),aZ=BT(),lZ=jT,uZ=c$,yn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},ef={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:h$,decimalSuffixes:Bm}=Si.currentBytes(),zT={general:{scale:1024,suffixes:Bm},binary:{scale:1024,suffixes:h$},decimal:{scale:1e3,suffixes:Bm}};function cZ(t,e={},n){if(typeof e=="string"&&(e=lZ.parseFormat(e)),!aZ.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=hZ(t,e,n);return s=OZ(s,i),s=xZ(s,o),s}function hZ(t,e,n){switch(e.output){case"currency":return e=Ou(e,Si.currentCurrencyDefaultFormat()),CZ(t,e,Si);case"percent":return e=Ou(e,Si.currentPercentageDefaultFormat()),vZ(t,e,Si,n);case"byte":return e=Ou(e,Si.currentByteDefaultFormat()),mZ(t,e,Si,n);case"time":return e=Ou(e,Si.currentTimeDefaultFormat()),wZ(t);case"ordinal":return e=Ou(e,Si.currentOrdinalDefaultFormat()),pZ(t,e,Si);case"number":default:return tf({instance:t,providedFormat:e})}}function dZ(t){let e=zT.decimal;return ow(t._value,e.suffixes,e.scale).suffix}function fZ(t){let e=zT.binary;return ow(t._value,e.suffixes,e.scale).suffix}function gZ(t){let e=zT.general;return ow(t._value,e.suffixes,e.scale).suffix}function ow(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function mZ(t,e,n,r){let i=e.base||"binary",o=Object.assign({},ef,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Bm,marker:"bd"},binary:{scale:1024,suffixes:s||h$,marker:"b"},decimal:{scale:1e3,suffixes:a||Bm,marker:"d"}}[i],{value:c,suffix:h}=ow(t._value,u.suffixes,u.scale);return`${tf({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function pZ(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},ef,e),o=tf({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function wZ(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function vZ(t,e,n,r){let i=e.prefixSymbol,o=tf({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},ef,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function CZ(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},ef,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=tf({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function yZ({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&yn[e]?(a=r[e],t=t/yn[e]):l>=yn.trillion||n&&s(l/yn.trillion)===1?(a=r.trillion,t=t/yn.trillion):l<yn.trillion&&l>=yn.billion||n&&s(l/yn.billion)===1?(a=r.billion,t=t/yn.billion):l<yn.billion&&l>=yn.million||n&&s(l/yn.million)===1?(a=r.million,t=t/yn.million):(l<yn.million&&l>=yn.thousand||n&&s(l/yn.thousand)===1)&&(a=r.thousand,t=t/yn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function bZ({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function Qf(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function SZ(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+Qf(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Qf(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Qf(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${Qf(e)}`),n}function RZ(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?SZ(t,e):new uZ(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function EZ(t,e,n,r,i,o){if(r===-1)return t;let s=RZ(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function TZ(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function _Z(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function MZ(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),_Z(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function IZ(t,e){return t+e}function PZ(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function OZ(t,e){return e+t}function xZ(t,e){return t+e}function tf({instance:t,providedFormat:e,state:n=Si,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},ef,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,w=s.trimMantissa,C=s.thousandSeparated,S=s.spaceSeparated,v=s.negative,T=s.forceSign,M=s.exponential,x=s.roundingFunction,I="";if(d){let U=yZ({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:S,roundingFunction:x,totalLength:a});o=U.value,I+=U.abbreviation,a&&(f=U.mantissaPrecision)}if(M){let U=bZ({value:o,characteristicPrecision:l});o=U.value,I=U.abbreviation+I}let P=EZ(o.toString(),o,g,f,w,x);return P=TZ(P,o,u,l),P=MZ(P,o,C,n,r),(d||M)&&(P=IZ(P,I)),(T||o<0)&&(P=PZ(P,o,v)),P}function Ou(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var AZ=t=>({format:(...e)=>cZ(...e,t),getByteUnit:(...e)=>gZ(...e,t),getBinaryByteUnit:(...e)=>fZ(...e,t),getDecimalByteUnit:(...e)=>dZ(...e,t),formatOrDefault:Ou});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const cs=c$;function HZ(t,e,n){let r=new cs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new cs(i),t._value=r.plus(i).toNumber(),t}function d$(t,e,n){let r=new cs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new cs(i),t._value=r.minus(i).toNumber(),t}function NZ(t,e,n){let r=new cs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new cs(i),t._value=r.times(i).toNumber(),t}function DZ(t,e,n){let r=new cs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new cs(i),t._value=r.dividedBy(i).toNumber(),t}function kZ(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function LZ(t,e,n){let r=n(t._value);return d$(r,e,n),Math.abs(r._value)}var $Z=t=>({add:(e,n)=>HZ(e,n,t),subtract:(e,n)=>d$(e,n,t),multiply:(e,n)=>NZ(e,n,t),divide:(e,n)=>DZ(e,n,t),set:(e,n)=>kZ(e,n,t),difference:(e,n)=>LZ(e,n,t),BigNumber:cs});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const FZ="2.5.0",To=UT(),VZ=BT(),WZ=sZ(Bt),BZ=l$();let _a=AZ(Bt),Ja=$Z(Bt);const jZ=jT;class f${constructor(e){this._value=e}clone(){return Bt(this._value)}format(e={}){return _a.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=jZ.parseFormat(e)),e=_a.formatOrDefault(e,To.currentCurrencyDefaultFormat()),e.output="currency",_a.format(this,e)}formatTime(e={}){return e.output="time",_a.format(this,e)}binaryByteUnits(){return _a.getBinaryByteUnit(this)}decimalByteUnits(){return _a.getDecimalByteUnit(this)}byteUnits(){return _a.getByteUnit(this)}difference(e){return Ja.difference(this,e)}add(e){return Ja.add(this,e)}subtract(e){return Ja.subtract(this,e)}multiply(e){return Ja.multiply(this,e)}divide(e){return Ja.divide(this,e)}set(e){return Ja.set(this,g$(e))}value(){return this._value}valueOf(){return this._value}}function g$(t){let e=t;return Bt.isNumbro(t)?e=t._value:typeof t=="string"?e=Bt.unformat(t):isNaN(t)&&(e=NaN),e}function Bt(t){return new f$(g$(t))}Bt.version=FZ;Bt.isNumbro=function(t){return t instanceof f$};Bt.language=To.currentLanguage;Bt.registerLanguage=To.registerLanguage;Bt.setLanguage=To.setLanguage;Bt.languages=To.languages;Bt.languageData=To.languageData;Bt.zeroFormat=To.setZeroFormat;Bt.defaultFormat=To.currentDefaults;Bt.setDefaults=To.setDefaults;Bt.defaultCurrencyFormat=To.currentCurrencyDefaultFormat;Bt.validate=VZ.validate;Bt.loadLanguagesInNode=WZ.loadLanguagesInNode;Bt.unformat=BZ.unformat;Bt.BigNumber=Ja.BigNumber;var UZ=Bt,Ma=V5(UZ);const zZ="numeric";function m$(t,e){if(Gn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!Ma.languages()[r]){const o=r.replace("-",""),s=Ma.allLanguages?Ma.allLanguages[r]:Ma[o];s&&Ma.registerLanguage(s)}Ma.setLanguage(r),t=Ma(t).format(i||"0")}return t}function YT(t,e,n,r,i,o,s){let a=o;if(Gn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=m$(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}ws(t,e,n,r,i,a,s)}YT.RENDERER_TYPE=zZ;const YZ="password";function GT(t,e,n,r,i,o,s){ws.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";he(a-1,()=>{u+=l}),bc(e,u)}GT.RENDERER_TYPE=YZ;const GZ="select";function qT(t,e,n,r,i,o,s){ws.apply(this,[t,e,n,r,i,o,s])}qT.RENDERER_TYPE=GZ;const qZ="time";function KT(t,e,n,r,i,o,s){ws.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}KT.RENDERER_TYPE=qZ;function KZ(){jr(Tc),jr(Qd),jr(FT),jr($T),jr(WT),jr(LT),jr(YT),jr(GT),jr(qT),jr(ws),jr(KT)}const XZ="autocomplete";function sw(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,bA(n,e)):bA(n,e)(this.source):e(!0)}sw.VALIDATOR_TYPE=XZ;function bA(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function ZZ(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const JZ="date";function XT(t,e){const n=jk(e$,this.instance);let r=t,i=!0;r==null&&(r="");let o=Z(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Z(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=QZ(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}XT.VALIDATOR_TYPE=JZ;function QZ(t,e){const n=Z(ZZ(t)),r=Z(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const eJ="dropdown";function ZT(t,e){sw.apply(this,[t,e])}ZT.VALIDATOR_TYPE=eJ;const tJ="numeric";function JT(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Gn(t))}JT.VALIDATOR_TYPE=tJ;const nJ=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],rJ="time";function QT(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Z(i,nJ,!0).isValid()?Z(i):Z(i,n);let a=s.isValid(),l=Z(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}QT.VALIDATOR_TYPE=rJ;function iJ(){Iu(sw),Iu(ZT),Iu(XT),Iu(JT),Iu(QT)}const oJ="autocomplete",sJ={CELL_TYPE:oJ,editor:DT,renderer:Tc,validator:sw},aJ="checkbox",lJ={CELL_TYPE:aJ,editor:QL,renderer:FT},uJ="date";function p$(t,e,n,r,i,o,s){Tc.apply(this,[t,e,n,r,i,o,s])}p$.RENDERER_TYPE=uJ;const cJ="date",hJ={CELL_TYPE:cJ,editor:t$,renderer:p$,validator:XT},dJ="dropdown",fJ={CELL_TYPE:dJ,editor:n$,renderer:$T,validator:ZT,filter:!1,strict:!0},gJ="handsontable",mJ={CELL_TYPE:gJ,editor:NT,renderer:WT},pJ="numeric",wJ={CELL_TYPE:pJ,editor:r$,renderer:YT,validator:JT,dataType:"number"},vJ="password",CJ={CELL_TYPE:vJ,editor:i$,renderer:GT,copyable:!1},yJ="select",bJ={CELL_TYPE:yJ,editor:o$,renderer:qT},SJ="time",RJ={CELL_TYPE:SJ,editor:s$,renderer:KT,validator:QT};function EJ(){Ci(sJ),Ci(lJ),Ci(hJ),Ci(fJ),Ci(mJ),Ci(wJ),Ci(CJ),Ci(bJ),Ci(KL),Ci(RJ)}function TJ(t,e){w$(t,e),e.add(t)}function _J(t,e,n){w$(t,e),e.set(t,n)}function w$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zl(t,e,n){return(e=MJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MJ(t){var e=IJ(t,"string");return typeof e=="symbol"?e:e+""}function IJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jl(t,e){return t.get(v$(t,e))}function v$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const SA=new Map([["plugin",i3],["cell-type",kL],["editor",Bk],["renderer",Xk],["validator",Zk]]),C$=Symbol("mainSetting"),PJ="base",eg=[];let Ia=null;var Pa=new WeakMap,RA=new WeakSet;class Xe{static get PLUGIN_KEY(){return PJ}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){TJ(this,RA),Zl(this,"eventManager",new Di(this)),Zl(this,"pluginName",null),Zl(this,"pluginsInitializedCallbacks",[]),Zl(this,"isPluginsReady",!1),Zl(this,"enabled",!1),Zl(this,"initialized",!1),_J(this,Pa,{}),ms(this,"hot",e,{writable:!1}),Ia=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!SA.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);SA.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");eg.push(o)}}if(Ia||(Ia=Kk()),Ia.indexOf(this.pluginName)>=0&&Ia.splice(Ia.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ia.length===0){if(eg.length>0){const i=[`${eg.join(`
`)}
`,"You have to import and register them manually."].join("");throw eg.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||Ae(n))&&r[C$]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(Ae(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){Jl(Pa,this)[e]=Jl(Pa,this)[e]||[];const i=Jl(Pa,this)[e];this.hot.addHook(e,n,r),i.push(n),Jl(Pa,this)[e]=i}removeHooks(e){A(Jl(Pa,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Jl(Pa,this);He(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){A(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=v$(RA,this,OJ).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),He(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function OJ(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Oa(t,e,n){return(e=xJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xJ(t){var e=AJ(t,"string");return typeof e=="symbol"?e:e+""}function AJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let y$=class{constructor(e){Oa(this,"hot",null),Oa(this,"container",null),Oa(this,"injected",!1),Oa(this,"rows",[]),Oa(this,"columns",[]),Oa(this,"samples",null),Oa(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&q(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),A(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),A(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{A(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{A(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{A(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),A(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{A(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),q(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function tg(t,e,n){return(e=HJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HJ(t){var e=NJ(t,"string");return typeof e=="symbol"?e:e+""}function NJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aw{static get SAMPLE_COUNT(){return 3}constructor(e){tg(this,"samples",null),tg(this,"dataFactory",null),tg(this,"customSampleCount",null),tg(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:aw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return he(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return he(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Ae(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${It(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function DJ(t,e){b$(t,e),e.add(t)}function db(t,e,n){b$(t,e),e.set(t,n)}function b$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rh(t,e,n){return(e=kJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kJ(t){var e=LJ(t,"string");return typeof e=="symbol"?e:e+""}function LJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ks(t,e){return t.get(hr(t,e))}function jm(t,e,n){return t.set(hr(t,e),n),n}function hr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("modifyAutoColumnSizeSeed");const fb="autoColumnSize",$J=10,FJ="autoColumnSize";var e_=new WeakMap,xu=new WeakMap,uc=new WeakMap,_r=new WeakSet;class Kh extends Xe{static get PLUGIN_KEY(){return fb}static get PLUGIN_PRIORITY(){return $J}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),DJ(this,_r),rh(this,"ghostTable",new y$(this.hot)),rh(this,"samplesGenerator",new aw((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),rh(this,"inProgress",!1),rh(this,"measuredColumns",0),rh(this,"columnWidthsMap",new ha),db(this,e_,!1),db(this,xu,[]),db(this,uc,[]),this.hot.columnIndexMapper.registerMap(FJ,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>hr(_r,this,EA).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[fb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hr(_r,e,BJ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hr(_r,e,jJ).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hr(_r,e,zJ).call(e,...i)}),this.addHook("beforeRender",()=>hr(_r,this,WJ).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>hr(_r,this,UJ).call(this)),super.enablePlugin()}updatePlugin(){jm(uc,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>hr(_r,this,EA).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;he(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&hr(_r,this,S$).call(this,s,o)}),this.ghostTable.columns.length&&(hr(_r,this,R$).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){xm(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Kh.CALCULATION_STEP,i)},e,n),r=r+Kh.CALCULATION_STEP+1,r<i?o=Om(s):(xm(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[fb];let n=Kh.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Ae(e)&&(n=e.syncLimit,hk(n)?n=Yk(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,ic))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Ks(xu,this).length;return(s-1<o||Ks(xu,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Ks(xu,this).push(i):Ks(xu,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function VJ(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||hr(_r,this,S$).call(this,n,e))}),this.ghostTable.columns.length&&(hr(_r,this,R$).call(this),this.ghostTable.clean())}function S$(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function R$(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function WJ(){this.calculateVisibleColumnsWidth(),this.inProgress||(hr(_r,this,VJ).call(this,Ks(uc,this)),jm(uc,this,[]))}function BJ(t,e){e||this.recalculateAllColumnsWidth()}function jJ(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Ks(uc,this).push(...e)}function EA(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function UJ(){jm(xu,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),jm(e_,this,!0)}function zJ(t){if(!Ks(e_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Ks(uc,this).push(...e)}const sl={horizontal:"horizontal",vertical:"vertical"};function YJ(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function GJ(t){const e={};return t===!0?(e.directions=Object.keys(sl),e.autoInsertRow=!0):Ae(t)?(le(t.autoInsertRow)?t.direction===sl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(sl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function qJ(t,e){KJ(t,e),e.add(t)}function KJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ql(t,e,n){return(e=XJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XJ(t){var e=ZJ(t,"string");return typeof e=="symbol"?e:e+""}function ZJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ih(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("modifyAutofillRange");re.getSingleton().register("beforeAutofill");re.getSingleton().register("afterAutofill");const TA="autofill",JJ=20,QJ=["fillHandle"],eQ="insert_row_below",tQ=200;var eu=new WeakSet;class nQ extends Xe{constructor(){super(...arguments),qJ(this,eu),Ql(this,"addingStarted",!1),Ql(this,"mouseDownOnCellCorner",!1),Ql(this,"mouseDragOutside",!1),Ql(this,"handleDraggedCells",0),Ql(this,"directions",[]),Ql(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return TA}static get PLUGIN_PRIORITY(){return JJ}static get SETTING_KEYS(){return[TA,...QJ]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>ih(eu,this,iQ).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>ih(eu,this,rQ).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>ih(eu,this,oQ).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return A(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),A(a,c=>{const h=[];A(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=YJ(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),w=this.hot._createCellRange(h,h,d),C=this.hot.runHooks("beforeAutofill",f,g,w,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let S=C;const v=C;if(["up","left"].indexOf(c)>-1&&!(v.length===1&&v[0].length===0))if(S=[],c==="up"){const T=d.row-h.row+1,M=T%v.length;for(let x=0;x<T;x++)S.push(v[(x+(v.length-M))%v.length])}else{const T=d.col-h.col+1,M=T%v[0].length;for(let x=0;x<v.length;x++){S.push([]);for(let I=0;I<T;I++)S[x].push(v[x][(I+(v[x].length-M))%v[x].length])}}this.hot.populateFromArray(h.row,h.col,S,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",S,g,w,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(sl.vertical)&&this.directions.includes(sl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(sl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(sl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(eQ,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},tQ)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Wt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Wt(s)||!Wt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...We(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Hn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+tn(this.hot.table),i=Hn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Yt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>ih(eu,this,sQ).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>ih(eu,this,aQ).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=GJ(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function rQ(){this.selectAdjacent()&&this.fillIn()}function iQ(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function oQ(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function sQ(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function aQ(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function lQ(t,e){E$(t,e),e.add(t)}function _A(t,e,n){E$(t,e),e.set(t,n)}function E$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tu(t,e,n){return(e=uQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uQ(t){var e=cQ(t,"string");return typeof e=="symbol"?e:e+""}function cQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T$(t,e,n){return t.set(uo(t,e),n),n}function Um(t,e){return t.get(uo(t,e))}function uo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gb="autoRowSize",hQ=40,dQ="autoRowSize";var Rd=new WeakMap,t_=new WeakMap,jo=new WeakSet;class Xh extends Xe{static get PLUGIN_KEY(){return gb}static get PLUGIN_PRIORITY(){return hQ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),lQ(this,jo),tu(this,"headerHeight",null),tu(this,"ghostTable",new y$(this.hot)),tu(this,"samplesGenerator",new aw((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),tu(this,"inProgress",!1),tu(this,"measuredRows",0),tu(this,"rowHeightsMap",new ha),_A(this,Rd,[]),_A(this,t_,!1),this.hot.rowIndexMapper.registerMap(dQ,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>uo(jo,this,MA).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[gb];return e===!0||Ae(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return uo(jo,e,mQ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return uo(jo,e,pQ).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return uo(jo,e,vQ).call(e,...i)}),this.addHook("beforeRender",()=>uo(jo,this,gQ).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>uo(jo,this,wQ).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>uo(jo,this,MA).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}he(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){xm(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Xh.CALCULATION_STEP,i)},e,n),r=r+Xh.CALCULATION_STEP+1,r<i?o=Om(s):(xm(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[gb];let n=Xh.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Ae(e)&&(n=e.syncLimit,hk(n)?n=Yk(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{he(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function fQ(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function gQ(){this.calculateVisibleRowsHeight(),this.inProgress||(uo(jo,this,fQ).call(this,Um(Rd,this)),T$(Rd,this,[]))}function MA(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function mQ(t,e){e||this.recalculateAllRowsHeight()}function pQ(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);Um(Rd,this).push(...e)}function wQ(){this.recalculateAllRowsHeight(),T$(t_,this,!0)}function vQ(t){if(!Um(t_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Um(Rd,this).push(...e)}const{getListWithInsertedItems:CQ,getListWithRemovedItems:yQ}=vL("physicallyIndexed");class bQ extends Dl{constructor(){super(e=>e)}insert(e,n){const r=s0(this.indexedValues,n);this.indexedValues=CQ(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=yQ(this.indexedValues,e);this.indexedValues=o0(n,e),super.remove(e)}}const{getListWithInsertedItems:SQ,getListWithRemovedItems:RQ}=vL("physicallyIndexed");class EQ extends Dl{constructor(){super(e=>e)}insert(e,n){this.indexedValues=SQ(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=RQ(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function TQ(t,e){_Q(t,e),e.add(t)}function _Q(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MQ(t,e,n){return(e=IQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IQ(t){var e=PQ(t,"string");return typeof e=="symbol"?e:e+""}function PQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OQ(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const IA="bindRowsWithHeaders",xQ=210,AQ="loose",PA=new Map([["loose",bQ],["strict",EQ]]);var OA=new WeakSet;class HQ extends Xe{constructor(){super(...arguments),TQ(this,OA),MQ(this,"headerIndexes",null)}static get PLUGIN_KEY(){return IA}static get PLUGIN_PRIORITY(){return xQ}isEnabled(){return!!this.hot.getSettings()[IA]}enablePlugin(){var e;if(this.enabled)return;const n=(e=PA.get(this.getSetting()))!==null&&e!==void 0?e:PA.get(AQ);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>OQ(OA,this,NQ).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function NQ(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function DQ(t,e){_$(t,e),e.add(t)}function kQ(t,e,n){_$(t,e),e.set(t,n)}function _$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xA(t,e,n){return(e=LQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LQ(t){var e=$Q(t,"string");return typeof e=="symbol"?e:e+""}function $Q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AA(t,e){return t.get($u(t,e))}function mb(t,e,n){return t.set($u(t,e),n),n}function $u(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lm="collapsibleColumns",FQ=290,VQ=["nestedHeaders"],qu="collapsibleIndicator",HA=lm,NA=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var nu=new WeakMap,oh=new WeakSet;class WQ extends Xe{constructor(){super(...arguments),DQ(this,oh),xA(this,"nestedHeadersPlugin",null),xA(this,"headerStateManager",null),kQ(this,nu,null)}static get PLUGIN_KEY(){return lm}static get PLUGIN_PRIORITY(){return FQ}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[lm,...VQ]}isEnabled(){return!!this.hot.getSettings()[lm]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Ke("You need to configure the Nested Headers plugin in order to use collapsible headers."),mb(nu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>$u(oh,this,UQ).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return $u(oh,e,zQ).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return $u(oh,e,BQ).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>$u(oh,this,jQ).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),mb(nu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:HA,relativeToGroup:da,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HA)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};he(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;he(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${qu}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${qu}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${qu}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!NA.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=wl(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;A(r,f=>{var g;let{row:w,col:C}=f;const{collapsible:S,isCollapsed:v}=(g=this.headerStateManager.getHeaderSettings(w,C))!==null&&g!==void 0?g:{};if(!S||v&&n==="collapse"||!v&&n==="expand")return i=!1,!1});const o=[],s=[];i&&A(r,f=>{let{row:g,col:w}=f;const{colspanCompensation:C,affectedColumns:S,rollbackModification:v}=this.headerStateManager.triggerNodeModification(n,g,w);C>0&&(s.push(...S),o.push(v))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=rq([...a,...s]):n==="expand"&&(l=wl(a,f=>!s.includes(f)));const u=NA.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){A(o,f=>{f()});return}this.hot.batchExecution(()=>{A(s,f=>{AA(nu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const C=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,S=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;C!==null&&S!==null&&this.hot.selectCell(C,S)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return AA(nu,this).getHiddenIndexes()}destroy(){mb(nu,this,null),super.destroy()}}function BQ(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${qu}`);if(yc(e,[ti("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,qu),e.querySelector("div:first-child").appendChild(u)),we(u,["collapsed","expanded"]),s?(q(u,"collapsed"),Cl(u,"+"),l&&Ce(e,...ti(!1))):(q(u,"expanded"),Cl(u,"-"),l&&Ce(e,...ti(!0))),l&&Ce(u,...Nl());else{var c;(c=u)===null||c===void 0||c.remove()}}function jQ(t,e){ye(t.target,qu)&&(ye(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ye(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Fi(t))}function UQ(){this.updatePlugin()}function zQ(t,e){e||this.updatePlugin()}function xa(t,e,n){return(e=YQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YQ(t){var e=GQ(t,"string");return typeof e=="symbol"?e:e+""}function GQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qQ=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],KQ=!1,XQ=!0,ZQ=!0;class JQ{constructor(e,n){xa(this,"hot",void 0),xa(this,"sortingStates",new Jp),xa(this,"sortEmptyCells",KQ),xa(this,"indicator",XQ),xa(this,"headerAction",ZQ),xa(this,"compareFunctionFactory",void 0),xa(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Ae(e)&&He(e,(n,r)=>{qQ.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Ae(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function M$(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?vo:Wt(i)?Wt(o)?vo:s&&t==="asc"?Nt:Dt:Wt(o)?s&&t==="asc"?Dt:Nt:isNaN(i)&&!isNaN(o)?t==="asc"?Dt:Nt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Nt:Dt:i>o?t==="asc"?Dt:Nt:vo}}const I$="default";function QQ(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return vo;if(a){if(Wt(r))return t==="asc"?Nt:Dt;if(Wt(i))return t==="asc"?Dt:Nt}return isNaN(o)?Dt:isNaN(s)?Nt:o<s?t==="asc"?Nt:Dt:o>s?t==="asc"?Dt:Nt:vo}}const eee="numeric";function tee(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Wt(s),u=Wt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Dt;if(l===!1&&u)return Nt}return d===!1&&f?t==="asc"?Nt:Dt:d&&f===!1?t==="asc"?Dt:Nt:d===!1&&f===!1?M$(t,e,n)(s,a):c===i&&h===r?t==="asc"?Nt:Dt:c===r&&h===i?t==="asc"?Dt:Nt:vo}}const nee="checkbox";function ree(t,e,n){return N$(t,e.dateFormat,n)}const iee="date";function oee(t,e,n){return N$(t,e.timeFormat,n)}const see="time",{register:nf,getItem:DA,hasItem:aee}=li("sorting.compareFunctionFactory"),{register:P$,getItem:lee}=li("sorting.mainSortComparator");function O$(t){return aee(t)?DA(t):DA(I$)}nf(nee,tee);nf(iee,ree);nf(I$,M$);nf(eee,QQ);nf(see,oee);const vo=0,Nt=-1,Dt=1;function uee(t,e){const n=lee(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const zm="asc",Ym="desc",x$="colHeader";function cee(t){if(Ae(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[zm,Ym].includes(n)}function hee(t){if(t.some(n=>cee(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function kA(t){if(t!==Ym)return t===zm?Ym:zm}function A$(t){return t.querySelector(`.${x$}`)}function H$(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function n_(t,e,n){return t===-1&&e>=0&&yl(n)===!1}function N$(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return vo;if(Wt(r))return Wt(i)?vo:o&&t==="asc"?Nt:Dt;if(Wt(i))return o&&t==="asc"?Dt:Nt;const s=Z(r,e),a=Z(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Nt:Dt:a.isBefore(s)?t==="asc"?Dt:Nt:vo:Nt:Dt}}function dee(t,e){Ke(nt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const fee="ascending",gee="descending",D$="indicatorDisabled",k$="columnSorting",L$="sortAction",$$=new Map([[zm,fee],[Ym,gee]]);function mee(t,e,n,r){const i=[k$];if(r&&i.push(L$),n===!1)return i.push(D$),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push($$.get(o)),i}function pee(){return Array.from($$.values()).concat(L$,D$,k$)}function wee(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:O$(u.type))(l,u,d)(c,h)}(0)}}function vee(t,e){Cee(t,e),e.add(t)}function Cee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ng(t,e,n){return(e=yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yee(t){var e=bee(t,"string");return typeof e=="symbol"?e:e+""}function bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Au(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Gm="columnSorting",See=50,qm="append",Ree="replace",LA=Gm;P$(Gm,wee);re.getSingleton().register("beforeColumnSort");re.getSingleton().register("afterColumnSort");const sh=new WeakMap;var Qa=new WeakSet;class F$ extends Xe{constructor(){super(...arguments),vee(this,Qa),ng(this,"columnStatesManager",null),ng(this,"columnMetaCache",null),ng(this,"pluginKey",Gm),ng(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Gm}static get PLUGIN_PRIORITY(){return See}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(sh.has(this.hot)&&sh.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),dee(sh.get(this.hot),this.pluginKey);return}this.enabled||(sh.set(this.hot,this.pluginKey),this.columnStatesManager=new JQ(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ha(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Au(Qa,this,Eee).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Au(Qa,e,_ee).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Au(Qa,this,cR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Au(Qa,e,Tee).call(e,...r)}),this.hot.view&&Au(Qa,this,cR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=A$(r);H$(n,r)===!1||i===null||this.updateHeaderClasses(i)};sh.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:da,position:"before",group:LA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(LA)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new CL),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return hee(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=We(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=We(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=kA(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:kA()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qm;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Mt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===qm)return[...o.slice(0,r),...o.slice(r+1),s];if(n===Ree)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if(Ae(e)){const n=e[this.pluginKey];if(Ae(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):ot(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>We(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=We(n,u=>u[0]);uee(n,this.pluginKey,We(e,u=>u.sortOrder),We(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=We(n,u=>u[0]),a=new Map(We(o,(u,c)=>[u,s[c]])),l=We(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ae(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Ae(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(we(e,pee()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];q(e,mee(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ye(e.target,x$)}onAfterOnCellMouseDown(e,n){if(n_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function cR(){const t=this.getAllSavedSortSettings();if(Ae(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Eee(t,e){const n=A$(e);if(H$(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Ce(e,...Tq(s?`${s}ending`:"none"))}}function Tee(t){t===!0&&this.hot.view&&Au(Qa,this,cR).call(this)}function _ee(t,e,n,r){n_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Aa(t,e,n){return(e=Mee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mee(t){var e=Iee(t,"string");return typeof e=="symbol"?e:e+""}function Iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pee{constructor(e,n){Aa(this,"plugin",void 0),Aa(this,"hot",void 0),Aa(this,"endpoints",[]),Aa(this,"settings",void 0),Aa(this,"settingsType","array"),Aa(this,"currentEndpoint",null),Aa(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),A(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();A(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;A(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?A(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):A(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){A(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];A(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),A(i,o=>{let s=[];A(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,A(e.ranges,r=>{A(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],A(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],A(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],A(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&A(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),A(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ke("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function pb(t){return t==null||isNaN(t)}function Oee(t,e){xee(t,e),e.add(t)}function xee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aee(t,e,n){return(e=Hee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hee(t){var e=Nee(t,"string");return typeof e=="symbol"?e:e+""}function Nee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wb="columnSummary",Dee=220;var ah=new WeakSet;class kee extends Xe{constructor(){super(...arguments),Oee(this,ah),Aee(this,"endpoints",null)}static get PLUGIN_KEY(){return wb}static get PLUGIN_PRIORITY(){return Dee}isEnabled(){return!!this.hot.getSettings()[wb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[wb],this.endpoints=new Pee(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rg(ah,e,Lee).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rg(ah,e,Fee).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rg(ah,e,$ee).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rg(ah,e,Vee).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return He(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=pb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return He(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=pb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=pb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return He(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(nt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function Lee(){this.endpoints.initEndpoints()}function $ee(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function Fee(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Vee(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Wee(t,e){V$(t,e),e.add(t)}function vb(t,e,n){V$(t,e),e.set(t,n)}function V$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hu(t,e){return t.get(r_(t,e))}function hR(t,e,n){return t.set(r_(t,e),n),n}function r_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Km=new WeakMap,ig=new WeakMap,og=new WeakMap,$A=new WeakSet;class W${constructor(){Wee(this,$A),vb(this,Km,!0),vb(this,ig,null),vb(this,og,new ResizeObserver(e=>r_($A,this,Bee).call(this,e)))}setObservedElement(e){hR(ig,this,e)}unobserve(){Hu(og,this).unobserve(Hu(ig,this))}observe(){hR(Km,this,!0),Hu(og,this).observe(Hu(ig,this))}destroy(){Hu(og,this).disconnect()}}function Bee(t){if(Hu(Km,this)||!Array.isArray(t)||!t.length){hR(Km,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}ht(W$,Sn);function bs(t,e,n){jee(t,e),e.set(t,n)}function jee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lt(t,e){return t.get(B$(t,e))}function Gi(t,e,n){return t.set(B$(t,e),n),n}function B$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ru=new WeakMap,Cb=new WeakMap,yb=new WeakMap,Lo=new WeakMap,Ss=new WeakMap,Rs=new WeakMap,sg=new WeakMap,iu=new WeakMap;class al{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,r){var i=this;bs(this,ru,void 0),bs(this,Cb,void 0),bs(this,yb,!1),bs(this,Lo,null),bs(this,Ss,void 0),bs(this,Rs,void 0),bs(this,sg,!0),bs(this,iu,new W$),Gi(ru,this,e),Gi(Cb,this,r),Gi(yb,this,n),Gi(Ss,this,this.createEditor()),Gi(Rs,this,lt(Ss,this).style),lt(iu,this).setObservedElement(this.getInputElement()),lt(iu,this).addLocalHook("resize",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){lt(Rs,this).left=`${e}px`,lt(Rs,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:Yt(this.getInputElement()),height:tn(this.getInputElement())}}observeSize(){lt(iu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){lt(Rs,this).display="block",Gi(sg,this,!1)}hide(){lt(iu,this).unobserve(),lt(sg,this)||(lt(Rs,this).display="none"),Gi(sg,this,!0)}isVisible(){return lt(Rs,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return lt(ru,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=lt(ru,this).createElement("div"),n=lt(ru,this).createElement("textarea");return e.style.display="none",Gi(Lo,this,lt(ru,this).createElement("div")),lt(Lo,this).setAttribute("dir",lt(yb,this)?"rtl":"ltr"),q(lt(Lo,this),al.CLASS_EDITOR_CONTAINER),lt(Cb,this).appendChild(lt(Lo,this)),q(e,al.CLASS_EDITOR),q(n,al.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),lt(Lo,this).appendChild(e),e}getInputElement(){return lt(Ss,this).querySelector(`.${al.CLASS_INPUT}`)}getEditorElement(){return lt(Ss,this)}destroy(){const e=lt(Lo,this)?lt(Lo,this).parentNode:null;lt(Ss,this).parentNode.removeChild(lt(Ss,this)),Gi(Ss,this,null),Gi(Rs,this,null),lt(iu,this).destroy(),e&&e.removeChild(lt(Lo,this))}}ht(al,Sn);function bb(t,e,n){return(e=Uee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uee(t){var e=zee(t,"string");return typeof e=="symbol"?e:e+""}function zee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Yee=250,Gee=250;class j${constructor(e){bb(this,"wasLastActionShow",!0),bb(this,"showDebounced",null),bb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Gee)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yee;this.showDebounced=Yp(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}ht(j$,Sn);function qee(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Kee(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ha(t,e){const n={};return A(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Ls(t,e,n,r,i){A(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Xee(s,a,e,n,r,i)})})}function Xee(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=qee(s.className,r):a=Kee(s.className,r)),o(t,e,"className",a)}function U$(t){return`<span class="selected">✓</span>${t}`}function um(t,e){let n=!1;return Array.isArray(t)&&A(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function lw(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const xe="---------";function Zee(){return{name:xe}}const Gr="alignment";function Jee(){return{key:Gr,name(){return this.getTranslatedPhrase(x0)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Gr}:left`,name(){return this.getTranslatedPhrase(A0)},callback(){const t=this.getSelectedRange(),e=Ha(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Ls(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Gr}:center`,name(){return this.getTranslatedPhrase(H0)},callback(){const t=this.getSelectedRange(),e=Ha(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Ls(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Gr}:right`,name(){return this.getTranslatedPhrase(N0)},callback(){const t=this.getSelectedRange(),e=Ha(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Ls(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Gr}:justify`,name(){return this.getTranslatedPhrase(D0)},callback(){const t=this.getSelectedRange(),e=Ha(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Ls(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:xe},{key:`${Gr}:top`,name(){return this.getTranslatedPhrase(k0)},callback(){const t=this.getSelectedRange(),e=Ha(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Ls(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Gr}:middle`,name(){return this.getTranslatedPhrase(L0)},callback(){const t=this.getSelectedRange(),e=Ha(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Ls(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Gr}:bottom`,name(){return this.getTranslatedPhrase($0)},callback(){const t=this.getSelectedRange(),e=Ha(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Ls(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const uw="clear_column";function Qee(){return{key:uw,name(){return this.getTranslatedPhrase(w0)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const rf="col_left";function ete(){return{key:rf,name(){return this.getTranslatedPhrase(h0)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const of="col_right";function tte(){return{key:of,name(){return this.getTranslatedPhrase(d0)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const sf="make_read_only";function nte(){return{key:sf,checkable:!0,ariaChecked(){return um(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(km)},name(){let t=this.getTranslatedPhrase(km);return um(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=U$(t)),t},callback(){const t=this.getSelectedRange(),e=um(t,(n,r)=>this.getCellMeta(n,r).readOnly);A(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const cw="redo";function rte(){return{key:cw,name(){return this.getTranslatedPhrase(p0)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const af="remove_col";function ite(){return{key:af,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(g0,e)},callback(){this.alter("remove_col",b9(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const hw="remove_row";function ote(){return{key:hw,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(f0,e)},callback(){this.alter("remove_row",S9(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const dw="row_above";function ste(){return{key:dw,name(){return this.getTranslatedPhrase(u0)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const fw="row_below";function ate(){return{key:fw,name(){return this.getTranslatedPhrase(c0)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Ed="no_items";function lte(){return{key:Ed,name(){return this.getTranslatedPhrase(l0)},disabled:!0,isCommand:!1}}const gw="undo";function ute(){return{key:gw,name(){return this.getTranslatedPhrase(m0)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const cte=[dw,fw,rf,of,uw,hw,af,gw,cw,sf,Gr,xe,Ed],hte={[xe]:Zee,[Ed]:lte,[dw]:ste,[fw]:ate,[rf]:ete,[of]:tte,[uw]:Qee,[hw]:ote,[af]:ite,[gw]:ute,[cw]:rte,[sf]:nte,[Gr]:Jee};function z$(){const t={};return He(hte,(e,n)=>{t[n]=e()}),t}function dte(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(I0):this.getTranslatedPhrase(M0)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function fte(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(P0)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function gte(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(O0);return um(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,cm))?U$(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,cm);t.updateCommentMeta(n,r,{[cm]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function mte(t,e){Y$(t,e),e.add(t)}function ou(t,e,n){Y$(t,e),e.set(t,n)}function Y$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pte(t,e,n){return(e=wte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wte(t){var e=vte(t,"string");return typeof e=="symbol"?e:e+""}function vte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xs(t,e,n){return t.set(Tr(t,e),n),n}function Oe(t,e){return t.get(Tr(t,e))}function Tr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xm="comments",Cte=60,qo="comment",$h="value",G$="style",cm="readOnly",lh=Xm,dR=`plugin:${Xm}`;var ct=new WeakMap,so=new WeakMap,mw=new WeakMap,hm=new WeakMap,fR=new WeakMap,Zm=new WeakMap,Br=new WeakSet;class yte extends Xe{constructor(){super(...arguments),mte(this,Br),pte(this,"range",{}),ou(this,ct,null),ou(this,so,null),ou(this,mw,!1),ou(this,hm,!1),ou(this,fR,null),ou(this,Zm,"")}static get PLUGIN_KEY(){return Xm}static get PLUGIN_PRIORITY(){return Cte}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Xm]}enablePlugin(){var e=this;this.enabled||(Oe(ct,this)||(Xs(ct,this,new al(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),Oe(ct,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tr(Br,e,Ite).call(e,...r)}),this.hot.addHook("afterSetTheme",(n,r)=>{r||this.hide()})),Oe(so,this)||Xs(so,this,new j$(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Tr(Br,this,Tte).call(this,n,a)),this.addHook("afterScroll",()=>Tr(Br,this,Pte).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Tr(Br,this,FA).call(this,n)),this.addHook("beforeCompositionStart",n=>Tr(Br,this,FA).call(this,n)),Oe(so,this).addLocalHook("hide",()=>this.hide()),Oe(so,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Oe(so,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(dR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Xs(hm,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(dR),this.hot._registerTimeout(()=>{Xs(hm,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:lh}),r.addShortcut({keys:[["Escape"]],callback:()=>{Oe(ct,this).setValue(Oe(Zm,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Oe(ct,this).isVisible()&&Oe(ct,this).isFocused(),group:lh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Oe(ct,this).isVisible()&&Oe(ct,this).isFocused(),group:lh}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{Oe(ct,this).setValue(Oe(ct,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:lh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Tr(Br,this,Rte).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Tr(Br,this,bte).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Tr(Br,this,Ete).call(this)),this.eventManager.addEventListener(n,"focus",()=>Tr(Br,this,Mte).call(this)),this.eventManager.addEventListener(n,"blur",()=>Tr(Br,this,_te).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Tr(Br,this,Ste).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=vl(e.target,"TD","TBODY");return!!(n&&ye(n,"htCommentCell")&&vl(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Oe(ct,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[$h]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,qo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,$h)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,$h)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Oe(so,this).cancelHiding(),Oe(ct,this).setValue((e=i[qo]?i[qo][$h]:null)!==null&&e!==void 0?e:""),Oe(ct,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Oe(ct,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Oe(ct,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;Oe(ct,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),w=this.getCommentMeta(i,o,G$);w?Oe(ct,this).setSize(w.width,w.height):Oe(ct,this).resetSize();const C=c?0:f.getColumnWidth(a),S=l&&!u?tn(g):0,{left:v,top:T,width:M,height:x}=g.getBoundingClientRect(),{width:I,height:P}=Oe(ct,this).getSize(),{innerWidth:U,innerHeight:K}=this.hot.rootWindow,N=this.hot.rootDocument.documentElement,Y=Cn(this.hot.rootDocument),X=Ak(this.hot.rootWindow)?Y:0,se=Hk(this.hot.rootWindow)?Y:0;let ee=v+h.scrollX+C,te=T+h.scrollY+S;this.hot.isRtl()&&(ee-=I+C),this.hot.isLtr()&&v+M+I>U-X?ee=v+h.scrollX-I-1:this.hot.isRtl()&&ee<-(N.scrollWidth-N.clientWidth)&&(ee=v+h.scrollX+C+1),T+P>K-se&&(te-=P-x+1),Oe(ct,this).setPosition(ee,te),Oe(ct,this).setReadOnlyState(this.getCommentMeta(i,o,cm)),Oe(ct,this).observeSize()}focusEditor(){Oe(ct,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[qo];let o;i?(o=Xn(i),jp(o,r)):o=r,this.hot.setCellMeta(e,n,qo,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[qo])return i[qo][r]}addToContextMenu(e){e.items.push({name:xe},dte(this),fte(this),gte(this))}getEditorInputElement(){return Oe(ct,this).getInputElement()}destroy(){var e,n;(e=Oe(ct,this))===null||e===void 0||e.destroy(),(n=Oe(so,this))===null||n===void 0||n.destroy(),super.destroy()}}function bte(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Oe(mw,this)&&!this.targetIsCommentTextArea(t)){const e=vl(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Ste(t){t.stopPropagation()}function Rte(t){const{rootDocument:e}=this.hot;if(!(Oe(mw,this)||Oe(ct,this).isFocused()||ye(t.target,"wtBorder")||Oe(fR,this)===t.target||!Oe(ct,this)))if(Xs(fR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Oe(so,this).show(n)}else gl(t.target,e)&&!this.targetIsCommentTextArea(t)&&Oe(so,this).hide()}function Ete(){Xs(mw,this,!1)}function Tte(t,e){e[qo]&&e[qo][$h]&&q(t,e.commentedCellClassName)}function _te(){Xs(Zm,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Mte(){Xs(Zm,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(dR)}function Ite(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[G$]:{width:t,height:e}})}function FA(t){Oe(ct,this).isFocused()&&Fi(t)}function Pte(){Oe(hm,this)||this.hide()}function Sb(t,e,n){return(e=Ote(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ote(t){var e=xte(t,"string");return typeof e=="symbol"?e:e+""}function xte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q${constructor(e){Sb(this,"hot",void 0),Sb(this,"commands",{}),Sb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Ate(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Qt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),A(u,c=>c.apply(this.hot,r))}}function Ate(t,e){let n;return A(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Rb(t,e,n){return(e=Hte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hte(t){var e=Nte(t,"string");return typeof e=="symbol"?e:e+""}function Nte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Rb(this,"hot",void 0),Rb(this,"predefinedItems",z$()),Rb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,He(e,(r,i)=>{let o="";r.name===xe?(n[xe]=r,o=xe):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Dte(e,this.defaultOrderPattern,this.predefinedItems)}}function Dte(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ae(i)?He(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Ae(o)?nn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):A(i,(o,s)=>{let a=n[o];!a&&cte.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Ae(o)&&nn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function Es(t,e,n){return(e=kte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kte(t){var e=Lte(t,"string");return typeof e=="symbol"?e:e+""}function Lte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $te{constructor(e,n){Es(this,"top",void 0),Es(this,"topRelative",void 0),Es(this,"left",void 0),Es(this,"leftRelative",void 0),Es(this,"scrollTop",void 0),Es(this,"scrollLeft",void 0),Es(this,"cellHeight",void 0),Es(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function uh(t,e,n){Fte(t,e),e.set(t,n)}function Fte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _e(t,e){return t.get(X$(t,e))}function ag(t,e,n){return t.set(X$(t,e),n),n}function X$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vn=new WeakMap,rr=new WeakMap,ir=new WeakMap,Eb=new WeakMap,su=new WeakMap;class Vte{constructor(e){uh(this,Vn,void 0),uh(this,rr,void 0),uh(this,ir,void 0),uh(this,Eb,!1),uh(this,su,{above:0,below:0,left:0,right:0}),ag(Eb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return _e(su,this)[e]=n,this}setElement(e){return ag(Vn,this,e),this}setParentElement(e){return ag(rr,this,e),this}updatePosition(e){ag(ir,this,new $te(e,_e(Vn,this).ownerDocument.defaultView)),_e(Eb,this)?(_e(ir,this).fitsBelow(_e(Vn,this))?this.setPositionBelowCursor():_e(ir,this).fitsAbove(_e(Vn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){_e(Vn,this).dir==="rtl"?_e(ir,this).fitsOnLeft(_e(Vn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():_e(ir,this).fitsOnRight(_e(Vn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=_e(su,this).above+_e(ir,this).top-_e(Vn,this).offsetHeight;if(_e(rr,this)){const r=_e(rr,this).ownerDocument.defaultView.getComputedStyle(_e(rr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=_e(ir,this).top+_e(ir,this).cellHeight-_e(Vn,this).scrollHeight+i+o}_e(Vn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=_e(su,this).below+_e(ir,this).top+1;if(_e(rr,this)){const r=_e(rr,this).ownerDocument.defaultView.getComputedStyle(_e(rr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=_e(ir,this).top-i-o-1}_e(Vn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=_e(ir,this).left;if(_e(rr,this)){const n=_e(rr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(_e(rr,this).querySelector(".htCore")).borderRightWidth,10);e+=_e(ir,this).cellWidth+r}else e+=_e(su,this).right;_e(Vn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=_e(su,this).left+_e(ir,this).left-_e(Vn,this).offsetWidth;if(_e(rr,this)){const n=_e(rr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(_e(rr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}_e(Vn,this).style.left=`${e}px`}}function Z$(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=je(e,-1,w()-1);function a(S,v){const T=w()-1;return S<0&&(S=T),S>T&&(S=0),o.has(S)?-1:(o.add(S),r(S,!1)===!1&&(S=a(v===1?++S:--S,v)),S)}function l(S){S>-1&&S<w()&&r(S,!0)!==!1&&(s=S)}function u(S){S>-1&&S<w()&&(s=S)}function c(){return s}function h(){w()>0&&(o.clear(),s=a(0,1))}function d(){w()>0&&(o.clear(),s=a(w()-1,-1))}function f(){w()>0&&(o.clear(),s=a(++s,1))}function g(){w()>0&&(o.clear(),s=a(--s,-1))}function w(){return Math.max(n(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:g,getSize:w,clear:C}}function Wte(t){return We(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function gR(t){return Qt(t,"submenu")}function mR(t){return new RegExp(xe,"i").test(t.name)}function dm(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function VA(t){return Qt(t,"disableSelection")}function Bte(t){return ye(t,"htSeparator")}function jte(t){return ye(t,"htSubmenu")}function Ute(t){return ye(t,"htDisabled")}function zte(t){return ye(t,"htSelectionDisabled")}function Yte(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function J$(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Gte(t,e){let n=t.slice(0);return n.reverse(),n=J$(n,e),n.reverse(),n}function qte(t){const e=[];return A(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Kte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xe,n=t.slice(0);return n=J$(n,e),n=Gte(n,e),n=qte(n),n}function Xte(t){return t.checkable===!0}function Zte(t){return Z$({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||Bte(r)||Ute(r)||zte(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Jte(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const Q$="menu",WA=Q$;function Qte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Jte(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:Q$})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${WA}:${u}`:WA}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function ene(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(us(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!dm(a,t)&&!VA(a)&&!mR(a);Ce(n,[...Xte(a)?[pq(),tc(c),Ck(h)]:[mq(),tc(u)],...d?[ua(-1)]:[],...dm(a,t)?[Rq()]:[],...gR(a)?[ti(!1)]:[]])}n.className="",n.appendChild(l),mR(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):bc(l,u),dm(a,t)?q(n,"htDisabled"):VA(a)?q(n,"htSelectionDisabled"):gR(a)&&q(n,"htSubmenu")}}function Tb(t,e,n){tne(t,e),e.set(t,n)}function tne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qi(t,e,n){return(e=nne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nne(t){var e=rne(t,"string");return typeof e=="symbol"?e:e+""}function rne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _b(t,e,n){return t.set(eF(t,e),n),n}function Ts(t,e){return t.get(eF(t,e))}function eF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const BA=215;var au=new WeakMap,lg=new WeakMap,ug=new WeakMap;class _c{get tableBorderWidth(){return Ts(ug,this)===void 0&&this.hotMenu&&_b(ug,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Ts(ug,this)}constructor(e,n){var r=this;qi(this,"hot",void 0),qi(this,"options",void 0),qi(this,"eventManager",new Di(this)),qi(this,"container",void 0),qi(this,"positioner",void 0),qi(this,"hotMenu",null),qi(this,"hotSubMenus",{}),qi(this,"parentMenu",void 0),qi(this,"menuItems",null),qi(this,"origOutsideClickDeselects",null),Tb(this,au,void 0),Tb(this,lg,void 0),Tb(this,ug,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:BA,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new Vte(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(we(this.options.container,/ht-theme-.*/g),q(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=nc(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Ts(au,this)}getKeyboardShortcutsCtrl(){return Ts(lg,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Yp(a=>this.openSubMenu(a),300),n=this.options.minWidth||BA;let r=!1,i=wl(this.menuItems,a=>(a.key===Ed&&(r=!0),Yte(a,this.hot)));if(i.length<1&&!r)i.push(z$()[Ed]);else if(i.length===0)return;i=Kte(i,xe);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:ene(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?Ts(au,this).setCurrentPage(l.row):Ts(au,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),YS()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!YS()||!yl(a))&&o&&this.hasSelectedItem()&&(po()||Rk()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),_b(au,this,Zte(this.hotMenu)),_b(lg,this,Qte(this)),Ts(lg,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Ts(au,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Ce(r,[ti(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!jte(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new _c(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Ce(n,[ti(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ce(i,[ti(!1)])}}closeAllSubMenus(){A(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Wte(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||mR(e)||dm(e,this.hot)||gR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=vr(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?tn(this.hotMenu.getCell(u,0)):0;return a+(l.name===xe?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(ot(r)&&(r=r.call(this.hot),r===null||Mt(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),q(i,`htMenu handsontable ${this.options.className}`),r&&q(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ce(this.hotMenu.rootElement,[gq(),ua(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!gl(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!gl(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ye(e.target,"htCore")&&gl(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ht(_c,Sn);function ine(t,e){one(t,e),e.add(t)}function one(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mb(t,e,n){return(e=sne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sne(t){var e=ane(t,"string");return typeof e=="symbol"?e:e+""}function ane(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fh="contextMenu",lne=70,jA=Fh;re.getSingleton().register("afterContextMenuDefaultOptions");re.getSingleton().register("beforeContextMenuShow");re.getSingleton().register("afterContextMenuShow");re.getSingleton().register("afterContextMenuHide");re.getSingleton().register("afterContextMenuExecute");var ch=new WeakSet;class pw extends Xe{constructor(){super(...arguments),ine(this,ch),Mb(this,"commandExecutor",new q$(this.hot)),Mb(this,"itemsFactory",null),Mb(this,"menu",null)}static get PLUGIN_KEY(){return Fh}static get PLUGIN_PRIORITY(){return lne}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[dw,fw,xe,rf,of,xe,hw,af,xe,gw,cw,xe,sf,xe,Gr]}isEnabled(){return!!this.hot.getSettings()[Fh]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Fh];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new _c(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>cg(ch,this,cne).call(this)),this.menu.addLocalHook("afterOpen",()=>cg(ch,this,hne).call(this)),this.menu.addLocalHook("afterClose",()=>cg(ch,this,dne).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>cg(ch,this,une).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=lw(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:jA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jA)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;He(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new K$(this.hot,pw.DEFAULT_ITEMS);const e=this.hot.getSettings()[Fh],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),A(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function une(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ye(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(ye(o,"current")&&ye(o,"wtBorder"))))return;const s=lw(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function cne(){this.hot.runHooks("beforeContextMenuShow",this)}function hne(){this.hot.runHooks("afterContextMenuShow",this)}function dne(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}pw.SEPARATOR={name:xe};function fne(t){return{key:"copy",name(){return this.getTranslatedPhrase(v0)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function gne(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(b0,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function mne(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(y0,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function pne(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(C0,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function wne(t){return{key:"cut",name(){return this.getTranslatedPhrase(S0)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class vne{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Cne{constructor(){this.clipboardData=new vne}preventDefault(){}composedPath(){return[]}}function yne(t,e){tF(t,e),e.add(t)}function lu(t,e,n){tF(t,e),e.set(t,n)}function tF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jn(t,e){return t.get(Fu(t,e))}function uu(t,e,n){return t.set(Fu(t,e),n),n}function Fu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _s=new WeakMap,Ib=new WeakMap,hh=new WeakMap,pR=new WeakMap,wR=new WeakMap,dh=new WeakMap,fh=new WeakSet;class bne{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;yne(this,fh),lu(this,_s,void 0),lu(this,Ib,void 0),lu(this,hh,void 0),lu(this,pR,void 0),lu(this,wR,void 0),lu(this,dh,void 0),uu(Ib,this,n),uu(hh,this,r),uu(pR,this,i),uu(wR,this,o),uu(dh,this,s)}setSelectedRange(e){uu(_s,this,e)}getCellsRange(){if(jn(Ib,this).call(this)===0||jn(hh,this).call(this)===0)return null;const{row:e,col:n}=jn(_s,this).getTopStartCorner(),{row:r,col:i}=jn(_s,this).getBottomEndCorner(),o=Fu(fh,this,Sne).call(this,e,r),s=Fu(fh,this,Pb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(jn(hh,this).call(this)===0||jn(dh,this).call(this)===0)return null;const{col:e}=jn(_s,this).getTopStartCorner(),{col:n}=jn(_s,this).getBottomEndCorner(),r=Fu(fh,this,Pb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(jn(hh,this).call(this)===0||jn(dh,this).call(this)===0)return null;const{col:e}=jn(_s,this).getTopStartCorner(),{col:n}=jn(_s,this).getBottomEndCorner(),r=Fu(fh,this,Pb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-jn(dh,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Pb(t,e){return Math.min(e,Math.max(t+jn(wR,this).call(this)-1,t))}function Sne(t,e){return Math.min(e,Math.max(t+jn(pR,this).call(this)-1,t))}function nF(t){const e=[],n=[];return A(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);he(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);he(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Rne(t,e){rF(t,e),e.add(t)}function Ms(t,e,n){rF(t,e),e.set(t,n)}function rF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gh(t,e,n){return(e=Ene(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ene(t){var e=Tne(t,"string");return typeof e=="symbol"?e:e+""}function Tne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cr(t,e){return t.get(dr(t,e))}function yi(t,e,n){return t.set(dr(t,e),n),n}function dr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("afterCopyLimit");re.getSingleton().register("modifyCopyableRange");re.getSingleton().register("beforeCut");re.getSingleton().register("afterCut");re.getSingleton().register("beforePaste");re.getSingleton().register("afterPaste");re.getSingleton().register("beforeCopy");re.getSingleton().register("afterCopy");const Ob="copyPaste",_ne=80,Mne=["fragmentSelection"],UA=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var vR=new WeakMap,CR=new WeakMap,yR=new WeakMap,cu=new WeakMap,hg=new WeakMap,dg=new WeakMap,hu=new WeakMap,Jm=new WeakMap,Mr=new WeakSet;class Ine extends Xe{constructor(){super(...arguments),Rne(this,Mr),gh(this,"columnsLimit",1/0),gh(this,"rowsLimit",1/0),gh(this,"pasteMode","overwrite"),gh(this,"uiContainer",this.hot.rootDocument.body),Ms(this,vR,!1),Ms(this,CR,!1),Ms(this,yR,!1),Ms(this,cu,"cells-only"),Ms(this,hg,!1),Ms(this,dg,!1),Ms(this,hu,new bne({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ms(this,Jm,!1),gh(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Ob}static get SETTING_KEYS(){return[Ob,...Mne]}static get PLUGIN_PRIORITY(){return _ne}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Ob]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),yi(vR,this,this.getSetting("copyColumnHeaders")),yi(CR,this,this.getSetting("copyColumnGroupHeaders")),yi(yR,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>dr(Mr,this,xne).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return dr(Mr,r,Ane).call(r,...o)}),this.addHook("afterSelectionEnd",()=>dr(Mr,this,Hne).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),vd()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return dr(Mr,r,Nne).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return dr(Mr,r,Dne).call(r,...o)}),this.addHook("afterSelection",()=>dr(Mr,this,kne).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";yi(cu,this,e),yi(hg,this,!0),dr(Mr,this,zA).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){yi(dg,this,!0),dr(Mr,this,zA).call(this,"cut")}getRangedCopyableData(e){return Yh(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=nF(e);return A(r,o=>{const s=[];A(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new Cne;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}cr(hu,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);cr(cu,this)==="column-headers-only"?n.set("headers",cr(hu,this).getMostBottomColumnHeadersRange()):(cr(cu,this)==="with-column-headers"?n.set("headers",cr(hu,this).getMostBottomColumnHeadersRange()):cr(cu,this)==="with-column-group-headers"&&n.set("headers",cr(hu,this).getAllColumnHeadersRange()),n.set("cells",cr(hu,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:w}=this.hot.getCellMeta(c,a);if(c=w+1,g===!0)continue;d=w,h=a;const C=[],S=o.length%r;for(;C.length<i||h<=u;){const{skipColumnOnPaste:v,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,v===!0)continue;f=T;const M=C.length%i;C.push(e[S][M])}o.push(C)}return yi(Jm,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!cr(hg,this)||this.isEditorOpened()||as(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!im(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),yi(hg,this,!1);const o=this.getRangedData(this.copyableRanges),s=dr(Mr,this,Pne).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=Yh(o);if(e&&e.clipboardData){const u=Ix(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[UA,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}yi(cu,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!cr(dg,this)||this.isEditorOpened()||as(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!im(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),yi(dg,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=Yh(o);if(e&&e.clipboardData){const l=Ix(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[UA,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||as(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!im(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=ME(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=GK(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=M9(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function zA(t){if(vd()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&tK(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Pne(t){const{rows:e}=nF(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function One(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&kk(r)}}}function iF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&Lk(r)}}}function xne(t){t.items.push({name:"---------"},fne(this)),cr(vR,this)&&t.items.push(pne(this)),cr(CR,this)&&t.items.push(mne(this)),cr(yR,this)&&t.items.push(gne(this)),t.items.push(wne(this))}function Ane(t,e,n,r,i){cr(Jm,this)&&(i.value=!0),yi(Jm,this,!1)}function Hne(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Nne(){dr(Mr,this,iF).call(this)}function Dne(){dr(Mr,this,One).call(this)}function kne(){dr(Mr,this,iF).call(this)}function oF(t,e){return`border_row${t}col${e}`}function Vh(){return{width:1,color:"#000"}}function ts(){return{hide:!0}}function Lne(){return{width:1,color:"#000",cornerVisible:!1}}function xb(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function mh(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function Ab(t,e){return{id:oF(t,e),border:Lne(),row:t,col:e,top:ts(),bottom:ts(),start:ts(),end:ts()}}function $ne(t,e){return Qt(e,"border")&&e.border&&(t.border=e.border),Qt(e,"top")&&le(e.top)&&(e.top?(Ae(e.top)||(e.top=Vh()),t.top=e.top):(e.top=ts(),t.top=e.top)),Qt(e,"bottom")&&le(e.bottom)&&(e.bottom?(Ae(e.bottom)||(e.bottom=Vh()),t.bottom=e.bottom):(e.bottom=ts(),t.bottom=e.bottom)),Qt(e,"start")&&le(e.start)&&(e.start?(Ae(e.start)||(e.start=Vh()),t.start=e.start):(e.start=ts(),t.start=e.start)),Qt(e,"end")&&le(e.end)&&(e.end?(Ae(e.end)||(e.end=Vh()),t.end=e.end):(e.end=ts(),t.end=e.end)),t}function hs(t,e){let n=!1;return A(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Qt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function ww(t){return`<span class="selected">✓</span>${t}`}function Fne(t){return t.some(e=>le(e.left)||le(e.right))}function Vne(t){return t.some(e=>le(e.start)||le(e.end))}const Wne=new Map([["left","start"],["right","end"]]);function Bne(t){var e;return(e=Wne.get(t))!==null&&e!==void 0?e:t}function jne(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(B0);return hs(this,"bottom")&&(e=ww(e)),e},callback(e,n){const r=hs(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function Une(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(j0);return hs(this,e)&&(n=ww(n)),n},callback(n,r){const i=hs(this,e);t.prepareBorder(r,e,i)}}}function zne(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(U0)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!hs(this)}}}function Yne(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(W0);return hs(this,e)&&(n=ww(n)),n},callback(n,r){const i=hs(this,e);t.prepareBorder(r,e,i)}}}function Gne(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(V0);return hs(this,"top")&&(e=ww(e)),e},callback(e,n){const r=hs(this,"top");t.prepareBorder(n,"top",r)}}}function qne(t,e){Kne(t,e),e.add(t)}function Kne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xne(t,e,n){return(e=Zne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zne(t){var e=Jne(t,"string");return typeof e=="symbol"?e:e+""}function Jne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fm="customBorders",Qne=90;var Hb=new WeakSet;class ere extends Xe{constructor(){super(...arguments),qne(this,Hb),Xne(this,"savedBorders",[])}static get PLUGIN_KEY(){return fm}static get PLUGIN_PRIORITY(){return Qne}isEnabled(){return!!this.hot.getSettings()[fm]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>YA(Hb,this,tre).call(this,e)),this.addHook("init",()=>YA(Hb,this,nre).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=xb(n));const o=oc(e),s=bd(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});A(e,a=>{s(a).forAll((l,u)=>{A(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,Bne(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=oc(e),r=bd(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return A(e,o=>{r(o).forAll((s,a)=>{A(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(mh(l))})})}),i}clearBorders(e){e?this.setBorders(e):(A(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Ab(e,n);r&&(a=$ne(a,r),A(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",mh(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);he(e.from.row,r,o=>{he(e.from.col,i,s=>{const a=Ab(o,s);let l=0;o===e.from.row&&Qt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Qt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Qt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Qt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",mh(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=oF(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Ab(e,n):o=xb(o),i?(o[r]=ts(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",mh(o)))):(o[r]=Vh(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",mh(o)))}prepareBorder(e,n,r){A(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":he(o.col,s.col,a=>{he(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":he(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":he(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":he(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":he(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){A(e,n=>{const r=xb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return vr([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=We(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){A(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){A(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=We(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):A(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return A(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return A(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):A(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);A(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[fm];if(Array.isArray(e)){const n=Xn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Fne(e),r=Vne(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function tre(t){this.hot.getSettings()[fm]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(F0)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Gne(this),Yne(this),jne(this),Une(this),zne(this)]}})}function nre(){this.changeBorderSettings()}function rre(t,e){ire(t,e),e.add(t)}function ire(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nb(t,e,n){return(e=ore(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ore(t){var e=sre(t,"string");return typeof e=="symbol"?e:e+""}function sre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qA="dragToScroll",are=100;var Db=new WeakSet;class lre extends Xe{constructor(){super(...arguments),rre(this,Db),Nb(this,"boundaries",null),Nb(this,"callback",null),Nb(this,"listening",!1)}static get PLUGIN_KEY(){return qA}static get PLUGIN_PRIORITY(){return are}isEnabled(){return!!this.hot.getSettings()[qA]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>GA(Db,this,KA).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>GA(Db,this,KA).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=nc(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function KA(t){if(yl(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function ure(t,e){sF(t,e),e.add(t)}function cre(t,e,n){sF(t,e),e.set(t,n)}function sF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kb(t,e,n){return(e=hre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hre(t){var e=dre(t,"string");return typeof e=="symbol"?e:e+""}function dre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fre(t,e){return t.get(qr(t,e))}function aF(t,e,n){return t.set(qr(t,e),n),n}function qr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("afterDropdownMenuDefaultOptions");re.getSingleton().register("beforeDropdownMenuShow");re.getSingleton().register("afterDropdownMenuShow");re.getSingleton().register("afterDropdownMenuHide");re.getSingleton().register("afterDropdownMenuExecute");const gm="dropdownMenu",gre=230,Td="changeType",Lb=gm;var vw=new WeakMap,Ri=new WeakSet;class Cw extends Xe{static get PLUGIN_KEY(){return gm}static get PLUGIN_PRIORITY(){return gre}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[rf,of,xe,af,xe,uw,xe,sf,xe,Gr]}constructor(e){super(e),ure(this,Ri),kb(this,"commandExecutor",new q$(this.hot)),kb(this,"itemsFactory",null),kb(this,"menu",null),cre(this,vw,!1),this.hot.addHook("afterGetColHeader",(n,r)=>qr(Ri,this,pre).call(this,n,r))}isEnabled(){return this.hot.getSettings()[gm]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new K$(this.hot,Cw.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return qr(Ri,e,Sre).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return qr(Ri,e,bre).call(e,...o)});const n=this.hot.getSettings()[gm],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new _c(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>qr(Ri,this,wre).call(this)),this.menu.addLocalHook("afterOpen",()=>qr(Ri,this,vre).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>qr(Ri,this,Cre).call(this,o)),this.menu.addLocalHook("afterClose",()=>qr(Ri,this,yre).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),A(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=lw(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${Td}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Lb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Lb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Lb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>qr(Ri,this,mre).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),He(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function lF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function mre(t){if(ye(t.target,Td)){const e=lw(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),aF(vw,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function pre(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Td}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Td,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ce(s,[Nl(),tc(" ")]),Ce(e,[pk("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function wre(){this.hot.runHooks("beforeDropdownMenuShow",this)}function vre(){this.hot.runHooks("afterDropdownMenuShow",this),qr(Ri,this,lF).call(this,this.menu)}function Cre(t){qr(Ri,this,lF).call(this,t)}function yre(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function bre(t){return fre(vw,this)?null:t}function Sre(t){ye(t.target,Td)&&aF(vw,this,!0)}Cw.SEPARATOR={name:xe};function XA(t,e,n){return(e=Rre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rre(t){var e=Ere(t,"string");return typeof e=="symbol"?e:e+""}function Ere(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tre{constructor(e){XA(this,"hot",void 0),XA(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return he(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(he(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();he(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();he(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function ZA(t,e,n){return(e=_re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _re(t){var e=Mre(t,"string");return typeof e=="symbol"?e:e+""}function Mre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class i_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){ZA(this,"dataProvider",void 0),ZA(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=yo(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=nn(yo(i_.DEFAULT_OPTIONS),n),n=nn(n,e),n.filename=dk(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function Ire(t,e){Pre(t,e),e.add(t)}function Pre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uF="\r",Ore='"',xre=`
`,Are="=",Hre="+",Nre="-",Dre="@",kre="	";var $b=new WeakSet;class Lre extends i_{constructor(){super(...arguments),Ire(this,$b)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=We(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),A(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=It(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=JA($b,this,Fre).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=JA($b,this,$re).call(this,i)),(n||i.indexOf(uF)>=0||i.indexOf(Ore)>=0||i.indexOf(xre)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function $re(t){return t.startsWith(Are)||t.startsWith(Hre)||t.startsWith(Nre)||t.startsWith(Dre)||t.startsWith(kre)||t.startsWith(uF)?`'${t}`:t}function Fre(t,e){return e.test(t)?`'${t}`:t}const Vre="csv",bR={[Vre]:Lre};function Wre(t,e,n){return typeof bR[t]=="function"?new bR[t](e,n):null}const Bre="exportFile",jre=240;class Ure extends Xe{static get PLUGIN_KEY(){return Bre}static get PLUGIN_PRIORITY(){return jre}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!bR[e])throw new Error(`Export format type "${e}" is not supported.`);return Wre(e,new Tre(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function du(t,e,n){return(e=zre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zre(t){var e=Yre(t,"string");return typeof e=="symbol"?e:e+""}function Yre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lf{constructor(e,n){let{id:r,stateless:i=!0}=n;du(this,"hot",void 0),du(this,"id",void 0),du(this,"elements",[]),du(this,"hidden",!1),du(this,"stateId",""),du(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Jp)}getElements(){return this.elements}reset(){A(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),A(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ht(lf,Sn);const _d={};function ia(t,e){if(!_d[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=_d[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function ll(t){if(!_d[t])throw Error(`Filter condition "${t}" does not exist.`);return _d[t].descriptor}function Kt(t,e,n){n.key=t,_d[t]={condition:e,descriptor:n}}const vn="none";function Gre(){return!0}Kt(vn,Gre,{name:Qp,inputsCount:0,showOperators:!1});const Zh="empty";function qre(t){return Wt(t.value)}Kt(Zh,qre,{name:Z0,inputsCount:0,showOperators:!0});const mm="not_empty";function Kre(t,e){return!ia(Zh,e)(t)}Kt(mm,Kre,{name:J0,inputsCount:0,showOperators:!0});const Jh="eq";function Xre(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale)===It(n)}Kt(Jh,Xre,{name:Q0,inputsCount:1,showOperators:!0});const pm="neq";function Zre(t,e){return!ia(Jh,e)(t)}Kt(pm,Zre,{name:eT,inputsCount:1,showOperators:!0});const cF="gt";function Jre(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Kt(cF,Jre,{name:oT,inputsCount:1,showOperators:!0});const hF="gte";function Qre(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Kt(hF,Qre,{name:sT,inputsCount:1,showOperators:!0});const dF="lt";function eie(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Kt(dF,eie,{name:aT,inputsCount:1,showOperators:!0});const fF="lte";function tie(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Kt(fF,tie,{name:lT,inputsCount:1,showOperators:!0});const o_="date_after";function nie(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Kt(o_,nie,{name:hT,inputsCount:1,showOperators:!0});const s_="date_before";function rie(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Kt(s_,rie,{name:dT,inputsCount:1,showOperators:!0});const Qm="between";function iie(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=ia(s_,[o]),a=ia(o_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Kt(Qm,iie,{name:uT,inputsCount:2,showOperators:!0});const gF="not_between";function oie(t,e){return!ia(Qm,e)(t)}Kt(gF,oie,{name:cT,inputsCount:2,showOperators:!0});const mF="begins_with";function sie(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).startsWith(It(n))}Kt(mF,sie,{name:tT,inputsCount:1,showOperators:!0});const pF="ends_with";function aie(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).endsWith(It(n))}Kt(pF,aie,{name:nT,inputsCount:1,showOperators:!0});const a_="contains";function lie(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).indexOf(It(n))>=0}Kt(a_,lie,{name:rT,inputsCount:1,showOperators:!0});const wF="not_contains";function uie(t,e){return!ia(a_,e)(t)}Kt(wF,uie,{name:iT,inputsCount:1,showOperators:!0});const vF="date_tomorrow";function cie(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}Kt(vF,cie,{name:gT,inputsCount:0});const CF="date_today";function hie(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}Kt(CF,hie,{name:fT,inputsCount:0});const yF="date_yesterday";function die(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}Kt(yF,die,{name:mT,inputsCount:0});$q();function fie(t,e){let n=t;return n===""&&(n=`(${e})`),n}function uf(t){const e=new Set(t);return function(n){return e.has(n)}}function l_(t){return t??""}function SR(t){return Array.from(new Set(t)).map(e=>l_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function QA(t,e,n,r){const i=[],o=t===e;let s;return o||(s=uf(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:fie(a,n)};r&&r(u),i.push(u)}),i}const ul="by_value";function gie(t,e){let[n]=e;return n(t.value)}Kt(ul,gie,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[uf(e)]},showOperators:!1});const Md={};function mie(t){if(!Md[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Md[t].func;return function(n,r){return e(n,r)}}function pie(t){return Md[t].name}function u_(t,e,n){Md[t]={name:e,func:n}}const na="conjunction",wie=vT;function vie(t,e){return t.every(n=>n.func(e))}u_(na,wie,vie);const ep="disjunction",Cie=ew;function yie(t,e){return t.some(n=>n.func(e))}u_(ep,Cie,yie);const c_="disjunctionWithExtraCondition",bie=ew;function Sie(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}u_(c_,bie,Sie);const Rie="numeric",bF="text",Eie="date",eH={[Rie]:[vn,xe,Zh,mm,xe,Jh,pm,xe,cF,hF,dF,fF,Qm,gF],[bF]:[vn,xe,Zh,mm,xe,Jh,pm,xe,mF,pF,xe,a_,wF],[Eie]:[vn,xe,Zh,mm,xe,Jh,pm,xe,s_,o_,Qm,xe,vF,CF,yF]};function Tie(t){const e=[];let n=t;return eH[n]||(n=bF),A(eH[n],r=>{let i;r===xe?i={name:xe}:i=yo(ll(r)),e.push(i)}),e}function ph(t,e,n){return(e=_ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ie(t){var e=Mie(t,"string");return typeof e=="symbol"?e:e+""}function Mie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Fb="built",Vb="building",tH=["click","input","keydown","keypress","keyup","focus","blur","change"];let xi=class SF{static get DEFAULTS(){return yo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){ph(this,"hot",void 0),ph(this,"eventManager",new Di(this)),ph(this,"options",void 0),ph(this,"_element",void 0),ph(this,"buildState",void 0),this.hot=e,this.options=nn(SF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Vb?this._element:this.buildState===Fb?(this.update(),this._element):(this.buildState=Vb,this.build(),this.buildState=Fb,this._element)}isBuilt(){return this.buildState===Fb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Zn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Vb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)A(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),He(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),A(tH,r=>e(n,r))}else A(tH,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ht(xi,Sn);function Iie(t,e){RF(t,e),e.add(t)}function Pie(t,e,n){RF(t,e),e.set(t,n)}function RF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fg(t,e){return t.get(h_(t,e))}function Oie(t,e,n){return t.set(h_(t,e),n),n}function h_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fu=new WeakMap,nH=new WeakSet;class ra extends xi{static get DEFAULTS(){return yo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,nn(ra.DEFAULTS,n)),Iie(this,nH),Pie(this,fu,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>h_(nH,this,xie).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Oie(fu,this,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(fg(fu,this).type=this.options.type,fg(fu,this).placeholder=this.translateIfPossible(this.options.placeholder),fg(fu,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&fg(fu,this).focus()}}function xie(t){this.options.value=t.target.value}function Aie(t,e){EF(t,e),e.add(t)}function wh(t,e,n){EF(t,e),e.set(t,n)}function EF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gu(t,e,n){return t.set(Qh(t,e),n),n}function Pt(t,e){return t.get(Qh(t,e))}function Qh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cn=new WeakMap,gg=new WeakMap,mg=new WeakMap,Wb=new WeakMap,pg=new WeakMap,wg=new WeakSet;class Id extends xi{static get DEFAULTS(){return yo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,nn(Id.DEFAULTS,n)),Aie(this,wg),wh(this,cn,null),wh(this,gg,[]),wh(this,mg,void 0),wh(this,Wb,void 0),wh(this,pg,void 0),this.registerHooks()}getMenu(){return Pt(cn,this)}registerHooks(){this.addLocalHook("click",()=>Qh(wg,this,Die).call(this))}setItems(e){gu(gg,this,this.translateNames(e)),Pt(cn,this)&&Pt(cn,this).setMenuItems(Pt(gg,this))}translateNames(e){return A(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),gu(cn,this,new _c(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Pt(cn,this).setMenuItems(Pt(gg,this));const e=new xi(this.hot,{className:"htUISelectCaption"}),n=new xi(this.hot,{className:"htUISelectDropdown"});gu(mg,this,e),gu(Wb,this,e.element),gu(pg,this,n),this.hot.getSettings().ariaTags&&(Ce(n.element,[Nl()]),Ce(this._element,[mk()])),A([e,n],r=>this._element.appendChild(r.element)),Pt(cn,this).addLocalHook("select",r=>Qh(wg,this,Hie).call(this,r)),Pt(cn,this).addLocalHook("afterClose",()=>Qh(wg,this,Nie).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Pt(cn,this).hot.getTranslatedPhrase(Qp),Pt(Wb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Pt(cn,this)&&(Pt(cn,this).open(),Pt(cn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Pt(cn,this).getNavigator().toFirstItem(),Pt(cn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Pt(cn,this)&&Pt(cn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Pt(cn,this)&&(Pt(cn,this).destroy(),gu(cn,this,null)),Pt(mg,this)&&Pt(mg,this).destroy(),Pt(pg,this)&&Pt(pg,this).destroy(),super.destroy()}}function Hie(t){t.name!==xe&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Nie(){this.runLocalHooks("afterClose")}function Die(){this.openOptions()}function kie(t,e){Lie(t,e),e.add(t)}function Lie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rH(t,e,n){return(e=$ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ie(t){var e=Fie(t,"string");return typeof e=="symbol"?e:e+""}function Fie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bb=new WeakSet;class RR extends lf{constructor(e,n){super(e,{id:n.id,stateless:!1}),kie(this,Bb),rH(this,"name",""),rH(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Id(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ra(this.hot,{placeholder:ET})),this.elements.push(new ra(this.hot,{placeholder:TT})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>iH(Bb,this,Vie).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),A(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>iH(Bb,this,Wie).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=yo(e.command);n.name.startsWith(kt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),A(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||ll(vn),n=[];return A(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=ll(e?e.name:vn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||A(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Id)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ra)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||A(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[ll(vn)];if(e!==null){const{visualIndex:r}=e;n=Tie(this.hot.getDataType(0,r,this.hot.countRows(),r))}A(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Vie(t){A(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Wie(t){qd(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Fi(t))}function oH(t,e,n){Bie(t,e),e.set(t,n)}function Bie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vh(t,e){return t.get(TF(t,e))}function sH(t,e,n){return t.set(TF(t,e),n),n}function TF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mu=new WeakMap,jb=new WeakMap;class tp extends xi{static get DEFAULTS(){return yo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,nn(tp.DEFAULTS,n)),oH(this,mu,void 0),oH(this,jb,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),sH(jb,this,e),sH(mu,this,this._element.firstChild),vh(mu,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(vh(jb,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?vh(mu,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(vh(mu,this).checked=e)}focus(){this.isBuilt()&&vh(mu,this).focus()}}function jie(t,e){Uie(t,e),e.add(t)}function Uie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zie(t,e,n){return(e=Yie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yie(t){var e=Gie(t,"string");return typeof e=="symbol"?e:e+""}function Gie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qie(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const aH=0;var lH=new WeakSet;class Kie extends lf{constructor(e,n){super(e,{id:n.id,stateless:!1}),jie(this,lH),zie(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),A(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[na,ep];A(e,n=>{const r=new tp(this.hot,{name:"operator",label:{htmlFor:n,textContent:pie(n)},value:n,checked:n===e[aH],id:n});r.addLocalHook("change",i=>qie(lH,this,Xie).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(nt`Radio button with index ${e} doesn't exist.`);A(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof tp&&n.isChecked());return e?e.getValue():na}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&A(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:na,n=arguments.length>1?arguments[1]:void 0,r=e;r===c_&&(r=ep),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(aH)}}function Xie(t){this.setState(t.target.value)}function Zie(t,e,n){Jie(t,e),e.set(t,n)}function Jie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ub(t,e){return t.get(_F(t,e))}function Qie(t,e,n){return t.set(_F(t,e),n),n}function _F(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ch=new WeakMap;class Pd extends xi{static get DEFAULTS(){return yo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,nn(Pd.DEFAULTS,n)),Zie(this,Ch,void 0)}build(){super.build(),Qie(Ch,this,this._element.firstChild)}update(){this.isBuilt()&&(Ub(Ch,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Ub(Ch,this).focus()}activate(){Ub(Ch,this).click()}}function eoe(t,e){MF(t,e),e.add(t)}function pu(t,e,n){MF(t,e),e.set(t,n)}function MF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Me(t,e){return t.get(Vu(t,e))}function mi(t,e,n){return t.set(Vu(t,e),n),n}function Vu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uH="multipleSelect.itemBox";var Ei=new WeakMap,Ut=new WeakMap,zb=new WeakMap,$o=new WeakMap,Is=new WeakMap,Ps=new WeakMap,yh=new WeakSet;class Od extends xi{static get DEFAULTS(){return yo({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,nn(Od.DEFAULTS,n)),eoe(this,yh),pu(this,Ei,[]),pu(this,Ut,void 0),pu(this,zb,void 0),pu(this,$o,void 0),pu(this,Is,void 0),pu(this,Ps,void 0),mi($o,this,new ra(this.hot,{placeholder:RT,className:"htUIMultipleSelectSearch"})),mi(Is,this,new Pd(this.hot,{textContent:CT,className:"htUISelectAll"})),mi(Ps,this,new Pd(this.hot,{textContent:yT,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Me(Ut,this)}registerHooks(){Me($o,this).addLocalHook("keydown",e=>Vu(yh,this,noe).call(this,e)),Me($o,this).addLocalHook("input",e=>Vu(yh,this,toe).call(this,e)),Me(Is,this).addLocalHook("click",e=>Vu(yh,this,roe).call(this,e)),Me(Ps,this).addLocalHook("click",e=>Vu(yh,this,ioe).call(this,e))}setItems(e){var n;mi(Ei,this,e),(n=Me(Ut,this))===null||n===void 0||n.loadData(Me(Ei,this))}setLocale(e){mi(zb,this,e)}getLocale(){return Me(zb,this)}getItems(){return[...Me(Ei,this)]}getValue(){return soe(Me(Ei,this))}getSearchInputElement(){return Me($o,this)}getSelectAllElement(){return Me(Is,this)}getClearAllElement(){return Me(Ps,this)}isSelectedAllValues(){return Me(Ei,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new xi(this.hot,{className:"htUISelectionControls",children:[Me(Is,this),Me(Ps,this)]});this._element.appendChild(Me($o,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Me(Ut,this))===null||s===void 0||s.destroy(),q(o,"htUIMultipleSelectHot"),mi(Ut,this,new this.hot.constructor(o,{data:Me(Ei,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Me(Ut,this).listen()},modifyColWidth:u=>{const c=Me(Ut,this).container.scrollWidth-Cn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Me(Ut,this).init();const l=Me(Ut,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:uH}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Me(Ut,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:uH})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Me(Ut,this).listen()}reset(){Me($o,this).reset(),Me(Is,this).reset(),Me(Ps,this).reset()}update(){this.isBuilt()&&(Me(Ut,this).loadData(ooe(Me(Ei,this),this.options.value)),super.update())}destroy(){var e;(e=Me(Ut,this))===null||e===void 0||e.destroy(),Me($o,this).destroy(),Me(Ps,this).destroy(),Me(Is,this).destroy(),mi($o,this,null),mi(Ps,this,null),mi(Is,this,null),mi(Ut,this,null),mi(Ei,this,null),super.destroy()}}function toe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Me(Ei,this)]:n=Me(Ei,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Me(Ut,this).loadData(n)}function noe(t){this.runLocalHooks("keydown",t,this),$k(qd,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Fi(t),Me(Ut,this).listen(),Me(Ut,this).selectCell(0,0))}function roe(t){const e=[];t.preventDefault(),Me(Ut,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(pL(n,r)[0])}),Me(Ut,this).setSourceDataAtCell(e)}function ioe(t){const e=[];t.preventDefault(),Me(Ut,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(pL(n,r)[0])}),Me(Ut,this).setSourceDataAtCell(e)}function ooe(t,e){const n=uf(e);return t.map(r=>(r.checked=n(r.value),r))}function soe(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function aoe(t,e){loe(t,e),e.add(t)}function loe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uoe(t,e,n){return(e=coe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function coe(t){var e=hoe(t,"string");return typeof e=="symbol"?e:e+""}function hoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bh=new WeakSet;class doe extends lf{constructor(e,n){super(e,{id:n.id,stateless:!1}),aoe(this,bh),uoe(this,"name",""),this.name=n.name,this.elements.push(new Od(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>vg(bh,this,foe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>vg(bh,this,goe).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===ul){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?vn:ul},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=wl(i,h=>h.name===ul),u={},c=this.hot.getTranslatedPhrase(Lm);if(l){const h=s(r,a),d=We(h,v=>v.value),f=new Map(h.map(v=>[v.value,this.hot.getCellMeta(v.meta.visualRow,v.meta.visualCol)])),g=SR(d);o&&(l.args[0]=o);const w=[],C=QA(g,l.args[0],c,v=>{v.checked&&w.push(v.value),vg(bh,this,cH).call(this,v,f)}),S=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,S).locale,u.args=[w],u.command=ll(ul),u.itemsSnapshot=C}else u.args=[],u.command=ll(vn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Od)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||A(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Lm),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=SR(r),s=QA(o,o,e,l=>{vg(bh,this,cH).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:We(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:l_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function foe(t){qd(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Fi(t))}function cH(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function goe(t,e){switch(e.type){case"numeric":return m$(t,e);default:return t}}var IF;function moe(t,e){poe(t,e),e.add(t)}function poe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function woe(t,e,n){return(e=voe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function voe(t){var e=Coe(t,"string");return typeof e=="symbol"?e:e+""}function Coe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yoe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hH=new WeakSet;class xd extends lf{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),moe(this,hH),woe(this,"name",""),this.name=n.name,this.elements.push(new ra(this.hot,{type:"button",value:bT,className:"htUIButton htUIButtonOK",identifier:xd.BUTTON_OK})),this.elements.push(new ra(this.hot,{type:"button",value:ST,className:"htUIButton htUIButtonCancel",identifier:xd.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){A(this.elements,e=>{e.addLocalHook("click",(n,r)=>yoe(hH,this,boe).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),A(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}IF=xd;function boe(t,e){e.options.identifier===IF.BUTTON_OK?this.accept():this.cancel()}function Yb(t,e,n){return(e=Soe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Soe(t){var e=Roe(t,"string");return typeof e=="symbol"?e:e+""}function Roe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dH="ConditionCollection.filteringStates";class d_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Yb(this,"hot",void 0),Yb(this,"isMapRegistrable",void 0),Yb(this,"filteringStates",new Jp),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(dH,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i?.conditions)!==null&&r!==void 0?r:[],s=i?.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:na;return e.length?mie(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:na,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(nt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Mt(Md[r]))throw new Error(nt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:ia(a,s)}]},i):u.push({name:a,args:s,func:ia(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(dH),this.filteringStates=null,this.clearLocalHooks()}}ht(d_,Sn);function fH(t,e,n){return(e=Eoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eoe(t){var e=Toe(t,"string");return typeof e=="symbol"?e:e+""}function Toe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];fH(this,"conditionCollection",void 0),fH(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return A(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return A(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return A(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function _oe(t,e){Moe(t,e),e.add(t)}function Moe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Na(t,e,n){return(e=Ioe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ioe(t){var e=Poe(t,"string");return typeof e=="symbol"?e:e+""}function Poe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cg=new WeakSet;class OF{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];_oe(this,Cg),Na(this,"hot",void 0),Na(this,"conditionCollection",void 0),Na(this,"columnDataFactory",void 0),Na(this,"changes",[]),Na(this,"grouping",!1),Na(this,"latestEditedColumnPosition",-1),Na(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Gb(Cg,this,Ooe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Gb(Cg,this,xoe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Gb(Cg,this,Aoe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,A(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=nK(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new d_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const w=r.columnDataFactory(h);let C;f.isEmpty()?C=w:C=new PF(f,v=>r.columnDataFactory(v)).filter(),C=We(C,v=>v.meta.visualRow);const S=uf(C);return f.destroy(),wl(w,v=>S(v.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),He(this,(e,n)=>{this[n]=null})}}function Ooe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function xoe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Aoe(){A(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ht(OF,Sn);function Hoe(t){return Z$({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Od)return r;if(i.element&&!rc(i.element))return!1;i.focus()}})}const Sh="filters";function Noe(t,e){let n=-1,r;const i=Hoe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Sh),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof xi&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Sh),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Sh)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const w=r.getNavigator();w.getCurrentPage()>-1&&(n=w.getCurrentPage()),w.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const w=e[i.getCurrentPage()];w instanceof Id&&(w.openOptions(),g.preventDefault()),w instanceof Pd&&(w.activate(),g.preventDefault()),w instanceof xi||g.preventDefault()}}],Sh)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Sh)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function Doe(t,e){xF(t,e),e.add(t)}function qb(t,e,n){xF(t,e),e.set(t,n)}function xF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rh(t,e,n){return(e=koe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function koe(t){var e=Loe(t,"string");return typeof e=="symbol"?e:e+""}function Loe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wm(t,e,n){return t.set(ar(t,e),n),n}function Kr(t,e){return t.get(ar(t,e))}function ar(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ER="filters",$oe=250,gH=ER;var Uo=new WeakMap,TR=new WeakMap,rl=new WeakMap,Cr=new WeakSet;class Foe extends Xe{static get PLUGIN_KEY(){return ER}static get PLUGIN_PRIORITY(){return $oe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,Doe(this,Cr),Rh(this,"dropdownMenuPlugin",null),Rh(this,"conditionCollection",null),Rh(this,"conditionUpdateObserver",null),Rh(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Rh(this,"filtersRowsMap",null),qb(this,Uo,void 0),qb(this,TR,new WeakSet),qb(this,rl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ar(Cr,n,Yoe).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[ER]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Jd),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>ar(Cr,this,mH).call(this,"accept")),a.addLocalHook("cancel",()=>ar(Cr,this,mH).call(this,"cancel")),a.addLocalHook("change",l=>ar(Cr,this,zoe).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(pT)}:`,s=()=>`${this.hot.getTranslatedPhrase(wT)}:`;if(!this.components.get("filter_by_condition")){const a=new RR(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>ar(Cr,this,pH).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Kie(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new RR(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>ar(Cr,this,pH).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new doe(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new xd(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new d_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new OF(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>ar(Cr,this,Goe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return ar(Cr,e,Uoe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>ar(Cr,this,joe).call(this)),this.addHook("afterDropdownMenuShow",()=>ar(Cr,this,Woe).call(this)),this.addHook("afterDropdownMenuHide",()=>ar(Cr,this,Boe).call(this)),this.addHook("afterChange",a=>ar(Cr,this,Voe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Kr(Uo,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=Kr(Uo,this).getMenu(),c=u.getNavigator(),h=Kr(Uo,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];wm(Uo,this,Noe(this.dropdownMenuPlugin.menu,a));const l=u=>{Kr(Uo,this).listen(),u.preventDefault(),qd(u.keyCode,"TAB")&&(u.shiftKey?Kr(Uo,this).toPreviousItem():Kr(Uo,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:gH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gH)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:na;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,Kr(rl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=We(n.filter(),u=>u.meta.visualRow);const l=uf(i);he(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),A(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),wm(rl,this,this.exportConditions())}else s!==!1&&!r?(wm(rl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(Kr(rl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return A(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),w=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:l_(w)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=SR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===ep&&n.command.key!==vn&&r.command.key!==vn&&i.command.key!==vn?o=c_:i.command.key!==vn&&(n.command.key===vn||r.command.key===vn)&&(o=na),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new PF(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return A(i,s=>{A(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Voe(t){t&&A(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Woe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Boe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function joe(){const t=this.dropdownMenuPlugin.menu;Kr(TR,this).has(t)||Kr(Uo,this).setMenu(t),Kr(TR,this).add(t)}function Uoe(t){t.items.push({name:xe}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function mH(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==vn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==vn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==vn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function zoe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===RR&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function pH(){this.setListeningDropdownMenu()}function Yoe(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?q(e,"htFiltersActive"):we(e,"htFiltersActive")}function Goe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&wm(rl,this,Kr(rl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===ul),s=n.filter(a=>a.name!==ul);if(o.length>=2||s.length>=3)Ke(nt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const AF="internal-use-in-handsontable",_R={licenseKey:AF,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function HF(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[An])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function NF(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function qoe(t){var e;const n=t[An],r=NF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=HF(t);return{..._R,...r,...i}}function Koe(t){var e;const n=t[An],r=NF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=HF(t);return{...r,...i}}function Xoe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function yw(){const t="engine_relationship",e=li(An);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function f_(){const t="shared_engine_usage",e=li(An);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Zoe(t){const e=t.getSettings(),n=e[An],r=n?.engine;if(n===!0||Mt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Joe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Mt(r.hyperformula)){const o=yw(),s=f_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:AF}),(r.getConfig().leapYear1900!==_R.leapYear1900||OE(r.getConfig().nullDate,_R.nullDate)===!1)&&Ke(nt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Joe(t,e,n){const r=e[An],i=qoe(e),o=yw(),s=f_();Qoe(t,r.functions),ese(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),tse(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function wH(t){var e;const n=yw(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function vH(t,e){if(t){const n=yw(),r=n.get(t),i=f_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Qoe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){Ke(s.message)}})}function ese(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){Ke(r.message)}}}function tse(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){Ke(a.message)}}),t.resumeEvaluation())}function nse(t,e){return(Mt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const DF="DD/MM/YYYY";function rse(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function ise(t){return rse(t)?t.substr(1):t}function ose(t){return typeof t=="string"&&t.startsWith("=")}function g_(t,e){return typeof t=="string"&&e==="date"}function kF(t,e){return Z(t,e,!0).isValid()}function LF(t,e){return Z(t,e,!0).format(DF)}function sse(t,e){return Z(t,DF,!0).format(e)}function $F(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Z(r).format(e)}function ase(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function lse(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function use(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function m_(t,e,n){const r=lse(t,ase(t,e,n));return use(r)}function Da(t,e,n){cse(t,e),e.set(t,n)}function cse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){return t.get(FF(t,e))}function Os(t,e,n){return t.set(FF(t,e),n),n}function FF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Eh=new WeakMap,xs=new WeakMap,yr=new WeakMap,yg=new WeakMap,Kb=new WeakMap,Xb=new WeakMap,bg=new WeakMap;class CH{constructor(e,n,r){Da(this,Eh,void 0),Da(this,xs,void 0),Da(this,yr,void 0),Da(this,yg,[]),Da(this,Kb,[]),Da(this,Xb,void 0),Da(this,bg,[]),Os(Eh,this,e),Os(xs,this,n),Os(yr,this,r)}setRemovedHfIndexes(e){return Os(bg,this,e.map(n=>{const r=bt(xs,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),bt(bg,this)}getRemovedHfIndexes(){return bt(bg,this)}getHfIndexFromVisualIndex(e){const n=bt(xs,this).getIndexesSequence(),r=bt(xs,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Ni(bt(Eh,this))}s`;bt(yr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&bt(yr,this).getEngine()[r](bt(yr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Os(Kb,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Os(Xb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(bt(yr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=m_(bt(Kb,this),bt(Xb,this),bt(xs,this).getNumberOfIndexes());bt(yr,this).getSheetId()===null?bt(yr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Ni(bt(Eh,this))}Order`;return n=>{if(bt(yr,this).isPerformingUndoRedo())return;const r=bt(xs,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=bt(yg,this).map(l=>r.indexOf(l)),o=bt(yr,this).getEngine().getSheetDimensions(bt(yr,this).getSheetId());let s;bt(Eh,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);bt(yr,this).getEngine()[e](bt(yr,this).getSheetId(),i)}Os(yg,this,r)}}init(){Os(yg,this,bt(xs,this).getIndexesSequence())}}function ka(t,e,n){hse(t,e),e.set(t,n)}function hse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fo(t,e){return t.get(VF(t,e))}function La(t,e,n){return t.set(VF(t,e),n),n}function VF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sg=new WeakMap,Rg=new WeakMap,Zb=new WeakMap,Jb=new WeakMap,Qb=new WeakMap,eS=new WeakMap,tS=new WeakMap;class dse{constructor(e,n,r){ka(this,Sg,void 0),ka(this,Rg,void 0),ka(this,Zb,void 0),ka(this,Jb,!1),ka(this,Qb,!1),ka(this,eS,null),ka(this,tS,null),La(Sg,this,new CH("row",e,this)),La(Rg,this,new CH("column",n,this)),La(Zb,this,r)}getForAxis(e){return e==="row"?Fo(Sg,this):Fo(Rg,this)}setPerformUndo(e){La(Jb,this,e)}setPerformRedo(e){La(Qb,this,e)}isPerformingUndoRedo(){return Fo(Jb,this)||Fo(Qb,this)}getSheetId(){return Fo(tS,this)}getEngine(){return Fo(eS,this)}getPostponeAction(){return Fo(Zb,this)}setupSyncEndpoint(e,n){La(eS,this,e),La(tS,this,n),Fo(Sg,this).init(),Fo(Rg,this).init()}}function fse(t,e){WF(t,e),e.add(t)}function $a(t,e,n){return(e=gse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gse(t){var e=mse(t,"string");return typeof e=="symbol"?e:e+""}function mse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nS(t,e,n){WF(t,e),e.set(t,n)}function WF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oa(t,e,n){return t.set(ze(t,e),n),n}function ml(t,e){return t.get(ze(t,e))}function ze(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const An="formulas",pse=["maxRows","maxColumns","language"],wse=260;re.getSingleton().register("afterNamedExpressionAdded");re.getSingleton().register("afterNamedExpressionRemoved");re.getSingleton().register("afterSheetAdded");re.getSingleton().register("afterSheetRemoved");re.getSingleton().register("afterSheetRenamed");re.getSingleton().register("afterFormulasValuesUpdate");const Mc=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var ds=new WeakMap,bw=new WeakMap,Th=new WeakMap,qe=new WeakSet;class vse extends Xe{constructor(){var e;super(...arguments),e=this,fse(this,qe),nS(this,ds,!1),nS(this,bw,!1),nS(this,Th,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,Nse).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,Dse).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,kse).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,Lse).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,$se).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,Fse).call(e,...r)}]]),$a(this,"staticRegister",li("formulas")),$a(this,"engine",null),$a(this,"sheetId",null),$a(this,"sheetName",null),$a(this,"indexSyncer",null),$a(this,"rowAxisSyncer",null),$a(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return An}static get PLUGIN_PRIORITY(){return wse}static get SETTING_KEYS(){return[An,...pse]}isEnabled(){return!!this.hot.getSettings()[An]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Zoe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Ke("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&ze(qe,this,ed).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,yH).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,bH).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,yH).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,bH).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Sse).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Rse).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Cse).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Ese).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,SH).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,SH).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Tse).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,_se).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Pse).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Ose).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Mse).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Ise).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,xse).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Ase).call(n,...i)}),this.indexSyncer=new dse(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,bse).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,Hse).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,yse).call(n,...i)}),ml(Th,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){ml(Th,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),vH(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Koe(this.hot.getSettings());Xoe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[An];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[An].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());ze(qe,this,ed).call(this,o)}}super.updatePlugin(e)}destroy(){ml(Th,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),oa(Th,this,null),vH(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!f6(n))return Ke("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Ke("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return Ke(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){kE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}ze(qe,this,ed).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Ni(An)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),wH(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o?.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=wH(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Ke(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return g_(r,o.type)&&(kF(r,o.dateFormat)?r=LF(r,o.dateFormat):ose(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function ed(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function Cse(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Gn(s)&&(s=$F(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function yse(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:w}=h.start,{row:C,col:S}=h.end,v=C-g+1,T=S-w+1;for(let M=0;M<f.length;M+=1)for(let x=0;x<f[M].length;x+=1){const I=f[M][x],P=g+M%v,U=w+x%T,K=this.hot.getCellMeta(P,U);g_(I,K.type)&&(I.startsWith("'")?f[M][x]=I.slice(1):this.isFormulaCellType(P,U,this.sheetId)===!1&&(f[M][x]=sse(I,K.dateFormat)))}return f}function yH(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Ni(An))||oa(bw,this,Mt(this.hot.getSettings().data))}function bse(){if(ml(bw,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;g_(i,s.type)&&(kF(i,a)?t[r][o]=LF(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),oa(ds,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),oa(ds,this,!1)}function bH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Ni(An)))return;const r=nse(this.engine,this.hot.getSettings()[An].sheetName);if(ze(qe,this,ed).call(this,r),n!=="updateSettings")if(ml(bw,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){oa(ds,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),oa(ds,this,!1)}}}function Sse(t,e,n,r){if(r!=="get"||ml(ds,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){n.value=ise(n.value);return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let s=this.engine.getCellValue(o);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&Gn(s)&&(s=$F(s,a.dateFormat)),n.value=typeof s=="object"&&s!==null?s.value:s}function Rse(t,e,n,r){if(r!=="get"||ml(ds,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function SH(t,e){if(Mc(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Ese(t,e){if(Mc(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Gn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Ke(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Tse(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function _se(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Mse(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Ise(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Pse(t,e,n){if(Mc(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Ose(t,e,n){if(Mc(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function xse(t,e,n,r){if(Mc(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Ase(t,e,n,r){if(Mc(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Hse(t,e,n){var r;oa(ds,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());oa(ds,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Nse(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Dse(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function kse(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Lse(t){this.hot.runHooks("afterSheetAdded",t)}function $se(t,e){ze(qe,this,ed).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function Fse(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Vse(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(G0,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Wse(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(q0,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=We(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return A(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Bse(t,e){BF(t,e),e.add(t)}function jse(t,e,n){BF(t,e),e.set(t,n)}function BF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fa(t,e){return t.get(Fs(t,e))}function RH(t,e,n){return t.set(Fs(t,e),n),n}function Fs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeHideColumns");re.getSingleton().register("afterHideColumns");re.getSingleton().register("beforeUnhideColumns");re.getSingleton().register("afterUnhideColumns");const EH="hiddenColumns",Use=310;var Ki=new WeakMap,Va=new WeakSet;class zse extends Xe{constructor(){super(...arguments),Bse(this,Va),jse(this,Ki,null)}static get PLUGIN_KEY(){return EH}static get PLUGIN_PRIORITY(){return Use}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[EH]}enablePlugin(){var e=this;this.enabled||(RH(Ki,this,new Zp),Fa(Ki,this).addLocalHook("init",()=>Fs(Va,this,Zse).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Fa(Ki,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Fs(Va,e,Xse).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Fs(Va,this,Gse).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Fs(Va,this,Yse).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Fs(Va,e,Kse).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Fs(Va,this,qse).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Fa(Ki,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));A(l,u=>{o[u]=!1}),i=vr(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Fa(Ki,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{A(e,s=>{Fa(Ki,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return We(Fa(Ki,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Fa(Ki,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){A(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){RH(Ki,this,null),super.destroy()}}function Yse(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Gse(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function qse(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return A(t,r=>{let i=!0,o=0;he(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Kse(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function Xse(t){t.items.push({name:xe},Vse(this),Wse(this))}function Zse(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Jse(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(K0,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Qse(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(X0,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=We(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return A(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function eae(t,e){jF(t,e),e.add(t)}function tae(t,e,n){jF(t,e),e.set(t,n)}function jF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wa(t,e){return t.get(Vs(t,e))}function TH(t,e,n){return t.set(Vs(t,e),n),n}function Vs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeHideRows");re.getSingleton().register("afterHideRows");re.getSingleton().register("beforeUnhideRows");re.getSingleton().register("afterUnhideRows");const _H="hiddenRows",nae=320;var Xi=new WeakMap,Ba=new WeakSet;class rae extends Xe{constructor(){super(...arguments),eae(this,Ba),tae(this,Xi,null)}static get PLUGIN_KEY(){return _H}static get PLUGIN_PRIORITY(){return nae}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[_H]}enablePlugin(){var e=this;this.enabled||(TH(Xi,this,new Zp),Wa(Xi,this).addLocalHook("init",()=>Vs(Ba,this,uae).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Wa(Xi,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vs(Ba,e,lae).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Vs(Ba,this,oae).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>Vs(Ba,this,iae).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vs(Ba,e,aae).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Vs(Ba,this,sae).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Wa(Xi,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));A(l,u=>{o[u]=!1}),i=vr(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Wa(Xi,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{A(e,s=>{Wa(Xi,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return We(Wa(Xi,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Wa(Xi,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){A(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){TH(Xi,this,null),super.destroy()}}function iae(t,e){return this.isHidden(e)?0:t}function oae(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function sae(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return A(t,r=>{let i=!0,o=0;he(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function aae(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function lae(t){t.items.push({name:xe},Jse(this),Qse(this))}function uae(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function cae(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(R0)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function hae(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(E0)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function dae(t,e){UF(t,e),e.add(t)}function fae(t,e,n){UF(t,e),e.set(t,n)}function UF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MR(t,e){return t.get(np(t,e))}function rS(t,e,n){return t.set(np(t,e),n),n}function np(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeColumnFreeze");re.getSingleton().register("afterColumnFreeze");re.getSingleton().register("beforeColumnUnfreeze");re.getSingleton().register("afterColumnUnfreeze");const MH="manualColumnFreeze",gae=110;var el=new WeakMap,iS=new WeakSet;class mae extends Xe{constructor(){super(...arguments),dae(this,iS),fae(this,el,!1)}static get PLUGIN_KEY(){return MH}static get PLUGIN_PRIORITY(){return gae}isEnabled(){return!!this.hot.getSettings()[MH]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>np(iS,this,pae).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>np(iS,this,wae).call(this,e,n)),super.enablePlugin())}disablePlugin(){rS(el,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;MR(el,this)||rS(el,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;MR(el,this)||rS(el,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function pae(t){t.items.push({name:"---------"},cae(this),hae(this))}function wae(t,e){if(MR(el,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Eg(t,e,n){return(e=vae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vae(t){var e=Cae(t,"string");return typeof e=="symbol"?e:e+""}function Cae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oS=0,IH=1,PH=2,wu="px";let zF=class{constructor(e){Eg(this,"hot",void 0),Eg(this,"_element",null),Eg(this,"state",oS),Eg(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=PH}build(){this.state===oS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=IH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=oS}isAppended(){return this.state===PH}isBuilt(){return this.state>=IH}setPosition(e,n){Gn(e)&&(this._element.style.top=e+wu),Gn(n)&&(this._element.style[this.inlineProperty]=n+wu)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Gn(e)&&(this._element.style.width=e+wu),Gn(n)&&(this._element.style.height=n+wu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Gn(e)&&(this._element.style.marginTop=e+wu),Gn(n)&&(this._element.style[`margin${Ni(this.inlineProperty)}`]=n+wu)}getOffset(){const e=this._element.style,n=`margin${Ni(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const yae="ht__manualColumnMove--backlight";let bae=class extends zF{build(){super.build(),q(this._element,yae)}};const Sae="ht__manualColumnMove--guideline";let Rae=class extends zF{build(){super.build(),q(this._element,Sae)}};function Eae(t,e){YF(t,e),e.add(t)}function pi(t,e,n){YF(t,e),e.set(t,n)}function YF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fr(t,e,n){return t.set(Ws(t,e),n),n}function ce(t,e){return t.get(Ws(t,e))}function Ws(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeColumnMove");re.getSingleton().register("afterColumnMove");const sS="manualColumnMove",Tae=120,OH="ht__manualColumnMove",rp="show-ui",IR="on-moving--columns",PR="after-selection--columns";var zn=new WeakMap,js=new WeakMap,ns=new WeakMap,vm=new WeakMap,Zs=new WeakMap,Un=new WeakMap,Tg=new WeakMap,Ur=new WeakMap,Nu=new WeakMap,ip=new WeakMap,td=new WeakMap,ja=new WeakSet;class _ae extends Xe{constructor(){super(...arguments),Eae(this,ja),pi(this,zn,new bae(this.hot)),pi(this,js,new Rae(this.hot)),pi(this,ns,[]),pi(this,vm,0),pi(this,Zs,!1),pi(this,Un,{}),pi(this,Tg,void 0),pi(this,Ur,void 0),pi(this,Nu,void 0),pi(this,ip,void 0),pi(this,td,void 0)}static get PLUGIN_KEY(){return sS}static get PLUGIN_PRIORITY(){return Tae}isEnabled(){return!!this.hot.getSettings()[sS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ws(ja,e,Mae).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ws(ja,e,Pae).call(e,...r)}),this.addHook("afterScrollVertically",()=>Ws(ja,this,xae).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ws(ja,e,Aae).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,OH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,OH),this.unregisterEvents(),ce(zn,this).destroy(),ce(js,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=ce(Tg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(fr(Tg,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return fr(Tg,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=vr(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[sS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return he(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ce(Ur,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ce(Ur,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ce(zn,this).getOffset().start,u=ce(zn,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,w=Yt(this.hot.rootElement),C=g.innerWidth-ce(Nu,this)-w;h=g.innerWidth-ce(Un,this).eventPageX-C-(r.scrollX===void 0?i:0)}else h=ce(Un,this).eventPageX-(ce(Nu,this)-(r.scrollX===void 0?i:0));if(ce(ip,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ce(Ur,this))&&(o+=i),o+=c,ce(Ur,this)<0)ce(td,this)>0?ce(Un,this).col=0:ce(Un,this).col=e>0?e-1:e;else if(ce(Un,this).TD.offsetWidth/2+o<=h){const g=ce(Ur,this)>=ce(vm,this)?ce(vm,this)-1:ce(Ur,this);ce(Un,this).col=g+1,o+=ce(Un,this).TD.offsetWidth}else ce(Un,this).col=ce(Ur,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&ce(Ur,this)<ce(td,this)&&(f-=ce(Nu,this)<=r.scrollX?ce(Nu,this):0),ce(zn,this).setPosition(null,d),ce(js,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ws(ja,this,Iae).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ws(ja,this,Oae).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ce(zn,this).build(),ce(js,this).build()}destroy(){ce(zn,this).destroy(),ce(js,this).destroy(),super.destroy()}}function Mae(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=ye(t.target,"sortAction");if(!s||!o||ce(Zs,this)||t.button!==0||a){fr(Zs,this,!1),ce(ns,this).length=0,we(this.hot.rootElement,[IR,rp]);return}const l=ce(js,this).isBuilt()&&!ce(js,this).isAppended(),u=ce(zn,this).isBuilt()&&!ce(zn,this).isAppended();l&&u&&(ce(js,this).appendTo(i.hider),ce(zn,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,fr(Zs,this,!0);const g=n.firstChild?aK(t,n.firstChild).x:t.offsetX;ce(Un,this).eventPageX=t.pageX,fr(Ur,this,e.col),ce(Un,this).TD=n,ce(Un,this).col=e.col,fr(ns,this,this.prepareColumnsToMoving(d,f)),fr(ip,this,!!this.hot.getSettings().rowHeaders),fr(vm,this,this.hot.countCols()),fr(td,this,this.hot.getSettings().fixedColumnsStart),fr(Nu,this,Hn(this.hot.rootElement).left);const w=ce(ip,this)?-1:0,C=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,S=e.col<ce(td,this),v=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),M=this.getColumnsWidth(d,e.col-1)+T,x=this.getColumnsWidth(w,d-1)+(S?v:0)+M;ce(zn,this).setPosition(C,x),ce(zn,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-C),ce(zn,this).setOffset(null,-M),q(this.hot.rootElement,IR)}else we(this.hot.rootElement,PR),fr(Zs,this,!1),ce(ns,this).length=0}function Iae(t){ce(Zs,this)&&(ce(Un,this).eventPageX=t.pageX,this.refreshPositions())}function Pae(t,e,n,r){!this.hot.getSelectedRangeLast()||!ce(Zs,this)||(ce(ns,this).indexOf(e.col)>-1?we(this.hot.rootElement,rp):q(this.hot.rootElement,rp),r.row=!0,r.column=!0,r.cell=!0,fr(Ur,this,e.col),ce(Un,this).TD=n)}function Oae(){const t=ce(Un,this).col,e=ce(ns,this).length;if(fr(Ur,this,void 0),fr(Zs,this,!1),we(this.hot.rootElement,[IR,rp,PR]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,PR),e<1||t===void 0)return;const n=ce(ns,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(ce(ns,this),t);if(ce(ns,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function xae(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;ce(zn,this).setPosition(r),ce(zn,this).setSize(null,t.hider.offsetHeight-r)}function Aae(){this.moveBySettingsOrLoad()}function Hae(t,e){GF(t,e),e.add(t)}function _n(t,e,n){GF(t,e),e.set(t,n)}function GF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e,n){return t.set(Ti(t,e),n),n}function ie(t,e){return t.get(Ti(t,e))}function Ti(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const op="manualColumnResize",Nae=130,xH="manualColumnWidths";var Ko=new WeakMap,_g=new WeakMap,Pr=new WeakMap,sp=new WeakMap,go=new WeakMap,Dae=new WeakMap,Ku=new WeakMap,Mg=new WeakMap,sr=new WeakMap,zo=new WeakMap,Tl=new WeakMap,ap=new WeakMap,nd=new WeakMap,rd=new WeakMap,xr=new WeakMap,id=new WeakMap,Zi=new WeakSet;class kae extends Xe{static get PLUGIN_KEY(){return op}static get PLUGIN_PRIORITY(){return Nae}constructor(e){super(e),Hae(this,Zi),_n(this,Ko,null),_n(this,_g,null),_n(this,Pr,[]),_n(this,sp,null),_n(this,go,null),_n(this,Dae,null),_n(this,Ku,null),_n(this,Mg,null),_n(this,sr,this.hot.rootDocument.createElement("DIV")),_n(this,zo,this.hot.rootDocument.createElement("DIV")),_n(this,Tl,null),_n(this,ap,!1),_n(this,nd,0),_n(this,rd,null),_n(this,xr,void 0),_n(this,id,void 0),q(ie(sr,this),"manualColumnResizer"),q(ie(zo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[op]}enablePlugin(){var e=this;this.enabled||(Vt(xr,this,new ha),ie(xr,this).addLocalHook("init",()=>Ti(Zi,this,Lae).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ie(xr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ti(Zi,e,jae).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ti(Zi,e,Uae).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ti(Zi,e,zae).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Vt(id,this,ie(xr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",xH,ie(xr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",xH,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return ie(xr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ie(xr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Vt(Ko,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(ie(Ko,this)),i=r.col;if(i<0)return;const o=tn(ie(Ko,this)),s=ie(Ko,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(Ko,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ie(Ko,this),r.row,r.col)),Vt(_g,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Vt(Pr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();A(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;he(d,f,g=>{ie(Pr,this).includes(g)||ie(Pr,this).push(g)})})}ie(Pr,this).includes(ie(_g,this))||Vt(Pr,this,[ie(_g,this)]),Vt(Mg,this,l.start-6),Vt(Ku,this,parseInt(s.width,10)),ie(sr,this).style.top=`${l.top}px`,ie(sr,this).style[this.inlineDir]=`${ie(Mg,this)+ie(Ku,this)}px`,ie(sr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(ie(sr,this))}refreshHandlePosition(){ie(sr,this).style[this.inlineDir]=`${ie(Mg,this)+ie(sp,this)}px`}setupGuidePosition(){const e=parseInt(tn(ie(sr,this)),10),n=parseInt(ie(sr,this).style.top,10)+e,r=this.hot.view.getTableHeight();q(ie(sr,this),"active"),q(ie(zo,this),"active"),ie(zo,this).style.top=`${n}px`,this.refreshGuidePosition(),ie(zo,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ie(zo,this))}refreshGuidePosition(){ie(zo,this).style[this.inlineDir]=ie(sr,this).style[this.inlineDir]}hideHandleAndGuide(){we(ie(sr,this),"active"),we(ie(zo,this),"active")}checkIfColumnHeader(e){const n=vl(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",ie(go,this),r,!0);o!==void 0&&Vt(go,this,o),this.setManualSize(r,ie(go,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ie(go,this),r,!0),i&&e()};ie(nd,this)>=2&&(ie(Pr,this).length>1?(A(ie(Pr,this),i=>{n(i)}),e()):A(ie(Pr,this),i=>{n(i,!0)})),Vt(nd,this,0),Vt(rd,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Ti(Zi,this,$ae).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Ti(Zi,this,Fae).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Ti(Zi,this,Vae).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Ti(Zi,this,Wae).call(this)),this.eventManager.addEventListener(ie(sr,this),"contextmenu",()=>Ti(Zi,this,Bae).call(this))}destroy(){super.destroy()}}function Lae(){const t=this.hot.getSettings()[op],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{ie(xr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{ie(xr,this).setValueAtIndex(r,n)})},!0),Vt(id,this,t)):t===!0&&Array.isArray(ie(id,this))&&this.hot.batchExecution(()=>{ie(id,this).forEach((n,r)=>{ie(xr,this).setValueAtIndex(r,n)})},!0)}function $ae(t){if(!Dk(t.target)&&ie(ap,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ie(Tl,this)||this.setupHandlePosition(e))}}function Fae(t){t.target.parentNode===this.hot.rootElement&&ye(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ie(Ko,this)),this.setupGuidePosition(),Vt(Tl,this,!0),ie(rd,this)===null&&(Vt(rd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(rd,this))),Vt(nd,this,ie(nd,this)+1),this.startX=t.pageX,Vt(go,this,ie(Ku,this)))}function Vae(t){if(ie(Tl,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Vt(sp,this,ie(Ku,this)+e),A(ie(Pr,this),n=>{Vt(go,this,this.setManualSize(n,ie(sp,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Wae(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",ie(go,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ie(go,this),n,!1)};ie(Tl,this)&&(this.hideHandleAndGuide(),Vt(Tl,this,!1),ie(go,this)!==ie(Ku,this)&&(ie(Pr,this).length>1?(A(ie(Pr,this),r=>{e(r)}),t()):A(ie(Pr,this),r=>{e(r,!0)})),this.setupHandlePosition(ie(Ko,this)))}function Bae(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(sr,this)),this.hot.rootElement.removeChild(ie(zo,this)),Vt(Tl,this,!1),Vt(ap,this,!0),this.hot._registerImmediate(()=>{Vt(ap,this,!1)})}function jae(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ie(xr,this).getValueAtIndex(r);this.hot.getSettings()[op]&&i&&(n=i)}return n}function Uae(t,e){const n=ie(xr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function zae(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function aS(t,e,n){return(e=Yae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yae(t){var e=Gae(t,"string");return typeof e=="symbol"?e:e+""}function Gae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lS=0,AH=1,HH=2,vu="px";let qF=class{constructor(e){aS(this,"hot",void 0),aS(this,"_element",null),aS(this,"state",lS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=HH}build(){this.state===lS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=AH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=lS}isAppended(){return this.state===HH}isBuilt(){return this.state>=AH}setPosition(e,n){e!==void 0&&(this._element.style.top=e+vu),n!==void 0&&(this._element.style.left=n+vu)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+vu),n&&(this._element.style.height=n+vu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+vu),n&&(this._element.style.marginLeft=n+vu)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const qae="ht__manualRowMove--backlight";class Kae extends qF{build(){super.build(),q(this._element,qae)}}const Xae="ht__manualRowMove--guideline";class Zae extends qF{build(){super.build(),q(this._element,Xae)}}function Jae(t,e){KF(t,e),e.add(t)}function Cu(t,e,n){KF(t,e),e.set(t,n)}function KF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cl(t,e,n){return t.set(Bs(t,e),n),n}function Ee(t,e){return t.get(Bs(t,e))}function Bs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeRowMove");re.getSingleton().register("afterRowMove");const uS="manualRowMove",Qae=140,NH="ht__manualRowMove",lp="show-ui",OR="on-moving--rows",xR="after-selection--rows";var Yn=new WeakMap,Us=new WeakMap,rs=new WeakMap,Js=new WeakMap,mr=new WeakMap,Ig=new WeakMap,Ua=new WeakSet;class ele extends Xe{constructor(){super(...arguments),Jae(this,Ua),Cu(this,Yn,new Kae(this.hot)),Cu(this,Us,new Zae(this.hot)),Cu(this,rs,[]),Cu(this,Js,void 0),Cu(this,mr,{}),Cu(this,Ig,void 0)}static get PLUGIN_KEY(){return uS}static get PLUGIN_PRIORITY(){return Qae}isEnabled(){return!!this.hot.getSettings()[uS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bs(Ua,e,tle).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bs(Ua,e,rle).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Bs(Ua,this,ole).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bs(Ua,e,sle).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,NH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,NH),this.unregisterEvents(),Ee(Yn,this).destroy(),Ee(Us,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Ee(Ig,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(cl(Ig,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return cl(Ig,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=vr(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[uS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return he(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Ee(mr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Ee(mr,this).TD,a=this.hot.rootElement,l=Hn(a),u=Cd(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Ee(mr,this).eventPageY-d+c,g=o.hider.offsetHeight,w=o.TBODY.offsetTop,C=Ee(Yn,this).getOffset().top,S=Ee(Yn,this).getSize().height,v=s.offsetHeight/2,T=s.offsetHeight;let M=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const x=f>=M+v;this.isFixedRowTop(e.row)&&(M+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Ee(mr,this).row=n>0?n-1:n:x?(Ee(mr,this).row=e.row+1,M+=e.row===0?T-1:T):Ee(mr,this).row=e.row;let I=f,P=M;f+S+C>=g?I=g-S-C:f+C<w&&(I=w+Math.abs(C)),M>=g-1&&(P=g-1),Ee(Yn,this).setPosition(I),Ee(Us,this).setPosition(P)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Bs(Ua,this,nle).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Bs(Ua,this,ile).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ee(Yn,this).build(),Ee(Us,this).build()}destroy(){Ee(Yn,this).destroy(),Ee(Us,this).destroy(),super.destroy()}}function tle(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Ee(Js,this)||t.button!==0){cl(Js,this,!1),Ee(rs,this).length=0,we(this.hot.rootElement,[OR,lp]);return}const l=Ee(Us,this).isBuilt()&&!Ee(Us,this).isAppended(),u=Ee(Yn,this).isBuilt()&&!Ee(Yn,this).isAppended();l&&u&&(Ee(Us,this).appendTo(i.hider),Ee(Yn,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,cl(Js,this,!0),Ee(mr,this).eventPageY=t.pageY,Ee(mr,this).coords=e,Ee(mr,this).TD=n,cl(rs,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),w=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Ee(Yn,this).setPosition(null,g),Ee(Yn,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),Ee(Yn,this).setOffset(-w,null),q(this.hot.rootElement,OR),this.refreshPositions()}else we(this.hot.rootElement,xR),cl(Js,this,!1),Ee(rs,this).length=0}function nle(t){Ee(Js,this)&&(Ee(mr,this).eventPageY=t.pageY,this.refreshPositions())}function rle(t,e,n,r){!this.hot.getSelectedRangeLast()||!Ee(Js,this)||(Ee(rs,this).indexOf(e.row)>-1?we(this.hot.rootElement,lp):q(this.hot.rootElement,lp),r.row=!0,r.column=!0,r.cell=!0,Ee(mr,this).coords=e,Ee(mr,this).TD=n)}function ile(){const t=Ee(mr,this).row,e=Ee(rs,this).length;if(cl(Js,this,!1),we(this.hot.rootElement,[OR,lp,xR]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,xR),e<1||t===void 0)return;const n=Ee(rs,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Ee(rs,this),t);if(Ee(rs,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function ole(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Ee(Yn,this).setPosition(null,r),Ee(Yn,this).setSize(t.hider.offsetWidth-r)}function sle(){this.moveBySettingsOrLoad()}function ale(t,e){XF(t,e),e.add(t)}function Mn(t,e,n){XF(t,e),e.set(t,n)}function XF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ht(t,e,n){return t.set(Xo(t,e),n),n}function ne(t,e){return t.get(Xo(t,e))}function Xo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const up="manualRowResize",lle=30,DH="manualRowHeights";var ao=new WeakMap,Pg=new WeakMap,Or=new WeakMap,od=new WeakMap,zs=new WeakMap,p_=new WeakMap,Xu=new WeakMap,Og=new WeakMap,Bn=new WeakMap,io=new WeakMap,_l=new WeakMap,cp=new WeakMap,sd=new WeakMap,ad=new WeakMap,Mi=new WeakMap,ld=new WeakMap,As=new WeakSet;class ule extends Xe{static get PLUGIN_KEY(){return up}static get PLUGIN_PRIORITY(){return lle}constructor(e){super(e),ale(this,As),Mn(this,ao,null),Mn(this,Pg,null),Mn(this,Or,[]),Mn(this,od,null),Mn(this,zs,null),Mn(this,p_,null),Mn(this,Xu,null),Mn(this,Og,null),Mn(this,Bn,this.hot.rootDocument.createElement("DIV")),Mn(this,io,this.hot.rootDocument.createElement("DIV")),Mn(this,_l,!1),Mn(this,cp,!1),Mn(this,sd,0),Mn(this,ad,null),Mn(this,Mi,void 0),Mn(this,ld,void 0),q(ne(Bn,this),"manualRowResizer"),q(ne(io,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[up]}enablePlugin(){this.enabled||(Ht(Mi,this,new ha),ne(Mi,this).addLocalHook("init",()=>Xo(As,this,ple).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ne(Mi,this)),this.addHook("modifyRowHeight",(e,n)=>Xo(As,this,mle).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ht(ld,this,ne(Mi,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",DH,ne(Mi,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",DH,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return ne(Mi,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return ne(od,this)}setupHandlePosition(e){Ht(ao,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ne(ao,this)),o=i.row;if(o<0)return;const s=Yt(ne(ao,this)),a=ne(ao,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ne(ao,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ne(ao,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ne(ao,this),i.row,i.col)),Ht(Pg,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Ht(Or,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();A(d,f=>{const g=f.getTopStartCorner().row,w=f.getBottomStartCorner().row;he(g,w,C=>{ne(Or,this).includes(C)||ne(Or,this).push(C)})})}ne(Or,this).includes(ne(Pg,this))||Ht(Or,this,[ne(Pg,this)]),Ht(Og,this,c.top-6),Ht(Xu,this,parseInt(a.height,10)),ne(Bn,this).style.top=`${ne(Og,this)+ne(Xu,this)}px`,ne(Bn,this).style[this.inlineDir]=`${c.start}px`,ne(Bn,this).style.width=`${s}px`,this.hot.rootElement.appendChild(ne(Bn,this))}refreshHandlePosition(){ne(Bn,this).style.top=`${ne(Og,this)+ne(od,this)}px`}setupGuidePosition(){const e=parseInt(Yt(ne(Bn,this)),10),n=parseInt(ne(Bn,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();q(ne(Bn,this),"active"),q(ne(io,this),"active"),ne(io,this).style.top=ne(Bn,this).style.top,ne(io,this).style[this.inlineDir]=`${n}px`,ne(io,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ne(io,this))}refreshGuidePosition(){ne(io,this).style.top=ne(Bn,this).style.top}hideHandleAndGuide(){we(ne(Bn,this),"active"),we(ne(io,this),"active")}checkIfRowHeader(e){const n=vl(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ne(zs,this)<n?n:ne(zs,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Ht(zs,this,o),this.setManualSize(r,ne(zs,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ne(sd,this)>=2&&(ne(Or,this).length>1?(A(ne(Or,this),i=>{n(i)}),e()):A(ne(Or,this),i=>{n(i,!0)})),Ht(sd,this,0),Ht(ad,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Xo(As,this,cle).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Xo(As,this,hle).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Xo(As,this,dle).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Xo(As,this,fle).call(this)),this.eventManager.addEventListener(ne(Bn,this),"contextmenu",()=>Xo(As,this,gle).call(this))}destroy(){super.destroy()}}function cle(t){if(!Dk(t.target)&&ne(cp,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ne(_l,this)||this.setupHandlePosition(e))}}function hle(t){ye(t.target,"manualRowResizer")&&(this.setupHandlePosition(ne(ao,this)),this.setupGuidePosition(),Ht(_l,this,!0),ne(ad,this)===null&&(Ht(ad,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ne(ad,this))),Ht(sd,this,ne(sd,this)+1),Ht(p_,this,t.pageY),Ht(zs,this,ne(Xu,this)))}function dle(t){ne(_l,this)&&(Ht(od,this,ne(Xu,this)+(t.pageY-ne(p_,this))),A(ne(Or,this),e=>{Ht(zs,this,this.setManualSize(e,ne(od,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function fle(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ne(_l,this)&&(this.hideHandleAndGuide(),Ht(_l,this,!1),ne(zs,this)!==ne(Xu,this)&&(ne(Or,this).length>1?(A(ne(Or,this),r=>{e(r)}),t()):A(ne(Or,this),r=>{e(r,!0)})),this.setupHandlePosition(ne(ao,this)))}function gle(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ne(Bn,this)),this.hot.rootElement.removeChild(ne(io,this)),Ht(_l,this,!1),Ht(cp,this,!0),this.hot._registerImmediate(()=>{Ht(cp,this,!1)})}function mle(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ne(Mi,this).getValueAtIndex(r);this.hot.getSettings()[up]&&i&&(n=i)}return n}function ple(){const t=this.hot.getSettings()[up],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ne(Mi,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ne(Mi,this).setValueAtIndex(r,n)}),Ht(ld,this,t)):t===!0&&Array.isArray(ne(ld,this))&&ne(ld,this).forEach((n,r)=>{ne(Mi,this).setValueAtIndex(r,n)})},!0)}var kH={},LH;function wle(){if(LH)return kH;LH=1;var t=Gp();return t("flatMap"),kH}wle();var $H={},FH={},cS,VH;function vle(){if(VH)return cS;VH=1;var t=on(),e=an(),n=So(),r=QR();return cS=function(i,o){(!o||typeof i!="string")&&e(i);var s=r(i);return n(e(s!==void 0?t(s,i):i))},cS}var WH;function Cle(){if(WH)return FH;WH=1;var t=gt(),e=on(),n=pr(),r=an(),i=So(),o=vle(),s=nE(),a=wr(),l=sa(),u=rE(),c=la(),h=!l&&!u("flatMap",function(){}),d=!l&&!h&&c("flatMap",TypeError),f=l||h||d,g=s(function(){for(var w=this.iterator,C=this.mapper,S,v;;){if(v=this.inner)try{if(S=r(e(v.next,v.iterator)),!S.done)return S.value;this.inner=null}catch(T){a(w,"throw",T)}if(S=r(e(this.next,w)),this.done=!!S.done)return;try{this.inner=o(C(S.value,this.counter++),!1)}catch(T){a(w,"throw",T)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(C){r(this);try{n(C)}catch(S){a(this,"throw",S)}return d?e(d,this,C):new g(i(this),{mapper:C,inner:null})}}),FH}var BH;function yle(){return BH||(BH=1,Cle()),$H}yle();function ble(t,e,n){Sle(t,e),e.set(t,n)}function Sle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function za(t,e,n){return(e=Rle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rle(t){var e=Ele(t,"string");return typeof e=="symbol"?e:e+""}function Ele(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jH(t,e){return t.get(ZF(t,e))}function xg(t,e,n){return t.set(ZF(t,e),n),n}function ZF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ya=new WeakMap;class lo{constructor(e,n,r,i,o,s){za(this,"row",void 0),za(this,"col",void 0),za(this,"rowspan",void 0),za(this,"colspan",void 0),za(this,"removed",!1),za(this,"cellCoordsFactory",void 0),za(this,"cellRangeFactory",void 0),ble(this,Ya,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return nt`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),xg(Ya,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,xg(Ya,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return xg(Ya,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return jH(Ya,this)||xg(Ya,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),jH(Ya,this)}}function Tle(t,e){_le(t,e),e.add(t)}function _le(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ag(t,e,n){return(e=Mle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mle(t){var e=Ile(t,"string");return typeof e=="symbol"?e:e+""}function Ile(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ga(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hs=new WeakSet;class hp{constructor(e){Tle(this,Hs),Ag(this,"plugin",void 0),Ag(this,"mergedCells",[]),Ag(this,"mergedCellsMatrix",new Map),Ag(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){Ke(hp.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new lo(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Ga(Hs,this,UH).call(this,a),a):(u&&Ke(hp.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Ga(Hs,this,Ple).call(this,r),r):!1}clear(){A(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;he(n,n+i,s=>{he(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=je(u,i,i+s-1),d=je(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Ga(Hs,this,Hg).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Ga(Hs,this,Hg).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Ga(Hs,this,Hg).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Ga(Hs,this,Hg).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Ga(Hs,this,UH).call(this,s)})}}function Hg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function UH(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Ple(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function hS(t,e,n){return(e=Ole(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ole(t){var e=xle(t,"string");return typeof e=="symbol"?e:e+""}function xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ale{constructor(e){hS(this,"plugin",void 0),hS(this,"mergedCellsCollection",void 0),hS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,w=this.getFarthestCollection(e,n,r,i);if(w){if(r==="down"){const C=w.row+w.rowspan-a-g;o[2]+C>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?C:0}else if(r==="right"){const C=w.col+w.colspan-l-g;o[3]+C>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?C:0}else if(r==="up"){const C=u-g-w.row+1;o[0]+C<0?o[0]+=g:o[0]-=g?C:0}else if(r==="left"){const C=c-g-w.col+1;o[1]+C<0?o[1]+=g:o[1]-=g?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),nn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,w=d-g;let C=null,S=null,v=null;switch(r){case"up":C="includesVertically",v=c-w+1;break;case"left":C="includesHorizontally",v=c-w+1;break;case"down":C="includesVertically",v=h+w-1;break;case"right":C="includesHorizontally",v=h+w-1;break}return A(i,T=>{T[C](v)&&T.isFarther(S,r)&&(S=T)}),S}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return A(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:w}=g;return w===h.getWidth()}):!f.every(g=>{let{rowspan:w}=g;return w===h.getHeight()})}}function dS(t,e,n){return(e=Hle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hle(t){var e=Nle(t,"string");return typeof e=="symbol"?e:e+""}function Nle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dle{constructor(e){dS(this,"plugin",void 0),dS(this,"hot",void 0),dS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function kle(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(_0)}return this.getTranslatedPhrase(T0)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?lo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function ud(t,e,n){return(e=Lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lle(t){var e=$le(t,"string");return typeof e=="symbol"?e:e+""}function $le(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zH{constructor(e){ud(this,"data",void 0),ud(this,"next",null),ud(this,"prev",null),this.data=e}}class Ng{constructor(){ud(this,"first",null),ud(this,"last",null)}push(e){const n=new zH(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new zH(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function Fle(t,e){JF(t,e),e.add(t)}function qa(t,e,n){JF(t,e),e.set(t,n)}function JF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tt(t,e){return t.get(dp(t,e))}function br(t,e,n){return t.set(dp(t,e),n),n}function dp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ji=new WeakMap,Qi=new WeakMap,eo=new WeakMap,to=new WeakMap,AR=new WeakMap,Dg=new WeakMap,kg=new WeakMap,fS=new WeakSet;class Vle{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;Fle(this,fS),qa(this,Ji,new Ng),qa(this,Qi,new Ng),qa(this,eo,null),qa(this,to,null),qa(this,AR,null),qa(this,Dg,null),qa(this,kg,null),br(AR,this,n),br(Dg,this,r),br(kg,this,i)}getCurrentVerticalNode(){return tt(to,this).data}getFirstVerticalNode(){return tt(Qi,this).first.data}getNextVerticalNode(){return tt(to,this).next.data}getPrevVerticalNode(){return tt(to,this).prev.data}getCurrentHorizontalNode(){return tt(eo,this).data}getFirstHorizontalNode(){return tt(Ji,this).first.data}getNextHorizontalNode(){return tt(eo,this).next.data}getPrevHorizontalNode(){return tt(eo,this).prev.data}setPrevNodeAsActive(){br(to,this,tt(to,this).prev),br(eo,this,tt(eo,this).prev)}setNextNodeAsActive(){br(to,this,tt(to,this).next),br(eo,this,tt(eo,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;br(Ji,this,new Ng);for(let s=n.row;s<=r.row;s++)if(!tt(Dg,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(tt(kg,this).isHidden(a))continue;const l=dp(fS,this,YH).call(this,e,tt(Ji,this),i,s,a);l&&br(eo,this,l)}tt(Ji,this).first&&(tt(Ji,this).first.prev=tt(Ji,this).last,tt(Ji,this).last.next=tt(Ji,this).first);const o=new WeakSet;br(Qi,this,new Ng);for(let s=n.col;s<=r.col;s++)if(!tt(kg,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(tt(Dg,this).isHidden(a))continue;const l=dp(fS,this,YH).call(this,e,tt(Qi,this),o,a,s);l&&br(to,this,l)}tt(Qi,this).first&&(tt(Qi,this).first.prev=tt(Qi,this).last,tt(Qi,this).last.next=tt(Qi,this).first)}setActiveNode(e,n){return tt(Ji,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return br(eo,this,r),!1}),tt(Qi,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return br(to,this,r),!1}),this}}function YH(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=tt(AR,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function QF(t,e,n){const{rowIndexMapper:r,stylesHandler:i}=t,o=i.getDefaultRowHeight();let s=0;for(let l=e;l<e+n;l++)if(!r.isHidden(l)){var a;s+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:o,l===0&&!i.isClassicTheme()&&(s+=1)}return s}function Wle(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!Ae(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),vd()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[w,C]=t.translateMergedCellToRenderable(h,g,d,f),S=t.getSetting("virtualized");if(vd()&&d===0&&!e.getSettings().rowHeaders){const N=QF(e,h,g);i.set(l,N/g)}const v=n.getRenderableFromVisualIndex(l),T=r.getRenderableFromVisualIndex(u),M=w-v+1,x=C-T+1;let I=n.getNearestNotHiddenIndex(h,1),P=r.getNearestNotHiddenIndex(d,1);if(S){const N=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(N)||(I=Math.max(I,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(N)||(P=Math.max(P,e.getFirstRenderedVisibleColumn()))}const U=Math.min(g,M),K=Math.min(f,x);I===l&&P===u?(a.setAttribute("rowspan",U),a.setAttribute("colspan",K)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function Ble(t,e){eV(t,e),e.add(t)}function Lg(t,e,n){eV(t,e),e.set(t,n)}function eV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gS(t,e,n){return(e=jle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jle(t){var e=Ule(t,"string");return typeof e=="symbol"?e:e+""}function Ule(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ad(t,e,n){return t.set(it(t,e),n),n}function ft(t,e){return t.get(it(t,e))}function it(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeMergeCells");re.getSingleton().register("afterMergeCells");re.getSingleton().register("beforeUnmergeCells");re.getSingleton().register("afterUnmergeCells");const HR="mergeCells",zle=150,GH=HR;var Jr=new WeakMap,Qr=new WeakMap,mo=new WeakMap,qH=new WeakMap,ut=new WeakSet;class Yle extends Xe{constructor(){super(...arguments),Ble(this,ut),gS(this,"mergedCellsCollection",null),gS(this,"autofillCalculations",null),gS(this,"selectionCalculations",null),Lg(this,Jr,null),Lg(this,Qr,{row:0,col:0}),Lg(this,mo,new Vle({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Lg(this,qH,Wle(this))}static get PLUGIN_KEY(){return HR}static get PLUGIN_PRIORITY(){return zle}static get DEFAULT_SETTINGS(){return{[C$]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[HR]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new hp(this),this.autofillCalculations=new Ale(this),this.selectionCalculations=new Dle(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Gle).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Kle).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Xle).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Zle).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Jle).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,XH).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,XH).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,eue).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,tue).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,nue).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,KH).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,KH).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,qle).call(e,...r)}),this.addHook("afterRenderer",function(){return ft(qH,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Qle).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,rue).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,iue).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,oue).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,sue).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,aue).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,lue).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,uue).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,cue).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,hue).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,due).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,fue).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,gue).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,mue).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,pue).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!bk())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>o?.name==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Hm(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Hm(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?lo.containsNegativeValues(e)?(Ke(lo.NEGATIVE_VALUES_WARNING(e)),!1):lo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ke(lo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):lo.isSingleCell(e)?(Ke(lo.IS_SINGLE_CELL(e)),!1):lo.containsZeroSpan(e)?(Ke(lo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),he(0,s.rowspan-1,c=>{he(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),A(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),he(0,i.rowspan-1,o=>{he(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:GH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(GH)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ae(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ae(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ae(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ae(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Gle(){this.generateFromSettings(),this.hot.render()}function qle(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Kle(t){ft(Qr,this).row=t.row,ft(Qr,this).col=t.col}function Xle(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;ft(Jr,this)&&(i.getRenderableFromVisualIndex(ft(Jr,this).row)!==null&&(n.row=ft(Jr,this).row),r.getRenderableFromVisualIndex(ft(Jr,this).col)!==null&&(n.col=ft(Jr,this).col),Ad(Jr,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Zle(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Jle(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Ad(Jr,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Ad(Jr,this,e.clone()),n&&e.assign(n)}function KH(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),w=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[je(g,u,h),je(w,c,d),je(this.hot.getLastRenderedVisibleRow(),u,h),je(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Qle(t){t.items.push({name:"---------"},kle(this))}function XH(){Ad(Jr,this,null)}function eue(){if(ft(Jr,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=ft(Jr,this).clone().normalize();ft(mo,this).setActiveNode(r.row,r.col),ft(Qr,this).row>0||ft(Qr,this).col>0?ft(mo,this).setPrevNodeAsActive():(n==="E-W"&&ft(Qr,this).col<0||e==="S-N"&&ft(Qr,this).row<0)&&ft(mo,this).setNextNodeAsActive()}function tue(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(ft(Qr,this).col<0){const{rowEnd:a,colEnd:l}=ft(mo,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(ft(Qr,this).col>0){const{rowStart:a,colStart:l}=ft(mo,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(ft(Qr,this).row<0){const{rowEnd:a,colEnd:l}=ft(mo,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(ft(Qr,this).row>0){const{rowStart:a,colStart:l}=ft(mo,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}ft(mo,this).setActiveNode(t,e),Ad(Qr,this,{row:0,col:0})}function nue(){this.hot.getSelectedRangeLast().isHeader()||ft(mo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function rue(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function iue(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function oue(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function sue(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function aue(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function lue(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function uue(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function cue(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function hue(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function due(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);A(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function fue(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function gue(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function mue(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function pue(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,QF(this.hot,e,g))}),t}function wue(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:O$(u.type))(l,u,d)(c,h);if(g===vo){const w=a+1;if(typeof e[w]<"u")return s(w)}return g}(0)}}const tV="sort";function vue(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${tV}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Cue(t){const e=t.className.split(" "),n=new RegExp(`^${tV}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function yue(t,e,n){return(e=bue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bue(t){var e=Sue(t,"string");return typeof e=="symbol"?e:e+""}function Sue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const fp="multiColumnSorting",Rue=170,ZH=fp;P$(fp,wue);class Eue extends F${constructor(){super(...arguments),yue(this,"pluginKey",fp)}static get PLUGIN_KEY(){return fp}static get PLUGIN_PRIORITY(){return Rue}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,qm)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:da,position:"before",group:ZH})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ZH)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),we(e,Cue(e)),this.enabled!==!1&&q(e,vue(...r))}onAfterOnCellMouseDown(e,n){n_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,qm))):this.sort(this.getColumnNextConfig(n.col)))}}function JH(t,e,n){return(e=Tue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tue(t){var e=_ue(t,"string");return typeof e=="symbol"?e:e+""}function _ue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Mue="multipleSelectionHandles",Iue=160;class Pue extends Xe{constructor(){super(...arguments),JH(this,"dragged",[]),JH(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Mue}static get PLUGIN_PRIORITY(){return Iue}isEnabled(){return po()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(ye(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(ye(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(ye(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(ye(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function NR(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function nV(){return{label:"",isPlaceholder:!0}}function Oue(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;A(t,i=>{const o=[];let s=0;n.push(o),A(i,a=>{const l=NR();if(Ae(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=It(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=It(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(nV());return!u})});const r=Math.max(...We(n,i=>i.length));return A(n,i=>{if(i.length<r){const o=We(new Array(r-i.length),()=>NR());i.splice(i.length,0,...o)}}),n}function mS(t,e,n){xue(t,e),e.set(t,n)}function xue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wi(t,e){return t.get(rV(t,e))}function _h(t,e,n){return t.set(rV(t,e),n),n}function rV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const QH=["label","collapsible"];var Vo=new WeakMap,Ka=new WeakMap,pS=new WeakMap;class Aue{constructor(){mS(this,Vo,[]),mS(this,Ka,0),mS(this,pS,1/0)}setColumnsLimit(e){_h(pS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_h(Vo,this,Oue(e,wi(pS,this))),_h(Ka,this,wi(Vo,this).length)}getData(){return wi(Vo,this)}mergeWith(e){A(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&nn(s,o,QH)})}map(e){A(wi(Vo,this),n=>{A(n,r=>{const i=e({...r});Ae(i)&&nn(r,i,QH)})})}getHeaderSettings(e,n){var r;if(e>=wi(Ka,this)||e<0)return null;const i=wi(Vo,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=wi(Ka,this)||e<0)return i;const o=wi(Vo,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return wi(Ka,this)}getColumnsCount(){return wi(Ka,this)>0?wi(Vo,this)[0].length:0}clear(){_h(Vo,this,[]),_h(Ka,this,0)}}function wS(t,e,n){return(e=Hue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hue(t){var e=Nue(t,"string");return typeof e=="symbol"?e:e+""}function Nue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const iV="DF-pre-order";function oV(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=oV.call(this.childs[r],t,e)}return n}const Due="DF-post-order";function sV(t,e){for(let n=0;n<this.childs.length;n++)if(sV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const aV="BF";function kue(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const Lue=aV,eN=new Map([[iV,oV],[Due,sV],[aV,kue]]);class gp{constructor(e){wS(this,"data",{}),wS(this,"parent",null),wS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new gp({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lue;if(!eN.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);eN.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function vS(t,e,n){$ue(t,e),e.set(t,n)}function $ue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wn(t,e){return t.get(lV(t,e))}function Fue(t,e,n){return t.set(lV(t,e),n),n}function lV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yu=new WeakMap,Xa=new WeakMap,bu=new WeakMap;class Vue{constructor(e){vS(this,yu,new Map),vS(this,Xa,new Map),vS(this,bu,null),Fue(bu,this,e)}getRoots(){return Array.from(Wn(yu,this).values())}getRootByColumn(e){let n;return Wn(Xa,this).has(e)&&(n=Wn(yu,this).get(Wn(Xa,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Wn(Xa,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Wn(Xa,this).clear(),A(Wn(yu,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Wn(Xa,this).set(i,e);e+=r})}buildTree(){this.clear();const e=Wn(bu,this).getColumnsCount();let n=0;for(;n<e;){const r=Wn(bu,this).getHeaderSettings(0,n),i=new gp;Wn(yu,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Wn(bu,this).getHeadersSettings(r,n,i);r+=1,A(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new gp(a),e.addChild(l)),r<Wn(bu,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Wn(yu,this).clear(),Wn(Xa,this).clear()}}function uV(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function mp(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function pp(t){return mp(t,"origColspan")===t.data.origColspan}function w_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(pp(t))return w_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)A(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,uV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):pp(a)&&(l.isCollapsed=mp(a,"isCollapsed"))}),{rollbackModification:()=>v_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function v_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(pp(t))return v_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)A(o,l=>{uV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=mp(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):pp(l)&&(u.isCollapsed=mp(l,"isCollapsed"))}),{rollbackModification:()=>w_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function Wue(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(nt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function Bue(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(nt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const tN=new Map([["collapse",v_],["expand",w_],["hide-column",Wue],["show-column",Bue]]);function jue(t,e,n){if(!tN.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return tN.get(t)(e,n)}function $g(t){const e=[];return A(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=zue(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(nV());else{const f=Uue(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function Uue(t){const{crossHiddenColumns:e,...n}=NR(t);return n}function zue(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function CS(t,e,n){Yue(t,e),e.set(t,n)}function Yue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mh(t,e,n){return t.set(cV(t,e),n),n}function Ot(t,e){return t.get(cV(t,e))}function cV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var no=new WeakMap,or=new WeakMap,Za=new WeakMap;class Gue{constructor(){CS(this,no,new Aue),CS(this,or,new Vue(Ot(no,this))),CS(this,Za,[[]])}setState(e){Ot(no,this).setData(e);let n=!1;try{Ot(or,this).buildTree()}catch{Ot(or,this).clear(),Ot(no,this).clear(),n=!0}return Mh(Za,this,$g(Ot(or,this).getRoots())),n}setColumnsLimit(e){Ot(no,this).setColumnsLimit(e)}mergeStateWith(e){const n=We(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Ot(no,this).mergeWith(n),Ot(or,this).buildTree(),Mh(Za,this,$g(Ot(or,this).getRoots()))}mapState(e){Ot(no,this).map(e),Ot(or,this).buildTree(),Mh(Za,this,$g(Ot(or,this).getRoots()))}mapNodes(e){return vr(Ot(or,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Ot(or,this).getNode(n,r);let o;return i&&(o=jue(e,i,r),Mh(Za,this,$g(Ot(or,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Ot(Za,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Ot(or,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Ot(or,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},iV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Ot(no,this).getLayersCount()}getColumnsCount(){return Ot(no,this).getColumnsCount()}clear(){Mh(Za,this,[]),Ot(no,this).clear(),Ot(or,this).clear()}}function Ih(t,e,n){return(e=que(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function que(t){var e=Kue(t,"string");return typeof e=="symbol"?e:e+""}function Kue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xue{constructor(e,n){Ih(this,"hot",void 0),Ih(this,"nestedHeaderSettingsGetter",void 0),Ih(this,"layersCount",0),Ih(this,"container",void 0),Ih(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),bc(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function Zue(t,e){hV(t,e),e.add(t)}function nN(t,e,n){return(e=Jue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jue(t){var e=Que(t,"string");return typeof e=="symbol"?e:e+""}function Que(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ph(t,e,n){hV(t,e),e.set(t,n)}function hV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function is(t,e,n){return t.set(xt(t,e),n),n}function ke(t,e){return t.get(xt(t,e))}function xt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rN="nestedHeaders",ece=280;var st=new WeakMap,Ns=new WeakMap,cd=new WeakMap,Sw=new WeakMap,wp=new WeakMap,Lt=new WeakSet;class tce extends Xe{constructor(){super(...arguments),Zue(this,Lt),Ph(this,st,new Gue),Ph(this,Ns,null),Ph(this,cd,null),Ph(this,Sw,!1),Ph(this,wp,null),nN(this,"ghostTable",new Xue(this.hot,(e,n)=>this.getHeaderSettings(e,n))),nN(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return rN}static get PLUGIN_PRIORITY(){return ece}isEnabled(){return!!this.hot.getSettings()[rN]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Ke(nt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>xt(Lt,this,wce).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,vce).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,oce).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,sce).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,ace).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,lce).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,uce).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,cce).call(e,...i)}),this.addHook("afterSelection",()=>xt(Lt,this,Fg).call(this)),this.addHook("afterSelectionFocusSet",()=>xt(Lt,this,Fg).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,nce).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>xt(Lt,this,dce).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,gce).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,mce).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,rce).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,ice).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,hce).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,fce).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,pce).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>xt(Lt,this,Fg).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>xt(Lt,this,Fg).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();ke(st,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=ke(st,this).setState(e)),this.detectedOverlappedHeaders&&Ke(nt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";ke(st,this).triggerColumnModification(i,r)}),!ke(Ns,this)&&this.enabled&&is(Ns,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";ke(st,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),ke(st,this).clear(),ke(Ns,this).unsubscribe(),is(Ns,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return ke(st,this)}getLayersCount(){return ke(st,this).getLayersCount()}getHeaderSettings(e,n){return ke(st,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),we(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),we(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),we(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),we(o,"hiddenHeader"),we(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=ke(st,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)q(o,"hiddenHeader");else if(c>1){var g,w,C;const{wtOverlays:S}=l._wt,v=(g=S.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),T=(w=S.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o);((C=S.topOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o))&&u<r&&q(o,"hiddenHeaderText");const x=v||T?Math.min(c,r-i):c;x>1&&o.setAttribute("colspan",x)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const S=o.querySelector("div.relative");S&&f&&f.length>0&&(we(S,this.hot.getColumnMeta(u).headerClassName),q(S,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=ke(st,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){is(st,this,null),ke(Ns,this)!==null&&(ke(Ns,this).unsubscribe(),is(Ns,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return ke(st,this).getHeaderTreeNodeData(e.row,e.col)}}function Fg(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=ke(st,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function nce(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=ke(wp,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(is(wp,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=ke(st,this).findLeftMostColumnIndex(a,l),g=ke(st,this).findRightMostColumnIndex(a,l),w=g-f+1;if(f<c&&g>h)return f;if(s){let C=null;return f>=c&&g>h?w>d?(e.value="start",C=f):(e.value="end",C=g):f<c&&g<=h&&(w>d?(e.value="end",C=g):(e.value="start",C=f)),C}return f<=c?f:g}function rce(t,e,n){const r=ke(st,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=ke(st,this).getHeaderSettings(e,t);if(o===YE){if(!a)return r.columnIndex}else if(o===uL&&(l>s-i||!a))return null;return t}function ice(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,w=d-a;if(w===0)continue;((i=ke(st,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][w]="")}}}function oce(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function sce(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;is(cd,this,e.clone()),is(Sw,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(DE(t)||yl(t)&&l||sK(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function ace(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=je(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function lce(){is(Sw,this,!1)}function uce(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!ke(Sw,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=ke(st,this).getHeaderTreeNodeData(ke(cd,this).row,ke(cd,this).col);if(e.setHighlight(ke(cd,this)),o>e.getWidth()||i<n||i+o-1>r){const s=ke(st,this).findTopMostEntireHeaderLevel(je(n,i,i+o-1),je(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function cce(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=ke(st,this).findLeftMostColumnIndex(n.row,n.col),o=ke(st,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function hce(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});is(wp,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function dce(t){if(ke(st,this).getLayersCount()>0){t.length=0;for(let e=0;e<ke(st,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function fce(t){const e=ke(st,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=ke(st,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Gn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?ke(st,this).getHeaderTreeNodeData(0,n).columnIndex:n}function gce(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function mce(t,e,n){var r;const{label:i}=(r=ke(st,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function pce(t,e){if(t<0)return this.hot.getCell(t,ke(st,this).findLeftMostColumnIndex(t,e),!0)}function wce(){this.updatePlugin()}function vce(t,e){e||this.updatePlugin()}function Oh(t,e,n){return(e=Cce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cce(t){var e=yce(t,"string");return typeof e=="symbol"?e:e+""}function yce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bce{constructor(e,n){Oh(this,"hot",void 0),Oh(this,"data",null),Oh(this,"plugin",void 0),Oh(this,"parentReference",new WeakMap),Oh(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},he(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&A(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&A(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return He(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(A(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(he(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),he(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];A(r,o=>{i.push(this.getDataObject(o))}),A(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function iN(t,e,n){return(e=Sce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sce(t){var e=Rce(t,"string");return typeof e=="symbol"?e:e+""}function Rce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C_{constructor(e,n){iN(this,"hot",void 0),iN(this,"plugin",void 0),this.hot=n,this.plugin=e}}class co extends C_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(A(l,c=>{c&&s.removeChild(c)}),q(n,co.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",he(0,i-1,()=>{const d=c.createElement("SPAN");q(d,co.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Ce(c,[Nl()]),q(n,co.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(q(c,`${co.CSS_CLASSES.button} ${co.CSS_CLASSES.expandButton}`),u&&Ce(n,[ti(!1)])):(q(c,`${co.CSS_CLASSES.button} ${co.CSS_CLASSES.collapseButton}`),u&&Ce(n,[ti(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let r=11;this.hot.stylesHandler.isClassicTheme()||(r=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}class Ece extends C_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),A(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{he(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&A(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];A(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return A(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);A(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return A(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);A(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&A(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];A(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];A(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];A(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{A(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{A(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&A(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);ye(e.target,co.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Fi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Tce(t,e,n){_ce(t,e),e.set(t,n)}function _ce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mce(t,e,n){return(e=Ice(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ice(t){var e=Pce(t,"string");return typeof e=="symbol"?e:e+""}function Pce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oce(t,e){return t.get(xce(t,e))}function xce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oN=new WeakMap;class Ace extends C_{constructor(){super(...arguments),Mce(this,"dataManager",this.plugin.dataManager),Tce(this,oN,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(z0)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Y0)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return he(0,e.items.length-1,r=>{if(r===0)return A(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return he(0,e.items.length-1,n=>{const r=Oce(oN,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function Vg(t,e,n){return(e=Hce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hce(t){var e=Nce(t,"string");return typeof e=="symbol"?e:e+""}function Nce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dce{constructor(e){Vg(this,"plugin",void 0),Vg(this,"hot",void 0),Vg(this,"dataManager",void 0),Vg(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const w=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(w,a),w}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Mt(i)&&(Ke(nt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function kce(t,e){dV(t,e),e.add(t)}function sN(t,e,n){dV(t,e),e.set(t,n)}function dV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yS(t,e,n){return(e=Lce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lce(t){var e=$ce(t,"string");return typeof e=="symbol"?e:e+""}function $ce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cm(t,e){return t.get(dn(t,e))}function vp(t,e,n){return t.set(dn(t,e),n),n}function dn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Cp="nestedRows",Fce=300,aN=Cp,Vce="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Rw=new WeakMap,Su=new WeakMap,wn=new WeakSet;class Wce extends Xe{constructor(){super(...arguments),kce(this,wn),yS(this,"dataManager",null),yS(this,"headersUI",null),yS(this,"collapsedRowsMap",null),sN(this,Rw,!1),sN(this,Su,!1)}static get PLUGIN_KEY(){return Cp}static get PLUGIN_PRIORITY(){return Fce}isEnabled(){return!!this.hot.getSettings()[Cp]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Jd),this.dataManager=new bce(this,this.hot),this.collapsingUI=new Ece(this,this.hot),this.headersUI=new co(this,this.hot),this.contextMenuUI=new Ace(this,this.hot),this.rowMoveController=new Dce(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,the).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,nhe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,Uce).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,zce).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,Yce).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,jce).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,Kce).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,qce).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,Xce).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,Zce).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,Jce).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,Qce).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,Gce).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,ehe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dn(wn,e,Bce).call(e,...r)}),this.addHook("beforeLoadData",n=>dn(wn,this,lN).call(this,n)),this.addHook("beforeUpdateData",n=>dn(wn,this,lN).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:aN,relativeToGroup:da,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aN)}disableCoreAPIModifiers(){vp(Su,this,!0)}enableCoreAPIModifiers(){vp(Su,this,!1)}onModifyRowData(e){if(!Cm(Su,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Cm(Su,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Cm(Su,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function Bce(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function jce(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Uce(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),vp(Rw,this,!0),this.dataManager.getData().slice()}function zce(t){return this.contextMenuUI.appendOptions(t)}function Yce(t,e){this.headersUI.appendLevelIndicators(t,e)}function Gce(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function qce(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{vp(Rw,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Kce(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Xce(){this.collapsingUI.collapsedRowsStash.stash()}function Zce(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Jce(){this.collapsingUI.collapsedRowsStash.stash()}function Qce(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function ehe(){this.dataManager.rewriteCache()}function the(){this.headersUI.updateRowHeaderWidth()}function nhe(t,e){Cm(Rw,this)&&(e.skipRender=!0)}function lN(t){if(!g6(t)){kE(Vce),this.hot.getSettings()[Cp]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function bS(t,e,n){return(e=rhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rhe(t){var e=ihe(t,"string");return typeof e=="symbol"?e:e+""}function ihe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ohe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;bS(this,"rootWindow",void 0),bS(this,"prefix",void 0),bS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){A(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function she(t,e,n){return(e=ahe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ahe(t){var e=lhe(t,"string");return typeof e=="symbol"?e:e+""}function lhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}re.getSingleton().register("persistentStateSave");re.getSingleton().register("persistentStateLoad");re.getSingleton().register("persistentStateReset");const uN="persistentState",uhe=0;class che extends Xe{constructor(){super(...arguments),she(this,"storage",void 0)}static get PLUGIN_KEY(){return uN}static get PLUGIN_PRIORITY(){return uhe}isEnabled(){return!!this.hot.getSettings()[uN]}enablePlugin(){this.enabled||(this.storage||(this.storage=new ohe(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function hhe(t,e){dhe(t,e),e.add(t)}function dhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SS(t,e,n){return(e=fhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fhe(t){var e=ghe(t,"string");return typeof e=="symbol"?e:e+""}function ghe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const RS="search",mhe=190,phe="htSearchResult",whe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},vhe=function(t,e,n){return Mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Mt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var ES=new WeakSet;class Che extends Xe{constructor(){super(...arguments),hhe(this,ES),SS(this,"callback",whe),SS(this,"queryMethod",vhe),SS(this,"searchResultClass",phe)}static get PLUGIN_KEY(){return RS}static get PLUGIN_PRIORITY(){return mhe}isEnabled(){return this.hot.getSettings()[RS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[RS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cN(ES,e,hN).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cN(ES,e,hN).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return he(0,i-1,l=>{he(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const w={row:l,col:u,data:c};s.push(w)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ae(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function hN(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Wg(t,e,n){return(e=yhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yhe(t){var e=bhe(t,"string");return typeof e=="symbol"?e:e+""}function bhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fV{constructor(e){Wg(this,"viewportWidth",void 0),Wg(this,"overwriteColumnWidthFn",void 0),Wg(this,"baseWidths",new Map),Wg(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class She extends fV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=ic?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=ic){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,w=g;o.includes(f)||(w=Math.round(g*l)),this.stretchedWidths.set(f,w),u=f,d<i.length-1&&(c+=w)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function dN(t,e,n){Rhe(t,e),e.set(t,n)}function Rhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TS(t,e){return t.get(gV(t,e))}function Bg(t,e,n){return t.set(gV(t,e),n),n}function gV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jg=new WeakMap,xh=new WeakMap;class Ehe extends fV{constructor(){super(...arguments),dN(this,jg,0),dN(this,xh,-1)}prepare(e){super.prepare(e),Bg(jg,this,0),Bg(xh,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),Bg(xh,this,e),Bg(jg,this,n)}calculate(){if(TS(xh,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+TS(jg,this),0);this.stretchedWidths.set(TS(xh,this),n)}}function The(t,e){mV(t,e),e.add(t)}function Ug(t,e,n){mV(t,e),e.set(t,n)}function mV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $t(t,e){return t.get(Wu(t,e))}function _S(t,e,n){return t.set(Wu(t,e),n),n}function Wu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _he="stretchColumns";var On=new WeakMap,Ru=new WeakMap,MS=new WeakMap,zg=new WeakMap,Ah=new WeakSet;class Mhe{constructor(e){The(this,Ah),Ug(this,On,void 0),Ug(this,Ru,void 0),Ug(this,MS,new Map([["all",new She(Wu(Ah,this,fN).bind(this))],["last",new Ehe(Wu(Ah,this,fN).bind(this))]])),Ug(this,zg,"none"),_S(On,this,e),_S(Ru,this,$t(On,this).columnIndexMapper.createAndRegisterIndexMap(_he,"physicalIndexToValue"))}useStrategy(e){_S(zg,this,$t(MS,this).has(e)?e:"none")}refreshStretching(){if($t(zg,this)==="none"){$t(Ru,this).clear();return}$t(On,this).batchExecution(()=>{$t(Ru,this).clear();const e=$t(MS,this).get($t(zg,this));let r=$t(On,this).view.getViewportWidth();Wu(Ah,this,Ihe).call(this)&&(r-=Cn($t(On,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<$t(On,this).countCols();i++)$t(On,this).columnIndexMapper.isHidden($t(On,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Wu(Ah,this,Phe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;$t(Ru,this).setValueAtIndex($t(On,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return $t(Ru,this).getValueAtIndex($t(On,this).toPhysicalColumn(e))}}function Ihe(){const{view:t,stylesHandler:e}=$t(On,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),r=$t(On,this).countRows(),i=e.getDefaultRowHeight();let o=0,s=!1;for(let l=0;l<r;l++){var a;if(o+=((a=$t(On,this).getRowHeight(l))!==null&&a!==void 0?a:i)+(l===0?1:0),o>n){s=!0;break}}return s}function Phe(t){var e;return(e=$t(On,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:ic}function fN(t,e){return $t(On,this).runHooks("beforeStretchingColumnWidth",t,e)}function Ohe(t,e){pV(t,e),e.add(t)}function IS(t,e,n){pV(t,e),e.set(t,n)}function pV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PS(t,e,n){return t.set(yp(t,e),n),n}function Yo(t,e){return t.get(yp(t,e))}function yp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xhe="stretchColumns",Ahe=155;var Du=new WeakMap,Yg=new WeakMap,Hh=new WeakMap,OS=new WeakSet;class Hhe extends Xe{constructor(){super(...arguments),Ohe(this,OS),IS(this,Du,new Mhe(this.hot)),IS(this,Yg,null),IS(this,Hh,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;Yo(Yg,this)!==null&&Yo(Yg,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),PS(Yg,this,i.width)})})}))}static get PLUGIN_KEY(){return xhe}static get PLUGIN_PRIORITY(){return Ahe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Yo(Du,this).useStrategy(this.hot.getSettings().stretchH),Yo(Hh,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yp(OS,e,Dhe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yp(OS,e,Nhe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Yo(Du,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Yo(Hh,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Yo(Du,this).getStretchedWidth(e)}destroy(){Yo(Hh,this).disconnect(),PS(Hh,this,null),PS(Du,this,null),super.destroy()}}function Nhe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function Dhe(t){t&&Yo(Du,this).refreshStretching()}function khe(t,e){Lhe(t,e),e.add(t)}function Lhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gg(t,e,n){return(e=$he(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $he(t){var e=Fhe(t,"string");return typeof e=="symbol"?e:e+""}function Fhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vhe="touchScroll",Whe=200;var qg=new WeakSet;class Bhe extends Xe{constructor(){super(...arguments),khe(this,qg),Gg(this,"scrollbars",[]),Gg(this,"clones",[]),Gg(this,"lockedCollection",!1),Gg(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Vhe}static get PLUGIN_PRIORITY(){return Whe}static get SETTING_KEYS(){return!0}isEnabled(){return yk()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>xS(qg,this,jhe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>xS(qg,this,Uhe).call(this)),this.addHook("afterMomentumScroll",()=>xS(qg,this,zhe).call(this))}}function jhe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Uhe(){this.freezeOverlays=!0,A(this.clones,t=>{q(t,"hide-tween")})}function zhe(){this.freezeOverlays=!1,A(this.clones,t=>{we(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{A(this.clones,t=>{we(t,"show-tween")})},400),A(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Yhe(t,e){Ghe(t,e),e.add(t)}function Ghe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qhe(t,e,n){return(e=Khe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Khe(t){var e=Xhe(t,"string");return typeof e=="symbol"?e:e+""}function Xhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zhe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ym="trimRows",Jhe=330;var gN=new WeakSet;class Qhe extends Xe{constructor(){super(...arguments),Yhe(this,gN),qhe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return ym}static get PLUGIN_PRIORITY(){return Jhe}isEnabled(){return!!this.hot.getSettings()[ym]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Jd),this.trimmedRowsMap.addLocalHook("init",()=>Zhe(gN,this,ede).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[ym];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),A(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{A(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(A(e,l=>{o[l]=!1}),i=vr(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function ede(){const t=this.hot.getSettings()[ym];Array.isArray(t)&&this.hot.batchExecution(()=>{A(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function tde(t,e,n){return(e=nde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nde(t){var e=rde(t,"string");return typeof e=="symbol"?e:e+""}function rde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ui{constructor(e){tde(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Kg(t,e,n){return(e=ide(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ide(t){var e=ode(t,"string");return typeof e=="symbol"?e:e+""}function ode(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y_ extends ui{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),Kg(this,"stateBefore",void 0),Kg(this,"range",void 0),Kg(this,"type",void 0),Kg(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new y_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){A(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Ls(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function mN(t,e,n){return(e=sde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sde(t){var e=ade(t,"string");return typeof e=="symbol"?e:e+""}function ade(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b_ extends ui{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),mN(this,"columns",void 0),mN(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new b_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),m_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function pN(t,e,n){return(e=lde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lde(t){var e=ude(t,"string");return typeof e=="symbol"?e:e+""}function ude(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S_ extends ui{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),pN(this,"previousSortState",void 0),pN(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new S_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function wN(t,e,n){return(e=cde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cde(t){var e=hde(t,"string");return typeof e=="symbol"?e:e+""}function hde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R_ extends ui{constructor(e){let{index:n,amount:r}=e;super("insert_col"),wN(this,"index",void 0),wN(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new R_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function vN(t,e,n){return(e=dde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dde(t){var e=fde(t,"string");return typeof e=="symbol"?e:e+""}function fde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E_ extends ui{constructor(e){let{index:n,amount:r}=e;super("insert_row"),vN(this,"index",void 0),vN(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new E_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Xg(t,e,n){return(e=gde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gde(t){var e=mde(t,"string");return typeof e=="symbol"?e:e+""}function mde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T_ extends ui{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Xg(this,"changes",void 0),Xg(this,"selected",void 0),Xg(this,"countCols",void 0),Xg(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new T_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=Xn(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=Xn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function CN(t,e,n){return(e=pde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pde(t){var e=wde(t,"string");return typeof e=="symbol"?e:e+""}function wde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class __ extends ui{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),CN(this,"conditionsStack",void 0),CN(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new __({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function vde(t,e,n){return(e=Cde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cde(t){var e=yde(t,"string");return typeof e=="symbol"?e:e+""}function yde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M_ extends ui{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),vde(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new M_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function wV(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return he(r,i,l=>{he(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Wo(t,e,n){return(e=bde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bde(t){var e=Sde(t,"string");return typeof e=="symbol"?e:e+""}function Sde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I_ extends ui{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Wo(this,"index",void 0),Wo(this,"indexes",void 0),Wo(this,"data",void 0),Wo(this,"amount",void 0),Wo(this,"headers",void 0),Wo(this,"columnPositions",void 0),Wo(this,"rowPositions",void 0),Wo(this,"fixedColumnsStart",void 0),Wo(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return he(l.length-1,g=>{const w=[],C=l[g];he(u,c,S=>{w.push(C[e.toPhysicalColumn(S)])}),h.push(w)}),he(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&he(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new I_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:wV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(We(this.data[c],o));const l=We(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),A(e.getSourceDataArray(),(c,h)=>{A(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&A(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Eu(t,e,n){return(e=Rde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rde(t){var e=Ede(t,"string");return typeof e=="symbol"?e:e+""}function Ede(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P_ extends ui{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),Eu(this,"index",void 0),Eu(this,"data",void 0),Eu(this,"fixedRowsBottom",void 0),Eu(this,"fixedRowsTop",void 0),Eu(this,"rowIndexesSequence",void 0),Eu(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Xn(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new P_({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:wV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function yN(t,e,n){return(e=Tde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tde(t){var e=_de(t,"string");return typeof e=="symbol"?e:e+""}function _de(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O_ extends ui{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),yN(this,"rows",void 0),yN(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new O_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),m_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Mde(t,e,n){return(e=Ide(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ide(t){var e=Pde(t,"string");return typeof e=="symbol"?e:e+""}function Pde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x_ extends ui{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),Mde(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new x_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function Ode(t,e){[y_,b_,S_,R_,E_,T_,__,M_,I_,P_,O_,x_].forEach(n=>n.startRegisteringEvents(t,e))}function xde(t,e){Ade(t,e),e.add(t)}function Ade(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AS(t,e,n){return(e=Hde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hde(t){var e=Nde(t,"string");return typeof e=="symbol"?e:e+""}function Nde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bN="undoRedo",Dde="undoRedo",kde=1e3;re.getSingleton().register("beforeUndo");re.getSingleton().register("afterUndo");re.getSingleton().register("beforeRedo");re.getSingleton().register("afterRedo");const SN=new Set;var Zg=new WeakSet;class Lde extends Xe{static get PLUGIN_KEY(){return Dde}static get PLUGIN_PRIORITY(){return kde}static get SETTING_KEYS(){return!0}constructor(e){super(e),xde(this,Zg),AS(this,"doneActions",[]),AS(this,"undoneActions",[]),AS(this,"ignoreNewActions",!1),Ode(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return HS(Zg,e,$de).call(e,...r)}),this.registerShortcuts(),HS(Zg,this,Fde).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),HS(Zg,this,Vde).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:bN};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bN)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Xn(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Xn(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function $de(t,e){e==="loadData"&&this.clear()}function Fde(){const t=e=>{SN.has(e)||(Ke(nt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),SN.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Vde(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function Wde(){Ue(Kh),Ue(nQ),Ue(Xh),Ue(HQ),Ue(WQ),Ue(F$),Ue(kee),Ue(yte),Ue(pw),Ue(Ine),Ue(ere),Ue(lre),Ue(Cw),Ue(Ure),Ue(Foe),Ue(vse),Ue(zse),Ue(rae),Ue(mae),Ue(_ae),Ue(kae),Ue(ele),Ue(ule),Ue(Yle),Ue(Eue),Ue(Pue),Ue(tce),Ue(Wce),Ue(che),Ue(Che),Ue(Hhe),Ue(Bhe),Ue(Qhe),Ue(Lde)}function Bde(){_5(),KZ(),iJ(),EJ(),Wde()}const RN={isDone:{name:"是否已完成",show:!1},id:{name:"谱面ID",show:!0},mode:{name:"模式",show:!1},status:{name:"状态",show:!1},bpm:{name:"BPM",show:!0},total_length:{name:"音频总时长(秒)",show:!1},hit_length:{name:"游玩长度(秒)",show:!1},url:{name:"谱面链接",show:!1},version:{name:"难度名称",show:!1},difficulty_rating:{name:"难度星级",show:!0},cs:{name:"CS",show:!1},ar:{name:"AR",show:!1},accuracy:{name:"OD",show:!1},drain:{name:"HP",show:!1},max_combo:{name:"最大连击数",show:!1},count_circles:{name:"圆圈数",show:!1},count_sliders:{name:"滑条数",show:!1},count_spinners:{name:"转盘数",show:!1},passcount:{name:"过关次数",show:!1},playcount:{name:"游玩次数",show:!1},"beatmapset.covers.list@2x":{name:"封面图",show:!1},"beatmapset.id":{name:"谱面集ID",show:!1},"beatmapset.title":{name:"歌曲标题",show:!1},"beatmapset.title_unicode":{name:"歌曲标题(原语言)",show:!0},"beatmapset.artist":{name:"歌曲艺术家",show:!1},"beatmapset.artist_unicode":{name:"艺术家(原语言)",show:!0},"beatmapset.bpm":{name:"谱面集BPM",show:!1},"beatmapset.preview_url":{name:"试听链接",show:!1},"beatmapset.creator":{name:"谱面集作者",show:!0},"beatmapset.user_id":{name:"谱面集作者ID",show:!1},"beatmapset.source":{name:"谱面集来源",show:!1},"beatmapset.video":{name:"是否含视频",show:!1},"beatmapset.storyboard":{name:"是否含故事板",show:!1},"beatmapset.favourite_count":{name:"收藏数",show:!1},"beatmapset.rating":{name:"谱面评分",show:!1},"beatmapset.tags":{name:"标签",show:!1},"beatmapset.submitted_date":{name:"提交日期",show:!1},"beatmapset.last_updated":{name:"最后更新日期",show:!1},"beatmapset.ranked_date":{name:"Ranked 日期",show:!1}};function jde(t,e){return e.split(".").reduce((n,r)=>{if(n&&typeof n=="object")return n[r]},t)}function Ude(){function t(r){const i=[];for(const o of Object.keys(beatmapInfoMap)){const s=jde(r,o);typeof s<"u"?i.push(s):i.push(o==="isDone"?1:"")}return i}function e(){return Object.values(RN).map(r=>r.name)}function n(){return Object.values(RN).map(r=>r.show)}return{mapObject:t,getFieldNames:e,getFieldShows:n}}const zde={class:"grid-container"},Yde={class:"content"},Gde={key:0,class:"corner-icon"},qde={__name:"BeatmapInfoTable",props:["modelValue","hot"],emits:["selected"],setup(t,{emit:e}){const n=t,r=e,i=en(!1),o=en([]),s=en([]),a=en([]);Qs(()=>n.modelValue,h=>{if(i.value=h,h){o.value=n.hot.getColHeader(),a.value=[],s.value=[],o.value[0]="自定义内容";const d=n.hot.getPlugin("hiddenColumns");if(d){const f=n.hot.countCols();for(let g=1;g<f;g++)d.isHidden(g)||s.value.push(g)}}});function l(h){if(s.value.includes(h))return;const d=a.value.indexOf(h);d>=0?a.value.splice(d,1):a.value.push(h)}function u(){r("selected",a.value),i.value=!1}function c(){r("selected",[]),i.value=!1}return(h,d)=>{const f=_N,g=QB,w=JV,C=vj;return Dn(),Ju(C,{modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=S=>i.value=S),title:"请选择",width:"60%",onClose:c},{footer:gr(()=>[Ii(w,{onClick:c},{default:gr(()=>d[1]||(d[1]=[Sm("取消")])),_:1,__:[1]}),Ii(w,{type:"primary",onClick:u},{default:gr(()=>d[2]||(d[2]=[Sm("确认")])),_:1,__:[2]})]),default:gr(()=>[dl("div",zde,[(Dn(!0),wo(ZV,null,XV(o.value,(S,v)=>(Dn(),Ju(g,{key:v,class:Ar([{selected:a.value.includes(v),disabled:s.value.includes(v)},"grid-item"]),onClick:T=>l(v)},{default:gr(()=>[dl("div",Yde,Rm(S),1),a.value.includes(v)?(Dn(),wo("div",Gde,[Ii(f,null,{default:gr(()=>[Ii(pe(QV))]),_:1})])):Qu("",!0)]),_:2},1032,["class","onClick"]))),128))])]),_:1},8,["modelValue"])}}},Kde=KV(qde,[["__scopeId","data-v-297173c6"]]),Xde={class:"container"},mfe={__name:"TableView",setup(t){Bde();const{getFieldNames:e,getFieldShows:n}=Ude(),r=en(null);let i=null;const o=e(),s=en(!1);let a;const l=w=>{s.value=!1,a&&(a(w),a=null)},u=async()=>(s.value=!0,new Promise(w=>{a=w})),c={colHeaders:o,rowHeaders:!0,stretchH:"all",width:"100%",minCols:o.length,manualColumnResize:!0,manualColumnMove:!0,manualRowMove:!0,manualRowResize:!0,autoWrapRow:!0,themeName:"ht-theme-horizon",licenseKey:"non-commercial-and-evaluation",hiddenColumns:{copyPasteEnabled:!1},contextMenu:{async callback(w,C,S){const v=h(),T=d();switch(w){case"row:delete":{let M=0;T.forEach(x=>{this.alter("remove_row",x-M),M++});break}case"row:above":{this.alter("insert_row_above",T[0]);break}case"row:below":{this.alter("insert_row_below",T[0]);break}case"col:delete":{let M=0;v.forEach(x=>{this.toPhysicalColumn(x)>=o.length?(this.alter("remove_col",x-M),M++):this.getPlugin("hiddenColumns").hideColumn(x)});break}case"col:left":{const M=await u(),x=this.getPlugin("manualColumnMove"),I=this.getPlugin("hiddenColumns");M[0]===0&&(this.alter("insert_col_end",this.countCols()),x.moveColumn(this.countCols()-1,v[0]),M.shift()),I.showColumns(M),x.moveColumns(M,v[0]);break}case"col:right":{const M=await u();console.log(M);break}}console.log(w),this.render()},items:{row:{name:"行操作",submenu:{items:[{key:"row:delete",name:"删除选中行",disabled(){return g()}},{key:"row:above",name:"在上方插入行",disabled(){return d().length!==1}},{key:"row:below",name:"在下方插入行",disabled(){return d().length!==1}}]}},col:{name:"列操作",submenu:{items:[{key:"col:delete",name:"删除选中列",disabled(){return f()}},{key:"col:left",name:"在左侧插入自定义列...",disabled(){return h().length!==1}},{key:"col:right",name:"在右侧插入自定义列...",disabled(){return h().length!==1}}]}},split:{name:"---------"},alignment:{name:"单元格对齐"}}},afterGetColHeader(w,C){C.removeEventListener("dblclick",C._dblclickHandler);const S=()=>{const v=i.getColHeader(w),T=document.createElement("input");T.type="text",T.value=v,T.style.position="absolute";const M=C.getBoundingClientRect();T.style.left=M.left+"px",T.style.top=M.top+"px",T.style.width=M.width+"px",T.style.height=M.height+"px",T.style.zIndex=9999,document.body.appendChild(T),i.deselectCell(),T.focus(),T.addEventListener("blur",()=>{const x=T.value.trim()||v,I=i.getSettings().colHeaders,P=i.toPhysicalColumn(w);I[P]=x,i.updateSettings({colHeaders:I}),document.body.removeChild(T)}),T.addEventListener("keydown",x=>{x.key==="Enter"&&T.blur()})};C._dblclickHandler=S,C.addEventListener("dblclick",S)}};function h(){const w=i.getSelectedRange(),C=new Set,S=i.getPlugin("hiddenColumns");return w?(w.forEach(v=>{const T=Math.min(v.from.col,v.to.col),M=Math.max(v.from.col,v.to.col);for(let x=T;x<=M;x++)x!==-1&&!S.isHidden(x)&&C.add(x)}),Array.from(C).sort((v,T)=>v-T)):[]}function d(){const w=i.getSelectedRange(),C=new Set;return w?(w.forEach(S=>{const v=Math.min(S.from.row,S.to.row),T=Math.max(S.from.row,S.to.row);for(let M=v;M<=T;M++)M!==-1&&C.add(M)}),Array.from(C).sort((S,v)=>S-v)):[]}function f(){const w=i.countCols(),C=i.getPlugin("hiddenColumns");let S=0;for(let T=0;T<w;T++)C.isHidden(T)||S++;return h().length===S}function g(){return i.countRows()===d().length}return cc(()=>{if(r.value){i=r.value.hotInstance;const w=i.getPlugin("hiddenColumns"),C=n().reduce((S,v,T)=>v?S:[...S,T],[]);w.hideColumns(C),i.render()}}),(w,C)=>(Dn(),wo("div",Xde,[Ii(pe(HT),{class:"handsontable",ref_key:"hotTable",ref:r,settings:c,width:"100%",height:"500"},null,512),Ii(Kde,{modelValue:s.value,"onUpdate:modelValue":C[0]||(C[0]=S=>s.value=S),hot:pe(i),onSelected:l},null,8,["modelValue","hot"])]))}};export{mfe as default};
